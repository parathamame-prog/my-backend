(()=>{var e,t,s,a={6221:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(69783);class n extends a.A{getMountPath(){return"/ws/socket.io/"}}const l=new n},23046:(e,t,s)=>{"use strict";s.d(t,{GY:()=>n,Gt:()=>l,Zk:()=>r,wE:()=>a});const a=()=>"https://app.base44.com",n=()=>"https://ws.base44.com";function l(){return a()+"/api"}function r(){return l()}},24394:()=>{},38534:(e,t,s)=>{"use strict";s.d(t,{KZ:()=>i,xL:()=>r,yI:()=>l});var a=s(89379);let n={};function l(e,t){n[e]=t}function r(e){delete n[e]}function i(){return(0,a.A)({},n)}},42634:()=>{},55194:(e,t,s)=>{"use strict";s.d(t,{O5:()=>l,QF:()=>r,VO:()=>n,b3:()=>a.A});var a=s(76976);function n(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return a.A.fetchToken(e)}function l(e){a.A.setToken(e)}function r(){a.A.setToken(null)}},67150:(e,t,s)=>{"use strict";var a={};s.r(a),s.d(a,{cn:()=>de});var n={};s.r(n),s.d(n,{Accordion:()=>St,AccordionContent:()=>It,AccordionItem:()=>Et,AccordionTrigger:()=>Tt});var l={};s.r(l),s.d(l,{Alert:()=>Dt,AlertDescription:()=>Ot,AlertTitle:()=>Ft});var r={};s.r(r),s.d(r,{Button:()=>zt,buttonVariants:()=>Bt});var i={};s.r(i),s.d(i,{AlertDialog:()=>Zt,AlertDialogAction:()=>ls,AlertDialogCancel:()=>rs,AlertDialogContent:()=>es,AlertDialogDescription:()=>ns,AlertDialogFooter:()=>ss,AlertDialogHeader:()=>ts,AlertDialogOverlay:()=>Xt,AlertDialogPortal:()=>Qt,AlertDialogTitle:()=>as,AlertDialogTrigger:()=>Jt});var o={};s.r(o),s.d(o,{AspectRatio:()=>is});var c={};s.r(c),s.d(c,{Avatar:()=>us,AvatarFallback:()=>xs,AvatarImage:()=>ms});var d={};s.r(d),s.d(d,{Badge:()=>gs,badgeVariants:()=>ps});var u={};s.r(u),s.d(u,{Calendar:()=>Ns});var m={};s.r(m),s.d(m,{Card:()=>Es,CardContent:()=>Ls,CardDescription:()=>Ps,CardFooter:()=>Ms,CardHeader:()=>Ts,CardTitle:()=>Is});var x={};s.r(x),s.d(x,{Checkbox:()=>Os});var h={};s.r(h),s.d(h,{Collapsible:()=>Us,CollapsibleContent:()=>zs,CollapsibleTrigger:()=>Bs});var p={};s.r(p),s.d(p,{Carousel:()=>Qs,CarouselContent:()=>Xs,CarouselItem:()=>ea,CarouselNext:()=>sa,CarouselPrevious:()=>ta});var g={};s.r(g),s.d(g,{Dialog:()=>ma,DialogClose:()=>pa,DialogContent:()=>fa,DialogDescription:()=>ya,DialogFooter:()=>ba,DialogHeader:()=>va,DialogOverlay:()=>ga,DialogPortal:()=>ha,DialogTitle:()=>ja,DialogTrigger:()=>xa});var f={};s.r(f),s.d(f,{Command:()=>Ta,CommandDialog:()=>Ia,CommandEmpty:()=>Ma,CommandGroup:()=>Ra,CommandInput:()=>Pa,CommandItem:()=>Fa,CommandList:()=>La,CommandSeparator:()=>Da,CommandShortcut:()=>Oa});var v={};s.r(v),s.d(v,{ContextMenu:()=>Za,ContextMenuCheckboxItem:()=>rn,ContextMenuContent:()=>nn,ContextMenuGroup:()=>Qa,ContextMenuItem:()=>ln,ContextMenuLabel:()=>cn,ContextMenuPortal:()=>Xa,ContextMenuRadioGroup:()=>tn,ContextMenuRadioItem:()=>on,ContextMenuSeparator:()=>dn,ContextMenuShortcut:()=>un,ContextMenuSub:()=>en,ContextMenuSubContent:()=>an,ContextMenuSubTrigger:()=>sn,ContextMenuTrigger:()=>Ja});var b={};s.r(b),s.d(b,{DropdownMenu:()=>yn,DropdownMenuCheckboxItem:()=>In,DropdownMenuContent:()=>En,DropdownMenuGroup:()=>wn,DropdownMenuItem:()=>Tn,DropdownMenuLabel:()=>Ln,DropdownMenuPortal:()=>_n,DropdownMenuRadioGroup:()=>Cn,DropdownMenuRadioItem:()=>Pn,DropdownMenuSeparator:()=>Mn,DropdownMenuShortcut:()=>Rn,DropdownMenuSub:()=>kn,DropdownMenuSubContent:()=>Sn,DropdownMenuSubTrigger:()=>An,DropdownMenuTrigger:()=>Nn});var j={};s.r(j),s.d(j,{Label:()=>On});var y={};s.r(y),s.d(y,{Form:()=>Vn,FormControl:()=>Zn,FormDescription:()=>Jn,FormField:()=>qn,FormItem:()=>Kn,FormLabel:()=>$n,FormMessage:()=>Qn,useFormField:()=>Yn});var N={};s.r(N),s.d(N,{HoverCard:()=>el,HoverCardContent:()=>sl,HoverCardTrigger:()=>tl});var w={};s.r(w),s.d(w,{Input:()=>nl});var _={};s.r(_),s.d(_,{Menubar:()=>Nl,MenubarCheckboxItem:()=>Sl,MenubarContent:()=>Cl,MenubarGroup:()=>vl,MenubarItem:()=>Al,MenubarLabel:()=>Tl,MenubarMenu:()=>fl,MenubarPortal:()=>bl,MenubarRadioGroup:()=>yl,MenubarRadioItem:()=>El,MenubarSeparator:()=>Il,MenubarShortcut:()=>Pl,MenubarSub:()=>jl,MenubarSubContent:()=>kl,MenubarSubTrigger:()=>_l,MenubarTrigger:()=>wl});var k={};s.r(k),s.d(k,{NavigationMenu:()=>Bl,NavigationMenuContent:()=>ql,NavigationMenuIndicator:()=>Kl,NavigationMenuItem:()=>Hl,NavigationMenuLink:()=>Yl,NavigationMenuList:()=>zl,NavigationMenuTrigger:()=>Wl,NavigationMenuViewport:()=>Gl,navigationMenuTriggerStyle:()=>Vl});var C={};s.r(C),s.d(C,{Popover:()=>Zl,PopoverContent:()=>Ql,PopoverTrigger:()=>Jl});var A={};s.r(A),s.d(A,{Progress:()=>tr});var S={};s.r(S),s.d(S,{RadioGroup:()=>lr,RadioGroupItem:()=>rr});var E={};s.r(E),s.d(E,{ScrollArea:()=>cr,ScrollBar:()=>dr});var T={};s.r(T),s.d(T,{Select:()=>br,SelectContent:()=>kr,SelectGroup:()=>jr,SelectItem:()=>Ar,SelectLabel:()=>Cr,SelectScrollDownButton:()=>_r,SelectScrollUpButton:()=>wr,SelectSeparator:()=>Sr,SelectTrigger:()=>Nr,SelectValue:()=>yr});var I={};s.r(I),s.d(I,{Separator:()=>Tr});var P={};s.r(P),s.d(P,{Sheet:()=>Fr,SheetClose:()=>Ur,SheetContent:()=>Vr,SheetDescription:()=>Gr,SheetFooter:()=>qr,SheetHeader:()=>Wr,SheetOverlay:()=>zr,SheetPortal:()=>Br,SheetTitle:()=>Yr,SheetTrigger:()=>Or});var L={};s.r(L),s.d(L,{Skeleton:()=>$r});var M={};s.r(M),s.d(M,{Slider:()=>Qr});var R={};s.r(R),s.d(R,{Switch:()=>ei});var D={};s.r(D),s.d(D,{Table:()=>ci,TableBody:()=>ui,TableCaption:()=>gi,TableCell:()=>pi,TableFooter:()=>mi,TableHead:()=>hi,TableHeader:()=>di,TableRow:()=>xi});var F={};s.r(F),s.d(F,{Tabs:()=>ji,TabsContent:()=>wi,TabsList:()=>yi,TabsTrigger:()=>Ni});var O={};s.r(O),s.d(O,{Textarea:()=>ki});var U={};s.r(U),s.d(U,{Toast:()=>Ri,ToastAction:()=>Di,ToastClose:()=>Fi,ToastDescription:()=>Ui,ToastProvider:()=>Pi,ToastTitle:()=>Oi,ToastViewport:()=>Li});var B={};s.r(B),s.d(B,{Toggle:()=>Vi,toggleVariants:()=>Hi});var z={};s.r(z),s.d(z,{Tooltip:()=>Yi,TooltipContent:()=>Ki,TooltipProvider:()=>qi,TooltipTrigger:()=>Gi});var H={};s.r(H),s.d(H,{reducer:()=>Qi,toast:()=>so,useToast:()=>ao});var V={};s.r(V),s.d(V,{Toaster:()=>lo});var W={};s.r(W),s.d(W,{Toaster:()=>io});var q={};s.r(q),s.d(q,{Sidebar:()=>Oo,SidebarContent:()=>Yo,SidebarFooter:()=>Wo,SidebarGroup:()=>Go,SidebarGroupAction:()=>$o,SidebarGroupContent:()=>Zo,SidebarGroupLabel:()=>Ko,SidebarHeader:()=>Vo,SidebarInput:()=>Ho,SidebarInset:()=>zo,SidebarMenu:()=>Jo,SidebarMenuAction:()=>tc,SidebarMenuBadge:()=>sc,SidebarMenuButton:()=>ec,SidebarMenuItem:()=>Qo,SidebarMenuSkeleton:()=>ac,SidebarMenuSub:()=>nc,SidebarMenuSubButton:()=>rc,SidebarMenuSubItem:()=>lc,SidebarProvider:()=>Fo,SidebarRail:()=>Bo,SidebarSeparator:()=>qo,SidebarTrigger:()=>Uo,useSidebar:()=>Do});var Y=s(9950),G=s(1352),K=s.t(G,2),$=s(35887),Z=s(42074),J=s(28429),Q=s(39330),X=s(15441),ee=s(55194),te=s(84125),se=s(44414);const ae=(0,Y.createContext)();class ne extends te.y{getBaseURL(){return"/apps"}getCurrentUser(e){return this.axios.get("/".concat(e,"/entities/User/me"))}}const le=new ne,re=e=>{let{children:t,appId:s}=e;const[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{const e=(0,ee.VO)(!0);if(e)(0,ee.O5)(e),m("platform"),h();else{const e=ee.b3.getSSOTokens();e&&e.access_token?(d(e),m("sso"),ee.b3.setSSOTokens({sso_access_token:e.access_token,sso_token_type:e.token_type,sso_expires_at:e.expires_at,sso_scope:e.scope,sso_provider:e.provider,sso_id_token:e.id_token}),o(!1)):o(!1)}const t=ee.b3.addListener((e,t)=>{if("sso_tokens_updated"===e){const e=t.tokens;d(e);!(0,ee.VO)(!1)&&e&&e.access_token&&m("sso")}else"sso_tokens_cleared"===e&&(d(null),"sso"===u&&(m(null),r(!1),n(null)))});return()=>{t()}},[]);const x=()=>{(0,ee.QF)(),n(null),r(!1),o(!1),d(null),m(null),ee.b3.clearSSOTokens()},h=async()=>{try{o(!0);const e=await le.getCurrentUser(s);return window.FS&&window.FS("setIdentity",{uid:e.id,properties:{displayName:e.full_name||e.email,email:e.email}}),n(e),r(!0),o(!1),e}catch(e){o(!1),x()}},p=()=>c||ee.b3.getSSOTokens();return(0,se.jsx)(ae.Provider,{value:{user:a,isAuthenticated:l,logout:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(x(),r(!1),n(null),e){const e=encodeURIComponent(window.location.href);window.location.href="/login?from_url="+e}},isLoadingAuth:i,updateUser:e=>{n(e)},ssoTokens:c,authMethod:u,loginWithSSO:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=window.location.href,a="/api/apps/".concat(s,"/auth/sso/login?from_url=").concat(encodeURIComponent(t),"&include_external_tokens=").concat(e);window.location.href=a},getSSOTokens:p,getSSOAuthHeader:()=>{const e=p();return e&&e.access_token?{Authorization:"".concat(e.token_type," ").concat(e.access_token)}:null},fetchWithSSO:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ee.b3.fetchWithSSO(e,t)},clearSSOTokens:()=>{ee.b3.clearSSOTokens(),d(null)}},children:t})},ie=()=>(0,Y.useContext)(ae);var oe=s(72004),ce=s(79800);function de(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,ce.QP)((0,oe.$)(t))}var ue=s(89379),me=s(73215);function xe(){const e=window.location.hostname;if(e.startsWith("checkpoint--")){const t=e.split("--");if(t.length>=3){return t[2].split(".")[0]}}return e.startsWith("preview--")?"preview":"prod"}function he(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};class n extends te.y{constructor(){super(),this.axios.interceptors.response.use(e=>e,e=>{var a,n;const l="error trying to call ".concat(t.name," entity api: ").concat(e.config.url);let r=e.config.data;try{"string"!=typeof r&&(r=JSON.stringify(r)),r&&r.length>1e3&&(r=r.substring(0,997)+"...")}catch(u){r=String(r)}let i="";try{var o;i=JSON.stringify(null===(o=e.response)||void 0===o?void 0:o.data),i&&i.length>1e3&&(i=i.substring(0,997)+"...")}catch(u){var c;i=String((null===(c=e.response)||void 0===c?void 0:c.data)||"")}const d="When using the app, on url ".concat(window.location.href," the following entity api call failed: \nentity: ").concat(t.name,"\nurl: ").concat(e.config.baseURL).concat(e.config.url,"\nmethod: ").concat(e.config.method,"\ndata: ").concat(r,"\nerror:").concat((null===(a=e.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||e.message,"\nfulljson:").concat(i);return s(l,d),Promise.reject(e)})}getBaseURL(){return"https://base44.app/api"+"/apps/".concat(e,"/entities/").concat(t.name)}getClient(){return(0,me.Ay)(this.getBaseURL(),a,!0,!0)}schema(){return t}bulkCreate(e){return this.axios.post("/bulk",e)}importEntities(e){const t=new FormData;return t.append("file",e,e.name),this.axios.post("/import",t,{headers:{"Content-Type":"multipart/form-data"}})}async listDeleted(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a={};return e&&Object.keys(e).length>0&&(a.q=JSON.stringify(e)),t&&(a.limit=t),s&&(a.skip=s),await this.axios.get("/trash",{params:a})}async restore(e){return await this.axios.put("/".concat(e,"/restore"))}async deletePermanently(e){return await this.axios.delete("/".concat(e,"/permanent"))}async restoreMany(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.axios.put("/trash/restore",e)}}return new n}function pe(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n={};return Object.keys(e.entities).forEach(s=>{n[s]=he(e.id,e.entities[s],t,a)}),n.User=he(e.id,e.user_entity,t,a),n.User.updateMyUserData=async function(e){return await s.updateMyUserData(e)},n.User.me=async function(){return await s.getMyUserInfo()},n.User.logout=async function(){return await s.logout()},n.User.login=async function(){return await s.login()},n.User.loginWithRedirect=async function(e){return await s.loginWithRedirect(e)},n.User.isUserAuthenticated=function(){return s.isUserAuthenticated()},n}async function ge(e,t){const s=(0,me.Ay)("https://base44.app/api"+"/apps/".concat(e,"/integration-endpoints"),{"X-App-Id":e},!0,!0),a=await s.get("/schema");let n={};return(a.installed_packages||a).forEach(e=>{n[e.package_name]=function(e,t,s){const a={};return t.endpoints.forEach(n=>{a[n.name]=async a=>{if("create_checkout_session"===n.name&&window.parent!==window&&alert("Note - you're creating a stripe checkout session, but stripe does not allow this to be done inside an iframe. Please use the publish button to test the checkout flow."),"string"==typeof a)throw new Error("Integration ".concat(n.name," must receive an object with named parameters, received: ").concat(a));try{let s,l;a instanceof FormData||a&&Object.values(a).some(e=>e instanceof File)?(s=new FormData,Object.keys(a).forEach(e=>{a[e]instanceof File?s.append(e,a[e],a[e].name):"object"==typeof a[e]&&null!==a[e]?s.append(e,JSON.stringify(a[e])):s.append(e,a[e])}),l="multipart/form-data"):(s=a,l="application/json");const r="Core"===t.package_name?"/Core/".concat(n.name):"/".concat(t.package_name,"/").concat(n.name),i=e.post(r,s||a,{headers:{"Content-Type":l}});return await i}catch(i){var l,r;throw s("Error calling integration ".concat(n.name,": ").concat((null===(l=i.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail)||i.message),"When using the app, the following integration call failed:\ninput parameters:\n".concat(JSON.stringify(a,null,2)),null,i),i}}}),a}(s,e,t)}),n.getMissingPackages=()=>a.missing_packages||[],n}var fe=s(23046);const ve=e=>{window.location.href=e},be=e=>{var t;"undefined"!=typeof navigator&&(t=navigator.userAgent,/LinkedIn|Twitter/i.test(t))?/Android/i.test(navigator.userAgent)?ve((e=>{const t=e.match(/^(https?):\/\//),s=t?t[1]:"https",a=e.replace(/^https?:\/\//,"").replace(/#/g,"%23"),n=encodeURIComponent(e);return"intent://".concat(a,"#Intent;scheme=").concat(s,";package=com.android.chrome;S.browser_fallback_url=").concat(n,";end")})(e)):/iPhone|iPad|iPod/i.test(navigator.userAgent)?(e=>{const t=setTimeout(()=>ve(e),1e3);window.addEventListener("pagehide",()=>clearTimeout(t),{once:!0}),ve("x-safari-".concat(e))})(e):ve(e):ve(e)};function je(e,t,s){class a extends te.y{getBaseURL(){return"https://base44.app/api"+"/apps/".concat(e)}inviteUser(e,t){return this.axios.post("/users/invite-user",{user_email:e,role:t})}getMyUserInfo(){return this.axios.get("/entities/User/me")}updateMyUserData(e){return this.axios.put("/entities/User/me",e)}async logout(){s.logout(!1),window.location.reload()}async login(){const t=window.location.href,s="".concat((0,fe.Zk)(),"/apps/auth/login?from_url=").concat(t,"&app_id=").concat(e);be(s)}async loginWithRedirect(e){const t=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);window.location.href="".concat(t,"login?from_url=").concat(encodeURIComponent(e))}isUserAuthenticated(){return s.isUserAuthenticated()}register(e){return this.axios.post("/auth/register",e)}verifyOtp(e,t){return this.axios.post("/auth/verify-otp",{email:e,otp_code:t})}resendOtp(e){return this.axios.post("/auth/resend-otp",{email:e})}verifyAccessRequestOtp(e,t){return this.axios.post("/access-requests/verify-otp",{email:e,otp_code:t})}resendAccessRequestOtp(e){return this.axios.post("/access-requests/resend-otp",{email:e})}loginViaUsernamePassword(e,t){return this.axios.post("/auth/login",{email:e,password:t})}resetPasswordRequest(e){return this.axios.post("/auth/reset-password-request",{email:e},{headers:{"X-Origin-Host":window.location.hostname}})}resetPassword(e,t){return this.axios.post("/auth/reset-password",{reset_token:e,new_password:t})}changePassword(e,t,s){return this.axios.post("/auth/change-password",{user_id:e,current_password:t,new_password:s})}}return new a(t)}function ye(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=xe(),n=(0,ue.A)({"Base44-Functions-Version":a},s),l=(0,me.Ay)("https://base44.app/api"+"/apps/".concat(e.id,"/functions"),n,!0,!1,!1);t=t||(e=>{}),l.interceptors.response.use(e=>e,e=>{const s="error trying to call function: ".concat(e.config.url);let a=e.config.data;try{"string"!=typeof a&&(a=JSON.stringify(a)),a&&a.length>1e3&&(a=a.substring(0,997)+"...")}catch(i){a=String(a)}let n="";try{var l;null!==(l=e.response)&&void 0!==l&&l.data?(n="object"==typeof e.response.data?JSON.stringify(e.response.data):String(e.response.data),n.length>1e3&&(n=n.substring(0,997)+"...")):n=e.message||"Unknown error"}catch(i){n=String(e)||"Unknown error"}const r="When using the app, on url ".concat(window.location.href," the following function call failed: \nurl: ").concat(e.config.baseURL).concat(e.config.url,"\nmethod: ").concat(e.config.method,"\ndata: ").concat(a,"\nerror: ").concat(n);return t(s,r),Promise.reject(e)});let r={};return(e.function_names||Object.keys(e.functions||{})).forEach(e=>{r[e]=async t=>await l.post("/".concat(e),t||{})}),r}var Ne=s(69783);let we=null;const _e=function(e,t){class s extends Ne.A{getMountPath(){return"/ws-user-apps/socket.io/"}getSocketQuery(){let s=super.getSocketQuery();return t&&(s.token=t),s.app_id=e,s}}return we||(we=new s),we};var ke=s(76976);const Ce={};function Ae(e,t,s){class a extends te.y{constructor(){super(),this.socketManager=_e(e,t),this.axios.interceptors.response.use(e=>e,e=>{var t,a;return s((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message),Promise.reject(e)})}getClient(){return t?(0,me.Ay)(this.getBaseURL(),{Authorization:"Bearer ".concat(t)}):super.getClient()}getBaseURL(){return"https://base44.app/api"+"/apps/".concat(e,"/agents")}getConversations(){return this.axios.get("/conversations")}getConversation(e){return this.axios.get("/conversations/".concat(e))}listConversations(e){return this.axios.get("/conversations",{params:e})}createConversation(e){return this.axios.post("/conversations",e)}addMessage(e,t){return this.axios.post("/conversations/v2/".concat(e.id,"/messages"),t)}getWhatsAppConnectURL(s){const a="".concat("https://base44.app","/api/apps/").concat(e,"/agents/").concat(encodeURIComponent(s),"/whatsapp"),n=null!=t?t:ke.A.getToken();return n?"".concat(a,"?token=").concat(n):a}subscribeToConversation(e,t){const s=this.getConversation(e).then(e=>{const{id:t}=e;Ce[t]=e});return this.socketManager.addListener("/agent-conversations/".concat(e),async a=>{if(await s,!a._message)return;const n=a._message,l=Ce[e],r=l.messages.findIndex(e=>e.id===n.id),i=r>=0?l.messages.map((e,t)=>t===r?n:e):[...l.messages,n],o=(0,ue.A)((0,ue.A)({},l),{},{messages:i});Ce[e]=o,t(o)})}}return new a}async function Se(e){const t=(0,me.Ay)("https://base44.app/api/apps/public",{"X-App-Id":e.id,"X-App-Slug":e.slug});if(!e.id&&!e.slug)throw new Error("Either id or slug must be provided");let s;s=e.slug?await t.get("/prod/by-slug/".concat(e.slug)):await t.get("/prod/by-id/".concat(e.id));const a=xe(),n={};n["api/base44Client.js"]="import { createClient } from '@base44/sdk';\n\nexport const base44 = createClient({\n  appId: \"".concat(s.id,'",\n  serverUrl: "').concat("https://base44.app",'",\n  functionsVersion: "').concat(a,'"\n});\n');const l=(t,a,n,l)=>{let r=n;if(a&&"string"==typeof a){const e=a.match(/at\s+(\w+)\s+/);if(e&&e[1]){const t=e[1];if(s.components&&s.components[t])r=t;else if(s.pages&&s.pages[t])r=t;else{for(const e in s.components||{})if(s.components[e].includes("function ".concat(t))){r=e;break}for(const e in s.pages||{})if(s.pages[e].includes("function ".concat(t))){r=e;break}}}}e.onError(t,a,r,l)},r=je(s.id,l,e.authProps),i=pe(s,l,r),o=await ge(s.id,l),c=ye(s,l),d=Ae(s.id,void 0,l);return{appId:s.id,files:(0,ue.A)((0,ue.A)({},s),{},{coreFiles:n}),entities:i,integrations:o,functions:c,users:r,agents:d,getCurrentPage:()=>function(e){let t=window.location.pathname;t.endsWith("/")&&(t=t.slice(0,-1));let s=t.split("/").pop();return s.includes("?")&&(s=s.split("?")[0]),Object.keys(e.pages).map(e=>e.toLowerCase()).includes(s.toLowerCase())?{name:s,code:e.pages[s]}:s===e.slug||s===e.id||"preview"===s||""===s?{name:e.main_page,code:e.pages[e.main_page]}:null}(s),createPageUrl:(e,t)=>((e,t,s)=>{const a=window.location.hostname;return!["localhost","base44.com","base44.app","app.base44.com","base44.onrender.com","apper-test.onrender.com","beta-base44.onrender.com","base44.io","ba11.me","ba22.me","ba33.me"].includes(a)||a.startsWith("app--")||a.startsWith("preview--")?s&&"object"==typeof s?"/".concat(t,"?").concat(Object.keys(s).map(e=>"".concat(e,"=").concat(s[e])).join("&")):s&&"string"==typeof s?s.startsWith("?")?"/".concat(t).concat(s):"/".concat(t,"?").concat(s):"/".concat(t):s&&"object"==typeof s?"/apps-show/".concat(e.slug,"/").concat(t,"?").concat(Object.keys(s).map(e=>"".concat(e,"=").concat(s[e])).join("&")):s&&"string"==typeof s?s.startsWith("?")?"/apps-show/".concat(e.slug,"/").concat(t).concat(s):"/apps-show/".concat(e.slug,"/").concat(t,"?").concat(s):"/apps-show/".concat(e.slug,"/").concat(t)})(s,e,t),options:(0,ue.A)((0,ue.A)({},e),{},{onError:l})}}var Ee=s(37906),Te=s(52536),Ie=s(83817),Pe=s(4940),Le=s(36876);function Me(e){let t=!1;function s(e){!function(e){if(Le.isJSXExpressionContainer(e)){const t=e.expression;if(Le.isJSXEmptyExpression(t))return!1;if(!Le.isLiteral(t))return!0}if(Le.isTemplateLiteral(e)&&e.expressions.length>0)return!0;if(Le.isMemberExpression(e))return!0;if(Le.isCallExpression(e))return!0;if(Le.isConditionalExpression(e))return!0;if(Le.isIdentifier(e)&&["props","state","data","item","value","text","content"].some(t=>e.name.includes(t)))return!0;return!1}(e)?Object.keys(e).forEach(t=>{const a=e[t];Array.isArray(a)?a.forEach(e=>{e&&"object"==typeof e&&e.type&&s(e)}):a&&"object"==typeof a&&a.type&&s(a)}):t=!0}return e.children.forEach(e=>{t||s(e)}),t}function Re(e,t){const s=function(e,t){e.includes(".")&&(e=e.split(".")[0]);try{const s=(0,Te.parse)(t,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","objectRestSpread","functionBind","exportDefaultFrom","exportNamespaceFrom","dynamicImport","nullishCoalescingOperator","optionalChaining","asyncGenerators","bigInt","optionalCatchBinding","throwExpressions"]});return(0,Ie.default)(s,{JSXElement(t){var s;const a=t.node,n=a.openingElement;if(Le.isJSXFragment(a))return;if(n.attributes.some(e=>Le.isJSXAttribute(e)&&Le.isJSXIdentifier(e.name)&&"data-source-location"===e.name.name))return;const{line:l,column:r}=(null===(s=n.loc)||void 0===s?void 0:s.start)||{line:1,column:0},i=Le.jsxAttribute(Le.jsxIdentifier("data-source-location"),Le.stringLiteral("".concat(e,":").concat(l,":").concat(r))),o=Me(a),c=Le.jsxAttribute(Le.jsxIdentifier("data-dynamic-content"),Le.stringLiteral(o?"true":"false"));n.attributes.unshift(i,c)}}),{code:(0,Pe.default)(s,{retainLines:!0,compact:!1,concise:!1}).code,success:!0}}catch(s){return{code:t,success:!1,error:s instanceof Error?s.message:"Unknown error"}}}(e,t);return s.code}function De(){const e="preview_";return{getItem:t=>localStorage.getItem(e+t),setItem:(t,s)=>localStorage.setItem(e+t,s),removeItem:t=>localStorage.removeItem(e+t)}}function Fe(e){(e.startsWith("./")||e.startsWith("@/"))&&(e=e.substring(2));const t=e.split("/"),s=[];for(const n of t)".."===n?s.pop():"."!==n&&s.push(n);let a=s.join("/");return/\.\w+$/.test(a)||(a+=".js"),a}function Oe(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={get(t,a){if(!t.hasOwnProperty(a)&&"PropTypes"!==a&&"__esModule"!==a&&a.charAt(0)===a.charAt(0).toUpperCase()){if("function"==typeof t&&a.charAt(0)===a.charAt(0).toUpperCase())return t;if(!s&&a===e.split("/").pop().split(".")[0]&&t.default)return t.default;throw new Error("'".concat(a,"' does not exist in module: ").concat(e))}return t[a]}};return new Proxy(t,a)}function Ue(e,t,s){try{const a=crypto.randomUUID?crypto.randomUUID():Date.now().toString();window.parent.postMessage({type:"console-log",logId:a,data:{message:"object"==typeof e?JSON.stringify(e):e,severity:t,component:s}},"*")}catch(a){}}function Be(e,t){const s="[".concat(e,"]");return{log:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];window.console.log(s,...a);Ue(a.map(e=>"object"==typeof e?JSON.stringify(e):String(e)).join(" "),"log",e)},error:function(){for(var a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];window.console.error(s,...n);const r=n.find(e=>e instanceof Error),i=n.map(e=>(null==e?void 0:e.message)||(null==e?void 0:e.toString())).join(" - "),o={title:i,details:i,originalError:r,componentName:e};t(o.title,o.details,o.componentName,o.originalError),Ue(i,"error",e)},warn:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];window.console.warn(s,...a);Ue(a.map(e=>"object"==typeof e?JSON.stringify(e):String(e)).join(" "),"warn",e)}}}var ze=s(59051),He=s.n(ze),Ve=s(84079),We=s(94048),qe=s(93204),Ye=s(86991),Ge=s(79476),Ke=s(8849),$e=s(35254),Ze=s.n($e),Je=s(51797),Qe=s(2527),Xe=s(99603),et=s(32033),tt=s(39181),st=s(36995),at=s(22180),nt=s(92962),lt=s(37970),rt=s(29037),it=s(89942),ot=s(19909),ct=s(78237),dt=s(61611),ut=s(59222),mt=s(41443),xt=s(24082),ht=s(87113),pt=s(63653),gt=s(59710),ft=s(94364),vt=s(97202),bt=s(65604),jt=(s(55392),s(56687)),yt=s(9449),Nt=(s(17687),s(53986)),wt=s(39040),_t=s(27453);const kt=["className"],Ct=["className","children"],At=["className","children"],St=wt.bL,Et=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,kt);return(0,se.jsx)(wt.q7,(0,ue.A)({ref:t,className:de("border-b",s)},a))});Et.displayName="AccordionItem";const Tt=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,Ct);return(0,se.jsx)(wt.Y9,{className:"flex",children:(0,se.jsxs)(wt.l9,(0,ue.A)((0,ue.A)({ref:t,className:de("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s)},n),{},{children:[a,(0,se.jsx)(_t.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]}))})});Tt.displayName=wt.l9.displayName;const It=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,At);return(0,se.jsx)(wt.UC,(0,ue.A)((0,ue.A)({ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"},n),{},{children:(0,se.jsx)("div",{className:de("pb-4 pt-0",s),children:a})}))});It.displayName=wt.UC.displayName;const Pt=["className","variant"],Lt=["className"],Mt=["className"],Rt=(0,ft.cva)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Dt=Y.forwardRef((e,t)=>{let{className:s,variant:a}=e,n=(0,Nt.A)(e,Pt);return(0,se.jsx)("div",(0,ue.A)({ref:t,role:"alert",className:de(Rt({variant:a}),s)},n))});Dt.displayName="Alert";const Ft=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Lt);return(0,se.jsx)("h5",(0,ue.A)({ref:t,className:de("mb-1 font-medium leading-none tracking-tight",s)},a))});Ft.displayName="AlertTitle";const Ot=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Mt);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("text-sm [&_p]:leading-relaxed",s)},a))});Ot.displayName="AlertDescription";const Ut=["className","variant","size","asChild"],Bt=(0,ft.cva)("inline-flex items-center justify-center gap-1 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-3 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),zt=Y.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:l=!1}=e,r=(0,Nt.A)(e,Ut);const i=l?nt.Slot:"button";return(0,se.jsx)(i,(0,ue.A)({className:de(Bt({variant:a,size:n,className:s})),ref:t},r))});zt.displayName="Button";const Ht=["className"],Vt=["className"],Wt=["className"],qt=["className"],Yt=["className"],Gt=["className"],Kt=["className"],$t=["className"],Zt=ot.Root,Jt=ot.Trigger,Qt=ot.Portal,Xt=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ht);return(0,se.jsx)(ot.Overlay,(0,ue.A)((0,ue.A)({className:de("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},a),{},{ref:t}))});Xt.displayName=ot.Overlay.displayName;const es=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Vt);return(0,se.jsxs)(Qt,{children:[(0,se.jsx)(Xt,{}),(0,se.jsx)(ot.Content,(0,ue.A)({ref:t,className:de("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},a))]})});es.displayName=ot.Content.displayName;const ts=e=>{let{className:t}=e,s=(0,Nt.A)(e,Wt);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col space-y-2 text-center sm:text-left",t)},s))};ts.displayName="AlertDialogHeader";const ss=e=>{let{className:t}=e,s=(0,Nt.A)(e,qt);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};ss.displayName="AlertDialogFooter";const as=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Yt);return(0,se.jsx)(ot.Title,(0,ue.A)({ref:t,className:de("text-lg font-semibold",s)},a))});as.displayName=ot.Title.displayName;const ns=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Gt);return(0,se.jsx)(ot.Description,(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});ns.displayName=ot.Description.displayName;const ls=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Kt);return(0,se.jsx)(ot.Action,(0,ue.A)({ref:t,className:de(Bt(),s)},a))});ls.displayName=ot.Action.displayName;const rs=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,$t);return(0,se.jsx)(ot.Cancel,(0,ue.A)({ref:t,className:de(Bt({variant:"outline"}),"mt-2 sm:mt-0",s)},a))});rs.displayName=ot.Cancel.displayName;const is=s(7239).b,os=["className"],cs=["className"],ds=["className"],us=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,os);return(0,se.jsx)(ht.Root,(0,ue.A)({ref:t,className:de("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s)},a))});us.displayName=ht.Root.displayName;const ms=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,cs);return(0,se.jsx)(ht.Image,(0,ue.A)({ref:t,className:de("aspect-square h-full w-full",s)},a))});ms.displayName=ht.Image.displayName;const xs=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ds);return(0,se.jsx)(ht.Fallback,(0,ue.A)({ref:t,className:de("flex h-full w-full items-center justify-center rounded-full bg-muted",s)},a))});xs.displayName=ht.Fallback.displayName;const hs=["className","variant"],ps=(0,ft.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function gs(e){let{className:t,variant:s}=e,a=(0,Nt.A)(e,hs);return(0,se.jsx)("div",(0,ue.A)({className:de(ps({variant:s}),t)},a))}var fs=s(20454),vs=s(68108),bs=s(90983),js=s(53938);const ys=["className","classNames","showOutsideDays"];function Ns(e){let{className:t,classNames:s,showOutsideDays:a=!0}=e,n=(0,Nt.A)(e,ys);return(0,se.jsx)(js.hv,(0,ue.A)({showOutsideDays:a,className:de("p-3",t),classNames:(0,ue.A)({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:de(Bt({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:de(Bt({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible"},s),components:{IconLeft:e=>{Object.assign({},((0,fs.A)(e),e));return(0,se.jsx)(vs.A,{className:"h-4 w-4"})},IconRight:e=>{Object.assign({},((0,fs.A)(e),e));return(0,se.jsx)(bs.A,{className:"h-4 w-4"})}}},n))}Ns.displayName="Calendar";const ws=["className"],_s=["className"],ks=["className"],Cs=["className"],As=["className"],Ss=["className"],Es=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ws);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("rounded-lg border bg-card text-card-foreground shadow-sm",s)},a))});Es.displayName="Card";const Ts=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,_s);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("flex flex-col space-y-1.5 p-6",s)},a))});Ts.displayName="CardHeader";const Is=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ks);return(0,se.jsx)("h3",(0,ue.A)({ref:t,className:de("text-2xl font-semibold leading-none tracking-tight",s)},a))});Is.displayName="CardTitle";const Ps=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Cs);return(0,se.jsx)("p",(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});Ps.displayName="CardDescription";const Ls=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,As);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("p-6 pt-0",s)},a))});Ls.displayName="CardContent";const Ms=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ss);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("flex items-center p-6 pt-0",s)},a))});Ms.displayName="CardFooter";var Rs=s(20939),Ds=s(86311);const Fs=["className"],Os=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Fs);return(0,se.jsx)(Rs.bL,(0,ue.A)((0,ue.A)({ref:t,className:de("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s)},a),{},{children:(0,se.jsx)(Rs.C1,{className:de("flex items-center justify-center text-current"),children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}))});Os.displayName=Rs.bL.displayName;const Us=xt.Root,Bs=xt.CollapsibleTrigger,zs=xt.CollapsibleContent;var Hs=s(55421),Vs=s(45462),Ws=s(52257);const qs=["orientation","opts","setApi","plugins","className","children"],Ys=["className"],Gs=["className"],Ks=["className","variant","size"],$s=["className","variant","size"],Zs=Y.createContext(null);function Js(){const e=Y.useContext(Zs);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const Qs=Y.forwardRef((e,t)=>{let{orientation:s="horizontal",opts:a,setApi:n,plugins:l,className:r,children:i}=e,o=(0,Nt.A)(e,qs);const[c,d]=(0,Hs.A)((0,ue.A)((0,ue.A)({},a),{},{axis:"horizontal"===s?"x":"y"}),l),[u,m]=Y.useState(!1),[x,h]=Y.useState(!1),p=Y.useCallback(e=>{e&&(m(e.canScrollPrev()),h(e.canScrollNext()))},[]),g=Y.useCallback(()=>{null==d||d.scrollPrev()},[d]),f=Y.useCallback(()=>{null==d||d.scrollNext()},[d]),v=Y.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),g()):"ArrowRight"===e.key&&(e.preventDefault(),f())},[g,f]);return Y.useEffect(()=>{d&&n&&n(d)},[d,n]),Y.useEffect(()=>{if(d)return p(d),d.on("reInit",p),d.on("select",p),()=>{null==d||d.off("select",p)}},[d,p]),(0,se.jsx)(Zs.Provider,{value:{carouselRef:c,api:d,opts:a,orientation:s||("y"===(null==a?void 0:a.axis)?"vertical":"horizontal"),scrollPrev:g,scrollNext:f,canScrollPrev:u,canScrollNext:x},children:(0,se.jsx)("div",(0,ue.A)((0,ue.A)({ref:t,onKeyDownCapture:v,className:de("relative",r),role:"region","aria-roledescription":"carousel"},o),{},{children:i}))})});Qs.displayName="Carousel";const Xs=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ys);const{carouselRef:n,orientation:l}=Js();return(0,se.jsx)("div",{ref:n,className:"overflow-hidden",children:(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("flex","horizontal"===l?"-ml-4":"-mt-4 flex-col",s)},a))})});Xs.displayName="CarouselContent";const ea=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Gs);const{orientation:n}=Js();return(0,se.jsx)("div",(0,ue.A)({ref:t,role:"group","aria-roledescription":"slide",className:de("min-w-0 shrink-0 grow-0 basis-full","horizontal"===n?"pl-4":"pt-4",s)},a))});ea.displayName="CarouselItem";const ta=Y.forwardRef((e,t)=>{let{className:s,variant:a="outline",size:n="icon"}=e,l=(0,Nt.A)(e,Ks);const{orientation:r,scrollPrev:i,canScrollPrev:o}=Js();return(0,se.jsxs)(zt,(0,ue.A)((0,ue.A)({ref:t,variant:a,size:n,className:de("absolute  h-8 w-8 rounded-full","horizontal"===r?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:i},l),{},{children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Previous slide"})]}))});ta.displayName="CarouselPrevious";const sa=Y.forwardRef((e,t)=>{let{className:s,variant:a="outline",size:n="icon"}=e,l=(0,Nt.A)(e,$s);const{orientation:r,scrollNext:i,canScrollNext:o}=Js();return(0,se.jsxs)(zt,(0,ue.A)((0,ue.A)({ref:t,variant:a,size:n,className:de("absolute h-8 w-8 rounded-full","horizontal"===r?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:i},l),{},{children:[(0,se.jsx)(Ws.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Next slide"})]}))});sa.displayName="CarouselNext";var aa=s(34079),na=s(13147),la=s(96479);const ra=["className"],ia=["className","children"],oa=["className"],ca=["className"],da=["className"],ua=["className"],ma=gt.Root,xa=gt.Trigger,ha=gt.Portal,pa=gt.Close,ga=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ra);return(0,se.jsx)(gt.Overlay,(0,ue.A)({ref:t,className:de("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},a))});ga.displayName=gt.Overlay.displayName;const fa=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,ia);return(0,se.jsxs)(ha,{children:[(0,se.jsx)(ga,{}),(0,se.jsxs)(gt.Content,(0,ue.A)((0,ue.A)({ref:t,className:de("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},n),{},{children:[a,(0,se.jsxs)(gt.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,se.jsx)(la.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});fa.displayName=gt.Content.displayName;const va=e=>{let{className:t=""}=e,s=(0,Nt.A)(e,oa);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col space-y-1.5 text-center sm:text-left",t)},s))};va.displayName="DialogHeader";const ba=e=>{let{className:t}=e,s=(0,Nt.A)(e,ca);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};ba.displayName="DialogFooter";const ja=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,da);return(0,se.jsx)(gt.Title,(0,ue.A)({ref:t,className:de("text-lg font-semibold leading-none tracking-tight",s)},a))});ja.displayName=gt.Title.displayName;const ya=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ua);return(0,se.jsx)(gt.Description,(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});ya.displayName=gt.Description.displayName;const Na=["className"],wa=["children"],_a=["className"],ka=["className"],Ca=["className"],Aa=["className"],Sa=["className"],Ea=["className"],Ta=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Na);return(0,se.jsx)(aa.uB,(0,ue.A)({ref:t,className:de("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s)},a))});Ta.displayName=aa.uB.displayName;const Ia=e=>{let{children:t}=e,s=(0,Nt.A)(e,wa);return(0,se.jsx)(ma,(0,ue.A)((0,ue.A)({},s),{},{children:(0,se.jsx)(fa,{className:"overflow-hidden p-0 shadow-lg",children:(0,se.jsx)(Ta,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:t})})}))},Pa=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,_a);return(0,se.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,se.jsx)(na.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,se.jsx)(aa.uB.Input,(0,ue.A)({ref:t,className:de("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s)},a))]})});Pa.displayName=aa.uB.Input.displayName;const La=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ka);return(0,se.jsx)(aa.uB.List,(0,ue.A)({ref:t,className:de("max-h-[300px] overflow-y-auto overflow-x-hidden",s)},a))});La.displayName=aa.uB.List.displayName;const Ma=Y.forwardRef((e,t)=>(0,se.jsx)(aa.uB.Empty,(0,ue.A)({ref:t,className:"py-6 text-center text-sm"},e)));Ma.displayName=aa.uB.Empty.displayName;const Ra=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ca);return(0,se.jsx)(aa.uB.Group,(0,ue.A)({ref:t,className:de("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s)},a))});Ra.displayName=aa.uB.Group.displayName;const Da=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Aa);return(0,se.jsx)(aa.uB.Separator,(0,ue.A)({ref:t,className:de("-mx-1 h-px bg-border",s)},a))});Da.displayName=aa.uB.Separator.displayName;const Fa=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Sa);return(0,se.jsx)(aa.uB.Item,(0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",s)},a))});Fa.displayName=aa.uB.Item.displayName;const Oa=e=>{let{className:t}=e,s=(0,Nt.A)(e,Ea);return(0,se.jsx)("span",(0,ue.A)({className:de("ml-auto text-xs tracking-widest text-muted-foreground",t)},s))};Oa.displayName="CommandShortcut";var Ua=s(21984),Ba=s(48056);const za=["className","inset","children"],Ha=["className"],Va=["className"],Wa=["className","inset"],qa=["className","children","checked"],Ya=["className","children"],Ga=["className","inset"],Ka=["className"],$a=["className"],Za=Ua.bL,Ja=Ua.l9,Qa=Ua.YJ,Xa=Ua.ZL,en=Ua.Pb,tn=Ua.z6,sn=Y.forwardRef((e,t)=>{let{className:s,inset:a,children:n}=e,l=(0,Nt.A)(e,za);return(0,se.jsxs)(Ua.ZP,(0,ue.A)((0,ue.A)({ref:t,className:de("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",a&&"pl-8",s)},l),{},{children:[n,(0,se.jsx)(bs.A,{className:"ml-auto h-4 w-4"})]}))});sn.displayName=Ua.ZP.displayName;const an=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ha);return(0,se.jsx)(Ua.G5,(0,ue.A)({ref:t,className:de("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},a))});an.displayName=Ua.G5.displayName;const nn=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Va);return(0,se.jsx)(Ua.ZL,{children:(0,se.jsx)(Ua.UC,(0,ue.A)({ref:t,className:de("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},a))})});nn.displayName=Ua.UC.displayName;const ln=Y.forwardRef((e,t)=>{let{className:s,inset:a}=e,n=(0,Nt.A)(e,Wa);return(0,se.jsx)(Ua.q7,(0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s)},n))});ln.displayName=Ua.q7.displayName;const rn=Y.forwardRef((e,t)=>{let{className:s,children:a,checked:n}=e,l=(0,Nt.A)(e,qa);return(0,se.jsxs)(Ua.H_,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n},l),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(Ua.VF,{children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}),a]}))});rn.displayName=Ua.H_.displayName;const on=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,Ya);return(0,se.jsxs)(Ua.hN,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s)},n),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(Ua.VF,{children:(0,se.jsx)(Ba.A,{className:"h-2 w-2 fill-current"})})}),a]}))});on.displayName=Ua.hN.displayName;const cn=Y.forwardRef((e,t)=>{let{className:s,inset:a}=e,n=(0,Nt.A)(e,Ga);return(0,se.jsx)(Ua.JU,(0,ue.A)({ref:t,className:de("px-2 py-1.5 text-sm font-semibold text-foreground",a&&"pl-8",s)},n))});cn.displayName=Ua.JU.displayName;const dn=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ka);return(0,se.jsx)(Ua.wv,(0,ue.A)({ref:t,className:de("-mx-1 my-1 h-px bg-border",s)},a))});dn.displayName=Ua.wv.displayName;const un=e=>{let{className:t}=e,s=(0,Nt.A)(e,$a);return(0,se.jsx)("span",(0,ue.A)({className:de("ml-auto text-xs tracking-widest text-muted-foreground",t)},s))};un.displayName="ContextMenuShortcut";const mn=["className","inset","children"],xn=["className"],hn=["className","sideOffset"],pn=["className","inset"],gn=["className","children","checked"],fn=["className","children"],vn=["className","inset"],bn=["className"],jn=["className"],yn=pt.Root,Nn=pt.Trigger,wn=pt.Group,_n=pt.Portal,kn=pt.Sub,Cn=pt.RadioGroup,An=Y.forwardRef((e,t)=>{let{className:s,inset:a,children:n}=e,l=(0,Nt.A)(e,mn);return(0,se.jsxs)(pt.SubTrigger,(0,ue.A)((0,ue.A)({ref:t,className:de("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",s)},l),{},{children:[n,(0,se.jsx)(bs.A,{className:"ml-auto h-4 w-4"})]}))});An.displayName=pt.SubTrigger.displayName;const Sn=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,xn);return(0,se.jsx)(pt.SubContent,(0,ue.A)({ref:t,className:de("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},a))});Sn.displayName=pt.SubContent.displayName;const En=Y.forwardRef((e,t)=>{let{className:s,sideOffset:a=4}=e,n=(0,Nt.A)(e,hn);return(0,se.jsx)(pt.Portal,{children:(0,se.jsx)(pt.Content,(0,ue.A)({ref:t,sideOffset:a,className:de("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},n))})});En.displayName=pt.Content.displayName;const Tn=Y.forwardRef((e,t)=>{let{className:s,inset:a}=e,n=(0,Nt.A)(e,pn);return(0,se.jsx)(pt.Item,(0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s)},n))});Tn.displayName=pt.Item.displayName;const In=Y.forwardRef((e,t)=>{let{className:s,children:a,checked:n}=e,l=(0,Nt.A)(e,gn);return(0,se.jsxs)(pt.CheckboxItem,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n},l),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(pt.ItemIndicator,{children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}),a]}))});In.displayName=pt.CheckboxItem.displayName;const Pn=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,fn);return(0,se.jsxs)(pt.RadioItem,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s)},n),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(pt.ItemIndicator,{children:(0,se.jsx)(Ba.A,{className:"h-2 w-2 fill-current"})})}),a]}))});Pn.displayName=pt.RadioItem.displayName;const Ln=Y.forwardRef((e,t)=>{let{className:s,inset:a}=e,n=(0,Nt.A)(e,vn);return(0,se.jsx)(pt.Label,(0,ue.A)({ref:t,className:de("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s)},n))});Ln.displayName=pt.Label.displayName;const Mn=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,bn);return(0,se.jsx)(pt.Separator,(0,ue.A)({ref:t,className:de("-mx-1 my-1 h-px bg-muted",s)},a))});Mn.displayName=pt.Separator.displayName;const Rn=e=>{let{className:t}=e,s=(0,Nt.A)(e,jn);return(0,se.jsx)("span",(0,ue.A)({className:de("ml-auto text-xs tracking-widest opacity-60",t)},s))};Rn.displayName="DropdownMenuShortcut";const Dn=["className"],Fn=(0,ft.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),On=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Dn);return(0,se.jsx)(dt.Root,(0,ue.A)({ref:t,className:de(Fn(),s)},a))});On.displayName=dt.Root.displayName;const Un=["className"],Bn=["className"],zn=["className"],Hn=["className","children"],Vn=yt.FormProvider,Wn=Y.createContext({}),qn=e=>{let t=Object.assign({},((0,fs.A)(e),e));return(0,se.jsx)(Wn.Provider,{value:{name:t.name},children:(0,se.jsx)(yt.Controller,(0,ue.A)({},t))})},Yn=()=>{const e=Y.useContext(Wn),t=Y.useContext(Gn),{getFieldState:s,formState:a}=(0,yt.useFormContext)(),n=s(e.name,a);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return(0,ue.A)({id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message")},n)},Gn=Y.createContext({}),Kn=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Un);const n=Y.useId();return(0,se.jsx)(Gn.Provider,{value:{id:n},children:(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("space-y-2",s)},a))})});Kn.displayName="FormItem";const $n=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Bn);const{error:n,formItemId:l}=Yn();return(0,se.jsx)(On,(0,ue.A)({ref:t,className:de(n&&"text-destructive",s),htmlFor:l},a))});$n.displayName="FormLabel";const Zn=Y.forwardRef((e,t)=>{let s=Object.assign({},((0,fs.A)(e),e));const{error:a,formItemId:n,formDescriptionId:l,formMessageId:r}=Yn();return(0,se.jsx)(nt.Slot,(0,ue.A)({ref:t,id:n,"aria-describedby":a?"".concat(l," ").concat(r):"".concat(l),"aria-invalid":!!a},s))});Zn.displayName="FormControl";const Jn=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,zn);const{formDescriptionId:n}=Yn();return(0,se.jsx)("p",(0,ue.A)({ref:t,id:n,className:de("text-sm text-muted-foreground",s)},a))});Jn.displayName="FormDescription";const Qn=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,Hn);const{error:l,formMessageId:r}=Yn(),i=l?String(null==l?void 0:l.message):a;return i?(0,se.jsx)("p",(0,ue.A)((0,ue.A)({ref:t,id:r,className:de("text-sm font-medium text-destructive",s)},n),{},{children:i})):null});Qn.displayName="FormMessage";const Xn=["className","align","sideOffset"],el=rt.Root,tl=rt.Trigger,sl=Y.forwardRef((e,t)=>{let{className:s,align:a="center",sideOffset:n=4}=e,l=(0,Nt.A)(e,Xn);return(0,se.jsx)(rt.Content,(0,ue.A)({ref:t,align:a,sideOffset:n,className:de("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},l))});sl.displayName=rt.Content.displayName;const al=["className","type"],nl=Y.forwardRef((e,t)=>{let{className:s,type:a}=e,n=(0,Nt.A)(e,al);return(0,se.jsx)("input",(0,ue.A)({type:a,className:de("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t},n))});nl.displayName="Input";var ll=s(55102);const rl=["className"],il=["className"],ol=["className","inset","children"],cl=["className"],dl=["className","align","alignOffset","sideOffset"],ul=["className","inset"],ml=["className","children","checked"],xl=["className","children"],hl=["className","inset"],pl=["className"],gl=["className"],fl=ll.W1,vl=ll.YJ,bl=ll.ZL,jl=ll.Pb,yl=ll.z6,Nl=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,rl);return(0,se.jsx)(ll.bL,(0,ue.A)({ref:t,className:de("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",s)},a))});Nl.displayName=ll.bL.displayName;const wl=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,il);return(0,se.jsx)(ll.l9,(0,ue.A)({ref:t,className:de("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",s)},a))});wl.displayName=ll.l9.displayName;const _l=Y.forwardRef((e,t)=>{let{className:s,inset:a,children:n}=e,l=(0,Nt.A)(e,ol);return(0,se.jsxs)(ll.ZP,(0,ue.A)((0,ue.A)({ref:t,className:de("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",a&&"pl-8",s)},l),{},{children:[n,(0,se.jsx)(bs.A,{className:"ml-auto h-4 w-4"})]}))});_l.displayName=ll.ZP.displayName;const kl=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,cl);return(0,se.jsx)(ll.G5,(0,ue.A)({ref:t,className:de("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},a))});kl.displayName=ll.G5.displayName;const Cl=Y.forwardRef((e,t)=>{let{className:s,align:a="start",alignOffset:n=-4,sideOffset:l=8}=e,r=(0,Nt.A)(e,dl);return(0,se.jsx)(ll.ZL,{children:(0,se.jsx)(ll.UC,(0,ue.A)({ref:t,align:a,alignOffset:n,sideOffset:l,className:de("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},r))})});Cl.displayName=ll.UC.displayName;const Al=Y.forwardRef((e,t)=>{let{className:s,inset:a}=e,n=(0,Nt.A)(e,ul);return(0,se.jsx)(ll.q7,(0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s)},n))});Al.displayName=ll.q7.displayName;const Sl=Y.forwardRef((e,t)=>{let{className:s,children:a,checked:n}=e,l=(0,Nt.A)(e,ml);return(0,se.jsxs)(ll.H_,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n},l),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(ll.VF,{children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}),a]}))});Sl.displayName=ll.H_.displayName;const El=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,xl);return(0,se.jsxs)(ll.hN,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s)},n),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(ll.VF,{children:(0,se.jsx)(Ba.A,{className:"h-2 w-2 fill-current"})})}),a]}))});El.displayName=ll.hN.displayName;const Tl=Y.forwardRef((e,t)=>{let{className:s,inset:a}=e,n=(0,Nt.A)(e,hl);return(0,se.jsx)(ll.JU,(0,ue.A)({ref:t,className:de("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s)},n))});Tl.displayName=ll.JU.displayName;const Il=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,pl);return(0,se.jsx)(ll.wv,(0,ue.A)({ref:t,className:de("-mx-1 my-1 h-px bg-muted",s)},a))});Il.displayName=ll.wv.displayName;const Pl=e=>{let{className:t}=e,s=(0,Nt.A)(e,gl);return(0,se.jsx)("span",(0,ue.A)({className:de("ml-auto text-xs tracking-widest text-muted-foreground",t)},s))};Pl.displayname="MenubarShortcut";var Ll=s(47624);const Ml=["className","children"],Rl=["className"],Dl=["className","children"],Fl=["className"],Ol=["className"],Ul=["className"],Bl=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,Ml);return(0,se.jsxs)(Ll.bL,(0,ue.A)((0,ue.A)({ref:t,className:de("relative z-10 flex max-w-max flex-1 items-center justify-center",s)},n),{},{children:[a,(0,se.jsx)(Gl,{})]}))});Bl.displayName=Ll.bL.displayName;const zl=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Rl);return(0,se.jsx)(Ll.B8,(0,ue.A)({ref:t,className:de("group flex flex-1 list-none items-center justify-center space-x-1",s)},a))});zl.displayName=Ll.B8.displayName;const Hl=Ll.q7,Vl=(0,ft.cva)("group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"),Wl=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,Dl);return(0,se.jsxs)(Ll.l9,(0,ue.A)((0,ue.A)({ref:t,className:de(Vl(),"group",s)},n),{},{children:[a," ",(0,se.jsx)(_t.A,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]}))});Wl.displayName=Ll.l9.displayName;const ql=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Fl);return(0,se.jsx)(Ll.UC,(0,ue.A)({ref:t,className:de("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",s)},a))});ql.displayName=Ll.UC.displayName;const Yl=Ll.N_,Gl=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ol);return(0,se.jsx)("div",{className:de("absolute left-0 top-full flex justify-center"),children:(0,se.jsx)(Ll.LM,(0,ue.A)({className:de("origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",s),ref:t},a))})});Gl.displayName=Ll.LM.displayName;const Kl=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ul);return(0,se.jsx)(Ll.C1,(0,ue.A)((0,ue.A)({ref:t,className:de("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",s)},a),{},{children:(0,se.jsx)("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md"})}))});Kl.displayName=Ll.C1.displayName;const $l=["className","align","sideOffset"],Zl=ct.Root,Jl=ct.Trigger,Ql=Y.forwardRef((e,t)=>{let{className:s,align:a="center",sideOffset:n=4}=e,l=(0,Nt.A)(e,$l);return(0,se.jsx)(ct.Portal,{children:(0,se.jsx)(ct.Content,(0,ue.A)({ref:t,align:a,sideOffset:n,className:de("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},l))})});Ql.displayName=ct.Content.displayName;var Xl=s(93757);const er=["className","value"],tr=Y.forwardRef((e,t)=>{let{className:s,value:a}=e,n=(0,Nt.A)(e,er);return(0,se.jsx)(Xl.bL,(0,ue.A)((0,ue.A)({ref:t,className:de("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s)},n),{},{children:(0,se.jsx)(Xl.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})}))});tr.displayName=Xl.bL.displayName;var sr=s(5995);const ar=["className"],nr=["className"],lr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ar);return(0,se.jsx)(sr.bL,(0,ue.A)((0,ue.A)({className:de("grid gap-2",s)},a),{},{ref:t}))});lr.displayName=sr.bL.displayName;const rr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,nr);return(0,se.jsx)(sr.q7,(0,ue.A)((0,ue.A)({ref:t,className:de("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s)},a),{},{children:(0,se.jsx)(sr.C1,{className:"flex items-center justify-center",children:(0,se.jsx)(Ba.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}))});rr.displayName=sr.q7.displayName;const ir=["className","children"],or=["className","orientation"],cr=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,ir);return(0,se.jsxs)(mt.Root,(0,ue.A)((0,ue.A)({ref:t,className:de("relative overflow-hidden",s)},n),{},{children:[(0,se.jsx)(mt.Viewport,{className:"h-full w-full rounded-[inherit]",children:a}),(0,se.jsx)(dr,{}),(0,se.jsx)(mt.Corner,{})]}))});cr.displayName=mt.Root.displayName;const dr=Y.forwardRef((e,t)=>{let{className:s,orientation:a="vertical"}=e,n=(0,Nt.A)(e,or);return(0,se.jsx)(mt.ScrollAreaScrollbar,(0,ue.A)((0,ue.A)({ref:t,orientation:a,className:de("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s)},n),{},{children:(0,se.jsx)(mt.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}))});dr.displayName=mt.ScrollAreaScrollbar.displayName;var ur=s(17684);const mr=["className","children","advancedDropdown"],xr=["className"],hr=["className"],pr=["className","children","position"],gr=["className"],fr=["className","children","hideCheckIcon"],vr=["className"],br=it.Root,jr=it.Group,yr=it.Value,Nr=Y.forwardRef((e,t)=>{let{className:s,children:a,advancedDropdown:n=!1}=e,l=(0,Nt.A)(e,mr);return(0,se.jsxs)(it.Trigger,(0,ue.A)((0,ue.A)({ref:t,className:de("flex h-10 w-full items-center justify-between ".concat(n?"rounded-lg":"rounded-md"," border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring  disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1"),s)},l),{},{children:[n?(0,se.jsx)("div",{className:"flex-1 min-w-0",children:a}):a,(0,se.jsx)(it.Icon,{asChild:!0,children:(0,se.jsx)(_t.A,{className:de("h-4 w-4 opacity-50",n?"flex-shrink-0 ml-2":"")})})]}))});Nr.displayName=it.Trigger.displayName;const wr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,xr);return(0,se.jsx)(it.ScrollUpButton,(0,ue.A)((0,ue.A)({ref:t,className:de("flex cursor-default items-center justify-center py-1",s)},a),{},{children:(0,se.jsx)(ur.A,{className:"h-4 w-4"})}))});wr.displayName=it.ScrollUpButton.displayName;const _r=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,hr);return(0,se.jsx)(it.ScrollDownButton,(0,ue.A)((0,ue.A)({ref:t,className:de("flex cursor-default items-center justify-center py-1",s)},a),{},{children:(0,se.jsx)(_t.A,{className:"h-4 w-4"})}))});_r.displayName=it.ScrollDownButton.displayName;const kr=Y.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper"}=e,l=(0,Nt.A)(e,pr);return(0,se.jsx)(it.Portal,{children:(0,se.jsxs)(it.Content,(0,ue.A)((0,ue.A)({ref:t,className:de("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n},l),{},{children:[(0,se.jsx)(wr,{}),(0,se.jsx)(it.Viewport,{className:de("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,se.jsx)(_r,{})]}))})});kr.displayName=it.Content.displayName;const Cr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,gr);return(0,se.jsx)(it.Label,(0,ue.A)({ref:t,className:de("py-1.5 pl-8 pr-2 text-sm font-semibold",s)},a))});Cr.displayName=it.Label.displayName;const Ar=Y.forwardRef((e,t)=>{let{className:s,children:a,hideCheckIcon:n=!1}=e,l=(0,Nt.A)(e,fr);return(0,se.jsxs)(it.Item,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n?"pl-2 pr-2":"pl-8 pr-2",s)},l),{},{children:[!n&&(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(it.ItemIndicator,{children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}),(0,se.jsx)(it.ItemText,{children:a})]}))});Ar.displayName=it.Item.displayName;const Sr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,vr);return(0,se.jsx)(it.Separator,(0,ue.A)({ref:t,className:de("-mx-1 my-1 h-px bg-muted",s)},a))});Sr.displayName=it.Separator.displayName;const Er=["className","orientation","decorative"],Tr=Y.forwardRef((e,t)=>{let{className:s,orientation:a="horizontal",decorative:n=!0}=e,l=(0,Nt.A)(e,Er);return(0,se.jsx)(at.Root,(0,ue.A)({ref:t,decorative:n,orientation:a,className:de("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",s)},l))});Tr.displayName=at.Root.displayName;const Ir=["className"],Pr=["side","className","children"],Lr=["className"],Mr=["className"],Rr=["className"],Dr=["className"],Fr=gt.Root,Or=gt.Trigger,Ur=gt.Close,Br=gt.Portal,zr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ir);return(0,se.jsx)(gt.Overlay,(0,ue.A)((0,ue.A)({className:de("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},a),{},{ref:t}))});zr.displayName=gt.Overlay.displayName;const Hr=(0,ft.cva)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Vr=Y.forwardRef((e,t)=>{let{side:s="right",className:a,children:n}=e,l=(0,Nt.A)(e,Pr);return(0,se.jsxs)(Br,{children:[(0,se.jsx)(zr,{}),(0,se.jsxs)(gt.Content,(0,ue.A)((0,ue.A)({ref:t,className:de(Hr({side:s}),a)},l),{},{children:[n,(0,se.jsxs)(gt.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,se.jsx)(la.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});Vr.displayName=gt.Content.displayName;const Wr=e=>{let{className:t}=e,s=(0,Nt.A)(e,Lr);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col space-y-2 text-center sm:text-left",t)},s))};Wr.displayName="SheetHeader";const qr=e=>{let{className:t}=e,s=(0,Nt.A)(e,Mr);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};qr.displayName="SheetFooter";const Yr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Rr);return(0,se.jsx)(gt.Title,(0,ue.A)({ref:t,className:de("text-lg font-semibold text-foreground",s)},a))});Yr.displayName=gt.Title.displayName;const Gr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Dr);return(0,se.jsx)(gt.Description,(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});Gr.displayName=gt.Description.displayName;const Kr=["className"];function $r(e){let{className:t}=e,s=(0,Nt.A)(e,Kr);return(0,se.jsx)("div",(0,ue.A)({className:de("animate-pulse rounded-md bg-muted",t)},s))}var Zr=s(23379);const Jr=["className"],Qr=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Jr);return(0,se.jsxs)(Zr.bL,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex w-full touch-none select-none items-center",s)},a),{},{children:[(0,se.jsx)(Zr.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,se.jsx)(Zr.Q6,{className:"absolute h-full bg-primary"})}),(0,se.jsx)(Zr.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});Qr.displayName=Zr.bL.displayName;const Xr=["className"],ei=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Xr);return(0,se.jsx)(ut.Root,(0,ue.A)((0,ue.A)({className:de("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s)},a),{},{ref:t,children:(0,se.jsx)(ut.Thumb,{className:de("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});ei.displayName=ut.Root.displayName;const ti=["className"],si=["className"],ai=["className"],ni=["className"],li=["className"],ri=["className"],ii=["className"],oi=["className"],ci=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ti);return(0,se.jsx)("div",{className:"relative w-full overflow-auto",children:(0,se.jsx)("table",(0,ue.A)({ref:t,className:de("w-full caption-bottom text-sm",s)},a))})});ci.displayName="Table";const di=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,si);return(0,se.jsx)("thead",(0,ue.A)({ref:t,className:de("[&_tr]:border-b",s)},a))});di.displayName="TableHeader";const ui=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ai);return(0,se.jsx)("tbody",(0,ue.A)({ref:t,className:de("[&_tr:last-child]:border-0",s)},a))});ui.displayName="TableBody";const mi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ni);return(0,se.jsx)("tfoot",(0,ue.A)({ref:t,className:de("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s)},a))});mi.displayName="TableFooter";const xi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,li);return(0,se.jsx)("tr",(0,ue.A)({ref:t,className:de("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s)},a))});xi.displayName="TableRow";const hi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ri);return(0,se.jsx)("th",(0,ue.A)({ref:t,className:de("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s)},a))});hi.displayName="TableHead";const pi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ii);return(0,se.jsx)("td",(0,ue.A)({ref:t,className:de("p-4 align-middle [&:has([role=checkbox])]:pr-0",s)},a))});pi.displayName="TableCell";const gi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,oi);return(0,se.jsx)("caption",(0,ue.A)({ref:t,className:de("mt-4 text-sm text-muted-foreground",s)},a))});gi.displayName="TableCaption";const fi=["className"],vi=["className"],bi=["className"],ji=lt.Root,yi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,fi);return(0,se.jsx)(lt.List,(0,ue.A)({ref:t,className:de("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s)},a))});yi.displayName=lt.List.displayName;const Ni=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,vi);return(0,se.jsx)(lt.Trigger,(0,ue.A)({ref:t,className:de("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s)},a))});Ni.displayName=lt.Trigger.displayName;const wi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,bi);return(0,se.jsx)(lt.Content,(0,ue.A)({ref:t,className:de("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s)},a))});wi.displayName=lt.Content.displayName;const _i=["className"],ki=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,_i);return(0,se.jsx)("textarea",(0,ue.A)({className:de("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t},a))});ki.displayName="Textarea";const Ci=["className"],Ai=["className","variant"],Si=["className"],Ei=["className"],Ti=["className"],Ii=["className"],Pi=tt.Provider,Li=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ci);return(0,se.jsx)(tt.Viewport,(0,ue.A)({ref:t,className:de("fixed bottom-0 z-[100] flex max-h-screen w-full flex-col p-4 sm:right-0 md:max-w-[420px]",s)},a))});Li.displayName=tt.Viewport.displayName;const Mi=(0,ft.cva)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",success:"border bg-white text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ri=Y.forwardRef((e,t)=>{let{className:s,variant:a}=e,n=(0,Nt.A)(e,Ai);return(0,se.jsx)(tt.Root,(0,ue.A)({ref:t,className:de(Mi({variant:a}),s)},n))});Ri.displayName=tt.Root.displayName;const Di=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Si);return(0,se.jsx)(tt.Action,(0,ue.A)({ref:t,className:de("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s)},a))});Di.displayName=tt.Action.displayName;const Fi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ei);return(0,se.jsx)(tt.Close,(0,ue.A)((0,ue.A)({ref:t,className:de("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":""},a),{},{children:(0,se.jsx)(la.A,{className:"h-4 w-4"})}))});Fi.displayName=tt.Close.displayName;const Oi=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ti);return(0,se.jsx)(tt.Title,(0,ue.A)({ref:t,className:de("text-sm font-semibold",s)},a))});Oi.displayName=tt.Title.displayName;const Ui=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ii);return(0,se.jsx)(tt.Description,(0,ue.A)({ref:t,className:de("text-sm opacity-90",s)},a))});Ui.displayName=tt.Description.displayName;var Bi=s(52982);const zi=["className","variant","size"],Hi=(0,ft.cva)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),Vi=Y.forwardRef((e,t)=>{let{className:s,variant:a,size:n}=e,l=(0,Nt.A)(e,zi);return(0,se.jsx)(Bi.b,(0,ue.A)({ref:t,className:de(Hi({variant:a,size:n,className:s}))},l))});Vi.displayName=Bi.b.displayName;const Wi=["className","sideOffset"],qi=st.Provider,Yi=st.Root,Gi=st.Trigger,Ki=Y.forwardRef((e,t)=>{let{className:s,sideOffset:a=4}=e,n=(0,Nt.A)(e,Wi);return(0,se.jsx)(st.Content,(0,ue.A)({ref:t,sideOffset:a,className:de("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s)},n))});Ki.displayName=st.Content.displayName;let $i=0;const Zi=new Map,Ji=e=>{if(Zi.has(e))return;const t=setTimeout(()=>{Zi.delete(e),to({type:"REMOVE_TOAST",toastId:e})},1e6);Zi.set(e,t)},Qi=(e,t)=>{switch(t.type){case"ADD_TOAST":return(0,ue.A)((0,ue.A)({},e),{},{toasts:[t.toast,...e.toasts].slice(0,1)});case"UPDATE_TOAST":return(0,ue.A)((0,ue.A)({},e),{},{toasts:e.toasts.map(e=>e.id===t.toast.id?(0,ue.A)((0,ue.A)({},e),t.toast):e)});case"DISMISS_TOAST":{const{toastId:s}=t;return s?Ji(s):e.toasts.forEach(e=>{Ji(e.id)}),(0,ue.A)((0,ue.A)({},e),{},{toasts:e.toasts.map(e=>e.id===s||void 0===s?(0,ue.A)((0,ue.A)({},e),{},{open:!1}):e)})}case"REMOVE_TOAST":return void 0===t.toastId?(0,ue.A)((0,ue.A)({},e),{},{toasts:[]}):(0,ue.A)((0,ue.A)({},e),{},{toasts:e.toasts.filter(e=>e.id!==t.toastId)})}},Xi=[];let eo={toasts:[]};function to(e){eo=Qi(eo,e),Xi.forEach(e=>{e(eo)})}function so(e){let t=Object.assign({},((0,fs.A)(e),e));const s=($i=($i+1)%Number.MAX_SAFE_INTEGER,$i.toString()),a=()=>to({type:"DISMISS_TOAST",toastId:s});return to({type:"ADD_TOAST",toast:(0,ue.A)((0,ue.A)({},t),{},{id:s,open:!0,onOpenChange:e=>{e||a()}})}),{id:s,dismiss:a,update:e=>to({type:"UPDATE_TOAST",toast:(0,ue.A)((0,ue.A)({},e),{},{id:s})})}}function ao(){const[e,t]=Y.useState(eo);return Y.useEffect(()=>(Xi.push(t),()=>{const e=Xi.indexOf(t);e>-1&&Xi.splice(e,1)}),[e]),(0,ue.A)((0,ue.A)({},e),{},{toast:so,dismiss:e=>to({type:"DISMISS_TOAST",toastId:e})})}const no=["id","title","description","action","icon"];function lo(){const{toasts:e}=ao();return(0,se.jsxs)(Pi,{children:[e.map(function(e){let{id:t,title:s,description:a,action:n,icon:l}=e,r=(0,Nt.A)(e,no);return(0,se.jsxs)(Ri,(0,ue.A)((0,ue.A)({},r),{},{children:[(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[l&&(0,se.jsx)("div",{className:"shrink-0 mt-0.5",children:l}),(0,se.jsxs)("div",{className:"grid gap-1",children:[s&&(0,se.jsx)(Oi,{children:s}),a&&(0,se.jsx)(Ui,{children:a})]})]}),n,(0,se.jsx)(Fi,{})]}),t)}),(0,se.jsx)(Li,{})]})}var ro=s(85162);const io=e=>{let t=Object.assign({},((0,fs.A)(e),e));const{theme:s="system"}=(0,ro.D)();return(0,se.jsx)(et.Toaster,(0,ue.A)({theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}}},t))};var oo=s(45403),co=s(31115);function uo(){return(0,co.Ub)({maxWidth:767})}function mo(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,ce.QP)((0,oe.$)(t))}const xo=["defaultOpen","open","onOpenChange","className","style","children"],ho=["side","variant","collapsible","className","children"],po=["className","onClick","asChild"],go=["className"],fo=["className"],vo=["className"],bo=["className"],jo=["className"],yo=["className"],No=["className"],wo=["className"],_o=["className","asChild"],ko=["className","asChild"],Co=["className"],Ao=["className"],So=["className"],Eo=["asChild","isActive","variant","size","tooltip","className"],To=["className","asChild","showOnHover"],Io=["className"],Po=["className","showIcon"],Lo=["className"],Mo=["asChild","size","isActive","className"],Ro=Y.createContext(null);function Do(){const e=Y.useContext(Ro);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const Fo=Y.forwardRef((e,t)=>{let{defaultOpen:s=!0,open:a,onOpenChange:n,className:l,style:r,children:i}=e,o=(0,Nt.A)(e,xo);const c=uo(),[d,u]=Y.useState(!1),[m,x]=Y.useState(s),h=null!=a?a:m,p=Y.useCallback(e=>{const t="function"==typeof e?e(h):e;n?n(t):x(t),document.cookie="".concat("sidebar_state","=").concat(t,"; path=/; max-age=").concat(604800)},[n,h]),g=Y.useCallback(()=>c?u(e=>!e):p(e=>!e),[c,p,u]);Y.useEffect(()=>{const e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),g())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[g]);const f=h?"expanded":"collapsed",v=Y.useMemo(()=>({state:f,open:h,setOpen:p,isMobile:c,openMobile:d,setOpenMobile:u,toggleSidebar:g}),[f,h,p,c,d,u,g]);return(0,se.jsx)(Ro.Provider,{value:v,children:(0,se.jsx)(qi,{delayDuration:0,children:(0,se.jsx)("div",(0,ue.A)((0,ue.A)({style:(0,ue.A)({"--sidebar-width":"16rem","--sidebar-width-icon":"3rem"},r),className:mo("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",l),ref:t},o),{},{children:i}))})})});Fo.displayName="SidebarProvider";const Oo=Y.forwardRef((e,t)=>{let{side:s="left",variant:a="sidebar",collapsible:n="offcanvas",className:l,children:r}=e,i=(0,Nt.A)(e,ho);const{isMobile:o,state:c,openMobile:d,setOpenMobile:u}=Do();return"none"===n?(0,se.jsx)("div",(0,ue.A)((0,ue.A)({className:mo("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",l),ref:t},i),{},{children:r})):o?(0,se.jsx)(Fr,(0,ue.A)((0,ue.A)({open:d,onOpenChange:u},i),{},{children:(0,se.jsxs)(Vr,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:s,children:[(0,se.jsxs)(Wr,{className:"sr-only",children:[(0,se.jsx)(Yr,{children:"Sidebar"}),(0,se.jsx)(Gr,{children:"Displays the mobile sidebar."})]}),(0,se.jsx)("div",{className:"flex h-full w-full flex-col",children:r})]})})):(0,se.jsxs)("div",{ref:t,className:"group peer hidden text-sidebar-foreground md:block","data-state":c,"data-collapsible":"collapsed"===c?n:"","data-variant":a,"data-side":s,children:[(0,se.jsx)("div",{className:mo("relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===a||"inset"===a?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),(0,se.jsx)("div",(0,ue.A)((0,ue.A)({className:mo("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex","left"===s?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===a||"inset"===a?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",l)},i),{},{children:(0,se.jsx)("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:r})}))]})});Oo.displayName="Sidebar";const Uo=Y.forwardRef((e,t)=>{let{className:s,onClick:a,asChild:n=!1}=e,l=(0,Nt.A)(e,po);const{toggleSidebar:r}=Do();return(0,se.jsx)(zt,(0,ue.A)((0,ue.A)({ref:t,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:mo("h-7 w-7",s),onClick:e=>{null==a||a(e),r()},asChild:n},l),{},{children:n?(0,se.jsx)(oo.A,{}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(oo.A,{}),(0,se.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}))});Uo.displayName="SidebarTrigger";const Bo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,go);const{toggleSidebar:n}=Do();return(0,se.jsx)("button",(0,ue.A)({ref:t,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:mo("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",s)},a))});Bo.displayName="SidebarRail";const zo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,fo);return(0,se.jsx)("main",(0,ue.A)({ref:t,className:mo("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",s)},a))});zo.displayName="SidebarInset";const Ho=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,vo);return(0,se.jsx)(nl,(0,ue.A)({ref:t,"data-sidebar":"input",className:mo("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",s)},a))});Ho.displayName="SidebarInput";const Vo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,bo);return(0,se.jsx)("div",(0,ue.A)({ref:t,"data-sidebar":"header",className:mo("flex flex-col gap-2 p-2",s)},a))});Vo.displayName="SidebarHeader";const Wo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,jo);return(0,se.jsx)("div",(0,ue.A)({ref:t,"data-sidebar":"footer",className:mo("flex flex-col gap-2 p-2",s)},a))});Wo.displayName="SidebarFooter";const qo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,yo);return(0,se.jsx)(Tr,(0,ue.A)({ref:t,"data-sidebar":"separator",className:mo("mx-2 w-auto bg-sidebar-border",s)},a))});qo.displayName="SidebarSeparator";const Yo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,No);return(0,se.jsx)("div",(0,ue.A)({ref:t,"data-sidebar":"content",className:mo("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",s)},a))});Yo.displayName="SidebarContent";const Go=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,wo);return(0,se.jsx)("div",(0,ue.A)({ref:t,"data-sidebar":"group",className:mo("relative flex w-full min-w-0 flex-col p-2",s)},a))});Go.displayName="SidebarGroup";const Ko=Y.forwardRef((e,t)=>{let{className:s,asChild:a=!1}=e,n=(0,Nt.A)(e,_o);const l=a?nt.Slot:"div";return(0,se.jsx)(l,(0,ue.A)({ref:t,"data-sidebar":"group-label",className:mo("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",s)},n))});Ko.displayName="SidebarGroupLabel";const $o=Y.forwardRef((e,t)=>{let{className:s,asChild:a=!1}=e,n=(0,Nt.A)(e,ko);const l=a?nt.Slot:"button";return(0,se.jsx)(l,(0,ue.A)({ref:t,"data-sidebar":"group-action",className:mo("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",s)},n))});$o.displayName="SidebarGroupAction";const Zo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Co);return(0,se.jsx)("div",(0,ue.A)({ref:t,"data-sidebar":"group-content",className:mo("w-full text-sm",s)},a))});Zo.displayName="SidebarGroupContent";const Jo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ao);return(0,se.jsx)("ul",(0,ue.A)({ref:t,"data-sidebar":"menu",className:mo("flex w-full min-w-0 flex-col gap-1",s)},a))});Jo.displayName="SidebarMenu";const Qo=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,So);return(0,se.jsx)("li",(0,ue.A)({ref:t,"data-sidebar":"menu-item",className:mo("group/menu-item relative",s)},a))});Qo.displayName="SidebarMenuItem";const Xo=(0,ft.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),ec=Y.forwardRef((e,t)=>{let{asChild:s=!1,isActive:a=!1,variant:n="default",size:l="default",tooltip:r,className:i}=e,o=(0,Nt.A)(e,Eo);const c=s?nt.Slot:"button",{isMobile:d,state:u}=Do(),m=(0,se.jsx)(c,(0,ue.A)({ref:t,"data-sidebar":"menu-button","data-size":l,"data-active":a,className:mo(Xo({variant:n,size:l}),i)},o));return r?("string"==typeof r&&(r={children:r}),(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:m}),(0,se.jsx)(Ki,(0,ue.A)({side:"right",align:"center",hidden:"collapsed"!==u||d},r))]})):m});ec.displayName="SidebarMenuButton";const tc=Y.forwardRef((e,t)=>{let{className:s,asChild:a=!1,showOnHover:n=!1}=e,l=(0,Nt.A)(e,To);const r=a?nt.Slot:"button";return(0,se.jsx)(r,(0,ue.A)({ref:t,"data-sidebar":"menu-action",className:mo("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",s)},l))});tc.displayName="SidebarMenuAction";const sc=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Io);return(0,se.jsx)("div",(0,ue.A)({ref:t,"data-sidebar":"menu-badge",className:mo("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",s)},a))});sc.displayName="SidebarMenuBadge";const ac=Y.forwardRef((e,t)=>{let{className:s,showIcon:a=!1}=e,n=(0,Nt.A)(e,Po);const l=Y.useMemo(()=>"".concat(Math.floor(40*Math.random())+50,"%"),[]);return(0,se.jsxs)("div",(0,ue.A)((0,ue.A)({ref:t,"data-sidebar":"menu-skeleton",className:mo("flex h-8 items-center gap-2 rounded-md px-2",s)},n),{},{children:[a&&(0,se.jsx)($r,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),(0,se.jsx)($r,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":l}})]}))});ac.displayName="SidebarMenuSkeleton";const nc=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Lo);return(0,se.jsx)("ul",(0,ue.A)({ref:t,"data-sidebar":"menu-sub",className:mo("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",s)},a))});nc.displayName="SidebarMenuSub";const lc=Y.forwardRef((e,t)=>{let s=Object.assign({},((0,fs.A)(e),e));return(0,se.jsx)("li",(0,ue.A)({ref:t},s))});lc.displayName="SidebarMenuSubItem";const rc=Y.forwardRef((e,t)=>{let{asChild:s=!1,size:a="md",isActive:n,className:l}=e,r=(0,Nt.A)(e,Mo);const i=s?nt.Slot:"a";return(0,se.jsx)(i,(0,ue.A)({ref:t,"data-sidebar":"menu-sub-button","data-size":a,"data-active":n,className:mo("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===a&&"text-xs","md"===a&&"text-sm","group-data-[collapsible=icon]:hidden",l)},r))});rc.displayName="SidebarMenuSubButton";var ic=s(96046),oc=s(22164),cc=s(41397),dc=s.n(cc),uc=s(31815),mc=s(71358),xc=s(17119),hc=s.t(xc,2),pc=s(13437),gc=s(11728),fc=s(15061),vc=s(14237),bc=s(88141),jc=s(81052),yc=s(38840);const Nc={createClient:function(e){const t=(0,yc.UU)(e),{serverUrl:s="https://base44.app",appId:a}=e;return t.stripe=function(e,t,s){const a=async function(a,n){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=null==s?void 0:s(),i={"X-App-Id":String(t),"Content-Type":"application/json"};r&&(i.Authorization="Bearer ".concat(r));const o={method:a,headers:i};l&&(o.body=JSON.stringify(l));const c=await fetch("".concat(e,"/api").concat(n),o);if(!c.ok){const e=await c.json().catch(()=>({}));throw new Error(e.detail||"Request failed: ".concat(c.status))}return c.json()};return{listProducts:async()=>a("GET","/apps/".concat(t,"/stripe/products")),getProduct:async e=>a("GET","/apps/".concat(t,"/stripe/products/").concat(e)),async listPrices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=new URLSearchParams;e.productId&&s.append("product_id",e.productId);const n=s.toString(),l=n?"/apps/".concat(t,"/stripe/prices?").concat(n):"/apps/".concat(t,"/stripe/prices");return a("GET",l)},async createCheckoutSession(e){if(!e.priceId)throw new Error("priceId is required");if(!e.successUrl)throw new Error("successUrl is required");if(!e.cancelUrl)throw new Error("cancelUrl is required");const s={price_id:e.priceId,success_url:e.successUrl,cancel_url:e.cancelUrl,quantity:e.quantity||1};return e.customerEmail&&(s.customer_email=e.customerEmail),e.metadata&&(s.metadata=e.metadata),a("POST","/apps/".concat(t,"/stripe/checkout-sessions"),s)}}}(s,a,()=>{var e,s;return null===(e=t.auth)||void 0===e||null===(s=e.getToken)||void 0===s?void 0:s.call(e)}),t},createClientFromRequest:yc.xb,Base44Error:yc.EU,getAccessToken:yc.iD,saveAccessToken:yc.rQ,removeAccessToken:yc.kz,getLoginUrl:yc.fx};He().locale("en-US");class wc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};this.appSDK=e;let G=(0,ue.A)({},e.files.coreFiles);for(const a in e.files.pages)G["pages/"+a+".js"]=e.files.pages[a];for(const a in e.files.components)G["components/"+a+".js"]=e.files.components[a];e.files.layout&&(G["layout.js"]=e.files.layout),this.appFiles=G,this.packages={recharts:Ge,"react-hot-toast":$,moment:He(),"moment/locale/he":Ye,"moment/locale/ar":Ve,"moment/locale/fr":We,"moment/locale/es":qe,react:Y,"lucide-react":Ke,"react-quill":$e,"@hello-pangea/dnd":jt,"date-fns":ic,"date-fns/locale":oc,three:pc,"three/addons/controls/OrbitControls.js":gc,"three/addons/loaders/GLTFLoader.js":fc,sonner:et,"@stripe/stripe-js":vt,"@stripe/react-stripe-js":bt,"@radix-ui/react-toast":tt,"@radix-ui/react-slot":nt,"@radix-ui/react-tooltip":st,"@radix-ui/react-separator":at,"@radix-ui/react-tabs":lt,"@radix-ui/react-hover-card":rt,"@radix-ui/react-select":it,"@radix-ui/react-alert-dialog":ot,"@radix-ui/react-popover":ct,"@radix-ui/react-label":dt,"@radix-ui/react-switch":ut,"@radix-ui/react-scroll-area":mt,"@radix-ui/react-collapsible":xt,"@radix-ui/react-avatar":ht,"@radix-ui/react-dropdown-menu":pt,"@radix-ui/react-dialog":gt,"class-variance-authority":ft,"@/components/ui/sidebar":q,"react-dom":hc,"react-dom/client":K,"react-markdown":uc,"@tanstack/react-query":mc,lodash:cc,jspdf:Je,"framer-motion":vc,"react-router-dom":Z,"react-hook-form":yt,"react-quill/dist/quill.snow.css":{},"react-leaflet":Xe,leaflet:Qe,"leaflet/dist/leaflet.css":{},"canvas-confetti":bc,html2canvas:jc,"@/lib/utils":a,"@/components/lib/utils":a,"./components/lib/utils":a,"@/components/ui/accordion":n,"@/components/ui/alert":l,"@/components/ui/alert-dialog":i,"@/components/ui/aspect-ratio":o,"@/components/ui/avatar":c,"@/components/ui/badge":d,"@/components/ui/button":r,"@/components/ui/calendar":u,"@/components/ui/card":m,"@/components/ui/checkbox":x,"@/components/ui/collapsible":h,"@/components/ui/carousel":p,"@/components/ui/command":f,"@/components/ui/context-menu":v,"@/components/ui/dialog":g,"@/components/ui/dropdown-menu":b,"@/components/ui/form":y,"@/components/ui/hover-card":N,"@/components/ui/input":w,"@/components/ui/label":j,"@/components/ui/menubar":_,"@/components/ui/navigation-menu":k,"@/components/ui/popover":C,"@/components/ui/progress":A,"@/components/ui/radio-group":S,"@/components/ui/scroll-area":E,"@/components/ui/select":T,"@/components/ui/separator":I,"@/components/ui/sheet":P,"@/components/ui/skeleton":L,"@/components/ui/slider":M,"@/components/ui/switch":R,"@/components/ui/table":D,"@/components/ui/tabs":F,"@/components/ui/textarea":O,"@/components/ui/toast":U,"@/hooks/use-toast":H,"@/components/ui/use-toast":H,"@/components/ui/toaster":V,"@/components/ui/toggle":B,"@/components/ui/tooltip":z,"@/components/ui/sonner":W,"@base44/sdk":Nc},this.globals=t,this.moduleCache={},this.compilingModules=new Set,this.importFile=this.importFile.bind(this),this.onError=s}_importAppSDK(e){let t=e;if(e.split("/").length>2&&(t=e.split("/").pop()),e.includes("/entities"))return t?(0,ue.A)((0,ue.A)({},this.appSDK.entities),{},{default:this.appSDK.entities[t]}):this.appSDK.entities;if(e.includes("/functions"))return t?(0,ue.A)((0,ue.A)({},this.appSDK.functions),{},{default:()=>alert="ok!!!"}):this.appSDK.functions;if(e.includes("/integrations")){if(t)return this.appSDK.integrations[t];let e={};return Object.keys(this.appSDK.integrations).forEach(t=>{e["@/integrations/".concat(t)]=this.appSDK.integrations[t],e["./integrations/".concat(t)]=this.appSDK.integrations[t]}),e}return"./utils"==e||"@/utils"==e||"../utils"===e?{createPageUrl:this.appSDK.createPageUrl}:e.includes("/agents")?{agentSDK:this.appSDK.agents,default:this.appSDK.agents}:void alert("importing "+e)}importAppSDK(e){return this._importAppSDK(e)}importFile(e,t){if(e.endsWith(".css"))return this.handleCSSImport(e);const s=Fe(e);if(this.appFiles[s]&&!s.includes("use-toast"))return this.importAppFile(e,t);if(e.includes("components/ui/")||e.includes("@/components/ui/")){let t=e;if(e.startsWith("./")||e.startsWith("../")){const s=e.split("/"),a=s[s.length-1];t="@/components/ui/".concat(a)}return this.importPackage(t)}return"@/lib/utils"===e?this.importPackage(e):e.startsWith("./")||e.startsWith("@/")||e.startsWith("../")?e.includes("/entities/")||e.includes("/functions/")||e.includes("/integrations/")||e.includes("/agents")||"./utils"==e||"@/utils"==e||"../utils"===e?this.importAppSDK(e):this.importAppFile(e,t):this.importPackage(e)}importPackage(e){if(!this.packages.hasOwnProperty(e)){const t=e.split("/");if(this.packages.hasOwnProperty(t[0])){let s=this.packages[t[0]];for(let a=1;a<t.length;a++){if(!s||!Object.prototype.hasOwnProperty.call(s,t[a]))throw new Error("Module not found: '".concat(e,"'"));s=s[t[a]]}return Oe(e,s,!0)}throw new Error("Module not found: '".concat(e,"'"))}return Oe(e,this.packages[e],!0)}importAppFile(e,t){const s=function(e,t,s){const a=Fe(e);if(s[a])return a;if(e.startsWith("./")||e.startsWith("../")){const a=t.split("/").slice(0,-1).join("/"),n=e.split("/");let l=a?a.split("/"):[];for(const e of n)"."!==e&&(".."===e?l.length>0&&l.pop():e&&l.push(e));let r=l.join("/");if(r.startsWith("./")&&(r=r.substring(2)),r.startsWith("../")&&(r=r.substring(3)),r.startsWith("@/")&&(r=r.substring(2)),s[r])return r;if(s[r+".js"])return r+".js";const i=Object.keys(s).find(t=>t.endsWith(e));if(i)return i}return a}(e,t,this.appFiles);if(this.moduleCache[s])return this.moduleCache[s];if(this.compilingModules.has(s))return{};this.compilingModules.add(s);let a=this.appFiles[s];if(!a){const n=s.toLowerCase(),l=Object.keys(this.appFiles).find(e=>e.toLowerCase()===n);if(!l)throw new Error("Error in ".concat(t,": can't import file ").concat(e,", it doesn't exist (checked case-insensitive also)."));a=this.appFiles[l]}const n=function(e,t){e.includes(".")&&(e=e.split(".")[0]);const s=Re(e,t).split("\n"),a=/(<[A-Z][a-zA-Z]*|<[a-z][a-zA-Z0-9]*)(\s|>|\/>)/g;return s.map((t,s)=>{const n=s+1;return a.test(t)?(a.lastIndex=0,t.replace(a,(s,a,l)=>{const r=t.substring(0,t.indexOf(a)).includes('"')?"'":'"';return l.includes(">")?(l.indexOf(">"),"".concat(a," data-filename=").concat(r).concat(e).concat(r," data-linenumber=").concat(r).concat(n).concat(r," data-visual-selector-id=").concat(r).concat(e).concat(n).concat(r).concat(l)):"".concat(a).concat(l,"data-filename=").concat(r).concat(e).concat(r," data-linenumber=").concat(r).concat(n).concat(r," data-visual-selector-id=").concat(r).concat(e).concat(n).concat(r," ")})):t}).join("\n")}(s,a);let l;try{l=this.compileJSXToJavascript(s,n,!1)}catch(i){l=this.compileJSXToJavascript(s,a,!0)}const r=this.evaluateJavascriptCode(s,l);return this.moduleCache[s]=r,this.compilingModules.delete(s),r}compileJSXToJavascript(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!=typeof t)throw new Error('Invalid code content for "'.concat(e,'"'));const a=t.trim();let n;try{n=(0,Ee.pd)(a,{transforms:["jsx","imports"],production:!1,filePath:e})}catch(r){throw s&&this.onError(null==r?void 0:r.message,null==r?void 0:r.toString(),e,r),r}let l=n.code;l.startsWith('"use strict";')&&(l=l.substring(13));return"\n            // Initialize module objects\n            const module = { exports: {} };\n            const exports = module.exports;\n            \n            ".concat(l,"\n            \n            // No need for regex transforms - module.exports will naturally capture all exports\n        ")}evaluateJavascriptCode(e,t){const s=(0,ue.A)({React:Y,require:t=>this.importFile(t,e),console:Be(e,this.onError)},this.globals),a=Object.keys(s),n=a.map(e=>s[e]);try{const s=new Function(...a,t+"; return { moduleExports: module.exports, exportsObj: exports };")(...n),l=s.moduleExports&&Object.keys(s.moduleExports).length>0?s.moduleExports:s.exportsObj;return Oe(e,l)}catch(l){return this.onError("Error evaluating module ".concat(e,": ").concat(l.message),l.toString(),e,l),Oe(e,{})}}render(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a=this.importAppFile(e);if(!a)throw new Error('[AppProjectCompiler] No exports found in "'.concat(e,'"'));let n=null;if("function"==typeof a)n=a;else if(a.default&&"function"==typeof a.default)n=a.default;else for(const l of Object.keys(a))if("function"==typeof a[l]&&(l.includes("Component")||l.endsWith("Provider")||l.startsWith("App")||"Main"===l||l.charAt(0)===l.charAt(0).toUpperCase())){n=a[l];break}if(!n)throw new Error('No component found in "'.concat(e,'"'));return Y.createElement(n,t,...s)}handleCSSImport(e){const t=Fe(e);if(this.constructor.injectedCSS||(this.constructor.injectedCSS=new Set),this.constructor.injectedCSS.has(t))return{};let s="";if(!this.appFiles[t])return this.packages[e],{};if(s=this.appFiles[t],s){const e=document.createElement("style");e.textContent=s,e.setAttribute("data-source",t),document.head.appendChild(e),this.constructor.injectedCSS.add(t)}return{}}}function _c(){const[e,t]=(0,Y.useState)(!1),s=(0,Y.useRef)(!1),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(!1),i=(0,Y.useRef)(!1),[o,c]=(0,Y.useState)(!1),d=(0,Y.useRef)(!1),u=(0,Y.useRef)([]),m=(0,Y.useRef)([]),x=(0,Y.useRef)([]),h=(0,Y.useRef)(null),p=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=document.createElement("div");return t.style.position="absolute",t.style.pointerEvents="none",t.style.transition="all 0.1s ease-in-out",t.style.zIndex="9999",e?t.style.border="2px solid #2563EB":(t.style.border="2px solid #95a5fc",t.style.backgroundColor="rgba(99, 102, 241, 0.05)"),t},g=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t||!s.current)return;t.offsetWidth;const n=t.getBoundingClientRect();e.style.top="".concat(n.top+window.scrollY,"px"),e.style.left="".concat(n.left+window.scrollX,"px"),e.style.width="".concat(n.width,"px"),e.style.height="".concat(n.height,"px");let l=e.querySelector("div");l||(l=document.createElement("div"),l.textContent=t.tagName.toLowerCase(),l.style.position="absolute",l.style.top="-27px",l.style.left="-2px",l.style.padding="2px 8px",l.style.fontSize="11px",l.style.fontWeight=a?"500":"400",l.style.color=a?"#ffffff":"#526cff",l.style.backgroundColor=a?"#526cff":"#DBEAFE",l.style.borderRadius="3px",l.style.boxShadow="none",l.style.minWidth="24px",l.style.textAlign="center",e.appendChild(l))},f=e=>{if(!e)return[];const t=[...document.querySelectorAll('[data-source-location="'.concat(e,'"]'))];return t.length>0?t:[...document.querySelectorAll('[data-visual-selector-id="'.concat(e,'"]'))]},v=()=>{u.current.forEach(e=>{e&&e.parentNode&&e.remove()}),u.current=[],x.current=[]},b=e=>{if(!s.current||i.current)return;if(d.current)return void v();if("path"===e.target.tagName.toLowerCase())return void v();const t=e.target.closest("[data-source-location], [data-visual-selector-id]");if(!t)return void v();const a=t.dataset.sourceLocation||t.dataset.visualSelectorId;t.dataset.sourceLocation;if(h.current===a)return void v();const n=f(a);v(),n.forEach(e=>{const t=p(!1);document.body.appendChild(t),u.current.push(t),g(t,e)}),x.current=n},j=()=>{i.current||v()},y=e=>{var t;if(!s.current)return;if(d.current)return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),void window.parent.postMessage({type:"close-dropdowns"},"*");if("path"===e.target.tagName.toLowerCase())return;e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const a=e.target.closest("[data-source-location], [data-visual-selector-id]");if(!a)return;const l=a.dataset.sourceLocation||a.dataset.visualSelectorId;a.dataset.sourceLocation;m.current.forEach(e=>{e&&e.parentNode&&e.remove()}),m.current=[];f(l).forEach(e=>{const t=p(!0);document.body.appendChild(t),m.current.push(t),g(t,e,!0)}),n(a),h.current=l,v();const r=a.getBoundingClientRect(),i={top:r.top,left:r.left,right:r.right,bottom:r.bottom,width:r.width,height:r.height,centerX:r.left+r.width/2,centerY:r.top+r.height/2},o={type:"element-selected",tagName:a.tagName,classes:(null===(t=a.className)||void 0===t?void 0:t.baseVal)||a.className||"",visualSelectorId:l,content:a.innerText,dataSourceLocation:a.dataset.sourceLocation,isDynamicContent:"true"===a.dataset.dynamicContent,linenumber:a.dataset.linenumber,filename:a.dataset.filename,position:i};window.parent.postMessage(o,"*")};return(0,Y.useEffect)(()=>{document.querySelectorAll("[data-visual-selector-id]");document.querySelectorAll("[data-linenumber]:not([data-visual-selector-id])").forEach((e,t)=>{const s="visual-id-".concat(e.dataset.filename,"-").concat(e.dataset.linenumber,"-").concat(t);e.dataset.visualSelectorId=s});const e=()=>{if(h.current){const e=f(h.current);if(e.length>0){const t=e[0].getBoundingClientRect(),s=window.innerHeight,a=window.innerWidth,n=t.top<s&&t.bottom>0&&t.left<a&&t.right>0,l={top:t.top,left:t.left,right:t.right,bottom:t.bottom,width:t.width,height:t.height,centerX:t.left+t.width/2,centerY:t.top+t.height/2};window.parent.postMessage({type:"element-position-update",position:l,isInViewport:n,visualSelectorId:h.current},"*")}}},a=e=>{const a=e.data;switch(a.type){case"toggle-visual-edit-mode":l=a.data.enabled,t(l),s.current=l,l?(document.body.style.cursor="crosshair",document.addEventListener("mouseover",b),document.addEventListener("mouseout",j),document.addEventListener("click",y,!0)):(v(),m.current.forEach(e=>{e&&e.parentNode&&e.remove()}),m.current=[],x.current=[],n(null),h.current=null,document.body.style.cursor="default",document.removeEventListener("mouseover",b),document.removeEventListener("mouseout",j),document.removeEventListener("click",y,!0));break;case"update-classes":a.data&&void 0!==a.data.classes&&function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=f(e);0!==a.length&&(a.forEach(e=>{if(s)e.className=t;else{var a;const s=(null===(a=e.className)||void 0===a?void 0:a.baseVal)||e.className||"";e.className=(0,ce.QP)(s,t)}}),setTimeout(()=>{var t,s;(h.current===e&&m.current.forEach((e,t)=>{t<a.length&&g(e,a[t])}),x.current.length>0)&&((null===(t=x.current[0])||void 0===t||null===(s=t.dataset)||void 0===s?void 0:s.visualSelectorId)===e&&u.current.forEach((e,t)=>{t<x.current.length&&g(e,x.current[t])}))},50))}(a.data.visualSelectorId,a.data.classes,a.data.replace||!1);break;case"unselect-element":m.current.forEach(e=>{e&&e.parentNode&&e.remove()}),m.current=[],n(null),h.current=null;break;case"refresh-page":window.location.reload();break;case"update-content":a.data&&void 0!==a.data.content&&((e,t)=>{const s=f(e);0!==s.length&&(s.forEach(e=>{e.innerText=t}),setTimeout(()=>{h.current===e&&m.current.forEach((e,t)=>{t<s.length&&g(e,s[t])})},50))})(a.data.visualSelectorId,a.data.content);break;case"request-element-position":if(h.current){const e=f(h.current);if(e.length>0){const t=e[0].getBoundingClientRect(),s=window.innerHeight,a=window.innerWidth,n=t.top<s&&t.bottom>0&&t.left<a&&t.right>0,l={top:t.top,left:t.left,right:t.right,bottom:t.bottom,width:t.width,height:t.height,centerX:t.left+t.width/2,centerY:t.top+t.height/2};window.parent.postMessage({type:"element-position-update",position:l,isInViewport:n,visualSelectorId:h.current},"*")}}break;case"popover-drag-state":a.data&&void 0!==a.data.isDragging&&(r(a.data.isDragging),i.current=a.data.isDragging,a.data.isDragging&&v());break;case"dropdown-state":a.data&&void 0!==a.data.isOpen&&(c(a.data.isOpen),d.current=a.data.isOpen,a.data.isOpen&&v())}var l};return window.addEventListener("message",a),window.addEventListener("scroll",e,!0),document.addEventListener("scroll",e,!0),window.parent.postMessage({type:"visual-edit-agent-ready"},"*"),()=>{window.removeEventListener("message",a),window.removeEventListener("scroll",e,!0),document.removeEventListener("scroll",e,!0),document.removeEventListener("mouseover",b),document.removeEventListener("mouseout",j),document.removeEventListener("click",y,!0),v(),m.current.forEach(e=>{e&&e.parentNode&&e.remove()})}},[]),(0,Y.useEffect)(()=>{s.current=e},[e]),(0,Y.useEffect)(()=>{i.current=l},[l]),(0,Y.useEffect)(()=>{d.current=o},[o]),(0,Y.useEffect)(()=>{const e=()=>{if(h.current){const e=f(h.current);m.current.forEach((t,s)=>{s<e.length&&g(t,e[s])})}x.current.length>0&&u.current.forEach((e,t)=>{t<x.current.length&&g(e,x.current[t])})},t=new MutationObserver(t=>{t.some(e=>{const t=e=>{if(e.nodeType===Node.ELEMENT_NODE){if(e.dataset&&e.dataset.visualSelectorId)return!0;for(let s=0;s<e.children.length;s++)if(t(e.children[s]))return!0}return!1};return"attributes"===e.type&&("style"===e.attributeName||"class"===e.attributeName||"width"===e.attributeName||"height"===e.attributeName)&&t(e.target)})&&setTimeout(e,50)});return t.observe(document.body,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["style","class","width","height"]}),window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e),t.disconnect()}},[]),null}class kc extends te.H{getBaseURL(){return"/app-logs"}fetchLogs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.axios.get("/".concat(e),{params:t})}logUserInApp(e,t){return this.axios.post("/".concat(e,"/log-user-in-app/").concat(t))}getStats(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"all"===e?this.axios.get("/platform-admin/platform-stats",{params:t}):this.axios.get("/".concat(e,"/stats"),{params:t})}getUserStats(e){return this.axios.get("/user-stats/".concat(e))}getTrendingApps(){return(0,me.Ay)("/apps/public").get("/trending")}}const Cc=new kc;var Ac=s(42989);function Sc(){const e="https://app.base44.com";return e||"app.base44.com"}function Ec(e){return e===function(){const e=Sc();return new URL(e).host}()}function Tc(e){return Lc(e.slug)}function Ic(e,t){return Lc("checkpoint--".concat(e.id,"--").concat(t.id))}function Pc(e){return Lc("preview--".concat(e.slug))}function Lc(e){const t="base44.app",s=(a=t).includes("localhost")||a.includes("127.0.0.1")?"http":"https";var a;return"".concat(s,"://").concat(e,".").concat(t)}function Mc(e){let{appId:t}=e;const[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!0);(0,Y.useEffect)(()=>{"true"===new URLSearchParams(window.location.search).get("hide_badge")&&l(!1)},[]);return n?(0,se.jsxs)("div",{dir:"ltr",className:"fixed z-50 text-white bottom-4 right-4 flex items-center gap-2 bg-black pt-2 pb-2 pl-3 pr-3 rounded-md shadow-lg cursor-pointer transition-all hover:shadow-xl border border-neutral-800",onClick:async()=>{a(!0);const e=Sc();window.open("".concat(e,"/remix-app/").concat(t),"_blank"),a(!1)},children:[(0,se.jsx)("img",{src:"https://base44.app/logo_v3.png",alt:"base44",className:"w-5 h-5"}),(0,se.jsx)("span",{className:"whitespace-nowrap text-xs",children:s?(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(Ac.A,{className:"w-3 h-3 animate-spin"}),(0,se.jsx)("span",{children:"Cloning..."})]}):(0,se.jsxs)("div",{className:"flex items-center gap-1.5 align-middle justify-center text-sm",children:[(0,se.jsx)("span",{children:"Edit with "}),(0,se.jsx)("span",{className:"mb-0.5",children:(0,se.jsx)("img",{src:"/base44_text.png",alt:"Base44",height:18,width:56})})]})}),(0,se.jsx)("button",{className:"p-0.5 ml-0.5 rounded-full hover:bg-neutral-700 transition-colors","aria-label":"Close badge",onClick:e=>{e.stopPropagation(),l(!1)},children:(0,se.jsx)(la.A,{className:"w-3.5 h-3.5"})})]}):null}function Rc(e){let{}=e;const{user:t,isAuthenticated:s}=ie(),{pageName:a}=(0,J.g)();return(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6 bg-slate-50",children:(0,se.jsx)("div",{className:"max-w-md w-full",children:(0,se.jsxs)("div",{className:"text-center space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h1",{className:"text-7xl font-light text-slate-300",children:"404"}),(0,se.jsx)("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto"})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("h2",{className:"text-2xl font-medium text-slate-800",children:"Page Not Found"}),(0,se.jsxs)("p",{className:"text-slate-600 leading-relaxed",children:["The page ",(0,se.jsxs)("span",{className:"font-medium text-slate-700",children:['"',a,'"']})," could not be found in this application."]})]}),s&&"admin"===(null==t?void 0:t.role)&&(0,se.jsx)("div",{className:"mt-8 p-4 bg-slate-100 rounded-lg border border-slate-200",children:(0,se.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-orange-100 flex items-center justify-center mt-0.5",children:(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-orange-400"})}),(0,se.jsxs)("div",{className:"text-left space-y-1",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Admin Note"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed",children:"This could mean that the AI hasn't implemented this page yet. Ask it to implement it in the chat."})]})]})}),(0,se.jsx)("div",{className:"pt-6",children:(0,se.jsxs)("button",{onClick:()=>window.location.href="/",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500",children:[(0,se.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Go Home"]})})]})})})}const Dc=e=>{let{className:t="",width:s=36,height:a=36}=e;return(0,se.jsxs)("svg",{width:s,height:a,viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,se.jsx)("path",{d:"M28.2533 31.4621C28.2999 31.4621 28.3204 31.5214 28.2833 31.5498C25.3198 33.8234 21.6115 35.1751 17.5875 35.1751C13.5635 35.1751 9.85519 33.8238 6.8917 31.5498C6.85457 31.5214 6.87509 31.4621 6.92166 31.4621H28.2537H28.2533ZM32.8411 26.3487C32.2268 27.416 31.5034 28.4127 30.6869 29.3236C30.656 29.3582 30.6117 29.3777 30.5654 29.3777H4.60988C4.56364 29.3777 4.51934 29.3582 4.4884 29.3236C3.67156 28.4127 2.94852 27.416 2.33426 26.3487C2.30918 26.3054 2.34077 26.251 2.39093 26.251H32.7844C32.8346 26.251 32.8661 26.3054 32.8411 26.3487ZM34.8272 21.0855C34.6181 22.1209 34.3181 23.1234 33.9361 24.0845C33.9162 24.134 33.868 24.1666 33.8146 24.1666H1.36043C1.30702 24.1666 1.25882 24.134 1.23895 24.0845C0.856909 23.1237 0.556944 22.1212 0.347848 21.0855C0.339706 21.0451 0.370647 21.0074 0.41201 21.0074H34.763C34.804 21.0074 34.8353 21.0451 34.8272 21.0855ZM17.4686 0.000392079C27.2365 -0.0640954 35.175 7.83464 35.175 17.5876C35.175 18.0162 35.1597 18.4412 35.1297 18.8623C35.1274 18.8965 35.0988 18.9229 35.0646 18.9229H0.110743C0.076545 18.9229 0.0478839 18.8965 0.045604 18.8623C0.0156401 18.4467 0.000332489 18.0269 6.79435e-06 17.6035C-0.00846126 8.0343 7.89972 0.0639025 17.4686 0.000392079Z",fill:"black"}),(0,se.jsx)("path",{d:"M28.2533 31.4621C28.2999 31.4621 28.3204 31.5214 28.2833 31.5498C25.3198 33.8234 21.6115 35.1751 17.5875 35.1751C13.5635 35.1751 9.85519 33.8238 6.8917 31.5498C6.85457 31.5214 6.87509 31.4621 6.92166 31.4621H28.2537H28.2533ZM32.8411 26.3487C32.2268 27.416 31.5034 28.4127 30.6869 29.3236C30.656 29.3582 30.6117 29.3777 30.5654 29.3777H4.60988C4.56364 29.3777 4.51934 29.3582 4.4884 29.3236C3.67156 28.4127 2.94852 27.416 2.33426 26.3487C2.30918 26.3054 2.34077 26.251 2.39093 26.251H32.7844C32.8346 26.251 32.8661 26.3054 32.8411 26.3487ZM34.8272 21.0855C34.6181 22.1209 34.3181 23.1234 33.9361 24.0845C33.9162 24.134 33.868 24.1666 33.8146 24.1666H1.36043C1.30702 24.1666 1.25882 24.134 1.23895 24.0845C0.856909 23.1237 0.556944 22.1212 0.347848 21.0855C0.339706 21.0451 0.370647 21.0074 0.41201 21.0074H34.763C34.804 21.0074 34.8353 21.0451 34.8272 21.0855ZM17.4686 0.000392079C27.2365 -0.0640954 35.175 7.83464 35.175 17.5876C35.175 18.0162 35.1597 18.4412 35.1297 18.8623C35.1274 18.8965 35.0988 18.9229 35.0646 18.9229H0.110743C0.076545 18.9229 0.0478839 18.8965 0.045604 18.8623C0.0156401 18.4467 0.000332489 18.0269 6.79435e-06 17.6035C-0.00846126 8.0343 7.89972 0.0639025 17.4686 0.000392079Z",fill:"#FF983B"})]})};function Fc(){return(0,se.jsxs)("div",{className:"min-h-screen bg-[#F8FAFC] flex flex-col relative overflow-hidden font-base44",children:[(0,se.jsx)("div",{className:"absolute right-0 top-1/2 transform -translate-y-1/2 w-[50%] h-[100%] rounded-full opacity-60 blur-3xl",style:{background:"radial-gradient(circle, #FF5500 10%, #FFEAA6 70%)",right:"-25%",top:"50%"}}),(0,se.jsx)("div",{className:"md:px-[60px] px-[16px] md:py-[24px] py-[16px]",children:(0,se.jsxs)("div",{className:"flex items-center space-x-3 h-[44px]",children:[(0,se.jsx)(Dc,{width:32,height:32}),(0,se.jsx)("span",{className:"text-xl font-semibold text-slate-800",children:"Base 44"})]})}),(0,se.jsx)("div",{className:"flex-1 flex items-center md:px-[90px] px-[16px]",children:(0,se.jsxs)("div",{className:" w-full",children:[(0,se.jsxs)("h1",{className:"md:text-[100px] text-[42px] md:font-medium text-[#001E36] md:leading-[109px] tracking-[-1px] mb-6",children:["Your app is",(0,se.jsx)("br",{}),"waiting to shine!"]}),(0,se.jsxs)("div",{className:"md:text-[28px] text-[18px] font-normal text-black space-y-2",children:[(0,se.jsx)("p",{children:"But it isn't live yet."}),(0,se.jsx)("p",{children:"Publish it to make it visible here."})]})]})})]})}const Oc=()=>(0,se.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-white to-gray-50",children:(0,se.jsx)("div",{className:"max-w-md w-full p-8 bg-white rounded-lg shadow-lg border border-gray-100",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 mb-6 rounded-full bg-red-100",children:(0,se.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,se.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Access Restricted"}),(0,se.jsx)("p",{className:"text-gray-600 mb-8",children:"You are not registered to use this application. Please contact the app administrator to request access."}),(0,se.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md text-sm text-gray-600",children:[(0,se.jsx)("p",{children:"If you believe this is an error, you can:"}),(0,se.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,se.jsx)("li",{children:"Verify you are logged in with the correct account"}),(0,se.jsx)("li",{children:"Contact the app administrator for access"}),(0,se.jsx)("li",{children:"Try logging out and back in again"})]})]})]})})});function Uc(e){var t,s,a,n;let{appId:l}=e;const{isAuthenticated:r,isLoadingAuth:i,logout:o}=ie(),c=(0,J.zy)(),d=(0,J.Zp)(),{appId:u,pageName:m}=(0,J.g)(),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(null),[f,v]=(0,Y.useState)(!0),[b,j]=(0,Y.useState)(!1),y=e=>{const t=new wc(e,{cn:de,localStorage:De()},(t,s,a,n)=>{e.options.onError(t,s,a,n)}),s=e.getCurrentPage();if(!s)return void g((0,se.jsx)(Rc,{}));const a=t.render("pages/"+s.name);if(e.files.layout){const e=t.render("layout",{currentPageName:null==s?void 0:s.name},[a]);g(e)}else g(a)};(0,Y.useEffect)(()=>{Se({id:l||u,onError:N,authProps:{isLoadingAuth:i,logout:o,isUserAuthenticated:()=>r}}).then(e=>{h(e)}).catch(e=>{var t,s,a,n,l,r,i,o,c,d,u,m;e.response&&404===e.response.status?N("App not found","This app does not exist or has been removed.","general",e):e.response&&403===e.response.status&&null!==(t=e.response.data)&&void 0!==t&&null!==(s=t.extra_data)&&void 0!==s&&s.reason?"auth_required"===(null===(a=e.response.data)||void 0===a||null===(n=a.extra_data)||void 0===n?void 0:n.reason)?k(null===(u=e.response.data)||void 0===u||null===(m=u.extra_data)||void 0===m?void 0:m.app_id):"user_not_registered"===(null===(l=e.response.data)||void 0===l||null===(r=l.extra_data)||void 0===r?void 0:r.reason)?v(!1):"support_access_required"===(null===(i=e.response.data)||void 0===i||null===(o=i.extra_data)||void 0===o?void 0:o.reason)?N("Access Required","Please access this app through the support panel first. Go to the support panel and click on a ticket for this app to grant temporary access.","general",e):"not_deployed"===(null===(c=e.response.data)||void 0===c||null===(d=c.extra_data)||void 0===d?void 0:d.reason)&&j(!0):N("Failed to load app "+e.message,"none","general",e)})},[]);const N=(e,t,s,a)=>{var n,l;if(402===(null==a||null===(n=a.response)||void 0===n?void 0:n.status))return;const r=(null==a?void 0:a.stack)||null;null===(l=window.parent)||void 0===l||l.postMessage({type:"app_error",error:{title:e.toString(),details:null==t?void 0:t.toString(),componentName:null==s?void 0:s.toString(),stack:r}},"*")};(0,Y.useEffect)(()=>{window.parent.postMessage({type:"app_changed_url",url:window.location.href},"*"),x&&y(x)},[c,m,x]);const w=e=>{var t;const s=null===(t=e.reason.stack.match(/at\s+(\w+)\s+\(eval/))||void 0===t?void 0:t[1],a=s?"Error in ".concat(s,": ").concat(e.reason.toString()):e.reason.toString();N(a,e.reason.toString(),s,e.reason)},_=e=>{var t,s;let a=null===(s=(null===(t=e.error)||void 0===t?void 0:t.stack).match(/at\s+(\w+)\s+\(eval/))||void 0===s?void 0:s[1];"eval"===a&&(a=null);const n=a?"in ".concat(a,": ").concat(e.error.toString()):e.error.toString();N(n,e.error.toString(),a,e.error)};(0,Y.useEffect)(()=>(window.addEventListener("unhandledrejection",w),window.addEventListener("error",_),()=>{window.removeEventListener("unhandledrejection",w),window.removeEventListener("error",_)}),[]);const k=e=>{d("/login?from_url=".concat(window.location.href,"&app_id=").concat(e))};return(0,Y.useEffect)(()=>{let e=null==x?void 0:x.getCurrentPage();r&&null!=x&&x.appId&&null!=e&&e.name&&Cc.logUserInApp(x.appId,e.name)},[r,null==x?void 0:x.appId,null==x||null===(t=x.getCurrentPage())||void 0===t?void 0:t.name]),f?b?(0,se.jsx)(Fc,{}):x?i?(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,se.jsx)("div",{className:"w-8 h-8 border-4 border-gray-200 border-t-black rounded-full animate-spin"})}):(0,se.jsxs)("div",{className:"min-h-screen w-full relative app-preview",children:[(0,se.jsx)(_c,{}),(null==x||null===(s=x.files)||void 0===s?void 0:s.is_remixable)&&(null==x||null===(a=x.files)||void 0===a||null===(n=a.public_settings)||void 0===n?void 0:n.includes("public"))&&(0,se.jsx)(Mc,{appId:l}),(0,se.jsx)("div",{className:"flex flex-col w-full h-full",id:"app-demo",children:(0,se.jsx)("div",{className:"bg-white w-full min-h-full overflow-auto",children:(0,se.jsx)("div",{id:"component-preview-container",children:p})})})]}):(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,se.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,se.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-black rounded-full animate-spin"})})}):(0,se.jsx)(Oc,{})}class Bc extends te.y{getBaseURL(){return"/apps"}addMessage(e,t){return this.axios.post("/".concat(e,"/chat/message"),t)}undoMessage(e,t){return this.axios.post("/".concat(e,"/chat/message/").concat(t,"/undo"))}inviteUser(e,t,s){return this.axios.post("/".concat(e,"/users/invite-user"),{user_email:t,role:s})}remixApp(e,t){return this.axios.post("/".concat(e,"/remix"),t)}remixAppRequirements(e){return this.axios.get("/".concat(e,"/remix/requirements"))}updateLogo(e,t){return this.axios.post("/".concat(e,"/metadata/update-logo"),t)}generateLogoFromPrompt(e,t){return this.axios.post("/".concat(e,"/metadata/generate-logo"),t)}stopChat(e){return this.axios.post("/".concat(e,"/chat/stop"))}submitToolCallInput(e,t,s,a){return this.axios.post("/".concat(e,"/chat/submit-tool-call-input"),{tool_call_id:t,action:s?"approved":"rejected",extra_user_input:a})}getToolCall(e,t,s){return this.axios.get("/".concat(e,"/chat/messages/").concat(t,"/tool_calls/").concat(s))}getDomainAppId(e){return this.axios.get("/public/prod/domain/".concat(e))}getRuntimeAuthToken(e,t){return this.axios.get("/".concat(e,"/auth/token"))}generateTokenForUser(e,t){return this.axios.post("/".concat(e,"/util/ping"),{email:t},{headers:{"X-From-Preview":"true"}})}getLoginInfoById(e){return this.axios.get("/public/login-info/by-id/".concat(e))}getAppPublishedUrl(e){return this.axios.get("/platform/".concat(e,"/published-url"))}getSuggestions(e){return this.axios.get("/".concat(e,"/chat/suggestions/edit"))}dismissDomainSuggestion(e){return this.axios.put("/".concat(e,"/chat/suggestions/edit/dismiss-domain-suggestion"))}deployApp(e,t){const s=t?{checkpoint_id:t}:void 0;return this.axios.post("/".concat(e,"/deploy"),s)}installIntegration(e,t,s){return this.axios.post("/".concat(e,"/install-integration/").concat(t,"/").concat(s))}deleteIntegration(e,t,s){return this.axios.post("/".concat(e,"/delete-integration/").concat(t,"/").concat(s))}redeployFunction(e,t,s){return this.axios.post("/".concat(e,"/coding/redeploy-function/").concat(t),{code:s})}moveToWorkspace(e,t){return this.axios.post("/".concat(e,"/metadata/move-to-workspace"),{target_workspace_id:t})}updateSlug(e){let{appId:t,slug:s}=e;return this.axios.patch("/".concat(t,"/metadata/slug"),{slug:s})}loadFullConversation(e){let{appId:t,limit:s,skip:a}=e;return this.axios.get("/".concat(t,"/chat/full-conversation"),{params:{limit:s,skip:a}})}getOwnerEmail(e){return this.axios.get("/".concat(e,"/metadata/owner-email"))}filter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0;const r=super.filterParams(e,t,s,a,n);return l&&(r.filter_mode=l),this.axios.get("",{params:r}).then(e=>e.map(e=>this.parseInstance(e)))}}const zc=new Bc;var Hc=s(388),Vc=s(88276);function Wc(e){let{appId:t,appPlatformVersion:s,authSDK:a,onSuccess:n,onSwitchToRegister:l,onSwitchToResetPassword:r}=e;const[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)(""),[x,h]=(0,Y.useState)(!1);return(0,se.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(""),h(!0);try{if(3===s){const e=(0,yc.UU)({appId:t,serverUrl:(0,fe.wE)()}),s=await e.auth.loginViaEmailPassword(i,c);s&&n(s.user)}else{const e=await a.loginViaUsernamePassword(i,c);e&&((0,ee.O5)(e.access_token),n(e.user))}}catch(o){var l,r;m((null===(l=o.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail)||"Invalid email or password")}finally{h(!1)}},className:"space-y-4 sm:space-y-5",children:[(0,se.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsx)(On,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Hc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,se.jsx)(nl,{id:"email",type:"email",placeholder:"you@example.com",value:i,onChange:e=>o(e.target.value),required:!0,disabled:x,className:"pl-10 h-11 sm:h-12 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400"})]})]}),(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsx)(On,{htmlFor:"password",className:"text-sm font-medium text-slate-700",children:"Password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Vc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,se.jsx)(nl,{id:"password",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:c,onChange:e=>d(e.target.value),required:!0,disabled:x,className:"pl-10 h-11 sm:h-12 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400"})]})]})]}),u&&(0,se.jsx)(Dt,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,se.jsx)(Ot,{className:"text-red-700 text-sm",children:u})}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(zt,{type:"submit",disabled:x,className:"w-full h-11 sm:h-12 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:x?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign in"}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2 sm:gap-0",children:[(0,se.jsx)("button",{type:"button",onClick:r,className:"text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:"Forgot password?"}),(0,se.jsxs)("button",{type:"button",onClick:l,className:"text-sm text-slate-500 hover:text-slate-700 transition-colors",children:["Need an account? ",(0,se.jsx)("span",{className:"font-medium text-slate-700",children:"Sign up"})]})]})]})]})}function qc(e){let{authSDK:t,onSuccess:s,onSwitchToLogin:a,onSwitchToOtpVerification:n,appId:l}=e;const r=(0,J.Zp)(),[i,o]=(0,Y.useState)({email:"",password:"",confirmPassword:""}),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)(!1),x=(e,t)=>{o(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))};return(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("button",{type:"button",onClick:a,className:"flex items-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors -mb-2",children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4"}),"Back to sign in"]}),(0,se.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Create your account"}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),d(""),i.password===i.confirmPassword)if(i.password.length<8)d("Password must be at least 8 characters long");else{m(!0);try{const e=await t.register({email:i.email,password:i.password});e&&n(i.email,e.access_request_created)}catch(x){var s,a;const e=null===(s=x.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.extra_data;var l,o,c,u;if("access_request_needed"===(null==e?void 0:e.reason)&&null!=e&&e.app_id)r("/request-access?app_id=".concat(e.app_id,"&email=").concat(encodeURIComponent(i.email)));else d((null===(l=x.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.detail)||(null===(c=x.response)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.message)||"Registration failed. Please try again.")}finally{m(!1)}}else d("Passwords do not match")},className:"space-y-3 sm:space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsx)(On,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Hc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,se.jsx)(nl,{id:"email",type:"email",placeholder:"you@example.com",value:i.email,onChange:e=>x("email",e.target.value),required:!0,disabled:u,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400 text-sm sm:text-base"})]})]}),(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsx)(On,{htmlFor:"password",className:"text-sm font-medium text-slate-700",children:"Password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Vc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,se.jsx)(nl,{id:"password",type:"password",placeholder:"Min. 8 characters",value:i.password,onChange:e=>x("password",e.target.value),required:!0,disabled:u,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400 text-sm sm:text-base"})]})]}),(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsx)(On,{htmlFor:"confirmPassword",className:"text-sm font-medium text-slate-700",children:"Confirm Password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Vc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,se.jsx)(nl,{id:"confirmPassword",type:"password",placeholder:"Re-enter password",value:i.confirmPassword,onChange:e=>x("confirmPassword",e.target.value),required:!0,disabled:u,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400 text-sm sm:text-base"})]})]})]}),c&&(0,se.jsx)(Dt,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,se.jsx)(Ot,{className:"text-red-700 text-sm",children:c})}),(0,se.jsx)(zt,{type:"submit",disabled:u,className:"w-full h-10 sm:h-11 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:u?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):"Create account"})]})]})}var Yc=s(16243);function Gc(e){let{authSDK:t,appId:s,email:a,isAccessRequest:n=!1,onSuccess:l,onSwitchToLogin:r}=e;const i=(0,J.Zp)(),[o,c]=(0,Y.useState)(["","","","","",""]),[d,u]=(0,Y.useState)(""),[m,x]=(0,Y.useState)(""),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),v=(0,Y.useRef)([]);(0,Y.useEffect)(()=>{var e;null===(e=v.current[0])||void 0===e||e.focus()},[]);const b=e=>{e.preventDefault();const t=e.clipboardData.getData("text").slice(0,6),s=[...o];for(let r=0;r<t.length;r++)/^\d$/.test(t[r])&&(s[r]=t[r]);c(s);const a=s.findIndex(e=>!e);var n,l;-1!==a?null===(n=v.current[a])||void 0===n||n.focus():null===(l=v.current[5])||void 0===l||l.focus()};return(0,se.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,se.jsxs)("button",{type:"button",onClick:r,className:"flex items-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors -mb-2",children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4"}),"Back to sign in"]}),(0,se.jsxs)("div",{className:"text-center space-y-2",children:[(0,se.jsx)("div",{className:"mx-auto w-14 h-14 sm:w-16 sm:h-16 bg-slate-100 rounded-full flex items-center justify-center mb-3 sm:mb-4",children:(0,se.jsx)(Yc.A,{className:"h-7 w-7 sm:h-8 sm:w-8 text-slate-700"})}),(0,se.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Verify your email"}),(0,se.jsxs)("p",{className:"text-slate-600 text-sm sm:text-base",children:["We've sent a 6-digit code to",(0,se.jsx)("br",{}),(0,se.jsx)("span",{className:"font-medium text-slate-900",children:a})]})]}),(0,se.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(""),x("");const c=o.join("");if(6===c.length){p(!0);try{const e=n?await t.verifyAccessRequestOtp(a,c):await t.verifyOtp(a,c);e&&(n?(x("Email verified! Waiting for admin approval..."),setTimeout(()=>{i("/request-access?app_id=".concat(s,"&email=").concat(encodeURIComponent(a)))},1500)):e.access_token?((0,ee.O5)(e.access_token),await new Promise(e=>setTimeout(e,500)),l()):(x("Email verified successfully! Redirecting to login..."),setTimeout(()=>{r()},2e3)))}catch(h){var d,m;u((null===(d=h.response)||void 0===d||null===(m=d.data)||void 0===m?void 0:m.detail)||"Invalid verification code")}finally{p(!1)}}else u("Please enter all 6 digits")},className:"space-y-4 sm:space-y-6",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"flex gap-2 justify-center",children:o.map((e,t)=>(0,se.jsx)(nl,{ref:e=>v.current[t]=e,type:"text",inputMode:"numeric",pattern:"\\d{1}",maxLength:1,value:e,onChange:e=>((e,t)=>{if(t.length>1)return;const s=[...o];var a;s[e]=t,c(s),t&&e<5&&(null===(a=v.current[e+1])||void 0===a||a.focus())})(t,e.target.value),onKeyDown:e=>((e,t)=>{var s;"Backspace"===t.key&&!o[e]&&e>0&&(null===(s=v.current[e-1])||void 0===s||s.focus())})(t,e),onPaste:0===t?b:void 0,disabled:h||g,className:"w-11 h-11 sm:w-12 sm:h-12 text-center text-lg font-semibold bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl"},t))}),(0,se.jsx)("p",{className:"text-xs text-slate-500 text-center mt-3",children:"Enter the verification code sent to your email"})]}),d&&(0,se.jsx)(Dt,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,se.jsx)(Ot,{className:"text-red-700 text-sm",children:d})}),m&&(0,se.jsx)(Dt,{className:"bg-green-50/70 border-green-200 rounded-xl",children:(0,se.jsx)(Ot,{className:"text-green-700 text-sm",children:m})}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(zt,{type:"submit",disabled:h||g,className:"w-full h-10 sm:h-11 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:h?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify email"}),(0,se.jsx)("div",{className:"text-center",children:(0,se.jsxs)("p",{className:"text-sm text-slate-600",children:["Didn't receive the code?"," ",(0,se.jsx)("button",{type:"button",onClick:async()=>{u(""),x(""),f(!0);try{var e;n?await t.resendAccessRequestOtp(a):await t.resendOtp(a),x("New verification code sent to your email"),c(["","","","","",""]),null===(e=v.current[0])||void 0===e||e.focus()}catch(r){var s,l;u((null===(s=r.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.detail)||"Failed to resend code")}finally{f(!1)}},disabled:g||h,className:"font-medium text-slate-700 hover:text-slate-900 disabled:opacity-50 transition-colors",children:g?"Sending...":"Resend"})]})})]})]})]})}function Kc(e){let{authSDK:t,onSwitchToLogin:s}=e;const[a,n]=(0,Y.useState)(""),[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1);return i?(0,se.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,se.jsxs)("div",{className:"text-center space-y-3 sm:space-y-4",children:[(0,se.jsx)("div",{className:"mx-auto w-14 h-14 sm:w-16 sm:h-16 bg-slate-100 rounded-full flex items-center justify-center",children:(0,se.jsx)(Hc.A,{className:"h-7 w-7 sm:h-8 sm:w-8 text-slate-700"})}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Check your email"}),(0,se.jsxs)("p",{className:"text-slate-600 text-sm sm:text-base",children:["We've sent password reset instructions to",(0,se.jsx)("br",{}),(0,se.jsx)("span",{className:"font-medium text-slate-900",children:a})]})]})]}),(0,se.jsx)(Dt,{className:"bg-green-50/70 border-green-200 rounded-xl",children:(0,se.jsx)(Ot,{className:"text-green-700 text-sm",children:"Please check your email for the password reset link. It may take a few minutes to arrive."})}),(0,se.jsxs)("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4"}),"Back to sign in"]})]}):(0,se.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,se.jsxs)("button",{type:"button",onClick:s,className:"flex items-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors -mb-2",children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4"}),"Back to sign in"]}),(0,se.jsxs)("div",{className:"text-center space-y-2",children:[(0,se.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Reset your password"}),(0,se.jsx)("p",{className:"text-slate-600 text-sm sm:text-base",children:"Enter your email and we'll send you a link to reset your password"})]}),(0,se.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),r(""),o(!1),d(!0);try{await t.resetPasswordRequest(a),o(!0)}catch(l){var s,n;r((null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.detail)||"Failed to send reset email")}finally{d(!1)}},className:"space-y-4 sm:space-y-5",children:[(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsx)(On,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Hc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,se.jsx)(nl,{id:"email",type:"email",placeholder:"you@example.com",value:a,onChange:e=>n(e.target.value),required:!0,disabled:c,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400"})]})]}),l&&(0,se.jsx)(Dt,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,se.jsx)(Ot,{className:"text-red-700 text-sm",children:l})}),(0,se.jsx)(zt,{type:"submit",disabled:c,className:"w-full h-10 sm:h-11 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:c?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):"Send reset link"})]})]})}function $c(e){return(null==e?void 0:e.auth_config)||{enable_username_password:!1,enable_google_login:!0,enable_microsoft_login:!1,enable_facebook_login:!1,enable_sso_login:!1,sso_provider_name:null}}const Zc=()=>(0,se.jsxs)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,se.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,se.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,se.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),Jc=()=>(0,se.jsxs)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{fill:"#F25022",d:"M1 1h10v10H1z"}),(0,se.jsx)("path",{fill:"#00A4EF",d:"M13 1h10v10H13z"}),(0,se.jsx)("path",{fill:"#7FBA00",d:"M1 13h10v10H1z"}),(0,se.jsx)("path",{fill:"#FFB900",d:"M13 13h10v10H13z"})]}),Qc=()=>(0,se.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{fill:"#1877F2",d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})});function Xc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return function(e){if(!e)return!1;try{const s=decodeURIComponent(e);if(s.match(/^(javascript|data|vbscript|file|about):/i))return!1;if(s.startsWith("/")&&!s.startsWith("//"))return!s.includes(":");let a;try{a=new URL(s)}catch(t){return!1}return!!["http:","https:"].includes(a.protocol)}catch(s){return!1}}(e)?e:t}const ed={google:{name:"Google",icon:Zc},microsoft:{name:"Microsoft",icon:Jc},github:{name:"GitHub",icon:()=>(0,se.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{fill:"#181717",d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})},okta:{name:"Okta",icon:()=>(0,se.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{fill:"#007DC1",d:"M12 0C5.383 0 0 5.383 0 12s5.383 12 12 12 12-5.383 12-12S18.617 0 12 0zm0 4.8c3.971 0 7.2 3.229 7.2 7.2s-3.229 7.2-7.2 7.2S4.8 15.971 4.8 12 8.029 4.8 12 4.8z"})})}};function td(e){var t;let{appId:s}=e;const a=(0,J.zy)(),n=je(s,()=>{},{}),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)("login"),[x,h]=(0,Y.useState)(""),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(!1),b=new URLSearchParams(a.search),j=e=>{const t=Xc(b.get("from_url"),"/"),a=b.get("app_id")||s;let n;n="google"===e?"".concat((0,fe.Zk)(),"/apps/auth/login?from_url=").concat(encodeURIComponent(t)):"".concat((0,fe.Zk)(),"/apps/auth/").concat(e,"/login?from_url=").concat(encodeURIComponent(t)),a&&(n+="&app_id=".concat(a)),be(n)},y=()=>{const e=Xc(b.get("from_url"),"/"),t=b.get("app_id")||s;let a;_.use_workspace_sso&&null!=c&&c.organization_id?a="".concat((0,fe.Zk)(),"/apps/").concat(c.organization_id,"/").concat(t,"/auth/sso/login?from_url=").concat(encodeURIComponent(e)):(a="".concat((0,fe.Zk)(),"/apps/").concat(t,"/auth/sso/login?from_url=").concat(encodeURIComponent(e)),t&&(a+="&app_id=".concat(t))),be(a)},N=e=>{const t=Xc(b.get("from_url"),"/");window.location.href=t},w=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];h(e),g(t),m("otp")},_=$c(c),k=[{id:"google",name:"Google",enabled:!1!==_.enable_google_login,handler:()=>j("google"),icon:Zc},{id:"microsoft",name:"Microsoft",enabled:_.enable_microsoft_login,handler:()=>j("microsoft"),icon:Jc},{id:"facebook",name:"Facebook",enabled:_.enable_facebook_login,handler:()=>j("facebook"),icon:Qc}],C=_.enable_sso_login||_.use_workspace_sso?[]:k.filter(e=>e.enabled),A=e=>{const t=e.icon;return(0,se.jsxs)("button",{onClick:e.handler,className:"w-full flex items-center justify-center gap-3 bg-white text-slate-700 px-5 py-3.5 rounded-xl border border-slate-200 hover:bg-slate-50 hover:border-slate-300 hover:shadow-sm transition-all duration-200 font-medium text-[16px] group",children:[(0,se.jsx)("div",{className:" transition-transform duration-200 ".concat("google"===e.id?"-ml-4":""),children:(0,se.jsx)(t,{})}),(0,se.jsxs)("span",{children:["Continue with ",e.name]})]},e.id)},S=()=>{if(!_.sso_provider_name||!1===_.enable_sso_login)return null;const e=ed[_.sso_provider_name],t=e?"Continue with ".concat(e.name):"Continue with ".concat(_.sso_provider_name," SSO"),s=null==e?void 0:e.icon;return(0,se.jsxs)("button",{onClick:y,className:"w-full flex items-center justify-center gap-3 bg-white text-slate-700 px-5 py-3.5 rounded-xl border border-slate-200 hover:bg-slate-50 hover:border-slate-300 hover:shadow-sm transition-all duration-200 font-medium text-[15px] group",children:[s&&(0,se.jsx)("div",{className:"group-hover:scale-110 transition-transform duration-200",children:(0,se.jsx)(s,{})}),(0,se.jsx)("span",{children:t})]})};if((0,Y.useEffect)(()=>{(async()=>{try{const e=await zc.getLoginInfoById(s);if(e.not_published)return v(!0),void r(!1);d(e),r(!1)}catch(i){o(i),r(!1)}})()},[s]),l)return(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100",children:(0,se.jsx)("div",{className:"p-8",children:(0,se.jsx)(Ac.A,{className:"h-10 w-10 animate-spin text-slate-400"})})});if(f)return(0,se.jsx)(Fc,{});if(i)return(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100",children:(0,se.jsx)("div",{className:"p-8 text-base font-medium text-red-600 bg-white rounded-2xl shadow-sm border border-red-100",children:"An error occurred while loading the app"})});return(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 p-4",children:(0,se.jsxs)("div",{className:"w-full max-w-md",children:[(0,se.jsxs)(Es,{className:"relative overflow-hidden border-0 shadow-2xl bg-white/95 backdrop-blur-sm rounded-2xl",children:[(0,se.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-slate-200 via-slate-300 to-slate-200"}),(0,se.jsx)(Ls,{className:"p-8 sm:p-10 md:pt-12 md:pb-10 md:px-10",children:(0,se.jsxs)("div",{className:"flex flex-col items-center text-center space-y-6 sm:space-y-8",children:[(null==c?void 0:c.logo_url)&&"login"===u&&(0,se.jsxs)("div",{className:"relative group",children:[(0,se.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-200 to-slate-300 rounded-full blur-xl opacity-30 group-hover:opacity-40 transition-opacity duration-300"}),(0,se.jsxs)(us,{className:"relative h-20 w-20 sm:h-24 sm:w-24 shadow-lg ring-4 ring-white/50 group-hover:shadow-xl transition-all duration-300",children:[(0,se.jsx)(ms,{src:c.logo_url,alt:"".concat(c.name," logo"),className:"object-cover"}),(0,se.jsx)(xs,{className:"bg-gradient-to-br from-slate-100 to-slate-200 text-xl sm:text-2xl font-bold text-slate-700",children:null===(t=c.name)||void 0===t?void 0:t[0]})]})]}),"login"===u&&(0,se.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,se.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 tracking-tight",children:["Welcome to ",null==c?void 0:c.name]}),(0,se.jsx)("p",{className:"text-slate-500 text-sm sm:text-base font-medium",children:"Sign in to continue"})]}),(0,se.jsx)("div",{className:"w-full",children:(()=>{if(_.enable_username_password)switch(u){case"register":return(0,se.jsx)(qc,{authSDK:n,appId:s,onSuccess:N,onSwitchToLogin:()=>m("login"),onSwitchToOtpVerification:w});case"otp":return(0,se.jsx)(Gc,{authSDK:n,appId:s,email:x,isAccessRequest:p,onSuccess:N,onSwitchToLogin:()=>m("login")});case"reset":return(0,se.jsx)(Kc,{authSDK:n,onSwitchToLogin:()=>m("login")});default:return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"space-y-3",children:[C.map(e=>A(e)),S()]}),(C.length>0||S())&&(0,se.jsxs)("div",{className:"relative my-6",children:[(0,se.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,se.jsx)(Tr,{className:"w-full bg-slate-200"})}),(0,se.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,se.jsx)("span",{className:"bg-white px-3 text-slate-400 font-medium tracking-wider",children:"or"})})]}),(0,se.jsx)(Wc,{appId:s,appPlatformVersion:null==c?void 0:c.platform_version,authSDK:n,onSuccess:N,onSwitchToRegister:()=>m("register"),onSwitchToResetPassword:()=>m("reset")})]})}return(0,se.jsxs)("div",{className:"space-y-3",children:[C.map(e=>A(e)),S()]})})()})]})})]}),(0,se.jsx)("div",{className:"mt-8 text-center text-xs text-slate-400 sm:hidden",children:(0,se.jsx)("p",{children:"\xa0"})})]})})}var sd=s(45833),ad=s(52828);function nd(e){let{appId:t}=e;const s=(0,J.zy)(),a=(0,J.Zp)(),n=je(t,()=>{},{}),l=new URLSearchParams(s.search).get("token"),[r,i]=(0,Y.useState)({password:"",confirmPassword:""}),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(!0);(0,Y.useEffect)(()=>{(async()=>{try{const e=await zc.getLoginInfoById(t);p(e)}catch(o){}finally{f(!1)}})(),l||c("Invalid reset link. Please request a new password reset.")},[l,t]);const v=(e,t)=>{i(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))};return g?(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,se.jsx)("div",{className:"p-8",children:(0,se.jsx)(Ac.A,{className:"h-10 w-10 animate-spin text-gray-600"})})}):m?(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,se.jsx)(Es,{className:"max-w-md w-full overflow-hidden border-0 shadow-lg bg-white",children:(0,se.jsxs)(Ls,{className:"pt-12 pb-10 px-12 text-center space-y-6",children:[(0,se.jsx)("div",{className:"mx-auto w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center",children:(0,se.jsx)(sd.A,{className:"h-10 w-10 text-green-600"})}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Password reset successful!"}),(0,se.jsx)("p",{className:"text-gray-600",children:"Your password has been reset. Redirecting to login..."})]}),(null==h?void 0:h.name)&&(0,se.jsxs)("p",{className:"text-sm text-gray-500",children:["You can now sign in to ",h.name," with your new password"]})]})})}):l?(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,se.jsxs)(Es,{className:"relative max-w-md w-full overflow-hidden border-0 shadow-lg bg-white",children:[(0,se.jsx)("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-gray-900"}),(0,se.jsxs)(Ls,{className:"pt-12 pb-10 px-12 space-y-8",children:[(0,se.jsxs)("div",{className:"text-center space-y-2",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Set new password"}),(0,se.jsx)("p",{className:"text-gray-600",children:null!=h&&h.name?"Enter your new password for ".concat(h.name):"Please enter your new password below"})]}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),c(""),r.password===r.confirmPassword)if(r.password.length<8)c("Password must be at least 8 characters long");else{u(!0);try{await n.resetPassword(l,r.password),x(!0),setTimeout(()=>{a("/login")},3e3)}catch(i){var t,s;c((null===(t=i.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"Failed to reset password. The link may have expired.")}finally{u(!1)}}else c("Passwords do not match")},className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-5",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"New Password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Vc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,se.jsx)(nl,{id:"password",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:r.password,onChange:e=>v("password",e.target.value),required:!0,disabled:d,className:"pl-10 h-11 bg-gray-50/50 border-gray-200 focus:border-gray-400 focus:ring-gray-400"})]}),(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"Must be at least 8 characters"})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Vc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,se.jsx)(nl,{id:"confirmPassword",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:r.confirmPassword,onChange:e=>v("confirmPassword",e.target.value),required:!0,disabled:d,className:"pl-10 h-11 bg-gray-50/50 border-gray-200 focus:border-gray-400 focus:ring-gray-400"})]})]})]}),o&&(0,se.jsx)(Dt,{className:"bg-red-50/50 border-red-200",children:(0,se.jsx)(Ot,{className:"text-red-800 text-sm",children:o})}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(zt,{type:"submit",disabled:d,className:"w-full h-11 bg-gray-900 hover:bg-gray-800 text-white font-medium shadow-sm",children:d?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Resetting password..."]}):"Reset password"}),(0,se.jsx)("button",{type:"button",onClick:()=>a("/login"),className:"w-full text-sm text-gray-600 hover:text-gray-700",children:"Back to login"})]})]})]})]})}):(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,se.jsx)(Es,{className:"max-w-md w-full overflow-hidden border-0 shadow-lg bg-white",children:(0,se.jsxs)(Ls,{className:"pt-12 pb-10 px-12 text-center space-y-6",children:[(0,se.jsx)("div",{className:"mx-auto w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:(0,se.jsx)(ad.A,{className:"h-10 w-10 text-red-600"})}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Invalid Reset Link"}),(0,se.jsx)("p",{className:"text-gray-600",children:"This password reset link is invalid or has expired."})]}),(0,se.jsx)(zt,{onClick:()=>a("/login"),className:"w-full h-11 bg-gray-900 hover:bg-gray-800 text-white font-medium shadow-sm",children:"Back to Login"})]})})})}function ld(e){let{appId:t}=e;const[s]=(0,Z.useSearchParams)(),a=s.get("email");return(0,se.jsxs)("div",{className:"min-h-screen bg-slate-50 p-4",children:[(0,se.jsx)("div",{className:"absolute top-6 left-6",children:(0,se.jsx)("a",{href:"https://app.base44.com",target:"_blank",rel:"noopener noreferrer",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",width:"114",height:"28"})})}),(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,se.jsx)(Es,{className:"w-full max-w-[450px] border border-slate-200 shadow-sm bg-white rounded-xl",children:(0,se.jsx)(Ls,{className:"p-10 pt-12 pb-10",children:(0,se.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,se.jsx)("div",{className:"w-14 h-14 rounded-xl bg-orange-50 flex items-center justify-center mb-8",children:(0,se.jsx)(Vc.A,{className:"w-7 h-7 text-orange-500"})}),(0,se.jsx)("h1",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"Access requested"}),(0,se.jsx)("p",{className:"text-slate-500 text-base mb-8",children:"Your access request has been submitted successfully."}),(0,se.jsxs)("div",{className:"w-full flex items-center gap-3 p-4 bg-teal-50 rounded-xl border border-teal-100 mb-6",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 flex items-center justify-center",children:(0,se.jsx)(Ds.A,{className:"w-5 h-5 text-teal-600"})}),(0,se.jsxs)("div",{className:"flex-1 text-left",children:[(0,se.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Request submitted successfully!"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"You'll receive an email when the app admin approves your request."})]})]}),a&&(0,se.jsxs)("div",{className:"mt-8 flex flex-col items-center gap-1",children:[(0,se.jsxs)("p",{className:"text-sm text-slate-500",children:["You're logged in as ",a]}),(0,se.jsx)("button",{onClick:()=>{window.location.href="/login?app_id=".concat(t)},className:"text-sm font-medium text-blue-600 hover:text-blue-700 hover:underline",children:"Switch account"})]})]})})})})]})}function rd(e){let{}=e;const[t,s]=(0,Y.useState)(null),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(!0),i=window.location.host.includes("localhost")?window.location.host:window.location.hostname,[o]=(0,Y.useState)(()=>new Q.E);return(0,Y.useEffect)(()=>{zc.getDomainAppId(i).then(e=>{s(e),window.appId=e,r(!1)}).catch(e=>{n(!0),r(!1)})},[]),l?(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,se.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-black rounded-full animate-spin"})}):a?(0,se.jsxs)("div",{className:"relative font-base44 w-full min-h-screen overflow-hidden bg-gradient-to-br from-slate-50 via-orange-50/30 to-orange-100/40",children:[(0,se.jsx)("div",{className:"absolute right-0 bottom-0 translate-x-1/2 translate-y-1/2 w-[800px] h-[800px] bg-orange-400/20 rounded-full mix-blend-multiply filter blur-[120px]"}),(0,se.jsx)("div",{className:"absolute right-0 bottom-0 translate-x-1/2 translate-y-1/2 w-[600px] h-[600px] bg-yellow-300/25 rounded-full mix-blend-multiply filter blur-[100px]"}),(0,se.jsx)("div",{className:"absolute right-0 bottom-0 translate-x-1/2 translate-y-1/2 w-[500px] h-[500px] bg-orange-500/15 rounded-full mix-blend-multiply filter blur-[80px]"}),(0,se.jsx)("div",{className:"absolute top-0 left-0 w-full px-[4%] md:px-[60px] py-4 md:py-6 flex items-center gap-5 md:gap-10 z-10",children:(0,se.jsx)("div",{className:"flex items-center w-[114px] h-[28px]",children:(0,se.jsx)("img",{src:"https://app.base44.com/Logo_v5.png",alt:"Base44",width:"114",height:"28"})})}),(0,se.jsx)("div",{className:"relative z-10 flex items-start md:items-center min-h-screen px-[4%] md:pl-[4%] pt-32 md:pt-0 pb-30 md:pb-0",children:(0,se.jsxs)("div",{className:"w-full max-w-6xl",children:[(0,se.jsx)("div",{className:"text-[20px] md:text-[32px] font-normal mb-4 tracking-[0.1em] md:tracking-[0.05em] text-[#001E36]",children:"ERROR: 404"}),(0,se.jsx)("h1",{className:"text-[48px] md:text-[100px] font-[300] leading-[52px] md:leading-[109px] tracking-[0.02em] md:tracking-[-1px] m-0 text-[#001E36]",children:"This app was not found"}),(0,se.jsxs)("div",{className:"text-[18px] md:text-[24px] text-black leading-relaxed mt-8 font-[300] tracking-[0.01em] md:tracking-normal",children:["This usually happens when the app's subdomain has been changed, the app has been deleted, or there's a typo in the URL.",(0,se.jsx)("br",{}),(0,se.jsx)("br",{}),"Are you looking for Base44?",(0,se.jsx)("br",{}),(0,se.jsx)("a",{href:"https://app.base44.com",className:"text-slate-800 underline decoration-1 underline-offset-2 hover:text-orange-600 transition-colors",children:"Visit Base44 home \u2192"})]})]})}),(0,se.jsx)("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 text-center px-5 z-10",children:(0,se.jsxs)("div",{className:"text-sm md:text-[0.875rem] text-black tracking-[0.02em] whitespace-nowrap",children:["Need help? visit our"," ",(0,se.jsx)("a",{href:"https://app.base44.com/support",className:"text-black underline decoration-1 underline-offset-2 hover:text-slate-800 transition-colors",children:"support center"})]})})]}):(0,se.jsxs)(Z.BrowserRouter,{children:[(0,se.jsx)("div",{children:(0,se.jsx)($.Toaster,{})}),(0,se.jsx)("div",{children:(0,se.jsx)(io,{})}),(0,se.jsx)("div",{children:(0,se.jsx)($.Toaster,{})}),(0,se.jsx)(re,{appId:t,children:(0,se.jsx)(X.Ht,{client:o,children:(0,se.jsxs)(J.BV,{children:[(0,se.jsx)(J.qh,{path:"/login",element:(0,se.jsx)(td,{appId:t})}),(0,se.jsx)(J.qh,{path:"/reset-password",element:(0,se.jsx)(nd,{appId:t})}),(0,se.jsx)(J.qh,{path:"/request-access",element:(0,se.jsx)(ld,{appId:t})}),(0,se.jsx)(J.qh,{path:"/:pageName?",element:(0,se.jsx)(Uc,{appId:t})})]})})})]})}const id=!1;function od(){return!(!window.wixMobileNativeBridge||"function"!=typeof window.wixMobileNativeBridge||!window.wixMobileNativeBridge.general.getHostName)}let cd=new Set,dd=new Set,ud=!1,md=null;function xd(e){ud||cd.add(e)}function hd(e){ud||(dd.add(e),md&&cancelAnimationFrame(md),md=requestAnimationFrame(()=>{md=requestAnimationFrame(()=>{!function(){if(ud)return;if(0===cd.size)return;const e=Array.from(cd).every(e=>dd.has(e));if(!e)return;var t;ud=!0,od()&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.actions.onContentReady&&window.wixMobileNativeBridge.base44.actions.onContentReady().catch(e=>{})}()})}))}function pd(){md&&(cancelAnimationFrame(md),md=null),cd=new Set,dd=new Set,ud=!1}function gd(e){var t,s;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank",n=arguments.length>2?arguments[2]:void 0;const l="string"==typeof e?e:e.url,r="string"==typeof e?a:null!==(t=e.target)&&void 0!==t?t:"_blank",i="string"==typeof e?n:e.features;if(od()&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.linking.openUrl){const e=function(e){if(e.startsWith("http://")||e.startsWith("https://"))return e;const t=window.location.origin;return e.startsWith("/")?"".concat(t).concat(e):"".concat(t,"/").concat(e)}(l);window.wixMobileNativeBridge.base44.linking.openUrl({url:e})}else window.open(l,r,i)}function fd(){return(0,Y.useMemo)(()=>{const e=od();return{isNativeMobile:e,general:{getHostName:async()=>{var t;if(e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.general.getHostName)return await window.wixMobileNativeBridge.base44.general.getHostName()}},actions:{onContentReady:async()=>{var t;if(e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.actions.onContentReady)return await window.wixMobileNativeBridge.base44.actions.onContentReady()},onError:async()=>{var t;if(e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.actions.onError)return await window.wixMobileNativeBridge.base44.actions.onError()},onItemClicked:async t=>{var s;let{id:a,data:n}=t;if(e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.actions.onItemClicked)return await window.wixMobileNativeBridge.base44.actions.onItemClicked({id:a,data:n})},addAppProcess:async t=>{var s;let{appId:a,appName:n}=t;if(e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.actions.addAppProcess)return await window.wixMobileNativeBridge.base44.actions.addAppProcess({appId:a,appName:n})}},navigation:{openBottomSheet:async t=>{var s;let{uri:a,maxHeightPercentage:n}=t;e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.navigation.openBottomSheet&&await window.wixMobileNativeBridge.base44.navigation.openBottomSheet({uri:a,maxHeightPercentage:n})},showModal:async t=>{var s;let{screenName:a,passProps:n}=t;e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.navigation.showModal&&await window.wixMobileNativeBridge.base44.navigation.showModal({screenName:a,passProps:n})},showWebViewDialog:async t=>{var s;let{url:a,widthPercentage:n,heightPercentage:l}=t;if(e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.navigation.showWebViewDialog)return await window.wixMobileNativeBridge.base44.navigation.showWebViewDialog({url:a,widthPercentage:n,heightPercentage:l})},switchToTab:async t=>{var s;let{screenId:a}=t;e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.navigation.switchToTab&&await window.wixMobileNativeBridge.base44.navigation.switchToTab({screenId:a})},dismissOverlay:async()=>{var t;e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.navigation.dismissOverlay&&await window.wixMobileNativeBridge.base44.navigation.dismissOverlay()},dismissModal:async()=>{var t;e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.navigation.dismissModal&&await window.wixMobileNativeBridge.base44.navigation.dismissModal()},dismissAllModals:async()=>{var t;e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.navigation.dismissAllModals&&await window.wixMobileNativeBridge.base44.navigation.dismissAllModals()},notifyWebOverlayVisibilityChanged:async t=>{var s;let{isVisible:a,color:n}=t;e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.navigation.notifyWebOverlayVisibilityChanged&&await window.wixMobileNativeBridge.base44.navigation.notifyWebOverlayVisibilityChanged({isVisible:a,color:n})},push:async t=>{var s;let{screenName:a,passProps:n}=t;e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.navigation.push&&await window.wixMobileNativeBridge.base44.navigation.push({screenName:a,passProps:n})},pop:async()=>{var t;e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.navigation.pop&&await window.wixMobileNativeBridge.base44.navigation.pop()}},linking:{openUrl:async t=>{var s;let{url:a}=t;if(e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.linking.openUrl)return await window.wixMobileNativeBridge.base44.linking.openUrl({url:a})}},platform:{os:async()=>{var t;if(e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.platform.os)return await window.wixMobileNativeBridge.base44.platform.os()},countryCode:async()=>{var t;if(e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.platform.countryCode)return await window.wixMobileNativeBridge.base44.platform.countryCode()},setActiveWorkSpace:async t=>{var s;let{workspaceId:a}=t;if(e&&null!==(s=window.wixMobileNativeBridge)&&void 0!==s&&s.base44.platform.setActiveWorkSpace)return await window.wixMobileNativeBridge.base44.platform.setActiveWorkSpace({workspaceId:a})},getLatestActiveWorkSpace:async()=>{var t;if(e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.platform.getLatestActiveWorkSpace)return await window.wixMobileNativeBridge.base44.platform.getLatestActiveWorkSpace()}},auth:{logOut:async()=>{var t;if(e&&null!==(t=window.wixMobileNativeBridge)&&void 0!==t&&t.base44.auth.logOut)return await window.wixMobileNativeBridge.base44.auth.logOut()}}}},[])}var vd=s(36642);class bd extends te.y{getBaseURL(){return"/auth"}getCurrentUser(){return this.axios.get("/me")}regenerateApiKey(){return this.axios.post("/regenerate_api_key")}updateUser(e,t){return this.axios.post("/".concat(e,"/update-user"),(0,ue.A)({},t))}listUsers(e){return this.axios.get("/list-users",{params:e})}async checkDomainSSO(e){try{return(await vd.A.get("".concat((0,fe.Gt)(),"/workspace/public/sso/check-email-or-domain"),{params:{email_or_domain:e}})).data}catch(t){return{has_sso:!1}}}login(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={email:e,password:t};return s&&(a.turnstile_token=s),this.axios.post("/login",a)}register(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const l={email:e,password:t};return s&&(l.turnstile_token=s),a&&(l.referral_code=a),n&&(l.marketing_client_id=n),this.axios.post("/register",l)}verifyOtp(e,t){return this.axios.post("/verify-otp",{email:e,otp_code:t})}resendOtp(e){return this.axios.post("/resend-otp",{email:e})}resetPasswordRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s={email:e};return t&&(s.turnstile_token=t),this.axios.post("/reset-password-request",s)}resetPassword(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={reset_token:e,new_password:t};return s&&(a.turnstile_token=s),this.axios.post("/reset-password",a)}changePassword(e,t,s){return this.axios.post("/change-password",{user_id:e,current_password:t,new_password:s})}getUserFeatureFlags(e){return this.axios.get("/".concat(e,"/feature-flags"))}}const jd=new bd,yd=(0,Y.createContext)(),Nd=e=>{let{children:t}=e;const[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!0),o=()=>{localStorage.removeItem("token"),localStorage.removeItem("base44_access_token"),(0,me.xL)("Authorization"),a(null),l(!1),i(!1)};(0,Y.useEffect)(()=>{const e=(0,ee.VO)(!0);e?(localStorage.setItem("token",e),(0,me.yI)("Authorization","Bearer ".concat(e)),c()):i(!1),(0,me.Vp)(e=>{(e=>{var t;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)})(e)&&o()})},[]);const c=async()=>{try{i(!0);const e=await jd.getCurrentUser();return a(e),l(!0),i(!1),e}catch(t){var e;i(!1);const s=null===(e=t.response)||void 0===e?void 0:e.status;401!==s&&403!==s||o()}},d=(0,Y.useCallback)(async()=>{const e=await jd.getCurrentUser();e&&a(e)},[]);return(0,se.jsx)(yd.Provider,{value:{user:s,isAuthenticated:n,logout:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(o(),l(!1),a(null),e){const e=encodeURIComponent(window.location.href);window.location.href="/login?from_url="+e}},isLoadingAuth:r,updateUser:e=>{a(e)},reloadUser:d},children:t})},wd=()=>(0,Y.useContext)(yd);var _d=s(93796);const kd={applicationId:"db50c921-10c3-4f12-bccb-950fa174b708",clientToken:"pubfe8a4f2972b412b4556fd67e77f82cb4",site:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_APPS_BASE_DOMAIN:"base44.app",REACT_APP_DATADOG_APPLICATION_ID:"db50c921-10c3-4f12-bccb-950fa174b708",REACT_APP_TURNSTILE_ENABLED:"true",REACT_APP_PLATFORM_URL:"https://app.base44.com",REACT_APP_SDK_BACKEND_URL:"https://base44.app",REACT_APP_DATADOG_CLIENT_TOKEN:"pubfe8a4f2972b412b4556fd67e77f82cb4",REACT_APP_TURNSTILE_SITE_KEY:"0x4AAAAAABkwg1ZNNlkay6SI",REACT_APP_BACKEND_URL:"https://app.base44.com",REACT_APP_WS_BACKEND_URL:"https://ws.base44.com",REACT_APP_GOOGLE_CLIENT_ID:"185178814199-6a35e9aqcmlm15ig0upncg07c91av8do.apps.googleusercontent.com"}.REACT_APP_DATADOG_SITE||"datadoghq.com",service:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_APPS_BASE_DOMAIN:"base44.app",REACT_APP_DATADOG_APPLICATION_ID:"db50c921-10c3-4f12-bccb-950fa174b708",REACT_APP_TURNSTILE_ENABLED:"true",REACT_APP_PLATFORM_URL:"https://app.base44.com",REACT_APP_SDK_BACKEND_URL:"https://base44.app",REACT_APP_DATADOG_CLIENT_TOKEN:"pubfe8a4f2972b412b4556fd67e77f82cb4",REACT_APP_TURNSTILE_SITE_KEY:"0x4AAAAAABkwg1ZNNlkay6SI",REACT_APP_BACKEND_URL:"https://app.base44.com",REACT_APP_WS_BACKEND_URL:"https://ws.base44.com",REACT_APP_GOOGLE_CLIENT_ID:"185178814199-6a35e9aqcmlm15ig0upncg07c91av8do.apps.googleusercontent.com"}.REACT_APP_DATADOG_SERVICE||"base44-frontend",version:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_APPS_BASE_DOMAIN:"base44.app",REACT_APP_DATADOG_APPLICATION_ID:"db50c921-10c3-4f12-bccb-950fa174b708",REACT_APP_TURNSTILE_ENABLED:"true",REACT_APP_PLATFORM_URL:"https://app.base44.com",REACT_APP_SDK_BACKEND_URL:"https://base44.app",REACT_APP_DATADOG_CLIENT_TOKEN:"pubfe8a4f2972b412b4556fd67e77f82cb4",REACT_APP_TURNSTILE_SITE_KEY:"0x4AAAAAABkwg1ZNNlkay6SI",REACT_APP_BACKEND_URL:"https://app.base44.com",REACT_APP_WS_BACKEND_URL:"https://ws.base44.com",REACT_APP_GOOGLE_CLIENT_ID:"185178814199-6a35e9aqcmlm15ig0upncg07c91av8do.apps.googleusercontent.com"}.REACT_APP_GIT_SHA||"unknown"};let Cd=!1;function Ad(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Cd)return;if(!kd.applicationId||!kd.clientToken)return;const t=function(){const e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"development":e.includes("staging")||e.includes("preview")||e.endsWith(".velino.org")||"velino.org"===e?"staging":"production"}();if("development"!==t||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_APPS_BASE_DOMAIN:"base44.app",REACT_APP_DATADOG_APPLICATION_ID:"db50c921-10c3-4f12-bccb-950fa174b708",REACT_APP_TURNSTILE_ENABLED:"true",REACT_APP_PLATFORM_URL:"https://app.base44.com",REACT_APP_SDK_BACKEND_URL:"https://base44.app",REACT_APP_DATADOG_CLIENT_TOKEN:"pubfe8a4f2972b412b4556fd67e77f82cb4",REACT_APP_TURNSTILE_SITE_KEY:"0x4AAAAAABkwg1ZNNlkay6SI",REACT_APP_BACKEND_URL:"https://app.base44.com",REACT_APP_WS_BACKEND_URL:"https://ws.base44.com",REACT_APP_GOOGLE_CLIENT_ID:"185178814199-6a35e9aqcmlm15ig0upncg07c91av8do.apps.googleusercontent.com"}.REACT_APP_DATADOG_ENABLE_DEV)try{_d.L.init({applicationId:kd.applicationId,clientToken:kd.clientToken,site:kd.site,service:kd.service,env:t,version:kd.version,sessionSampleRate:100,sessionReplaySampleRate:10,defaultPrivacyLevel:"mask-user-input",trackUserInteractions:!0,trackResources:!0,trackLongTasks:!0}),_d.L.startSessionReplayRecording(),Cd=!0,e.appContext&&_d.L.setGlobalContextProperty("app_context",e.appContext),e.user&&Sd(e.user)}catch(s){}}function Sd(e){Cd&&(e?_d.L.setUser({id:e.id}):_d.L.clearUser())}function Ed(){return Cd}let Td=function(e){return e.CREATE_APP_STARTED="create_app_started",e.CREATE_APP_SUCCESS="create_app_success",e.APP_DELETED="app_deleted",e.APP_PUBLISHED="app_published",e.APP_DUPLICATED="app_duplicated",e.EDITOR_PROMPT_SENT="editor_prompt_sent",e.EDITOR_CODE_EDITED="editor_code_edited",e.EDITOR_PREVIEW_REFRESHED="editor_preview_refreshed",e.USER_SIGNED_UP="user_signed_up",e.USER_LOGGED_IN="user_logged_in",e.USER_LOGGED_OUT="user_logged_out",e.PLAN_UPGRADE_STARTED="plan_upgrade_started",e.PLAN_UPGRADE_COMPLETED="plan_upgrade_completed",e.WORKSPACE_CREATED="workspace_created",e.WORKSPACE_MEMBER_INVITED="workspace_member_invited",e}({}),Id=function(e){return e.API="api",e.BUSINESS="business",e.ASYNC="async",e.EVENT_HANDLER="event_handler",e.REACT="react",e.CUSTOM="custom",e}({});function Pd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{source:s=Id.CUSTOM,context:a={},component:n}=t;if(Ed())try{const t=function(e){if(e instanceof Error)return e;if("string"==typeof e)return new Error(e);if("object"==typeof e&&null!==e){const t=e,s=t.message||t.error||JSON.stringify(e),a=new Error(s);return t.stack&&(a.stack=t.stack),a}return new Error(String(e))}(e);_d.L.addError(t,(0,ue.A)({error_source:s,component:n||"unknown"},a))}catch(l){}}function Ld(e,t){if(Ed())try{_d.L.addAction(e,t)}catch(s){}}let Md=!1;function Rd(){const{user:e,isLoadingAuth:t}=wd();return(0,Y.useEffect)(()=>{t||(Ad({appContext:"platform",user:e?{id:e.id}:null}),Md||((0,me.Vp)(e=>{var t;const s=e;401!==(null==s||null===(t=s.response)||void 0===t?void 0:t.status)&&function(e,t){const s=e,a=(0,ue.A)({},t);var n,l;null!=s&&s.config&&(a.url=a.url||s.config.url,a.method=a.method||s.config.method),null!=s&&s.response&&(a.statusCode=a.statusCode||s.response.status,a.responseData=(null===(n=s.response.data)||void 0===n?void 0:n.message)||(null===(l=s.response.data)||void 0===l?void 0:l.error)),Pd(e,{source:Id.API,component:"axiosClient",context:a})}(e)}),Md=!0))},[t,e]),(0,Y.useEffect)(()=>{t||Sd(e?{id:e.id}:null)},[e,t]),null}class Dd extends Y.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){Pd(e,{source:Id.REACT,component:this.props.componentName||"ErrorBoundary",context:{errorType:"react_render_error",componentStack:t.componentStack}})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:(0,se.jsxs)("div",{className:"text-center p-8 max-w-md",children:[(0,se.jsx)("h1",{className:"text-2xl font-semibold text-slate-900 mb-4",children:"Something went wrong"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:"We've been notified and are looking into it."}),(0,se.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:"Reload Page"})]})}):this.props.children}}var Fd=s(6221);function Od(e){if(!e||"string"!=typeof e)return!1;if(e.length<8||e.length>128)return!1;return/^[a-zA-Z0-9]+$/.test(e)}class Ud extends te.H{getBaseURL(){return"/workspace/invitations"}inviteUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=s?{workspaceId:s}:{};return this.axios.post("/invite",{email:e,role:t},{params:a})}bulkInviteUsers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=t?{workspaceId:t}:{};return this.axios.post("/bulk-invite",{invitations:e},{params:s})}getInvitationDetails(e){return Od(e)?this.axios.get("/".concat(e)):Promise.reject(new Error("Invalid invitation token format"))}acceptInvitation(e){return Od(e)?this.axios.post("/".concat(e,"/accept")):Promise.reject(new Error("Invalid invitation token format"))}declineInvitation(e){return Od(e)?this.axios.post("/".concat(e,"/decline")):Promise.reject(new Error("Invalid invitation token format"))}}const Bd=new Ud;class zd extends te.H{getBaseURL(){return"/workspace"}getWorkspaces(){return this.axios.get("/workspaces")}getAvailablePlans(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=e?{existingPriceIds:e.join(",")}:{};return this.axios.get("/available-plans",{params:t})}createWorkspace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.axios.post("/workspaces",{name:e,domain:t})}getDashboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=e?{workspaceId:e}:{};return this.axios.get("",{params:t})}subscribeToDashboard(e,t,s){const a="workspace/".concat(e,"/dashboard");return s(t),Fd.A.addListener(a,e=>{t=(0,ue.A)((0,ue.A)({},t),e),s(t,Object.keys(e))},async()=>{try{const t=await this.getDashboard(e);s(t,Object.keys(t))}catch(t){}})}updateWorkspace(e,t){const s=e?{workspaceId:e}:{};return this.axios.put("/update",t,{params:s})}inviteUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Bd.inviteUser(e,t,s)}bulkInviteUsers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Bd.bulkInviteUsers(e,t)}buySeats(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=s?{workspaceId:s}:{};return this.axios.post("/buy-seats",{plan:e,count:t},{params:a})}removeSeats(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=s?{workspaceId:s}:{};return this.axios.post("/remove-seats",{plan:e,count:t},{params:a})}updateMemberRole(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=s?{workspaceId:s}:{};return this.axios.put("/members/".concat(e,"/role"),{role:t},{params:a})}updateMemberSeat(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n=s?{workspaceId:s}:{},l={seat_type:t};return null!==a&&(l.seat_id=a),this.axios.put("/members/".concat(e,"/seat"),l,{params:n})}removeMember(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=t?{workspaceId:t}:{};return this.axios.delete("/members/".concat(e),{params:s})}getMySeatInfo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=e?{workspaceId:e}:{};return this.axios.get("/my-seat",{params:t})}getSeatUsage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=t?{workspaceId:t}:{};return this.axios.get("/seats/".concat(e,"/usage"),{params:s})}getWorkspaceInvoices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=e?{workspaceId:e}:{};return this.axios.get("/invoices",{params:t})}getInvitationDetails(e){return Bd.getInvitationDetails(e)}acceptInvitation(e){return Bd.acceptInvitation(e)}declineInvitation(e){return Bd.declineInvitation(e)}createWorkspacePortalSession(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=e?{workspaceId:e}:{};return this.axios.post("/create-portal-session",{},{params:t})}checkSensitiveFeaturePermission(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s={feature:e};return t&&(s.organizationId=t),this.axios.get("/sensitive-feature-permission",{params:s})}getDomainVerificationStatus(e){const t={workspaceId:e};return this.axios.get("/domain/verification",{params:t})}initiateDomainVerification(e){const t={workspaceId:e};return this.axios.post("/domain/initiate-verification",{},{params:t})}verifyDomain(e){const t={workspaceId:e};return this.axios.post("/domain/verify",{},{params:t})}resetDomainVerification(e){const t={workspaceId:e};return this.axios.delete("/domain/verification",{params:t})}}const Hd=new zd,Vd=(0,Y.createContext)();function Wd(e){let{children:t}=e;const{isNativeMobile:s,platform:a}=fd(),n=(0,Y.useRef)(a);n.current=a;const[l,r]=(0,Y.useState)(()=>localStorage.getItem("activeWorkspaceId")||null),[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)(!0),[u,m]=(0,Y.useState)(!0),[x,h]=(0,Y.useState)(null),{reloadUser:p,isAuthenticated:g,user:f}=wd(),v=(0,Y.useMemo)(()=>{if(!l||!i.length)return null;return i.find(e=>e.id===l)||null},[l,i]);(0,Y.useEffect)(()=>{let e=!1;var t,a;s&&!l&&(null===(t=(a=n.current).getLatestActiveWorkSpace)||void 0===t||t.call(a).then(t=>{!e&&t&&r(t)}));return()=>{e=!0}},[s,l]),(0,Y.useEffect)(()=>((0,me.r8)(()=>l),g&&p(),()=>{(0,me.r8)(()=>null),g&&p()}),[l,g,p]),(0,Y.useEffect)(()=>{var e,t;s&&l&&(null===(e=(t=n.current).setActiveWorkSpace)||void 0===e||e.call(t,{workspaceId:l}))},[l]),(0,Y.useEffect)(()=>{if(null==f||!f.id)return void d(!1);const e=localStorage.getItem("activeWorkspaceId");e&&(0,me.r8)(()=>e),d(!1)},[null==f?void 0:f.id]),(0,Y.useEffect)(()=>{l?localStorage.setItem("activeWorkspaceId"+(null==f?void 0:f.id),l):localStorage.removeItem("activeWorkspaceId"+(null==f?void 0:f.id))},[l,null==f?void 0:f.id]);const b=(0,Y.useCallback)(async()=>{try{m(!0),h(null);const e=await Hd.getWorkspaces();o(e.workspaces||e||[])}catch(e){h(e),o([])}finally{m(!1)}},[]);(0,Y.useEffect)(()=>{b()},[b]);const j=(0,Y.useCallback)(e=>{const t="string"==typeof e?e:null==e?void 0:e.id;r(t),(0,me.r8)(()=>t),t?localStorage.setItem("activeWorkspaceId",t):localStorage.removeItem("activeWorkspaceId")},[]),y=(0,Y.useCallback)(()=>{r(null),(0,me.r8)(()=>null),localStorage.removeItem("activeWorkspaceId")},[]),N={activeWorkspace:v,activeWorkspaceId:l,workspaces:i,isLoading:c,isLoadingWorkspaces:u,error:x,switchActiveWorkspace:j,clearActiveWorkspace:y,refetchWorkspaces:b};return(0,se.jsx)(Vd.Provider,{value:N,children:t})}function qd(){const e=(0,Y.useContext)(Vd);if(void 0===e)throw new Error("useWorkspace must be used within a WorkspaceProvider");return e}var Yd=s(75888);const Gd={MUTATION:{staleTime:0,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1},REALTIME:{staleTime:0,refetchOnMount:"always",refetchOnWindowFocus:!0,refetchOnReconnect:!0},REALTIME_NO_REFETCH:{staleTime:0,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1},DEFAULT:{staleTime:12e4,refetchOnMount:!0,refetchOnWindowFocus:!0,refetchOnReconnect:!1},DYNAMIC:{staleTime:6e5,refetchOnMount:!0,refetchOnWindowFocus:!0,refetchOnReconnect:!1},STATIC:{staleTime:36e5,refetchOnMount:!0,refetchOnWindowFocus:!1,refetchOnReconnect:!1},FIXED:{staleTime:864e5,refetchOnMount:!0,refetchOnWindowFocus:!1,refetchOnReconnect:!1}},Kd=new Q.E({defaultOptions:{queries:(0,ue.A)((0,ue.A)({meta:{}},Gd.DEFAULT),{},{retryDelay:3e4,retryOnMount:!1,retry:!1,refetchIntervalInBackground:!1,refetchInterval:!1},null==$d||null===(Zd=$d.defaultOptions)||void 0===Zd?void 0:Zd.queries),mutations:(0,ue.A)({retryDelay:3e4,retry:!1},null==$d||null===(Jd=$d.defaultOptions)||void 0===Jd?void 0:Jd.mutations)}});var $d,Zd,Jd;const Qd=["mutate"],Xd=(e,t)=>{var s,a;let{query:n,caching:l,enabled:r,initialData:i,throwErrorToBoundary:o,onError:c,logErrorMsg:d,onSuccess:u,onLoading:m,toastSuccess:x,toastError:h,retry:p}=e;const[g,f]=(0,Y.useState)(i),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(void 0),{toast:N}=ao(),w=(0,Y.useRef)(!1),_=Array.isArray(l)?{groupIds:l}:l,k=Boolean(null==_||null===(s=_.groupIds)||void 0===s?void 0:s.length),C="string"==typeof x?{title:"Success",description:x}:x,A="string"==typeof h?{title:"Error",description:h}:h;(0,Y.useEffect)(()=>(w.current=!0,()=>{w.current=!1}),[]);const{queryFn:S,invalidateQuery:E,invalidateQueries:T}=(0,Y.useMemo)(()=>{if(!k)return{queryFn:n,invalidateQuery:()=>{},invalidateQueries:()=>{}};return{queryFn:async e=>{var s,a;return Kd.fetchQuery((0,ue.A)((0,ue.A)({},Gd[null!==(s=null==_?void 0:_.configuration)&&void 0!==s?s:"DEFAULT"]),{},{queryKey:[...null==_?void 0:_.groupIds,...null!=t?t:[]],queryFn:async()=>await n(e),meta:{deps:t,configuration:null!==(a=null==_?void 0:_.configuration)&&void 0!==a?a:"DEFAULT",tags:null==_?void 0:_.tags}}))},invalidateQueries:()=>{Kd.invalidateQueries({queryKey:null==_?void 0:_.groupIds,exact:!1})},invalidateQuery:()=>{Kd.invalidateQueries({queryKey:[...null==_?void 0:_.groupIds,...null!=t?t:[]],exact:!0})}}},[n,null==_?void 0:_.configuration,null==_||null===(a=_.groupIds)||void 0===a?void 0:a.join(","),...null!=t?t:[]]),I=(0,Y.useCallback)(async e=>{b(!0),null==m||m(!0,e);try{const t=await S(e);w.current&&f(t),w.current&&y(void 0),w.current&&b(!1),null==u||u(t,e),null==m||m(!1,e),C&&N(C)}catch(l){var t,s,a,n;const r=null!==(t=null!==(s=null==e||null===(a=e.retryData)||void 0===a?void 0:a.retries)&&void 0!==s?s:null==p?void 0:p.retries)&&void 0!==t?t:0,i=Math.max(null!==(n=null==p?void 0:p.delay)&&void 0!==n?n:100,100);if(r>0)return void setTimeout(()=>{I({refetchData:null==e?void 0:e.refetchData,retryData:{retries:r-1}})},i);null==c||c(l,e),w.current&&y(l),A&&N((0,ue.A)((0,ue.A)({},A),{},{variant:"destructive"})),w.current&&b(!1),null==m||m(!1,e)}},[S,u,c]);if((0,Y.useEffect)(()=>{!1!==r&&I()},[...null!=t?t:[],r]),j&&o)throw j;const P=(0,Y.useCallback)(e=>(E(),I({refetchData:e})),[I]),L=(0,Y.useCallback)(e=>{!1!==r&&P(e)},[r,I]),M=(0,Y.useCallback)(async()=>{if(!1!==r){return await I()}return g},[I,g,r]),R=(0,Y.useRef)(g);R.current=g;const D=(0,Y.useCallback)(e=>{var s;const a="function"==typeof e?e(R.current):e;!1!==a&&(f(null!==(s=null==a?void 0:a.data)&&void 0!==s?s:i),k&&Kd.setQueryData([...null==_?void 0:_.groupIds,...null!=t?t:[]],null==a?void 0:a.data),(null==a?void 0:a.refetch)&&P(null==a?void 0:a.refetchData))},[i,P,r]);return{data:g,isLoading:v,error:j,refetch:P,refetchIfEnabled:L,resetData:D,setData:f,invalidateQueries:T,fetchData:M}},eu=e=>{let{mutate:t}=e,s=(0,Nt.A)(e,Qd);const{refetch:a,data:n,isLoading:l,error:r,resetData:i}=Xd((0,ue.A)((0,ue.A)({},s),{},{query:async e=>await t(null==e?void 0:e.refetchData),enabled:!1}),[]);return{resetData:i,data:n,isLoading:l,error:r,mutate:e=>a(e)}};var tu=s(67143),su=s(61041),au=s(79585);class nu extends te.H{getBaseURL(){return"/apps"}write(e,t,s){return this.axios.post("/".concat(e,"/coding/write"),{file_path:t,content:s})}exportToGithub(e){return this.axios.post("/".concat(e,"/coding/export-to-github"))}updateGithubRepo(e){return this.axios.post("/".concat(e,"/coding/update-github-repo"))}exportToZip(e){return this.axios.get("/".concat(e,"/coding/export-to-zip"),{responseType:"blob"})}inviteCollaborator(e,t){return this.axios.post("/".concat(e,"/coding/invite-collaborator"),{collaborator_username:t})}searchGithubUsers(e,t){return this.axios.post("/".concat(e,"/coding/search-github-users"),{query:t})}}const lu=new nu;class ru extends te.y{getBaseURL(){return"/apps"}updateSecrets(e,t){return this.axios.post("/".concat(e,"/secrets"),t)}deleteSecret(e,t){return this.axios.delete("/".concat(e,"/secrets"),{params:{secret_name:t}})}getSecrets(e){return this.axios.get("/".concat(e,"/secrets"))}getGeneralSecrets(e){return(0,me.Ay)("/secrets").get(e)}}const iu=new ru;var ou=s(4775),cu=s(16869),du=s(51762);const uu=e=>"use".concat(e.charAt(0).toUpperCase()+e.slice(1)),mu=e=>t=>Object.keys(e).reduce((s,a)=>(0,ue.A)((0,ue.A)({},s),{},{[a]:function(){for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return e[a](t,...n)},[uu(a)]:function(){for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return t(t=>e[a](t,...n))}}),{}),xu=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return e=>t.reduce((t,s)=>(0,ue.A)((0,ue.A)({},t),{},{[s]:e[s]}),{})},hu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=(0,ue.A)((0,ue.A)({},e),t),a=(0,ou.h)((0,cu.D)(()=>(0,ue.A)({},s)),du.x),n=Object.assign(a,{useStore:a,usePick:function(){return a(xu(...arguments))},reset:()=>a.setState(()=>(0,ue.A)({},e))}),l={},r=new Proxy(n,{get(e,t){if(t in e)return e[t];if(t in l)return l[t];if("string"==typeof(s=t)&&s.startsWith("use")&&s.length>3){const s=(e=>e.slice(3).charAt(0).toLowerCase()+e.slice(4))(t);return()=>e(e=>e[s])}var s;if((e=>"string"==typeof e&&e.startsWith("update")&&e.length>3)(t)){const s=(e=>e.slice(6).charAt(0).toLowerCase()+e.slice(7))(t);return t=>{e.setState(e=>{t(e[s])})}}return e.getState()[t]},set(e,t,s){if(t)return e.setState(e=>{e[t]=s}),!0}});return r.use=e=>{const t="function"==typeof e?e(r):e;return Object.assign(l,t),r},r},pu=e=>t=>Object.keys(e).reduce((s,a)=>(0,ue.A)((0,ue.A)({},s),{},{[a]:function(){for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return e[a]({store:t},...n)}}),{}),gu=hu({id:null,messages:[],model:null,pageSize:100},{_hasMore:!0,_isLoading:!1,_appId:null}).use(mu({isValid:e=>null!=e.id&&null!=e._appId,hasMore:e=>e._hasMore,isLoading:e=>e._isLoading,hasMessage:(e,t)=>void 0!==e.messages.find(e=>e.id===t),findMessage:(e,t)=>e.messages.find(e=>e.id===t),enrichedMessages:e=>{const t=(null==e?void 0:e.messages.filter(e=>!0!==e.hidden))||[];return t.map((e,s)=>{let a=t[s-1],n=t[s+1];const l="assistant"===e.role&&(!a||"assistant"!==a.role),r="assistant"===e.role&&(!n||"assistant"!==n.role),i=s===t.length-1;let o=null;if(l)for(let u=s;u<t.length&&"assistant"===t[u].role;u++){var c;if(null!=(null===(c=t[u].usage)||void 0===c?void 0:c.credits_charged)){o=t[u];break}}let d=null;return l&&"user"===(null==a?void 0:a.role)&&(d=a.prompt_analysis),(0,ue.A)((0,ue.A)({},e),{},{isFirstAssistantMessage:l,isLastAssistantMessage:r,isLastMessageInChat:i,loopMessageWithCredits:o,previousUserAnalysis:d})})}})).use(pu({initConversation:async(e,t,s)=>{let{store:a}=e;a.messages=[],a._appId=t,a.id=s,a._hasMore=!0,a._isLoading=!0;try{var n,l,r;const e=await zc.loadFullConversation({appId:t,limit:a.pageSize});a.messages=null!==(n=e.messages)&&void 0!==n?n:[],a.id=e.id,a.model=null!==(l=e.model)&&void 0!==l?l:"",a._hasMore=(null===(r=e.messages)||void 0===r?void 0:r.length)>=a.pageSize}catch(i){}finally{a._isLoading=!1}},loadFullConversation:async e=>{let{store:t}=e;if(!t.isValid())return;const{messages:s}=await zc.loadFullConversation({appId:t._appId});t.messages=s,t._hasMore=s.length>=99},loadMore:async(e,t)=>{var s;let{store:a}=e;if(!a._hasMore||!a.isValid())return;const n=null!==(s=null==t?void 0:t.limit)&&void 0!==s?s:a.pageSize;a._isLoading=!0;try{const e=a.messages.length,{messages:t}=await zc.loadFullConversation({appId:a._appId,limit:n,skip:e});a.messages=[...t,...a.messages],a._hasMore=t.length>=n}catch(l){}finally{a._isLoading=!1}},loadUptoMessage:async(e,t)=>{let{store:s}=e,{messageId:a}=t;if(!s.isValid())return;let n=s.messages.find(e=>e.id===a),l=!0,r=[];for(;!n&&l;){const e=r.length+s.messages.length,{messages:t}=await zc.loadFullConversation({appId:s._appId,limit:s.pageSize,skip:e});r=[...t,...r],n=t.find(e=>e.id===a),l=t.length>=s.pageSize}return s.messages=[...r,...s.messages],n}})).use(e=>({upsertMessage:t=>{if(!e.hasMessage(t.id))return void(e.messages=[...e.messages,t]);const s=e.messages.findIndex(e=>e.id===t.id);e.updateMessages(e=>{e[s]=t})},truncateUptoMessage:async t=>{let{messageId:s}=t;e.hasMessage(s)||await e.loadUptoMessage({messageId:s});const a=e.messages.findIndex(e=>e.id===s);-1!==a&&(e.messages=e.messages.slice(0,a+1))}})).use(pu({refreshConversation:async function(e){var t,s;let{store:a}=e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!a.isValid())return;if(n){var l,r,i;const e=await zc.loadFullConversation({appId:a._appId,limit:a.pageSize});return a.messages=null!==(l=e.messages)&&void 0!==l?l:[],void(a._hasMore=(null!==(r=null===(i=e.messages)||void 0===i?void 0:i.length)&&void 0!==r?r:0)>=a.pageSize)}const o=null!==(t=(await zc.loadFullConversation({appId:a._appId,limit:10})).messages)&&void 0!==t?t:[];if(0===o.length)return;const c=new Set(a.messages.map(e=>e.id)),d=o.filter(e=>!c.has(e.id));d.length>0&&(a.messages=[...a.messages,...d]);const u=null===(s=dc().last(o))||void 0===s?void 0:s.id;if(u&&a.hasMessage(u)){const e=o.find(e=>e.id===u);e&&a.upsertMessage(e)}}}));var fu=s(74925);const vu="mixpanel_utm_params",bu="mixpanel_utm_timestamp",ju=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","utm_id","utm_campaign_id","utm_source_platform","utm_creative_format","utm_marketing_tactic","impact_click_id"],yu=()=>{try{const e=localStorage.getItem(vu),t=localStorage.getItem(bu);return{params:e?JSON.parse(e):{},timestamp:t?parseInt(t):null}}catch(e){return{params:{},timestamp:null}}};function Nu(e){var t;const s="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===s.length&&(null===(t=s.pop())||void 0===t?void 0:t.split(";").shift())||null}function wu(){return function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(null==document)return t();const a=document.cookie.split("; ").find(t=>t.startsWith(e+"="));if(a)return a.split("=")[1];const n=t(),l=new Date(Date.now()+60*s*1e3).toUTCString();return document.cookie=["".concat(e,"=").concat(n),"path=/","expires=".concat(l),"SameSite=Lax"].join("; "),n}("_base44_sessionId",()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),30)}const _u={signup:{src:189,evid:1204},login:{src:189,evid:1200}},ku=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signup",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(!e)return;const a=_u[t];if(!a)return;const n=Nu("_wixCIDX")||"no-cookie-found",l=e||"no-user-id",r={dt:0,e:[{dt:0,f:{src:a.src,evid:a.evid}}],g:{uuid:l,client_id:n}};Object.keys(s).length>0&&(r.additional_data=s),fetch("https://frog.wix.com/base44",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(e=>{if(!e.ok)throw new Error("Frog service responded with status: ".concat(e.status));return e.text()}).then(e=>{}).catch(e=>{})}catch(a){}},Cu=e=>{const t={event_type:"signup",timestamp:(new Date).toISOString()};ku(e,"signup",t)};let Au={feature_flags:[],tier:null};const Su=[];function Eu(e,t){const s=Nu("_wixCIDX")||"no-cookie-found",a=wu(),n=(0,ue.A)((0,ue.A)({},t),{},{feature_flags:t.feature_flags||Au.feature_flags,tier:t.tier||Au.tier,client_id:s,session_id:a});fu.A.track(e,n)}const Tu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fu.A.__loaded?Eu(e,t):Su.push(()=>Eu(e,t))};function Iu(){const{user:e,isLoadingAuth:t}=wd();return(0,Y.useEffect)(()=>{if(t)return;fu.A.init("eff913a25a5a2642acc7794bb28dc621",{debug:!1,opt_out_tracking_by_default:!1,ignore_dnt:!0,loaded:()=>{fu.A.__loaded=!0;const{params:t}=yu();if(Object.keys(t).length>0&&fu.A.register(t),e){s=e.id,fu.A.__loaded?fu.A.identify(s):Su.push(()=>fu.A.identify(s));const a={};Object.assign(a,t),a.is_beta=e.is_beta_tester||!1,a.tier=e.subscription_tier||"free",Au.tier=e.subscription_tier||"free",e.feature_flags&&Array.isArray(e.feature_flags)&&(Au.feature_flags=e.feature_flags,a.feature_flags=e.feature_flags,e.feature_flags.forEach(e=>{a["ff_".concat(e)]=!0})),((e,t)=>{fu.A.__loaded?(fu.A.identify(e),fu.A.people.set(t)):Su.push(()=>{fu.A.identify(e),fu.A.people.set(t)})})(e.id,a),Tu("User Login",t),(e=>{const t={event_type:"login",timestamp:(new Date).toISOString()};ku(e,"login",t)})(e.id)}for(var s;Su.length>0;){Su.shift()()}}})},[t,e]),null}const Pu={signup:{src:189,evid:1204},login:{src:189,evid:1200},message_sent:{src:189,evid:1020},message_completed:{src:189,evid:1019},page_view:{src:189,evid:1023},user_clicked:{src:189,evid:1021},help_center_clicked:{src:189,evid:1308},support_main_page_view:{src:189,evid:1311},support_main_open_ticket_hover:{src:189,evid:1309},support_main_open_ticket_click:{src:189,evid:1310},support_my_tickets_page_view:{src:189,evid:1312},support_my_tickets_new_ticket_click:{src:189,evid:1302},support_ticket_modal_submitted:{src:189,evid:1304},support_ticket_modal_closed:{src:189,evid:1303},support_ticket_modal_view:{src:189,evid:1307},support_ticket_modal_help_type_click:{src:189,evid:1305},support_ticket_modal_bot_helped_click:{src:189,evid:1313},support_ticket_modal_still_need_help_click:{src:189,evid:1314},support_ticket_modal_bot_answered:{src:189,evid:1319},support_admin_escalate_click:{src:189,evid:1301},support_admin_unescalate_click:{src:189,evid:1315},support_admin_resolved_open_click:{src:189,evid:1316},support_admin_internal_note_content_change:{src:189,evid:1317},support_admin_category_change:{src:189,evid:1318}};function Lu(e){return Pu[e]||null}async function Mu(e,t){let{timeoutMs:s=2500}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=JSON.stringify(t),n=fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:a}),l=await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500;return new Promise((s,a)=>{const n=setTimeout(()=>a(new Error("timeout")),t);e.then(e=>{clearTimeout(n),s(e)},e=>{clearTimeout(n),a(e)})})}(n,s);if(!l.ok)throw new Error("HTTP ".concat(l.status));return l}function Ru(e,t){try{const s=new Blob([JSON.stringify(t)],{type:"application/json"});return navigator.sendBeacon(e,s)}catch(s){return!1}}const Du="https://frog.wix.com/base44";const Fu=new class{constructor(){this._ready=!1,this._readyPromise=null,this._eventQueue=[],this._flushTimer=null,this._isFlushInProgress=!1,this.BATCH_SIZE=10,this.FLUSH_INTERVAL=2e3,this.MAX_QUEUE_SIZE=100}getCookie(e){var t;if("undefined"==typeof document)return null;const s="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===s.length&&(null===(t=s.pop())||void 0===t?void 0:t.split(";").shift())||null}getClientId(){return this.getCookie("_wixCIDX")||"no-cookie-found"}async ensureReady(){if(!this._ready)return this._readyPromise||(this._readyPromise=(async()=>{this._ready=!0})()),this._readyPromise}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{await this.ensureReady();if(!Lu(e))return;let l;try{l=await s}catch(n){l={}}const r=Date.now();if(a.immediate||a.useBeacon)return this._sendImmediately(e,t,l,r,a);const i={eventKey:e,session:t,additionalData:l,timestamp:r,useBeacon:a.useBeacon};if(this._eventQueue.push(i),this._eventQueue.length>this.MAX_QUEUE_SIZE&&this._eventQueue.shift(),this._eventQueue.length>=this.BATCH_SIZE)try{await this._flush()}catch(n){}else this._scheduleFlush()}catch(n){}}async flush(){try{return await this._flush()}catch(e){}}async _sendImmediately(e,t,s,a,n){try{const l=Lu(e),r={dt:0,e:[{dt:0,f:(0,ue.A)((0,ue.A)({src:l.src,evid:l.evid,timestamp:a},s),t)}],g:{uuid:t.user_id||"no-user-id",client_id:this.getClientId(),session_id:wu()}};if(n.useBeacon){if(Ru(Du,r))return}await Mu(Du,r,{timeoutMs:2500})}catch(l){}}async _flush(){if(!this._isFlushInProgress&&0!==this._eventQueue.length){this._isFlushInProgress=!0;try{this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=null);const t=this._eventQueue.splice(0,this.BATCH_SIZE);let s;try{s=this._groupEventsBySession(t)}catch(e){return}try{await Promise.all(s.map(e=>this._sendEventBatch(e)))}catch(e){}}catch(e){}finally{this._isFlushInProgress=!1,this._eventQueue.length>0&&this._scheduleFlush()}}}_groupEventsBySession(e){const t=new Map;for(const s of e){const e=(null==s?void 0:s.session)||{},a="object"==typeof e&&null!==e&&e.user_id||"no-user",n="object"==typeof e&&null!==e&&e.app_id||"no-app",l="object"==typeof e&&null!==e&&e.conversation_id||"no-conversation",r="".concat(a,"-").concat(n,"-").concat(l);t.has(r)||t.set(r,[]),t.get(r).push(s)}return Array.from(t.values())}_scheduleFlush(){this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=null),this._flushTimer=setTimeout(async()=>{try{await this._flush()}catch(e){}},this.FLUSH_INTERVAL)}async _sendEventBatch(e){if(0!==e.length)try{var t,s;const a=e.some(e=>e.useBeacon),n={dt:0,e:e.map(t=>{const s=Lu(t.eventKey);return{dt:t.timestamp-e[0].timestamp,f:(0,ue.A)((0,ue.A)({src:s.src,evid:s.evid,timestamp:t.timestamp},t.additionalData),t.session)}}),g:{uuid:(null===(t=e[0])||void 0===t||null===(s=t.session)||void 0===s?void 0:s.user_id)||"no-user-id",client_id:this.getClientId(),session_id:wu(),batch_size:e.length}};if(a){if(!Ru(Du,n))throw new Error("Beacon send failed")}else await Mu(Du,n,{timeoutMs:2500})}catch(a){}}destroy(){this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=null),this._eventQueue.length>0&&this._flush().catch(e=>{})}};async function Ou(){try{const e=await Promise.resolve().then(s.bind(s,75888));return await e.default.getCurrentUsage()}catch(e){return{daily_limit:null,daily_usage:null,monthly_limit:null,monthly_usage:null}}}async function Uu(){return function(e){if(!e)return null;const t="number"==typeof e.daily_limit?e.daily_limit:void 0,s="number"==typeof e.daily_usage?Math.round(e.daily_usage):void 0,a="number"==typeof e.monthly_limit?e.monthly_limit:void 0,n="number"==typeof e.monthly_usage?Math.round(e.monthly_usage):void 0;return"number"==typeof t?"number"!=typeof s?null:Math.max(0,t-s):"number"==typeof a?"number"!=typeof n?null:Math.max(0,a-n):null}(await Ou())}function Bu(e,t,s){Fu.track("message_sent",e,function(e){return{user_message:String(e.user_message||""),has_files:Boolean(e.has_files),is_initial_creation_message:Boolean(e.is_initial_creation_message)}}(t),s)}function zu(e,t,s){Fu.track("message_completed",e,async function(e){var t,s,a,n,l,r;const i=null!==(t=e.tokens_left)&&void 0!==t?t:await Uu();return{message_id:null!==(s=e.message_id)&&void 0!==s?s:null,user_message:String(e.user_message||""),agent_message:null!==(a=e.agent_message)&&void 0!==a?a:null,model:null!==(n=e.model)&&void 0!==n?n:null,was_successful:Boolean(e.was_successful),tokens_left:i,duration:null!==(l=e.duration)&&void 0!==l?l:null,has_files:Boolean(e.has_files),error_message:null!==(r=e.error_message)&&void 0!==r?r:null,is_initial_creation_message:Boolean(e.is_initial_creation_message)}}(t),s)}function Hu(e,t,s){Fu.track("page_view",e,function(e){return{page_name:String(e.page_name||"")}}(t),s)}function Vu(e,t,s){Fu.track("user_clicked",e,function(e){return(0,ue.A)({},e)}(t),s)}"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{Fu.destroy()});const Wu=hu({previews:{},activePreviewName:null}).use(mu({activePreview:e=>e.activePreviewName?e.previews[e.activePreviewName]:null,previewIframe:e=>{var t;return e.activePreviewName?null===(t=e.previews[e.activePreviewName])||void 0===t?void 0:t.iframeRef:null}})).use(pu({unregisterPreview:(e,t)=>{let{store:s}=e;s.setState(e=>{delete e.previews[t]})},registerPreview:(e,t,s)=>{let{store:a}=e;a.setState(e=>{e.previews[t]=(0,ue.A)({},s),e.activePreviewName||(e.activePreviewName=t)})},refreshPreview:e=>{var t,s;let{store:a}=e;null===(t=a.activePreview())||void 0===t||null===(s=t.refreshHandler)||void 0===s||s.call(t)},navigatePreview:(e,t)=>{var s,a;let{store:n}=e;null===(s=n.activePreview())||void 0===s||null===(a=s.navigateHandler)||void 0===a||a.call(s,t)},postMessageToPreview:(e,t,s)=>{var a,n;let{store:l}=e;const r=null!=s&&s.previewName?null===(a=l.previews[s.previewName])||void 0===a?void 0:a.iframeRef:l.previewIframe();return r?(null===(n=r.contentWindow)||void 0===n||n.postMessage(t,"*"),null==s||s.log,!0):(null==s||s.log,!1)}})).use(pu({useRegisterPreview:(e,t,s)=>{let{store:a}=e;const{refreshHandler:n,navigateHandler:l,pagesNames:r,mainPage:i,iframeRef:o}=s;(0,Y.useEffect)(()=>(a.registerPreview(t,s),()=>{a.unregisterPreview(t)}),[n,l,r,i,o])}}));function qu(){return(0,co.Ub)({maxWidth:767})}class Yu extends te.H{getBaseURL(){return"/apps"}async getPreviewURL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{const s=t?{checkpoint_id:t}:{};return await this.axios.get("/".concat(e,"/sandbox/preview-url"),{params:s})}catch(n){var s,a;throw new Error((null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail)||"Failed to get preview url")}}async getCheckpointFiles(e){let{appId:t,checkpointId:s}=e;try{var a;const e=await this.axios.get("/".concat(t,"/sandbox/checkpoint/").concat(s,"/files"));return null!==(a=null==e?void 0:e.files)&&void 0!==a?a:{}}catch(n){return{}}}async getAppFiles(e){try{return(await this.axios.get("/".concat(e,"/sandbox/files"))).files}catch(a){var t,s;throw new Error((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"Failed to get app files")}}async listFiles(e){let{appId:t,path:s}=e;try{return await this.axios.get("/".concat(t,"/sandbox/files/list"),{params:{path:s}})}catch(l){var a,n;throw new Error((null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail)||"Failed to list files")}}async updateMainPage(e,t){try{return await this.axios.post("/".concat(e,"/sandbox/main-page"),{main_page:t})}catch(n){var s,a;throw new Error((null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail)||"Failed to update main page")}}async migrateToSandbox(e){try{return await this.axios.post("/".concat(e,"/sandbox/migrate"))}catch(a){var t,s;throw new Error((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"Failed to migrate app to sandbox")}}async revertSandboxMigration(e){try{return await this.axios.post("/".concat(e,"/sandbox/revert-migration"))}catch(a){var t,s;throw new Error((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"Failed to unmigrate app from sandbox")}}}const Gu=new Yu,Ku=()=>{const{app:e}=lp();return null==e?void 0:e.using_sandbox};class $u extends te.H{getBaseURL(){return"/apps"}subscribeToCheckpoint(e,t){const s="/user-app-checkpoints/".concat(e);return Fd.A.addListener(s,e=>{t(e)})}getCheckpointFileTree(e,t){return this.axios.get("/".concat(e,"/app-checkpoints/").concat(t,"/file-tree"))}getCheckpointCommitHash(e,t){return this.axios.get("/".concat(e,"/app-checkpoints/").concat(t,"/commit-hash"))}listCheckpoints(e,t){return this.axios.get("/".concat(e,"/app-checkpoints"),{params:{limit:null==t?void 0:t.limit,skip:null==t?void 0:t.skip,filter:null==t?void 0:t.filter}})}loadCheckpoint(e,t){return this.axios.post("/".concat(e,"/app-checkpoints/").concat(t,"/load"))}retryCheckpointBuild(e){let{appId:t,checkpointId:s}=e;return this.axios.post("/".concat(t,"/app-checkpoints/").concat(s,"/retry-build"))}}const Zu=new $u;function Ju(e,t,s){return null!==e.closingTagIndex?e.closingTagIndex+t.length:s}function Qu(e,t){const s=[];let a=0;const n="<".concat(t," "),l="</".concat(t,">");for(;-1!==e.indexOf(n,a);){const t=e.indexOf(n,a);let r=e.indexOf(">",t)+1;0===r&&(r=e.length);const i=e.slice(t,r),o=e.indexOf(l,r);if(-1===o){s.push({openingTagIndex:t,closingTagIndex:null,openingTag:i,content:e.slice(r)});break}s.push({openingTagIndex:t,closingTagIndex:o,openingTag:i,content:e.slice(r,o)}),a=o+l.length}return s}function Xu(e,t){const s=e.match(new RegExp("".concat(t,'="([^"]*)"'),"i"));return s?s[1]:void 0}function em(e){if(!e.closingTagIndex&&!e.openingTag.includes(">"))return"";const t={"data-content-length":e.content.length,"data-is-complete":e.closingTagIndex?"true":"false"},s=Xu(e.openingTag,"action-type")||Xu(e.openingTag,"type");if("insertentityrecords"===(null==s?void 0:s.toLowerCase())){const s=Xu(e.openingTag,"entity-name");if(s&&(t["data-entity-name"]=s,t.title="Insert ".concat(s," Records")),e.closingTagIndex)try{const s=JSON.parse(e.content);t["data-insert-records-length"]=s.length}catch(a){}}else if("requestsecrets"===(null==s?void 0:s.toLowerCase()))try{t["data-content"]=btoa(e.content)}catch(a){}return e.openingTag.slice(0,-1).includes(">"),"".concat(e.openingTag.slice(0,-1)," ").concat(Object.entries(t).map(e=>{let[t,s]=e;return"".concat(t,'="').concat(s,'"')}).join(" "),"></action>")}function tm(e){let t=e;const s=Qu(e,"action");for(let a=s.length-1;a>=0;a--){const e=s[a],n=em(e),l=e.openingTagIndex,r=Ju(e,"</action>",t.length);t=t.slice(0,l)+n+t.slice(r)}return t=t.replace(/<action_group/g,'<div class="action-component action-group"'),t=t.replace(/<\/action_group>/g,"</div>"),t}function sm(e,t){const s=e||"",a=s.match(/title="([^"]*)"/i),n=s.match(/details="([^"]*)"/i),l=s.match(/component-name="([^"]*)"/i),r=a?a[1]:"",i=n?n[1]:"",o=l?l[1]:"";let c="";if(t&&t.trim())try{c=btoa(unescape(encodeURIComponent(t.trim())))}catch(d){}return'<div class="error-component" title="'.concat(r,'" details="').concat(i,'" component-name="').concat(o,'" data-content="').concat(c,'"></div>')}const am=e=>{const t=He().utc(e);return{relative:t.fromNow(),absolute:t.format("MMM D, YYYY [at] h:mm A")}},nm=e=>{try{const t=Qu(e,"action_group");if(t.length>0)for(const e of t){const t=e.openingTag.match(/title=["']([^"']*)["']/i);if(t&&t[1])return t[1]}const s=/# (.*)/,a=e.match(s);if(a)return a[1]}catch(t){}return"Untitled Version"};const lm=()=>{var e;const{app:t}=lp(),s=(0,Y.useRef)(!0),{resetData:a,mutate:n,data:l,isLoading:r,error:i}=eu({initialData:{checkpointsWithChatMatch:[],checkpointsWithNoMatch:[],hasNextPage:!0,pages:0},logErrorMsg:"Error fetching checkpoints",mutate:async()=>{var e,a,n,r;if(!s.current)return l;const i=await async function(e,t,s){var a,n,l;let r=t.filter((e,t,s)=>{var a,n,l;return e.checkpoint_id&&(e.content.includes("action_group")||(null===(a=s[t-1])||void 0===a||null===(n=a.tool_calls)||void 0===n?void 0:n.length)>0||"github_sync"===(null===(l=e.additional_message_params)||void 0===l?void 0:l.type))});const i=null!==(a=await Zu.listCheckpoints(e.id,{limit:null==s||null===(n=s.pagination)||void 0===n?void 0:n.limit,skip:null==s||null===(l=s.pagination)||void 0===l?void 0:l.skip}))&&void 0!==a?a:[],o=r.reduce((e,t)=>(0,ue.A)((0,ue.A)({},e),{},{[t.checkpoint_id]:t}),{});return{checkpointsFromMessages:i.map(t=>{const s=o[t.id];var a,n;return s?(0,ue.A)((0,ue.A)({},t),{},{app_id:e.id,created_date:(null===(a=s.metadata)||void 0===a?void 0:a.created_date)||(new Date).toISOString(),name:t.name||nm(s.content),message_id:s.id,is_github_sync:t.is_github_sync||"github_sync"===(null===(n=s.additional_message_params)||void 0===n?void 0:n.type)}):(0,ue.A)((0,ue.A)({},t),{},{message_id:void 0})}),checkpointsWithNoMatch:[]}}(t,gu.getState().messages,{pagination:{limit:25,skip:25*l.pages}});s.current=!1;const o=(null!==(e=null===(a=i.checkpointsFromMessages)||void 0===a?void 0:a.length)&&void 0!==e?e:0)+(null!==(n=null===(r=i.checkpointsWithNoMatch)||void 0===r?void 0:r.length)&&void 0!==n?n:0);return{checkpointsWithChatMatch:[...l.checkpointsWithChatMatch,...i.checkpointsFromMessages],checkpointsWithNoMatch:[...l.checkpointsWithNoMatch,...i.checkpointsWithNoMatch],hasNextPage:o>=25,pages:l.pages+1}}});(0,Y.useEffect)(()=>{var e;"ready"===(null===(e=t.status)||void 0===e?void 0:e.state)&&(s.current=!0,a({data:{checkpointsWithChatMatch:[],checkpointsWithNoMatch:[],hasNextPage:!0,pages:0}}))},[null===(e=t.status)||void 0===e?void 0:e.state]);const o=(0,Y.useMemo)(()=>[...null==l?void 0:l.checkpointsWithChatMatch,...null==l?void 0:l.checkpointsWithNoMatch],[l]),c=(0,Y.useCallback)((e,t)=>{const s=s=>s.map(s=>s.id===e?(0,ue.A)((0,ue.A)({},s),t):s);a({data:(0,ue.A)((0,ue.A)({},l),{},{checkpointsWithChatMatch:s(l.checkpointsWithChatMatch),checkpointsWithNoMatch:s(l.checkpointsWithNoMatch)})})},[l,a]),d=(0,Y.useRef)(c);(0,Y.useEffect)(()=>{d.current=c},[c]);const u=(0,Y.useMemo)(()=>o.filter(e=>"pending"===e.preview_status||"building"===e.preview_status).map(e=>e.id),[o]),m=(0,Y.useRef)(new Map);return(0,Y.useEffect)(()=>{for(const e of u)if(!m.current.has(e)){const t=Zu.subscribeToCheckpoint(e,t=>{d.current(e,t)});m.current.set(e,t)}return m.current.forEach((e,t)=>{u.includes(t)||(e(),m.current.delete(t))}),()=>{m.current.forEach(e=>{e()}),m.current.clear()}},[u]),{refreshCheckpoints:()=>n({}),loadMoreCheckpoints:()=>{s.current=!0,n({})},hasNextPage:l.hasNextPage,hasCheckpoints:o.length>0||s.current,checkpointsWithChatMatch:l.checkpointsWithChatMatch,checkpointsWithNoMatch:l.checkpointsWithNoMatch,allCheckpoints:o,isLoading:r,error:i,updateCheckpointInState:c}},rm=(e,t)=>s=>{var a;const n="base44_store_".concat(e),l=null!==(a=null==t?void 0:t.storage)&&void 0!==a?a:sessionStorage,r=cm(n,l),i=null!=t&&t.selector?t.selector:null!=t&&t.pick?xu(...t.pick):void 0;if(r){let e=i?i(r):r;e=null!=t&&t.exclude?Object.fromEntries(Object.entries(e).filter(e=>{let[s]=e;return!t.exclude.includes(s)})):e,null!=t&&t.sanitizeUndefined&&(e=Object.fromEntries(Object.entries(e).filter(e=>{let[t,s]=e;return void 0!==s}))),s.setState((0,ue.A)((0,ue.A)({},s.getInitialState()),e))}const o=null!=t&&t.debounce?(0,cc.debounce)(om,t.debounce):om;s.subscribe(e=>{let s=i?i(e):e;s=null!=t&&t.exclude?Object.fromEntries(Object.entries(s).filter(e=>{let[s]=e;return!t.exclude.includes(s)})):s,o(n,s,l)})},im={},om=(e,t,s)=>{try{s.setItem(e,JSON.stringify(t))}catch(a){im[e]=t}},cm=(e,t)=>{try{const s=t.getItem(e);return s?JSON.parse(s):null}catch(s){return im[e]}},dm=hu({view:"workspace",lastWorkspaceLocation:"overview",showCheckpoints:!1,isLeftPanelHidden:!1,isPhoneMode:!1,codeViewVisible:!1,isVisualEditMode:!1,chatWidth:24,isSplitScreenMode:!1,isSelectElementMode:!1,isCheckpointCodeViewAvailable:!0,isCheckpointPreviewBuilding:!1,referrer:null}).use(rm("userAppEditorStore",{selector:xu("isPhoneMode","chatWidth"),storage:localStorage})).use(pu({toggleLeftPanel:e=>{let{store:t}=e;t.isLeftPanelHidden=!t.isLeftPanelHidden},togglePhoneMode:e=>{let{store:t}=e;t.isPhoneMode=!t.isPhoneMode},enterSplitScreenMode:e=>{let{store:t}=e;t.isLeftPanelHidden=!0,t.isSplitScreenMode=!0},exitSplitScreenMode:e=>{let{store:t}=e;t.isSplitScreenMode=!1,t.isLeftPanelHidden=!1}}));dm.useStore;let um=function(e){return e.Active="active",e.Disconnected="disconnected",e.Revoked="revoked",e}({}),mm=function(e){return e.Active="active",e.Disconnected="disconnected",e.Error="error",e.Revoked="revoked",e}({});class xm extends te.H{constructor(){super(...arguments),this.appScopedClient=(0,me.Ay)("/apps")}getBaseURL(){return"/github"}async initiateOAuth(){return this.axios.post("/oauth/initiate")}async getOAuthStatus(){return this.axios.get("/oauth/status")}async disconnectOAuth(){return this.axios.delete("/oauth/disconnect")}async getOrganizations(e){return this.appScopedClient.get("/".concat(e,"/github/organizations"))}async connectRepository(e,t){return this.appScopedClient.post("/".concat(e,"/github/connect"),{org_name:t.organization,repo_name:t.repo_name,installation_id:t.installation_id})}async getConnectionStatus(e){return this.appScopedClient.get("/".concat(e,"/github/connection"))}async disconnectRepository(e){return this.appScopedClient.delete("/".concat(e,"/github/disconnect"))}async syncFromGitHub(e){return this.appScopedClient.post("/".concat(e,"/github/sync"))}}const hm=new xm;function pm(e,t){const{provider:s,width:a=600,height:n=700,name:l="oauth_popup"}=t;return new Promise((t,r)=>{const i=Math.round(window.screenX+(window.outerWidth-a)/2),o=Math.round(window.screenY+(window.outerHeight-n)/2),c=window.open(e,l,"width=".concat(a,",height=").concat(n,",left=").concat(i,",top=").concat(o,",scrollbars=yes,resizable=yes"));if(!c||c.closed||void 0===c.closed)return void r({reason:"popup_blocked"});c.focus();let d=!1;const u=e=>{var a,n;if(e.origin===window.location.origin&&e.source===c&&"oauth_result"===(null===(a=e.data)||void 0===a?void 0:a.type)&&(null===(n=e.data)||void 0===n?void 0:n.provider)===s){d=!0,x();const{status:a,message:n}=e.data;"success"===a?t({status:"success",provider:s}):r({reason:"oauth_error",message:n})}},m=setInterval(()=>{c.closed&&!d&&(x(),r({reason:"closed_by_user"}))},500),x=()=>{clearInterval(m),window.removeEventListener("message",u),c&&!c.closed&&c.close()};window.addEventListener("message",u)})}function gm(e){return!!e.connected&&e.oauthStatus===um.Revoked}function fm(e){return!!e.connected&&(e.status===mm.Error||e.status===mm.Revoked)}const vm="GitHub Popover Opened",bm="GitHub Connect Clicked",jm="GitHub Connect Confirm Shown",ym="GitHub Connect Confirm Clicked",Nm="GitHub OAuth Result",wm="GitHub Repo Creation Result",_m="GitHub Account Connect Clicked",km="GitHub Account Reconnect Clicked",Cm="GitHub Account OAuth Result",Am="GitHub Status Loaded",Sm="GitHub Initial Sync Result",Em="GitHub Retry Sync Clicked",Tm="GitHub Realtime Sync Result",Im="GitHub Go To Repository Clicked",Pm="GitHub Clone URL Copied",Lm="GitHub Reconnect Clicked",Mm="GitHub Disconnect Clicked",Rm="GitHub Disconnect Confirmed",Dm="GitHub Disconnect Result",Fm="github_popover_open",Om="github_connect_click",Um="github_connect_confirm_click",Bm="github_oauth_success",zm="github_oauth_failure",Hm="github_oauth_cancelled",Vm="github_repo_create_success",Wm="github_repo_create_failure",qm="github_account_connect_click",Ym="github_account_reconnect_click",Gm="github_account_oauth_success",Km="github_account_oauth_failure",$m="github_account_oauth_cancelled",Zm="github_retry_sync_click",Jm="github_go_to_repo_click",Qm="github_clone_url_copy",Xm="github_reconnect_click",ex="github_disconnect_click",tx="github_disconnect_confirm_click",sx="github_disconnect_success",ax="github_disconnect_failure",nx="github_toolbar_popover",lx="github_account_settings",rx="github_sync_loader",ix="github_connection_card";let ox=function(e){return e.Success="success",e.Failure="failure",e.Cancelled="cancelled",e}({}),cx=function(e){return e.SuccessSynced="success_synced",e.SuccessUpToDate="success_up_to_date",e.Error="error",e}({}),dx=function(e){return e.Active="active",e.Revoked="revoked",e.Error="error",e.NotConnected="not_connected",e}({}),ux=function(e){return e.Success="success",e.Failure="failure",e}({}),mx=function(e){return e.Success="success",e.Failure="failure",e}({}),xx=function(e){return e.Personal="personal",e.Shared="shared",e}({});function hx(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Nm,s);const a=t.result===ox.Success?Bm:t.result===ox.Failure?zm:Hm;Vu(e,(0,ue.A)({cta:a,origin:nx,target_route:null},t))}function px(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(wm,s);const a=t.result===ux.Success?Vm:Wm;Vu(e,(0,ue.A)({cta:a,origin:nx,target_route:null},t))}function gx(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Cm,s);const a=t.result===ox.Success?Gm:t.result===ox.Failure?Km:$m;Vu(e,(0,ue.A)({cta:a,origin:lx,target_route:null},t))}function fx(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Sm,s)}function vx(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Tm,s)}function bx(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Dm,s);const a=t.result===mx.Success?sx:ax;Vu(e,(0,ue.A)({cta:a,origin:ix,target_route:null},t))}async function jx(){try{return await hm.getOAuthStatus()}catch(e){return null}}async function yx(e){try{return await hm.getConnectionStatus(e)}catch(t){return null}}function Nx(e){var t,s,a;return{user_id:null!==(t=e._userId)&&void 0!==t?t:null,app_id:null!==(s=e._appId)&&void 0!==s?s:null,conversation_id:null!==(a=gu.getState().id)&&void 0!==a?a:null}}const wx=hu({oauthData:null,repoData:null,isLoading:!1,isConnecting:!1,isDisconnecting:!1,syncState:"idle",syncError:null,lastSyncResult:null,initialSyncState:"idle",initialSyncError:null},{_appId:null,_userId:null,_isEnabled:!1,_onAppRefresh:null,_lastSyncedAppId:null,_webhookUnsubscribe:null}).use(mu({oauth:e=>{var t,s,a,n,l,r,i,o;return{connected:null!==(t=null===(s=e.oauthData)||void 0===s?void 0:s.connected)&&void 0!==t&&t,status:null!==(a=null===(n=e.oauthData)||void 0===n?void 0:n.status)&&void 0!==a?a:null,username:null!==(l=null===(r=e.oauthData)||void 0===r?void 0:r.github_username)&&void 0!==l?l:null,email:null!==(i=null===(o=e.oauthData)||void 0===o?void 0:o.github_email)&&void 0!==i?i:null}},repo:e=>{var t,s,a,n,l,r,i,o,c,d,u,m;return{connected:null!==(t=null===(s=e.repoData)||void 0===s?void 0:s.connected)&&void 0!==t&&t,status:null!==(a=null===(n=e.repoData)||void 0===n?void 0:n.status)&&void 0!==a?a:null,fullName:null!==(l=null===(r=e.repoData)||void 0===r?void 0:r.repo_full_name)&&void 0!==l?l:null,url:null!==(i=null===(o=e.repoData)||void 0===o?void 0:o.repo_url)&&void 0!==i?i:null,cloneUrls:null!==(c=null===(d=e.repoData)||void 0===d?void 0:d.clone_urls)&&void 0!==c?c:null,webhookActive:null!==(u=null===(m=e.repoData)||void 0===m?void 0:m.webhook_active)&&void 0!==u&&u}},hasRepoConnectionError:e=>{var t,s,a,n;return fm({connected:null!==(t=null===(s=e.repoData)||void 0===s?void 0:s.connected)&&void 0!==t&&t,status:null!==(a=null===(n=e.repoData)||void 0===n?void 0:n.status)&&void 0!==a?a:null})},isEnabled:e=>e._isEnabled})).use(pu({fetchOAuthStatus:async e=>{let{store:t}=e;if(!t._isEnabled)return null;const s=await jx();return t.oauthData=s,s},fetchRepoStatus:async e=>{let{store:t}=e;if(!t._isEnabled||!t._appId)return null;const s=await yx(t._appId);return t.repoData=s,s},fetchStatus:async e=>{let{store:t}=e;if(t._isEnabled&&t._appId){t.isLoading=!0;try{const[e,s]=await Promise.all([jx(),yx(t._appId)]);t.oauthData=e,t.repoData=s}finally{t.isLoading=!1}}else t.isLoading=!1},clearSyncError:e=>{let{store:t}=e;t.syncError=null,t.syncState="idle"}})).use(pu({performSync:async e=>{let{store:t}=e;if(!t._isEnabled||!t._appId)return null;t.syncState="syncing",t.syncError=null;const s=Nx(t);try{const e=await hm.syncFromGitHub(t._appId);var a;if(t.lastSyncResult=e,e.synced)t.syncState="success",vx(s,{result:cx.SuccessSynced,files_updated:!0}),await(null===(a=t._onAppRefresh)||void 0===a?void 0:a.call(t)),gu.refreshConversation(t._appId);else if(e.already_up_to_date){var n;t.syncState="success",vx(s,{result:cx.SuccessUpToDate,files_updated:!1}),await(null===(n=t._onAppRefresh)||void 0===n?void 0:n.call(t))}else if(e.error&&"not_connected"!==e.error&&"sync_in_progress"!==e.error){if("connection_error"===e.error){const[e,s]=await Promise.all([jx(),yx(t._appId)]);t.oauthData=e,t.repoData=s}t.syncState="error",t.syncError=e.error_message||"Failed to sync GitHub changes",vx(s,{result:cx.Error,files_updated:!1,error_message:e.error_message||e.error})}else t.syncState="idle";return e}catch(r){const e=r instanceof Error?r.message:"Failed to sync GitHub changes";t.syncState="error",t.syncError=e,vx(s,{result:cx.Error,files_updated:!1,error_message:e});try{var l;await(null===(l=t._onAppRefresh)||void 0===l?void 0:l.call(t))}catch(i){}return null}},retryInitialSync:async e=>{let{store:t}=e;if(t._appId){t._lastSyncedAppId=null,t.isLoading=!0,t.initialSyncState="loading",t.initialSyncError=null;try{const[e,a]=await Promise.all([jx(),yx(t._appId)]);t.oauthData=e,t.repoData=a,t.isLoading=!1;if(!(!0===(null==a?void 0:a.connected)))return void(t.initialSyncState="complete");t.syncState="syncing",t.syncError=null,await Fd.A.waitForConnection();const n=await hm.syncFromGitHub(t._appId);var s;if(t.lastSyncResult=n,n.synced||n.already_up_to_date)t.syncState="success",t.initialSyncState="success",await(null===(s=t._onAppRefresh)||void 0===s?void 0:s.call(t)),n.synced&&gu.refreshConversation(t._appId),setTimeout(()=>{t.initialSyncState="complete"},1500);else n.error&&"not_connected"!==n.error&&"sync_in_progress"!==n.error?(t.syncState="error",t.syncError=n.error_message||"Failed to sync GitHub changes",t.initialSyncState="error",t.initialSyncError=n.error_message||"We could not fetch your code from GitHub."):(t.syncState="idle",t.initialSyncState="complete")}catch(a){t.isLoading=!1,t.syncState="error";const e=a instanceof Error?a.message:"Failed to sync GitHub changes";t.syncError=e,t.initialSyncState="error",t.initialSyncError="We could not fetch your code from GitHub."}}},connect:async e=>{let{store:t}=e;if(!t._isEnabled)return!1;t.isConnecting=!0;try{const e=await hm.initiateOAuth();await pm(e.authorization_url,{provider:"github",width:800,height:600}),hx(Nx(t),{result:ox.Success});const[s,a]=await Promise.all([jx(),t._appId?yx(t._appId):null]);return t.oauthData=s,a&&(t.repoData=a),$.default.success("GitHub connected successfully!"),!0}catch(s){const e=s;if("popup_blocked"===e.reason)hx(Nx(t),{result:ox.Failure,error_reason:"popup_blocked",error_message:"Popup blocked"}),$.default.error("Popup blocked. Please allow popups and try again.");else if("closed_by_user"===e.reason)hx(Nx(t),{result:ox.Cancelled});else if("oauth_error"===e.reason){const s=e.message||"Connection failed. Please try again.";hx(Nx(t),{result:ox.Failure,error_reason:"oauth_error",error_message:s}),$.default.error(s)}else hx(Nx(t),{result:ox.Failure,error_reason:"unknown",error_message:s instanceof Error?s.message:"Unknown error"}),$.default.error("Failed to connect GitHub. Please try again.");return!1}finally{t.isConnecting=!1}},disconnect:async e=>{let{store:t}=e;if(t._isEnabled&&t._appId){t.isDisconnecting=!0;try{await hm.disconnectRepository(t._appId);const[e,s]=await Promise.all([jx(),yx(t._appId)]);t.oauthData=e,t.repoData=s,bx(Nx(t),{result:mx.Success}),$.default.success("Repository disconnected successfully")}catch(s){bx(Nx(t),{result:mx.Failure,error_message:s instanceof Error?s.message:"Unknown error"}),$.default.error("Failed to disconnect repository. Please try again.")}finally{t.isDisconnecting=!1}}}})).use(pu({init:async(e,t,s,a,n,l)=>{let{store:r}=e;if(r._onAppRefresh=null!=n?n:null,r._userId=null!=l?l:null,r._appId!==t||r._isEnabled!==s||!r._webhookUnsubscribe){if(r._webhookUnsubscribe&&(r._webhookUnsubscribe(),r._webhookUnsubscribe=null),r._appId=t,r._isEnabled=s,!s)return r.isLoading=!1,void(r.initialSyncState="complete");if(r._lastSyncedAppId!==t){r._lastSyncedAppId=t,a&&(r.initialSyncState="loading"),r.isLoading=!0,r.initialSyncError=null;try{var i;const[e,s]=await Promise.all([jx(),yx(t)]);r.oauthData=e,r.repoData=s,r.isLoading=!1,function(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Am,s)}(Nx(r),{status:(d=e,null!=d&&d.connected?d.status===um.Revoked?dx.Revoked:dx.Active:dx.NotConnected),repo_connected:null!==(i=null==s?void 0:s.connected)&&void 0!==i&&i});if(!(!0===(null==s?void 0:s.connected)))return r.initialSyncState="complete",void _x(r);r.initialSyncState="loading",r.syncState="syncing",r.syncError=null,await Fd.A.waitForConnection();const a=await hm.syncFromGitHub(t);var o,c;if(r.lastSyncResult=a,a.synced||a.already_up_to_date)r.syncState="success",r.initialSyncState="success",fx(Nx(r),{result:a.synced?cx.SuccessSynced:cx.SuccessUpToDate,files_updated:null!==(o=a.synced)&&void 0!==o&&o}),await(null===(c=r._onAppRefresh)||void 0===c?void 0:c.call(r)),a.synced&&gu.refreshConversation(t),setTimeout(()=>{r.initialSyncState="complete"},1500);else a.error&&"not_connected"!==a.error&&"sync_in_progress"!==a.error?(r.syncState="error",r.syncError=a.error_message||"Failed to sync GitHub changes",r.initialSyncState="error",r.initialSyncError=a.error_message||"We could not fetch your code from GitHub.",fx(Nx(r),{result:cx.Error,files_updated:!1,error_message:a.error_message||a.error})):(r.syncState="idle",r.initialSyncState="complete")}catch(u){r.isLoading=!1,r.syncState="error";const e=u instanceof Error?u.message:"Failed to sync GitHub changes";r.syncError=e,r.initialSyncState="error",r.initialSyncError="We could not fetch your code from GitHub.",fx(Nx(r),{result:cx.Error,files_updated:!1,error_message:e})}var d;_x(r)}else _x(r)}},cleanup:e=>{let{store:t}=e;t._webhookUnsubscribe&&(t._webhookUnsubscribe(),t._webhookUnsubscribe=null)}})).use(e=>({useIsGithubSyncing:()=>{const{app:t}=lp(),s=e.useInitialSyncState();return{isGitHubSyncing:Boolean(null==t?void 0:t.connected_to_github)&&"complete"!==s}}}));function _x(e){if(!e._isEnabled||!e._appId)return;if(e._webhookUnsubscribe)return;const t=zc.getBaseURL()+"/"+e._appId,s=Fd.A.addListener(t,()=>{},{onGitHubChanges:async()=>{await wx.performSync()}});e._webhookUnsubscribe=s}const kx=wx,Cx=async(e,t)=>{var s;return null!==(s=null==e?void 0:e.git_commit_hash)&&void 0!==s?s:(await Zu.getCheckpointCommitHash(t,e.id)).git_commit_hash},Ax=()=>{var e;const{app:t}=lp(),[s,a]=(0,Y.useState)(null),n=(0,Y.useRef)({}),l=eu({mutate:async e=>{let{checkpointId:s}=e;return n.current[s]||(n.current[s]=await Zu.getCheckpointFileTree(t.id,s)),n.current[s]},onSuccess:e=>{a(e)}}),r=eu({mutate:async e=>{let{checkpointId:s}=e;if(!n.current[s]){const e=await Gu.getCheckpointFiles({appId:t.id,checkpointId:s});return Object.keys(e).length>0&&(n.current[s]={files:e,file_errors:{}}),{files:e,file_errors:{}}}return n.current[s]},onSuccess:e=>{a(e)}});return{filesTreeIsLoading:l.isLoading||r.isLoading||!s,filesTreeError:null!==(e=l.error)&&void 0!==e?e:r.error,filesTree:null!=s?s:{files:{},file_errors:{}},resetFilesTree:()=>{a(null)},fetchLegacyFilesTree:l.mutate,fetchSandboxFilesTree:r.mutate}},Sx=(0,Y.createContext)(null),Ex=e=>{let{children:t}=e;const s=(()=>{const{app:e}=lp(),t=Ku(),[s,a]=(0,Y.useState)(!1),{_isEnabled:n}=kx.usePick("_isEnabled"),l=kx.useRepo(),r=n&&l.connected?{connected:l.connected,repo_full_name:l.fullName,repo_url:l.url,clone_urls:l.cloneUrls,webhook_active:l.webhookActive,status:l.status}:null,i=Ax(),[o,c]=(0,Y.useState)(null),d=(0,Y.useRef)(null),u=lm();(0,Y.useEffect)(()=>{if(null==o||!o.id)return;const e=u.allCheckpoints.find(e=>e.id===o.id);e&&e.preview_status!==o.preview_status&&c(e)},[u.allCheckpoints,null==o?void 0:o.id,null==o?void 0:o.preview_status]);const m=eu({logErrorMsg:"Failed to restore checkpoint:",toastError:{title:"Failed to restore version",description:"An error occurred while restoring this version. Please try again."},mutate:async t=>{await Zu.loadCheckpoint(e.id,t.id),dm.showCheckpoints=!1}}),{data:{activeSandboxCheckpoint:x,canUseSandboxPreview:h},isLoading:p}=Xd({initialData:{activeSandboxCheckpoint:o,canUseSandboxPreview:!0},query:async()=>{if(!t)return(null==o?void 0:o.id)&&await i.fetchLegacyFilesTree({checkpointId:o.id}),{activeSandboxCheckpoint:null,canUseSandboxPreview:!1};if(null!=o&&o.id&&(null==o?void 0:o.id)===(null==x?void 0:x.id))return i.fetchSandboxFilesTree({checkpointId:null==x?void 0:x.id}),{activeSandboxCheckpoint:x,canUseSandboxPreview:!0};if(i.resetFilesTree(),!o)return{activeSandboxCheckpoint:null,canUseSandboxPreview:!0};const s=await Cx(o,e.id);return Boolean(s)?(await i.fetchSandboxFilesTree({checkpointId:o.id}),{activeSandboxCheckpoint:(0,ue.A)((0,ue.A)({},o),{},{git_commit_hash:s}),canUseSandboxPreview:!0}):(i.fetchLegacyFilesTree({checkpointId:o.id}),{activeSandboxCheckpoint:x,canUseSandboxPreview:!1})},onSuccess:()=>{d.current=o},onError:()=>{c(d.current)},toastError:"Failed to load checkpoint data"},[null==o?void 0:o.id,t]);return(0,ue.A)((0,ue.A)({showOtherCheckpoints:s,setShowOtherCheckpoints:a,isSyncingSandboxCheckpoint:p,selectedCheckpoint:o,activeSandboxCheckpoint:t?x:o,setSelectedCheckpoint:c,canUseSandboxPreview:h,filesTreeState:i},u),{},{isLoading:u.isLoading||m.isLoading,isRestoring:m.isLoading,restoreCheckpoint:m.mutate,githubConnection:r,getGitHubCommitUrl:e=>e.is_github_sync&&null!=r&&r.connected&&null!=r&&r.repo_url&&e.git_commit_hash?"".concat(r.repo_url,"/commit/").concat(e.git_commit_hash):null})})();return(0,se.jsx)(Sx.Provider,{value:s,children:t})};function Tx(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];const a=(0,Y.useContext)(Sx);if(!a)throw new Error("CheckpointsStateProvider was not properly initialized");const n=(0,Y.useMemo)(()=>{const e="function"==typeof t[0],s=!e&&Boolean(null==t?void 0:t.length)&&(null==t?void 0:t.every(e=>"string"==typeof e));return e?t[0](a):s?t.reduce((e,t)=>(e[t]=a[t],e),{}):a},[a,t]);return n}const Ix=function(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const[a,n]=(0,Y.useState)(e);return(0,Y.useEffect)(()=>{if(!s)return void n(e);const a=setTimeout(()=>n(e),t);return()=>clearTimeout(a)},[e,t,s]),a},Px=(e,t)=>Ix(e,t,!e)||e,Lx=e=>{let{isDisplayed:t,previewUrl:s,previewType:a,checkpointId:n}=e;const l=(0,Y.useRef)(null),{app:r}=lp(),i=null==r?void 0:r.id;(0,Y.useEffect)(()=>{if(t&&s&&i){const e="".concat(i,"-").concat(s);e!==l.current&&(Tu("Preview Displayed",{app_id:i,preview_url:s,preview_type:a}),l.current=e)}},[t,s,i,a,n])};var Mx=s(53291),Rx=s(52229),Dx=s(28017),Fx=s(66987);const Ox=["className","variant","size","asChild"],Ux=(0,ft.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-slate-200 group-data-[theme=white]:hover:bg-muted hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10",tiny:"h-8 rounded-lg px-2",xTiny:"h-6 w-6 rounded-lg px-1"}},defaultVariants:{variant:"default",size:"default"}}),Bx=Y.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:l=!1}=e,r=(0,Nt.A)(e,Ox);const i=l?nt.Slot:"button";return(0,se.jsx)(i,(0,ue.A)({className:de(Ux({variant:a,size:n,className:s})),ref:t},r))});function zx(e){let{status:t,typingSpeed:s=40,className:a=""}=e;const[n,l]=(0,Y.useState)(""),[r,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(0),d=(0,Y.useRef)(t||""),u=(0,Y.useRef)(null);return(0,Y.useEffect)(()=>{t===d.current&&r||(c(e=>e+1),i(!0),l(""),d.current=t||"")},[t]),(0,Y.useEffect)(()=>{if(r&&d.current&&n.length<d.current.length)return u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{l(d.current.substring(0,n.length+1))},s),()=>clearTimeout(u.current);r&&d.current&&n.length===d.current.length&&i(!1)},[n,r,s]),(0,se.jsxs)("div",{className:"flex items-center h-[1.5em] sm:h-[2em]",children:[" ",(0,se.jsx)(Mx.N,{mode:"wait",children:(0,se.jsxs)(Rx.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"text-slate-700 tracking-normal ".concat(a),children:[n,r?(0,se.jsx)(Rx.P.span,{initial:{opacity:1},animate:{opacity:0},transition:{duration:.5,repeat:1/0,repeatType:"reverse"},className:"inline-block w-[2px] h-[1.1em] sm:h-[1.2em] bg-slate-600 ml-[1px] align-middle"}):(0,se.jsx)(Rx.P.span,{initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:1.2,repeat:1/0,ease:"easeInOut",delay:.2},className:"inline-block w-[0.5em] sm:w-[0.55em] h-[1em] sm:h-[1.1em] bg-slate-600 ml-[2px] align-[-0.1em] sm:align-[-0.15em]"})]},o)})]})}function Hx(e){let{app:t}=e;return(0,se.jsx)("div",{className:"h-full flex items-center justify-center pt-4",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-8 max-w-md text-center px-4",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("div",{className:"w-16 h-16 rounded-full bg-orange-500/20 backdrop-blur-sm flex items-center justify-center",children:(0,se.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-orange-400 to-orange-500"})}),(0,se.jsx)("div",{className:"absolute top-0 left-0 w-16 h-16 rounded-full bg-orange-400/20 animate-ping"}),(0,se.jsx)("div",{className:"absolute top-2 left-2 w-12 h-12 rounded-full bg-orange-300/10 animate-ping",style:{animationDelay:"0.2s"}})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h2",{className:"text-2xl font-medium tracking-tight text-slate-700",children:"Creating Your App"}),(0,se.jsx)("p",{className:"text-sm font-light text-teal-700/60 tracking-wide",children:"This might take a few minutes..."})]}),(0,se.jsx)("div",{className:"text-base text-teal-600/80 font-light tracking-wide",children:(0,se.jsx)(zx,{status:t.status.details})})]})})}Bx.displayName="Button";const Vx=()=>(0,se.jsx)("div",{className:"h-full flex items-center justify-center pt-4",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-6 max-w-md text-center px-4",children:[(0,se.jsx)("div",{className:"w-16 h-16 rounded-full bg-orange-50 flex items-center justify-center",children:(0,se.jsx)(tu.A,{className:"w-8 h-8 text-orange-500"})}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h2",{className:"text-xl font-light text-slate-700",children:"Package Installation Pending"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Please approve the npm package installation in the chat to continue"})]})]})}),Wx=s.p+"static/media/logo_v3.d98750a7c406dd97e5db.png",qx=[.5,.5,.2,1],Yx=[0,.6,1],Gx=[.4,0,.2,1],Kx={duration:2.5,ease:[.4,0,.2,1],repeat:1/0},$x=["rgba(254, 215, 195, 0.6)","rgba(253, 195, 160, 0.7)"];function Zx(e){let{colors:t=$x,entry:s,entryAnimationTime:a=500,magnitude:n=0}=e;const[l,r]=(0,Y.useState)(!s),[i,o]=(0,Y.useState)(0),[c,d]=(0,Y.useState)(0),u=(0,Y.useRef)(0);(0,Y.useEffect)(()=>{u.current=i},[i]);const m=t.length;(0,Y.useEffect)(()=>{if(0===n)return;const e=setInterval(()=>{o(e=>e<=0?0:Math.max(0,e-.02)),d(e=>{const t=u.current,s=e+.15*(t-e);return s<.001&&t<.001?0:s})},50);return()=>clearInterval(e)},[n]);const x=n*c,h=(0,Y.useCallback)(()=>{n>0&&o(e=>Math.min(1,e+.15))},[n]),p=(0,Y.useCallback)(()=>h(),[h]),g=(0,Y.useCallback)(()=>h(),[h]),f=(0,Y.useCallback)(()=>h(),[h]),v=90+35*(m-1),b=v+20,j=m>1?.5*a/m:0;(0,Y.useEffect)(()=>{if(s){const e=setTimeout(()=>{r(!0)},a);return()=>clearTimeout(e)}},[s,a]);const y=1+2*x,N=t.map((e,t)=>{const s=t,n=v-35*s,l=1.1-.04*s,r=.5+.1*s,i=Math.min(1,r+.4),o=(m-1-s)*j;let c;return c=a-o,{color:e,targetSize:n,scaleMin:.7,scaleMax:l,deepBreathScale:2.5*l,opacityMin:r,opacityMax:i,breathingDelay:-.1*(m>1?s/(m-1):0)*(.5*Kx.duration),entryDelay:o/1e3,entryDuration:c/1e3}});return(0,se.jsxs)("div",{className:"relative flex items-center justify-center",style:{width:b,height:b},children:[(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center transition-transform duration-150 ease-out origin-center",style:{transform:"scale(".concat(y,")")},children:N.map((e,t)=>(0,se.jsx)(Rx.P.div,{className:"absolute rounded-full",style:(0,ue.A)({background:e.color},0===t&&{boxShadow:"0 0 40px 10px ".concat(e.color.replace(/[\d.]+\)$/,"0.3)"))}),initial:"inwards"===s?{width:3e3,height:3e3,opacity:e.opacityMax,scale:e.scaleMin}:"breath"===s?{width:e.targetSize,height:e.targetSize,opacity:e.opacityMin,scale:e.scaleMin}:{width:e.targetSize,height:e.targetSize,scale:e.scaleMin},animate:l?{width:e.targetSize,height:e.targetSize,scale:[e.scaleMin,e.scaleMax,e.scaleMin],opacity:[e.opacityMin,e.opacityMax,e.opacityMin]}:"breath"===s?{width:e.targetSize,height:e.targetSize,scale:[e.scaleMin,e.deepBreathScale,e.scaleMin],opacity:[e.opacityMin,e.opacityMax,e.opacityMin]}:{width:e.targetSize,height:e.targetSize,scale:e.scaleMin,opacity:e.opacityMin},transition:l?{scale:(0,ue.A)((0,ue.A)({},Kx),{},{delay:e.breathingDelay}),opacity:(0,ue.A)((0,ue.A)({},Kx),{},{delay:e.breathingDelay}),width:{duration:0},height:{duration:0}}:"breath"===s?{scale:{duration:a/1e3,delay:e.breathingDelay,ease:Gx,times:Yx},opacity:{duration:a/1e3,delay:e.breathingDelay,ease:Gx,times:Yx},width:{duration:0},height:{duration:0}}:{width:{duration:e.entryDuration,delay:e.entryDelay,ease:qx},height:{duration:e.entryDuration,delay:e.entryDelay,ease:qx},opacity:{duration:e.entryDuration,delay:e.entryDelay,ease:qx},scale:{duration:0}}},t))}),(0,se.jsx)("div",{className:"relative z-10",children:(0,se.jsx)(Rx.P.div,{className:"cursor-default",style:{width:65,height:65},initial:{scale:1},animate:l?{scale:[1,1.04,1]}:{scale:1},transition:l?Kx:{duration:0},onMouseOver:p,onMouseOut:g,onClick:f,children:(0,se.jsx)("img",{src:Wx,alt:"Base44",className:"w-full h-full object-contain"})})})]})}var Jx=s(41268),Qx=s(4321),Xx=s(61878),eh=s(319);const th=5e3,sh=1e3,ah=.5,nh=[.4,0,.2,1],lh=[{text:"Connect WhatsApp, Calendar, Notion, or Slack by asking the chat",icon:Jx.A},{text:"Set roles and permissions by telling the chat what you need",icon:Qx.A},{text:"Brainstorm ideas in Discussion Mode at 0.3 credits per request",icon:Xx.A},{text:"Refine text, colors, and spacing with Visual Edit",icon:Dx.A},{text:"Restore any previous version with Version History",icon:eh.A}];function rh(e){let{hints:t=lh,hintDuration:s=th,animationDuration:a=ah,iconSize:n=18,textClassName:l="text-base font-light text-slate-950 text-center leading-[24px]",iconClassName:r="text-slate-950 shrink-0",active:i=!0}=e;const[o,c]=(0,Y.useState)(0),[d,u]=(0,Y.useState)(!1),m=(0,Y.useRef)(Date.now()),x=(0,Y.useRef)(!1),h=(0,Y.useRef)(null),p=(0,Y.useRef)(!1);(0,Y.useEffect)(()=>{x.current=d},[d]);const g=(0,Y.useCallback)(()=>{c(e=>(e+1)%t.length),m.current=Date.now(),p.current=!1},[t.length]),f=(0,Y.useCallback)(e=>{h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{x.current?p.current=!0:(g(),f(s))},e)},[g,s]);if((0,Y.useEffect)(()=>{if(i&&!(t.length<=1))return m.current=Date.now(),f(s),()=>{h.current&&clearTimeout(h.current)}},[i,t.length,s,f]),(0,Y.useEffect)(()=>{if(!d&&i&&t.length>1){const e=Date.now()-m.current,t=s-e;(p.current||t<=0||t<sh)&&f(sh)}},[d,i,t.length,s,f]),0===t.length)return null;const v=t[o],b=v.icon;return(0,se.jsx)("div",{className:"min-h-[24px] sm:h-[24px] overflow-visible px-4 sm:px-0 cursor-default",onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:(0,se.jsx)(Mx.N,{mode:"wait",children:(0,se.jsxs)(Rx.P.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0,scale:d?1.05:1},exit:{opacity:0,y:-8},transition:{duration:a,ease:nh},className:"flex items-center justify-center gap-2 origin-center",children:[(0,se.jsx)(b,{className:"".concat(r," hidden sm:block"),style:{width:n,height:n}}),(0,se.jsx)("p",{className:l,children:v.text})]},o)})})}const ih={duration:4,ease:[.4,0,.2,1],repeat:1/0},oh=[{width:"5000px",height:500,gradient:"radial-gradient(ellipse 1800px 50% at 50% 50%, rgba(253, 180, 140, 0.7) 0%, rgba(254, 200, 170, 0.45) 30%, rgba(254, 220, 200, 0.15) 55%, transparent 100%)",animation:{opacity:[.8,1,.8],scale:[1,1.05,1]},delay:0},{width:"5000px",height:600,gradient:"radial-gradient(ellipse 1000px 50% at 50% 50%, rgba(253, 165, 120, 0.6) 0%, rgba(254, 190, 155, 0.35) 40%, rgba(254, 210, 185, 0.1) 65%, transparent 100%)",animation:{opacity:[.7,1,.7],scale:[1,1.08,1]},delay:.05},{width:"5000px",height:500,gradient:"radial-gradient(ellipse 600px 50% at 50% 50%, rgba(255, 200, 170, 0.7) 0%, rgba(253, 180, 145, 0.3) 45%, rgba(253, 200, 175, 0.05) 70%, transparent 100%)",animation:{opacity:[.6,1,.6]},delay:.1},{width:"5000px",height:500,gradient:"radial-gradient(ellipse 600px 50% at 50% 50%, rgba(255, 200, 170, 0.9) 0%, rgba(253, 180, 145, 0.5) 45%, rgba(253, 200, 175, 0.25) 70%, transparent 100%)",animation:{opacity:[.6,1,.6]},delay:.1,offsetX:0,offsetY:150}];function ch(){return(0,se.jsx)(se.Fragment,{children:oh.map((e,t)=>{var s,a;const n=null!==(s=e.offsetX)&&void 0!==s?s:0,l=null!==(a=e.offsetY)&&void 0!==a?a:0,r=2*e.height,i=-200-e.height+l,o=0!==n?"translateX(".concat(n,"px)"):void 0;return(0,se.jsx)(Rx.P.div,{className:"absolute left-0 right-0 flex justify-center pointer-events-none",style:{bottom:i,transformOrigin:"center center"},animate:e.animation,transition:(0,ue.A)((0,ue.A)({},ih),{},{delay:e.delay}),children:(0,se.jsx)("div",{style:{width:e.width,height:"".concat(r,"px"),background:e.gradient,transform:o}})},t)})})}var dh=s(4084);const uh=()=>{var e;const{user:t}=wd(),s=lp(),a=gu.useId();return(0,Y.useMemo)(()=>{var e,n,l;return{user_id:null!==(e=null==t?void 0:t.id)&&void 0!==e?e:null,app_id:null!==(n=null==s||null===(l=s.app)||void 0===l?void 0:l.id)&&void 0!==n?n:null,conversation_id:null!=a?a:null}},[null==t?void 0:t.id,null==s||null===(e=s.app)||void 0===e?void 0:e.id,a])};function mh(e){let{delay:t,isSuccess:s}=e;const a=s?"#22c55e":"#64748b";return(0,se.jsx)(Rx.P.svg,{width:"24",height:"14",viewBox:"0 0 24 14",fill:"none",className:"absolute",initial:{opacity:0,y:-8},animate:{opacity:[0,1,1,0],y:[-8,0,8,16]},transition:{duration:1.5,delay:t/1e3,repeat:s?0:1/0,ease:"linear",times:[0,.2,.8,1]},children:(0,se.jsx)("path",{d:"M2 2L12 12L22 2",stroke:a,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})}function xh(e){let{isSuccess:t}=e;return(0,se.jsx)("div",{className:"relative h-[60px] w-[24px] flex items-center justify-center overflow-hidden",children:Array.from({length:3}).map((e,s)=>(0,se.jsx)(mh,{delay:200*s,isSuccess:t},s))})}function hh(e){let{state:t,error:s,onRetry:a}=e;const n="loading"===t,l="success"===t,r="error"===t,i=uh();return(0,se.jsxs)("div",{className:"h-full flex items-center justify-center bg-slate-50 relative rounded-[10px] overflow-hidden",children:[(0,se.jsx)(ch,{}),(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:(0,se.jsx)("div",{className:"flex flex-col items-center",children:(0,se.jsxs)(Mx.N,{mode:"wait",children:[(n||l)&&(0,se.jsxs)(Rx.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"flex flex-col items-center",children:[(0,se.jsx)(Rx.P.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,delay:.2},className:"mb-6",children:(0,se.jsx)(dh.A,{className:"w-10 h-10 text-slate-700"})}),(0,se.jsx)(Rx.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.5},className:"my-1",children:(0,se.jsx)(xh,{isSuccess:l})}),(0,se.jsx)(Rx.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3},children:(0,se.jsx)(Zx,{magnitude:.3})}),(0,se.jsx)(Rx.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.7},className:"mt-6",children:(0,se.jsx)("p",{className:"font-base44 font-medium text-lg text-slate-700",children:l?(0,se.jsx)(se.Fragment,{children:"Code synced successfully!"}):(0,se.jsxs)(se.Fragment,{children:["Fetching your code from GitHub",(0,se.jsx)(ph,{})]})})})]},"sync-animation"),r&&(0,se.jsxs)(Rx.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"flex flex-col items-center max-w-md text-center px-4",children:[(0,se.jsx)("div",{className:"w-16 h-16 rounded-full bg-red-50 flex items-center justify-center mb-4",children:(0,se.jsx)(ad.A,{className:"w-8 h-8 text-red-500"})}),(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-2",children:"Couldn't fetch your code"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:s||"We could not fetch your code from GitHub. Restore the connection and try again."}),a&&(0,se.jsxs)(Bx,{onClick:()=>{var e;Tu(Em,e=i),Vu(e,{cta:Zm,origin:rx,target_route:null}),null==a||a()},variant:"default",className:"gap-2",children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4"}),"Try again"]})]},"error-state")]})})})]})}function ph(){return(0,se.jsx)("span",{className:"inline-flex w-[24px]",children:[0,1,2].map(e=>(0,se.jsx)(Rx.P.span,{initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:1.5,delay:.2*e,repeat:1/0,ease:"easeInOut"},children:"."},e))})}const gh=2500;function fh(){const[e,t]=(0,Y.useState)(1);return(0,Y.useEffect)(()=>{const e=setInterval(()=>{t(e=>e%3+1)},500);return()=>clearInterval(e)},[]),(0,se.jsx)("span",{className:"inline-block w-[24px] text-left",children:".".repeat(e)})}function vh(e){var t;let{onClickOnLoader:s}=e;const{app:a}=lp(),n=gu.useMessages(),l=(0,Y.useMemo)(()=>{if(!n)return!1;for(const e of n)if(e.tool_calls)for(const t of e.tool_calls)if("install_npm_package"===t.name&&"waiting_for_user_input"===t.status)return!0;return!1},[n]);switch(!0){case"pending"!==a.app_stage:return null;case"processing"===(null===(t=a.status)||void 0===t?void 0:t.state):return(0,se.jsx)(Hx,{app:a});case l:return(0,se.jsx)(Vx,{});default:return(0,se.jsx)("div",{className:"h-full flex items-center justify-center pt-4",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-6 max-w-md text-center px-4",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center",onClick:s,children:(0,se.jsx)(Dx.A,{className:"w-6 h-6 text-gray-400"})}),(0,se.jsx)("h2",{className:"text-xl font-light text-gray-700",children:"Let's Build Your App"}),(0,se.jsx)("p",{className:"text-sm text-gray-500",children:"Tell me what you'd like to create using the chat"})]})})}}function bh(e){let{loadingState:t,onRetry:s}=e;const[a,n]=(0,Y.useState)(!1),[l,r]=(0,Y.useState)(!1),{app:i}=lp(),{initialSyncState:o,initialSyncError:c}=kx.usePick("initialSyncState","initialSyncError"),d=Boolean(null==i?void 0:i.connected_to_github)&&"complete"!==o;return(0,Y.useEffect)(()=>{if("building"===t||"preparing"===t){const e=setTimeout(()=>n(!0),gh);return()=>clearTimeout(e)}},[t]),(0,Y.useEffect)(()=>{if("building"===t){const e=setTimeout(()=>r(!0),5e3);return()=>clearTimeout(e)}},[t]),d?(0,se.jsx)(hh,{state:o,error:c,onRetry:kx.retryInitialSync}):"preparing"===t?(0,se.jsx)("div",{className:"h-full w-full flex items-center justify-center relative overflow-hidden",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,se.jsx)(ch,{}),(0,se.jsx)(Zx,{entry:"breath",entryAnimationTime:gh,magnitude:.5}),(0,se.jsxs)(Rx.P.div,{initial:{opacity:0},animate:{opacity:a?1:0},transition:{duration:.5},className:"flex items-baseline justify-center",children:[(0,se.jsx)("p",{className:"font-base44 font-medium text-[24px] text-slate-800 leading-[1.2] pt-3",children:"Loading your app"}),(0,se.jsx)(fh,{})]})]})}):"checkpoint_building"===t?(0,se.jsxs)("div",{className:"h-full w-full relative overflow-hidden bg-white",children:[(0,se.jsx)("div",{className:"absolute",style:{right:"calc(-951px / 2)",top:"50%",transform:"translateY(-50%) rotate(90deg)",width:"951px",height:"755px",borderRadius:"951px",background:"radial-gradient(50% 50% at 50% 50%, rgba(255, 85, 0, 0.76) 0%, rgba(255, 234, 166, 0.76) 100%)",filter:"blur(153px)",zIndex:0}}),(0,se.jsx)("div",{className:"relative h-full flex items-center",style:{paddingLeft:"4%",zIndex:1},children:(0,se.jsxs)("div",{style:{maxWidth:"56rem"},children:[(0,se.jsxs)("h1",{style:{color:"#001e36",fontSize:"100px",fontWeight:300,lineHeight:"109px",letterSpacing:"-1px",margin:0},children:["Building preview",(0,se.jsx)(fh,{})]}),(0,se.jsxs)("p",{style:{fontSize:"24px",color:"#000",lineHeight:1.6,marginTop:"2rem",fontWeight:300},children:["Your app preview is being prepared.",(0,se.jsx)("br",{}),"This may take a moment."]})]})})]}):"checkpoint_failed"===t?(0,se.jsxs)("div",{className:"h-full w-full relative overflow-hidden bg-white",children:[(0,se.jsx)("div",{className:"absolute",style:{right:"calc(-951px / 2)",top:"50%",transform:"translateY(-50%) rotate(90deg)",width:"951px",height:"755px",borderRadius:"951px",background:"radial-gradient(50% 50% at 50% 50%, rgba(255, 85, 0, 0.76) 0%, rgba(255, 234, 166, 0.76) 100%)",filter:"blur(153px)",zIndex:0}}),(0,se.jsx)("div",{className:"relative h-full flex items-center",style:{paddingLeft:"4%",zIndex:1},children:(0,se.jsxs)("div",{style:{maxWidth:"56rem"},children:[(0,se.jsx)("h1",{style:{color:"#001e36",fontSize:"100px",fontWeight:300,lineHeight:"109px",letterSpacing:"-1px",margin:0},children:"Preview unavailable"}),(0,se.jsx)("p",{style:{fontSize:"24px",color:"#000",lineHeight:1.6,marginTop:"2rem",fontWeight:300},children:"The preview for this version couldn't be loaded."}),s&&(0,se.jsxs)(Bx,{variant:"outline",size:"default",onClick:s,style:{marginTop:"1.5rem"},children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2"}),"Retry build"]})]})})]}):(0,se.jsxs)("div",{className:"h-full flex items-center justify-center bg-slate-50 relative rounded-[10px] overflow-hidden",children:[(0,se.jsx)(ch,{}),(0,se.jsx)("div",{className:"absolute inset-x-0 top-2/5 flex justify-center -translate-y-1/2",children:(0,se.jsx)(Zx,{entry:"breath",entryAnimationTime:gh,magnitude:.5})}),(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10 pointer-events-none",children:(0,se.jsxs)("div",{className:"flex flex-col items-center translate-y-[70px]",children:[(0,se.jsxs)(Rx.P.div,{initial:{opacity:0},animate:{opacity:a?1:0},transition:{duration:.5},className:"flex items-baseline justify-center",children:[(0,se.jsx)("p",{className:"font-base44 font-medium text-[24px] text-slate-800 leading-[1.2] pt-3",children:"Building your idea"}),(0,se.jsx)(fh,{})]}),(0,se.jsxs)(Rx.P.div,{initial:{opacity:0},animate:{opacity:l?1:0},transition:{duration:.5},className:"flex flex-col items-center pointer-events-auto",children:[(0,se.jsx)("div",{className:"w-[220px] h-[2px] my-10 opacity-40",style:{background:"linear-gradient(to right, #F8FAFC, #FF4D00, #F8FAFC)"}}),(0,se.jsx)("p",{className:"text-sm text-slate-600 text-center mb-[8px]",children:"Did you know?"}),(0,se.jsx)(rh,{active:l})]})]})})]})}const jh=hu({isFirstPrompt:!1,hadErrorsDuringFirstPrompt:!1,isAppFullyReady:!1,isAppInEmptyState:!1,hadErrorsDuringGenerating:!1,hasBeenGenerating:!1}).use(mu({isGeneratingInitialPrompt:e=>e.isFirstPrompt&&!e.isAppFullyReady&&!e.isAppInEmptyState})),yh=(jh.useStore,e=>!!e&&(e.endsWith("@base44.com")||e.endsWith("@wix.com"))),Nh=e=>e.filter(e=>!yh(e.email)),wh=e=>"pending"===e.status,_h=(e,t)=>{if(null==t||!t.length)return null;const s=Object.entries(e).find(e=>{let[s,a]=e;return"string"==typeof a&&!(null==a||!a.length)&&a.toLowerCase().indexOf(t.toLowerCase())>=0});return s?{field:s[0],value:s[1],term:t}:null},kh=hu({isLoading:!1,showViewAsToolbar:!1},{_users:[],_currentAppId:null,_viewAsUser:null,_viewAsUrlParams:null,_canViewAsGuest:!1,_meUser:null}).use(mu({isViewAsMode:e=>null!=e._viewAsUser,usersCount:e=>e._users.length,users:(e,t)=>null!=t&&t.length?e._users.filter(e=>null!=_h(e,t)):e._users,viewAsUser:e=>{var t;return null!==(t=e._viewAsUser)&&void 0!==t?t:e._meUser},viewAsPreviewUrlParams:e=>e.showViewAsToolbar?e._viewAsUrlParams:null,canViewAsGuest:e=>e._canViewAsGuest,isViewingAsGuest:e=>{var t;return"true"==(null===(t=e._viewAsUrlParams)||void 0===t?void 0:t.clear_access_token)},isViewingAsDefault:e=>null==e._viewAsUrlParams})).use(pu({exitViewAsMode:e=>{let{store:t}=e;t.showViewAsToolbar=!1,Ch()},invalidateAppData:e=>{let{store:t}=e;t._currentAppId=null},viewAsGuest:e=>{let{store:t}=e;t._viewAsUrlParams={clear_access_token:"true"},t._viewAsUser={email:"Anonymous Guest",full_name:"Anonymous Guest"},Ch()},viewAsDefault:e=>{let{store:t}=e;t._viewAsUrlParams=null,t._viewAsUser=t._meUser,Ch()}})).use(e=>({findInUser:_h,selectUserToView:async(t,s)=>{const a=e._users.find(e=>e.email===s);if(a){e.isLoading=!0;try{const a=await zc.generateTokenForUser(t,s);e._viewAsUrlParams={access_token:a.token}}catch(n){return}finally{setTimeout(()=>e.isLoading=!1,2e3)}e._viewAsUser=a}else e.viewAsDefault()},useViewingAsUser:async()=>{var t;const{app:s,getEntitiesSDK:a}=lp(),{user:n}=wd(),{_currentAppId:l}=e.usePick("_currentAppId"),r=jh.useIsGeneratingInitialPrompt(),i=(null==s?void 0:s.id)!==l,o=new Date("2025-11-30").getTime(),c=new Date(null!==(t=null==s?void 0:s.created_date)&&void 0!==t?t:Date.now()).getTime(),d="public_without_login"===(null==s?void 0:s.public_settings)&&c>=o;(0,Y.useEffect)(()=>()=>{setTimeout(()=>{e.isLoading=!1},2e3)},[]),(0,Y.useEffect)(()=>{e._canViewAsGuest=d},[d]),(0,Y.useEffect)(()=>{r&&(e.showViewAsToolbar=!1,e.reset())},[r]),Xd({query:async()=>{e.isLoading=!0;const t=await async function(e){const t=[],s=100;let a=0,n=!0;for(;n;){const l=await e.User.list(null,s,a);t.push(...l),n=l.length===s,a+=s}return t}(a());e.isLoading=!1,e._viewAsUrlParams=null,e._viewAsUser=null,e._users=yh(n.email)?t:Nh(t),e._users=[...e._users.filter(e=>null!=e&&e.email!==n.email)],e._currentAppId=s.id,e._canViewAsGuest=d,e._meUser=n,e.viewAsDefault()},enabled:i&&(null==s?void 0:s.id),logErrorMsg:"[ViewAs]: Failed to load users for app: ".concat(null==s?void 0:s.id),toastError:"Unable to view as other users for this application",onError:()=>{e.reset(),e._currentAppId=s.id}},[null==s?void 0:s.id])}})).use(()=>({useBiEvents:()=>{const{app:e}=lp(),{user:t}=wd();return{onUserSelected:s=>{var a;const n={matched_property:s.matchValue,matched_property_title:s.matchField};Tu("View As User Selected",(0,ue.A)({app_id:null==e?void 0:e.id,user_id:null==t?void 0:t.id,selected_user_email_domain:s.email?null===(a=s.email.split("@")[1])||void 0===a?void 0:a.toLowerCase():null},n)),Vu({user_id:(null==t?void 0:t.id)||null,app_id:(null==e?void 0:e.id)||null},(0,ue.A)({cta:"View as user selected",origin:"view_as_dropdown",target_route:"/act_user",selected_user_email:s.email},n))}}}}));function Ch(){kh.isLoading=!0,setTimeout(()=>{kh.isLoading=!1},2e3)}const Ah="analytics-enable",Sh=e=>{let{url:t,iframeRef:s}=e;if(s.current){const e=null!=t?t:s.current.src;s.current.src="",setTimeout(()=>{s.current&&(s.current.src=e)},50)}},Eh=["data"],Th="sandbox",Ih=e=>{var t;let{isPhoneMode:s,className:a}=e;const{sandboxPreviewUrl:n,basePreviewUrl:l,isInitializingSandbox:r,isLoadingSandbox:i,isUpdatingSandbox:o,fullRefreshSandbox:c,sandboxConfig:d,setPageNameInSandboxUrl:u,isSandboxMounted:m,dataEnv:x}=Ph(),h=(0,Y.useRef)(null),[p,g]=(0,Y.useState)(null),f=qu(),[v,b]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[s,a]=(0,Y.useState)(t);return[Px(s,e),a]}(1e3),j=jh.useIsGeneratingInitialPrompt(),y=Px(r||i||o||v||j,100),N=v||j||(null==a?void 0:a.includes("hidden"));Lx({isDisplayed:!y,previewUrl:n,previewType:"sandbox"}),(0,Y.useEffect)(()=>(function(){if(zh)return;window.addEventListener("message",Hh),zh=!0}(),()=>{window.removeEventListener("message",Hh),zh=!1,Bh[Th]=null,Bh[Dh]=null,Bh[Oh]=null}),[]);const w=(0,Y.useCallback)(e=>{var t;var s,a;(null!==(t=d["external-navigation"])&&void 0!==t?t:{}).enabled?null===(s=h.current)||void 0===s||s.contentWindow.postMessage({type:null===(a=d["external-navigation"])||void 0===a?void 0:a.topic,url:"/".concat(e)},"*"):u(e)},[u,d]);return Wu.useRegisterPreview(Th,{iframeRef:p,pagesNames:null===(t=d.components)||void 0===t?void 0:t.pages,refreshHandler:c,navigateHandler:w}),(0,Y.useEffect)(()=>{b(!0),setTimeout(()=>{b(!1)},2e4)},[l]),(0,Y.useEffect)(()=>{b(!0)},[x]),(0,Y.useEffect)(()=>{o&&b(!1)},[o]),(0,Y.useEffect)(()=>{!j&&b(!1)},[j]),(0,Y.useEffect)(()=>{m&&b(!1)},[m]),(0,Y.useEffect)(()=>{Tu("SandboxPreviewIframe",{base_preview_url:l,timestamp:(new Date).getTime(),iframe_loading:v,is_app_fully_ready:!j})},[v,j]),(0,se.jsxs)("div",{className:de("relative w-full h-full",a),children:[(0,se.jsx)(Mx.N,{children:y&&(0,se.jsx)(Rx.P.p,{initial:{opacity:0,background:"transparent",backdropFilter:"none"},animate:{opacity:1,background:"rgba(255, 255, 255, 0.6)",backdropFilter:"blur(6px)"},exit:{opacity:0,background:"transparent",backdropFilter:"none"},transition:{duration:.6,ease:"easeInOut"},className:" absolute w-full h-full flex items-center justify-center",children:(0,se.jsx)(bh,{loadingState:"preparing"})})}),(0,se.jsx)("iframe",{title:"App Preview",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",ref:h,id:"preview-iframe",src:n,onLoad:()=>{n&&b(!1),g(h.current)},onError:()=>{b(!1),Tu("SandboxPreviewIframe",{base_preview_url:l,timestamp:(new Date).getTime(),error:!0,iframe_loading:!1,is_app_fully_ready:!j})},className:de(" transition-all duration-1000 ease-in-out w-full h-full",{"w-[375px] h-[667px] border border-gray-300 rounded-xl shadow-md justify-self-center":s,"opacity-0":N,"opacity-100":!N}),style:f&&!s?{height:"100vh"}:{}})]})},Ph=()=>{const{app:e,runtimeAuthToken:t,setAppErrors:s,isUpdatingApp:a,dataEnv:n}=lp(),{pageName:l}=(0,J.g)(),r=Ku(),{isSyncingSandboxCheckpoint:i}=Tx("isSyncingSandboxCheckpoint"),o=(0,Y.useRef)(!1),[c,d]=(0,Y.useState)(l||null),{isLoading:u}=kh.usePick("isLoading"),m=kh.useViewAsPreviewUrlParams(),{sandboxUpdating:x,sandboxConfig:h,reset:p,isSandboxMounted:g}=Lh(),f=Xd({query:async t=>{var a;(null==t||null===(a=t.refetchData)||void 0===a||!a.keepAlive)&&s([]);const n=await Gu.getPreviewURL(e.id);return{previewUrl:n.preview_url.startsWith("http")?n.preview_url:"".concat(window.location.protocol,"//").concat(n.preview_url),expireTimestamp:n.timeout_timestamp}},initialData:{previewUrl:null,expireTimestamp:null},enabled:Boolean(r&&null!=(null==e?void 0:e.id)),retry:{delay:1e3,retries:3},logErrorMsg:"Failed to fetch sandbox preview URL",onLoading:e=>{e||(o.current=!1)}},[null==e?void 0:e.id]),{data:{expireTimestamp:v,previewUrl:b}}=f,j=(0,Nt.A)(f,Eh);(0,Y.useEffect)(()=>{l&&d(l)},[l]);const y=(0,Y.useMemo)(()=>{var e;const s=c||"";if(!b)return null;const a=s?"".concat(b,"/").concat(s):b,l=new URL(b).origin;return a+"?"+new URLSearchParams((0,ue.A)((0,ue.A)({hide_badge:"true",base44_data_env:n,server_url:l},null!==(e=m)&&void 0!==e?e:{access_token:t}),{},{[Ah]:"false"})).toString()},[t,b,c,m,n]);(0,Y.useEffect)(()=>{const e=setInterval(()=>{document.hidden||(o.current=!0,j.refetchIfEnabled({keepAlive:!0}))},6e4);return()=>{clearInterval(e)}},[j.refetchIfEnabled]),(0,Y.useEffect)(()=>{const e=e=>{var t;"preview:requestRefresh"===(null===(t=e.data)||void 0===t?void 0:t.type)&&j.refetchIfEnabled({keepAlive:!0})};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[j.refetchIfEnabled]),(0,Y.useEffect)(()=>{if(null==e||!e.id)return;const t=()=>{if(!document.hidden){var t;const s=new Date(Date.now()+36e5).toISOString(),a="preview_timeout_timestamp_".concat(e.id),n=null!==(t=null!=v?v:localStorage.getItem(a))&&void 0!==t?t:s;localStorage.setItem(a,n);const l=new Date(n).getTime();(new Date).getTime()>l&&(localStorage.setItem(a,s),j.resetData({refetch:!0}))}};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}},[null==e?void 0:e.id,j.resetData,j.refetchIfEnabled]);const N=(0,Y.useCallback)(()=>{p(),j.resetData({refetch:!0})},[p,j.resetData]),w=x||a||i||u,_=!y&&j.isLoading,k=j.isLoading&&!o.current;return{sandboxPreviewUrl:y,basePreviewUrl:b,isLoadingSandbox:k,isInitializingSandbox:_,isUpdatingSandbox:w,fullRefreshSandbox:N,setPageNameInSandboxUrl:d,sandboxConfig:h,isSandboxMounted:g,dataEnv:n}},Lh=()=>{const{setAppErrors:e}=lp(),[t,s]=(0,Y.useState)(!1),[a,n]=(0,Y.useState)({}),[l,r]=(0,Y.useState)(!1),i=dm.useIsVisualEditMode();(0,Y.useEffect)(()=>{Wu.postMessageToPreview({type:"toggle-visual-edit-mode",data:{enabled:i}},{previewName:Th,log:!0})},[i]);const o=(0,Y.useCallback)(t=>{var a;switch(null===(a=t.data)||void 0===a?void 0:a.type){case"sandbox:beforeUpdate":s(!0),e([]),setTimeout(()=>{s(!1)},1e4);break;case"sandbox:afterUpdate":case"sandbox:error":s(!1);break;case"sandbox:config":n(e=>(0,ue.A)((0,ue.A)({},e),t.data.config));break;case"sandbox:onMounted":const a=dm.isVisualEditMode||dm.isSelectElementMode;Wu.postMessageToPreview({type:"toggle-visual-edit-mode",data:{enabled:a}},{previewName:Th,log:!0}),r(!0);break;case"sandbox:onUnmounted":r(!1)}},[e]);return(0,Y.useEffect)(()=>(window.addEventListener("message",o),()=>{window.removeEventListener("message",o)}),[o]),{sandboxUpdating:t,sandboxConfig:a,reset:()=>{s(!1),n({}),e([])},isSandboxMounted:l}},Mh=e=>{const{app:t}=lp(),{updateCheckpointInState:s,setSelectedCheckpoint:a,selectedCheckpoint:n}=Tx("updateCheckpointInState","setSelectedCheckpoint","selectedCheckpoint"),{refetch:l,isLoading:r}=Xd({query:async()=>{if(null==e||!e.id)return;const l=await Zu.retryCheckpointBuild({appId:t.id,checkpointId:e.id}),r={preview_status:l.status,git_commit_hash:l.git_commit_hash};s(e.id,r),(null==n?void 0:n.id)===e.id&&a((0,ue.A)((0,ue.A)({},e),r))},enabled:!1,logErrorMsg:"Failed to retry build:"},[null==e?void 0:e.id,t.id]);return{retryBuild:l,isRetrying:r}},Rh=e=>{const t=!(null==e||!e.git_commit_hash),s=null==e?void 0:e.preview_status;return{hasGitCommitHash:t,isPreviewBuilding:"building"===s||"pending"===s,isPreviewFailed:"failed"===s,isPreviewReady:"ready"===s||!t&&!s}},Dh="static",Fh=e=>{var t;let{isPhoneMode:s,className:a}=e;const{app:n,runtimeAuthToken:l,dataEnv:r}=lp(),[i,o]=(0,Y.useState)(null==n?void 0:n.main_page),{selectedCheckpoint:c}=Tx("selectedCheckpoint"),d=uo(),u=(0,Y.useRef)(null),m=kh.useViewAsPreviewUrlParams(),[x,h]=(0,Y.useState)(!0),p=(0,Y.useRef)(null),g=e=>{clearTimeout(p.current),p.current=setTimeout(()=>{h(!1)},e)},f=(0,Y.useMemo)(()=>{var e,t;h(!0),g(1e4);const s=Boolean(null==n?void 0:n.slug)?Pc(n):void 0,a=null!==(e=null==c?void 0:c.preview_url)&&void 0!==e?e:s;if(!a)return null;const o=new URL(a).origin,d=new URLSearchParams((0,ue.A)((0,ue.A)({hide_badge:"true",base44_data_env:r,server_url:o},null!==(t=m)&&void 0!==t?t:{access_token:l}),{},{[Ah]:"false"}));return"".concat(a,"/").concat(null!=i?i:"","?").concat(d.toString())},[null==n?void 0:n.slug,l,i,m,null==c?void 0:c.preview_url,r]);Lx({isDisplayed:!x&&"ready"===(null==n||null===(t=n.status)||void 0===t?void 0:t.state),previewUrl:f,previewType:"static",checkpointId:null==c?void 0:c.id});const v=(0,Y.useMemo)(()=>{var e;return Object.keys(null!==(e=null==n?void 0:n.pages)&&void 0!==e?e:{})},[null==n?void 0:n.pages]),b=(0,Y.useCallback)(()=>{Sh({url:f,iframeRef:u})},[f,u]),j=(0,Y.useCallback)(e=>o(e),[o]);Wu.useRegisterPreview(Dh,{iframeRef:u.current,refreshHandler:b,pagesNames:v,navigateHandler:j,mainPage:null==n?void 0:n.main_page});const{hasGitCommitHash:y,isPreviewBuilding:N,isPreviewFailed:w,isPreviewReady:_}=Rh(c),k=Boolean(null==c?void 0:c.id),{retryBuild:C,isRetrying:A}=Mh(c);if(k&&y&&!_){if(N||A)return(0,se.jsx)("div",{className:de("relative w-full h-full",a),children:(0,se.jsx)(bh,{loadingState:"checkpoint_building"})});if(w)return(0,se.jsx)("div",{className:de("relative w-full h-full",a),children:(0,se.jsx)(bh,{loadingState:"checkpoint_failed",onRetry:()=>C()})})}return(0,se.jsxs)("div",{className:de("relative w-full h-full",a),children:[(0,se.jsx)(Mx.N,{children:x&&(0,se.jsx)(Rx.P.p,{initial:{opacity:0,background:"transparent",backdropFilter:"none"},animate:{opacity:1,background:"rgba(255, 255, 255, 0.6)",backdropFilter:"blur(6px)"},exit:{opacity:0,background:"transparent",backdropFilter:"none"},transition:{duration:.6,ease:"easeInOut"},className:" absolute w-full h-full flex items-center justify-center",children:(0,se.jsx)(bh,{loadingState:"preparing"})})}),(0,se.jsx)("iframe",{title:"App Preview",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",src:null!=f?f:"",ref:u,id:"preview-iframe",onLoad:()=>{null!=f&&f.length&&g(2e3)},className:de("transition-all duration-300 ease-in-out w-full h-full",{"w-[375px] h-[667px] border border-gray-300 rounded-xl shadow-md justify-self-center":s}),style:d&&!s?{height:"100vh"}:{}})]})},Oh="default",Uh=e=>{var t,s,a,n;let{isPhoneMode:l,view:r}=e;const{app:i}=lp(),o=(0,J.Zp)(),c=Tx(e=>e.selectedCheckpoint),d=null!==(t=null==c?void 0:c.id)&&void 0!==t?t:"",{getIframeURL:u}=(()=>{const{app:e,runtimeAuthToken:t,dataEnv:s}=lp();return{getIframeURL:(0,Y.useCallback)(a=>{let n,{selectedCheckpointId:l,selectedCheckpoint:r,pagePath:i,viewAsUrlParams:o}=a;n=l&&r?e.using_sandbox&&r.preview_url?r.preview_url:Ic(e,{id:l}):l?Ic(e,{id:l}):Pc(e);const c=new URLSearchParams((0,ue.A)({hide_badge:"true",base44_data_env:s},null!=o?o:{access_token:t}));return"".concat(n).concat(i,"?").concat(c.toString())},[e,t,s])}})(),m=uo(),x=(0,Y.useRef)(null),[h,p]=(0,Y.useState)(!1),g=kh.useViewAsPreviewUrlParams(),[f,v]=(0,Y.useState)(""),b=gu.useMessages(),j=(0,Y.useMemo)(()=>u({selectedCheckpointId:d,selectedCheckpoint:c,viewAsUrlParams:g,pagePath:f}),[f,g,d,c]);(0,Y.useEffect)(()=>{Sh({url:j,iframeRef:x})},[j]);const y=(0,Y.useCallback)(()=>{p(!1),Sh({url:j,iframeRef:x})},[d]);Lx({isDisplayed:h&&"ready"===(null==i||null===(s=i.status)||void 0===s?void 0:s.state),previewUrl:j,previewType:"default",checkpointId:d});const N=(0,Y.useCallback)(e=>{o("/apps/".concat(null==i?void 0:i.id,"/editor/preview/").concat(e)),v("/".concat(e))},[v,o]);return Wu.useRegisterPreview(Oh,{iframeRef:x.current,refreshHandler:y,pagesNames:Object.keys(null!==(a=null==i?void 0:i.pages)&&void 0!==a?a:{}),navigateHandler:N}),(0,Y.useEffect)(()=>{if(d)"workspace"===r.toLowerCase()?o("/apps/".concat(i.id,"/editor/preview")):y();else{if("ready"!==i.status.state)return;b.length<=2?setTimeout(()=>{y()},1e3):y()}},[d,r,null===(n=i.status)||void 0===n?void 0:n.last_updated_date,b.length]),(0,Y.useEffect)(()=>{i.slug&&x.current&&!x.current.src.includes(i.slug)&&y()},[i.slug]),(0,se.jsx)("iframe",{title:"App Preview",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",ref:x,id:"preview-iframe",onLoad:()=>p(!0),className:de("relative transition-all duration-300 ease-in-out w-full h-full",{"w-[375px] h-[667px] border border-gray-300 rounded-xl shadow-md":l}),style:m&&!l?{height:"100vh"}:{}})},Bh={[Th]:null,[Dh]:null,[Oh]:null};let zh=!1;function Hh(e){var t;if(function(e){if(!e)return!1;try{const t=new URL(e).host;return["https://base44.app","base44.app"].some(e=>{if(!e)return!1;const s=e.includes("://")?new URL(e).host:e;return t===s||t.endsWith(".".concat(s))})}catch(t){return!1}}(e.origin)&&"DEBUG_SNAPSHOT"===(null===(t=e.data)||void 0===t?void 0:t.type)){const t=e.data.payload,s=function(e){try{if(new URL(e).hostname.startsWith("preview-sandbox--"))return Th}catch(t){}return Dh}(t.url);Bh[s]=t}}const Vh=e=>{var t,s,a;let{startTime:n,body:l,updatedApp:r=null,userMessageId:i=null,agentMessage:o=null,agentModel:c=null,wasSuccessful:d,responseModel:u=null,error:m=null,userId:x=null,appId:h=null,isInitialCreation:p=!1,appModel:g=null,toolsUsed:f=[]}=e;const v=Date.now()-n,b=(null==r||null===(t=r.conversation)||void 0===t?void 0:t.id)||null,j={app_id:h,conversation_id:b,message_id:i,message:String((null==l?void 0:l.content)||""),has_files:((null===(s=l.file_urls)||void 0===s?void 0:s.length)||0)>0,user_id:x,was_successful:d,model:c,response_model:u,is_initial_creation_message:p,model_selection_type:Wh(g),selected_model:qh(g),tools_used:f};if(!d&&m){var y,N;const e=m;j.error_message=(null==e||null===(y=e.response)||void 0===y||null===(N=y.data)||void 0===N?void 0:N.message)||(null==e?void 0:e.message)||"unknown"}Tu("Message Completed",j),zu({user_id:x,app_id:h,conversation_id:b},(0,ue.A)({message_id:i,user_message:String((null==l?void 0:l.content)||""),agent_message:o,model:c,was_successful:d,response_model:u,duration:v,has_files:((null===(a=l.file_urls)||void 0===a?void 0:a.length)||0)>0,is_initial_creation_message:p},j.error_message?{error_message:String(j.error_message)}:{}))},Wh=e=>e&&"default"!==e?"explicit":"default",qh=e=>e&&"default"!==e?e:null;async function Yh(e){let{appId:t,body:s,app:a=null,user:n=null,onSuccess:l,onError:r}=e;const i=Date.now(),o=0===(gu.messages.length||0);try{var c,d,u,m,x;(e=>{var t,s;let{body:a,userId:n=null,appId:l=null,conversationId:r=null,isInitialCreation:i=!1,appModel:o=null}=e;const c={app_id:l,conversation_id:r,user_id:n,message:String((null==a?void 0:a.content)||""),has_files:((null===(t=a.file_urls)||void 0===t?void 0:t.length)||0)>0,is_initial_creation_message:i,model_selection_type:Wh(o),selected_model:qh(o)};Tu("Message Sent",c),Bu({user_id:n,app_id:l,conversation_id:r},{user_message:String((null==a?void 0:a.content)||""),has_files:((null===(s=a.file_urls)||void 0===s?void 0:s.length)||0)>0,is_initial_creation_message:i})})({body:s,userId:(null==n?void 0:n.id)||null,appId:t||null,conversationId:gu.id||null,isInitialCreation:o,appModel:(null==a?void 0:a.model)||null});const e=function(){const e=Wu.activePreviewName;return e===Th?Bh[Th]:e===Dh?Bh[Dh]:e===Oh?Bh[Oh]:Bh[Th]||Bh[Dh]||Bh[Oh]}(),r=(0,ue.A)((0,ue.A)({},s),e&&{debug_snapshot:e}),h=await zc.addMessage(t,r),p=((e,t)=>{try{const r=e||[];if(null!=t)for(let e=r.length-1;e>=0;e--){var s,a;const n=r[e];if("user"===(null==n?void 0:n.role)&&String(null!==(s=null==n?void 0:n.content)&&void 0!==s?s:"")===String(null!==(a=t)&&void 0!==a?a:""))return(null==n?void 0:n.id)||null}for(let e=r.length-1;e>=0;e--){var n,l;if("user"===(null===(n=r[e])||void 0===n?void 0:n.role))return(null===(l=r[e])||void 0===l?void 0:l.id)||null}return null}catch(r){return null}})((null==h||null===(c=h.conversation)||void 0===c?void 0:c.messages)||null,null==s?void 0:s.content),{message:g,model:f}=(e=>{try{const n=e||[];for(let e=n.length-1;e>=0;e--){var t,s,a;if("assistant"===(null===(t=n[e])||void 0===t?void 0:t.role))return{message:String((null===(s=n[e])||void 0===s?void 0:s.content)||""),model:(null===(a=n[e])||void 0===a?void 0:a.model)||null}}return{message:null,model:null}}catch(n){return{message:null,model:null}}})((null==h||null===(d=h.conversation)||void 0===d?void 0:d.messages)||null),v=(e=>{try{const t=e||[],s=new Set;for(let e=t.length-1;e>=0;e--){const a=t[e];if("user"===(null==a?void 0:a.role))break;if("assistant"===(null==a?void 0:a.role)&&null!=a&&a.tool_calls&&Array.isArray(a.tool_calls))for(const e of a.tool_calls)null!=e&&e.name&&s.add(e.name)}return Array.from(s)}catch(t){return[]}})((null==h||null===(u=h.conversation)||void 0===u?void 0:u.messages)||null),b=null!=h&&null!==(m=h.conversation)&&void 0!==m&&m.id?h:a,j=null==h||null===(x=h.conversation)||void 0===x?void 0:x.model;return Vh({startTime:i,body:s,updatedApp:b||null,userMessageId:p,agentMessage:g,agentModel:f,wasSuccessful:!0,responseModel:j,userId:(null==n?void 0:n.id)||null,appId:t||null,isInitialCreation:o,appModel:(null==a?void 0:a.model)||null,toolsUsed:v}),l&&await l(h),h}catch(h){throw Vh({startTime:i,body:s,updatedApp:a||null,userMessageId:null,agentMessage:null,agentModel:null,wasSuccessful:!1,responseModel:null,error:h,userId:(null==n?void 0:n.id)||null,appId:t||null,isInitialCreation:o,appModel:(null==a?void 0:a.model)||null,toolsUsed:[]}),r&&await r(h),h}}async function Gh(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Yh({appId:e,body:(0,ue.A)((0,ue.A)({},t),{},{additional_message_params:{from_mobile:a.from_mobile}}),user:{id:s},onSuccess:e=>{},onError:e=>{}})}function Kh(){return(0,se.jsxs)("div",{className:"min-h-screen bg-[#F8FAFC] flex flex-col relative overflow-hidden font-base44",children:[(0,se.jsx)("div",{className:"absolute left-0 top-[65%]  w-[100%] h-[100%] rounded-full opacity-60 blur-3xl bg-[radial-gradient(circle,#FF5500_10%,#FFEAA6_70%)]"}),(0,se.jsx)("div",{className:"md:px-[60px] px-[16px] md:py-[24px] py-[16px] z-10",children:(0,se.jsxs)("div",{className:"flex items-center space-x-3 h-[44px]",children:[(0,se.jsx)(Dc,{width:32,height:32}),(0,se.jsx)("span",{className:"text-xl font-semibold text-slate-800",children:"Base 44"})]})}),(0,se.jsxs)("div",{className:"flex-1 flex-col flex w-[100vw] items-center justify-center gap-6 z-10",children:[(0,se.jsx)("h1",{className:"md:text-[100px] text-[42px] md:font-medium text-[#001E36] md:leading-[109px] tracking-[-1px] mb-6",children:"Couldn't load the app"}),(0,se.jsxs)("div",{className:"md:text-[28px] text-[18px] text-center font-normal text-black space-y-2",children:[(0,se.jsx)("p",{children:"You may not have permissions to access it."}),(0,se.jsxs)("p",{children:["Please refresh or ",(0,se.jsx)("span",{className:"underline text-primary hover:text-orange-500 transition-colors cursor-pointer",onClick:()=>window.open("/support","_blank"),children:"reach out to support"})]})]})]})]})}var $h=s(36150);const Zh="appFiles",Jh=(e,t)=>{const s=(0,X.jE)(),a=(0,$h.I)({queryKey:[Zh,e],queryFn:()=>Gu.getAppFiles(e),enabled:!!e&&t,refetchOnWindowFocus:!1,staleTime:1/0});return(0,ue.A)((0,ue.A)({},a),{},{updateCachedFile:(t,a)=>{s.setQueryData([Zh,e],e=>e?(0,ue.A)((0,ue.A)({},e),{},{[t]:a}):e)}})},Qh=e=>e.replace(/^src\//,""),Xh=e=>{const t=Qh(e).toLowerCase();return"layout"===t||"layout.jsx"===t||"layout.js"===t},ep=(e,t)=>e&&Object.keys(e).find(e=>((e,t)=>Qh(e).startsWith(t))(e,t))||null,tp=e=>e&&Object.keys(e).find(e=>Xh(e))||null,sp=e=>{if(!e)return e;const t=e.lastIndexOf(".");return t<=0?e:e.substring(0,t)},ap=(0,Y.createContext)(),np=e=>{let{children:t}=e;const{user:s,reloadUser:a,isAuthenticated:n}=wd(),{appId:l,pageName:r}=(0,J.g)(),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!0),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)(null),[b,j]=(0,Y.useState)(null),[y,N]=(0,Y.useState)([]),[w,_]=(0,Y.useState)(null),[k,C]=(0,Y.useState)(null),{isNativeMobile:A}=fd(),{data:S,updateCachedFile:E}=Jh(null==i?void 0:i.id,null==i?void 0:i.using_sandbox),[T,I]=(0,Y.useState)(()=>l&&localStorage.getItem("base44_data_env_".concat(l))||"prod");(0,Y.useEffect)(()=>{l&&I(localStorage.getItem("base44_data_env_".concat(l))||"prod")},[l]),(0,Y.useEffect)(()=>{i&&!i.dev_environment_enabled&&I("prod")},[null==i?void 0:i.dev_environment_enabled]),(0,Y.useEffect)(()=>{l&&("dev"===T?localStorage.setItem("base44_data_env_".concat(l),"dev"):localStorage.removeItem("base44_data_env_".concat(l)))},[T,l]);const P=e=>{o(e),gu.refreshConversation(l)},[L,M]=(0,Y.useState)(!1),[R,D]=(0,Y.useState)(!1),[F,O]=(0,Y.useState)(null);(0,Y.useEffect)(()=>((0,me.bx)(()=>l),n&&a(),()=>{(0,me.bx)(()=>null),n&&a()}),[l,n]),(0,Y.useEffect)(()=>{if(!i||l&&(null==i?void 0:i.id)!==l)return(()=>{let e=null;const t=l;return(async()=>{try{d(!0),e=await zc.fetchAndSubscribe(t,(e,s)=>{o(a=>{var n;return a?(s&&s.forEach(t=>{a[t]=e[t]}),null!=s&&s.includes("_last_msg")&&gu.upsertMessage(a._last_msg),(0,ue.A)({},a)):(gu.initConversation(t,null===(n=e.conversation)||void 0===n?void 0:n.id),e)}),K()});const a=zc.getBaseURL()+"/"+t;Fd.A.setDirectiveCallback(a,"conversation_changed",async()=>{gu.refreshConversation()});const[n,r,i]=await Promise.all([Yd.default.getCurrentUsage(),zc.getRuntimeAuthToken(l,s.api_key),zc.getOwnerEmail(l)]);j(n),W(t),_(r.token),C(i),q(t)}catch(r){var a,n;h("Failed to load app  : "+((null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||r.message))}finally{d(!1)}})(),()=>{e&&e();const s=zc.getBaseURL()+"/"+t;Fd.A.removeAllDirectiveCallbacks(s)}})()},[l]),(0,Y.useEffect)(()=>{i&&k&&i.owner_email!==k&&o(e=>(0,ue.A)((0,ue.A)({},e),{},{owner_email:k}))},[i,k]),(0,Y.useEffect)(()=>{xd("appData")},[]),(0,Y.useEffect)(()=>{c||hd("appData")},[c,i,x]);const U=(0,Y.useMemo)(()=>{if(null!=i&&i.using_sandbox&&S){const e={};return Object.keys(S).forEach(t=>{const s=Qh(t);if(s.startsWith("pages/")){const a=sp(s.replace("pages/",""));e[a]=S[t]}}),e}return(null==i?void 0:i.pages)||{}},[null==i?void 0:i.using_sandbox,null==i?void 0:i.pages,S]),B=(0,Y.useMemo)(()=>{if(null!=i&&i.using_sandbox&&S){const e={};return Object.keys(S).forEach(t=>{const s=Qh(t);if(s.startsWith("components/")){const a=sp(s.replace("components/",""));e[a]=S[t]}}),e}return(null==i?void 0:i.components)||{}},[null==i?void 0:i.using_sandbox,null==i?void 0:i.components,S]),z=(0,Y.useMemo)(()=>{if(null!=i&&i.using_sandbox&&S){const e=tp(S);return e?S[e]:null}return(null==i?void 0:i.layout)||null},[null==i?void 0:i.using_sandbox,null==i?void 0:i.layout,S]),H=(0,Y.useMemo)(()=>{var e;const t=null!==(e=null==i?void 0:i.page_names)&&void 0!==e?e:Object.keys((null==i?void 0:i.pages)||{});return new Set(t)},[null==i?void 0:i.page_names,null==i?void 0:i.pages]);let V=null;if(r)U[r]&&(V={name:r,code:U[r]});else if(Object.keys(U).length>0){const e=Object.keys(U)[0];V={name:e,code:U[e]}}const W=async e=>{const t=await iu.getSecrets(e);N(Object.keys(t))},q=async e=>{if(!window.location.href.includes("/editor/"))return;const t=await zc.getSuggestions((null==i?void 0:i.id)||e);v(t)};let G=t;if(c)G=(0,se.jsx)("div",{className:"fixed inset-0 flex justify-center items-center",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin"})});else{if(x)return(0,se.jsx)(Kh,{});i||(G=(0,se.jsx)(Dt,{variant:"destructive",children:(0,se.jsx)(Ot,{children:"App not found"})}))}const K=()=>{i&&!c&&(i.using_sandbox||g([]))};return(0,se.jsx)(ap.Provider,{value:{app:i,setApp:P,updateApp:async e=>{m(!0);try{const t=await zc.update(i.id,e);K(),P(t)}finally{m(!1)}},updateSlug:async e=>{let{slug:t}=e;m(!0);try{const e=await zc.updateSlug({appId:i.id,slug:t});K(),P(e),q()}finally{m(!1)}},isLoading:c,isUpdatingApp:u,error:x,getEntitiesSDK:function(e){const t={"X-Bypass-RLS":"true","X-Bypass-Entities-Filter-Limit":"true",Authorization:"Bearer ".concat(w),"X-Data-Env":T};return pe(i,e,null,t)},appErrors:p,setAppErrors:g,onAppError:(e,t,s,a)=>{let n;n=dc().isObject(e)?{title:e.title||e.message||e.toString(),details:e.details||e.stack||e.toString(),componentName:s||r,stack:e.stack||a||null}:{title:e,details:t,componentName:s||r,stack:a||null},g(e=>e.some(e=>e.title===n.title)?e:[...e,n])},addChatMessage:async e=>{F&&(e.custom_context=[{type:"element",data:{element_tag_name:F.tagName,filename:F.dataset.filename,linenumber:F.dataset.linenumber},message:"User has selected an element to edit, here's the element's code position: file: ".concat(F.dataset.filename,", line number: ").concat(F.dataset.linenumber)}],O(null),D(!1)),e.additional_message_params=e.additional_message_params||{},V&&(e.additional_message_params.current_page=V.name),e.additional_message_params.user_timezone=Intl.DateTimeFormat().resolvedOptions().timeZone,e.additional_message_params.from_mobile=A,null!=i&&i.dev_environment_enabled&&(e.additional_message_params.data_env=T);try{await Yh({appId:l,body:e,app:i,user:s,onSuccess:async e=>{"pending"!==e.app_stage&&q(),await(async()=>{const e=await Yd.default.getCurrentUsage();j(e)})()},onError:e=>{}})}catch(t){}},undoMessage:async e=>{try{const t=await zc.undoMessage(l,e);P(t)}catch(s){var t;const e=null===(t=s.response)||void 0===t?void 0:t.status;if(403===e)return void h("You do not have access to this app");if(400===e||404===e||500===e){try{const e=await zc.get(l);P(e)}catch(a){h("Failed to undo message. Please refresh the page.")}return}try{const e=await zc.get(l);P(e)}catch(a){h("An unexpected error occurred. Please refresh the page.")}}},pages:U,pageNames:H,components:B,layout:z,currentPage:V,stopChat:async()=>{const e=await zc.stopChat(i.id);P(e)},submitToolCallInput:async(e,t,s)=>{const a=await zc.submitToolCallInput(i.id,e,t,s);P(a)},loadFullConversation:async()=>{const e=await zc.loadFullConversation({appId:i.id});return P(t=>(0,ue.A)((0,ue.A)({},t),{},{conversation:e})),e},suggestions:f,refreshSuggestions:q,dismissDomainSuggestion:async()=>{const e=await zc.dismissDomainSuggestion((null==i?void 0:i.id)||l);v(e)},currentUsage:b,isSelectingDivMode:L,setIsSelectingDivMode:M,isElementMode:R,setIsElementMode:D,selectedElement:F,setSelectedElement:O,writeCodeToFile:async(e,t)=>{m(!0);try{K();const s=await lu.write(i.id,e,t);P(s),null!=i&&i.using_sandbox&&E(e,t)}finally{m(!1)}},existingSecretNames:y,updateSecrets:async e=>{await iu.updateSecrets(l,e),await W(l)},runtimeAuthToken:w,refreshApp:async()=>{const e=await zc.get(i.id);P(e)},dataEnv:T,setDataEnv:I},children:G})},lp=()=>(0,Y.useContext)(ap);class rp extends te.H{getBaseURL(){return"/files"}uploadFile(e){const t=new FormData;return t.append("file",e),this.axios.post("/",t,{headers:{"Content-Type":"multipart/form-data"}})}uploadAppFile(e,t){const s=new FormData;return s.append("file",e),this.axios.post("/apps/".concat(t,"/upload"),s,{headers:{"Content-Type":"multipart/form-data"}})}}const ip=new rp;var op=s(52607),cp=s(15952);const dp=["className","sideOffset"],up=["className"],mp=st.Provider,xp=st.Root,hp=st.Trigger,pp=Y.forwardRef((e,t)=>{let{className:s,sideOffset:a=4}=e,n=(0,Nt.A)(e,dp);return(0,se.jsx)(st.Portal,{children:(0,se.jsx)(st.Content,(0,ue.A)({ref:t,sideOffset:a,className:de("z-50 overflow-hidden font-base44 rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s)},n))})});pp.displayName=st.Content.displayName;const gp=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,up);return(0,se.jsx)(st.Arrow,(0,ue.A)({ref:t,className:de("fill-current",s)},a))});gp.displayName=st.Arrow.displayName;class fp extends te.H{getBaseURL(){return"/speech"}async transcribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio.webm";const s=new FormData;return s.append("file",e,t),this.axios.post("/transcribe",s,{headers:{"Content-Type":"multipart/form-data"}})}}const vp=new fp;function bp(e){let{width:t=18,height:s=18,className:a="text-gray-800"}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:s,viewBox:"0 0 24 24",className:a,children:[(0,se.jsx)("style",{children:"\n                    @keyframes pulse-bar {\n                        0%, 100% { transform: scaleY(1); }\n                        50% { transform: scaleY(0.5); }\n                    }\n                    .bar-1 { animation: pulse-bar 0.8s ease-in-out infinite; transform-origin: center; }\n                    .bar-2 { animation: pulse-bar 0.8s ease-in-out 0.1s infinite; transform-origin: center; }\n                    .bar-3 { animation: pulse-bar 0.8s ease-in-out 0.2s infinite; transform-origin: center; }\n                    .bar-4 { animation: pulse-bar 0.8s ease-in-out 0.3s infinite; transform-origin: center; }\n                    .bar-5 { animation: pulse-bar 0.8s ease-in-out 0.4s infinite; transform-origin: center; }\n                "}),(0,se.jsxs)("g",{fill:"none",children:[(0,se.jsx)("path",{d:"m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),(0,se.jsxs)("g",{fill:"currentColor",children:[(0,se.jsx)("path",{className:"bar-1",d:"M12 2.5a1.5 1.5 0 0 1 1.493 1.356L13.5 4v16a1.5 1.5 0 0 1-2.993.144L10.5 20V4A1.5 1.5 0 0 1 12 2.5"}),(0,se.jsx)("path",{className:"bar-2",d:"M8 5.5A1.5 1.5 0 0 1 9.5 7v10a1.5 1.5 0 0 1-3 0V7A1.5 1.5 0 0 1 8 5.5"}),(0,se.jsx)("path",{className:"bar-3",d:"M16 5.5A1.5 1.5 0 0 1 17.5 7v10a1.5 1.5 0 0 1-3 0V7A1.5 1.5 0 0 1 16 5.5"}),(0,se.jsx)("path",{className:"bar-4",d:"M4 8.5A1.5 1.5 0 0 1 5.5 10v4a1.5 1.5 0 0 1-3 0v-4A1.5 1.5 0 0 1 4 8.5"}),(0,se.jsx)("path",{className:"bar-5",d:"M20 8.5a1.5 1.5 0 0 1 1.493 1.356L21.5 10v4a1.5 1.5 0 0 1-2.993.144L18.5 14v-4A1.5 1.5 0 0 1 20 8.5"})]})]})]})}function jp(e){let{onTranscript:t,disabled:s=!1,variant:a="default"}=e;const[n,l]=(0,Y.useState)("idle"),r=(0,Y.useRef)(null),i=(0,Y.useRef)([]),o=(0,Y.useRef)(null),c=(0,Y.useCallback)(async()=>{r.current&&"inactive"!==r.current.state&&r.current.stop(),o.current&&(o.current.getTracks().forEach(e=>e.stop()),o.current=null)},[]);(0,Y.useEffect)(()=>()=>{c()},[c]);const d=(0,Y.useCallback)(async e=>{l("processing");try{var s;const a=null===(s=(await vp.transcribe(e,"audio.webm")).text)||void 0===s?void 0:s.trim();a?t(a):$.toast.error("No speech detected. Please try again.")}catch(n){var a;429===(null==n||null===(a=n.response)||void 0===a?void 0:a.status)?$.toast.error("Too many requests. Please wait a moment and try again."):$.toast.error("Failed to transcribe audio. Please try again.")}finally{l("idle")}},[t]),u=(0,Y.useCallback)(async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});o.current=e;let t="audio/webm";MediaRecorder.isTypeSupported(t)||(t="audio/mp4",MediaRecorder.isTypeSupported(t)||(t="audio/ogg",MediaRecorder.isTypeSupported(t)||(t="")));const s=new MediaRecorder(e,t?{mimeType:t}:void 0);r.current=s,i.current=[],s.ondataavailable=e=>{e.data.size>0&&i.current.push(e.data)},s.onstop=async()=>{const e=new Blob(i.current,{type:t||"audio/webm"});i.current=[],e.size>0?await d(e):(l("idle"),$.toast.error("No audio recorded. Please try again."))},s.onerror=e=>{l("idle"),$.toast.error("Recording error. Please try again.")},s.start(),l("recording")}catch(e){"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?$.toast.error("Microphone access denied. Please allow microphone access to use speech-to-text."):"NotFoundError"===e.name?$.toast.error("No microphone found. Please connect a microphone."):$.toast.error("Failed to access microphone. Please try again."),l("idle")}},[d]),m=(0,Y.useCallback)(()=>{s||("idle"===n?u():"recording"===n&&c())},[s,n,u,c]),x="home"===a?"flex items-center gap-1 px-2 py-2 rounded-md text-xs text-black hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed":"flex items-center gap-1 px-1 py-1.5 mr-2 rounded-md text-xs text-black hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",h=()=>"processing"===n?"Processing audio...":"recording"===n?"Click to stop recording":"Speech to text";return(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("button",{onClick:m,className:de(x,"recording"===n&&"bg-gray-50"),disabled:s||"processing"===n,type:"button","aria-label":h(),children:"processing"===n?(0,se.jsx)(Ac.A,{className:"h-[18px] w-[18px] animate-spin"}):"recording"===n?(0,se.jsx)(bp,{}):(0,se.jsx)(cp.A,{className:"h-[18px] w-[18px]"})})}),(0,se.jsx)(pp,{side:"left",children:(0,se.jsx)("p",{children:h()})})]})})}function yp(e){let{onFileUploadClick:t,customButtomRight:s,customButtomLeft:a,variant:n="default",onSpeechTranscript:l,disabled:r=!1}=e;const[i,o]=(0,Y.useState)(!0),c=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{const e=()=>{if(c.current){const e=c.current.getBoundingClientRect().width;o(e>400)}};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);const d="home"===n?"flex justify-between text-sm py-2 px-2 md:px-4 rounded-b-xl":"flex justify-between text-sm p-2",u="home"===n?"flex items-center gap-1 px-2 py-1 rounded-md text-xs text-black hover:bg-gray-100":"flex items-center gap-1 px-1 py-1 rounded-md text-xs text-black hover:bg-gray-100",m=(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("button",{onClick:t,className:u,children:(0,se.jsx)(op.A,{className:"h-4 w-4"})})}),(0,se.jsx)(Ki,{children:(0,se.jsx)("p",{children:"Upload files"})})]})}),x=l?(0,se.jsx)(jp,{onTranscript:l,disabled:r,variant:n}):null;return(0,se.jsxs)("div",{className:d,ref:c,children:[(0,se.jsx)("div",{className:"flex gap-1 items-center",children:a?a(m):(0,se.jsx)(se.Fragment,{children:m})}),(0,se.jsxs)("div",{className:"flex gap-1 items-center",children:[s,x]})]})}var Np=s(59680);function wp(e){let{files:t,uploadingFiles:s,onRemoveFile:a}=e;const[n,l]=(0,Y.useState)({});return 0===t.length&&0===s.length?null:(0,se.jsxs)("div",{className:"flex flex-wrap gap-4 p-4 border-b",children:[t.map((e,t)=>(0,se.jsx)("div",{className:"relative",children:e.match(/\.(jpg|jpeg|png|gif)$/i)?(0,se.jsxs)("div",{className:"relative group",children:[!n[e]&&(0,se.jsx)("div",{className:"w-[120px] h-[120px] flex items-center justify-center bg-gray-100 rounded-lg",children:(0,se.jsx)(Np.A,{className:"w-4 h-4 animate-spin text-gray-500"})}),(0,se.jsx)("img",{src:e,alt:"Attached content",className:"max-w-[120px] max-h-[120px] object-contain rounded-lg border border-gray-200 shadow-sm ".concat(n[e]?"":"hidden"),onLoad:()=>(e=>{l(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!0}))})(e)}),(0,se.jsx)("button",{onClick:()=>a(e),className:"absolute top-1 right-1 bg-white/80 text-gray-500 hover:text-gray-700 rounded-full p-1",children:"\xd7"})]}):(0,se.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-white rounded-lg border border-gray-200 group relative",children:[(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-500",children:[(0,se.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,se.jsx)("polyline",{points:"14 2 14 8 20 8"})]}),(0,se.jsx)("span",{className:"truncate max-w-[150px]",children:e.split("/").pop()}),(0,se.jsx)("button",{onClick:()=>a(e),className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]})},t)),s.map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-white rounded-lg border border-gray-200",children:[(0,se.jsx)(Np.A,{className:"w-4 h-4 animate-spin text-gray-500"}),(0,se.jsxs)("span",{className:"truncate max-w-[150px] text-gray-500 text-sm",children:["Uploading ",e,"..."]})]},t))]})}var _p=s(19900),kp=s(53034);const Cp=(0,Y.forwardRef)((e,t)=>{let{value:s,onValueChange:a,onKeyDown:n,onPaste:l,placeholder:r,disabled:i,isProcessing:o,showStopFeedback:c=!1,onStop:d,onSend:u,isVisualEditMode:m,isDiscussionMode:x,variant:h="default"}=e;const p=(0,Y.useRef)(null);(0,Y.useImperativeHandle)(t,()=>p.current);(0,Y.useEffect)(()=>{p.current&&"default"===h&&(p.current.style.height="auto",p.current.scrollHeight>400?p.current.style.height="400px":p.current.style.height=p.current.scrollHeight+"px")},[s]);const g=i,f=i||!s&&!o,v="home"===h?"w-full pl-[16px] pt-[6px] pr-12  md:pl-[24px] md:pt-[12px] md:pr-16 font-base44 text-[16px] font-thin mt-2 font-base44 resize-none overflow-auto focus:outline-none bg-transparent placeholder:text-gray-400":"w-full pl-4 pt-4 pr-16 text-sm resize-none overflow-auto focus:outline-none bg-transparent rounded-t-lg",b=de("absolute flex justify-center items-center top-4 right-2 md:right-4 p-1 bg-[#000] hover:bg-orange-600 rounded-[8px] text-white md:rounded-[12px] md:w-[40px] md:h-[40px] w-[30px] h-[30px] transition-colors",{"bg-[#000] cursor-not-allowed":i}),j=de("absolute flex justify-center items-center top-4 w-[28px] h-[28px] right-4 p-1 text-white rounded-lg transition-all",{[f?"bg-violet-300":"bg-violet-600 hover:bg-violet-800"]:x,[f?"bg-blue-300":"bg-blue-600 hover:bg-blue-800"]:!x&&m,[f?"bg-gray-400":"bg-gray-900 hover:bg-gray-800"]:!x&&!m,"animate-pulse opacity-70":c&&o}),y="home"===h?b:j;return(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("textarea",{dir:"auto",ref:p,value:s,onChange:e=>a(e.target.value),onKeyDown:n,onPaste:l,placeholder:r,disabled:g,className:v,style:{default:{height:"auto",minHeight:"100px",maxHeight:"400px"},home:{height:"120px",minHeight:"110px",maxHeight:"200px"}}[h],"aria-label":"Chat message input",onInput:e=>{}}),u&&(0,se.jsx)("button",{onClick:()=>{o?null==d||d():null==u||u()},className:"".concat(y," ").concat(s||o?"":"cursor-not-allowed"),"aria-label":o?"Stop processing":"Send message",title:o?"Stop processing":"Send message",disabled:f,children:o?(0,se.jsx)(_p.A,{className:"w-4 h-4"}):i?(0,se.jsx)(Vc.A,{className:"w-4 h-4"}):(0,se.jsx)(kp.A,{className:"w-6 h-6"})})]})});var Ap=s(15924);const Sp=[".jpg",".jpeg",".png",".pdf",".txt",".html"],Ep=[".gif",".mp4",".webm"],Tp=40,Ip=100,Pp=5,Lp={".jpg":Tp,".jpeg":Tp,".png":Tp,".gif":Tp,".pdf":10,".mp4":Ip,".webm":Ip};async function Mp(e){const t=await async function(e){try{const{PDFDocument:t}=await s.e(96).then(s.bind(s,59595)),a=await e.arrayBuffer();return(await t.load(a,{ignoreEncryption:!0,throwOnInvalidObject:!1})).getPageCount()}catch(t){return null}}(e);return t>100?{valid:!1,error:'PDF "'.concat(e.name,'" has ').concat(t," pages. Maximum amount of pages allowed is ").concat(100,". Please split your PDF into smaller sections.")}:{valid:!0}}async function Rp(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?[...Sp,...Ep]:Sp,s="."+e.name.split(".").pop().toLowerCase();if(!t.includes(s)){const s=t.map(e=>e.substring(1)).join(", ");return{valid:!1,error:'File type "'.concat(e.name.split(".").pop(),'" is not supported. Supported types: ').concat(s,".")}}const a=Lp[s]||Pp,n=1024*a*1024;return e.size>n?{valid:!1,error:'File "'.concat(e.name,'" exceeds the maximum allowed size of ').concat(a,"MB.")}:".pdf"===s?await Mp(e):{valid:!0}}async function Dp(e){if(!e.type.startsWith("image/")||"image/gif"===e.type)return{file:e,mimeType:e.type};const t=1024,s=2097152,a="image/png"===e.type,n=a?"image/png":"image/jpeg",l=a?".png":".jpg";return new Promise((r,i)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=o=>{const c=new Image;c.src=o.target.result,c.onload=()=>{try{let{width:o,height:d}=c;const u=o>t||d>t;if(e.size<=s&&!u)return void r({file:e,mimeType:e.type});u&&(o>d?(d=Math.round(d*t/o),o=t):(o=Math.round(o*t/d),d=t));const m=document.createElement("canvas");m.width=o,m.height=d;const x=m.getContext("2d");a?x.clearRect(0,0,m.width,m.height):(x.fillStyle="white",x.fillRect(0,0,m.width,m.height)),x.drawImage(c,0,0,o,d);const h=t=>{try{m.toBlob(a=>{if(a)if(a.size<=s)try{const t=e.name,s=t.substring(0,t.lastIndexOf("."))||t,i=new File([a],s+l,{type:n,lastModified:Date.now()});r({file:i,mimeType:n})}catch(o){r({file:e,mimeType:e.type})}else if(t>.55)h(t-.1);else try{const t=e.name,s=t.substring(0,t.lastIndexOf("."))||t,i=new File([a],s+l,{type:n,lastModified:Date.now()});r({file:i,mimeType:n})}catch(o){r({file:e,mimeType:e.type})}else i(new Error("Failed to create image blob"))},n,a?null:t)}catch(o){r({file:e,mimeType:e.type})}};h(.85)}catch(o){r({file:e,mimeType:e.type})}},c.onerror=t=>{r({file:e,mimeType:e.type})}},o.onerror=t=>{r({file:e,mimeType:e.type})}})}function Fp(){return(0,Y.useMemo)(()=>{const e=function(){if("undefined"==typeof window||"undefined"==typeof navigator)return"other";const e=navigator.userAgent.toLowerCase(),t=(navigator.platform||"").toLowerCase();if(t.includes("mac")||e.includes("macintosh")||e.includes("mac os"))return"mac";if(t.includes("win")||e.includes("windows"))return"windows";if(t.includes("linux")||e.includes("linux"))return"linux";return"other"}(),t="mac"===e;return{platform:e,modifierKey:t?"Cmd":"Ctrl",modifierSymbol:t?"\u2318":"Ctrl",useMetaKey:t}},[])}const Op={send_message:"enter",insert_new_line:"shift_enter"};function Up(){var e,t;const{user:s}=wd(),{modifierKey:a,modifierSymbol:n,useMetaKey:l}=Fp(),r=null==s||null===(e=s.keyboard_preferences)||void 0===e?void 0:e.send_message,i=null==s||null===(t=s.keyboard_preferences)||void 0===t?void 0:t.insert_new_line,o=(0,Y.useMemo)(()=>({send_message:r||Op.send_message,insert_new_line:i||Op.insert_new_line}),[r,i]),c=(0,Y.useCallback)(e=>{switch(e){case"enter":default:return{label:"Enter",symbol:"\u21b5",type:"enter"};case"cmd_enter":return{label:"".concat(a," + Enter"),symbol:"".concat(n," + \u21b5"),type:"cmd_enter"};case"shift_enter":return{label:"Shift + Enter",symbol:"\u21e7 + \u21b5",type:"shift_enter"}}},[a,n]),d=(0,Y.useMemo)(()=>c(o.send_message),[o.send_message,c]),u=(0,Y.useMemo)(()=>c(o.insert_new_line),[o.insert_new_line,c]),m=(0,Y.useMemo)(()=>[c("enter"),c("shift_enter"),c("cmd_enter")],[c]),x=(0,Y.useCallback)((e,t)=>{if("Enter"!==e.key)return!1;const s=l?e.metaKey:e.ctrlKey,a=e.shiftKey;switch(t){case"enter":return!s&&!a;case"cmd_enter":return s&&!a;case"shift_enter":return a&&!s;default:return!1}},[l]),h=(0,Y.useCallback)(e=>x(e,o.send_message),[x,o.send_message]),p=(0,Y.useCallback)(e=>x(e,o.insert_new_line),[x,o.insert_new_line]),g=(0,Y.useCallback)(e=>{const{onSend:t,value:s,onValueChange:a}=e;return e=>{if("Enter"===e.key){if(x(e,o.send_message))return e.preventDefault(),void t();if(x(e,o.insert_new_line)){var n,r;e.preventDefault();const t=e.target,l=null!==(n=t.selectionStart)&&void 0!==n?n:s.length,i=null!==(r=t.selectionEnd)&&void 0!==r?r:s.length,o=s.substring(0,l)+"\n"+s.substring(i);return a(o),void setTimeout(()=>{t.selectionStart=t.selectionEnd=l+1},0)}if("Enter"===e.key){const t=l?e.metaKey:e.ctrlKey,s=e.shiftKey;if(!t){const t="enter"===o.send_message,a="enter"===o.insert_new_line,n="shift_enter"===o.send_message,l="shift_enter"===o.insert_new_line;s?n||l||e.preventDefault():t||a||e.preventDefault()}}}}},[o,x,l]);return{preferences:o,sendMessageShortcut:d,insertNewLineShortcut:u,shouldSendOnKey:h,shouldInsertNewLineOnKey:p,getShortcutDisplay:c,allShortcutOptions:m,createChatKeyDownHandler:g}}const Bp=1e5,zp=(0,Y.forwardRef)((e,t)=>{let{value:s,files:a=[],onSend:n,placeholder:l,disabled:r,isProcessing:i,showStopFeedback:o=!1,onValueChange:c,onFilesChange:d,onStop:u,customButtomRight:m,customButtomLeft:x,variant:h="default",isDiscussionMode:p=!1,isVisualEditMode:g=!1,className:f}=e;const v=lp(),{createChatKeyDownHandler:b}=Up(),j=(0,Y.useRef)(),y=uo(),[N,w]=(0,Y.useState)([]),[_,k]=(0,Y.useState)(null),[C,A]=(0,Y.useState)(null),S=(null==s?void 0:s.length)||0,E=Bp-S,T=E<0,I=E<=1e3&&E>0||T;(0,Y.useEffect)(()=>{C&&S<Bp&&A(null)},[S,C]);const P=()=>{n&&(n({text:s,files:a}),c(""),d([]),k(null),A(null))},L=b({onSend:P,value:s,onValueChange:c}),M=async e=>{try{const{valid:s,error:a}=await Rp(e);if(!s)return k(a),null;let n=e;if(e.type.startsWith("image/")){w(t=>[...t,"".concat(e.name," (processing...)")]);try{n=(await Dp(e)).file}catch(t){}}w(t=>t.filter(t=>t!=="".concat(e.name," (processing...)"))),w(t=>[...t,e.name]);const l=null!=v&&v.app?await ip.uploadAppFile(n,v.app.id):await ip.uploadFile(n);return w(t=>t.filter(t=>t!==e.name)),k(null),l.url}catch(s){return w(t=>t.filter(t=>t!==e.name)),null}};return(0,se.jsxs)("div",{className:de("w-full relative",{"max-w-[760px] mx-auto rounded-[18px] bg-white px-2":"home"===h,"shadow-[0_16px_30px_0_rgba(0,0,0,0.04)]":!r&&"home"===h,"border border-gray-300 rounded-[16px] bg-white/80 backdrop-blur":"home"!==h,"shadow-[0px_1px_6px_3px_rgba(0,0,0,0.1)] ":!r&&"home"!==h},f),onDrop:async e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files).map(e=>M(e)),s=(await Promise.all(t)).filter(e=>null!==e);s.length>0&&d([...a,...s])},onDragOver:e=>{e.preventDefault()},children:[(0,se.jsx)(wp,{files:a,uploadingFiles:N,onRemoveFile:e=>d(a.filter(t=>t!==e))}),_&&(0,se.jsx)("div",{className:"px-4 py-2",children:(0,se.jsxs)(Dt,{variant:"destructive",className:"flex items-center justify-between",children:[(0,se.jsxs)(Ot,{children:[_,(0,se.jsxs)("div",{className:"mt-1 text-xs",children:["Please request support for additional file types at ",(0,se.jsx)("a",{href:"https://feedback.base44.com",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-destructive-foreground/80",children:"feedback.base44.com"})]})]}),(0,se.jsx)("button",{onClick:()=>k(null),className:"ml-2 inline-flex h-5 w-5 items-center justify-center rounded-full bg-destructive/10 hover:bg-destructive/20",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})}),C&&(0,se.jsx)("div",{className:"px-4 py-2",children:(0,se.jsxs)("div",{className:"flex items-start gap-2 bg-amber-50 border border-amber-200 rounded-lg p-3",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"The text you pasted was too long."}),(0,se.jsxs)("p",{className:"text-xs text-amber-700 mt-0.5",children:["Only ",C.truncatedTo.toLocaleString()," of ",C.originalLength.toLocaleString()," characters were added. Check if important parts were removed."]})]}),(0,se.jsx)("button",{onClick:()=>A(null),className:"flex-shrink-0 inline-flex h-5 w-5 items-center justify-center rounded-full hover:bg-amber-100",children:(0,se.jsx)(la.A,{className:"h-3 w-3 text-amber-600"})})]})}),I&&!C&&(0,se.jsx)("div",{className:"px-4 py-2",children:(0,se.jsxs)("div",{className:de("flex items-center gap-2 rounded-lg p-3",T?"bg-red-50 border border-red-200":"bg-amber-50 border border-amber-200"),children:[(0,se.jsx)(Ap.A,{className:de("h-4 w-4 flex-shrink-0",T?"text-red-600":"text-amber-600")}),(0,se.jsx)("p",{className:de("text-sm font-medium",T?"text-red-800":"text-amber-800"),children:T?"".concat(Math.abs(E).toLocaleString()," characters over the ").concat(Bp.toLocaleString()," limit"):"".concat(E.toLocaleString()," characters remaining")})]})}),(0,se.jsx)(Cp,{ref:t,value:s,onValueChange:c,onKeyDown:L,onPaste:async e=>{var t,n,l;const r=null===(t=e.clipboardData||(null===(n=e.originalEvent)||void 0===n?void 0:n.clipboardData))||void 0===t?void 0:t.items;if(!r)return;const i=null===(l=e.clipboardData)||void 0===l?void 0:l.getData("text");if(i){const t=(null==s?void 0:s.length)||0;if(t+i.length>Bp){e.preventDefault();const a=Bp-t;let n=Math.max(0,a);if(n>0&&n<i.length){const e=i.charCodeAt(n-1);e>=55296&&e<=56319&&n--}const l=i.slice(0,n);c((s||"")+l),l.length>0&&A({originalLength:i.length,truncatedTo:l.length})}}const o=[];for(let s of r)if("file"===s.kind){const e=s.getAsFile();e&&o.push(M(e))}const u=(await Promise.all(o)).filter(e=>null!==e);u.length>0&&d([...a,...u])},placeholder:l,disabled:r,isProcessing:i,showStopFeedback:o,onStop:u,onSend:n?P:null,variant:h,isDiscussionMode:p,isVisualEditMode:g}),(0,se.jsx)("input",{ref:j,type:"file",id:"chat-file-upload",className:"hidden",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files),s=[];for(let a of t){const e=await M(a);e&&s.push(e)}d([...a,...s]),j.current.value=""},accept:".jpg,.jpeg,.png,.pdf,.txt,.html"}),(0,se.jsx)(yp,{onFileUploadClick:()=>document.getElementById("chat-file-upload").click(),value:s,isMobile:y,customButtomLeft:x,customButtomRight:m,variant:h,onSpeechTranscript:e=>{const t=s?"".concat(s," ").concat(e):e;c(t)},disabled:r})]})}),Hp=zp,Vp=["limit","skip","sort_by","seed"],Wp=["limit","skip","sort_by"];class qp extends te.y{listCatalogItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{limit:t,skip:s,sort_by:a,seed:n}=e,l=(0,Nt.A)(e,Vp);const r={};return Object.keys(l).length>0&&(r.q=JSON.stringify(l)),t&&(r.limit=t),s&&(r.skip=s),a&&(r.sort_by=a),void 0!==n&&(r.seed=n),this.axios.get("/catalog",Object.keys(r).length?{params:r}:void 0)}listMyItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{limit:t,skip:s,sort_by:a}=e,n=(0,Nt.A)(e,Wp);const l={};return Object.keys(n).length>0&&(l.q=JSON.stringify(n)),t&&(l.limit=t),s&&(l.skip=s),a&&(l.sort_by=a),this.axios.get("/catalog/my-listings",Object.keys(l).length?{params:l}:void 0)}getCatalogItem(e){return this.axios.get("/catalog/".concat(e))}submitItem(e){return this.axios.post("/catalog",e)}upvoteItem(e){return this.axios.post("/catalog/".concat(e,"/upvote"))}approveItem(e,t){const s=t?{language:t}:void 0;return this.axios.post("/catalog/".concat(e,"/approve"),s)}declineItem(e,t){const s=t?{reason:t}:void 0;return this.axios.post("/catalog/".concat(e,"/decline"),s)}archiveItem(e){return this.axios.post("/catalog/".concat(e,"/archive"))}inviteAdmin(e,t){return this.axios.post("/catalog/".concat(e,"/invite"),{email:t})}}const Yp=new class extends qp{getBaseURL(){return"/integration-catalog-items"}},Gp=["user","support_personnel","platform_admin","platform_owner"];function Kp(e,t){if(!e)return!1;const s=Gp.indexOf(e),a=Gp.indexOf(t);return-1!==s&&-1!==a&&s>=a}const $p=e=>"platform_admin"===e||"platform_owner"===e,Zp=e=>"platform_admin"===e||"platform_owner"===e||"support_personnel"===e;function Jp(e){let{secret:t,value:s,onChange:a}=e;const{user:n}=wd(),{name:l,description:r}=t,[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)(!0),[u,m]=(0,Y.useState)((null==s?void 0:s.type)||"value"),[x,h]=(0,Y.useState)((null==s?void 0:s.value)||""),[p,g]=(0,Y.useState)("clone"===(null==s?void 0:s.type)?s.value:"");(0,Y.useEffect)(()=>{(async()=>{try{const e=await iu.getGeneralSecrets(l);o(e||[])}catch(e){o([])}finally{d(!1)}})()},[l]),(0,Y.useEffect)(()=>{"value"===u?a(l,{type:"value",value:x}):"clone"===u&&p&&a(l,{type:"clone",value:p})},[u,x,p,l,a]);return(0,se.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200 last:border-0 last:mb-0 last:pb-0",children:[(0,se.jsx)("div",{className:"flex items-center mb-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Qx.A,{className:"h-4 w-4 text-gray-500"}),(0,se.jsx)(On,{className:"text-sm font-medium",children:l})]})}),(0,se.jsxs)(lr,{value:u,onValueChange:m,className:"flex gap-8 mb-4",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(rr,{value:"value",id:"value-".concat(l),className:"h-4 w-4"}),(0,se.jsx)(On,{htmlFor:"value-".concat(l),className:"text-xs cursor-pointer",children:"New value"})]}),$p(null==n?void 0:n.platform_role)&&(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(rr,{value:"clone",id:"clone-".concat(l),className:"h-4 w-4"}),(0,se.jsx)(On,{htmlFor:"clone-".concat(l),className:"text-xs cursor-pointer",children:"Reuse existing"})]})]}),"value"===u?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(nl,{type:"password",placeholder:"Enter ".concat(l),value:x,onChange:e=>{h(e.target.value)},className:"h-9 text-sm mt-3 transition-all focus:ring-2 focus:ring-offset-1 focus:ring-blue-500"}),r&&(0,se.jsx)("p",{className:"text-xs text-gray-500 mt-2 ml-1",children:r})]}):(0,se.jsxs)(se.Fragment,{children:[c?(0,se.jsxs)("div",{className:"flex items-center h-9 text-xs text-gray-500 mt-3 bg-gray-50 rounded-md px-3",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}),"Loading existing secrets..."]}):i.length>0?(0,se.jsxs)(br,{value:p,onValueChange:e=>{g(e)},children:[(0,se.jsx)(Nr,{className:"h-9 text-sm mt-3",children:(0,se.jsx)(yr,{placeholder:"Select an existing secret"})}),(0,se.jsx)(kr,{className:"max-h-[200px] overflow-y-auto",children:i.map(e=>(0,se.jsxs)(Ar,{value:e.id,className:"text-xs py-3",children:[e.app_name||"Unnamed App"," (",e.secret_name,")"]},e.id))})]}):(0,se.jsxs)("div",{className:"flex items-center h-9 text-xs text-gray-500 mt-3 bg-gray-50 rounded-md px-3",children:["No existing secrets found for ",l]}),r&&(0,se.jsx)("p",{className:"text-xs text-gray-500 mt-2 ml-1",children:r})]})]})}function Qp(e){let{secretNames:t,value:s={},onChange:a}=e;const n=(e,t)=>{a((0,ue.A)((0,ue.A)({},s),{},{[e]:t}))};return(0,se.jsx)("div",{className:"text-sm px-5 py-7",children:t.map((e,t)=>(0,se.jsx)("div",{className:"mb-6 last:mb-0",children:(0,se.jsx)(Jp,{secret:e,value:s[e.name],onChange:n})},t))})}const Xp=e=>{let{integration:t,secrets:s,onSecretsChange:a,onRemove:n}=e;const{item:l}=t,r=l.required_secrets&&l.required_secrets.length>0,i=!(!r||l.required_secrets.every(e=>{const t=s[e.name];return!!t&&!!("value"!==t.type||t.value&&""!==t.value.trim())&&!!("clone"!==t.type||t.value&&""!==t.value.trim())}));return(0,se.jsx)(Es,{className:"mt-4 border-slate-200 overflow-hidden ".concat(i?"border-red-200":""),children:(0,se.jsxs)(Ls,{className:"p-0",children:[(0,se.jsx)("div",{className:"flex flex-col sm:flex-row",children:(0,se.jsxs)("div",{className:"flex-1 p-4",children:[(0,se.jsxs)("div",{className:"flex justify-between items-start",children:[(0,se.jsxs)("div",{className:"flex gap-3 items-center mb-2",children:[(0,se.jsx)("div",{className:"h-10 w-10 rounded-md border border-slate-200 flex-shrink-0 overflow-hidden bg-slate-50",children:l.image_url?(0,se.jsx)("img",{src:l.image_url,alt:l.name,className:"h-full w-full object-contain",onError:e=>{e.target.src="",e.target.parentElement.classList.add("bg-gradient-to-br","from-blue-100","to-teal-100"),e.target.parentElement.innerHTML='<span class="text-teal-600 text-lg font-semibold flex h-full w-full items-center justify-center">'.concat(l.name.charAt(0).toUpperCase(),"</span>")}}):(0,se.jsx)("div",{className:"h-full w-full bg-gradient-to-br from-blue-100 to-teal-100 flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-teal-600 text-lg font-semibold",children:l.name.charAt(0).toUpperCase()})})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:l.name}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[l.official&&(0,se.jsx)(gs,{className:"bg-blue-50 text-blue-700 border-blue-100 hover:bg-blue-100 text-xs",children:"Official"}),l.requires_backend_functions&&(0,se.jsx)("span",{className:"text-xs text-slate-500",children:"Requires backend functions"})]})]})]}),(0,se.jsx)("button",{className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 p-1.5 rounded-md transition-colors",onClick:()=>n(t.item.id),title:"Remove integration","aria-label":"Remove integration",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})})]}),l.description&&(0,se.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:l.description})]})}),r&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Tr,{className:"my-1"}),(0,se.jsxs)("div",{className:"p-4 pt-3 bg-slate-50",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("h4",{className:"text-xs uppercase tracking-wide text-slate-500 font-medium mb-3",children:"Required API Keys"}),i&&(0,se.jsxs)("div",{className:"flex items-center text-red-500 text-xs mb-3",children:[(0,se.jsx)(ad.A,{className:"h-3 w-3 mr-1"}),(0,se.jsx)("span",{children:"Missing required keys"})]})]}),(0,se.jsx)(Qp,{secretNames:l.required_secrets,value:s,onChange:a})]})]})]})})},eg={CRM:[{title:"Real Estate Agents",description:"Design a CRM for real estate agents - should manage property listings and client interactions. Include features like property images and descriptions, automatic reminders for contract renewals and viewings, integration with property portals, commission tracking, and geolocation mapping for properties."},{title:"Lawyers/Legal Practices",description:"Develop a CRM for law firms - should help manage cases, track billable hours, and store legal documents. Include features for case management, time tracking, legal workflows, team task delegation, client profiles with case history, and court date reminders."},{title:"Photographers",description:"Build a CRM for photographers - should handle client galleries and bookings. Include features for gallery management, photoshoot booking with reminders, file delivery systems, pricing packages, and client referral tracking for expanding the business."},{title:"Healthcare Practices",description:"Create a CRM for healthcare providers - should support clinics with patient management and compliance. Include features for medical history tracking, HIPAA-compliant communications, prescription tracking, billing integration with insurance claims, and patient satisfaction surveys."},{title:"Influencers/Content Creators",description:"Design a CRM for influencers - should help manage partnerships and content. Include features for campaign management, brand partnership tracking, content scheduling, revenue tracking from posts and merchandise, and audience segmentation by platform."},{title:"Wedding Planners",description:"Develop a CRM for wedding planners - should help manage tasks, budgets, and events. Include features for task management, client profiles segmented by couples and vendors, budget tracking, event timelines, and visual planning tools like seating arrangements."},{title:"Fitness Trainers/Gyms",description:"Build a CRM for fitness professionals - should track client progress and manage schedules. Include features for client progress tracking, integration with wearable devices, personalized workout plans, session reminders, and social tracking for referrals."},{title:"Construction Contractors",description:"Design a CRM for contractors - should manage projects, timelines, and resources. Include features for project milestones, resource tracking for materials and subcontractors, budget management, document storage for plans and permits, and client updates on project progress."}],"Dev productivity":[{title:"Online JSON Viewer",description:"Create an online JSON viewer - should allow users to view and format JSON data. Include features for syntax highlighting, collapsible tree structure, JSON validation, and the ability to upload or paste raw JSON for easy analysis."},{title:"Markdown to HTML Converter",description:"Develop a Markdown to HTML converter - should quickly convert Markdown text into HTML. Include features for live preview, support for common Markdown syntax (headings, links, code blocks), and export options to download the resulting HTML."},{title:"Regex Tester",description:"Build a regex tester tool - should help users test and refine regular expressions. Include features for real-time regex evaluation, examples, syntax highlighting, error notifications, and a library of commonly used regex patterns."},{title:"Code Diff Checker",description:"Create a code diff checker - should compare two code snippets side by side to highlight differences. Include features for line-by-line comparison, syntax highlighting for multiple programming languages, and exportable diff reports."},{title:"REST API Tester",description:"Design a REST API tester - should allow testing of API endpoints with customizable HTTP requests. Include features to set headers, body, and query parameters, store test cases, and view response details like headers and status codes."},{title:"Cron Expression Generator",description:"Develop a cron expression generator - should help create cron job expressions for scheduling tasks. Include an intuitive UI to select time intervals, a preview of the generated cron expression, and descriptions of each component of the expression."},{title:"Base64 Encoder/Decoder",description:"Build a Base64 encoder/decoder - should encode or decode text into Base64 format. Include support for large text blocks, file encoding/decoding, and one-click conversion between Base64 and plain text."},{title:"UUID Generator",description:"Create a UUID generator - should generate Universally Unique Identifiers (UUIDs) for use in applications. Include options for different UUID versions, batch generation, and the ability to copy or export UUIDs in bulk."},{title:"Color Palette Generator",description:"Design a color palette generator - should create and visualize color palettes for web design. Include hex and RGB code conversion, color harmonies (complementary, triadic), and the ability to save and export color schemes."}],Educational:[{title:"Interactive Flashcard Creator",description:"Develop an interactive flashcard creator - should allow users to create and study digital flashcards with spaced repetition algorithms for efficient learning."},{title:"Quiz Generator",description:"Build a quiz generator - should create quizzes from custom content or pre-existing question banks for various subjects."},{title:"Language Learning Games",description:"Design language learning games - should be fun and interactive, aimed at improving vocabulary, grammar, and pronunciation in foreign languages."},{title:"Math Problem Solver",description:"Create a math problem solver - should provide step-by-step solutions with explanations for various difficulty levels of math problems."},{title:"Historical Timeline Maker",description:"Develop a historical timeline maker - should allow users to create visual timelines of historical events with customizable layouts and multimedia integration."}],"Content Generation and Editing":[{title:"AI-Powered Writing Assistant",description:"Build an AI-powered writing assistant - should help improve writing with suggestions for grammar, style, and clarity using AI algorithms."},{title:"Social Media Post Generator",description:"Create a social media post generator - should produce engaging posts with customizable templates and trending hashtags."},{title:"Meme Creator",description:"Design an easy-to-use meme creator - should include a library of popular templates and a custom image upload option."},{title:"Infographic Maker",description:"Develop an infographic maker - should be a design tool for creating visually appealing infographics with pre-made templates and icons."},{title:"Resume Builder",description:"Build a resume builder - should craft professional resumes with industry-specific templates and content suggestions."}],"Personal Finance":[{title:"Budget Planner",description:"Create a budget planner - should help users create and manage personal or household budgets with customizable categories."},{title:"Expense Tracker",description:"Develop an expense tracker - should log and categorize expenses, providing insights and reports on spending habits."},{title:"Investment Calculator",description:"Build an investment calculator - should calculate potential returns on investments based on various parameters and market scenarios."},{title:"Debt Repayment Planner",description:"Design a debt repayment planner - should create strategies for efficient debt repayment, including snowball and avalanche methods."},{title:"Currency Converter",description:"Create a currency converter - should provide real-time currency conversion with historical rate charts and rate alerts."}],"Health and Wellness":[{title:"Meal Planner and Recipe Finder",description:"Develop a meal planner and recipe finder - should plan balanced meals and suggest recipes based on dietary preferences and restrictions."},{title:"Workout Routine Generator",description:"Build a workout routine generator - should create personalized workout plans based on fitness goals, equipment availability, and time constraints."},{title:"Meditation Timer and Guide",description:"Create a meditation timer and guide - should offer guided meditations and customizable meditation timers with ambient sounds."},{title:"Sleep Cycle Analyzer",description:"Design a sleep cycle analyzer - should track sleep patterns and provide insights for improving sleep quality."},{title:"Water Intake Tracker",description:"Develop a water intake tracker - should monitor daily water consumption and send reminders to stay hydrated."}],Productivity:[{title:"Pomodoro Timer",description:"Create a Pomodoro timer - should implement the Pomodoro Technique with customizable work and break intervals."},{title:"To-Do List Organizer",description:"Build a to-do list organizer - should manage tasks with priority levels, due dates, and collaboration features."},{title:"Mind Mapping Tool",description:"Design a mind mapping tool - should create visual mind maps for brainstorming and organizing ideas."},{title:"Goal Tracker",description:"Develop a goal tracker - should help set and track personal or professional goals with progress visualization."},{title:"Habit Formation Assistant",description:"Create a habit formation assistant - should help users build and maintain positive habits through reminders and streak tracking."}],"Travel Planning":[{title:"Itinerary Builder",description:"Build an itinerary builder - should create detailed travel itineraries with attractions, reservations, and transportation details."},{title:"Packing List Generator",description:"Develop a packing list generator - should generate customized packing lists based on destination, duration, and activities."},{title:"Flight Delay Predictor",description:"Create a flight delay predictor - should estimate the likelihood of flight delays based on historical data and current conditions."},{title:"Local Currency Converter",description:"Design a local currency converter - should convert currencies with offline support for travelers without constant internet access."},{title:"Travel Phrase Translator",description:"Build a travel phrase translator - should translate common travel phrases with audio pronunciation guides."}],Entertainment:[{title:"Movie Recommendation Engine",description:"Create a movie recommendation engine - should suggest movies based on user preferences, ratings, and viewing history."},{title:"Book Discovery Tool",description:"Develop a book discovery tool - should recommend books across genres based on reading preferences and past favorites."},{title:"Podcast Finder",description:"Build a podcast finder - should discover new podcasts based on topics of interest and listening habits."},{title:"TV Show Episode Tracker",description:"Design a TV show episode tracker - should keep track of watched episodes and provide notifications for new releases."},{title:"Random Activity Generator",description:"Create a random activity generator - should suggest random activities or hobbies to try when bored or looking for inspiration."}],Environmental:[{title:"Carbon Footprint Calculator",description:"Develop a carbon footprint calculator - should estimate personal or household carbon footprint and suggest reduction strategies."},{title:"Recycling Guide",description:"Build a recycling guide - should provide location-specific information on how to properly recycle various items."},{title:"Sustainable Product Finder",description:"Create a sustainable product finder - should help users find eco-friendly alternatives to common products."},{title:"Energy Usage Monitor",description:"Design an energy usage monitor - should track and analyze home energy consumption, offering tips for reduction."},{title:"Local Eco-Event Finder",description:"Develop a local eco-event finder - should locate and promote environmental events and volunteer opportunities in the user's area."}],"Home Management":[{title:"Home Inventory Tracker",description:"Create a home inventory tracker - should catalog household items for insurance purposes or organization."},{title:"Chore Scheduler",description:"Build a chore scheduler - should assign and rotate household chores among family members or roommates."},{title:"Plant Care Reminder",description:"Design a plant care reminder - should send reminders for watering and caring for house plants based on species and season."},{title:"DIY Project Planner",description:"Develop a DIY project planner - should help plan and track home improvement projects with material lists and tutorials."},{title:"Smart Home Device Dashboard",description:"Create a smart home device dashboard - should centralize control and monitoring of various smart home devices."}],"Creative Tools":[{title:"Color Scheme Generator",description:"Build a color scheme generator - should create harmonious color palettes for design projects with export options."},{title:"Font Pairing Assistant",description:"Design a font pairing assistant - should suggest complementary font combinations for typography projects."},{title:"Logo Maker",description:"Create a logo maker - should design simple logos using pre-made elements and customization options."},{title:"Music Chord Progression Generator",description:"Develop a music chord progression generator - should create chord progressions for songwriting inspiration across various genres."},{title:"Digital Art Sketchpad",description:"Build a digital art sketchpad - should provide a simple drawing interface with basic tools for digital sketching and doodling."}]};class tg extends te.H{getBaseURL(){return"/"}getAppSuggestions(){return this.axios.get("/prompt-suggestions")}}const sg=new tg,ag=e=>e.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""),ng=Object.keys(eg),lg=()=>[...ng].sort(()=>.5-Math.random()).slice(0,5);function rg(e){let{onSetPrompt:t,onCategoryChange:s,controlledCategory:a}=e;const[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)([]),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(!0),m=void 0!==a?a:n;(0,Y.useEffect)(()=>{i(lg())},[]),(0,Y.useEffect)(()=>{(async()=>{try{u(!0);const e=await sg.getAppSuggestions();c(e.data)}catch(e){c(null)}finally{u(!1)}})()},[]);const x=(0,Y.useCallback)(e=>{Tu("creation_frame_selected",{category:e}),void 0===a&&l(e),null==s||s(e)},[a,s]),h=(0,Y.useCallback)((e,s)=>{m&&s&&Tu("creation_inspiration_used",{category:m,inspiration_id:ag(s)}),t(e)},[t,m]),p=(0,Y.useCallback)(()=>{void 0===a&&l(null),null==s||s(null)},[a,s]),g=(0,Y.useCallback)(()=>{i(lg())},[]);return{loading:d,selectedCategory:m,displayedCategories:r,suggestions:o,suggestionItems:o?[{title:o.suggestion_1.title,prompt:o.suggestion_1.prompt},{title:o.suggestion_2.title,prompt:o.suggestion_2.prompt},{title:o.suggestion_3.title,prompt:o.suggestion_3.prompt},{title:o.suggestion_4.title,prompt:o.suggestion_4.prompt},{title:o.suggestion_5.title,prompt:o.suggestion_5.prompt}]:[],starters:eg,handleCategoryClick:x,handleSubPromptClick:h,handleBackToCategories:p,refreshCategories:g}}function ig(){return(0,se.jsx)("span",{className:"text-[#404040] text-[14px] font-base44 font-normal",children:"Ideas to get started:"})}function og(e){let{onClick:t,disabled:s}=e;return(0,se.jsxs)("button",{onClick:t,disabled:s,className:"flex items-center gap-1.5 ".concat(s?"opacity-50":"hover:opacity-70 transition-opacity"),children:[(0,se.jsx)(Fx.A,{size:16,className:"text-[#171717]"}),(0,se.jsx)("span",{className:"text-[14px] font-medium text-[#0a0a0a] font-base44",children:"More ideas"})]})}function cg(e){let{onClick:t,categoryName:s}=e;return(0,se.jsxs)("button",{onClick:t,className:"text-[#404040] text-sm font-normal font-base44 flex items-center hover:text-slate-900 transition-colors",children:[(0,se.jsx)(vs.A,{className:"h-4 w-4 mr-1"}),s]})}function dg(e){let{count:t=5}=e;return(0,se.jsx)(se.Fragment,{children:[...Array(t)].map((e,t)=>(0,se.jsx)("div",{className:"rounded-[100px] h-8 bg-white/40 animate-pulse",style:{width:"".concat(80+60*Math.random(),"px")}},t))})}const ug=["className"],mg=["className"],xg=["className"],hg=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ug);return(0,se.jsx)(ht.Root,(0,ue.A)({ref:t,className:de("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s)},a))});hg.displayName=ht.Root.displayName;const pg=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,mg);return(0,se.jsx)(ht.Image,(0,ue.A)({ref:t,className:de("aspect-square h-full w-full",s)},a))});pg.displayName=ht.Image.displayName;const gg=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,xg);return(0,se.jsx)(ht.Fallback,(0,ue.A)({ref:t,className:de("flex h-full w-full items-center justify-center rounded-full bg-muted",s)},a))});function fg(e){if(!e)return"?";const t=e.trim().split(" ").filter(Boolean);return 0===t.length?"?":1===t.length?t[0].charAt(0).toUpperCase():(t[0].charAt(0)+t[1].charAt(0)).toUpperCase()}function vg(e){if(!e)return"Updated recently";const t=He().utc(e,He().ISO_8601);return t.isValid()?"Updated ".concat(t.fromNow()):"Updated recently"}function bg(e){var t,s,a,n;let{app:l,className:r}=e;const i="/apps/".concat(l.id,"/editor/preview");return(0,se.jsxs)(Z.Link,{to:i,className:["box-border flex h-[66px] w-[196px] flex-none items-center gap-3 rounded-[12px] border border-slate-200 bg-white py-2 pl-2 pr-3",null!=r?r:""].join(" "),title:"Open ".concat(null!==(t=l.name)&&void 0!==t?t:"app"),children:[(0,se.jsxs)(hg,{className:"h-[50px] w-[50px] rounded-[12px] border border-slate-100",children:[(0,se.jsx)(pg,{src:null!==(s=l.logo_url)&&void 0!==s?s:void 0,alt:"".concat(null!==(a=l.name)&&void 0!==a?a:"App"," Logo")}),(0,se.jsx)(gg,{className:"rounded-[12px] bg-gradient-to-br from-orange-100 to-orange-50 font-base44 text-orange-500",children:fg(l.name)})]}),(0,se.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start gap-1 p-0",children:[(0,se.jsx)("div",{className:"w-full truncate font-base44 text-[14px] font-semibold leading-[20px] tracking-[-0.03em] text-[#0A0A0A]",children:null!==(n=l.name)&&void 0!==n?n:"Untitled app"}),(0,se.jsx)("div",{className:"w-full truncate font-base44 text-[12px] font-normal leading-[12px] tracking-[-0.03em] text-slate-500",children:vg(l.updated_date)})]})]})}gg.displayName=ht.Fallback.displayName;var jg=s(38554);function yg(e){const t={isSupabaseUrl:!1,originalUrl:e};try{const s=new URL(e);if(!s.hostname.includes("supabase.co"))return t;const a=s.hostname.match(/^([^.]+)\.supabase\.co$/);if(!a)return t;t.projectId=a[1],t.isSupabaseUrl=!0;const n=s.pathname.match(/^\/storage\/v1\/(object|render\/image)\/public\/([^/]+)\/(.+)$/);n&&(t.bucket=n[2],t.filePath=n[3],t.baseUrl="".concat(s.origin,"/storage/v1/render/image/public/").concat(t.bucket,"/").concat(t.filePath)),t.existingParams=new URLSearchParams(s.search)}catch(s){0}return t}function Ng(e){const t=yg(e);return t.isSupabaseUrl&&!!t.bucket&&!!t.filePath}function wg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=yg(e);if(!s.isSupabaseUrl||!s.baseUrl)return e;const a=new URLSearchParams;if(void 0!==t.width){const e=Math.min(Math.max(Math.round(t.width),1),2500);a.set("width",e.toString())}if(void 0!==t.height){const e=Math.min(Math.max(Math.round(t.height),1),2500);a.set("height",e.toString())}if(void 0!==t.quality){const e=Math.min(Math.max(Math.round(t.quality),20),100);a.set("quality",e.toString())}t.resize&&"cover"!==t.resize&&a.set("resize",t.resize),"origin"===t.format&&a.set("format","origin");const n=a.toString();return n?"".concat(s.baseUrl,"?").concat(n):s.baseUrl}function _g(e,t){const{baseWidth:s,baseHeight:a,devicePixelRatios:n=[1,2,3],quality:l=80,resize:r="cover",sizes:i}=t;if(!Ng(e))return{srcset:e,src:e,sizes:i};const o=[];for(const d of n){const t={width:Math.round(s*d),quality:l,resize:r};a&&(t.height=Math.round(a*d));const n=wg(e,t);o.push("".concat(n," ").concat(d,"x"))}const c=wg(e,{width:s,height:a,quality:l,resize:r});return{srcset:o.join(", "),src:c,sizes:i}}function kg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return Ng(e)?wg(e,{width:t,quality:s,resize:"contain"}):e}const Cg=e=>{let{src:t,alt:s,className:a="",quality:n=80,objectFit:l="cover",lazy:r=!0,placeholderQuality:i=20,placeholderWidth:o=20,onLoad:c,onError:d,width:u,height:m,resize:x,devicePixelRatios:h=[1,2,3],sizes:p,disableProgressiveLoading:g=!1,transitionDuration:f=300,disableTransition:v=!0,resizeDebounceMs:b=150,style:j}=e;const[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)(!r),[A,S]=(0,Y.useState)(null),E=(0,Y.useRef)(null),T=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{if(!r||!E.current)return;const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&C(!0)})},{rootMargin:"50px",threshold:.01});return e.observe(E.current),()=>{e.disconnect()}},[r]);const I=(0,Y.useMemo)(()=>(0,cc.debounce)((e,t)=>{e>0&&S({width:e,height:t})},b),[b]);(0,Y.useEffect)(()=>{if(!E.current)return;if(u&&m)return void S({width:u,height:m});const e=new ResizeObserver(e=>{for(const t of e){const{width:e,height:s}=t.contentRect;I(e,s)}});return e.observe(E.current),()=>{I.cancel(),e.disconnect()}},[u,m,I]);const P=Ng(t),L=g?t:P?kg(t,o,i):t,M=(()=>{if(!P||!A)return{src:t,srcset:void 0,sizes:void 0};return _g(t,{baseWidth:u||A.width,baseHeight:m||A.height,devicePixelRatios:h,quality:n,resize:x||("contain"===l?"contain":"fill"===l?"fill":"cover"),sizes:p})})();return(0,se.jsxs)("div",{ref:E,className:"relative overflow-hidden ".concat(a),style:j,children:[!g&&k&&(0,se.jsx)("img",{src:L,alt:"",className:"absolute inset-0 w-full h-full",style:(0,ue.A)({objectFit:l,filter:"blur(10px)",transform:"scale(1.1)",opacity:y?0:1},v?{}:{transition:"opacity ".concat(f,"ms ease-in-out")}),"aria-hidden":"true"}),k&&(0,se.jsx)("img",{ref:T,src:M.src,srcSet:M.srcset,sizes:M.sizes,alt:s,className:"relative w-full h-full",style:(0,ue.A)({objectFit:l,opacity:y?1:0},v?{}:{transition:"opacity ".concat(f,"ms ease-in-out")}),onLoad:()=>{N(!0),null==c||c()},onError:e=>{_(!0);const s=new Error("Failed to load image: ".concat(t));null==d||d(s)},loading:r?"lazy":"eager"}),w&&(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-100",children:(0,se.jsxs)("div",{className:"text-center text-slate-500 text-sm",children:[(0,se.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,se.jsx)("span",{children:"Image not available"})]})})]})};function Ag(e){var t,s;let{catalogItem:a,onClick:n,className:l}=e;const r=a.item,i=null===(t=r.screenshot_urls)||void 0===t?void 0:t[0],[o,c]=(0,Y.useState)(!1),d=a.item_creator,u=null!==(s=a.usage)&&void 0!==s?s:0,m=r.is_paid&&r.price_usd?"$".concat(r.price_usd):"Free";return(0,se.jsxs)("div",{className:["flex flex-col items-start w-[240px] flex-none cursor-pointer",null!=l?l:""].join(" "),onClick:()=>n(a),children:[(0,se.jsx)("div",{className:"w-full aspect-video relative rounded-[8px] overflow-hidden border border-slate-200 bg-slate-100",children:i&&!o?(0,se.jsx)(Cg,{src:i,alt:r.name,className:"absolute inset-0 size-full object-cover",objectFit:"cover",quality:80,lazy:!0,onError:()=>c(!0)}):(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-50",children:(0,se.jsx)(jg.A,{className:"w-8 h-8 text-slate-300"})})}),(0,se.jsxs)("div",{className:"flex flex-col items-start w-full pt-2.5 px-2.5 pb-2.5 gap-1",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between w-full gap-2",children:[(0,se.jsx)("p",{className:"font-base44 font-semibold text-[14px] leading-[20px] tracking-[-0.03em] text-[#0A0A0A] truncate flex-1",children:r.name}),(0,se.jsx)("p",{className:"font-base44 font-semibold text-[14px] leading-[20px] tracking-[-0.03em] flex-none ".concat("Free"===m?"text-slate-500":"text-[#0A0A0A]"),children:m})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5 w-full",children:[(0,se.jsx)("p",{className:"font-base44 font-normal text-[12px] leading-[16px] text-slate-500 truncate",children:(null==d?void 0:d.full_name)||"Unknown"}),(0,se.jsx)("span",{className:"text-slate-400",children:"\u2022"}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 6V5C5 4.44772 5.44772 4 6 4H14C14.5523 4 15 4.44772 15 5V12C15 12.5523 14.5523 13 14 13H13V14C13 14.5523 12.5523 15 12 15H4C3.44772 15 3 14.5523 3 14V7C3 6.44772 3.44772 6 4 6H5ZM12 10H4V14H12V10ZM12 9V7H4V9H12ZM6 6H12C12.5523 6 13 6.44772 13 7V12H14V5H6V6Z",fill:"#94a3b8"})}),(0,se.jsx)("p",{className:"font-base44 font-normal text-[12px] leading-[16px] text-slate-500",children:u})]})]})]})]})}const Sg="#000000CC";function Eg(){let{onAnimationStart:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{navigation:t}=fd();(0,Y.useEffect)(()=>(t.notifyWebOverlayVisibilityChanged({isVisible:!0,color:Sg}),()=>{t.notifyWebOverlayVisibilityChanged({isVisible:!1,color:Sg})}),[t]);return(0,Y.useCallback)(s=>{"closed"===s.currentTarget.getAttribute("data-state")&&t.notifyWebOverlayVisibilityChanged({isVisible:!1,color:Sg}),null==e||e(s)},[t,e])}const Tg=["className","onAnimationStart"],Ig=Y.forwardRef((e,t)=>{let{className:s,onAnimationStart:a}=e,n=(0,Nt.A)(e,Tg);const l=Eg({onAnimationStart:a});return(0,se.jsx)(gt.Overlay,(0,ue.A)((0,ue.A)({className:s,onAnimationStart:l},n),{},{ref:t}))});Ig.displayName=gt.Overlay.displayName;const Pg=["className"],Lg=["className","children","quickActions","showClose","Close"],Mg=["className"],Rg=["className"],Dg=["className"],Fg=["className"],Og=gt.Root,Ug=gt.Trigger,Bg=gt.Portal,zg=(gt.Close,Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Pg);return(0,se.jsx)(Ig,(0,ue.A)({ref:t,className:de("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},a))}));zg.displayName=gt.Overlay.displayName;const Hg=Y.forwardRef((e,t)=>{let{className:s,children:a,quickActions:n,showClose:l=!0,Close:r}=e,i=(0,Nt.A)(e,Lg);return(0,se.jsxs)(Bg,{children:[(0,se.jsx)(zg,{}),(0,se.jsxs)(gt.Content,(0,ue.A)((0,ue.A)({ref:t,className:de("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},i),{},{children:[a,(0,se.jsx)("div",{className:"absolute right-4 top-4 ",children:(0,se.jsxs)("div",{className:"flex flex-row gap-2",children:[n,l&&(null!=r?r:(0,se.jsxs)(gt.Close,{className:"rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2  disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,se.jsx)(la.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Close"})]}))]})})]}))]})});Hg.displayName=gt.Content.displayName;const Vg=e=>{let{className:t}=e,s=(0,Nt.A)(e,Mg);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col space-y-1.5 text-center sm:text-left",t)},s))};Vg.displayName="DialogHeader";const Wg=e=>{let{className:t}=e,s=(0,Nt.A)(e,Rg);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};Wg.displayName="DialogFooter";const qg=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Dg);return(0,se.jsx)(gt.Title,(0,ue.A)({ref:t,className:de("text-lg font-semibold leading-none tracking-tight",s)},a))});qg.displayName=gt.Title.displayName;const Yg=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Fg);return(0,se.jsx)(gt.Description,(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});Yg.displayName=gt.Description.displayName;const Gg=new class extends qp{getBaseURL(){return"/app-catalog-items"}async getListingIfExists(e){const t=await this.filter({app_id:e});return t.length>0?t[0]:null}async submitUpdate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=t?{metadata:t}:{};return this.axios.post("/catalog/".concat(e,"/submit-update"),s)}async getPendingChanges(e){return this.axios.get("/catalog/".concat(e,"/pending-changes"))}async cloneFromSnapshot(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.axios.post("/catalog/".concat(e,"/clone-snapshot"),{use_pending:t})}};function Kg(){return{itemViewed:e=>{try{Tu("Marketplace - Item Viewed",e)}catch(t){}},itemPreviewed:e=>{try{Tu("Marketplace - Item Previewed",e)}catch(t){}},purchaseInitiated:e=>{try{Tu("Marketplace - Purchase Initiated",e)}catch(t){}},purchaseFailed:e=>{try{Tu("Marketplace - Purchase Failed",e)}catch(t){}},purchaseCompleted:e=>{try{Tu("Marketplace - Purchase Completed",e)}catch(t){}},templateCloned:e=>{try{Tu("Marketplace - Template Cloned",e)}catch(t){}},listingSaved:e=>{try{Tu("Marketplace - Listing Saved",e)}catch(t){}}}}function $g(e){var t;let{itemId:s,initialItem:a=null,enabled:n=!0,viewSource:l="browse"}=e;const{user:r}=wd(),i=Kg(),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(null),g=null!=o?o:a,f=async()=>{var e;const t=s||(null==a||null===(e=a.item)||void 0===e?void 0:e.id);if(t&&n){x(!0),p(null);try{const e=await Gg.getCatalogItem(t);if(c(e),$p(null==r?void 0:r.platform_role))try{const e=await Gg.getPendingChanges(t);u(e)}catch(v){}var o,d,m,h,g,f;if(r)i.itemViewed({item_id:t,item_name:(null===(o=e.item)||void 0===o?void 0:o.name)||(null==a||null===(d=a.item)||void 0===d?void 0:d.name)||"",is_paid:(null===(m=e.item)||void 0===m?void 0:m.is_paid)||!1,price_usd:(null===(h=e.item)||void 0===h?void 0:h.price_usd)||null,item_category:(null===(g=e.item)||void 0===g?void 0:g.categories)||[],seller_id:(null===(f=e.item)||void 0===f?void 0:f.seller_id)||"",view_source:l,is_own_listing:e.is_user_the_owner||!1,already_purchased:e.already_purchased||!1})}catch(b){p(b instanceof Error?b:new Error("Failed to fetch item details")),a&&c(a)}finally{x(!1)}}};(0,Y.useEffect)(()=>{var e;n&&(s||null!=a&&null!==(e=a.item)&&void 0!==e&&e.id)?(c(null),u(null),f()):(c(null),u(null))},[n,s,null==a||null===(t=a.item)||void 0===t?void 0:t.id]);return{item:g,pendingChanges:d,isLoading:m,error:h,refetch:f,clearPendingChanges:()=>{u(null)}}}var Zg=s(89284),Jg=s(37524),Qg=s(7082);const Xg=e=>e&&"string"==typeof e?Qg.default.sanitize(e,{ALLOWED_TAGS:["p","br","strong","b","em","i","u","s","ol","ul","li","blockquote","h1","h2","h3","a","code","pre"],ALLOWED_ATTR:["href","target","rel"],ALLOWED_URI_REGEXP:/^(?:(?:https?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.-:]|$))/i,ALLOW_DATA_ATTR:!1,FORBID_SCRIPT:!0,FORBID_TAGS:["script","object","embed","iframe","form","input","button","svg","math","link","meta","style"],FORBID_ATTR:["onerror","onload","onclick","onmouseover","onfocus","onblur","onkeyup","onkeydown","onchange","onsubmit","onreset","onselect","onabort","style","cite"],KEEP_CONTENT:!0,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_DOM_IMPORT:!1,SANITIZE_DOM:!0,HOOKS:{beforeSanitizeElements:e=>e}}):"";const ef=function(e){let{content:t}=e;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n        .expandable-description h1 { font-size: 1.25rem; font-weight: 600; margin-bottom: 0.75rem; color: #0f172a; }\n        .expandable-description h2 { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: #0f172a; }\n        .expandable-description h3 { font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem; color: #0f172a; }\n        .expandable-description p { margin-bottom: 0.75rem; line-height: 1.6; color: #475569; }\n        .expandable-description ul, .expandable-description ol { margin-bottom: 0.75rem; padding-left: 1.5rem; color: #475569; }\n        .expandable-description li { margin-bottom: 0.25rem; }\n        .expandable-description strong { font-weight: 600; color: #334155; }\n        .expandable-description em { font-style: italic; }\n        .expandable-description blockquote { border-left: 3px solid #e2e8f0; padding-left: 1rem; margin: 0.75rem 0; color: #64748b; }\n        .expandable-description code { background: #f1f5f9; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.875rem; color: #0f172a; }\n        .expandable-description pre { background: #f1f5f9; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 0.75rem; }\n        .expandable-description a { color: #f97316; text-decoration: underline; }\n        .expandable-description a:hover { color: #ea580c; }\n        .expandable-description > *:last-child { margin-bottom: 0; }\n    "}}),(0,se.jsx)("div",{className:"relative",children:(0,se.jsx)("div",{className:"expandable-description text-sm",dangerouslySetInnerHTML:{__html:Xg(t)}})})]})};class tf extends te.H{getBaseURL(){return"/purchase"}async getMyPurchases(){return await this.axios.get("/my-purchases")}async getMySales(){return await this.axios.get("/my-sales")}async clonePurchasedApp(e){return await this.axios.post("/clone/".concat(e))}async purchaseItem(e){return await this.axios.post("/app_templates/".concat(e))}async getTransactionStatus(e){return await this.axios.get("/transaction/".concat(e))}}const sf=new tf;function af(e){let{requiredFeatures:t=[],isPaid:s=!1}=e;const{user:a}=wd();return t&&0!==t.length&&a?(0,se.jsxs)("div",{className:"w-full px-4 py-3 bg-gradient-to-r from-orange-300/30 to-amber-200/25 rounded-lg flex items-start gap-2",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-[#0a0a0a] flex-shrink-0"}),(0,se.jsx)("div",{className:"flex-1 flex flex-col gap-3",children:(0,se.jsx)("div",{className:"flex flex-col gap-1",children:(0,se.jsxs)("span",{className:"text-[#111827] text-sm font-normal leading-5",children:["Some features in this app require the Builder Plan or higher to work properly."," ",(0,se.jsx)("a",{href:"/billing",target:"_blank",rel:"noopener noreferrer",className:"text-[#111827] text-sm font-normal underline leading-5 hover:no-underline",children:"See Plans"})]})})})]}):null}const nf=["orientation","opts","setApi","plugins","className","children"],lf=["className"],rf=["className"],of=["className","variant","size"],cf=["className","variant","size"],df=zt,uf=Y.createContext(null);function mf(){const e=Y.useContext(uf);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const xf=Y.forwardRef((e,t)=>{let{orientation:s="horizontal",opts:a,setApi:n,plugins:l,className:r,children:i}=e,o=(0,Nt.A)(e,nf);const[c,d]=(0,Hs.A)((0,ue.A)((0,ue.A)({},a),{},{axis:"horizontal"===s?"x":"y"}),l),[u,m]=Y.useState(!1),[x,h]=Y.useState(!1),p=Y.useCallback(e=>{e&&(m(e.canScrollPrev()),h(e.canScrollNext()))},[]),g=Y.useCallback(()=>{null==d||d.scrollPrev()},[d]),f=Y.useCallback(()=>{null==d||d.scrollNext()},[d]),v=Y.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),g()):"ArrowRight"===e.key&&(e.preventDefault(),f())},[g,f]);return Y.useEffect(()=>{d&&n&&n(d)},[d,n]),Y.useEffect(()=>{if(d)return p(d),d.on("reInit",p),d.on("select",p),()=>{null==d||d.off("reInit",p),null==d||d.off("select",p)}},[d,p]),(0,se.jsx)(uf.Provider,{value:{carouselRef:c,api:d,opts:a,orientation:s||("y"===(null==a?void 0:a.axis)?"vertical":"horizontal"),scrollPrev:g,scrollNext:f,canScrollPrev:u,canScrollNext:x},children:(0,se.jsx)("div",(0,ue.A)((0,ue.A)({ref:t,onKeyDownCapture:v,className:de("relative",r),role:"region","aria-roledescription":"carousel"},o),{},{children:i}))})});xf.displayName="Carousel";const hf=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,lf);const{carouselRef:n,orientation:l}=mf();return(0,se.jsx)("div",{ref:n,className:"overflow-hidden h-full",children:(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("flex","horizontal"===l?"-ml-4":"-mt-4 flex-col",s)},a))})});hf.displayName="CarouselContent";const pf=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,rf);const{orientation:n}=mf();return(0,se.jsx)("div",(0,ue.A)({ref:t,role:"group","aria-roledescription":"slide",className:de("min-w-0 shrink-0 grow-0 basis-full","horizontal"===n?"pl-4":"pt-4",s)},a))});pf.displayName="CarouselItem";Y.forwardRef((e,t)=>{let{className:s,variant:a="outline",size:n="icon"}=e,l=(0,Nt.A)(e,of);const{orientation:r,scrollPrev:i,canScrollPrev:o}=mf();return(0,se.jsxs)(df,(0,ue.A)((0,ue.A)({ref:t,variant:a,size:n,className:de("absolute  h-8 w-8 rounded-full","horizontal"===r?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:i},l),{},{children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Previous slide"})]}))}).displayName="CarouselPrevious";function gf(e){var t,s,a,n,l,r,i,o,c;let{item:d,pendingChanges:u,onItemUpdate:m,onClose:x,showCloseButton:h=!0,showTermsFooter:p=!0,onPendingChangesCleared:g,className:f}=e;const{user:v}=wd(),[b,j]=(0,Y.useState)(0),[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)(null),A=Kg(),{isNativeMobile:S,linking:E}=fd(),T=qu()||S;(0,Y.useEffect)(()=>{j(0),k&&k.scrollTo(0)},[null==d||null===(t=d.item)||void 0===t?void 0:t.id,k]),(0,Y.useEffect)(()=>{if(k)return k.on("select",()=>{j(k.selectedScrollSnap())}),()=>{k.off("select",cc.noop)}},[k]);const I=()=>{if(!d)return;const e=d.already_purchased&&d.purchase_transaction_id?"?transaction_id=".concat(d.purchase_transaction_id):"";window.open("/remix-app/".concat(d.item.app_id).concat(e),"_blank")},P=async()=>{if(d){N(!0);try{const e=await Gg.approveItem(d.item.id);so({title:"Success",description:"App listing approved successfully"}),null==m||m((0,ue.A)((0,ue.A)({},d),{},{item:(0,ue.A)((0,ue.A)({},d.item),e)})),null==g||g()}catch(e){so({title:"Error",description:"Failed to approve listing",variant:"destructive"})}finally{N(!1)}}},L=async()=>{if(d){N(!0);try{const e=await Gg.declineItem(d.item.id);so({title:"Success",description:"App listing declined successfully"}),null==m||m((0,ue.A)((0,ue.A)({},d),{},{item:(0,ue.A)((0,ue.A)({},d.item),e)}))}catch(e){so({title:"Error",description:"Failed to decline listing",variant:"destructive"})}finally{N(!1)}}},M=(0,Y.useCallback)(()=>{null==k||k.scrollPrev(),j((null==k?void 0:k.selectedScrollSnap())||0)},[k]),R=(0,Y.useCallback)(()=>{null==k||k.scrollNext(),j((null==k?void 0:k.selectedScrollSnap())||0)},[k]);return d?(0,se.jsxs)("div",{className:de("h-full flex flex-col relative bg-white",f),children:[h&&x&&(0,se.jsx)("button",{onClick:x,className:"absolute top-4 right-4 md:top-6 md:right-6 z-50 w-[30px] h-[30px] rounded-full hover:bg-slate-100 flex items-center justify-center transition-colors","aria-label":"Close",children:(0,se.jsx)(la.A,{className:"w-5 h-5 text-slate-900"})}),(0,se.jsx)("div",{className:de("safe-area-inset flex-1 overflow-y-auto md:overflow-hidden h-full",T?"mx-[20px] mt-[56px]":" p-4 md:p-6",S&&"mt-[24px]"),children:(0,se.jsxs)("div",{className:"flex flex-col md:flex-row md:gap-8 md:h-full h-full",children:[(0,se.jsxs)("div",{className:de("flex flex-col items-center w-full md:w-[65%] shrink-0 md:mb-0 gap-3",!T&&"mb-6"),children:[(0,se.jsx)("div",{className:de("md:flex-1 md:h-full min-h-[250px] md:min-h-0 md:aspect-auto w-full h-full relative",!T&&"bg-slate-100 rounded-[16px] overflow-hidden"),children:d.item.screenshot_urls&&d.item.screenshot_urls.length>0?(0,se.jsxs)(xf,{setApi:C,opts:{loop:!0,align:"start",axis:"x"},className:"w-full h-full rounded-[16px] overflow-hidden [touch-action:pan-y]",children:[(0,se.jsx)(hf,{className:"ml-0 h-full",children:d.item.screenshot_urls.map((e,t)=>(0,se.jsx)(pf,{className:"pl-0",children:(0,se.jsxs)("div",{className:"w-full min-h-[250px] aspect-auto md:aspect-auto h-full relative bg-slate-100 overflow-hidden",children:[(0,se.jsx)("div",{className:"absolute inset-0 h-full",style:{backgroundImage:"url(".concat(e,")"),backgroundSize:"cover",backgroundPosition:"center",filter:"blur(20px)",opacity:.3}}),(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,se.jsx)("img",{src:e,alt:"Screenshot ".concat(t+1),className:T?"w-full h-full object-cover":"w-full h-full object-contain",draggable:!1})})]})},t))}),!T&&d.item.screenshot_urls.length>1&&(0,se.jsxs)("div",{className:"absolute inset-0 flex items-center justify-between px-[18px] pointer-events-none",children:[(0,se.jsx)("button",{onClick:M,className:"pointer-events-auto w-[42px] h-[42px] rounded-full bg-white/90 hover:bg-white flex items-center justify-center shadow-lg transition-all","aria-label":"Previous screenshot",children:(0,se.jsx)(vs.A,{className:"w-6 h-6 text-slate-700"})}),(0,se.jsx)("button",{onClick:R,className:"pointer-events-auto w-[42px] h-[42px] rounded-full bg-white/90 hover:bg-white flex items-center justify-center shadow-lg transition-all","aria-label":"Next screenshot",children:(0,se.jsx)(bs.A,{className:"w-6 h-6 text-slate-700"})})]})]}):(0,se.jsx)("div",{className:de("absolute inset-0 flex items-center justify-center bg-slate-50",T&&"rounded-[16px]"),children:(0,se.jsx)(jg.A,{className:"w-16 h-16 text-slate-300"})})}),d.item.screenshot_urls&&d.item.screenshot_urls.length>1&&(0,se.jsx)("div",{className:"flex gap-2",children:d.item.screenshot_urls.map((e,t)=>(0,se.jsx)("button",{onClick:()=>{null==k||k.scrollTo(t),j(t)},className:de("w-2.5 h-2.5 rounded-full transition-all",b===t?"bg-slate-900":"bg-slate-300 hover:bg-slate-400"),"aria-label":"Go to screenshot ".concat(t+1)},t))})]}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col w-full md:w-[35%] h-[60vh] md:h-full relative pr-0 md:pr-3",children:[(0,se.jsx)("div",{className:"flex-1 md:overflow-y-auto pt-6 md:pt-0",children:(0,se.jsx)("div",{className:"flex-1 flex flex-col justify-between",children:(0,se.jsxs)("div",{className:"",children:[(0,se.jsx)("h1",{className:"text-[22px] md:text-[26px] font-medium text-black leading-normal",children:d.item.name}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2 text-[14px] md:text-[16px] mt-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)(hg,{className:"h-6 w-6",children:[(0,se.jsx)(pg,{src:null===(s=d.item_creator)||void 0===s?void 0:s.profile_image_url}),(0,se.jsx)(gg,{className:"text-xs bg-slate-100",children:(null===(a=d.item_creator)||void 0===a||null===(n=a.full_name)||void 0===n?void 0:n[0])||"U"})]}),(0,se.jsxs)("span",{className:"text-[#3c444c] leading-[14px]",children:["by ",(null===(l=d.item_creator)||void 0===l?void 0:l.full_name)||"Unknown"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"hidden lg:inline-block text-[#3c444c] text-[14px] leading-[14px]",children:"\u2022"}),(0,se.jsxs)("span",{className:"text-[#3c444c] leading-[14px]",children:[d.usage||0," Usages"]})]}),d.item.is_private&&(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"hidden lg:inline-block text-[#3c444c] text-[14px] leading-[14px]",children:"\u2022"}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5 text-[#3c444c]",children:[(0,se.jsx)(Vc.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{className:"leading-[14px]",children:"Private"})]})]}),"workspace"===d.item.visibility_scope&&(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"hidden lg:inline-block text-[#3c444c] text-[14px] leading-[14px]",children:"\u2022"}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5 text-teal-600",children:[(0,se.jsx)(Zg.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{className:"leading-[14px]",children:"Workspace Template"})]})]})]}),(0,se.jsxs)("div",{className:"flex flex-col xl:flex-row gap-3 pt-[18px]",children:[d.already_purchased?(0,se.jsx)(Bx,{onClick:I,className:"flex-1 h-10 bg-[#09090b] hover:bg-[#18181b] text-white font-medium text-[14px] md:text-[16px] rounded-[12px] shadow-sm",children:"Clone Purchase"}):d.item.is_paid?(0,se.jsx)(Bx,{onClick:async()=>{var e;if(null!=d&&null!==(e=d.item)&&void 0!==e&&e.id){_(!0),v&&A.purchaseInitiated({item_id:d.item.id,item_name:d.item.name,price_usd:d.item.price_usd||0,seller_id:d.item.seller_id||"",user_tier:v.subscription_tier||"free",is_first_purchase:!0});try{const e=await sf.purchaseItem(d.item.id);e.checkout_url&&(window.location.href=e.checkout_url)}catch(i){var t,s,a,n,l,r;if(v)A.purchaseFailed({item_id:d.item.id,price_usd:d.item.price_usd||0,error_type:(null===(a=i.response)||void 0===a||null===(n=a.status)||void 0===n?void 0:n.toString())||"unknown",error_message:(null===(l=i.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail)||i.message||"Failed to initiate purchase",user_tier:v.subscription_tier||"free"});so({title:"Purchase Failed",description:(null===(t=i.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||i.message||"Failed to initiate purchase",variant:"destructive"})}finally{_(!1)}}},disabled:w,className:"flex-1 h-10 bg-[#09090b] hover:bg-[#18181b] text-white font-medium text-[14px] md:text-[16px] rounded-[12px] shadow-sm disabled:opacity-50",children:w?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Purchase for $".concat(d.item.price_usd)}):(0,se.jsx)(Bx,{onClick:I,className:"flex-1 h-10 bg-[#09090b] hover:bg-[#18181b] text-white font-medium text-[14px] md:text-[16px] rounded-[12px] shadow-sm",children:"Use Template"}),(0,se.jsxs)(Bx,{onClick:async()=>{if(!d)return;v&&A.itemPreviewed({item_id:d.item.id,is_paid:d.item.is_paid||!1,price_usd:d.item.price_usd||null});const{url:e}=await zc.getAppPublishedUrl(d.item.app_id);S?await E.openUrl({url:e}):window.open(e,"_blank")},variant:"outline",className:"flex-1 lg:flex-none h-10 px-4 bg-white border-[#e4e4e7] text-[#09090b] hover:bg-slate-50 font-medium text-[14px] md:text-[16px] rounded-[12px] flex items-center gap-1.5 justify-center",children:["View app",(0,se.jsx)(Jg.A,{className:"w-[16px] h-[16px] md:w-[18px] md:h-[18px]"})]})]}),d.item.is_paid&&(0,se.jsx)("p",{className:"text-slate-500 text-xs font-normal leading-[19px] mt-2",children:"Payment goes entirely to the creator"}),(0,se.jsx)("div",{className:"h-px bg-[#e5e7eb] my-4"}),((null===(r=d.required_premium_features)||void 0===r?void 0:r.includes("Backend Functions"))||(null===(i=d.required_premium_features)||void 0===i?void 0:i.includes("Installable Integrations")))&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(null===(o=d.required_premium_features)||void 0===o?void 0:o.includes("Backend Functions"))&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-[14px] text-[#374151] leading-[19px]",children:[(0,se.jsxs)("svg",{className:"w-3 h-3 shrink-0",viewBox:"0 0 12 12",fill:"none",stroke:"#6b7280",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("polyline",{points:"3,9 1.5,6 3,3"}),(0,se.jsx)("polyline",{points:"9,3 10.5,6 9,9"})]}),(0,se.jsx)("span",{children:"Backend functions enabled"})]}),(null===(c=d.required_premium_features)||void 0===c?void 0:c.includes("Installable Integrations"))&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-[14px] text-[#374151] leading-[19px]",children:[(0,se.jsxs)("svg",{className:"w-3 h-3 shrink-0",viewBox:"0 0 12 12",fill:"none",stroke:"#6b7280",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("circle",{cx:"9",cy:"2.5",r:"1.5"}),(0,se.jsx)("circle",{cx:"3",cy:"6",r:"1.5"}),(0,se.jsx)("circle",{cx:"9",cy:"9.5",r:"1.5"}),(0,se.jsx)("line",{x1:"4.3",y1:"6.75",x2:"7.7",y2:"8.75"}),(0,se.jsx)("line",{x1:"7.7",y1:"3.25",x2:"4.3",y2:"5.25"})]}),(0,se.jsx)("span",{children:"Uses integrations"})]})]}),(0,se.jsx)("div",{className:"h-px bg-[#e5e7eb]"})]}),$p(null==v?void 0:v.platform_role)&&(null==u?void 0:u.has_pending_update)&&(0,se.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:"Pending Update for Review"}),(0,se.jsxs)("div",{className:"space-y-2 text-sm",children:[u.has_code_changes&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-orange-700",children:[(0,se.jsx)(jg.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:"App code changes pending"})]}),u.has_metadata_changes&&(0,se.jsxs)("div",{className:"text-orange-700",children:[(0,se.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,se.jsx)("span",{className:"font-medium",children:"Listing metadata changes:"})}),(0,se.jsx)("div",{className:"space-y-1 pl-2 text-xs",children:Object.entries(u.metadata_diff).map(e=>{let[t,s]=e;return(0,se.jsxs)("div",{className:"bg-white/50 rounded px-2 py-1",children:[(0,se.jsxs)("span",{className:"font-medium capitalize",children:[t.replace(/_/g," "),":"]}),(0,se.jsxs)("div",{className:"ml-2 text-slate-600",children:[(0,se.jsx)("div",{className:"line-through text-slate-400 truncate max-w-[200px]",children:"object"==typeof s.old?JSON.stringify(s.old):String(s.old||"(empty)")}),(0,se.jsx)("div",{className:"text-green-700 truncate max-w-[200px]",children:"object"==typeof s.new?JSON.stringify(s.new):String(s.new||"(empty)")})]})]},t)})})]})]})]}),(d.is_user_the_owner||$p(null==v?void 0:v.platform_role))&&(0,se.jsxs)("div",{className:"flex flex-col gap-3 pt-3 md:pt-2 pb-3 md:pb-2",children:[d.is_user_the_owner&&(0,se.jsxs)(Bx,{onClick:()=>{d&&(window.open("/apps/".concat(d.item.app_id,"/editor/workspace/app-listing"),"_blank"),null==x||x())},variant:"outline",className:"h-10 w-full border-orange-500 text-orange-500 bg-white hover:bg-orange-50 rounded-[12px] font-medium",children:["Manage Listing"," ",(0,se.jsx)(Jg.A,{className:"w-4 h-4 ml-1"})]}),$p(null==v?void 0:v.platform_role)&&(null!=u&&u.has_pending_update?(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Bx,{onClick:P,disabled:y,className:"flex-1 h-10 bg-green-500 text-white hover:bg-green-600 rounded-[12px] font-medium",children:y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Approving..."]}):"Approve Update"}),(0,se.jsx)(Bx,{onClick:L,disabled:y,variant:"outline",className:"flex-1 h-10 border-red-500 text-red-500 bg-white hover:bg-red-50 rounded-[12px] font-medium",children:y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Declining..."]}):"Decline Update"})]}):"approved"===d.item.status?(0,se.jsx)(Bx,{onClick:L,disabled:y,variant:"outline",className:"h-10 w-full border-red-500 text-red-500 bg-white hover:bg-red-50 rounded-[12px] font-medium",children:y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Declining..."]}):"Decline Listing"}):(0,se.jsx)(Bx,{onClick:P,disabled:y,className:"h-10 w-full bg-green-500 text-white hover:bg-green-600 rounded-[12px] font-medium",children:y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Approving..."]}):"Approve Listing"}))]}),(0,se.jsx)("div",{className:"flex flex-col gap-3",children:(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)("div",{className:"text-[#374151] text-base font-semibold leading-5",children:"About this app"}),(0,se.jsx)("div",{className:"inline-flex flex-wrap gap-2",children:d.item.categories&&d.item.categories.length>0&&d.item.categories.map((e,t)=>(0,se.jsx)("div",{className:"px-1 py-0.5 bg-gray-100 rounded-sm outline outline-1 outline-offset-[-1px] outline-gray-200",children:(0,se.jsx)("div",{className:"text-center text-gray-600 text-xs font-normal",children:e})},t))}),(0,se.jsx)("div",{className:"text-[#374151] text-sm font-normal leading-5",children:(0,se.jsx)(ef,{content:d.item.description||"<p>No description available</p>"})})]})})]})})}),(0,se.jsx)("div",{className:"hidden md:block",children:d.required_premium_features&&d.required_premium_features.length>0&&(0,se.jsxs)("div",{className:"shrink-0",children:[(0,se.jsx)("div",{className:"h-px bg-[#e5e7eb] mb-4"}),(0,se.jsx)(af,{requiredFeatures:d.required_premium_features,isPaid:d.item.is_paid})]})})]})]})}),d.required_premium_features&&d.required_premium_features.length>0&&(0,se.jsxs)("div",{className:"md:hidden md:absolute bottom-[44px] left-0 right-0 z-40 bg-white px-4 pb-4",children:[(0,se.jsx)("div",{className:"h-px bg-[#e5e7eb] mb-4"}),(0,se.jsx)(af,{requiredFeatures:d.required_premium_features,isPaid:d.item.is_paid})]}),p&&(0,se.jsx)("div",{className:"bg-slate-100 border-t border-slate-200 flex items-center justify-center px-2.5 py-1.5 shrink-0",children:(0,se.jsx)("a",{href:"/marketplace/terms",target:"_blank",rel:"noopener noreferrer",className:"text-slate-700 text-sm font-normal leading-5 text-center hover:text-slate-900 hover:underline",children:"Terms of use"})})]}):null}Y.forwardRef((e,t)=>{let{className:s,variant:a="outline",size:n="icon"}=e,l=(0,Nt.A)(e,cf);const{orientation:r,scrollNext:i,canScrollNext:o}=mf();return(0,se.jsxs)(df,(0,ue.A)((0,ue.A)({ref:t,variant:a,size:n,className:de("absolute h-8 w-8 rounded-full","horizontal"===r?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:i},l),{},{children:[(0,se.jsx)(Ws.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Next slide"})]}))}).displayName="CarouselNext";const ff=["className","children"],vf=e=>{let{className:t,children:s}=e,a=(0,Nt.A)(e,ff);return(0,se.jsxs)(gt.Portal,{children:[(0,se.jsx)(Ig,{className:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,se.jsx)(gt.Content,(0,ue.A)((0,ue.A)({className:de("fixed left-[50%] top-[50%] z-50 w-full translate-x-[-50%] translate-y-[-50%] bg-white shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-[16px]",t)},a),{},{children:s}))]})};const bf=function(e){let{isOpen:t,onClose:s,selectedItem:a,onItemUpdate:n}=e;const{item:l,pendingChanges:r,clearPendingChanges:i}=$g({initialItem:a,enabled:t&&!!a});return a?(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsx)(vf,{className:"max-w-[95vw] md:max-w-[80vw] h-[90vh] md:h-[85vh] bg-white shadow-2xl overflow-hidden",children:(0,se.jsx)(gf,{item:l,pendingChanges:r,onItemUpdate:n,onClose:s,showCloseButton:!0,showTermsFooter:!0,onPendingChangesCleared:i})})}):null},jf="base44.myAppsTab",yf="base44.templatesTab",Nf="base44.webviewPush",wf="#F3F3F3";function _f(e){let{items:t,isLoading:s,isModalOpen:a,selectedItem:n,onCardClick:l,onCloseModal:r,onItemUpdate:i}=e;const o=(0,J.Zp)(),{isNativeMobile:c,navigation:d}=fd(),u=(0,Y.useCallback)(()=>{c?d.switchToTab({screenId:yf}):o("/app-templates")},[c,d,o]);return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-3 px-5",children:[(0,se.jsx)("h2",{className:"font-base44 font-semibold text-[16px] leading-[24px] tracking-[-0.03em] text-[#0A0A0A]",children:"Explore templates"}),(0,se.jsxs)("button",{onClick:u,className:"flex items-center gap-1 font-base44 font-medium text-[14px] leading-[20px] text-[#171717]",children:["View all",(0,se.jsx)(bs.A,{size:16})]})]}),s?(0,se.jsx)("div",{className:"flex justify-center py-8",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-orange-500"})}):0===t.length?(0,se.jsx)("div",{className:"text-center py-8 text-slate-500 text-sm",children:"No templates available"}):(0,se.jsxs)("div",{className:"flex gap-3 overflow-x-auto hide-scrollbar pb-2 pl-5",children:[t.slice(0,10).map(e=>(0,se.jsx)(Ag,{catalogItem:e,onClick:l},e.item.id)),(0,se.jsx)("div",{className:"w-3 flex-none"})]}),(0,se.jsx)(bf,{isOpen:a,onClose:r,selectedItem:n,onItemUpdate:i})]})}function kf(e){let{onSetPrompt:t}=e;const{loading:s,selectedCategory:a,displayedCategories:n,suggestions:l,starters:r,handleCategoryClick:i,handleSubPromptClick:o,handleBackToCategories:c,refreshCategories:d}=rg({onSetPrompt:t});return s?(0,se.jsx)("div",{className:"w-full mt-4 pb-3 flex justify-center",children:(0,se.jsxs)("div",{className:"flex flex-col items-start gap-3 max-w-[760px] w-full",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,se.jsx)(ig,{}),(0,se.jsx)(og,{disabled:!0})]}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2 justify-start",children:(0,se.jsx)(dg,{})})]})}):(0,se.jsx)("div",{className:"w-full mt-4 pb-3 flex justify-center",children:(0,se.jsxs)("div",{className:"flex flex-col gap-3 max-w-[760px] w-full items-start mx-auto",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between w-full",children:[a?(0,se.jsx)(cg,{onClick:c,categoryName:a}):(0,se.jsx)(ig,{}),!a&&!l&&(0,se.jsx)(og,{onClick:d})]}),l?(()=>{if(!l)return null;const e=[{title:l.suggestion_1.title,prompt:l.suggestion_1.prompt},{title:l.suggestion_2.title,prompt:l.suggestion_2.prompt},{title:l.suggestion_3.title,prompt:l.suggestion_3.prompt},{title:l.suggestion_4.title,prompt:l.suggestion_4.prompt},{title:l.suggestion_5.title,prompt:l.suggestion_5.prompt}];return(0,se.jsx)("div",{className:"flex flex-wrap gap-2 justify-start",children:e.map((e,t)=>(0,se.jsx)("button",{onClick:()=>o(e.prompt,e.title),className:"backdrop-blur-[6px] bg-[rgba(255,255,255,0.4)] h-[32px] px-4 rounded-[100px]  text-[14px] font-normal text-[#0f0f0f] capitalize font-base44 transition-all hover:bg-white hover:shadow-sm cursor-pointer",children:e.title},t))})})():a?(0,se.jsx)("div",{className:"flex flex-wrap gap-2 justify-start",children:r[a].map((e,t)=>(0,se.jsx)("button",{onClick:()=>o(e.description,e.title),className:"backdrop-blur-[6px] bg-[rgba(255,255,255,0.4)] h-[32px] px-4 rounded-[100px]  text-[14px] font-normal text-[#0f0f0f] capitalize font-base44 transition-all hover:bg-white hover:shadow-sm cursor-pointer",children:e.title},t))}):(0,se.jsx)("div",{className:"flex flex-wrap gap-2 items-center justify-start",children:n.map((e,t)=>(0,se.jsx)("button",{onClick:()=>i(e),className:"backdrop-blur-[6px] bg-[rgba(255,255,255,0.4)] h-[32px] px-4 rounded-[100px]  text-[14px] font-normal text-[#0f0f0f] capitalize font-base44 transition-all hover:bg-white hover:shadow-sm cursor-pointer",children:e},t))})]})})}const Cf="flex-none h-8 px-4 rounded-full text-sm font-normal text-slate-950 capitalize font-base44 transition-all hover:bg-white hover:shadow-sm cursor-pointer backdrop-blur-[6px] bg-white/70 border border-slate-200";function Af(e){let{onSetPrompt:t,onCategoryChange:s,selectedCategory:a}=e;const n=(0,Y.useRef)(null),{loading:l,selectedCategory:r,displayedCategories:i,suggestions:o,suggestionItems:c,starters:d,handleCategoryClick:u,handleSubPromptClick:m,handleBackToCategories:x,refreshCategories:h}=rg({onSetPrompt:t,onCategoryChange:s,controlledCategory:a});if((0,Y.useEffect)(()=>{n.current&&(n.current.scrollLeft=0)},[r]),l)return(0,se.jsxs)("div",{className:"w-full mt-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between w-full mb-3 max-w-[760px] mx-auto",children:[(0,se.jsx)(ig,{}),(0,se.jsx)(og,{disabled:!0})]}),(0,se.jsx)("div",{className:"overflow-x-auto hide-scrollbar -mx-4 px-4 lg:mx-0 lg:px-0 lg:overflow-visible",children:(0,se.jsx)("div",{className:"flex gap-1 items-center w-max lg:w-full lg:flex-wrap lg:justify-center",children:(0,se.jsx)(dg,{})})})]});return(0,se.jsxs)("div",{className:"w-full mt-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between w-full mb-3 max-w-[760px] mx-auto",children:[r?(0,se.jsx)(cg,{onClick:x,categoryName:r}):(0,se.jsx)(ig,{}),!r&&!o&&(0,se.jsx)(og,{onClick:h})]}),(0,se.jsx)("div",{ref:n,className:"overflow-x-auto hide-scrollbar -mx-4 px-4 lg:mx-0 lg:px-0 lg:overflow-visible",children:(0,se.jsx)("div",{className:"flex gap-1 items-center w-max lg:w-full lg:flex-wrap lg:justify-center",children:o?(0,se.jsx)(se.Fragment,{children:c.map((e,t)=>(0,se.jsx)("button",{onClick:()=>m(e.prompt,e.title),className:Cf,children:e.title},t))}):r?(0,se.jsx)(se.Fragment,{children:d[r].map((e,t)=>(0,se.jsx)("button",{onClick:()=>m(e.description,e.title),className:"".concat(Cf," animate-in fade-in slide-in-from-left-2 duration-200"),style:{animationDelay:"".concat(40*t,"ms"),animationFillMode:"backwards"},children:e.title},t))}):(0,se.jsx)(se.Fragment,{children:i.map(e=>(0,se.jsx)("button",{onClick:()=>u(e),className:Cf,children:e},e))})})})]})}function Sf(e){let{onStart:t,loading:s}=e;const[a,n]=(0,Y.useState)(()=>localStorage.getItem("home_draft_prompt")||""),[l,r]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!1),[c]=(0,Z.useSearchParams)(),d=(0,J.Zp)(),[u,m]=(0,Y.useState)([]),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)({}),[f,v]=(0,Y.useState)(!1),[b,j]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)(!0),[k,C]=(0,Y.useState)(null),{activeWorkspaceId:A}=qd(),{user:S,isAuthenticated:E}=wd(),T=qu();(0,Y.useEffect)(()=>{a?localStorage.setItem("home_draft_prompt",a):localStorage.removeItem("home_draft_prompt")},[a]),(0,Y.useEffect)(()=>{(async()=>{try{_(!0);const e=await Yd.default.getCurrentUsage();j(e.is_over_limit),N(e.past_due)}catch(e){}finally{_(!1)}})()},[A]),(0,Y.useEffect)(()=>{const e={user_id:E&&null!=S&&S.id?S.id:null,app_id:null,conversation_id:null};Tu("Page View",{page_name:"homepage",page_url:window.location.pathname,user_id:e.user_id})},[]),(0,Y.useEffect)(()=>{const e=c.get("integrations");if(e){const t=e.split(",");h(!0),Promise.all(t.map(e=>Yp.getCatalogItem(e))).then(e=>{const t=e.map(e=>e);m(t)}).catch(e=>{}).finally(()=>{h(!1)})}},[]);const I=()=>0===u.length||u.every(e=>{const t=e.item;return!t.required_secrets||0===t.required_secrets.length||t.required_secrets.every(e=>{const t=p[e.name];return!!t&&(!!("value"!==t.type||t.value&&""!==t.value.trim())&&!!("clone"!==t.type||t.value&&""!==t.value.trim()))})}),P=e=>{if(1===u.length)return n(""),r([]),o(!1),m([]),g({}),v(!1),void d("/");const t=u.filter(t=>t.item.id!==e);m(t);const s=t.map(e=>e.item.id).join(",");d(s?"/?integrations=".concat(s):"/");const a=(0,ue.A)({},p),l=u.find(t=>t.item.id===e);l&&l.item.required_secrets&&(l.item.required_secrets.forEach(e=>{delete a[e.name]}),g(a)),v(!1)},L=()=>{d("/billing")},M=e=>{n(e)},R=e=>{if(g(e),f){I()&&v(!1)}},D=()=>0===u.length?null:(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded-md text-xs bg-green-100 text-green-700",children:[(0,se.jsx)(tu.A,{className:"h-3 w-3"}),(0,se.jsxs)("span",{children:["Integrations: ",u.length]})]})}),(0,se.jsx)(Ki,{side:"top",className:"bg-slate-800 text-white p-3 rounded-lg border-0 shadow-xl max-w-[300px]",children:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{className:"text-xs font-medium",children:"Selected Integrations:"}),(0,se.jsx)("div",{className:"flex flex-wrap gap-1",children:u.map(e=>(0,se.jsx)(gs,{className:"bg-green-700 text-xs",children:e.item.name},e.item.id))})]})})]})});return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"relative",children:[y&&(0,se.jsxs)("div",{className:"mb-3 p-4 bg-yellow-50 border border-yellow-200 rounded-md text-yellow-800 flex flex-col gap-3",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(su.A,{className:"h-5 w-5 mr-2 flex-shrink-0"}),(0,se.jsx)("span",{className:"font-medium",children:"Subscription payment overdue"})]}),(0,se.jsx)("p",{className:"text-sm",children:"Your subscription payment is overdue, Access to some features is currently limited. Please update your payment method to regain full access."}),(0,se.jsx)("div",{children:(0,se.jsx)(zt,{onClick:L,className:"bg-amber-600 hover:bg-amber-700 text-white",size:"sm",children:"Go to Billing"})})]}),f&&(0,se.jsxs)("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-sm flex items-center",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,se.jsx)("span",{children:"Please fill in all required API keys before submitting."})]}),!y&&b&&(0,se.jsx)("div",{className:"max-w-[760px] mx-auto mb-[-16px] pt-3 pb-7 px-4 bg-[#eeebe9] border border-[#e2d9d3] rounded-t-[18px] shadow-[0px_-2px_8px_0px_rgba(14,33,75,0.05)]",children:(0,se.jsxs)("p",{className:"text-[14px] text-black font-base44 leading-relaxed",children:["You've reached this month's limit. To continue creating apps"," ",(0,se.jsxs)("button",{onClick:L,className:"inline-flex items-center gap-0.5 text-[#ff631f] font-semibold font-base44 hover:opacity-80 transition-opacity",children:["upgrade your plan",(0,se.jsx)(au.A,{size:16,className:"text-[#ff5500]"})]})]})}),(0,se.jsx)("div",{className:"relative z-10",children:(0,se.jsx)(Hp,{value:a,files:l,onSend:()=>{const e=a.trim();if(e){if(b)return;if(!I())return void v(!0);const s={text:e,files:l,deep_coding_mode:i,integrations:u.map(e=>e.item.id),secrets:p};t(s),n(""),r([]),v(!1)}},placeholder:"Describe the app you want to create...",disabled:s||b||w,isProcessing:s||w,onValueChange:n,onFilesChange:r,variant:"home",customButtomLeft:(e,t)=>(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[e,(0,se.jsx)(D,{})]})})})]}),x?(0,se.jsxs)("div",{className:"mt-4 flex items-center justify-center p-4 bg-slate-50 rounded-lg border border-slate-200",children:[(0,se.jsx)(Ac.A,{className:"h-5 w-5 text-slate-400 animate-spin mr-3"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Loading integration..."})]}):u.length>0?(0,se.jsx)("div",{children:u.map((e,t)=>(0,se.jsx)(Xp,{integration:e,secrets:p,onSecretsChange:R,onRemove:P},t))}):(0,se.jsx)(se.Fragment,{children:!b&&(T?(0,se.jsx)(Af,{onSetPrompt:M,selectedCategory:k,onCategoryChange:C}):(0,se.jsx)(kf,{onSetPrompt:M}))})]})}const Ef=function(e){let{app:t,linkToBuilder:s=!0}=e;const{user:a}=wd(),n=s?"/apps/".concat(t.id,"/editor/preview"):Tc(t);return(0,se.jsx)(Z.Link,{to:n,className:"block h-full group",title:"Open ".concat(t.name),children:(0,se.jsx)("div",{className:"bg-white rounded-[16px] overflow-hidden h-full border border-gray-200 hover:border-gray-700 hover:shadow-sm transition-all duration-300 p-3",children:(0,se.jsxs)("div",{className:"flex gap-3 h-full",children:[(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsxs)(us,{className:"h-20 w-20 rounded-[8px] border border-black/10",children:[(0,se.jsx)(ms,{src:t.logo_url,alt:"".concat(t.name," Logo")}),(0,se.jsx)(xs,{className:"bg-gradient-to-br from-orange-100 to-orange-50 text-orange-500 rounded-lg font-base44",children:(e=>{if(!e)return"?";const t=e.trim().split(" ");return 1===t.length?e.charAt(0).toUpperCase():(t[0].charAt(0)+t[1].charAt(0)).toUpperCase()})(t.name)})]})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0 flex flex-col justify-between h-20",children:[(0,se.jsxs)("div",{className:"flex-1 mb-1",children:[(0,se.jsxs)("div",{className:"mb-1 flex items-center gap-1",children:[(0,se.jsx)("h3",{className:"font-medium text-slate-800 truncate font-base44 text-base leading-tight",children:t.name}),(0,se.jsx)("span",{className:"text-black opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:(0,se.jsx)(Ws.A,{size:16})})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2 font-base44 leading-tight mb-1",children:t.user_description||"No description available"})]}),(0,se.jsx)("div",{className:"flex justify-between items-center",children:(0,se.jsxs)("div",{className:"flex items-center text-xs text-gray-400 font-base44",children:[(0,se.jsxs)("span",{className:"whitespace-nowrap flex-shrink-0",children:["Edited ",(l=t.updated_date,He().utc(l,He().ISO_8601).fromNow())]}),$p(a.platform_role)&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"mx-2 w-1 h-1 bg-gray-200 rounded-full flex-shrink-0"}),(0,se.jsxs)("span",{className:"truncate min-w-0",children:["by ",(e=>{if(null!=e&&e.includes("@")){const t=e.split("@")[0];return t.charAt(0).toUpperCase()+t.slice(1)}return e})(t.created_by)]})]})]})})]})]})})});var l};const Tf=function(e){let{isLoading:t,apps:s,isMobile:a}=e;return t?(0,se.jsx)("div",{className:"flex justify-center py-12",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):null!=s&&s.length?a?(0,se.jsxs)("div",{className:"flex gap-3 overflow-x-auto hide-scrollbar h-[66px] items-center snap-x snap-mandatory",children:[(0,se.jsx)("div",{className:"w-[8px] flex-none snap-start"}),s.map(e=>(0,se.jsx)(bg,{app:e,className:"snap-start"},e.id)),(0,se.jsx)("div",{className:"w-3 flex-none"})]}):(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-5 slide-up",children:s.map((e,t)=>(0,se.jsx)("div",{className:"animate-in",style:{animationDelay:"".concat(80*t,"ms")},children:(0,se.jsx)(Ef,{app:e})},e.id))}):(0,se.jsxs)("div",{className:"text-center py-6 md:py-12 px-4 md:px-8 mx-5 md:mx-0 border-2 border-dashed border-slate-200 rounded-xl fade-in",children:[(0,se.jsx)("h3",{className:"text-base md:text-xl mb-2 md:mb-4 text-slate-800",children:"You haven't created any apps yet."}),(0,se.jsx)("p",{className:"text-sm md:text-base text-slate-600 mb-4 md:mb-6",children:"Create your first app using the form above!"})]})};const If=function(){const[e,t]=(0,Y.useState)([]),[s,a]=(0,Y.useState)(!0),n=(0,J.Zp)(),{activeWorkspaceId:l}=qd(),r=qu(),{isNativeMobile:i,navigation:o}=fd();(0,Y.useEffect)(()=>{c()},[l]);const c=async()=>{a(!0);try{const e=await zc.list("-updated_date",9,0,["id","name","user_description","status","updated_date","logo_url","created_date","owner_id","created_by"].join(","));t(e)}catch(e){}finally{a(!1)}},d=(0,Y.useCallback)(()=>{i?o.switchToTab({screenId:jf}):n("/apps")},[i,o,n]);return(0,se.jsxs)("div",{className:r?"":"fade-in",children:[r?(0,se.jsxs)("div",{className:"flex items-center justify-between pb-3 px-5",children:[(0,se.jsx)("h2",{className:"font-base44 font-semibold text-[16px] leading-[24px] tracking-[-0.03em] text-[#0A0A0A]",children:"Recent Apps"}),(0,se.jsxs)("button",{onClick:d,className:"flex items-center gap-1 font-base44 font-medium text-[14px] leading-[20px] text-[#171717]",children:["View all",(0,se.jsx)(bs.A,{size:16})]})]}):(0,se.jsxs)("div",{className:"flex items-center justify-between pb-7",children:[(0,se.jsx)("h2",{className:"text-[22px] sm:text-[28px] font-medium text-black font-base44",children:"Recent Apps"}),(0,se.jsxs)("button",{onClick:d,className:"flex items-center gap-1 sm:gap-1.5 px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-black bg-white border border-gray-200 rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] hover:bg-gray-50 transition-colors",children:["View all",(0,se.jsx)(bs.A,{size:14,className:"sm:w-4 sm:h-4"})]})]}),(0,se.jsx)(Tf,{isLoading:s,apps:e,isMobile:r}),(0,se.jsx)("style",{jsx:!0,global:!0,children:"\n                .fade-in {\n                    animation: fadeIn 0.5s ease-out;\n                }\n\n                .hide-scrollbar {\n                    scrollbar-width: none; /* Firefox */\n                    -ms-overflow-style: none; /* IE/Edge */\n                }\n\n                .hide-scrollbar::-webkit-scrollbar {\n                    display: none; /* Chrome/Safari/WebView */\n                }\n                \n                .slide-up > * {\n                    opacity: 0;\n                    transform: translateY(15px);\n                }\n                \n                .animate-in {\n                    animation: slideUp 0.4s ease-out forwards;\n                }\n                \n                @keyframes fadeIn {\n                    from { opacity: 0; }\n                    to { opacity: 1; }\n                }\n                \n                @keyframes slideUp {\n                    from { \n                        opacity: 0;\n                        transform: translateY(15px);\n                    }\n                    to { \n                        opacity: 1;\n                        transform: translateY(0);\n                    }\n                }\n            "})]})};var Pf=s(6890);function Lf(){const[e,t]=(0,Y.useState)([]),[s,a]=(0,Y.useState)(!0);return(0,Y.useEffect)(()=>{(async()=>{try{const e=await Cc.getTrendingApps();t(e.trending_apps.map(e=>(0,ue.A)((0,ue.A)({},e),{},{created_by:"Community"})))}catch(e){}finally{a(!1)}})()},[]),s?(0,se.jsxs)("div",{className:"mt-12",children:[(0,se.jsxs)("h2",{className:"text-2xl font-bold mb-6 flex items-center",children:[(0,se.jsx)(Pf.A,{className:"w-6 h-6 mr-2"}),"Trending Apps"]}),(0,se.jsx)("div",{className:"flex justify-center",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):e.length?(0,se.jsx)("div",{className:"mt-12",children:(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:e.map(e=>(0,se.jsx)(Ef,{app:e,linkToBuilder:!1},e.id))})}):null}function Mf(){return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("h1",{className:"text-[22px] sm:text-[28px] font-base44 font-medium mb-2 mt-4 sm:mt-6",children:"Explore templates from the community"}),(0,se.jsx)("p",{className:"text-sm sm:text-base font-base44 text-slate-600 max-w-2xl mb-4",children:"Discover a curated collection of applications built by our community."})]})}const Rf=["className","type"],Df=Y.forwardRef((e,t)=>{let{className:s,type:a}=e,n=(0,Nt.A)(e,Rf);return(0,se.jsx)("input",(0,ue.A)({type:a,className:de("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t},n))});Df.displayName="Input";const Ff=["className","children","advancedDropdown"],Of=["className"],Uf=["className"],Bf=["className","children","position","hideScrollButtons"],zf=["className"],Hf=["className","children","hideCheckIcon","checkPosition"],Vf=["className"],Wf=it.Root,qf=(it.Group,it.Value),Yf=Y.forwardRef((e,t)=>{let{className:s,children:a,advancedDropdown:n=!1}=e,l=(0,Nt.A)(e,Ff);return(0,se.jsxs)(it.Trigger,(0,ue.A)((0,ue.A)({ref:t,className:de("flex h-10 w-full items-center justify-between ".concat(n?"rounded-lg":"rounded-md"," border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring  disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1"),s)},l),{},{children:[n?(0,se.jsx)("div",{className:"flex-1 min-w-0",children:a}):a,(0,se.jsx)(it.Icon,{asChild:!0,children:(0,se.jsx)(_t.A,{className:de("h-4 w-4 opacity-50",n?"flex-shrink-0 ml-2":"")})})]}))});Yf.displayName=it.Trigger.displayName;const Gf=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Of);return(0,se.jsx)(it.ScrollUpButton,(0,ue.A)((0,ue.A)({ref:t,className:de("absolute top-0 left-0 right-0 z-10 flex cursor-default items-center justify-center py-1 bg-gradient-to-b from-popover via-popover to-transparent",s)},a),{},{children:(0,se.jsx)(ur.A,{className:"h-4 w-4"})}))});Gf.displayName=it.ScrollUpButton.displayName;const Kf=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Uf);return(0,se.jsx)(it.ScrollDownButton,(0,ue.A)((0,ue.A)({ref:t,className:de("absolute bottom-0 left-0 right-0 z-10 flex cursor-default items-center justify-center py-1 bg-gradient-to-t from-popover via-popover to-transparent",s)},a),{},{children:(0,se.jsx)(_t.A,{className:"h-4 w-4"})}))});Kf.displayName=it.ScrollDownButton.displayName;const $f=Y.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper",hideScrollButtons:l=!1}=e,r=(0,Nt.A)(e,Bf);return(0,se.jsx)(it.Portal,{children:(0,se.jsxs)(it.Content,(0,ue.A)((0,ue.A)({ref:t,className:de("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n},r),{},{children:[!l&&(0,se.jsx)(Gf,{}),(0,se.jsx)(it.Viewport,{className:de("p-1 scroll-smooth","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),!l&&(0,se.jsx)(Kf,{})]}))})});$f.displayName=it.Content.displayName;Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,zf);return(0,se.jsx)(it.Label,(0,ue.A)({ref:t,className:de("py-1.5 pl-8 pr-2 text-sm font-semibold",s)},a))}).displayName=it.Label.displayName;const Zf=Y.forwardRef((e,t)=>{let{className:s,children:a,hideCheckIcon:n=!1,checkPosition:l="left"}=e,r=(0,Nt.A)(e,Hf);if(!r.value)return null;const i="right"===l;return(0,se.jsxs)(it.Item,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n?"pl-2 pr-2":i?"pl-2 pr-8":"pl-8 pr-2","group-data-[theme=white]:hover:bg-muted",s)},r),{},{children:[!n&&(0,se.jsx)("span",{className:de("absolute flex h-3.5 w-3.5 items-center justify-center",i?"right-2":"left-2"),children:(0,se.jsx)(it.ItemIndicator,{children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}),(0,se.jsx)(it.ItemText,{children:a})]}))});Zf.displayName=it.Item.displayName;Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Vf);return(0,se.jsx)(it.Separator,(0,ue.A)({ref:t,className:de("-mx-1 my-1 h-px bg-muted",s)},a))}).displayName=it.Separator.displayName;const Jf=["Marketing & Sales","Operations","Data & Analytics","Content Generation","HR & Legal","Finance","Education","Community","Lifestyle & Hobbies","Games & Entertainment"],Qf=[{label:"English",value:"en"},{label:"Deutsch",value:"de"},{label:"Espa\xf1ol",value:"es"},{label:"Fran\xe7ais",value:"fr"},{label:"Italiano",value:"it"},{label:"\u65e5\u672c\u8a9e",value:"ja"},{label:"\u4e2d\u6587",value:"zh"},{label:"\u0939\u093f\u0928\u094d\u0926\u0940",value:"hi"},{label:"Portugu\xeas",value:"pt"},{label:"\u05e2\u05d1\u05e8\u05d9\u05ea",value:"he"},{label:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",value:"ar"},{label:"Bahasa Indonesia",value:"id"}],Xf=[{value:"all",label:"All Templates"},{value:"free",label:"Free Only"},{value:"paid",label:"Paid Only"}],ev="popular",tv="all";function sv(e){let{searchTerm:t,onSearchChange:s,selectedCategory:a,onCategoryChange:n,sortBy:l,onSortByChange:r,selectedLanguage:i,onLanguageChange:o,priceFilter:c=tv,onPriceFilterChange:d,showViewAllButton:u=!1}=e;const m=(0,J.Zp)(),{isNativeMobile:x,navigation:h}=fd(),p=(0,Y.useCallback)(()=>{x?h.switchToTab({screenId:yf}):m("/app-templates")},[x,h,m]);return(0,se.jsxs)("div",{className:"flex flex-col gap-4 sm:gap-6",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,se.jsxs)("div",{className:"flex items-center rounded-[24px] border border-[#e4e4e7] bg-white w-full sm:w-[420px] h-[40px] pl-3 pr-3 gap-[10px]",children:[(0,se.jsx)(na.A,{className:"w-5 h-5 sm:w-6 sm:h-6 text-[#b4b4b4] flex-shrink-0"}),(0,se.jsx)(Df,{placeholder:"Search apps",value:t,onChange:e=>s(e.target.value),className:"border-0 bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 placeholder:text-[#b4b4b4] text-sm text-black h-[40px] p-0"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3 sm:gap-6 justify-between sm:justify-end",children:[(0,se.jsxs)(Wf,{value:i,onValueChange:o,children:[(0,se.jsx)(Yf,{className:"w-auto min-w-[100px] sm:min-w-[140px] h-[36px] font-base44 font-medium text-sm border border-[#E5E5E5] bg-white rounded-lg px-3 sm:px-4 text-black focus:ring-0 [&>svg]:text-black [&>svg]:ml-1 sm:[&>svg]:ml-2 [&>svg]:h-4 [&>svg]:w-4",children:(0,se.jsx)(qf,{placeholder:"Language"})}),(0,se.jsx)($f,{children:Qf.map(e=>(0,se.jsx)(Zf,{value:e.value,className:"font-base44",children:e.label},e.value))})]}),d&&(0,se.jsxs)(Wf,{value:c,onValueChange:d,children:[(0,se.jsx)(Yf,{className:"w-auto min-w-[100px] sm:min-w-[140px] h-[36px] font-base44 font-medium text-sm border border-[#E5E5E5] bg-white rounded-lg px-3 sm:px-4 text-black focus:ring-0 [&>svg]:text-black [&>svg]:ml-1 sm:[&>svg]:ml-2 [&>svg]:h-4 [&>svg]:w-4",children:(0,se.jsx)(qf,{placeholder:"Price"})}),(0,se.jsx)($f,{children:Xf.map(e=>(0,se.jsx)(Zf,{value:e.value,className:"font-base44",children:e.label},e.value))})]}),u&&(0,se.jsxs)("button",{onClick:p,className:"flex items-center gap-1 sm:gap-2 h-[36px] px-2 sm:px-4 text-sm font-medium font-base44 text-[#0a0a0a] bg-white border border-[#e5e5e5] rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] hover:bg-gray-50 transition-colors whitespace-nowrap",children:[(0,se.jsx)("span",{className:"inline",children:"View all templates"}),(0,se.jsx)(bs.A,{className:"w-4 h-4"})]})]})]}),(0,se.jsx)("div",{className:"w-full h-px bg-[#E5E7EB]"}),(0,se.jsx)("div",{className:"w-full overflow-x-auto pb-1",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 min-w-max",children:[(0,se.jsx)("button",{onClick:()=>n("all"),className:de("cursor-pointer text-sm px-3 font-base44 font-normal rounded-full transition-colors whitespace-nowrap h-[28px] sm:h-[24px] flex items-center","all"===a?"bg-slate-800 text-white hover:bg-slate-700":"bg-white text-[#09090b] border border-[#e5e7eb] hover:bg-gray-50"),children:"All"}),(0,se.jsx)("div",{className:"w-px self-stretch bg-[#CBD5E1]"}),Jf.map(e=>(0,se.jsx)("button",{onClick:()=>n(e),className:de("cursor-pointer text-sm px-3 font-base44 font-normal rounded-full transition-colors whitespace-nowrap h-[28px] sm:h-[24px] flex items-center",a===e?"bg-slate-800 text-white hover:bg-slate-700":"bg-white text-[#09090b] border border-[#e5e7eb] hover:bg-gray-50"),children:e},e))]})})]})}var av=s(79992);function nv(e){var t;let{catalogItem:s,onCardClick:a}=e;const n=s.item,l=null===(t=n.screenshot_urls)||void 0===t?void 0:t[0],r=s.item_creator,i=n.categories||[],o=i.slice(0,2),c=i.length>2?i.length-2:0,[d,u]=(0,Y.useState)(!1),{isNativeMobile:m}=fd(),x=qu()||m;return(0,se.jsxs)("div",{className:"flex flex-col gap-3 items-start relative rounded-[20px] cursor-pointer group",onClick:()=>a(s),children:[(0,se.jsxs)("div",{className:"border border-black/10 border-solid aspect-[16/10] relative rounded-xl shrink-0 w-full overflow-hidden",children:[l&&!d?(0,se.jsx)(Cg,{src:l,alt:n.name,className:"absolute size-full object-cover rounded-xl",objectFit:"cover",quality:85,lazy:!0,onError:()=>u(!0)}):(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-50",children:(0,se.jsx)(jg.A,{className:"w-12 h-12 text-slate-400"})}),"workspace"===n.visibility_scope&&(0,se.jsxs)("div",{className:"absolute top-2 left-2 z-10 bg-teal-600 text-white text-xs px-2 py-1 rounded-md font-medium shadow-sm flex items-center gap-1",children:[(0,se.jsx)(Zg.A,{className:"w-3 h-3"}),"Workspace"]}),s.already_purchased&&(0,se.jsx)("div",{className:"absolute top-2 right-2 z-10 bg-green-500 text-white text-xs px-2 py-1 rounded-md font-medium shadow-sm",children:"Purchased"}),!x&&(0,se.jsx)("div",{className:"absolute inset-0 z-20 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center rounded-xl",children:(0,se.jsx)(Bx,{onClick:e=>{e.stopPropagation(),null==a||a(s)},variant:"outline",className:"bg-white hover:bg-gray-50 text-[#0a0a0a] border border-[#e5e5e5] font-medium font-base44 text-sm px-8 py-2 h-10 rounded-lg transition-colors",children:"View details"})})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-1 items-start relative shrink-0 w-full",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between relative shrink-0 w-full",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 relative min-w-0 flex-1",children:[(0,se.jsx)("p",{className:"font-medium leading-none relative text-lg text-black truncate",children:n.name}),n.is_private&&(0,se.jsxs)("div",{className:"group/tooltip relative inline-flex",children:[(0,se.jsx)(av.A,{className:"w-4 h-4 text-gray-500"}),(0,se.jsx)("div",{className:"pointer-events-none absolute -top-8 left-1/2 -translate-x-1/2 px-2 py-1 bg-white text-black border border-gray-200 shadow-lg text-xs rounded opacity-0 [@media(hover:hover)]:group-hover/tooltip:opacity-100 transition-opacity whitespace-nowrap z-30",children:"Private"})]})]}),n.is_paid&&n.price_usd?(0,se.jsxs)("p",{className:"font-normal leading-none text-base text-black",children:["$",n.price_usd]}):(0,se.jsx)("p",{className:"font-normal leading-none text-base text-gray-500",children:"Free"})]}),(0,se.jsxs)("div",{className:"box-border flex gap-2 items-center pb-0 pt-1 px-0 relative shrink-0",children:[(0,se.jsx)("p",{className:"font-normal leading-none relative shrink-0 text-[#3c444c] text-sm",children:(null==r?void 0:r.full_name)||"Unknown User"}),(0,se.jsx)("p",{className:"font-normal leading-[14px] relative shrink-0 text-sm text-gray-500",children:"\u2022"}),(0,se.jsxs)("div",{className:"flex gap-1 items-center relative shrink-0",children:[(0,se.jsx)("div",{className:"flex items-start relative shrink-0",children:(0,se.jsx)("div",{className:"relative shrink-0 size-[18px]",children:(0,se.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 6V5C5 4.44772 5.44772 4 6 4H14C14.5523 4 15 4.44772 15 5V12C15 12.5523 14.5523 13 14 13H13V14C13 14.5523 12.5523 15 12 15H4C3.44772 15 3 14.5523 3 14V7C3 6.44772 3.44772 6 4 6H5ZM12 10H4V14H12V10ZM12 9V7H4V9H12ZM6 6H12C12.5523 6 13 6.44772 13 7V12H14V5H6V6Z",fill:"#374151"})})})}),(0,se.jsx)("p",{className:"font-normal leading-none relative shrink-0 text-[#3c444c] text-sm",children:s.usage})]})]}),i.length>0&&(0,se.jsxs)("div",{className:"box-border flex gap-[6px] items-center pb-0 pt-2 px-0 relative shrink-0",children:[o.map((e,t)=>(0,se.jsx)("div",{className:"h-7 px-2 sm:px-2.5 bg-gray-50 rounded-md flex justify-center items-center gap-1 overflow-hidden max-w-full",children:(0,se.jsx)("p",{className:"font-medium leading-5 relative text-[#0a0a0a] text-sm truncate",children:e})},t)),c>0&&(0,se.jsxs)("div",{className:"h-7 px-2 flex justify-center items-center gap-2.5 group/categories relative",children:[(0,se.jsxs)("p",{className:"font-normal leading-none relative shrink-0 text-[#3c444c] text-sm cursor-default",children:["+",c]}),(0,se.jsx)("div",{className:"pointer-events-none absolute -top-2 left-1/2 -translate-x-1/2 -translate-y-full px-2 py-1 bg-white text-black border border-gray-200 shadow-lg text-xs rounded opacity-0 [@media(hover:hover)]:group-hover/categories:opacity-100 transition-opacity max-w-[200px] text-center z-30",children:i.slice(2).join(", ")})]})]})]})]})}function lv(){return(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsx)("div",{className:"border border-black/10 aspect-[16/10] bg-slate-100 rounded-xl animate-pulse"}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"h-5 bg-slate-100 rounded-md animate-pulse w-3/4"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-4 w-32 bg-slate-100 rounded-md animate-pulse"}),(0,se.jsx)("div",{className:"w-1 h-1 bg-slate-300 rounded-full"}),(0,se.jsx)("div",{className:"h-4 w-16 bg-slate-100 rounded-md animate-pulse"})]}),(0,se.jsxs)("div",{className:"flex gap-2 pt-1",children:[(0,se.jsx)("div",{className:"h-7 w-24 bg-slate-100 rounded-md animate-pulse"}),(0,se.jsx)("div",{className:"h-7 w-32 bg-slate-100 rounded-md animate-pulse"})]})]})]})}function rv(){return(0,se.jsxs)("div",{className:"space-y-14",children:[(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-10 gap-y-14",children:Array.from({length:6}).map((e,t)=>(0,se.jsx)(lv,{},t))}),(0,se.jsx)("div",{className:"flex items-center justify-center mt-8",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-8 h-8 bg-slate-100 rounded-md animate-pulse"}),(0,se.jsx)("div",{className:"w-8 h-8 bg-slate-100 rounded-md animate-pulse"}),(0,se.jsx)("div",{className:"w-8 h-8 bg-slate-100 rounded-md animate-pulse"})]})})]})}var iv=s(12550);function ov(){return(0,se.jsxs)("div",{className:"text-center py-24",children:[(0,se.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-slate-100 mb-4",children:(0,se.jsx)(iv.A,{className:"w-8 h-8 text-slate-400"})}),(0,se.jsx)("p",{className:"text-lg text-slate-600",children:"No apps found"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Try adjusting your search or filters"})]})}function cv(e){let{isLoading:t,isLoadingMore:s=!1,items:a,onCardClick:n,hasMore:l=!1,targetRef:r,showViewAllButton:i=!1}=e;return(0,se.jsx)("div",{className:"",children:t?(0,se.jsx)(rv,{}):0===a.length?(0,se.jsx)(ov,{}):(0,se.jsxs)("div",{className:"space-y-14",children:[(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-10 gap-y-14",children:a.map(e=>(0,se.jsx)(nv,{catalogItem:e,onCardClick:n},e.item.id))}),(0,se.jsx)("div",{ref:i?void 0:r,className:"w-full py-4",children:i?(0,se.jsx)("div",{className:"flex justify-center py-8",children:(0,se.jsx)(Bx,{onClick:()=>window.location.href="/app-templates",className:"bg-slate-900 hover:bg-slate-800 text-white font-medium px-8 py-3 rounded-[12px] font-base44",children:"View All Community Templates"})}):(0,se.jsx)(se.Fragment,{children:s&&(0,se.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}),(0,se.jsx)("span",{className:"ml-2 text-slate-600",children:"Loading more items..."})]})})})]})})}const dv=function(){const{user:e}=wd(),t=qu(),[s,a]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)("all"),[d,u]=(0,Y.useState)(ev),[m,x]=(0,Y.useState)("en"),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!0),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(0),[N]=(0,Y.useState)(20),[w,_]=(0,Y.useState)(0),[k,C]=(0,Y.useState)(null),[A,S]=(0,Y.useState)(!1),{isNativeMobile:E,navigation:T}=fd();(0,Y.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("category");if(e){const t=Jf.find(t=>t.toLowerCase()===e.toLowerCase());t?c(t):"my-apps"===e.toLowerCase()&&c("my-apps")}},[]),(0,Y.useEffect)(()=>{a([]),_(0),f(!0),I(!0)},[r,o,d,m]);const I=(0,Y.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?l(!0):b(!0);const t=e?0:w,s="my-apps"===o;let n={skip:t,limit:N,sort_by:P(d),categories:"all"!==o&&"my-apps"!==o?[o]:void 0};r&&"en"===m?n.$and=[{$or:[{name:{$regex:r,$options:"i"}},{description:{$regex:r,$options:"i"}},{categories:{$regex:r,$options:"i"}},{tags:{$regex:r,$options:"i"}},{created_by:{$regex:r,$options:"i"}}]},{$or:[{language:"en"},{language:{$exists:!1}},{language:null}]}]:r?(n.$or=[{name:{$regex:r,$options:"i"}},{description:{$regex:r,$options:"i"}},{categories:{$regex:r,$options:"i"}},{tags:{$regex:r,$options:"i"}},{created_by:{$regex:r,$options:"i"}}],m&&"en"!==m&&(n.language=m)):m&&("en"===m?n.$or=[{language:"en"},{language:{$exists:!1}},{language:null}]:n.language=m),Object.keys(n).forEach(e=>{void 0===n[e]&&delete n[e]});const i=s?await Gg.listMyItems(n):await Gg.listCatalogItems(n),c=i.items||i,u=i.total||c.length;e?(a(c),y(u)):a(e=>[...e,...c]),_(t+c.length),f(0!==c.length)}catch(t){so({title:"Error",description:"Failed to load catalog items",variant:"destructive"})}finally{l(!1),b(!1)}},[w,N,o,r,d,m]),P=e=>{switch(e){case"newest":return"created_at_desc";case"oldest":return"created_at_asc";default:return"usage"}},L=async e=>{E?T.push({screenName:Nf,passProps:{url:"".concat(window.location.origin,"/app-templates/").concat(e.item.id)}}):(C(e),S(!0))},M=()=>{S(!1),C(null)},R=e=>{C(e)},D=s.length,F=j>0?"Showing ".concat(D," of ").concat(j," items"):"",O=(0,se.jsx)(bf,{isOpen:A,onClose:M,selectedItem:k,onItemUpdate:R});return t?(0,se.jsx)(_f,{items:s,isLoading:n,isModalOpen:A,selectedItem:k,onCardClick:L,onCloseModal:M,onItemUpdate:R}):(0,se.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 max-w-[1600px] mx-auto",children:[(0,se.jsx)(Mf,{}),(0,se.jsx)(sv,{searchTerm:r,onSearchChange:e=>{i(e)},selectedCategory:o,onCategoryChange:e=>{c(e)},showAllCategories:h,setShowAllCategories:p,totalItems:j,displayedItems:D,showingText:F,isLoading:n,sortBy:d,onSortByChange:e=>{u(e)},selectedLanguage:m,onLanguageChange:e=>{x(e)},showViewAllButton:!0}),(0,se.jsx)("div",{className:"mt-12",children:(0,se.jsx)(cv,{isLoading:n,isLoadingMore:v,items:s,onCardClick:L,hasMore:g,targetRef:null,showViewAllButton:!0})}),O]})},uv={id:"personal-sale-2026",desktopTagline:"Limited time welcome offer",mobileTagline:"Get 30% off select yearly plans",offerText:"Get 30% off select yearly plans",discountPercent:.3,eligibleTiers:["builder","pro","elite"],yearlyOnly:!0,bannerStyle:{linkBackground:"#C3E6F1",fullWidthBackground:"#ff7b42",badgeBackground:"rgba(255,99,31,0.85)"},disclaimerLines:["Offer valid for {timer}. Applies only to the first billing cycle of a new yearly subscription purchased during this sale and does not apply to renewals.","Valid only for Builder, Pro, or Elite 1 yearly plans."]};function mv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uv;return"".concat(Math.round(100*e.discountPercent),"%")}function xv(e){return null!=e&&e.personal_sale_ends_at?new Date(e.personal_sale_ends_at):new Date("2099-12-31T23:59:59Z")}function hv(e){return!0===(null==e?void 0:e.personal_sale_eligible)}const pv=e=>{let{stats:t,isLinkToBilling:s=!1,saleConfig:a=uv,className:n}=e;const[l,r]=(0,Y.useState)({days:0,hours:0,minutes:0,seconds:0}),i=(0,J.Zp)(),o=(0,Y.useMemo)(()=>xv(t),[t]);if((0,Y.useEffect)(()=>{const e=()=>{const e=new Date,t=o.getTime()-e.getTime();if(t>0){const e=Math.floor(t/864e5),s=Math.floor(t%864e5/36e5),a=Math.floor(t%36e5/6e4),n=Math.floor(t%6e4/1e3);r({days:e,hours:s,minutes:a,seconds:n})}else r({days:0,hours:0,minutes:0,seconds:0})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[o]),!hv(t))return null;const c="Get ".concat(mv(a)," off select yearly plans");return(0,se.jsxs)("div",{className:de("text-white py-3 px-4 h-[64px] flex items-center justify-center md:flex-row flex-col md:h-[64px] h-auto md:py-3 py-4",s&&"w-full sm:max-w-3xl mx-auto text-center mb-[32px] md:mb-[32px] sm:rounded-[30px] cursor-pointer",!s&&"w-full",n),style:{background:s?a.bannerStyle.linkBackground:a.bannerStyle.fullWidthBackground},onClick:()=>{s&&i("/billing")},children:[(0,se.jsxs)("div",{className:"hidden md:flex items-center justify-center w-full",children:[(0,se.jsx)("p",{className:"text-black font-base44 font-light text-center text-[19.176px] leading-[23.97px]",children:a.desktopTagline}),(0,se.jsxs)("div",{className:de("ml-3 px-3 py-2 flex items-center justify-center rounded-full min-h-[40px] group transition-colors duration-200",s?"bg-[#D6F1FB]":"bg-[#ffccac]"),children:[(0,se.jsx)("p",{className:"text-black font-base44 font-regular text-center text-[16px] leading-[24px]",children:c}),s&&(0,se.jsx)("div",{className:"transition-transform ml-[8px] duration-200 group-hover:translate-x-0.5 group-hover:-translate-y-0.5",children:(0,se.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 41 41",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M11.8851 11.8851H28.8639M28.8639 11.8851V28.8639M28.8639 11.8851L11.8851 28.8639",stroke:"#0A0A0A",strokeWidth:"1.69788",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,se.jsxs)("div",{className:"ml-2 flex items-center font-base44 font-regular text-black text-[30px]",children:[(0,se.jsx)("span",{className:"inline-block w-[50px] text-center",children:String(24*l.days+l.hours).padStart(2,"0")}),(0,se.jsx)("span",{className:"w-[10px] text-center",children:":"}),(0,se.jsx)("span",{className:"inline-block w-[50px] text-center",children:String(l.minutes).padStart(2,"0")}),(0,se.jsx)("span",{className:"w-[10px] text-center",children:":"}),(0,se.jsx)("span",{className:"inline-block w-[50px] text-center",children:String(l.seconds).padStart(2,"0")})]})]}),(0,se.jsxs)("div",{className:"flex md:hidden flex-col items-center gap-2",children:[(0,se.jsxs)("p",{className:"text-black font-base44 text-center text-[18px] leading-[24px]",children:[(0,se.jsxs)("span",{className:"font-medium uppercase",children:["Get ",mv(a)," "]}),(0,se.jsx)("span",{className:"font-normal",children:"off select yearly plans"})]}),(0,se.jsxs)("div",{className:"flex items-center font-base44 font-normal text-black text-[38px] leading-[34px]",children:[(0,se.jsx)("span",{className:"inline-block w-[48px] text-center",children:String(24*l.days+l.hours).padStart(2,"0")}),(0,se.jsx)("span",{className:"text-center",children:":"}),(0,se.jsx)("span",{className:"inline-block w-[48px] text-center",children:String(l.minutes).padStart(2,"0")}),(0,se.jsx)("span",{className:"text-center",children:":"}),(0,se.jsx)("span",{className:"inline-block w-[48px] text-center",children:String(l.seconds).padStart(2,"0")})]})]})]})};const gv=function(){const[e,t]=(0,Y.useState)(!1),[s]=(0,Y.useState)("my-apps"),a=(0,J.Zp)(),n=(0,J.zy)(),{user:l}=wd(),{activeWorkspaceId:r,activeWorkspace:i,switchActiveWorkspace:o}=qd(),{isNativeMobile:c,actions:d}=fd(),u=qu(),{data:m}=Xd({query:()=>Yd.default.getStats()}),x=hv(m);return(0,Y.useEffect)(()=>{const e=localStorage.getItem("activeWorkspaceId");e&&e!==r&&o(e)},[]),(0,se.jsxs)("div",{className:"min-h-screen",style:{backgroundColor:c?wf:void 0},children:[(0,se.jsxs)("section",{className:"relative ".concat(c?"":"pb-10"),style:{background:c?wf:"linear-gradient(to top,rgba(255, 85, 0, 0.6) 0%, #FFC494 10%, #F5F5F4 70%)"},children:[x&&(0,se.jsx)(pv,{stats:m,isLinkToBilling:!0}),(0,se.jsxs)("div",{className:"relative z-10 flex flex-col px-4 sm:px-6 lg:px-8 ".concat(x?"pt-[20px] sm:pt-[40px]":c?"pt-6":"pt-[50px] sm:pt-[110px]"),children:[(0,se.jsxs)("div",{className:"mx-auto ".concat(u?"max-w-md mb-7 text-left":"max-w-4xl mb-14 text-center"),children:[i&&!i.is_personal&&(0,se.jsx)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full backdrop-blur-sm bg-white/60 mb-6 mx-auto w-fit",children:(0,se.jsx)("span",{className:"text-sm font-base44 font-normal text-slate-600",children:i.name.charAt(0).toUpperCase()+i.name.slice(1)})}),(0,se.jsx)("h1",{className:"font-base44 text-slate-800 ".concat(u?"text-3xl font-semibold":"text-[42px] font-medium mb-2"),style:u?{letterSpacing:"-0.9px"}:void 0,children:"What will you build today?"}),!u&&(0,se.jsxs)("p",{className:"text-gray-600 font-base44 font-light text-[14px]",children:["Describe your app idea below or get inspired by our"," ",(0,se.jsx)("span",{className:"underline italic cursor-pointer hover:text-gray-800 transition-colors",onClick:()=>{var e;return null===(e=document.querySelector("#app-catalog-section"))||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},children:"templates"})]})]}),(0,se.jsx)("div",{className:"sm:max-w-4xl mx-auto w-full",children:(0,se.jsx)(Sf,{onStart:async e=>{let{text:s,files:r,deep_coding_mode:i,integrations:o,secrets:u,model:m}=e;if(s.trim()){Ld(Td.CREATE_APP_STARTED,{has_files:(null==r?void 0:r.length)>0,has_integrations:(null==o?void 0:o.length)>0,deep_coding_mode:!!i,has_model:!!m,prompt_length:s.length}),t(!0);try{const e=new URLSearchParams(n.search).get("app_platform_version"),t={deep_coding_mode:!!i,status:{state:"processing",details:"Starting conversation..."},integrations:o,secrets:u};m&&(t.model=m),e&&(t.platform_version=parseInt(e,10));const x=await zc.create(t);Ld(Td.CREATE_APP_SUCCESS,{app_id:x.id}),c?(Gh(x.id,{content:s,file_urls:r},null==l?void 0:l.id,{from_mobile:!0}),await d.addAppProcess({appId:x.id,appName:x.name})):a("/apps/".concat(x.id,"/editor/preview"),{state:{initialMessage:{content:s,file_urls:r}}})}catch(x){Pd(x,{source:Id.BUSINESS,component:"HomePage.handleCreateApp",context:{prompt_length:s.length}}),alert("Failed to create app. Please try again.")}finally{t(!1)}}else alert("Please enter an app description")},loading:e})})]})]}),(0,se.jsxs)("main",{className:"relative max-w-[1600px] mx-auto ".concat(u?"pt-9":"pt-10 px-8"),style:{backgroundColor:c?wf:"#FFFFFF"},children:["my-apps"===s&&(0,se.jsx)(If,{}),"trending"===s&&(0,se.jsx)(Lf,{}),!u&&(0,se.jsx)("div",{className:"w-full h-px bg-[#E5E7EB] mt-16"})]}),(0,se.jsx)("section",{id:"app-catalog-section",className:"relative pb-10 md:pb-16 ".concat(u?"pt-9":"pt-6"),style:{backgroundColor:c?wf:"#FFFFFF",paddingBottom:c?"130px":void 0},children:(0,se.jsx)(dv,{})})]})};var fv=s(2263),vv=s(82407),bv=s(24990),jv=s(46327),yv=s(39193),Nv=s(9072);let wv=function(e){return e.MY_APPS_WORKSPACE="my_apps_workspace",e.ALL_APPS_WORKSPACE="all_apps_workspace",e.ALL_PLATFORM="all_platform",e.OWNED_BY_ME="owned_by_me",e}({});function _v(e){return t=e,Object.values(wv).includes(t);var t}let kv=null;function Cv(){return kv||(kv=new BroadcastChannel("app-list-updates")),kv}function Av(){kv&&(kv.close(),kv=null)}function Sv(){Cv().postMessage({type:"invalidate"})}const Ev=/[.*+?^${}()|[\]\\]/g;function Tv(e){return null==e?void 0:e.replace(Ev,"\\$&")}const Iv=/^[0-9a-fA-F]{24}$/;const Pv=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function Lv(e){return Pv.test(e)}const Mv=["className"],Rv=["className"],Dv=["className"],Fv=["className"],Ov=["className"],Uv=["className"],Bv=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Mv);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("rounded-lg border bg-card text-card-foreground shadow-sm",s)},a))});Bv.displayName="Card";const zv=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Rv);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("flex flex-col space-y-1.5 px-6 py-4",s)},a))});zv.displayName="CardHeader";const Hv=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Dv);return(0,se.jsx)("h3",(0,ue.A)({ref:t,className:de("font-medium leading-none tracking-tight",s)},a))});Hv.displayName="CardTitle";const Vv=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Fv);return(0,se.jsx)("p",(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});Vv.displayName="CardDescription";const Wv=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ov);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("px-6 py-3",s)},a))});Wv.displayName="CardContent";const qv=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Uv);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("flex items-center px-6 pt-0 pb-3",s)},a))});function Yv(){return(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("div",{className:"h-12 w-12 rounded-xl bg-slate-200 animate-pulse"}),(0,se.jsx)("div",{className:"flex-1 min-w-0",children:(0,se.jsx)("div",{className:"h-6 bg-slate-200 rounded-md animate-pulse w-3/4"})})]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,se.jsx)("div",{className:"h-4 bg-slate-100 rounded animate-pulse w-full"}),(0,se.jsx)("div",{className:"h-4 bg-slate-100 rounded animate-pulse w-2/3"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-3 bg-slate-100 rounded animate-pulse w-20"}),(0,se.jsx)("div",{className:"w-px h-3 bg-slate-200"}),(0,se.jsx)("div",{className:"h-3 bg-slate-100 rounded animate-pulse w-24"})]})]})]})}function Gv(){return(0,se.jsx)("div",{className:"p-6 min-h-full",children:(0,se.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,se.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,se.jsx)("div",{className:"h-9 bg-slate-200 rounded-lg animate-pulse w-32"}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full md:w-auto",children:[(0,se.jsx)("div",{className:"h-10 bg-slate-100 rounded-md animate-pulse w-full sm:w-80"}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)("div",{className:"h-10 bg-slate-100 rounded-md animate-pulse w-[300px]"}),(0,se.jsx)("div",{className:"h-10 w-10 bg-slate-100 rounded-md animate-pulse"}),(0,se.jsx)("div",{className:"h-10 w-10 bg-slate-100 rounded-md animate-pulse"}),(0,se.jsx)("div",{className:"h-10 w-10 bg-slate-100 rounded-md animate-pulse"})]})]})]}),(0,se.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,se.jsx)(Yv,{},t))}),(0,se.jsxs)("div",{className:"flex justify-center gap-2 mt-8",children:[(0,se.jsx)("div",{className:"h-10 w-24 bg-slate-100 rounded-md animate-pulse"}),(0,se.jsx)("div",{className:"h-10 w-20 bg-slate-100 rounded-md animate-pulse"})]})]})})}qv.displayName="CardFooter";const Kv=function(){var e;const{user:t}=wd(),{toast:s}=ao(),[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)("desc"),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(1),[f,v]=(0,Y.useState)(!0),[b,j]=(0,Y.useState)("grid"),[y,N]=(0,Y.useState)(null),w="grid"===b?24:100,[_,k]=(0,Y.useState)(0),{activeWorkspaceId:C,activeWorkspace:A}=((0,J.Zp)(),qd()),[S,E]=(0,Z.useSearchParams)(),[T,I]=(0,Y.useState)(()=>{const e=S.get("filter");return e&&_v(e)?e:$p(null==t?void 0:t.platform_role)?wv.OWNED_BY_ME:wv.MY_APPS_WORKSPACE}),P=$p(null==t?void 0:t.platform_role),L="admin"===(null==A?void 0:A.user_role)||"owner"===(null==A?void 0:A.user_role),M=(null==A?void 0:A.is_personal)||!C||C===(null==t?void 0:t.personal_organization_id);(0,Y.useEffect)(()=>{const e=new URLSearchParams(S);e.set("filter",T),E(e,{replace:!0})},[T,S,E]),(0,Y.useEffect)(()=>(Cv().onmessage=()=>{g(1),n([]),k(Date.now())},()=>Av()),[]);const R=(0,Y.useCallback)(async()=>{try{const t="desc"===u?"-":"";let s={};if(c)if(e=c,Iv.test(e))s.id=c;else if(Lv(c)){const e=Tv(c);s.$or=[{created_by:{$regex:"^".concat(e,"$"),$options:"i"}},{owner_email:{$regex:"^".concat(e.toLowerCase(),"$")}}]}else{const e=Tv(c);s.$or=[{name:{$regex:e,$options:"i"}},{user_description:{$regex:e,$options:"i"}},{created_by:{$regex:e,$options:"i"}},{owner_email:{$regex:"^".concat(e.toLowerCase())}}]}const a=await zc.filter(s,"".concat(t,"updated_date"),w,(p-1)*w,["id","name","logo_url","user_description","created_date","updated_date","is_starred","owner_id","created_by"].join(","),T);n(e=>1===p?a:[...e,...a]),v(a.length===w),r(!1)}catch(t){r(!1)}var e},[u,c,w,p,T]),D=(0,Y.useRef)(c);D.current=c;const F=(0,Y.useMemo)(()=>(0,cc.debounce)(e=>{e!==D.current&&(g(1),n([]),d(e))},550),[]);(0,Y.useEffect)(()=>()=>F.cancel(),[F]),(0,Y.useEffect)(()=>{t&&R()},[R,C,t,_]);const O=a.filter(e=>!x||e.is_starred),U=async(e,t)=>{if(e.preventDefault(),e.stopPropagation(),y!==t.id){N(t.id);try{const e=!t.is_starred;await zc.update(t.id,{is_starred:e}),n(s=>s.map(s=>s.id===t.id?(0,ue.A)((0,ue.A)({},s),{},{is_starred:e}):s))}catch(a){s({title:"Failed to update star",description:"Please try again",variant:"destructive"})}finally{N(null)}}};if(l&&1===p)return(0,se.jsx)(Gv,{});const B=(()=>{const e=[];if(M)P&&e.push({value:wv.OWNED_BY_ME,label:"Owned by me"}),e.push({value:wv.MY_APPS_WORKSPACE,label:"My apps (personal workspace)"}),P&&e.push({value:wv.ALL_PLATFORM,label:"All apps (platform wide)"});else{const t=(null==A?void 0:A.name)||"workspace";P&&e.push({value:wv.OWNED_BY_ME,label:"Owned by me"}),e.push({value:wv.MY_APPS_WORKSPACE,label:"My apps in ".concat(t," workspace")}),(L||P)&&e.push({value:wv.ALL_APPS_WORKSPACE,label:"All apps in ".concat(t," workspace")}),P&&e.push({value:wv.ALL_PLATFORM,label:"All apps (platform wide)"})}return e})();return(0,se.jsx)("div",{className:"p-6 min-h-full",children:(0,se.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,se.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,se.jsx)("h2",{className:"text-3xl font-bold",children:"Apps"}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full md:w-auto",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,se.jsx)(nl,{type:"text",placeholder:"Search apps...",className:"pl-10 w-full sm:w-80",value:i,onChange:e=>{o(e.target.value),F(e.target.value)}})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[B.length>1?(0,se.jsxs)(br,{value:T,onValueChange:e=>{B.some(t=>t.value===e)&&(I(e),g(1),n([]))},children:[(0,se.jsx)(Nr,{className:"w-[300px]",children:(0,se.jsx)(yr,{placeholder:"Select filter"})}),(0,se.jsx)(kr,{children:B.map(e=>(0,se.jsx)(Ar,{value:e.value,children:e.label},e.value))})]}):(0,se.jsx)("div",{className:"flex items-center px-3 py-2 text-sm font-medium border rounded-md bg-muted/50",children:null===(e=B[0])||void 0===e?void 0:e.label}),(0,se.jsx)(zt,{variant:x?"default":"outline",onClick:()=>h(!x),children:(0,se.jsx)(fv.A,{className:de("h-4 w-4",x&&"fill-current")})}),(0,se.jsx)(zt,{variant:"outline",onClick:()=>{m("desc"===u?"asc":"desc"),g(1),n([])},children:"desc"===u?(0,se.jsx)(vv.A,{className:"h-4 w-4"}):(0,se.jsx)(bv.A,{className:"h-4 w-4"})}),(0,se.jsx)(zt,{variant:"outline",onClick:()=>{j(e=>"grid"===e?"table":"grid"),g(1),n([])},children:"grid"===b?(0,se.jsx)(jv.A,{className:"h-4 w-4"}):(0,se.jsx)(iv.A,{className:"h-4 w-4"})})]})]})]}),"grid"===b?(0,se.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:O.map(e=>(0,se.jsx)(Z.Link,{to:"/apps/".concat(e.id,"/editor/preview"),className:"block hover:shadow-lg transition-all duration-300 group",children:(0,se.jsxs)(Es,{className:"",children:[(0,se.jsx)(Ts,{children:(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)(us,{className:"h-12 w-12 rounded-xl",children:e.logo_url?(0,se.jsx)(ms,{src:e.logo_url,alt:"".concat(e.name," logo")}):(0,se.jsx)(xs,{className:"bg-primary/10",children:(0,se.jsx)(yv.A,{className:"h-6 w-6 text-primary"})})}),(0,se.jsx)("div",{className:"flex-1 min-w-0",children:(0,se.jsx)("h3",{className:"font-semibold text-lg line-clamp-2",children:e.name})}),(0,se.jsx)(zt,{variant:"ghost",size:"icon",className:de("h-8 w-8 shrink-0 transition-opacity",!e.is_starred&&"opacity-0 group-hover:opacity-100"),onClick:t=>U(t,e),disabled:y===e.id,children:y===e.id?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(fv.A,{className:de("h-4 w-4",e.is_starred&&"fill-yellow-400 text-yellow-400")})})]})}),(0,se.jsxs)(Ls,{children:[(0,se.jsxs)("p",{className:"text-muted-foreground mb-3 line-clamp-2",children:[e.user_description||"No description",e.user_description&&e.user_description.length>100&&(0,se.jsx)(Nv.A,{className:"inline ml-1 h-4 w-4"})]}),(0,se.jsxs)("div",{className:"text-xs text-muted-foreground flex flex-wrap gap-2",children:[(0,se.jsxs)("span",{children:["By ",e.created_by]}),(0,se.jsx)(Tr,{orientation:"vertical",className:"h-4"}),(0,se.jsxs)("span",{children:["Created ",He().utc(e.created_date).fromNow()]})]})]})]})},e.id))}):(0,se.jsx)(Es,{children:(0,se.jsx)(Ls,{className:"p-0",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{className:"w-16"})," ",(0,se.jsx)(hi,{children:"Name"}),(0,se.jsx)(hi,{children:"Description"}),(0,se.jsx)(hi,{children:"Created By"}),(0,se.jsx)(hi,{children:"Last Updated"}),(0,se.jsx)(hi,{className:"text-right",children:"Actions"})]})}),(0,se.jsx)(ui,{children:O.map(e=>(0,se.jsxs)(xi,{className:"group",children:[(0,se.jsx)(pi,{className:"p-2",children:(0,se.jsx)(us,{className:"h-10 w-10 rounded-md",children:e.logo_url?(0,se.jsx)(ms,{src:e.logo_url,alt:"".concat(e.name," logo")}):(0,se.jsx)(xs,{className:"bg-primary/10 rounded-md",children:(0,se.jsx)(yv.A,{className:"h-5 w-5 text-primary"})})})}),(0,se.jsx)(pi,{className:"font-medium py-2 pr-2",children:(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsx)(Z.Link,{to:"/apps/".concat(e.id,"/editor/preview"),className:"hover:underline line-clamp-2",children:e.name})})}),(0,se.jsx)(pi,{className:"text-muted-foreground py-2 pr-2 line-clamp-2",children:e.user_description||"-"}),(0,se.jsx)(pi,{className:"text-muted-foreground py-2 pr-2 whitespace-nowrap",children:e.created_by}),(0,se.jsx)(pi,{className:"text-muted-foreground py-2 pr-2 whitespace-nowrap",children:He().utc(e.updated_date).fromNow()}),(0,se.jsx)(pi,{className:"py-2 pl-2 text-right",children:(0,se.jsx)(zt,{variant:"ghost",size:"icon",className:de("transition-opacity",!e.is_starred&&"opacity-0 group-hover:opacity-100"),onClick:t=>U(t,e),disabled:y===e.id,children:y===e.id?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(fv.A,{className:de("h-4 w-4",e.is_starred&&"fill-yellow-400 text-yellow-400")})})})]},e.id))})]})})}),0===O.length&&!l&&(0,se.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"No apps found matching your criteria"}),O.length>0&&(0,se.jsxs)("div",{className:"flex justify-center gap-2 mt-8",children:[(0,se.jsx)(zt,{variant:"outline",onClick:()=>g(e=>Math.max(1,e-1)),disabled:1===p,children:"Previous"}),(0,se.jsx)(zt,{variant:"outline",onClick:()=>g(e=>e+1),disabled:!f,children:"Next"})]}),l&&p>1&&(0,se.jsx)("div",{className:"flex justify-center items-center py-4",children:(0,se.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})})]})})};var $v=s(32443),Zv=s(86805),Jv=s(74878),Qv=s(40978),Xv=s(65330),eb=s(29975),tb=s(78419);const sb=(0,Y.createContext)();function ab(){const e=(0,Y.useContext)(sb);if(void 0===e)throw new Error("useActivity must be used within an ActivityProvider");return e}const nb=function(e){let{children:t}=e;const[s,a]=(0,Y.useState)({}),[n,l]=(0,Y.useState)(0);(0,Y.useEffect)(()=>{const e=e=>{const{type:t,requestId:s,logId:n,data:r}=e.data||{};if("api-request-start"===t)a(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:{id:s,type:"request",url:r.url,method:r.method,headers:r.headers,body:r.body,startTime:new Date,status:"pending"}})),l(e=>e+1);else if("api-request-end"===t)a(e=>{const t=e[s];return t?(0,ue.A)((0,ue.A)({},e),{},{[s]:(0,ue.A)((0,ue.A)({},t),{},{status:"completed",statusCode:r.statusCode,response:r.response,endTime:new Date,duration:t.startTime?new Date-t.startTime:0})}):e}),l(e=>Math.max(0,e-1));else if("console-log"===t){const e=new Date;a(t=>(0,ue.A)((0,ue.A)({},t),{},{[n]:{id:n,type:"log",message:r.message,severity:r.severity,component:r.component,timestamp:e}}))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);const r=Object.values(s);return(0,se.jsx)(sb.Provider,{value:{allActivities:r,activeRequests:n,clearActivities:()=>a({})},children:t})},lb=ab;function rb(e){let{children:t}=e;const{app:s,isLoading:a}=lp(),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)([]),[o,c]=(0,Y.useState)(!0),[d,u]=(0,Y.useState)(!0),[m,x]=(0,Y.useState)(null),h=(0,Y.useMemo)(()=>(null==s?void 0:s.organization_id)||null,[null==s?void 0:s.organization_id]),p=(0,Y.useMemo)(()=>{if(!h||!r.length)return null;return r.find(e=>e.id===h)||null},[h,r]);(0,Y.useEffect)(()=>((0,me.r8)(()=>h),()=>{const e=localStorage.getItem("activeWorkspaceId");e&&(0,me.r8)(()=>e)}),[h]),(0,Y.useEffect)(()=>{l(p)},[p]);const g=(0,Y.useCallback)(async()=>{try{u(!0),x(null);const e=await Hd.getWorkspaces();i(e.workspaces||e||[])}catch(e){x(e),i([])}finally{u(!1)}},[]);(0,Y.useEffect)(()=>{g()},[g]),(0,Y.useEffect)(()=>{c(a||d)},[a,d]);const f=(0,Y.useCallback)(e=>{},[]),v=(0,Y.useCallback)(()=>{},[]),b={activeWorkspace:n,activeWorkspaceId:h,workspaces:r,isLoading:o,isLoadingWorkspaces:d,error:m,switchActiveWorkspace:f,clearActiveWorkspace:v,refetchWorkspaces:g};return(0,se.jsx)(Vd.Provider,{value:b,children:t})}var ib=s(68432),ob=s(81830),cb=s(52180),db=s(89796),ub=s(72128),mb=s(10743),xb=s(67637),hb=s(70446),pb=s(35023);const gb=e=>{let{originalCode:t="",modifiedCode:s="",language:a="javascript",title:n="Code Comparison",diffViewStyle:l="default"}=e;const r={readOnly:!0,renderSideBySide:!0,wordWrap:"on",scrollBeyondLastLine:!1,minimap:{enabled:!1},lineNumbers:"on",diffWordWrap:"on"},i="github"===l?"light":"vs";return(0,se.jsxs)(Es,{className:"w-full shadow-md",children:[(0,se.jsx)(Ts,{className:"pb-2",children:(0,se.jsx)(Is,{className:"text-lg font-medium",children:n})}),(0,se.jsx)(Ls,{children:(0,se.jsxs)(ji,{defaultValue:"diff",className:"w-full",children:[(0,se.jsxs)(yi,{className:"mb-2",children:[(0,se.jsx)(Ni,{value:"diff",children:"Diff View"}),(0,se.jsx)(Ni,{value:"original",children:"Original"}),(0,se.jsx)(Ni,{value:"modified",children:"Modified"})]}),(0,se.jsx)(wi,{value:"diff",className:"w-full",children:(0,se.jsx)("div",{className:"h-[500px] border rounded-md overflow-hidden",children:(0,se.jsx)(pb.zC,{height:"100%",language:a,original:t,modified:s,options:r,theme:i})})}),(0,se.jsx)(wi,{value:"original",children:(0,se.jsx)("div",{className:"h-[500px] border rounded-md overflow-hidden",children:(0,se.jsx)(pb.zC,{height:"100%",language:a,original:t,modified:t,options:(0,ue.A)((0,ue.A)({},r),{},{renderSideBySide:!1}),theme:i})})}),(0,se.jsx)(wi,{value:"modified",children:(0,se.jsx)("div",{className:"h-[500px] border rounded-md overflow-hidden",children:(0,se.jsx)(pb.zC,{height:"100%",language:a,original:s,modified:s,options:(0,ue.A)((0,ue.A)({},r),{},{renderSideBySide:!1}),theme:i})})})]})})]})};function fb(e){let{msgId:t,isOpen:s,onClose:a}=e;const{user:n}=wd(),{app:l}=lp(),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!0),[d,u]=(0,Y.useState)("diff"),[m,x]=(0,Y.useState)(!1),h=gu.useMessages(),p=h.findIndex(e=>e.id===t),g=h[p],f=null!=g&&g.checkpoint_id?g:h.slice(p+1).find(e=>"assistant"===e.role&&e.checkpoint_id),v=null!=g&&g.content?Qu(g.content,"action"):[],b=async e=>{try{return await Zu.getCheckpointFileTree(l.id,e)}catch(t){return null}};(0,Y.useEffect)(()=>{(async()=>{if(c(!0),!f||!f.checkpoint_id)return void c(!1);const e=h.findIndex(e=>e.id===f.id),t=h.slice(0,e).reverse().find(e=>e.checkpoint_id),s=await b(f.checkpoint_id);let a=null;t&&t.checkpoint_id&&(a=await b(t.checkpoint_id));const n={};s&&a?(Object.entries(s.files).forEach(e=>{let[t,s]=e;const l=a.files[t];l&&JSON.stringify(l)===JSON.stringify(s)||(n[t]={original:l?"string"==typeof l?l:JSON.stringify(l,null,2):"",modified:"string"==typeof s?s:JSON.stringify(s,null,2),type:l?"modified":"added"})}),Object.keys(a.files).forEach(e=>{if(!s.files[e]){const t=a.files[e];n[e]={original:"string"==typeof t?t:JSON.stringify(t,null,2),modified:"",type:"deleted"}}})):s&&Object.entries(s.files).forEach(e=>{let[t,s]=e;n[t]={original:"",modified:"string"==typeof s?s:JSON.stringify(s,null,2),type:"added"}}),i(n),c(!1)})()},[t,l.id,p]);const j=()=>{null!=g&&g.content&&(navigator.clipboard.writeText(g.content),x(!0),setTimeout(()=>x(!1),2e3))};return(0,se.jsx)(ma,{open:s,onOpenChange:a,children:(0,se.jsxs)(fa,{className:"max-w-5xl max-h-[95vh] p-0 overflow-hidden flex flex-col border border-gray-200 rounded-md",children:[(0,se.jsx)(va,{className:"px-4 py-3 border-b border-gray-200 bg-gray-50 flex flex-row items-center justify-between",children:(0,se.jsx)(ja,{className:"text-base font-medium",children:"Message Details"})}),(0,se.jsxs)(ji,{defaultValue:"diff",className:"flex-1 flex flex-col overflow-hidden",onValueChange:u,children:[(0,se.jsxs)(yi,{className:"px-4 pt-2 bg-white border-b border-gray-200",children:[(0,se.jsxs)(Ni,{value:"diff",className:"flex items-center",children:[(0,se.jsx)(Jv.A,{className:"h-4 w-4 mr-2"}),"Code Changes"]}),$p(n.platform_role)&&(0,se.jsxs)(Ni,{value:"info",className:"flex items-center",children:[(0,se.jsx)(Xx.A,{className:"h-4 w-4 mr-2"}),"Message Info"]})]}),(0,se.jsx)(wi,{value:"diff",className:"flex-1 overflow-auto p-0 m-0",children:o?(0,se.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin text-gray-500"}),(0,se.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading changes..."})]}):r&&0!==Object.keys(r).length?(0,se.jsx)("div",{className:"divide-y divide-gray-200",children:Object.entries(r).map((e,t)=>{let[s,a]=e;return(0,se.jsxs)("div",{className:"bg-white",children:[(0,se.jsxs)("div",{className:"flex items-center px-4 py-2 bg-gray-50 border-b border-gray-200",children:[(0,se.jsx)(xb.A,{className:"h-4 w-4 mr-2 text-gray-600"}),(0,se.jsx)("span",{className:"font-medium text-sm text-gray-700",children:s}),(0,se.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full ".concat("added"===a.type?"bg-green-50 text-green-600 border border-green-100":"deleted"===a.type?"bg-red-50 text-red-600 border border-red-100":"bg-blue-50 text-blue-600 border border-blue-100"),children:a.type})]}),(0,se.jsx)("div",{className:"px-0",children:(0,se.jsx)(gb,{originalCode:a.original,modifiedCode:a.modified,language:s.endsWith(".css")?"css":"javascript",title:s,diffViewStyle:"github"})})]},t)})}):(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[(0,se.jsx)(ad.A,{className:"h-10 w-10 mb-3 text-gray-400"}),(0,se.jsx)("p",{children:"No file changes detected for this message."})]})}),$p(n.platform_role)&&(0,se.jsx)(wi,{value:"info",className:"flex-1 overflow-auto p-0 m-0",children:g?g?(0,se.jsxs)("div",{className:"p-4 space-y-4",children:[(0,se.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white",children:[(0,se.jsxs)("div",{className:"bg-gray-50 p-3 border-b border-gray-200 flex justify-between items-center",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Message Attributes"}),(0,se.jsx)("button",{onClick:j,className:"flex items-center text-xs text-gray-600 hover:text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 rounded px-2 py-1 transition-colors",children:m?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ds.A,{className:"h-3.5 w-3.5 mr-1"}),"Copied!"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ob.A,{className:"h-3.5 w-3.5 mr-1"}),"Copy Content"]})})]}),(0,se.jsx)("div",{className:"p-4 space-y-2",children:Object.entries(g).filter(e=>{let[t]=e;return"content"!==t}).map(e=>{let[t,s]=e;return(0,se.jsxs)("div",{className:"flex",children:[(0,se.jsxs)("span",{className:"font-medium text-gray-700 min-w-[120px]",children:[t,":"]}),(0,se.jsx)("span",{className:"text-gray-600 break-all",children:"object"==typeof s?JSON.stringify(s):String(s)})]},t)})})]}),(0,se.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white",children:[(0,se.jsx)("div",{className:"bg-gray-50 p-3 border-b border-gray-200",children:(0,se.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Actions (",v.length,")"]})}),(0,se.jsx)("div",{className:"divide-y divide-gray-200",children:0===v.length?(0,se.jsx)("div",{className:"p-4 text-gray-500 text-center",children:"No actions found in this message"}):v.map((e,t)=>{const s=e.openingTag.match(/action-type="([^"]*)"/)||e.openingTag.match(/type="([^"]*)"/),a=s?s[1]:"Unknown";return(0,se.jsxs)("div",{className:"p-4",children:[(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsxs)("span",{className:"font-medium text-gray-700",children:["Action ",t+1,":"]}),(0,se.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-blue-50 text-blue-600 border border-blue-100",children:a})]}),(0,se.jsxs)("div",{className:"mt-2",children:[(0,se.jsx)("div",{className:"font-medium text-sm text-gray-700 mb-1",children:"Content:"}),(0,se.jsx)("pre",{className:"bg-gray-50 p-2 rounded text-xs overflow-x-auto",children:e.content})]})]},t)})})]})]}):null:(0,se.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,se.jsx)(ad.A,{className:"h-10 w-10 mb-3 text-gray-400"}),(0,se.jsx)("span",{className:"ml-2 text-gray-600",children:"Message not found"})]})})]})]})})}let vb=0;const bb=new Map,jb=e=>{if(bb.has(e))return;const t=setTimeout(()=>{bb.delete(e),_b({type:"REMOVE_TOAST",toastId:e})},1e6);bb.set(e,t)},yb=(e,t)=>{switch(t.type){case"ADD_TOAST":return(0,ue.A)((0,ue.A)({},e),{},{toasts:[t.toast,...e.toasts].slice(0,1)});case"UPDATE_TOAST":return(0,ue.A)((0,ue.A)({},e),{},{toasts:e.toasts.map(e=>e.id===t.toast.id?(0,ue.A)((0,ue.A)({},e),t.toast):e)});case"DISMISS_TOAST":{const{toastId:s}=t;return s?jb(s):e.toasts.forEach(e=>{jb(e.id)}),(0,ue.A)((0,ue.A)({},e),{},{toasts:e.toasts.map(e=>e.id===s||void 0===s?(0,ue.A)((0,ue.A)({},e),{},{open:!1}):e)})}case"REMOVE_TOAST":return void 0===t.toastId?(0,ue.A)((0,ue.A)({},e),{},{toasts:[]}):(0,ue.A)((0,ue.A)({},e),{},{toasts:e.toasts.filter(e=>e.id!==t.toastId)})}},Nb=[];let wb={toasts:[]};function _b(e){wb=yb(wb,e),Nb.forEach(e=>{e(wb)})}function kb(e){let t=Object.assign({},((0,fs.A)(e),e));const s=(vb=(vb+1)%Number.MAX_SAFE_INTEGER,vb.toString()),a=()=>_b({type:"DISMISS_TOAST",toastId:s});return _b({type:"ADD_TOAST",toast:(0,ue.A)((0,ue.A)({},t),{},{id:s,open:!0,onOpenChange:e=>{e||a()}})}),{id:s,dismiss:a,update:e=>_b({type:"UPDATE_TOAST",toast:(0,ue.A)((0,ue.A)({},e),{},{id:s})})}}function Cb(){const[e,t]=Y.useState(wb);return Y.useEffect(()=>(Nb.push(t),()=>{const e=Nb.indexOf(t);e>-1&&Nb.splice(e,1)}),[e]),(0,ue.A)((0,ue.A)({},e),{},{toast:kb,dismiss:e=>_b({type:"DISMISS_TOAST",toastId:e})})}var Ab=s(22796);const Sb=e=>{let{content:t}=e;const{updateSecrets:s,existingSecretNames:a,addChatMessage:n}=lp(),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)({}),[c,d]=(0,Y.useState)(!1),{toast:u}=Cb(),m=Array.isArray(t)?t:[],x=m.map(e=>e.secretName).filter(Boolean),h=x.filter(e=>a&&a.includes(e)),p=h.length===x.length&&x.length>0,g=h.length>0&&h.length<x.length;if(!m.length)return null;return(0,se.jsxs)(ma,{open:l,onOpenChange:e=>{r(e),e||o({})},children:[(0,se.jsx)(xa,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"outline",size:"sm",className:"flex items-center gap-2 ".concat(p?"text-teal-600 border-teal-200 hover:bg-teal-50 hover:text-teal-700":g?"text-amber-600 border-amber-200 hover:bg-amber-50 hover:text-amber-700":"text-blue-600 border-blue-200 hover:bg-blue-50 hover:text-blue-700"),children:[p?(0,se.jsx)(hb.A,{size:16}):(0,se.jsx)(Ab.A,{size:16}),g&&(0,se.jsx)(ad.A,{size:16}),(()=>{const e=p?"Update":"Set";if(1===x.length){const e=a&&a.includes(x[0]);return"".concat(e?"Update":"Set"," ").concat(x[0]," secret")}return"".concat(e," secrets: ").concat(x.join(", "))})(),g&&" (".concat(h.length,"/").concat(x.length," set)")]})}),(0,se.jsxs)(fa,{className:"sm:max-w-md",children:[(0,se.jsxs)(va,{children:[(0,se.jsxs)(ja,{className:"text-teal-700",children:[p?"Update":"Set"," ",x.length>1?"Secrets":"".concat(x[0]," Secret")]}),(0,se.jsx)(ya,{children:"Enter the values for the required secrets."})]}),(0,se.jsxs)("form",{onSubmit:async e=>{e.preventDefault();if(Object.values(i).some(e=>!e.trim()))u({variant:"destructive",title:"Secret values required",description:"Please enter values for all secrets"});else{d(!0);try{await s(i);const e=Object.keys(i).filter(e=>!a.includes(e));if(e.length>0){const t=e.join(", ");n({role:"user",content:"I've added ".concat(t," secrets")})}r(!1),o({}),u({title:"Secrets updated successfully",description:"The secrets have been set."})}catch(t){u({variant:"destructive",title:"Failed to set secrets",description:t.message||"An error occurred while setting the secrets"})}finally{d(!1)}}},children:[(0,se.jsx)("div",{className:"grid gap-6 py-4",children:m.map((e,t)=>(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"secret-".concat(t),className:"block font-medium text-slate-700",children:e.secretName}),(0,se.jsx)(nl,{id:"secret-".concat(t),type:"password",value:i[e.secretName]||"",onChange:t=>{return s=e.secretName,a=t.target.value,void o(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:a}));var s,a},className:"w-full",placeholder:e.description||"Enter ".concat(e.secretName," value"),autoComplete:"off"}),e.description&&(0,se.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:e.description})]},t))}),(0,se.jsxs)(ba,{className:"gap-2 sm:gap-0",children:[(0,se.jsx)(zt,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:c,className:"border-slate-300 text-slate-700",children:"Cancel"}),(0,se.jsx)(zt,{type:"submit",disabled:c,className:"bg-teal-600 hover:bg-teal-700 text-white",children:c?"Saving...":"Save Secrets"})]})]})]})]})};function Eb(e){return null==e?void 0:e.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'").replace(/&apos;/g,"'")}const Tb=["node"],Ib=["node"],Pb=["node"];function Lb(e){let{msgId:t,title:s,children:a}=e;const[n,l]=(0,Y.useState)(!1);return(0,se.jsxs)("div",{className:"action-component action-group bg-white rounded-lg p-4 my-4 cursor-pointer","data-title":s,children:[(0,se.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-4 pb-2 border-b border-gray-100",children:[(0,se.jsx)("h3",{className:"font-medium text-gray-800",children:s}),(0,se.jsx)("div",{className:"flex items-center",children:(0,se.jsxs)(yn,{children:[(0,se.jsx)(Nn,{className:"flex items-center justify-center p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:(0,se.jsx)(mb.A,{size:16})}),(0,se.jsx)(En,{align:"end",children:(0,se.jsxs)(Tn,{onClick:e=>{e.stopPropagation(),l(!0)},className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(xb.A,{size:14,className:"text-gray-400"}),(0,se.jsx)("span",{children:"View Changes"})]})})]})})]}),(0,se.jsx)("div",{className:"space-y-3",children:a}),n&&(0,se.jsx)(fb,{msgId:t,isOpen:n,onClose:e=>l(!1)})]})}function Mb(e){let{title:t,details:s,"component-name":a,"data-content":n}=e;const[l,r]=Y.useState(!1);let i="";if(n)try{i=decodeURIComponent(escape(atob(n)))}catch(x){}const o=Eb(t),c=Eb(s),d=Eb(a),u=Eb(i),m=c||u;return(0,se.jsxs)("div",{className:"my-4 rounded-lg border border-red-200 bg-red-50",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 p-4 cursor-pointer",onClick:()=>r(!l),children:[(0,se.jsx)("div",{className:"text-red-500",children:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,se.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,se.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"font-medium text-red-700",children:o}),d&&(0,se.jsxs)("p",{className:"text-sm text-red-600",children:["in ",d]})]}),(0,se.jsx)("div",{className:"transition-transform ".concat(l?"rotate-180":""),children:(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,se.jsx)("polyline",{points:"6 9 12 15 18 9"})})})]}),l&&m&&(0,se.jsx)("div",{className:"px-4 pb-4 pt-0",children:(0,se.jsx)("div",{className:"p-3 bg-white rounded border border-red-100 font-mono text-sm text-red-800 whitespace-pre-wrap",children:m})})]})}const Rb=e=>{const t=e.split("/"),s=t[0];let a=t[t.length-1];return a.includes(".")&&(a=a.split(".").slice(0,-1).join(" ")),{name:a,artifactType:s}};function Db(e){let{node:t}=e;const{app:s}=lp(),a=(0,J.Zp)(),n=t.properties["action-type"]||t.properties.type;if("requestsecrets"===(null==n?void 0:n.toLowerCase())){let e;try{e=JSON.parse(atob(t.properties.dataContent))}catch(u){e=[]}return(0,se.jsx)(Sb,{content:e})}let l=(null==n?void 0:n.replace(/(_)/g," ").replace(/\b\w/g,e=>e.toUpperCase()))||"";"file"===n&&t.properties.filepath&&(l=(e=>{const{name:t,artifactType:s}=Rb(e);return"components"===s?"".concat(t," component"):"pages"===s?"".concat(t," page"):"entities"===s?"".concat(t," entity"):t.toLowerCase().includes("layout")?"Layout":"".concat(s," - ").concat(t)})(t.properties.filepath)),"insertentityrecords"===(null==n?void 0:n.toLowerCase())&&t.properties.dataInsertRecordsLength&&(l="Insert ".concat(t.properties.dataInsertRecordsLength," ").concat(t.properties.dataEntityName," Records"));const r=!0===t.properties.dataIsComplete||"true"===t.properties.dataIsComplete,i=t.properties.dataContentLength;let o=r?100:0;if(!r&&"file"===n&&t.properties.filepath){var c,d;const e=t.properties.filepath,{name:a,artifactType:n}=Rb(e),l=(null===(c=s[n])||void 0===c||null===(d=c[a])||void 0===d?void 0:d.length)||15e3;o=Math.round(i/l*100),o=o>100?100:o}return(0,se.jsxs)("div",{className:"action-component action-step flex flex-col px-3 py-2 rounded-md hover:bg-gray-100 transition-colors","data-type":t.properties.dataActionType,"data-title":t.properties.dataTitle,onClick:()=>{if("file"===n&&t.properties.filepath){const e=t.properties.filepath;if(e.startsWith("agents/")){let t=e.split("/").pop();t.endsWith(".json")&&(t=t.slice(0,-5)),a("/apps/".concat(s.id,"/editor/workspace/agents?agent=").concat(t))}else a("/apps/".concat(s.id,"/editor/workspace/code?filePath=").concat(t.properties.filepath))}},children:[(0,se.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[!0===r||"true"===r?(0,se.jsx)(hb.A,{className:"w-4 h-4 text-green-500"}):(0,se.jsx)("div",{className:"relative w-4 h-4",children:(0,se.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"#e5e7eb",strokeWidth:"2"}),(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:"".concat(2*Math.PI*10),strokeDashoffset:"".concat(2*Math.PI*10*(1-o/100)),transform:"rotate(-90 12 12)",style:{transition:"stroke-dashoffset 0.3s ease"}})]})}),(0,se.jsx)("span",{className:"text-sm text-gray-700",children:t.properties.title||"Editing "+l})]}),"file"===n&&t.properties.filepath&&t.properties.filepath.startsWith("functions/")&&(0,se.jsx)("div",{className:"text-gray-400",children:(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,se.jsx)("path",{d:"m9 18 6-6-6-6"})})})]}),(0,se.jsx)("span",{className:"text-xs text-gray-400 ml-6",children:l})]})}function Fb(e){return e&&e.match(/<[^>]*>|\s+|[^\s<]+|</g)||[]}function Ob(e){let{content:t,msgId:s,role:a,onTypingStateChange:n}=e;const l="assistant"===a,{displayedContent:r,isTyping:i}=function(e,t){const[s,a]=(0,Y.useState)(""),[n,l]=(0,Y.useState)(!1),r=(0,Y.useRef)(""),i=(0,Y.useRef)(null),o=(0,Y.useRef)(!0),c=(0,Y.useRef)(""),d=(0,Y.useMemo)(()=>Fb(e),[e]);return(0,Y.useEffect)(()=>{if(o.current){o.current=!1;const t=!e||e.length<c.current.length?c.current:e;return a(t),void(c.current=t)}if(!t)return a(e),void(c.current=e);if(e!==r.current){if(i.current&&(clearTimeout(i.current),i.current=null),c.current&&(!e||e.length<c.current.length))return void l(!1);if(r.current=e,e.startsWith(s.slice(0,50))||(a(""),c.current=""),s.length>=.95*((null==e?void 0:e.length)||0))return a(e),c.current=e,void l(!1)}if(s===e)return c.current=e,void l(!1);l(!0);const n=()=>{let t=!1,s=0;a(a=>{const n=Fb(a).length+1;if(n>=d.length)return c.current=e,e;t=!0,s=5*Math.random()*2-5+10;const l=d.slice(0,n).join("");return c.current=l,l}),t?i.current=setTimeout(n,s):l(!1)},u=10+5*Math.random();return i.current=setTimeout(n,u),()=>{i.current&&clearTimeout(i.current)}},[e,d,t,s]),{displayedContent:t?c.current&&(!e||e.length<c.current.length)?c.current:s:e,isTyping:n}}(t,l);(0,Y.useEffect)(()=>{n&&n(i)},[i,n]);const o=function(e){if(!e)return[{id:"empty",content:"",allowRawHtml:!1}];const t=[],s=Qu(e,"action_group");for(const c of s){const s=c.openingTagIndex,a=Ju(c,"</action_group>",e.length),n=tm(e.slice(s,a));t.push({start:s,end:a,processedContent:n})}const a=Qu(e,"action");for(const c of a){const s=c.openingTagIndex,a=Ju(c,"</action>",e.length);if(!t.some(e=>s>=e.start&&a<=e.end)){const e=em(c);e&&t.push({start:s,end:a,processedContent:e})}}const n=/<error(\s[^>]*)?>([\s\S]*?)<\/error>/g;let l;for(;null!==(l=n.exec(e));){const e=l.index,s=e+l[0].length;if(!t.some(t=>e>=t.start&&s<=t.end)){const a=sm(l[1],l[2]);t.push({start:e,end:s,processedContent:a})}}t.sort((e,t)=>e.start-t.start);const r=t.filter(e=>!t.some(t=>t!==e&&t.start<=e.start&&t.end>=e.end)),i=[];let o=0;for(const c of r)c.start>o&&i.push({id:"text-".concat(o),content:e.slice(o,c.start),allowRawHtml:!1}),i.push({id:"trusted-".concat(c.start),content:c.processedContent,allowRawHtml:!0}),o=c.end;return o<e.length&&i.push({id:"text-".concat(o),content:e.slice(o),allowRawHtml:!1}),i}(r),c={div:e=>{var t;let{node:a}=e,n=(0,Nt.A)(e,Tb),l=(null===(t=a.properties)||void 0===t?void 0:t.className)||"";if(Array.isArray(l)&&(l=l.join(" ")),"string"==typeof l&&l.includes("action-component")){if(l.includes("action-group"))return(0,se.jsx)(Lb,(0,ue.A)({msgId:s,title:a.properties.dataTitle},n));if(l.includes("action-single"))return(0,se.jsx)(Db,(0,ue.A)({node:a},n))}return l.includes("error-component")?(0,se.jsx)(Mb,(0,ue.A)({},n)):(0,se.jsx)("div",(0,ue.A)({},n))},action:e=>{let{node:t}=e,s=(0,Nt.A)(e,Ib);return(0,se.jsx)(Db,(0,ue.A)({node:t},s))},diff:e=>{let{node:t}=e,s=(0,Nt.A)(e,Pb);return(0,se.jsx)("code",(0,ue.A)({},s))}},d="user"===a&&!r.includes("<error");return(0,se.jsx)("div",{dir:"auto",className:"prose dark:prose-invert max-w-none base44-markdown relative",children:o.map(e=>(0,se.jsx)(db.oz,{rehypePlugins:d?[]:e.allowRawHtml?[ub.A]:[],remarkPlugins:d?[]:[cb.A],components:c,children:e.content.replace(/ref=/g,"ref__=")},e.id))})}const Ub=Y.memo(Ob);const Bb=function(e){let{message:t}=e;const[s,a]=(0,Y.useState)(!1);return(0,se.jsxs)("div",{className:"text-sm p-4 bg-white mx-auto mb-6 rounded-lg mb-6 border border-gray-300",children:[(0,se.jsxs)("div",{className:"text-gray-700",children:["Some errors were detected, base44 will try to fix them automatically."," ",(0,se.jsx)("div",{className:"mt-2",children:(0,se.jsx)("a",{className:"text-teal-900/70 hover:underline cursor-pointer",onClick:()=>a(!s),children:s?"hide errors":"see errors"})})]}),s&&(0,se.jsx)("div",{className:"mt-4",children:(0,se.jsx)(Ub,{content:t.content})})]})};var zb=s(50270),Hb=s(78968),Vb=s(97820),Wb=s(26209);const qb={div:(0,se.jsx)(zb.A,{className:"h-3 w-3"}),button:(0,se.jsx)(Hb.A,{className:"h-3 w-3"}),p:(0,se.jsx)(Vb.A,{className:"h-3 w-3"}),h1:(0,se.jsx)(Wb.A,{className:"h-3 w-3"}),h2:(0,se.jsx)(Wb.A,{className:"h-3 w-3"}),h3:(0,se.jsx)(Wb.A,{className:"h-3 w-3"}),h4:(0,se.jsx)(Wb.A,{className:"h-3 w-3"}),h5:(0,se.jsx)(Wb.A,{className:"h-3 w-3"})};var Yb=s(99189);const Gb=function(e){let{message:t}=e;const{app:s}=lp(),a=uh();return(0,se.jsxs)("div",{className:"text-sm p-4 bg-white mx-auto mb-6 rounded-lg mb-6 relative",children:[(0,se.jsx)("div",{className:"text-gray-700",children:"Files have been manually edited."}),(0,se.jsx)("div",{className:"cursor-pointer absolute bottom-[-10px] right-0 bg-white border border-gray-100 rounded-md p-1 text-xs text-gray-400",children:(0,se.jsxs)("a",{onClick:async()=>{window.confirm("Are you sure you want to revert these manual edits? This will undo all changes made in this edit.")&&(Tu("User clicked - revert this",{app_id:null==s?void 0:s.id,message_id:t.id}),Vu(a,{cta:"revert this",origin:"manual_editing_message",message_id:t.id,target_route:null}),await zc.undoMessage(s.id,t.id))},className:"flex items-center gap-1",children:[(0,se.jsx)(Yb.A,{className:"h-3 w-3"}),"Revert this"]})})]})};var Kb=s(83542);const $b=s.p+"static/media/github.c786f5023c1da91ad7e9ad210c78662f.svg",Zb=e=>{let{className:t="w-5 h-5"}=e;return(0,se.jsx)("span",{className:t,style:{display:"inline-block",backgroundColor:"currentColor",WebkitMaskImage:"url(".concat($b,")"),WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center",maskImage:"url(".concat($b,")"),maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center"}})};function Jb(e){let{open:t,onOpenChange:s,onConfirm:a,isDisconnecting:n,message:l="This will disable sync for all apps connected to your GitHub account. You can reconnect at any time."}=e;return(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsxs)(Hg,{children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Disconnect GitHub?"}),(0,se.jsx)(Yg,{className:"text-foreground",children:l})]}),(0,se.jsxs)(Wg,{children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>s(!1),disabled:n,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:a,disabled:n,className:"bg-red-600 hover:bg-red-700 text-white",children:n?"Disconnecting...":"Disconnect"})]})]})})}function Qb(e){let{isOpen:t=!1,onClose:s=()=>{},onConfirm:a,isConnecting:n}=e;return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&s(),children:(0,se.jsxs)(Hg,{className:"max-w-[425px] p-6 gap-4",children:[(0,se.jsx)(Vg,{className:"gap-1.5",children:(0,se.jsx)(qg,{className:"text-lg font-semibold leading-none text-[#0A0A0A]",children:"GitHub Connection"})}),(0,se.jsxs)("p",{className:"text-sm leading-5 text-black",children:["When you connect GitHub, your app's code is moved to your GitHub repository. Refreshing the builder keeps your app in sync with GitHub.",(0,se.jsx)("br",{}),"The connection is permanent and can't be removed."]}),(0,se.jsxs)(Wg,{className:"gap-2 sm:gap-2",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:s,disabled:n,className:"h-9 px-4 border-[#E5E5E5] shadow-sm",children:"Cancel"}),(0,se.jsx)(Bx,{onClick:a,disabled:n,className:"h-9 px-4 bg-[#171717] hover:bg-[#262626] text-[#FAFAFA] shadow-sm",children:n?"Connecting...":"Connect GitHub"})]})]})})}function Xb(){var e,t,s,a,n;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{enabled:r=!0}=l,[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(r),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(null),b=(0,Y.useCallback)(()=>{v(null)},[]),j=uh(),y=(0,Y.useCallback)(async()=>{if(r){d(!0),m(null);try{const e=await hm.getOAuthStatus();o(e)}catch(e){m("Failed to fetch GitHub connection status"),o(null)}finally{d(!1)}}},[r]);(0,Y.useEffect)(()=>{r?y():(o(null),d(!1),m(null))},[r,y]);const N=(0,Y.useCallback)(async()=>{if(!r)return!1;h(!0),v(null);try{const e=await hm.initiateOAuth();return await pm(e.authorization_url,{provider:"github",width:800,height:600}),gx(j,{result:ox.Success}),await y(),$.default.success("GitHub connected successfully!"),!0}catch(e){const t=e;if("popup_blocked"===t.reason)v("Please allow popups to connect GitHub"),gx(j,{result:ox.Failure,error_reason:"popup_blocked",error_message:"Popup blocked"}),$.default.error("Popup blocked. Please allow popups and try again.");else if("closed_by_user"===t.reason)gx(j,{result:ox.Cancelled});else if("oauth_error"===t.reason){const e=t.message||"Connection failed. Please try again.";v(e),gx(j,{result:ox.Failure,error_reason:"oauth_error",error_message:e}),$.default.error(e)}else v("Failed to connect GitHub. Please try again."),gx(j,{result:ox.Failure,error_reason:"unknown",error_message:e instanceof Error?e.message:"Unknown error"}),$.default.error("Failed to connect GitHub. Please try again.");return!1}finally{h(!1)}},[r,y,j]),w=(0,Y.useCallback)(async()=>{if(r){g(!0);try{await hm.disconnectOAuth(),await y(),$.default.success("GitHub disconnected successfully")}catch(e){$.default.error("Failed to disconnect GitHub. Please try again.")}finally{g(!1)}}},[r,y]),_=null!==(e=null==i?void 0:i.status)&&void 0!==e?e:null,k=gm({connected:null!==(t=null==i?void 0:i.connected)&&void 0!==t&&t,oauthStatus:_});return{connected:null!==(s=null==i?void 0:i.connected)&&void 0!==s&&s,oauthStatus:_,hasConnectionError:k,githubUsername:null!==(a=null==i?void 0:i.github_username)&&void 0!==a?a:null,githubEmail:null!==(n=null==i?void 0:i.github_email)&&void 0!==n?n:null,isLoading:c,error:u,refetch:y,isConnecting:x,isDisconnecting:p,connect:N,disconnect:w,connectionError:f,clearConnectionError:b}}const ej=()=>{const{user:e}=wd();return{hasFlag:t=>{var s;return(null==e||null===(s=e.feature_flags)||void 0===s?void 0:s.includes(t))||!1}}},tj="github-two-ways-integration",sj="github-two-ways-integration-allow-disconnect",aj="show-scheduled-tasks",nj="mobile-builds",lj="superbowl-us-user-exposure",rj="superbowl-banner-enabled",ij="gdpr-user-delete",oj="unchained-code-view",cj="block-legacy-apps-in-builder";function dj(){return(0,se.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M13.6324 0.0176C13.8225 0.0458 14.0074 0.1077 14.1773 0.2012C14.401 0.3244 14.5928 0.4993 14.7388 0.7109L16.7 4L16.7029 4.0039C16.8853 4.266 16.9881 4.5759 16.9998 4.8945L16.9988 5.0322C16.982 5.3989 16.8449 5.7496 16.6101 6.0283L16.6082 6.0312L16.6072 6.0303L9.7232 15.4053L9.7212 15.4033C9.5775 15.5854 9.3974 15.734 9.191 15.8369C8.9763 15.9439 8.7401 16 8.5015 16C8.2629 16 8.0267 15.9439 7.8121 15.8369C7.6057 15.734 7.4245 15.5863 7.2808 15.4043L0.3914 6.0303L0.3894 6.0283C0.1547 5.7496 0.0185 5.3988 0.0017 5.0322C-0.0149 4.6656 0.0892 4.3036 0.2976 4.0039L0.2996 4L2.2642 0.7109C2.4103 0.4991 2.6028 0.3244 2.8267 0.2012C3.0532 0.0765 3.3055 0.0072 3.563 0H13.441L13.6324 0.0176ZM9.4869 14.1641L15.3279 6.0146H12.5818L9.4869 14.1641ZM7.483 14.126L4.7722 6.0146H1.6716L7.483 14.126ZM8.4878 13.9082L11.4422 6.0146H5.8816L8.4878 13.9082ZM3.5123 1C3.4354 1.0114 3.3613 1.0374 3.2925 1.0752C3.2007 1.1257 3.1206 1.1969 3.0611 1.2842L3.0562 1.292L1.0935 4.5771L1.0945 4.5781C1.0119 4.6971 0.9707 4.8408 0.9773 4.9863C0.9778 4.9959 0.9804 5.0052 0.9812 5.0146H4.6902L5.7105 0.9932H3.5894L3.5123 1ZM12.6756 5.0146H16.0193C16.0202 5.0052 16.0228 4.9959 16.0232 4.9863C16.0297 4.8408 15.9884 4.6969 15.906 4.5781L13.9468 1.292L13.941 1.2842C13.8815 1.1971 13.803 1.1256 13.7115 1.0752C13.6427 1.0373 13.5678 1.0114 13.4908 1L13.4126 0.9932H11.6587L12.6756 5.0146ZM5.8455 5.0146H11.5203L10.5035 0.9932H6.8658L5.8455 5.0146Z",fill:"white"})})}function uj(){return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M13.6324 0.0176C13.8225 0.0458 14.0074 0.1077 14.1773 0.2012C14.401 0.3244 14.5928 0.4993 14.7388 0.7109L16.7 4L16.7029 4.0039C16.8853 4.266 16.9881 4.5759 16.9998 4.8945L16.9988 5.0322C16.982 5.3989 16.8449 5.7496 16.6101 6.0283L16.6082 6.0312L16.6072 6.0303L9.7232 15.4053L9.7212 15.4033C9.5775 15.5854 9.3974 15.734 9.191 15.8369C8.9763 15.9439 8.7401 16 8.5015 16C8.2629 16 8.0267 15.9439 7.8121 15.8369C7.6057 15.734 7.4245 15.5863 7.2808 15.4043L0.3914 6.0303L0.3894 6.0283C0.1547 5.7496 0.0185 5.3988 0.0017 5.0322C-0.0149 4.6656 0.0892 4.3036 0.2976 4.0039L0.2996 4L2.2642 0.7109C2.4103 0.4991 2.6028 0.3244 2.8267 0.2012C3.0532 0.0765 3.3055 0.0072 3.563 0H13.441L13.6324 0.0176ZM9.4869 14.1641L15.3279 6.0146H12.5818L9.4869 14.1641ZM7.483 14.126L4.7722 6.0146H1.6716L7.483 14.126ZM8.4878 13.9082L11.4422 6.0146H5.8816L8.4878 13.9082ZM3.5123 1C3.4354 1.0114 3.3613 1.0374 3.2925 1.0752C3.2007 1.1257 3.1206 1.1969 3.0611 1.2842L3.0562 1.292L1.0935 4.5771L1.0945 4.5781C1.0119 4.6971 0.9707 4.8408 0.9773 4.9863C0.9778 4.9959 0.9804 5.0052 0.9812 5.0146H4.6902L5.7105 0.9932H3.5894L3.5123 1ZM12.6756 5.0146H16.0193C16.0202 5.0052 16.0228 4.9959 16.0232 4.9863C16.0297 4.8408 15.9884 4.6969 15.906 4.5781L13.9468 1.292L13.941 1.2842C13.8815 1.1971 13.803 1.1256 13.7115 1.0752C13.6427 1.0373 13.5678 1.0114 13.4908 1L13.4126 0.9932H11.6587L12.6756 5.0146ZM5.8455 5.0146H11.5203L10.5035 0.9932H6.8658L5.8455 5.0146Z",fill:"#ff631f"})})}function mj(e){let{showDiamond:t=!0,trackingOrigin:s,userId:a,appId:n,conversationId:l,className:r="",discountPercent:i=0}=e;const o="".concat(window.location.origin,"/billing"),c=i>0,d=()=>{if(!s)return;const e={user_id:null!=a?a:null,app_id:null!=n?n:null,conversation_id:null!=l?l:null};Tu("User clicked upgrade",(0,ue.A)((0,ue.A)({},e),{},{cta:c?"".concat(i,"% off"):"Upgrade",origin:s,target_route:"/billing",discount_percent:i||null})),Vu(e,{cta:c?"".concat(i,"% off"):"Upgrade",origin:s,target_route:"/billing",discount_percent:i||null})};return c?(0,se.jsxs)("a",{href:o,onClick:d,className:"inline-flex items-center justify-center transition-all hover:opacity-90 ".concat(r),style:{boxSizing:"border-box",padding:"6px 12px",gap:"6px",height:"32px",background:"linear-gradient(77deg, rgba(255, 102, 0, 0.26) 70.38%, rgba(255, 222, 162, 0.182) 98.95%), #fff",border:"1px solid #ffcbb4",borderRadius:"8px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",fontSize:"14px",lineHeight:"20px",fontWeight:"500",color:"#ff631f"},children:[(0,se.jsx)(uj,{}),i,"% off"]}):(0,se.jsxs)("a",{href:o,onClick:d,className:"inline-flex items-center justify-center text-white transition-all hover:opacity-90 ".concat(r),style:{boxSizing:"border-box",padding:"4px 16px",gap:t?"6px":"3px",isolation:"isolate",height:"36px",background:"radial-gradient(ellipse 182.73% 2191.40% at 2.19% -1.56%, #FF5500 0%, #FFC494 100%), #FFF",borderRadius:"8px",fontSize:"14px",lineHeight:"20px",fontWeight:"500"},children:[t&&(0,se.jsx)(dj,{}),"Upgrade"]})}function xj(e){let{text:t="Unlock this feature with the Builder plan.",layout:s="horizontal",trackingOrigin:a,userId:n,appId:l,conversationId:r,className:i="",discountPercent:o=0}=e;const c="horizontal"===s;return(0,se.jsxs)("div",{className:"\n        flex rounded-lg\n        ".concat(c?"flex-row items-center justify-between gap-4 px-4 py-3":"flex-col items-start gap-3 p-4","\n        ").concat(i,"\n      "),style:{background:"linear-gradient(90deg, rgba(255, 198, 158, 0.25) 0%, rgba(255, 238, 227, 0.25) 100%)"},children:[(0,se.jsx)("p",{className:"text-sm font-normal m-0",style:{color:"#374151"},children:t}),(0,se.jsx)(mj,{showDiamond:!0,trackingOrigin:a,userId:n,appId:l,conversationId:r,discountPercent:o})]})}const hj=["className","hidden","inset","children"],pj=["className"],gj=["className","sideOffset"],fj=["className","hidden","inset"],vj=["className","children","checked"],bj=["className","children"],jj=["className","inset"],yj=["className"],Nj=pt.Root,wj=pt.Trigger,_j=(pt.Group,pt.Portal,pt.Sub),kj=(pt.RadioGroup,Y.forwardRef((e,t)=>{let{className:s,hidden:a,inset:n,children:l}=e,r=(0,Nt.A)(e,hj);return(0,se.jsxs)(pt.SubTrigger,(0,ue.A)((0,ue.A)({ref:t,className:de("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",{hidden:a},s)},r),{},{hidden:a,children:[l,(0,se.jsx)(bs.A,{className:"ml-auto h-4 w-4"})]}))}));kj.displayName=pt.SubTrigger.displayName;const Cj=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,pj);return(0,se.jsx)(pt.SubContent,(0,ue.A)({ref:t,className:de("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},a))});Cj.displayName=pt.SubContent.displayName;const Aj=Y.forwardRef((e,t)=>{let{className:s,sideOffset:a=4}=e,n=(0,Nt.A)(e,gj);return(0,se.jsx)(pt.Portal,{children:(0,se.jsx)(pt.Content,(0,ue.A)((0,ue.A)({ref:t,sideOffset:a,className:de("group","z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},n),{},{"data-theme":"white"}))})});Aj.displayName=pt.Content.displayName;const Sj=Y.forwardRef((e,t)=>{let{className:s,hidden:a,inset:n}=e,l=(0,Nt.A)(e,fj);return(0,se.jsx)(pt.Item,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",{hidden:a},n&&"pl-8",s)},l),{},{hidden:a}))});Sj.displayName=pt.Item.displayName;Y.forwardRef((e,t)=>{let{className:s,children:a,checked:n}=e,l=(0,Nt.A)(e,vj);return(0,se.jsxs)(pt.CheckboxItem,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n},l),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(pt.ItemIndicator,{children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}),a]}))}).displayName=pt.CheckboxItem.displayName;Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,bj);return(0,se.jsxs)(pt.RadioItem,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s)},n),{},{children:[(0,se.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,se.jsx)(pt.ItemIndicator,{children:(0,se.jsx)(Ba.A,{className:"h-2 w-2 fill-current"})})}),a]}))}).displayName=pt.RadioItem.displayName;const Ej=Y.forwardRef((e,t)=>{let{className:s,inset:a}=e,n=(0,Nt.A)(e,jj);return(0,se.jsx)(pt.Label,(0,ue.A)({ref:t,className:de("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s)},n))});Ej.displayName=pt.Label.displayName;const Tj=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,yj);return(0,se.jsx)(pt.Separator,(0,ue.A)({ref:t,className:de("-mx-1 my-1 h-px bg-muted",s)},a))});Tj.displayName=pt.Separator.displayName;function Ij(e){let{enabled:t,hasRequiredPlan:s}=e;const{hasFlag:a}=ej(),n=a(sj),{connected:l,oauthStatus:r,hasConnectionError:i,isLoading:o,isConnecting:c,isDisconnecting:d,connect:u,disconnect:m,connectionError:x,clearConnectionError:h}=Xb({enabled:t&&s}),p=i,[g,f]=(0,Y.useState)(!1),v=uh(),b=()=>{var e;h(),l&&p?(Tu(km,e=v),Vu(e,{cta:Ym,origin:lx,target_route:null})):function(e){Tu(_m,e),Vu(e,{cta:qm,origin:lx,target_route:null})}(v),u()};if(!t)return null;if(!s)return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"border-t border-gray-200"}),(0,se.jsxs)("div",{className:"flex flex-col gap-4 px-5 py-4 bg-white border border-gray-200 rounded-xl",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsx)("span",{className:"text-sm font-semibold text-neutral-900",children:"GitHub account"}),(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:"Add your GitHub account"})]}),(0,se.jsx)(xj,{text:"Unlock this feature with the Builder plan.",layout:"horizontal",trackingOrigin:"account-settings-github"})]})]});const j=()=>{f(!0)};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"border-t border-gray-200"}),(0,se.jsx)("div",{className:"flex items-center justify-between px-5 py-4 bg-white border border-gray-200 rounded-xl",children:o?(0,se.jsxs)("div",{className:"flex items-center gap-3 text-neutral-500",children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}),(0,se.jsx)("span",{className:"text-sm",children:"Loading..."})]}):l&&p?(0,se.jsxs)("div",{className:"flex flex-col gap-3 w-full",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"text-sm font-semibold text-neutral-900",children:"GitHub account"}),(0,se.jsx)("button",{onClick:b,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg shadow-sm hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin text-neutral-900"}),(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Connecting..."})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Zb,{className:"w-4 h-4 text-neutral-900"}),(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Reconnect"})]})})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-red-50 border border-red-100 rounded-lg",children:[(0,se.jsx)(ad.A,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-red-700",children:"The connection to GitHub was lost. Please reconnect your GitHub account to continue."})]})]}):l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsx)("span",{className:"text-sm font-semibold text-neutral-900",children:"GitHub Account"}),(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:"Your GitHub account is connected"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-50 border border-emerald-200 rounded-lg",children:[(0,se.jsx)(Zb,{className:"w-4 h-4 text-emerald-600"}),(0,se.jsx)("span",{className:"text-sm font-medium text-emerald-700",children:"Connected"})]}),n&&(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:d,children:(0,se.jsx)(Nv.A,{className:"w-4 h-4 text-neutral-500"})})}),(0,se.jsx)(Aj,{align:"end",children:(0,se.jsx)(Sj,{onClick:j,className:"text-red-600 focus:text-red-600 focus:bg-red-50 cursor-pointer",children:"Disconnect"})})]})]})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsx)("span",{className:"text-sm font-semibold text-neutral-900",children:"GitHub Account"}),x?(0,se.jsxs)("div",{className:"flex items-center gap-1.5 text-red-600",children:[(0,se.jsx)(ad.A,{className:"w-3.5 h-3.5"}),(0,se.jsx)("span",{className:"text-sm",children:x})]}):(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:"Add your GitHub account"})]}),(0,se.jsx)("button",{onClick:b,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg shadow-sm hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin text-neutral-900"}),(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Connecting..."})]}):x?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Zb,{className:"w-4 h-4 text-neutral-900"}),(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Try Again"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Zb,{className:"w-4 h-4 text-neutral-900"}),(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:"Connect GitHub"})]})})]})}),(0,se.jsx)(Jb,{open:g,onOpenChange:f,onConfirm:async()=>{await m(),f(!1)},isDisconnecting:d})]})}var Pj=s(36391),Lj=s(80903),Mj=s(86900),Rj=s(31641);const Dj=["free","starter","builder","pro","elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9","enterprise"],Fj=e=>e?e.replace(/_yearly_ils|_yearly|_ils/g,"").replace(/^starter25$/,"starter"):"free",Oj=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return"";let s=e.replace(/starter25/gi,"starter").replace(/_ils$/gi,"");return t||(s=s.replace(/_yearly/gi,"")),s.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")},Uj=(e,t)=>{const s=Fj(null==e?void 0:e.subscription_tier),a=Dj.indexOf(s),n=Dj.indexOf(t);return a>=0&&n>=0&&a>=n},Bj=e=>Uj(e,"builder"),zj=e=>Uj(e,"builder"),Hj=e=>Uj(e,"builder"),Vj=e=>{const t=Fj(e),s=Dj.indexOf(t),a=Dj.indexOf("builder");return s>=0&&a>=0&&s>=a};function Wj(e){let{tier:t,tooltip:s="Available on Builder plan+",className:a}=e;return(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("span",{className:de("inline-flex items-center justify-center px-1.5 h-5 text-sm font-medium rounded-md border cursor-default","border-[#FFCBB4] text-[#FF631F]",a),children:t})}),(0,se.jsx)(pp,{className:"bg-gray-900 text-white border-gray-900",children:s})]})}const qj=["className"],Yj=["className"],Gj=["className"],Kj=lt.Root,$j=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,qj);return(0,se.jsx)(lt.List,(0,ue.A)({ref:t,className:de("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s)},a))});$j.displayName=lt.List.displayName;const Zj=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Yj);return(0,se.jsx)(lt.Trigger,(0,ue.A)({ref:t,className:de("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-normal ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s)},a))});Zj.displayName=lt.Trigger.displayName;const Jj=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Gj);return(0,se.jsx)(lt.Content,(0,ue.A)({ref:t,className:de("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s)},a))});Jj.displayName=lt.Content.displayName;const Qj=xt.Root,Xj=Y.forwardRef((e,t)=>{let s=Object.assign({},((0,fs.A)(e),e));return(0,se.jsx)(xt.CollapsibleTrigger,(0,ue.A)({ref:t},s))});Xj.displayName=xt.CollapsibleTrigger.displayName;const ey=Y.forwardRef((e,t)=>{let s=Object.assign({},((0,fs.A)(e),e));return(0,se.jsx)(xt.CollapsibleContent,(0,ue.A)({ref:t},s))});function ty(e){let{value:t,tabId:s,copiedTab:a,onCopy:n}=e;return(0,se.jsxs)("div",{className:"flex items-center h-9 px-3 gap-1 bg-slate-50 rounded-lg w-full cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>n(t,s),children:[(0,se.jsx)("span",{className:"flex-1 text-sm text-slate-700 truncate",children:t}),a===s?(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-green-600 shrink-0"}):(0,se.jsx)(ob.A,{className:"w-4 h-4 text-slate-700 shrink-0"})]})}function sy(e){let{httpsUrl:t,sshUrl:s,repoFullName:a}=e;const[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null),o=uh(),c="gh repo clone ".concat(a),d=async(e,t)=>{try{await navigator.clipboard.writeText(e),i(t),function(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Pm,s),Vu(e,(0,ue.A)({cta:Qm,origin:ix,target_route:null},t))}(o,{clone_type:t,repo_full_name:a}),$.default.success("Copied to clipboard"),setTimeout(()=>i(null),2e3)}catch(s){$.default.error("Failed to copy to clipboard")}};return(0,se.jsxs)(Qj,{open:n,onOpenChange:l,children:[(0,se.jsxs)(Xj,{className:"flex items-center justify-between w-full h-[18px] text-sm text-zinc-950 hover:text-zinc-700 transition-colors",children:[(0,se.jsx)("span",{className:"leading-[18px]",children:"Clone app"}),(0,se.jsx)(_t.A,{className:"w-4 h-4 text-zinc-950 transition-transform duration-200 ".concat(n?"rotate-180":"")})]}),(0,se.jsx)(ey,{className:"overflow-hidden",children:(0,se.jsx)("div",{className:"pt-3 flex flex-col gap-2",children:(0,se.jsxs)(Kj,{defaultValue:"https",className:"w-full",children:[(0,se.jsxs)($j,{className:"w-full h-9 bg-neutral-100 p-[3px] rounded-[10px]",children:[(0,se.jsx)(Zj,{value:"https",className:"flex-1 h-7 text-sm font-medium text-zinc-950 rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"HTTPS"}),(0,se.jsx)(Zj,{value:"ssh",className:"flex-1 h-7 text-sm font-medium text-zinc-950 rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"SSH"}),(0,se.jsx)(Zj,{value:"cli",className:"flex-1 h-7 text-sm font-medium text-zinc-950 rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"GitHub CLI"})]}),(0,se.jsx)(Jj,{value:"https",className:"mt-2",children:(0,se.jsx)(ty,{value:t,tabId:"https",copiedTab:r,onCopy:d})}),(0,se.jsx)(Jj,{value:"ssh",className:"mt-2",children:(0,se.jsx)(ty,{value:s,tabId:"ssh",copiedTab:r,onCopy:d})}),(0,se.jsx)(Jj,{value:"cli",className:"mt-2",children:(0,se.jsx)(ty,{value:c,tabId:"cli",copiedTab:r,onCopy:d})})]})})})]})}ey.displayName=xt.CollapsibleContent.displayName;var ay=s(81064);const ny=["className","orientation","decorative"],ly=Y.forwardRef((e,t)=>{let{className:s,orientation:a="horizontal",decorative:n=!0}=e,l=(0,Nt.A)(e,ny);return(0,se.jsx)(at.Root,(0,ue.A)({ref:t,decorative:n,orientation:a,className:de("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",s)},l))});ly.displayName=at.Root.displayName;var ry=s(91412),iy=s(2737),oy=s(53270);const cy=()=>{const{user:e}=wd();return!(null!=e&&e.subscription_tier)||"free"===(null==e?void 0:e.subscription_tier.toLowerCase())},dy=e=>{dS.openModal("UpgradeModal",{origin:e})},uy=e=>{let{className:t}=e;return(0,se.jsx)(ry.A,{className:de("w-4 h-4 text-[#FF631F]",t),"aria-hidden":"true"})},my=e=>{let{origin:t}=e;return(0,se.jsxs)(Bx,{size:"tiny",variant:"outline",className:de("sm:px-4 sm:w-auto w-8 border-[#FFCBB4]","bg-[linear-gradient(85deg,rgba(255,102,0,0.26)_-70.38%,rgba(255,222,162,0.18)_98.95%)] text-[#FF631F] color-[#FF631F]hover:text-[#FF631F] hover:color-[#FF631F]"),onClick:()=>dy(t),"aria-label":"Upgrade plan",children:[(0,se.jsx)(ry.A,{className:"w-4 h-4","aria-hidden":"true"}),(0,se.jsx)("span",{children:"Upgrade"})]})},xy=(e,t)=>!(!e||!t)&&e.toLowerCase()===t.toLowerCase(),hy=e=>!!e&&"admin"===e;class py extends te.H{getBaseURL(){return"/apps"}list(e){let{appId:t}=e;return this.axios.get("/".concat(t,"/custom-domains"))}get(e){let{appId:t,domainId:s}=e;return this.axios.get("/".concat(t,"/custom-domains/").concat(s))}create(e){let{appId:t,domain:s}=e;return this.axios.post("/".concat(t,"/custom-domains"),{domain:s})}delete(e){let{appId:t,domainId:s}=e;return this.axios.delete("/".concat(t,"/custom-domains/").concat(s))}refreshStatus(e){let{appId:t,domainId:s}=e;return this.axios.post("/".concat(t,"/custom-domains/").concat(s,"/status"))}verify(e){let{appId:t,domainId:s}=e;return this.axios.post("/".concat(t,"/custom-domains/").concat(s,"/verify"))}unlink(e){let{appId:t,domainId:s}=e;return this.axios.post("/".concat(t,"/custom-domains/").concat(s,"/unlink"))}link(e){let{appId:t,domainId:s}=e;return this.axios.post("/".concat(t,"/custom-domains/").concat(s,"/link"))}getEntriToken(e){let{appId:t,appName:s,domain:a}=e;return(0,me.Ay)("/apps/buy_domain").post("/start",{appId:t,appName:s,domain:a})}}const gy=new py,fy="publish-queries-group",vy=hu({},{_isPublishing:!1,_publishingCheckpointId:null}).use(mu({isPublishing:e=>e._isPublishing,publishingCheckpointId:e=>e._publishingCheckpointId,isPublishingCheckpoint:e=>null!==e._publishingCheckpointId})).use(e=>({useFetchPermissions:()=>{const{app:e}=lp(),{data:t,isLoading:s}=Xd({caching:{configuration:"DYNAMIC",groupIds:[fy,"permissions"]},initialData:{canPublish:!0,restrictionReason:null},query:async()=>await async function(e){let{app:t}=e;if(null==t||!t.id||!t.organization_id)return{canPublish:!0,restrictionReason:null};try{const e=await Hd.checkSensitiveFeaturePermission("publish_app",t.organization_id);return{canPublish:e.allowed,restrictionReason:e.restriction_reason}}catch(s){return{canPublish:!0,restrictionReason:null}}}({app:e}),enabled:null!=(null==e?void 0:e.id)},[null==e?void 0:e.id]);return(0,ue.A)((0,ue.A)({},t),{},{isLoading:s})},usePublishUrl:()=>{const{app:e}=lp(),{data:t}=Xd({caching:[fy,"domains"],enabled:null!=(null==e?void 0:e.id),initialData:[],query:async()=>(await gy.list({appId:null==e?void 0:e.id})).map(e=>e.domain)},[null==e?void 0:e.id]);return{publishUrl:Y.useMemo(()=>{const s=t[0];return s?"https://".concat(s):null!=e&&e.slug?Tc(e):""},[t.join(","),null==e?void 0:e.slug]),domains:t}}})).use(e=>({useIsDisabled:()=>{const{isGitHubSyncing:t}=wx.useIsGithubSyncing(),s=e.use_isPublishing(),{canPublish:a,restrictionReason:n,isLoading:l}=e.useFetchPermissions();return{isDisabled:l||s||t||!a,restrictionReason:a?void 0:null!=n?n:"Publishing is currently disabled"}},usePublishApp:t=>{const{onPublishSuccess:s}=null!=t?t:{},{app:a}=lp(),{publishUrl:n,domains:l}=e.usePublishUrl(),r=eu({logErrorMsg:"Failed to publish app",toastError:"Failed to publish app",mutate:async e=>{const t=null==(null==a?void 0:a.last_deployed_at);await zc.deployApp(a.id,e.checkpointId),(e=>{let{isFirstTimePublishing:t}=e;s?s({isFirstTimePublishing:t,publishUrl:n,domains:l}):dS.openModal("PublishAppModal",{isFirstTimePublishing:t})})({isFirstTimePublishing:t})},onLoading:(t,s)=>{let{refetchData:a}=s;e._isPublishing=t,e._publishingCheckpointId=t?null==a?void 0:a.checkpointId:null},onSuccess:()=>{Tu("App Published",{app_id:a.id,app_name:a.name,has_custom_domains:l.length>0})}});return{publishApp:r.mutate,publishError:r.error}}})).use(e=>({useSocialShare:()=>{const{app:t}=lp(),{publishUrl:s}=e.usePublishUrl();return{shareToSocial:e=>{const a=null!=t&&t.name?"I've built ".concat(t.name," with @base_44!"):"Check out what I built with @base_44!",n=s;switch(e){case"twitter":gd("https://x.com/intent/tweet?text=".concat(encodeURIComponent(a),"&url=").concat(encodeURIComponent(n)));break;case"linkedin":gd("https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(n)));break;case"whatsapp":gd("https://wa.me/?text=".concat(encodeURIComponent("".concat(a," ").concat(n))));break;case"instagram":gd("https://www.instagram.com/intent/share?text=".concat(encodeURIComponent(a)));break;case"facebook":gd("https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(n)));break;case"reddit":gd("https://www.reddit.com/submit?url=".concat(encodeURIComponent(n),"&title=").concat(encodeURIComponent(a)))}}}}}));const by=e=>{let{isVisible:t,onCancel:s=()=>{},onInviteSuccess:a=()=>{}}=e;const{app:n}=lp(),[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)("user"),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)(!1),x=cy(),{publishUrl:h}=vy.usePublishUrl(),p=function(e){const t=Lc("share--".concat(e.slug));return e.main_page?"".concat(t,"/").concat(e.main_page):t}(n);return(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsxs)(Hg,{className:"sm:max-w-[500px] font-base44",children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{className:"text-xl font-semibold",children:"Share access to your app"})}),(0,se.jsxs)("div",{className:"space-y-5",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Invite user or collaborator"}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),d(""),l)if(Lv(l))if(xy(l,n.owner_email))d("You cannot invite the owner of this app");else{m(!0);try{await zc.inviteUser(n.id,l,i),et.toast.success("Invitation sent successfully"),r(""),a(),s()}catch(c){var t,o;const s=(null===(t=c.response)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.detail)||c.message||"Failed to send invitation";d(s)}finally{m(!1)}}else d("Email address is invalid");else d("Please enter an email address")},noValidate:!0,className:"flex flex-col gap-2.5 sm:flex-row sm:items-center",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2.5 flex-1",children:[(0,se.jsx)("div",{className:"flex-1 relative [&>*:not(input)]:absolute [&>*:not(input)]:right-2 [&>*:not(input)]:top-1/2 [&>*:not(input)]:-translate-y-1/2 [&>*:not(input)]:z-10",children:(0,se.jsx)(Df,{type:"email",placeholder:"Enter email address",value:l,onChange:e=>r(e.target.value),className:"w-full h-10 rounded-lg pr-10"})}),(0,se.jsxs)(Wf,{value:i,onValueChange:o,children:[(0,se.jsx)(Yf,{className:"w-[100px] h-10 rounded-lg [&_[data-description]]:hidden",children:(0,se.jsx)(qf,{placeholder:"Role"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"user",children:(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{children:"User"}),(0,se.jsx)("span",{"data-description":!0,className:"text-xs text-muted-foreground font-normal",children:"Can view and use the live app"})]})}),(0,se.jsx)(Zf,{value:"admin",disabled:x,children:(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)("span",{children:"Admin"}),x&&(0,se.jsx)(ry.A,{className:"w-3 h-3 text-[#FF631F]"})]}),(0,se.jsx)("span",{"data-description":!0,className:"text-xs text-muted-foreground font-normal",children:x?"Upgrade to invite admins":"Can edit app and its settings"})]})})]})]})]}),(0,se.jsxs)(Bx,{type:"submit",disabled:u,variant:"outline",className:"w-full sm:w-auto h-10 px-4 rounded-lg",children:["Invite",(0,se.jsx)(iy.A,{className:"w-4 h-4 ml-2"})]})]}),c&&(0,se.jsx)("p",{className:"text-sm text-destructive",children:c})]}),(0,se.jsx)(ly,{}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Share live app link"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Anyone with the link can view your app live."})]}),(0,se.jsxs)("div",{className:"flex flex-col-reverse sm:flex-row gap-2.5",children:[n.dev_environment_enabled&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"outline",className:"w-full sm:flex-1 h-10 rounded-lg",onClick:()=>{navigator.clipboard.writeText(p),et.toast.success("Link Copied")},children:[(0,se.jsx)(oy.A,{className:"w-4 h-4 mr-2 text-green-600"}),"Copy Testing Link"]})}),(0,se.jsx)(pp,{side:"top",className:"max-w-[250px] bg-foreground text-background",children:"View your app with unpublished changes. User test data appear in test mode in Preview and in your Dashboard."})]})}),(0,se.jsxs)(Bx,{className:"h-10 rounded-lg bg-foreground text-background hover:bg-foreground/90 w-full ".concat(n.dev_environment_enabled?"sm:flex-1":""),onClick:()=>{navigator.clipboard.writeText(h),et.toast.success("Link Copied")},children:[(0,se.jsx)(Jx.A,{className:"w-4 h-4 mr-2"}),"Copy Live Link"]})]})]})]})]})})},jy=["name","children","Openable"],yy=["open"],Ny=["className"],wy=["side","header","noOverlay","showDragHandle","className","children"],_y=["className","closeButton","actions"],ky=["className"],Cy=["className"],Ay=["className","onClose","onToggle","threshold"],Sy=gt.Root,Ey=gt.Trigger,Ty=(gt.Close,gt.Portal),Iy=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Ny);return(0,se.jsx)(Ig,(0,ue.A)((0,ue.A)({className:de("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},a),{},{ref:t}))});Iy.displayName=gt.Overlay.displayName;const Py=(0,ft.cva)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Ly=Y.forwardRef((e,t)=>{let{side:s="right",header:a,noOverlay:n=!1,showDragHandle:l=!0,className:r,children:i}=e,o=(0,Nt.A)(e,wy);return(0,se.jsxs)(Ty,{children:[!n&&(0,se.jsx)(Iy,{}),(0,se.jsxs)(gt.Content,(0,ue.A)((0,ue.A)({ref:t,className:de(Py({side:s}),r)},o),{},{children:[a,"bottom"===s&&l&&(0,se.jsx)("div",{className:"absolute top-2 left-1/2 w-full ",children:(0,se.jsx)("div",{className:"w-[50px] border-2 border-gray-100 translate-x-[-50%]"})}),i]}))]})});Ly.displayName=gt.Content.displayName;const My=e=>{let{className:t,closeButton:s,actions:a}=e,n=(0,Nt.A)(e,_y);return(0,se.jsxs)("div",{className:de("flex flex-row justify-between",t),children:[(0,se.jsx)("div",(0,ue.A)({className:"flex flex-col space-y-2 text-center sm:text-left"},n)),(0,se.jsxs)("div",{className:"flex flex-row gap-4 z-5 ring-offset-background transition-opacity opacity-70 hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none cursor-pointer data-[state=open]:bg-secondary items-center",children:[a,!1!==s&&(0,se.jsxs)(gt.Close,{children:[null!=s?s:(0,se.jsx)(la.A,{className:"h-6 w-6"}),(0,se.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})};My.displayName="SheetHeader";const Ry=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,ky);return(0,se.jsx)(gt.Title,(0,ue.A)({ref:t,className:de("text-lg font-semibold text-foreground",s)},a))});Ry.displayName=gt.Title.displayName;const Dy=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Cy);return(0,se.jsx)(gt.Description,(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});Dy.displayName=gt.Description.displayName;const Fy=e=>{let{className:t,onClose:s,onToggle:a,threshold:n=50}=e,l=(0,Nt.A)(e,Ay);const[r,i]=Y.useState(!1),o=Y.useRef(0);return(0,se.jsx)("div",(0,ue.A)((0,ue.A)({className:de("flex justify-center mb-2 cursor-grab active:cursor-grabbing touch-none",t),onPointerDown:e=>{i(!0),o.current=e.clientY,e.currentTarget.setPointerCapture(e.pointerId)},onPointerMove:e=>{},onPointerUp:e=>{if(!r)return;const t=e.clientY-o.current;i(!1),Math.abs(t)>n&&a?a():t>n&&s&&!a&&s()},onPointerCancel:()=>i(!1)},l),{},{children:(0,se.jsx)("div",{className:"w-[38px] h-1 bg-[#E8ECF0] rounded"})}))};Fy.displayName="SheetDragHandle";var Oy=s(16859),Uy=s(59469),By=s(52245),zy=s(84814),Hy=s(5487);function Vy(e){let{onClose:t}=e;const{allActivities:s,clearActivities:a}=ab(),[n,l]=(0,Y.useState)("all"),[r,i]=(0,Y.useState)("all"),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)(!1),m=(0,Y.useRef)(null),x=(0,Y.useRef)(null),h=[{value:"all",label:"All",count:s.length},{value:"requests",label:"Requests",count:s.filter(e=>"request"===e.type).length},{value:"logs",label:"Logs",count:s.filter(e=>"log"===e.type).length}].filter(e=>e.count>0),p=s.filter(e=>{if(!((e,t)=>{if(!t.trim())return!0;const s=t.toLowerCase();if("log"===e.type){var a,n;const t=(null===(a=e.message)||void 0===a?void 0:a.toString().toLowerCase())||"",l=(null===(n=e.component)||void 0===n?void 0:n.toLowerCase())||"";return t.includes(s)||l.includes(s)}if("request"===e.type){var l;const t=(null===(l=e.url)||void 0===l?void 0:l.toLowerCase())||"",a="string"==typeof e.body?e.body.toLowerCase():JSON.stringify(e.body||{}).toLowerCase(),n="string"==typeof e.response?e.response.toLowerCase():JSON.stringify(e.response||{}).toLowerCase();return t.includes(s)||a.includes(s)||n.includes(s)}return!1})(e,o))return!1;if("all"===n);else if("requests"===n){if("request"!==e.type)return!1}else{if("logs"!==n)return!1;if("log"!==e.type)return!1}if("requests"===n&&"all"!==r){const t=parseInt(r);return"request"===e.type&&"completed"===e.status&&e.statusCode===t}return!0}),g=[...p].sort((e,t)=>{const s="request"===e.type?e.startTime:e.timestamp,a="request"===t.type?t.startTime:t.timestamp;return new Date(s)-new Date(a)}),f=(()=>{if("requests"!==n)return[];const e=new Set;s.forEach(t=>{"request"===t.type&&"completed"===t.status&&t.statusCode&&e.add(t.statusCode)});const t=[{value:"all",label:"All",count:s.filter(e=>"request"===e.type).length}];return Array.from(e).sort((e,t)=>e-t).forEach(e=>{const a=s.filter(t=>"request"===t.type&&"completed"===t.status&&t.statusCode===e).length;t.push({value:e.toString(),label:"".concat(e),count:a,statusCode:e})}),t.filter(e=>e.count>0)})(),v=e=>e>=200&&e<300?"bg-emerald-50 text-emerald-700 border-emerald-200":e>=300&&e<400?"bg-blue-50 text-blue-700 border-blue-200":e>=400&&e<500?"bg-amber-50 text-amber-700 border-amber-200":e>=500?"bg-rose-50 text-rose-700 border-rose-200":"bg-slate-50 text-slate-700 border-slate-200",b=e=>e>=200&&e<300?(0,se.jsx)(sd.A,{className:"h-3 w-3"}):e>=300&&e<400?(0,se.jsx)(Oy.A,{className:"h-3 w-3"}):e>=400&&e<500?(0,se.jsx)(Ap.A,{className:"h-3 w-3"}):e>=500?(0,se.jsx)(Uy.A,{className:"h-3 w-3"}):(0,se.jsx)(Oy.A,{className:"h-3 w-3"}),j=()=>{u(!0),setTimeout(()=>{m.current&&m.current.focus()},100)};(0,Y.useEffect)(()=>{if(d&&m.current){const e=setTimeout(()=>{m.current&&document.activeElement!==m.current&&m.current.focus()},50);return()=>clearTimeout(e)}},[n,d]);const y=()=>{u(!1),c("")};(0,Y.useEffect)(()=>{const e=e=>{if(d&&x.current&&!x.current.contains(e.target)){const t=e.target.closest('[role="combobox"]')||e.target.closest("[data-radix-collection-item]")||e.target.closest("button");o.trim()||t||u(!1)}};return d&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[d,o]);const N=s.filter(e=>"request"===e.type).length,w=s.filter(e=>"log"===e.type).length;return(0,se.jsxs)("div",{className:"flex flex-col h-full bg-white shadow-lg rounded-lg relative",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 border-b",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("h2",{className:"font-semibold",children:"Activity Monitor"}),(0,se.jsx)("div",{className:"text-xs text-muted-foreground",children:s.length>0&&(0,se.jsxs)(gs,{variant:"outline",className:"font-normal bg-slate-50",children:[s.length," entries"]})})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsxs)(br,{value:n,onValueChange:e=>{l(e),"requests"!==e&&i("all")},children:[(0,se.jsxs)(Nr,{className:"h-8 w-auto min-w-[90px] bg-white border-slate-200",children:[(0,se.jsx)(By.A,{className:"h-3.5 w-3.5 mr-1.5 text-slate-500"}),(0,se.jsx)(yr,{})]}),(0,se.jsx)(kr,{className:"bg-white border-slate-200",children:h.map(e=>(0,se.jsx)(Ar,{value:e.value,className:"hover:bg-slate-50",children:(0,se.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,se.jsx)("span",{children:e.label}),(0,se.jsx)("span",{className:"text-xs text-slate-400 ml-2",children:e.count})]})},e.value))})]}),"requests"===n&&f.length>1&&(0,se.jsxs)(br,{value:r,onValueChange:i,children:[(0,se.jsx)(Nr,{className:"h-8 w-auto min-w-[70px] bg-white border-slate-200",children:(0,se.jsx)(yr,{})}),(0,se.jsx)(kr,{className:"bg-white border-slate-200",children:f.map(e=>(0,se.jsx)(Ar,{value:e.value,className:"hover:bg-slate-50",children:(0,se.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,se.jsx)("span",{className:"flex items-center gap-1",children:e.statusCode?(0,se.jsxs)(se.Fragment,{children:[b(e.statusCode),(0,se.jsx)(gs,{variant:"outline",className:de("text-xs px-1 py-0.5",v(e.statusCode)),children:e.label})]}):e.label}),(0,se.jsx)("span",{className:"text-xs text-slate-400 ml-1.5",children:e.count})]})},e.value))})]}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>{a(),c(""),l("all"),i("all"),u(!1)},className:"h-8",children:(0,se.jsx)(zy.A,{className:"h-3.5 w-3.5"})}),t&&(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})})]})]}),(d||o.trim())&&(0,se.jsx)("div",{ref:x,className:"border-b border-slate-200 px-4 py-2",children:d?(0,se.jsxs)("div",{className:"relative animate-in slide-in-from-top-2 duration-200",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),(0,se.jsx)(nl,{ref:m,type:"text",placeholder:(()=>{switch(n){case"logs":return"Search logs...";case"requests":return"Search requests...";default:return"Search logs and requests..."}})(),value:o,onChange:e=>c(e.target.value),onKeyDown:e=>{"Escape"===e.key&&y()},className:"h-10 w-full pl-10 pr-10 text-sm bg-white border-slate-200 placeholder:text-slate-400 focus:ring-2 focus:ring-orange-100 focus:border-orange-300"},"network-search-input"),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:y,className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-slate-100",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}):(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:j,className:"h-8 w-full justify-start gap-2 bg-orange-50 border-orange-200 text-orange-700",children:[(0,se.jsx)(na.A,{className:"h-3.5 w-3.5"}),(0,se.jsxs)("span",{className:"text-sm",children:['Search: "',o.length>30?o.substring(0,30)+"...":o,'"']})]})}),s.length>0&&(0,se.jsxs)("div",{className:"flex justify-between items-center text-xs border-b px-4 py-1 bg-slate-50",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[!d&&!o.trim()&&(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:j,className:"h-4 w-4 p-0 text-slate-400 hover:text-slate-500 hover:bg-transparent",children:(0,se.jsx)(na.A,{className:"h-3 w-3"})}),(0,se.jsxs)("span",{children:[N," requests"]}),(0,se.jsxs)("span",{children:[w," logs"]})]}),(o.trim()||"all"!==n||"all"!==r)&&(0,se.jsxs)("div",{className:"text-slate-500",children:["Showing ",p.length," of ",s.length]})]}),0===s.length&&!d&&!o.trim()&&(0,se.jsx)("div",{className:"px-4 py-1 border-b border-slate-200",children:(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:j,className:"h-4 w-4 p-0 text-slate-400 hover:text-slate-500 hover:bg-transparent",children:(0,se.jsx)(na.A,{className:"h-3 w-3"})})}),(0,se.jsx)(cr,{className:"flex-grow",children:0===g.length?(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground p-8",children:[(0,se.jsx)("p",{className:"text-sm",children:0===s.length?"No activities logged":o.trim()?"No ".concat("all"===n?"activities":n,' found matching "').concat(o,'"'):"No matching activities found"}),o.trim()&&(0,se.jsx)("p",{className:"text-xs mt-2 text-slate-400",children:"Try a different search term or clear filters"})]}):(0,se.jsx)("div",{className:"p-2 space-y-1",children:[...g].reverse().map(e=>"request"===e.type?(0,se.jsx)(qy,{request:e},e.id):(0,se.jsx)(Wy,{log:e},e.id))})})]})}function Wy(e){var t,s,a;let{log:n}=e;const{icon:l,className:r}=(e=>{switch(e){case"error":return{icon:(0,se.jsx)(Uy.A,{className:"h-3.5 w-3.5"}),className:"bg-rose-50 text-rose-700"};case"warn":return{icon:(0,se.jsx)(Ap.A,{className:"h-3.5 w-3.5"}),className:"bg-amber-50 text-amber-700"};default:return{icon:(0,se.jsx)(Oy.A,{className:"h-3.5 w-3.5"}),className:"bg-slate-50 text-slate-700"}}})(n.severity),i=e=>e?He()(e).fromNow():"";return(0,se.jsxs)(Us,{className:"border rounded overflow-hidden hover:shadow-sm transition-all duration-200",children:[(0,se.jsxs)(Bs,{className:"flex w-full p-2 hover:bg-accent/5 text-left",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-16 flex justify-center",children:(0,se.jsxs)(gs,{variant:"outline",className:"bg-purple-50 text-purple-700 font-mono text-xs uppercase",children:[(0,se.jsx)(Hy.A,{className:"h-3 w-3 mr-1"})," Log"]})}),(0,se.jsxs)("div",{className:"flex-grow mx-3",children:[n.component&&(0,se.jsx)("div",{className:"text-xs text-muted-foreground mb-0.5 font-medium",children:n.component}),(0,se.jsxs)("div",{className:"text-sm font-normal truncate",children:[null===(t=n.message)||void 0===t?void 0:t.toString().substring(0,60),(null===(s=n.message)||void 0===s?void 0:s.toString().length)>60?"...":""]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,se.jsx)("div",{className:"text-xs text-muted-foreground text-right",children:i(n.timestamp)}),(0,se.jsx)(gs,{variant:"outline",className:de("flex items-center",r),children:l}),(0,se.jsx)(_t.A,{className:"h-3.5 w-3.5 text-muted-foreground"})]})]}),(0,se.jsx)(zs,{children:(0,se.jsx)("div",{className:"p-4 border-t bg-slate-50/50",children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Message"}),(0,se.jsx)("pre",{className:"p-3 rounded bg-white text-xs overflow-auto max-h-60 border whitespace-pre-wrap",children:null===(a=n.message)||void 0===a?void 0:a.toString()})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Severity"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:n.severity})]}),n.component&&(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Component"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:n.component})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Time"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:i(n.timestamp)})]})]})]})})})]})}function qy(e){var t;let{request:s}=e;const{app:a}=lp(),n=e=>e?He()(e).fromNow():"";return(0,se.jsxs)(Us,{className:"border rounded overflow-hidden hover:shadow-sm transition-all duration-200",children:[(0,se.jsxs)(Bs,{className:"flex w-full p-2 hover:bg-accent/5 text-left",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-16 flex justify-center",children:(0,se.jsx)(gs,{variant:"outline",className:de("font-mono text-xs",(e=>{switch(e){case"GET":return"bg-blue-50 text-blue-700";case"POST":return"bg-green-50 text-green-700";case"PUT":return"bg-amber-50 text-amber-700";case"DELETE":return"bg-rose-50 text-rose-700";default:return"bg-slate-100 text-slate-700"}})(s.method)),children:null===(t=s.method)||void 0===t?void 0:t.toLowerCase()})}),(0,se.jsx)("div",{className:"flex-grow mx-3",children:(0,se.jsx)("div",{className:"text-sm font-normal truncate",children:(e=>{let t=e;return e.startsWith("http")&&(t=new URL(e).pathname),t.startsWith("/api/apps/"+(null==a?void 0:a.id))&&(t=t.replace("/api/apps/"+a.id,"")),null!=a&&a.id&&t.includes(a.id)&&(t=t.replace(a.id,"{app_id}")),t})(s.url)})}),(0,se.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,se.jsx)("div",{className:"text-xs text-muted-foreground text-right",children:n(s.startTime)}),(0,se.jsxs)(gs,{variant:"outline",className:de("flex items-center",(l=s.status,r=s.statusCode,"pending"===l?"bg-slate-100 text-slate-700":r>=200&&r<300?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-700")),children:[((e,t)=>"pending"===e?(0,se.jsx)(Ac.A,{className:"h-3.5 w-3.5 animate-spin"}):t>=200&&t<300?(0,se.jsx)(sd.A,{className:"h-3.5 w-3.5"}):(0,se.jsx)(ad.A,{className:"h-3.5 w-3.5"}))(s.status,s.statusCode),"completed"===s.status&&s.statusCode]}),(0,se.jsx)(_t.A,{className:"h-3.5 w-3.5 text-muted-foreground"})]})]}),(0,se.jsx)(zs,{children:(0,se.jsx)("div",{className:"p-4 border-t bg-slate-50/50",children:(0,se.jsxs)(ji,{defaultValue:"general",children:[(0,se.jsxs)(yi,{className:"mb-3",children:[(0,se.jsx)(Ni,{value:"general",children:"General"}),(0,se.jsx)(Ni,{value:"request",children:"Request"}),"completed"===s.status&&(0,se.jsx)(Ni,{value:"response",children:"Response"})]}),(0,se.jsxs)(wi,{value:"general",className:"space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"URL"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground break-all",children:s.url})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Method"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:s.method})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Status"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"completed"===s.status?"".concat(s.statusCode," (").concat(s.duration,"ms)"):(0,se.jsxs)("span",{className:"flex items-center",children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 mr-1 animate-spin"}),"Pending"]})})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Time"}),(0,se.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Started: ",n(s.startTime),s.endTime&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("br",{}),"Completed: ",n(s.endTime)]})]})]})]}),(0,se.jsx)(wi,{value:"request",children:s.body?(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Request Data"}),(0,se.jsx)("pre",{className:"p-3 rounded bg-white text-xs overflow-auto max-h-60 border",children:"object"==typeof s.body?JSON.stringify(s.body,null,2):s.body})]}):(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"No request data"})}),"completed"===s.status&&(0,se.jsx)(wi,{value:"response",children:s.response?(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{className:"text-sm font-medium",children:"Response Data"}),(0,se.jsx)("pre",{className:"p-3 rounded bg-white text-xs overflow-auto max-h-60 border",children:"object"==typeof s.response?JSON.stringify(s.response,null,2):s.response})]}):(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"No response data"})})]})})})]});var l,r}function Yy(e){let{isSaving:t,hasEditorErrors:s,onDiscard:a,onSave:n,onSaveAndRedeploy:l,hasUnsavedChanges:r,isFunction:i,deploymentError:o,onClearError:c}=e;if(!r&&!o)return null;const d=(e=>{if(!e)return null;const t=e.match(/Deployment (.*?) failed with error (.*)/);return t?{deployment:"".concat(t[1]," failed"),error:t[2].replace(/\\n\\n+/g,": ").replace(/\\n+/g," ").trim()}:void 0})(o);return d?(0,se.jsxs)("div",{className:"border-t border-neutral-200 bg-white",children:[(0,se.jsx)("div",{className:"border-b border-red-200 bg-red-50/80 px-3 py-2",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500 mt-0.5 shrink-0"}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("div",{className:"font-medium text-sm text-red-800",children:d.deployment}),d.error&&(0,se.jsx)("div",{className:"font-mono text-xs text-red-600 mt-1 whitespace-pre-wrap break-words",children:d.error})]}),(0,se.jsx)("button",{onClick:c,className:"text-red-600 hover:text-red-700 hover:bg-red-100 p-1 rounded transition-colors shrink-0","aria-label":"Close",children:(0,se.jsx)(la.A,{className:"w-4 h-4"})})]})}),(0,se.jsxs)("div",{className:"flex items-center justify-end gap-3 px-3 py-3",children:[(0,se.jsx)(zt,{variant:"secondary",size:"sm",onClick:a,disabled:t,className:"shadow-sm",children:"Discard"}),i?(0,se.jsxs)(zt,{size:"sm",onClick:l,disabled:t,className:"bg-neutral-900 text-white hover:bg-neutral-800 shadow-sm",children:[t&&(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Save & Redeploy"]}):(0,se.jsx)(zt,{size:"sm",onClick:n,disabled:t,className:"bg-neutral-900 text-white hover:bg-neutral-800 shadow-sm",children:"Save"})]})]}):(0,se.jsxs)("div",{className:"border-t border-neutral-200 bg-white",children:[s&&(0,se.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-red-50 border-b border-red-200 text-red-700 text-xs",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500"}),(0,se.jsx)("span",{children:"Editor has errors"})]}),(0,se.jsxs)("div",{className:"flex items-center justify-end gap-3 px-3 py-3",children:[(0,se.jsx)(zt,{variant:"secondary",size:"sm",onClick:a,disabled:t,className:"shadow-sm",children:"Discard"}),i?(0,se.jsxs)(zt,{size:"sm",onClick:l,disabled:t,className:"bg-neutral-900 text-white hover:bg-neutral-800 shadow-sm",children:[t&&(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Save & Redeploy"]}):(0,se.jsx)(zt,{size:"sm",onClick:n,disabled:t,className:"bg-neutral-900 text-white hover:bg-neutral-800 shadow-sm",children:"Save"})]})]})}function Gy(e){let t="",s=null;for(let a=0;a<e.length;a++){const n=e[a];s?"\\"===n&&a+1<e.length?(t+="  ",a++):n===s?(s=null,t+=n):t+=" ":(t+=n,'"'!==n&&"'"!==n&&"`"!==n||(s=n))}return t}const Ky="https://docs.base44.com/Building-your-app/Update-to-new-infrastructure",$y=hu({isMigrating:!1,isReverting:!1},{_nextMigrateModalShowTimeTs:{},_isMigrationNotificationsEnabled:!1}).use(rm("migrateToNewInfra",{pick:["_nextMigrateModalShowTimeTs"],storage:localStorage})).use(e=>{let t=null;const s=a=>{var n;if(!e._isMigrationNotificationsEnabled)return;const l=new Date("2026-01-25").getTime(),r=(new Date).getTime(),i=()=>{const e=Math.max(0,Math.min(12096e5,l-r)),t=Math.floor(Math.random()*e);return r+Math.max(864e5,t)},o=null!=(null===(n=e._nextMigrateModalShowTimeTs)||void 0===n?void 0:n[a])?e._nextMigrateModalShowTimeTs[a]:i();e._nextMigrateModalShowTimeTs=(0,ue.A)((0,ue.A)({},e._nextMigrateModalShowTimeTs),{},{[a]:o});let c=o-r;if(c<=0){const n=i();e._nextMigrateModalShowTimeTs=(0,ue.A)((0,ue.A)({},e._nextMigrateModalShowTimeTs),{},{[a]:n}),c=n-r,dS.openModal("MigrateToNewInfraModal",{closeAfterSec:5,onOpenChange:e=>{e||(clearTimeout(t),t=setTimeout(()=>s(a),c))}})}else clearTimeout(t),t=setTimeout(()=>s(a),c)};return{startShowingMigrateModalPeriodically:t=>{e._isMigrationNotificationsEnabled||(e._isMigrationNotificationsEnabled=!0,s(t))},stopShowingMigrateModalPeriodically:()=>{e._isMigrationNotificationsEnabled=!1,dS.closeModal("MigrateToNewInfraModal"),clearTimeout(t),t=null}}}).use(e=>({useMigrationNotifications:()=>{const{app:t}=lp(),s=(0,Y.useMemo)(()=>null!=t&&!0!==t.using_sandbox,[t,null==t?void 0:t.using_sandbox]);return(0,Y.useEffect)(()=>(s&&null!=t&&t.id?e.startShowingMigrateModalPeriodically(t.id):e.stopShowingMigrateModalPeriodically(),()=>{e.stopShowingMigrateModalPeriodically()}),[s,null==t?void 0:t.id]),{shouldMigrate:s}},useIsLegacyAppBlocked:()=>{const{app:e}=lp(),{hasFlag:t}=ej();return(0,Y.useMemo)(()=>null!=e&&!0!==e.using_sandbox,[e,null==e?void 0:e.using_sandbox])&&t(cj)}})),Zy={js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",json:"json",css:"css",html:"html",md:"markdown",gitignore:"plaintext"},Jy="javascript",Qy=e=>{if(!e)return Jy;if((e=>e.startsWith("entities/")||e.startsWith("agents/"))(e))return"json";const t=e.split(".").pop()||"";return Zy[t.toLowerCase()]||Jy};function Xy(e){let{filepath:t,selectedLine:s,onEdit:a,onSaveOrDiscard:n,isFunction:l,onRedeployFunction:r,functionHelperRef:i,cachedAppFiles:o,isLoadingAppFiles:c,shouldFetchFilesFromSandbox:d,onUpdateCachedFile:u}=e;const{user:m}=wd(),{app:x,writeCodeToFile:h,refreshApp:p}=lp(),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(""),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(!1),[_,k]=(0,Y.useState)(null),C=(0,Y.useRef)(null),A=(0,Y.useRef)(null),S="free"===(null==m?void 0:m.subscription_tier),E=$y.useIsLegacyAppBlocked(),T=S||E,I=(0,Y.useRef)(null),P=(0,Y.useRef)(""),[L,M]=(0,Y.useState)(null!=t?t:""),[R,D]=(0,Y.useState)(!0);(0,Y.useEffect)(()=>{t&&M(t)},[t]);const F=()=>{if(!(C.current&&s&&j&&N))return;const e=C.current,t=e.getModel();if(!t)return;const a=parseInt(s,10);if(isNaN(a)||a<=0)return;const n=t.getLineCount(),l=Math.min(a,n);requestAnimationFrame(()=>{requestAnimationFrame(()=>{try{const s=function(e,t,s){const a=e(t),n=a.match(/<([A-Za-z][A-Za-z0-9]*)/);if(!n)return t;const l=n[1];if(function(e,t){const s=e.indexOf("<".concat(t));if(-1===s)return!1;let a=s+t.length+1,n=null;for(;a<e.length;){const t=e[a];if(n)"\\"===t?a++:t===n&&(n=null);else if('"'===t||"'"===t||"`"===t)n=t;else if(">"===t)return"/"===e[a-1];a++}return!1}(a,l))return t;let r=1;for(let i=t;i<=s;i++){const s=Gy(e(i)),a=new RegExp("<".concat(l,"(?:\\s|>|/)"),"g"),n=(s.match(a)||[]).length;r+=i===t?n-1:n;const o=new RegExp("</".concat(l,">"),"g");r-=(s.match(o)||[]).length;const c=new RegExp("<".concat(l,"[^>]*/>"),"g");if(r-=(s.match(c)||[]).length,r<=0)return i}return t}(e=>t.getLineContent(e),l,n);e.revealLineInCenter(l,0),setTimeout(()=>{e.setPosition({lineNumber:l,column:1}),e.setSelection({startLineNumber:l,startColumn:1,endLineNumber:s,endColumn:t.getLineMaxColumn(s)}),e.focus()},50)}catch(s){}})})},O=()=>{if(C.current&&A.current){const e=C.current.getModel(),t=A.current;if(e&&t){const s=t.editor.getModelMarkers({resource:e.uri}).some(e=>e.severity===t.MarkerSeverity.Error);D(s)}}};(0,Y.useEffect)(()=>{if(L&&x){if(w(!1),C.current&&(I.current=C.current.saveViewState()),d&&o){const e=(e=>o&&o[e]||"")(L);b(e),P.current=e,w(!0)}else d&&c?(b(""),P.current="",w(!1)):(e=>{let t="";if("layout"===e)t=x.layout;else if(e.startsWith("pages/")){const s=e.split("pages/")[1];t=x.pages[s]}else if(e.startsWith("components/")){const s=e.split("components/")[1];t=x.components[s]}else if(e.startsWith("functions/")){const s=e.split("functions/")[1];t=x.functions[s]}else if(e.startsWith("entities/")){const s=e.split("entities/")[1];t=JSON.stringify(x.entities[s],null,2)}b(t),P.current=t,w(!0)})(L);if(C.current){const e=C.current.getModel();if(e){const t=e.onDidChangeDecorations(()=>{O(),t&&t.dispose&&t.dispose()})}}}},[L,x,d,o,c]),(0,Y.useEffect)(()=>{C.current&&I.current&&(C.current.restoreViewState(I.current),C.current.focus(),I.current=null)},[v,j]),(0,Y.useEffect)(()=>{s&&j&&N&&v&&F()},[s,j,N,v]),(0,Y.useEffect)(()=>{if(!C.current||!A.current)return;const e=C.current.getModel(),t=A.current;if(!e||!t)return;const s=t.editor.onDidChangeMarkers(t=>{t.some(t=>t.toString()===e.uri.toString())&&O()});return O(),()=>{s&&s.dispose&&s.dispose()}},[j,v]),(0,Y.useEffect)(()=>{k(null)},[L]);const U=v!==P.current,B=Qy(L),z=()=>(0,se.jsx)("div",{className:"h-full bg-white p-4 space-y-2 overflow-hidden",children:[...Array(6)].map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("div",{className:"h-4 w-8 bg-slate-200 rounded animate-shimmer bg-gradient-to-r from-slate-200 via-slate-100 to-slate-200 bg-[length:200%_100%]"}),(0,se.jsx)("div",{className:"h-4 bg-slate-200 rounded animate-shimmer bg-gradient-to-r from-slate-200 via-slate-100 to-slate-200 bg-[length:200%_100%]",style:{width:"".concat(40*Math.random()+20,"%")}})]},t))});return c?(0,se.jsx)("div",{className:"h-full flex flex-col",children:(0,se.jsx)("div",{className:"flex-1 relative min-h-0",children:(0,se.jsx)(z,{})})}):(0,se.jsxs)("div",{className:"h-full flex flex-col",children:[(0,se.jsxs)("div",{className:"flex-1 relative min-h-0",children:[(0,se.jsx)(pb.KE,{language:B,value:v,onChange:e=>{T||(b(e),C.current&&(I.current=C.current.saveViewState()),a&&a())},onMount:(e,t)=>{C.current=e,A.current=t,y(!0);const s=e.getModel();s&&s.onDidChangeContent(()=>{w(!0)})},options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:13,readOnly:T||g||c,padding:{top:T?40:0}},height:"100%"}),E&&(0,se.jsx)("div",{className:"absolute top-0 left-0 right-0 bg-amber-50 border-b border-amber-200 p-3 z-10 text-sm text-amber-800",children:"Code editing is disabled until you complete the infrastructure update."}),S&&!E&&(0,se.jsxs)("div",{className:"absolute top-0 left-0 right-0 bg-amber-50 border-b border-amber-200 p-3 z-10 text-sm text-amber-800",children:["Code editing is only available on paid plans.",(0,se.jsx)(Z.Link,{to:"/billing",className:"ml-2 text-blue-600 hover:underline",children:"Upgrade your plan"})]})]}),(0,se.jsx)(Yy,{isSaving:g,hasEditorErrors:R,onDiscard:()=>{var e;b(P.current),k(null),null!=i&&null!==(e=i.current)&&void 0!==e&&e.clearDeploymentError&&i.current.clearDeploymentError(),C.current&&I.current&&(C.current.restoreViewState(I.current),C.current.focus()),n&&n()},onSave:async()=>{f(!0);try{await(async e=>{T||(f(!0),await h(L,e),f(!1))})(v),P.current=v,u&&u(L,v),Wu.refreshPreview(),n&&n()}catch(e){}finally{f(!1)}},onSaveAndRedeploy:async()=>{var e;if(k(null),null!=i&&null!==(e=i.current)&&void 0!==e&&e.clearDeploymentError&&i.current.clearDeploymentError(),r){f(!0);try{await r(v),P.current=v,u&&u(L,v),await p(),setTimeout(()=>Wu.refreshPreview(),500),n&&n()}catch(t){k(t.message||"Failed to redeploy function")}finally{f(!1)}}},hasUnsavedChanges:U,isFunction:l,deploymentError:_,onClearError:()=>{k(null)}})]})}const eN=["className"],tN=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,eN);return(0,se.jsx)("textarea",(0,ue.A)({className:de("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t},a))});tN.displayName="Textarea";const sN=["className"],aN=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,sN);return(0,se.jsx)(dt.Root,(0,ue.A)({ref:t,className:de("text-regular text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",s)},a))});aN.displayName=dt.Root.displayName;const nN=(e,t)=>{var s;const{toast:a}=ao(),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null!==(s=null==t?void 0:t.initialResult)&&void 0!==s?s:null),[o,c]=(0,Y.useState)(null),d="string"==typeof(null==t?void 0:t.toastSuccess)?{title:"Success",description:t.toastSuccess}:null==t?void 0:t.toastSuccess,u="string"==typeof(null==t?void 0:t.toastError)?{title:"Error",description:t.toastError}:null==t?void 0:t.toastError;return{isLoading:n,update:async function(){l(!0);try{const s=await e(...arguments);return(null==t?void 0:t.toastSuccess)&&a(d),i(s),s}catch(o){(null==t?void 0:t.toastError)&&a((0,ue.A)((0,ue.A)({},u),{},{variant:"destructive"})),c(o)}finally{l(!1)}},result:r,error:o}},lN=e=>{var t,s;let{onSubmit:a}=e;const{app:n}=lp(),{isLoading:l,logoPrompt:r,defaultPrompt:i,handleRegenerateLogo:o,handleUploadLogo:c,handlePromptChange:d,handleUploadImageFile:u,logoUrl:m,isDirty:x}=(()=>{const{app:e}=lp(),t="A modern, minimalist logo for a business app",[s,a]=(0,Y.useState)(e.logo_prompt),[n,l]=(0,Y.useState)(e.logo_url);(0,Y.useEffect)(()=>()=>{l(void 0)},[]);const r=nN(async()=>{const a=await zc.generateLogoFromPrompt(e.id,{prompt:s||t});return l(a.logo_url),a.logo_url},{toastError:"Failed to regenerate logo"}),i=nN(async t=>{const s=await ip.uploadAppFile(t,e.id);return l(s.url),s.url},{toastError:"Failed to upload logo",initialResult:e.logo_url}),o=nN(async t=>{var s;const a=null!==(s=t.url)&&void 0!==s?s:(await ip.uploadAppFile(t.file,e.id)).url;return l(a),zc.updateLogo(e.id,{logo_url:a})},{toastSuccess:"Logo uploaded successfully",toastError:"Failed to upload logo"});return{isLoading:r.isLoading||o.isLoading||i.isLoading,logoPrompt:s,defaultPrompt:t,handleRegenerateLogo:r.update,handleUploadLogo:o.update,handleUploadImageFile:i.update,handlePromptChange:e=>a(e.target.value),logoUrl:n,isDirty:n!==e.logo_url}})(),[h,p]=(0,Y.useState)(!1),g=l||h;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex flex-col py-2 gap-3 items-center justify-center",children:[(0,se.jsx)("div",{className:"flex w-20 h-20 border-[1px] border-[rgba(0,0,0,0.1)] rounded-xl items-center justify-center",children:n.logo_url?(0,se.jsx)("img",{src:null!=m?m:n.logo_url,alt:"".concat(n.name," logo"),className:" w-full h-full object-contain rounded-xl",onLoadStart:()=>p(!0),onLoad:()=>p(!1)}):(0,se.jsx)("div",{className:"p-1 bg-gray-100 rounded-xl flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-xl font-bold text-gray-400",children:(null===(t=n.name)||void 0===t||null===(s=t[0])||void 0===s?void 0:s.toUpperCase())||"A"})})}),(0,se.jsxs)(Kj,{defaultValue:"upload",className:"w-full space-y-6",children:[(0,se.jsxs)($j,{className:"grid w-full grid-cols-2 bg-normal",children:[(0,se.jsx)(Zj,{value:"upload",className:"border-b-2 data-[state=active]:border-primary border-secondary rounded-none font-normal text-foreground",children:"Upload Logo"}),(0,se.jsx)(Zj,{value:"generate",className:"border-b-2 data-[state=active]:border-primary border-secondary rounded-none font-normal text-foreground",children:"Generate Logo"})]}),(0,se.jsx)(Jj,{value:"upload",className:" h-full rounded-lg",children:(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 hover:border-primary/50 transition-colors bg-gray-50 min-h-[170px]",onDragOver:e=>e.preventDefault(),onDrop:e=>{u(e.dataTransfer.files[0])},children:[(0,se.jsx)("input",{type:"file",id:"logo-upload",className:"hidden pointer-events-none ",disabled:g,accept:"image/*",onChange:e=>{u(e.target.files[0])}}),(0,se.jsxs)("label",{htmlFor:"logo-upload",className:"pointer-events-none text-center",children:[(0,se.jsx)("p",{className:"text-sm text-foreground ",children:"Drag and drop or click to upload"}),(0,se.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG up to 5MB"}),(0,se.jsx)(Bx,{disabled:g,variant:"outline",size:"tiny",className:"mt-3 pointer-events-auto",onClick:()=>{var e;null===(e=document.getElementById("logo-upload"))||void 0===e||e.click()},children:"Upload"})]})]})}),(0,se.jsxs)(Jj,{value:"generate",className:"space-y-1",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"logo-prompt",className:"text-muted-foreground",children:"What should your logo look like?"}),(0,se.jsx)(tN,{id:"logo-prompt",value:r,onChange:d,className:"min-h-[100px] rounded-lg",placeholder:i})]}),(0,se.jsx)(Bx,{onClick:o,disabled:g,variant:"secondary",size:"tiny",className:"w-full",children:g?"Generating...":"Generate new logo"})]})]})]}),(0,se.jsxs)("div",{className:"flex flex-row gap-2 items-center justify-end w-full",children:[(0,se.jsx)(Bx,{autoFocus:!x,variant:"outline",size:"tiny",onClick:a,children:"Cancel"}),(0,se.jsx)(Bx,{autoFocus:x,size:"tiny",onClick:async()=>{await c({url:m}),null==a||a()},disabled:g||!x,children:"Save"})]})]})},rN=e=>{Tu("Sandbox Migration - Clicked",{app_id:e})},iN=e=>{Tu("Sandbox Migration - Completed",{app_id:e})},oN=e=>{Tu("Sandbox Migration - Revert Clicked",{app_id:e})},cN=e=>{Tu("Sandbox Migration - Revert Completed",{app_id:e})},dN=()=>{const{app:e,refreshApp:t}=lp(),s=eu({toastSuccess:"Migration successful",toastError:"There was an issue with the migration",logErrorMsg:"Migration error",onLoading:e=>{$y.isMigrating=e},mutate:async()=>{if(null==e||!e.id)return;const s=await Gu.migrateToSandbox(e.id);var a;if(s&&!1===s.success)throw new Error(null!==(a=s.error)&&void 0!==a?a:"Failed to migrate app.");iN(e.id),await t(),Wu.refreshPreview()}}),a=eu({toastError:"There was an issue reverting to the old infrastructure",toastSuccess:"Revert successful",logErrorMsg:"Revert error",onLoading:e=>{$y.isReverting=e},mutate:async()=>{if(null==e||!e.id)return;const s=await Gu.revertSandboxMigration(e.id);var a;if(s&&!1===s.success)throw new Error(null!==(a=s.error)&&void 0!==a?a:"Failed to revert app.");cN(e.id),await t()}});return{handleMigrate:s.mutate,handleRevert:a.mutate}},uN=s.p+"static/media/migrate-to-new-infra-modal.f01d13d31b332879f013.png",mN=s.p+"static/media/migrate-to-new-infra-modal-mobile.7dbcae4c7700a073d17c.png";var xN=s(41186);const hN=["className","onAnimationStart"],pN=["className"],gN=["className"],fN=["className"],vN=["className"],bN=["className"],jN=["className"],yN=["className"],NN=ot.Root,wN=(ot.Trigger,ot.Portal),_N=Y.forwardRef((e,t)=>{let{className:s,onAnimationStart:a}=e,n=(0,Nt.A)(e,hN);const l=Eg({onAnimationStart:a});return(0,se.jsx)(ot.Overlay,(0,ue.A)({ref:t,className:de("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),onAnimationStart:l},n))});_N.displayName=ot.Overlay.displayName;const kN=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,pN);return(0,se.jsxs)(wN,{children:[(0,se.jsx)(_N,{}),(0,se.jsx)(ot.Content,(0,ue.A)({ref:t,className:de("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},a))]})});kN.displayName=ot.Content.displayName;const CN=e=>{let{className:t}=e,s=(0,Nt.A)(e,gN);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col space-y-2 text-center sm:text-left",t)},s))};CN.displayName="AlertDialogHeader";const AN=e=>{let{className:t}=e,s=(0,Nt.A)(e,fN);return(0,se.jsx)("div",(0,ue.A)({className:de("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};AN.displayName="AlertDialogFooter";const SN=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,vN);return(0,se.jsx)(ot.Title,(0,ue.A)({ref:t,className:de("text-lg font-semibold",s)},a))});SN.displayName=ot.Title.displayName;const EN=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,bN);return(0,se.jsx)(ot.Description,(0,ue.A)({ref:t,className:de("text-sm text-muted-foreground",s)},a))});EN.displayName=ot.Description.displayName;const TN=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,jN);return(0,se.jsx)(ot.Action,(0,ue.A)({ref:t,className:de(Bt(),s)},a))});TN.displayName=ot.Action.displayName;const IN=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,yN);return(0,se.jsx)(ot.Cancel,(0,ue.A)({ref:t,className:de(Bt({variant:"outline"}),"mt-2 sm:mt-0",s)},a))});IN.displayName=ot.Cancel.displayName;const PN=["appId"],LN=["appId"],MN=["appId"];class RN extends te.H{getBaseURL(){return"/apps"}enableEmail(e){const{appId:t}=e,s=(0,Nt.A)(e,PN);return this.axios.post("/".concat(t,"/custom-email-domains"),s)}configure(e){let{appId:t,domain:s}=e;return this.axios.post("/".concat(t,"/custom-email-domains/configure"),null,{params:{domain:s}})}listEmailDomains(e){let{appId:t}=e;return this.axios.get("/".concat(t,"/custom-email-domains"))}deleteEmailDomain(e){let{appId:t,domain:s}=e;return this.axios.delete("/".concat(t,"/custom-email-domains"),{params:{domain:s}})}updateSenderDetails(e){const{appId:t}=e,s=(0,Nt.A)(e,LN);return this.axios.patch("/".concat(t,"/custom-email-domains"),s)}replaceEmailDomain(e){const{appId:t}=e,s=(0,Nt.A)(e,MN);return this.axios.post("/".concat(t,"/custom-email-domains/replace"),s)}getConnectConfig(e){let{appId:t,domain:s}=e;return this.axios.get("/".concat(t,"/custom-email-domains/connect-config"),{params:{domain:s}})}}const DN=new RN;let FN=null;function ON(){const[e,t]=(0,Y.useState)(!!window.entri);return(0,Y.useEffect)(()=>{window.entri?t(!0):(FN||(FN=new Promise(e=>{const t=document.createElement("script");t.src="https://cdn.goentri.com/entri.js",t.async=!0,t.onload=()=>e(!0),t.onerror=()=>e(!1),document.body.appendChild(t)})),FN.then(e=>{e&&t(!0)}))},[]),{entriLoaded:e}}const UN=["pending_dns_configuration","pending_user_dns_configuration","pending_domain_verification","failed_provider_creation","failed_dns_configuration","failed_verification"],BN=e=>UN.includes(e),zN=e=>{var t,s,a,n,l,r,i;const o=(null===(t=e.purchase_info)||void 0===t?void 0:t.purchase_time)&&!(null!==(s=e.purchase_info)&&void 0!==s&&s.blocked)&&!(null!==(a=e.purchase_info)&&void 0!==a&&a.unlinked)&&"success"===(null===(n=e.purchase_info)||void 0===n||null===(l=n.propagation_status)||void 0===l?void 0:l.status),c=!(null!==(r=e.purchase_info)&&void 0!==r&&r.purchase_time)&&"verified"===(null===(i=e.last_status_payload)||void 0===i?void 0:i.verificationStatus);return o||c},HN=e=>{let{isOpen:t=!1,onClose:s=()=>{},appId:a,appName:n,eligibleDomains:l,onComplete:r,mode:i="create",initialSenderName:o,initialFromEmail:c}=e;const{toast:d}=ao(),{entriLoaded:u}=ON(),m=o||"".concat(n," App"),x="edit"===i?function(e){if(e)return e.split("@")[0]||"no-reply";return"no-reply"}(c):"no-reply",h="edit"===i&&c?{domain:c.split("@")[1]||""}:function(e,t){if(e&&t){const s=function(e){return e&&e.split("@")[1]||null}(e);if(s){const e=t.find(e=>e.domain===s);if(e)return e}}return(null==t?void 0:t[0])||null}(c,l),[p,g]=(0,Y.useState)(m),[f,v]=(0,Y.useState)(x),[b,j]=(0,Y.useState)(h),[y,N]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{t&&(g(m),v(x),j(h),N(null))},[t]);const w="edit"===i&&(null==b?void 0:b.domain)!==(null==h?void 0:h.domain),_=e=>{const t=e.toLowerCase();var s;v(t),N((s=t)?s.length>64?"Must be 64 characters or less":/^[a-z0-9][a-z0-9._-]*$/.test(s)?null:"Must be lowercase, start with a letter or number, and contain only letters, numbers, dots, hyphens, or underscores":"Address is required")},{mutate:k,isLoading:C}=eu({mutate:async()=>{if(!b)throw new Error("No domain selected");const e=await DN.enableEmail({appId:a,domain:b.domain,sender_name:p,from_email:"".concat(f,"@").concat(b.domain)});if(!e.external&&e.dns_records&&"pending_user_dns_configuration"===e.status){if(!u||!window.entri)return s(),d({title:"Domain connection needed",description:"Please retry from the email domain settings.",duration:5e3}),void r();try{const e=await DN.getConnectConfig({appId:a,domain:b.domain});s(),await window.entri.showEntri(e.config)}catch(t){return s(),d({title:"Domain connection needed",description:"Please retry from the email domain settings.",duration:5e3}),void r()}}else e.external&&e.dns_records?(s(),dS.openModal("DnsInstructionsModal",{dnsRecords:e.dns_records,domain:e.domain,flowType:"email_domain"})):s();"active"!==e.status&&d({title:"Email domain submitted.",description:e.external?"Please add DNS records to your domain provider.":"Verification may take up to 48 hours.",duration:5e3,icon:(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-500"})}),r()},onError:()=>{s(),r()}}),{mutate:A,isLoading:S}=eu({mutate:async()=>{if(!b)throw new Error("No domain selected");await DN.updateSenderDetails({appId:a,sender_name:p,from_email:"".concat(f,"@").concat(b.domain)}),s(),d({title:"Sender details updated.",duration:3e3,icon:(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-500"})}),r()},onError:()=>{s(),r()}}),{mutate:E,isLoading:T}=eu({mutate:async()=>{if(!b)throw new Error("No domain selected");const e=await DN.replaceEmailDomain({appId:a,domain:b.domain,sender_name:p,from_email:"".concat(f,"@").concat(b.domain)});if(!e.external&&e.dns_records&&"pending_user_dns_configuration"===e.status){if(!u||!window.entri)return s(),d({title:"Domain connection needed",description:"Please retry from the email domain settings.",duration:5e3}),void r();try{const e=await DN.getConnectConfig({appId:a,domain:b.domain});s(),await window.entri.showEntri(e.config)}catch(t){return s(),d({title:"Domain connection needed",description:"Please retry from the email domain settings.",duration:5e3}),void r()}}else e.external&&e.dns_records?(s(),dS.openModal("DnsInstructionsModal",{dnsRecords:e.dns_records,domain:e.domain,flowType:"email_domain"})):s();"active"!==e.status&&d({title:"Email domain submitted.",description:e.external?"Please add DNS records to your domain provider.":"Verification may take up to 48 hours.",duration:5e3,icon:(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-500"})}),r()},onError:()=>{s(),r()}}),I="edit"===i?w?T:S:C,P="edit"===i?"Edit sender details":"Set your sender details",L="edit"===i?"Save Changes":"Connect Domain",M="edit"===i?"Saving...":"Connecting...";return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&s(),children:(0,se.jsxs)(Hg,{className:"p-6 max-w-[425px] rounded-[10px] font-base44",children:[(0,se.jsxs)(Vg,{className:"gap-1.5",children:[(0,se.jsx)(qg,{className:"text-lg font-semibold leading-none",children:P}),(0,se.jsx)(Yg,{className:"text-sm leading-5",children:"Your users will get emails from these sender details."})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)(aN,{htmlFor:"sender-name",className:"text-sm font-medium",children:"Sender name"}),(0,se.jsx)(Df,{id:"sender-name",value:p,onChange:e=>g(e.target.value),placeholder:"".concat(n," App"),className:"h-9 px-3 py-2 text-sm rounded-lg"})]}),(null==l?void 0:l.length)>1?(0,se.jsxs)("div",{className:"flex gap-4",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-2 flex-1",children:[(0,se.jsx)(aN,{htmlFor:"custom-address",className:"text-sm font-medium",children:"Custom address"}),(0,se.jsx)(Df,{id:"custom-address",value:f,onChange:e=>_(e.target.value),placeholder:"no-reply",className:"h-9 px-3 py-2 text-sm rounded-lg"}),y&&(0,se.jsx)("p",{className:"text-sm text-red-500",children:y})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 flex-1",children:[(0,se.jsx)(aN,{className:"text-sm font-medium",children:"Domain"}),(0,se.jsxs)(Wf,{value:(null==b?void 0:b.domain)||"",onValueChange:e=>{const t=l.find(t=>t.domain===e);j(t)},children:[(0,se.jsxs)(Yf,{className:"h-9 rounded-lg",children:[(0,se.jsx)("span",{className:"text-gray-500 text-sm mr-1",children:"@"}),(0,se.jsx)(qf,{})]}),(0,se.jsx)($f,{children:l.map(e=>(0,se.jsx)(Zf,{value:e.domain,checkPosition:"right",children:e.domain},e.domain))})]})]})]}):(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)(aN,{htmlFor:"custom-address",className:"text-sm font-medium",children:"Custom address"}),(0,se.jsxs)("div",{className:"flex h-9 w-full rounded-lg border border-input bg-white shadow-xs overflow-hidden",children:[(0,se.jsx)("input",{id:"custom-address",value:f,onChange:e=>_(e.target.value),placeholder:"no-reply",className:"flex-1 min-w-0 bg-transparent px-3 py-2 text-sm outline-none placeholder:text-muted-foreground"}),(0,se.jsxs)("span",{className:"flex items-center px-3 text-gray-500 text-sm",children:["@",(null==b?void 0:b.domain)||"base44-apps.com"]})]}),y&&(0,se.jsx)("p",{className:"text-sm text-red-500",children:y})]}),(0,se.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:s,className:"px-4 py-2 rounded-lg",children:"Cancel"}),(0,se.jsx)(Bx,{onClick:()=>{w?E({}):"edit"===i?A({}):k({})},disabled:I||!!y||!b,className:"bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg",children:I?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 animate-spin"}),M]}):L})]})]})]})})},VN=e=>{let{isOpen:t=!1,onClose:s=()=>{},onAdd:a,loading:n=!1,onOpenDnsInstructions:l}=e;const[r,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)("");(0,Y.useEffect)(()=>{t&&(i(""),c(""))},[t]);return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&s(),children:(0,se.jsxs)(Hg,{className:"sm:max-w-[512px] p-6 rounded-[10px] gap-4 font-base44",children:[(0,se.jsxs)(Vg,{className:"gap-1.5",children:[(0,se.jsx)(qg,{className:"text-lg font-semibold leading-none",children:"Add New Domain"}),(0,se.jsx)(Yg,{className:"text-sm leading-5 text-gray-500",children:"Enter your domain name below. Make sure it follows the format: app.example.com"})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(Df,{placeholder:"Enter domain (e.g., app.example.com)",value:r,onChange:e=>{i(e.target.value),c("")},className:"h-9 px-3 py-2 text-sm rounded-lg ".concat(o?"border-red-500":"")}),o&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1 whitespace-pre-line",children:o})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("button",{type:"button",onClick:l,className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[(0,se.jsx)(Pj.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Configure DNS at register"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>{i(""),s()},className:"px-4 py-2 rounded-lg",children:"Cancel"}),(0,se.jsx)(Bx,{onClick:async()=>{if(!r.trim())return;const e=r.toLowerCase().trim();if(!/^(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/.test(e))return void c("This doesn't look like a valid domain.\nEnter a valid domain, e.g. example.com or app.example.com.");c("");await a(e)&&(i(""),s(),l())},disabled:n||!r.trim(),className:"bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg",children:n?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):"Add Domain"})]})]})]})]})})};var WN=s(16410),qN=s(16293),YN=s(78795),GN=s.n(YN);const KN=["cu","kp","sy","xn--ogbpf8fl","\u0633\u0648\u0631\u064a\u0629","ir","xn--mgba3a4f16a","\u0627\u06cc\u0631\u0627\u0646"];let $N=function(e){return e.INVALID_DOMAIN_NAME="INVALID_DOMAIN_NAME",e.DOMAIN_TOO_SHORT="DOMAIN_TOO_SHORT",e.DOMAIN_TOO_LONG="DOMAIN_TOO_LONG",e.INVALID_DASH_USAGE="INVALID_DASH_USAGE",e.LABEL_INVALID_CHARS="LABEL_INVALID_CHARS",e.TWO_CONSECUTIVE_DOTS="TWO_CONSECUTIVE_DOTS",e.OFAC_TLD="OFAC_TLD",e.GENERAL_ERROR="GENERAL_ERROR",e}({});const ZN=["\u05d9\u05e9\u05e8\u05d0\u05dc","co.az","la.gov","hz.de","as","in.gov","ll.land","co.pt","ag.org"],JN=e=>{if(!e)return{error:$N.DOMAIN_TOO_SHORT,input:e};if(e.input)return e;const t=e;if((e=>e.indexOf("..")>=0)(t))return{error:$N.TWO_CONSECUTIVE_DOTS,input:t};const s=XN(t);let a=(0,WN.qg)(ew(t));if("error"in a)return{error:QN[a.error.code],input:t};if(null==a.sld)return{error:$N.INVALID_DOMAIN_NAME,input:t};a=sw(a);const{domain:n,tld:l,sld:r,subdomain:i,input:o}=a,c=l&&(e=>KN.indexOf(e.toLowerCase())>=0)(l),d=(e=>!e||(0,qN.Pk)(e).length<1)(r);return{input:o,main:n,tld:l,sld:r,subdomain:i||null,error:(()=>{switch(!0){case c:return $N.OFAC_TLD;case d:return $N.DOMAIN_TOO_SHORT;default:return null}})(),isValidTld:tw(a),formattedInput:(0,qN.Pk)(s),asciiDomain:(0,qN.tl)(n),fullAsciiDomain:(0,qN.tl)(s)}},QN={DOMAIN_TOO_SHORT:$N.DOMAIN_TOO_SHORT,DOMAIN_TOO_LONG:$N.DOMAIN_TOO_LONG,LABEL_STARTS_WITH_DASH:$N.INVALID_DASH_USAGE,LABEL_ENDS_WITH_DASH:$N.INVALID_DASH_USAGE,LABEL_TOO_LONG:$N.DOMAIN_TOO_LONG,LABEL_TOO_SHORT:$N.DOMAIN_TOO_SHORT,LABEL_INVALID_CHARS:$N.LABEL_INVALID_CHARS},XN=e=>{let t=e.trim();t.endsWith(".")&&(t=t.slice(0,-1));const s=(e=>{const t=e.split(".");return 3===t.length?"".concat(t[1],".").concat(t[2]):t[1]})(t);return s&&"."!==s?t.startsWith("www.")&&t.split(".").length<=2?"".concat(t,".com"):t:"".concat(t,".com").replace(/\.{2,}/,".")},ew=e=>{const t=e.trimEnd().toLowerCase().replace(/^(www\.)/,"");return XN(t)},tw=e=>{if(!e.tld)return!1;const t=(0,WN.fn)(e.input);return!(t||!ZN.includes(e.tld))||t},sw=(GN().getAllCodes(),e=>{var t,s,a;const n=null!==(t=null===(s=ew(e.input))||void 0===s?void 0:s.split("."))&&void 0!==t?t:[];if(n.length<2)return e;let l=n.pop();l&&!ZN.includes(l)&&(l="".concat(n.pop(),".").concat(l));const r=null!==(a=n.pop())&&void 0!==a?a:null,i=n.join(".");return l&&ZN.includes(l)&&r?(0,ue.A)((0,ue.A)({},e),{},{tld:l,sld:r,domain:"".concat(r,".").concat(l),subdomain:i}):e}),aw=e=>{let{text:t}=e;const[s,a]=Y.useState(!1);return(0,se.jsx)("button",{onClick:async()=>{await navigator.clipboard.writeText(t),a(!0),setTimeout(()=>a(!1),2e3)},className:"p-1 hover:bg-gray-100 rounded transition-colors",title:"Copy to clipboard",children:s?(0,se.jsx)(Ds.A,{className:"h-3.5 w-3.5 text-green-500"}):(0,se.jsx)(ob.A,{className:"h-3.5 w-3.5 text-gray-400"})})},nw=()=>(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3 text-sm",children:(0,se.jsxs)("ol",{className:"list-decimal pl-5 space-y-3 text-foreground",children:[(0,se.jsxs)("li",{children:["Add CNAME record:"," ",(0,se.jsx)("code",{className:"bg-muted border border-gray-200 px-2 py-0.5 rounded text-xs font-mono",children:"www \u2192 base44.onrender.com"})]}),(0,se.jsxs)("li",{children:["Add ANAME/ALIAS record:"," ",(0,se.jsx)("code",{className:"bg-muted border border-gray-200 px-2 py-0.5 rounded text-xs font-mono",children:"empty or @ \u2192 base44.onrender.com"})]}),(0,se.jsxs)("li",{children:["If your DNS provider doesn't support ANAME/ALIAS, use A record:",(0,se.jsx)("br",{}),(0,se.jsx)("code",{className:"bg-muted border border-gray-200 px-2 py-0.5 rounded text-xs font-mono",children:"@ \u2192 216.24.57.1"})]}),(0,se.jsx)("li",{children:"Remove any AAAA records from your domain while configuring DNS. AAAA records map to an IPv6 address, and Base44 uses IPv4. These records can cause unexpected behavior for your custom domain."})]})}),(0,se.jsx)("div",{className:"space-y-2 text-sm text-gray-500",children:(0,se.jsx)("p",{children:"Please note, after adding DNS records, it may take some time for changes to fully propagate across the internet. During this time, the domain may not work properly."})})]}),lw=e=>{let{dnsRecords:t,domain:s}=e;return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("p",{className:"text-sm text-foreground",children:["1. Add these DNS records to your domain provider for ",s||"{domain name}",":"]}),(0,se.jsx)("div",{className:"border border-gray-200 rounded-[10px] overflow-hidden w-full",children:(0,se.jsxs)("table",{className:"w-full text-sm table-fixed",children:[(0,se.jsx)("thead",{children:(0,se.jsxs)("tr",{className:"bg-gray-100",children:[(0,se.jsx)("th",{className:"px-4 py-2 text-left font-medium text-muted-foreground border-t border-gray-200 w-[80px]",children:"Type"}),(0,se.jsx)("th",{className:"px-4 py-2 text-left font-medium text-muted-foreground border-t border-l border-gray-200",children:"Name"}),(0,se.jsx)("th",{className:"px-4 py-2 text-left font-medium text-muted-foreground border-t border-l border-gray-200",children:"Value"})]})}),(0,se.jsx)("tbody",{children:null==t?void 0:t.map((e,t)=>{const a=((e,t)=>{if(!t)return e;const s=JN(t);if(s.error||!s.main)return e;const a=".".concat(s.main);return e.endsWith(a)?e.slice(0,-a.length):e})(e.name,s);return(0,se.jsxs)("tr",{children:[(0,se.jsx)("td",{className:"px-4 py-1.5 text-sm border-t border-gray-200",children:e.type}),(0,se.jsx)("td",{className:"px-4 py-1.5 border-t border-l border-gray-200",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,se.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded-md text-sm font-mono truncate min-w-0 flex-1",title:a,children:a}),(0,se.jsx)(aw,{text:a})]})}),(0,se.jsx)("td",{className:"px-4 py-1.5 border-t border-l border-gray-200",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,se.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded-md text-sm font-mono truncate min-w-0 flex-1",title:e.value,children:e.value}),(0,se.jsx)(aw,{text:e.value})]})})]},t)})})]})})]}),(0,se.jsxs)("p",{className:"text-sm text-foreground",children:["2. Once configured, click '",(0,se.jsx)("span",{className:"font-semibold",children:"Verify"}),"' on the email domain card to verify the setup. DNS changes may take up to 48 hours to propagate."]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please note, after adding DNS records, changes may take up to 48 hours to propagate. During this time, emails will be sent from current email address."})]})},rw=e=>{let{isOpen:t=!1,onClose:s=()=>{},dnsRecords:a,domain:n,flowType:l="custom_domain"}=e;const r="email_domain"===l,i=r?"Configure DNS for email domain":"Connect your domain through your DNS provider",o=r?"Follow the instructions below to configure DNS records.":"Add these records in your provider's dashboard to finish setup.";return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&s(),children:(0,se.jsxs)(Hg,{className:"sm:max-w-[600px] rounded-[10px] font-base44 ".concat(r?"p-0 gap-0":"p-6"),children:[(0,se.jsxs)(Vg,{className:"gap-1.5 ".concat(r?"p-6 pb-0":""),children:[(0,se.jsx)(qg,{className:"text-lg font-semibold leading-none",children:i}),(0,se.jsx)(Yg,{className:"text-sm text-muted-foreground",children:o})]}),r?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex flex-col gap-4 px-6 pt-4",children:[(0,se.jsx)(lw,{dnsRecords:a,domain:n}),(0,se.jsx)("div",{className:"flex justify-end py-2",children:(0,se.jsx)(Bx,{onClick:s,className:"bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg",children:"Done"})})]}),(0,se.jsx)("div",{className:"bg-slate-100 border-t border-gray-200 rounded-b-[10px] px-6 py-3",children:(0,se.jsxs)("p",{className:"text-sm text-foreground",children:["Need help? Create a ticket at"," ",(0,se.jsx)("button",{type:"button",onClick:()=>{window.open("/support","_blank")},className:"underline hover:text-gray-700 transition-colors",children:"support system"})]})})]}):(0,se.jsxs)("div",{className:"flex flex-col gap-4 pt-2",children:[(0,se.jsx)(nw,{}),(0,se.jsx)("div",{className:"text-sm text-gray-500",children:(0,se.jsxs)("p",{children:["Need help? Create a ticket at"," ",(0,se.jsx)("button",{type:"button",onClick:()=>{window.open("/support","_blank")},className:"underline hover:text-gray-700 transition-colors",children:"support system"})]})}),(0,se.jsx)("div",{className:"flex justify-end pt-2",children:(0,se.jsx)(Bx,{onClick:s,className:"bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg",children:"Done"})})]})]})})};class iw extends te.H{getBaseURL(){return"/billing"}createCheckoutSession(e){return this.axios.post("/create-checkout-session/".concat(e))}createPortalSession(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.axios.post("/create-portal-session",{},{params:{flow_type:e}})}updateSubscription(e){return this.axios.post("/update-subscription/".concat(e))}cancelSchedule(){return this.axios.delete("/cancel-schedule")}createWorkspaceCheckoutSession(e,t){return this.axios.post("/create-workspace-checkout-session",{workspace_id:e,pending_changes:t})}getInvoices(){return this.axios.get("/invoices")}}const ow=new iw,cw=e=>{let{question:t,answer:s}=e;const[a,n]=(0,Y.useState)(!1);return(0,se.jsxs)("div",{className:"border-b border-gray-200 py-4",children:[(0,se.jsxs)("button",{className:"flex justify-between items-center w-full text-left",onClick:()=>n(!a),children:[(0,se.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:t}),(0,se.jsx)("span",{className:"text-gray-600 transition-transform duration-300 ".concat(a?"rotate-180":""),children:(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,se.jsx)("polyline",{points:"6 9 12 15 18 9"})})})]}),(0,se.jsx)(Mx.N,{children:a&&(0,se.jsx)(Rx.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,se.jsx)("div",{className:"pt-4 pb-2 text-gray-600",children:s})})})]})};function dw(){const e=[{question:"What is Base44?",answer:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{children:"Base44 is an AI-powered platform that allows you to build custom software applications without coding. It uses natural language processing to understand your requirements and generate functional software based on your descriptions."}),(0,se.jsx)("p",{children:"Our platform is designed to be user-friendly and accessible to non-technical users, enabling you to create powerful applications through simple conversations with our AI."})]})},{question:"What's included in the free plan?",answer:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{children:"The free plan gives you a daily allowance of 5 messages and a monthly cap of 25 messages total. You also get 100 integration credits to experiment with various integrations like authentication, database, and analytics."}),(0,se.jsx)("p",{children:"With the free plan, you have access to all core integration types, allowing you to build fully functional applications with user authentication, data storage, and more - all at no cost."})]})},{question:"What are integration credits?",answer:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{children:"Integration credits are used to access Base44's various integrations within your application."}),(0,se.jsx)("p",{children:"These integrations enhance your app's functionality, including LLMs, file uploading, image understanding, image generation, email sending, SMS sending, database querying, and many more. The number of integration credits in your plan determines how many of these requests you can make per month."}),(0,se.jsx)("p",{children:"Unused credits expire at the end of your monthly billing cycle (on your reset date)."}),(0,se.jsx)("p",{children:(0,se.jsx)("a",{href:"https://docs.base44.com/Getting-Started/Credits#credits",target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 hover:text-orange-600 underline",children:"Learn more about how credits are used in the Knowledge Base."})})]})},{question:"What types of applications can I build with Base44?",answer:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{children:"Base44 is versatile and can be used to build a wide range of applications, including but not limited to: fully functional SaaS products, backoffice tools, personal productivity apps, customer portals, and business process automation tools."}),(0,se.jsx)("p",{children:"You can also use it for rapid prototyping and creating MVPs, allowing you to validate your ideas quickly without investing in expensive development resources."})]})},{question:"Who owns the applications created with Base44?",answer:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{children:"Between you and Base44, all applications and content generated through our platform shall be considered your property. We make no ownership claims over anything you create using Base44.          "}),(0,se.jsx)("p",{children:"Your intellectual property remains yours, and you're free to use, modify, distribute, or sell the generated applications as permitted by law.          "})]})},{question:"How are Base44 applications deployed?",answer:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{children:"With Base44, deployment is incredibly simple. Your applications are instantly usable and shareable as soon as you create them. Simply use and share the URL of your app with others."}),(0,se.jsx)("p",{children:"There's no need for separate hosting or deployment steps, making it incredibly easy to get your application up and running quickly."})]})},{question:"What happens if I reach my plan limits?",answer:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{children:"When you reach your daily message limit, you'll need to wait until the next day to send more messages. If you hit your monthly limit, you won't be able to send additional messages or make integration requests until the beginning of your next billing cycle."}),(0,se.jsx)("p",{children:"To avoid interruptions in your app development and usage, you can upgrade to a higher tier plan with increased limits at any time from your billing dashboard."})]})}];return(0,se.jsxs)("div",{className:" rounded-xl p-8 mt-12",children:[(0,se.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-gray-800",children:"Frequently Asked Questions"}),(0,se.jsx)("div",{className:"divide-y divide-gray-200",children:e.map((e,t)=>(0,se.jsx)(cw,{question:e.question,answer:e.answer},t))})]})}var uw=s(34799);function mw(){const{toast:e}=ao(),{activeWorkspace:t}=qd(),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(null);if((0,Y.useEffect)(()=>{(async()=>{if(null!=t&&t.id)try{l(!0),i(null);const e=await Hd.getMySeatInfo(t.id);a(e)}catch(s){i(s),e({variant:"destructive",title:"Error",description:"Failed to load workspace billing information"})}finally{l(!1)}})()},[null==t?void 0:t.id,e]),n)return(0,se.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-slate-700"})});if(r||!s)return(0,se.jsx)(Dt,{className:"border-red-200 bg-red-50",children:(0,se.jsx)(Ot,{className:"text-red-800",children:"Unable to load workspace billing information. Please try again later."})});const o=null==s?void 0:s.user_seat,c=null==s?void 0:s.workspace,d=null==s?void 0:s.is_admin,u=(null==s?void 0:s.workspace_admins)||[];return(0,se.jsxs)("div",{className:"space-y-6",children:["assigned"===(null==o?void 0:o.status)?(0,se.jsx)(Es,{className:"border-slate-200",children:(0,se.jsx)(Ls,{className:"pt-6 space-y-4",children:(0,se.jsxs)("div",{children:[(0,se.jsxs)("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:[o.seat_type," Plan",(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-slate-400 hover:text-slate-600 ml-2 inline"})}),(0,se.jsx)(Ki,{children:(0,se.jsxs)("p",{children:["Seat #",o.seat_id]})})]})})]}),(0,se.jsxs)("p",{className:"text-slate-700 mb-4",children:["You're currently on the ",o.seat_type," plan. To make changes, please contact your workspace ",u.some(e=>"owner"===e.role)?"owner":"administrator","."]}),(0,se.jsxs)("div",{className:"space-y-2",children:[u.filter(e=>"owner"===e.role).map((e,t)=>(0,se.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,se.jsx)("span",{className:"font-medium",children:"Workspace owner:"})," ",e.email]},t)),u.filter(e=>"admin"===e.role).map((e,t)=>(0,se.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,se.jsx)("span",{className:"font-medium",children:"Workspace admin:"})," ",e.email]},t))]})]})})}):(0,se.jsx)(Es,{className:"border-slate-200",children:(0,se.jsx)(Ls,{className:"pt-6 space-y-4",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"Viewer Access"}),(0,se.jsxs)("p",{className:"text-slate-700 mb-4",children:["You currently have viewer access in this workspace. To get a seat with full access, please contact your workspace ",u.some(e=>"owner"===e.role)?"owner":"administrator","."]}),(0,se.jsxs)("div",{className:"space-y-2",children:[u.filter(e=>"owner"===e.role).map((e,t)=>(0,se.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,se.jsx)("span",{className:"font-medium",children:"Workspace owner:"})," ",e.email]},t)),u.filter(e=>"admin"===e.role).map((e,t)=>(0,se.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,se.jsx)("span",{className:"font-medium",children:"Workspace admin:"})," ",e.email]},t))]})]})})}),d&&(0,se.jsxs)(Dt,{className:"bg-teal-50 border-teal-200",children:[(0,se.jsx)(uw.A,{className:"h-4 w-4"}),(0,se.jsxs)(Ot,{className:"text-teal-800",children:[(0,se.jsx)("strong",{children:"Administrator Access:"})," Visit the"," ",(0,se.jsx)("a",{href:"/workspace/".concat(c.id),className:"underline font-medium hover:text-teal-900",children:"workspace dashboard"})," ","to manage seats, billing, and team members."]})]})]})}var xw=s(85667);const hw="GTM-5WLCSX6J",pw=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.dataLayer=window.dataLayer||[],window.dataLayer.push((0,ue.A)({event:e,event_id:(0,xw.A)().toString()},t))};function gw(){const e=(0,J.zy)();return(0,Y.useEffect)(()=>{!function(){if(document.getElementById("gtm-script"))return;const e=document.createElement("script");e.id="gtm-script",e.innerHTML="\n    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n    })(window,document,'script','dataLayer','".concat(hw,"');\n  "),document.head.prepend(e)}(),function(){if(document.getElementById("gtm-noscript"))return;const e=document.createElement("noscript");e.id="gtm-noscript",e.innerHTML='\n    <iframe src="https://www.googletagmanager.com/ns.html?id='.concat(hw,'"\n    height="0" width="0" style="display:none;visibility:hidden"></iframe>\n  '),document.body.prepend(e)}()},[]),(0,Y.useEffect)(()=>{pw("pageview",{page_path:e.pathname})},[e]),null}var fw=s(90386),vw=s.n(fw);function bw(){return(0,se.jsx)("div",{className:"relative h-full flex flex-col",children:(0,se.jsxs)("div",{className:"bg-white rounded-[20px] p-6 flex flex-col min-h-[480px] h-full animate-pulse",children:[(0,se.jsxs)("div",{className:"mb-5",children:[(0,se.jsx)("div",{className:"flex items-center mb-5",children:(0,se.jsx)("div",{className:"h-6 bg-gray-200 rounded w-20"})}),(0,se.jsxs)("div",{className:"flex items-end mb-2",children:[(0,se.jsx)("div",{className:"h-8 bg-gray-200 rounded w-12"}),(0,se.jsx)("div",{className:"h-8 bg-gray-200 rounded w-12 ml-1"}),(0,se.jsx)("div",{className:"h-6 bg-gray-200 rounded w-8 ml-1"})]})]}),(0,se.jsx)("div",{className:"mb-6 px-2",children:(0,se.jsx)("div",{className:"h-[1px] bg-[#ECECEC]"})}),(0,se.jsx)("div",{className:"mb-6",children:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("div",{className:"h-4 bg-gray-200 rounded w-44"}),(0,se.jsx)("div",{className:"h-4 bg-gray-200 rounded w-40"})]})}),(0,se.jsx)("div",{className:"mb-4",children:(0,se.jsx)("div",{className:"h-10 bg-gray-200 rounded-[8px] w-full"})}),(0,se.jsx)("div",{className:"my-4 px-2",children:(0,se.jsx)("div",{className:"h-[1px] bg-[#ECECEC]"})}),(0,se.jsxs)("div",{className:"space-y-1 flex-grow",children:[(0,se.jsx)("div",{className:"h-4 bg-gray-200 rounded w-28 mb-2"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-4/5"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-4/5"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})})}const jw=["className"],yw=["className"],Nw=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,jw);return(0,se.jsx)(sr.bL,(0,ue.A)((0,ue.A)({className:de("grid gap-2",s)},a),{},{ref:t}))});Nw.displayName=sr.bL.displayName;const ww=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,yw);return(0,se.jsx)(sr.q7,(0,ue.A)((0,ue.A)({ref:t,className:de("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s)},a),{},{children:(0,se.jsx)(sr.C1,{className:"flex items-center justify-center",children:(0,se.jsx)(Ba.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}))});ww.displayName=sr.q7.displayName;const _w=["trackingAction","ctaText","trackingContext","onClick","children"],kw=["user_email"],Cw=e=>{let{trackingAction:t,ctaText:s,trackingContext:a={},onClick:n,children:l}=e,r=(0,Nt.A)(e,_w);const i=wd(),o=qd();let c=null,d=null;try{c=(null==i?void 0:i.user)||null}catch(u){}try{d=(null==o?void 0:o.activeWorkspace)||null}catch(u){}return(0,se.jsx)(Bx,(0,ue.A)((0,ue.A)({},r),{},{onClick:e=>{try{var l,r,i,o;const e=a,{user_email:n}=e,u=(0,Nt.A)(e,kw),b=(0,ue.A)({action:t||"unknown_action",element_type:"button",user_id:(null===(l=c)||void 0===l?void 0:l.id)||null,workspace_id:(null===(r=d)||void 0===r?void 0:r.id)||null,workspace_name:(null===(i=d)||void 0===i?void 0:i.name)||null,is_workspace_context:!(!d||d.is_personal),is_personal_workspace:(null===(o=d)||void 0===o?void 0:o.is_personal)||!1},u);try{var m,x;Tu("User - Click",(0,ue.A)((0,ue.A)({},b),{},{user_email_domain:null!==(m=c)&&void 0!==m&&m.email?null===(x=c.email.split("@")[1])||void 0===x?void 0:x.toLowerCase():null}))}catch(f){}try{var h,p,g;Vu({user_id:null!==(h=null===(p=c)||void 0===p?void 0:p.id)&&void 0!==h?h:null},(0,ue.A)({cta:s||"Unknown CTA",origin:(null==a?void 0:a.origin)||"Unknown",target_route:(null==a?void 0:a.target_route)||null,user_email:(null===(g=c)||void 0===g?void 0:g.email)||null},a))}catch(v){}}catch(u){}try{null==n||n(e)}catch(u){throw u}},children:l}))},Aw=["billingAction","ctaText","billingContext","children"],Sw=e=>{let{billingAction:t,ctaText:s,billingContext:a={},children:n}=e,l=(0,Nt.A)(e,Aw),r={};try{r=(0,ue.A)({origin:"BillingPage",target_route:"/billing",element_type:"button"},a)}catch(i){r={origin:"BillingPage",element_type:"button"}}return(0,se.jsx)(Cw,(0,ue.A)((0,ue.A)({trackingAction:t||"unknown_billing_action",ctaText:s||"Unknown Button",trackingContext:r},l),{},{children:n}))},Ew=e=>{let{text:t,variant:s="default",disabled:a=!1,showX:n=!1,showGift:l=!1}=e;return(0,se.jsxs)("div",{className:"flex items-center text-sm ".concat(a?"text-gray-400":"text-gray-600"),children:[n?(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 mr-3 flex-shrink-0 text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M18 6 6 18"}),(0,se.jsx)("path",{d:"m6 6 12 12"})]}):l?(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-7 h-7 mr-3 flex-shrink-0 rounded-full p-1.5 ".concat(a?"text-gray-400":"text-teal-600"),style:{backgroundColor:"#F0FFE1"},width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("rect",{x:"3",y:"8",width:"18",height:"4",rx:"1"}),(0,se.jsx)("path",{d:"M12 8v13"}),(0,se.jsx)("path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"}),(0,se.jsx)("path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"})]}):(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 mr-3 flex-shrink-0 ".concat(a?"text-gray-400":"text-teal-600"),width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,se.jsx)("path",{d:"M20 6L9 17l-5-5"})}),(0,se.jsx)("span",{className:"text-left font-light base44-font ".concat(a?"text-gray-400":"text-black"),children:t})]})};function Tw(e){if(!e)return"0";const t=parseInt(e.toString(),10);return t>=1e3?"".concat((t/1e3).toFixed(t%1e3==0?0:1),"k"):t.toString()}function Iw(e){return Boolean(e&&(e.endsWith("_yearly")||e.includes("_yearly_")))}function Pw(e){return e?Fj(e):""}function Lw(e){return"".concat(e,"_yearly")}function Mw(e){return e?e.replace(/starter25/gi,"Starter").replace(/\s*ils\s*/gi,"").replace(/\s*(yearly|Yearly)\s*/gi,"").replace(/\s*plan\s*/gi,"").replace(/\s*\.\.\.\s*/g,"").replace(/\s+/g," ").trim():""}function Rw(e){var t,s,a;return null!=e&&null!==(t=e.currency)&&void 0!==t&&t.symbol?e.currency.symbol:null!=e&&null!==(s=e.pricing)&&void 0!==s&&null!==(a=s.currency)&&void 0!==a&&a.symbol?e.pricing.currency.symbol:"$"}function Dw(e,t){let s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:uv;if(!function(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:uv).yearlyOnly||"yearly"===e}(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"yearly",a))return!1;const n="elite"===e&&void 0!==t?t:e;if(!function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:uv).eligibleTiers.includes(e.toLowerCase())}(n,a))return!1;if(s){const e=["free","starter","builder","pro","elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"],t=Pw(s).toLowerCase(),a=n.toLowerCase(),l=e.indexOf(t),r=e.indexOf(a);if(-1!==l&&-1!==r&&l>r)return!1}return!0}const Fw=["user_email"];function Ow(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var a;const{user_email:n}=s,l=(0,Nt.A)(s,Fw);Tu("Billing - Click",(0,ue.A)({action:t},l)),Vu({user_id:null!==(a=null==e?void 0:e.user_id)&&void 0!==a?a:null},(0,ue.A)({cta:t,origin:s.origin||"BillingPage",target_route:"/billing"},s))}catch(n){}}const Uw=e=>{var t,s;let{period:a,isSaleEnabled:n=!1,plan:l,monthlyPlan:r,features:i,isSelected:o,isExpanded:c,onSelect:d,onExpansionToggle:u,onYearlySelect:m,disabled:x=!1,userId:h,stats:p,planType:g}=e;const f=(null==l||null===(t=l.metadata)||void 0===t?void 0:t.monthly_message_limit)||0,v=(null==l||null===(s=l.metadata)||void 0===s?void 0:s.monthly_integration_credits)||0,b=(null==l?void 0:l.nickname)||"",j=Mw(b),y=b.toLowerCase().includes("starter"),N=n&&"header"!==a&&Dw(g,void 0,a);let w,_;if("yearly"===a){const e=l.unit_amount/100/12;w=N?Math.ceil(e*(1-uv.discountPercent)).toString():e.toFixed(0),_=" x 12 months"}else{w=(l.unit_amount?l.unit_amount/100:0).toFixed(0),_=" / every month"}const k="yearly"===a?"Yearly":"Monthly",C=(()=>{if("yearly"!==a||null==r||!r.unit_amount||null==l||!l.unit_amount)return 0;const e=12*r.unit_amount-l.unit_amount;return Math.round(e/100)})();return(0,se.jsx)(Qj,{open:c,onOpenChange:()=>{Ow({user_id:h||null},c?"plan_collapse":"plan_expand",(0,ue.A)((0,ue.A)({origin:"CollapsiblePlanOption"},"header"!==a&&{billing_period:a}),{},{selected_plan_type:j.toLowerCase(),expansion_state:c?"collapsed":"expanded",element_type:"toggle"})),u()},onClick:()=>{Ow({user_id:h||null},"select_period",(0,ue.A)((0,ue.A)({origin:"CollapsiblePlanOption"},"header"!==a&&{billing_period:a}),{},{selected_plan_type:j.toLowerCase(),element_type:"radio"})),d()},children:(0,se.jsxs)("div",{className:"font-base44 bg-white cursor-pointer rounded-[12px] ".concat(o?"border border-black":"border border-transparent"," ").concat(o?"":"hover:bg-gray-50"," ").concat(x?"text-gray-200":""," ").concat("yearly"===a?"mb-4":""," transition-all duration-200"),children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-6",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-3 sm:space-x-4 flex-1 cursor-pointer",children:[(0,se.jsx)(ww,{value:a,id:a,className:o?"border-black text-black":""}),(0,se.jsx)("div",{className:"text-left flex-1 min-w-0",children:(0,se.jsxs)("label",{htmlFor:a,className:"text-base sm:text-lg flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3 ".concat(x?"text-gray-400":"text-gray-900"),children:[(0,se.jsx)("span",{className:"font-bold",children:k}),(0,se.jsx)("span",{className:"hidden sm:block h-px w-4 bg-gray-300"}),(0,se.jsxs)("span",{className:"font-normal text-sm sm:text-base",children:[Rw(p),w,_]}),N&&(0,se.jsxs)("span",{className:"font-normal text-sm sm:text-base text-gray-400 line-through",children:[Rw(p),(l.unit_amount/100/12).toFixed(0),_]})]})})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-shrink-0",children:["yearly"===a&&C>0&&(0,se.jsx)(se.Fragment,{children:N?(0,se.jsxs)("span",{className:"px-2 sm:px-4 py-1 text-xs sm:text-sm font-bold ".concat(o?"bg-orange-50":"bg-white"," bg-gradient-to-r from-[#FFA67C] to-[#FF8047] rounded-full"),children:[mv()," OFF"]}):(0,se.jsxs)("span",{className:"px-2 sm:px-4 py-1 text-xs sm:text-sm font-bold ".concat(o?"bg-[#F0FFE1]":""," text-[#00A184] rounded-lg border border-[#00A184]"),children:["SAVE ",Rw(p),C]})}),(0,se.jsx)(Xj,{asChild:!0,children:(0,se.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded",children:c?(0,se.jsx)(ur.A,{className:"h-5 w-5 text-gray-400"}):(0,se.jsx)(_t.A,{className:"h-5 w-5 text-gray-400"})})})]})]}),(0,se.jsx)(ey,{children:(0,se.jsxs)("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6",children:[(0,se.jsx)("div",{className:"border-t border-gray-200"}),(0,se.jsx)("div",{className:"mt-4 mb-6",children:(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsxs)("div",{className:"text-sm flex items-center gap-2 ".concat(x?"text-gray-400":"text-gray-900 bg-slate-100 px-4 py-2 rounded-lg w-fit"),children:[(0,se.jsx)("span",{className:"font-bold",children:Tw(f)}),(0,se.jsx)("span",{className:"text-black",children:"Monthly credits"})]}),(0,se.jsxs)("div",{className:"text-sm flex items-center gap-2 ".concat(x?"text-gray-400":"text-gray-900 bg-slate-100 px-4 py-2 rounded-lg w-fit"),children:[(0,se.jsx)("span",{className:"font-semibold",children:Tw(v)}),(0,se.jsx)("span",{className:"text-black",children:"Integration credits"})]})]})}),!y&&(0,se.jsxs)("div",{className:"mb-4 ".concat("monthly"===a?"bg-slate-50 p-3 sm:p-4 rounded-lg border border-gray-200":""),children:[(0,se.jsx)("h4",{className:"text-sm font-bold mb-3",children:"monthly"===a?"NOTE: Monthly subscription doesn't include:":"What's included with the ".concat(a," plan")}),(0,se.jsx)("div",{className:"space-y-2",children:!y&&("yearly"===a||"monthly"===a)&&{yearly:["Enjoy a special discount and save money","Get a free domain for 1 year","Receive 25 credits to share with a friend"],monthly:["Special discount and savings","Free domain for 1 year","25 credits to share with a friend"]}[a].map((e,t)=>(0,se.jsx)(Ew,{text:e,disabled:x,showX:"monthly"===a,showGift:"yearly"===a},"additional-".concat(t)))}),"monthly"===a&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"border-t border-gray-200 mt-4"}),(0,se.jsxs)("p",{className:"mt-4 text-sm",children:["Choose a ",(0,se.jsx)("span",{className:"text-blue-500 cursor-pointer hover:underline",onClick:()=>{null==m||m()},children:"yearly"})," subscription to get the most from your premium plan"]})]})]})]})})]})})},Bw=e=>{var t,s;let{selectedPlanType:a,stats:n,onSubscribe:l,onBack:r,selectedEliteTier:i,isUpgradeFlow:o=!1,onUpgrade:c,userId:d,isSaleEnabled:u=!1}=e;const[m,x]=(0,Y.useState)("yearly"),[h,p]=(0,Y.useState)("yearly"),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),j=i||a,y=n.pricing.monthly[j],N=n.pricing.yearly[j];if(!y||!N)return(0,se.jsxs)("div",{className:"text-center py-8 px-4",children:[(0,se.jsx)("p",{className:"text-gray-500",children:"Plan not found. Please try again."}),(0,se.jsx)(Sw,{billingAction:"back_to_plans",ctaText:"Back",billingContext:{origin:"BillingPeriodSelector",selected_plan_type:j},onClick:r,variant:"outline",className:"mt-4",children:"Go Back"})]});const w=e=>{var t;return(null==e||null===(t=e.metadata)||void 0===t?void 0:t.features)||""},_=e=>{x(e),p(e),Ow({user_id:d},"select_period",{origin:"BillingPeriodSelector",billing_period:e,selected_plan_type:j})},k=e=>{p(h===e?null:e)},C=u&&Dw(i?"elite":a,i,m);return(0,se.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,se.jsx)("div",{className:"rounded-lg",children:(0,se.jsxs)(Nw,{value:m,onValueChange:_,className:"gap-0",children:[(0,se.jsx)(Uw,{period:"yearly",isSaleEnabled:u,plan:N,monthlyPlan:y,features:w(N),isSelected:"yearly"===m,isExpanded:"yearly"===h,onSelect:()=>_("yearly"),onExpansionToggle:()=>k("yearly"),userId:d,stats:n,planType:j}),(0,se.jsx)(Uw,{period:"monthly",plan:y,monthlyPlan:y,features:w(y),isSelected:"monthly"===m,isExpanded:"monthly"===h,onSelect:()=>_("monthly"),onExpansionToggle:()=>k("monthly"),onYearlySelect:()=>_("yearly"),userId:d,stats:n,planType:j})]})}),(0,se.jsx)("div",{className:"mt-6 flex justify-center sm:justify-end px-4 sm:px-0",children:(0,se.jsx)(Sw,{billingAction:o?"upgrade_click":"continue_checkout",ctaText:o?"Confirm Subscription Upgrade":"Continue to Checkout",billingContext:{origin:"BillingPeriodSelector",billing_period:m,selected_plan_type:j,selected_elite_tier:i,price_id:("yearly"===m?N:y).id,is_upgrade_flow:o,target_route:"/stripe-checkout",current_tier:(null==n?void 0:n.tier)||"",subscription_status:(null==n?void 0:n.subscription_status)||null,monthly_usage:(null==n?void 0:n.monthly_usage)||0,daily_usage:(null==n?void 0:n.daily_usage)||0,monthly_limit:(null==n?void 0:n.monthly_limit)||0,daily_limit:(null==n?void 0:n.daily_limit)||0,is_over_limit:(null==n?void 0:n.is_over_limit)||!1,past_due:(null==n?void 0:n.past_due)||!1,plan_unit_amount:("yearly"===m?N:y).unit_amount,plan_currency:("yearly"===m?N:y).currency,organization_id:null==n?void 0:n.organization_id,user_email_domain:null!=n&&n.user_email?null===(t=n.user_email.split("@")[1])||void 0===t?void 0:t.toLowerCase():null,user_email:null==n?void 0:n.user_email,product_id:null==n?void 0:n.product_id},onClick:()=>{if(o)f(!0);else{l(("yearly"===m?N:y).id)}},className:"w-full sm:w-auto px-6 py-4 text-md font-normal bg-black hover:bg-orange-600 text-white rounded-lg",disabled:v,children:o?"Confirm Subscription Upgrade":"Continue to Checkout"})}),o&&(0,se.jsx)(Og,{open:g,onOpenChange:f,children:(0,se.jsxs)(Hg,{className:"sm:max-w-md",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Confirm Subscription Upgrade"}),(0,se.jsxs)(Yg,{children:["You are about to upgrade to the ",Mw((null===(s="yearly"===m?N:y)||void 0===s?void 0:s.nickname)||"")," plan for"," ",C&&"yearly"===m&&(0,se.jsxs)(se.Fragment,{children:["(",(0,se.jsxs)("span",{className:"line-through",children:[Rw(n),Math.round(N.unit_amount/100/12)]}),")"," "]}),Rw(n),(e=>{var t;if(null==e||!e.unit_amount)return"0";const s="month"===(null===(t=e.recurring)||void 0===t?void 0:t.interval)?(e.unit_amount/100).toFixed(0):(e.unit_amount/100/12).toFixed(0);return C&&"yearly"===m?Math.ceil(parseFloat(s)*(1-uv.discountPercent)).toString():s})("yearly"===m?N:y),"/mo."," ","Your subscription will be updated immediately and you'll be charged a prorated amount for the remainder of your billing cycle."]})]}),(0,se.jsxs)(Wg,{className:"sm:justify-between",children:[(0,se.jsx)(Sw,{billingAction:"dialog_cancel",ctaText:"Cancel",billingContext:{origin:"BillingPeriodSelector",billing_period:m,selected_plan_type:j,dialog_type:"upgrade",is_upgrade_flow:!0},onClick:()=>f(!1),variant:"outline",disabled:v,className:"text-sm",children:"Cancel"}),(0,se.jsx)(Sw,{billingAction:"dialog_confirm",ctaText:"Confirm Upgrade",billingContext:{origin:"BillingPeriodSelector",billing_period:m,selected_plan_type:j,selected_elite_tier:i,dialog_type:"upgrade",price_id:("yearly"===m?N:y).id,is_upgrade_flow:!0,target_route:"/stripe-checkout",current_tier:(null==n?void 0:n.tier)||"",subscription_status:(null==n?void 0:n.subscription_status)||null,monthly_usage:(null==n?void 0:n.monthly_usage)||0,is_over_limit:(null==n?void 0:n.is_over_limit)||!1,plan_unit_amount:("yearly"===m?N:y).unit_amount},onClick:async()=>{if(c){b(!0);try{const e="yearly"===m?N:y;await c(e.id),f(!1)}catch(e){}finally{b(!1)}}},disabled:v,className:"text-sm bg-teal-600 hover:bg-teal-700",children:v?"Processing...":"Confirm Upgrade"})]})]})})]})},zw=e=>{let{isOpen:t,onClose:s}=e;const a=(0,Y.useRef)(null),n=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{if(t){if(window.hbspt)l();else{const e=document.createElement("script");e.src="//js-eu1.hsforms.net/forms/embed/v2.js",e.charset="utf-8",e.type="text/javascript",document.head.appendChild(e),e.onload=()=>{l()}}const e=document.createElement("style");return e.textContent='\n        .hs-form-field {\n          margin-bottom: 1rem;\n        }\n        .hs-form-field label {\n          font-size: 0.875rem;\n          font-weight: 500;\n          color: #374151;\n          margin-bottom: 0.5rem;\n          display: block;\n        }\n        .hs-form-field input,\n        .hs-form-field textarea {\n          width: 100%;\n          padding: 0.75rem;\n          border: 1px solid #d1d5db;\n          border-radius: 0.5rem;\n          font-size: 0.875rem;\n          transition: border-color 0.2s;\n        }\n        .hs-form-field input:focus,\n        .hs-form-field textarea:focus {\n          outline: none;\n          border-color: #3b82f6;\n          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n        }\n        .hs-form-field textarea {\n          min-height: 100px;\n          resize: vertical;\n        }\n        .hs-error-msgs {\n          color: #dc2626;\n          font-size: 0.75rem;\n          margin-top: 0.25rem;\n        }\n        .hs-button {\n          background-color: #1f2937;\n          color: white;\n          padding: 0.75rem 1.5rem;\n          border: none;\n          border-radius: 0.5rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background-color 0.2s;\n          width: 100%;\n          margin-top: 1rem;\n        }\n        .hs-button:hover {\n          background-color: #111827;\n        }\n        .hs-form {\n          margin-top: 1rem;\n        }\n        .hs-form .hs-form-field {\n          display: inline-block;\n          width: calc(50% - 0.5rem);\n          margin-right: 1rem;\n        }\n        .hs-form .hs-form-field:nth-child(even) {\n          margin-right: 0;\n        }\n        .hs-form .hs-form-field:last-child,\n        .hs-form .hs-form-field:nth-last-child(2) {\n          width: 100%;\n          margin-right: 0;\n        }\n        @media (max-width: 640px) {\n          .hs-form .hs-form-field {\n            width: 100%;\n            margin-right: 0;\n          }\n        }\n        \n        /* Success message styling with Base44 colors */\n        .hs-form .hs-error-msgs,\n        .hs-form .hs-error-msgs label {\n          display: none !important;\n        }\n        \n        .success-message {\n          text-align: center;\n          padding: 3rem 2rem;\n          background: linear-gradient(135deg, #fef7ed 0%, #fef3e2 100%);\n          border-radius: 1rem;\n          margin: 1rem 0;\n          border: 1px solid #fed7aa;\n          position: relative;\n          overflow: hidden;\n        }\n        \n        .success-message::before {\n          content: "";\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 4px;\n          background: linear-gradient(90deg, #f97316, #ea580c);\n        }\n        \n        .success-icon {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 4rem;\n          height: 4rem;\n          background: #f97316;\n          color: white;\n          border-radius: 50%;\n          margin: 0 auto 1.5rem;\n          box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);\n        }\n        \n        .success-title {\n          color: #9a3412;\n          font-size: 1.5rem;\n          font-weight: 700;\n          margin: 0 0 0.75rem 0;\n          line-height: 1.2;\n        }\n        \n        .success-description {\n          color: #c2410c;\n          font-size: 1rem;\n          margin: 0;\n          line-height: 1.6;\n          max-width: 400px;\n          margin: 0 auto;\n        }\n        \n        .success-decoration {\n          position: absolute;\n          top: -10px;\n          right: -10px;\n          width: 60px;\n          height: 60px;\n          background: rgba(249, 115, 22, 0.1);\n          border-radius: 50%;\n        }\n        \n        .success-decoration:nth-child(2) {\n          bottom: -10px;\n          left: -10px;\n          width: 40px;\n          height: 40px;\n          background: rgba(249, 115, 22, 0.05);\n        }\n        \n        .base44-logo {\n          width: 2rem;\n          height: 2rem;\n          margin: 0 auto 1rem;\n        }\n      ',document.head.appendChild(e),()=>{const e=document.querySelector("style[data-hubspot-modal]");e&&e.remove()}}},[t]);const l=()=>{window.hbspt&&n.current&&window.hbspt.forms.create({portalId:"146561033",formId:"6c32b630-0d03-43da-948e-3808a34bbeff",region:"eu1",target:"#hubspot-form-container",onFormSubmitted:function(e){const t=document.getElementById("hubspot-form-container");t&&(t.innerHTML='\n              <div class="success-message">\n                <div class="success-decoration"></div>\n                <div class="success-decoration"></div>\n                <div class="success-icon">\n                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>\n                    <polyline points="22,4 12,14.01 9,11.01"></polyline>\n                  </svg>\n                </div>\n                <h3 class="success-title">Thank you for reaching out!</h3>\n                <p class="success-description">We\'ve received your message and our team will get back to you within 24 hours. We\'re excited to help you with your Base44 journey!</p>\n              </div>\n            ')}})};return t?(0,se.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,se.jsxs)("div",{ref:a,className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Let's talk"}),(0,se.jsx)("p",{className:"text-slate-600 mt-1",children:"Connect with our team to see how Base44 can help your organization."})]}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:s,className:"h-8 w-8 p-0 hover:bg-slate-100 rounded-full",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})})]}),(0,se.jsx)("div",{className:"p-6",children:(0,se.jsx)("div",{id:"hubspot-form-container",ref:n})})]})}):null};var Hw=s(55510),Vw=s(63997);const Ww=e=>{let{icon:t,title:s,description:a}=e;return(0,se.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,se.jsx)("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:t}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-white font-bold mb-1 text-sm",children:s}),(0,se.jsx)("p",{className:"text-white font-normal text-sm",children:a})]})]})},qw=()=>{const[e,t]=(0,Y.useState)(!1);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"mt-8 max-w-full mx-auto px-4",children:(0,se.jsx)("div",{className:"bg-gradient-to-tl from-[#FE7F48] via-slate-800 to-slate-800 rounded-[20px] px-12 py-8 text-white",children:(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-14",children:[(0,se.jsxs)("div",{className:"flex-[2] flex flex-col justify-center items-start",children:[(0,se.jsx)("h3",{className:"text-[24px] font-bold mb-2",children:"Base44 for Enterprise"}),(0,se.jsx)("p",{className:"text-white mb-6 font-light",children:"Empower large organizations to build solutions that fit their teams perfectly, safely and at scale"}),(0,se.jsx)(Sw,{billingAction:"enterprise_contact",ctaText:"Contact Us",billingContext:{origin:"EnterpriseCard"},onClick:()=>t(!0),className:"bg-transparent text-white hover:bg-white hover:text-slate-800 font-medium px-8 py-3 border border-white hover:border-white rounded-lg transition-colors text-base",children:"Contact Us"})]}),(0,se.jsx)("div",{className:"flex-[3]",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-14 w-full",children:[(0,se.jsx)(Ww,{icon:(0,se.jsx)(tb.A,{className:"w-5 h-5 text-orange-400"}),title:"Onboarding & Training",description:"Tailored onboarding plans combined with live training and resources, designed to help admins and end users adopt quickly."}),(0,se.jsx)(Ww,{icon:(0,se.jsx)(Hw.A,{className:"w-5 h-5 text-orange-400"}),title:"Dedicated account Team",description:"Work with a named account manager and solution engineer, providing direct guidance, escalations, and roadmap alignment."}),(0,se.jsx)(Ww,{icon:(0,se.jsx)(Vw.A,{className:"w-5 h-5 text-orange-400"}),title:"Priority support, guaranteed",description:"Get guaranteed priority assistance and defined response times from a dedicated support channel."}),(0,se.jsx)(Ww,{icon:(0,se.jsx)(Yc.A,{className:"w-5 h-5 text-orange-400"}),title:"Enterprise-Grade Capabilities",description:"Security, compliance, management, and monitoring features - providing the control and flexibility required at scale."})]})})]})})}),(0,se.jsx)(zw,{isOpen:e,onClose:()=>t(!1)})]})};var Yw=s(1323);const Gw=e=>{let{type:t,title:s,message:a,subMessage:n,buttonText:l,loadingText:r,onButtonClick:i,handleManageSubscription:o,isLoading:c}=e;const d="cancellation"===t?{container:"bg-gradient-to-r from-orange-50 to-orange-50/80 border-orange-200/60 shadow-sm",icon:"text-orange-500",title:"text-orange-900 font-semibold",description:"text-orange-800",subText:"text-orange-600",button:"bg-orange-100 border-orange-200 text-orange-800 hover:bg-orange-200 hover:border-orange-300 transition-all duration-200 font-medium shadow-sm"}:{container:"bg-gradient-to-r from-slate-50 to-slate-50/80 border-slate-200/60 shadow-sm",icon:"text-slate-500",title:"text-slate-900 font-semibold",description:"text-slate-700",subText:"text-slate-600",button:"bg-slate-100 border-slate-200 text-slate-800 hover:bg-slate-200 hover:border-slate-300 transition-all duration-200 font-medium shadow-sm"};return(0,se.jsx)(Dt,{className:"mb-3 ".concat(d.container," rounded-xl border p-4"),children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(Yw._TA,{className:"h-4 w-4 ".concat(d.icon," mt-0.5 flex-shrink-0")}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)(Ft,{className:"".concat(d.title," text-sm mb-1 leading-tight"),children:s}),(0,se.jsxs)(Ot,{className:"".concat(d.description," text-sm leading-relaxed"),children:[(0,se.jsx)("div",{className:"mb-1",children:a}),n&&(0,se.jsx)("div",{className:"text-xs ".concat(d.subText," leading-relaxed"),children:n})]})]}),l&&(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsx)(Sw,{billingAction:"subscription_notice_action",ctaText:l,billingContext:{notice_type:t},variant:"outline",size:"sm",className:"text-xs px-3 py-1.5 h-auto rounded-lg ".concat(d.button),onClick:()=>{"cancellation"===t?null==o||o():null==i||i()},disabled:c,children:c?r:l})})]})})},Kw=e=>{let{hasScheduledChange:t,hasCancelledSubscription:s,scheduledTierName:a,subscriptionEndDate:n,cancellingSchedule:l,onCancelSchedule:r,onManageSubscription:i}=e;return(0,se.jsxs)(se.Fragment,{children:[t&&(0,se.jsx)(Gw,{type:"schedule-change",title:"Pending Subscription Change",message:"You have a subscription change to the ".concat(a," plan scheduled to take effect at the end of your current billing cycle."),subMessage:'Note: To cancel your subscription, first cancel this change, then use "manage payments" to cancel.',buttonText:"Cancel Change",loadingText:"Cancelling...",onButtonClick:r,handleManageSubscription:i,isLoading:l}),!t&&s&&(0,se.jsx)(Gw,{type:"cancellation",title:"Subscription Cancellation Scheduled",message:"Your subscription will end on ".concat(n,". Until then, you have full access to all features."),subMessage:"Want to keep your subscription? You can reactivate it with one click.",buttonText:"Manage Payments",loadingText:"Processing...",handleManageSubscription:i,isLoading:!1})]})},$w=e=>{let{activeView:t,isWorkspaceContext:s}=e;const{toast:a}=ao();return(0,se.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md text-red-800",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(su.A,{className:"h-5 w-5 mr-2 flex-shrink-0"}),(0,se.jsx)("span",{className:"font-medium",children:"Subscription payment overdue"})]}),(0,se.jsx)(Sw,{billingAction:"payment_overdue_update",ctaText:"Update Payment Method",billingContext:{origin:"BillingPage",view:t,is_workspace_context:s,notice_type:"overdue",target_route:"/stripe-portal"},onClick:async()=>{try{const e="payment_method_update",t=await ow.createPortalSession(e);window.location.href=t.url}catch(e){a({variant:"destructive",title:"Error",description:"Failed to open payment management. Please try again."})}},variant:"outline",size:"sm",className:"border-red-300 text-red-700 hover:bg-red-100 hover:border-red-400",children:"Update Payment Method"})]}),(0,se.jsx)("p",{className:"text-sm mt-2",children:"Your subscription payment is overdue. Access to some features is currently limited. Please update your payment method to regain full access."})]})};var Zw=s(37358);const Jw=()=>(0,se.jsx)("div",{className:"mt-6 mb-2 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"flex items-center justify-center gap-6 flex-wrap",children:[(0,se.jsx)("span",{className:"text-sm font-normal leading-normal text-slate-600",children:"Base44 benefits:"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Zw.A,{size:16,className:"text-slate-600"}),(0,se.jsx)("span",{className:"text-sm font-normal leading-normal text-slate-600",children:"Responsive visual editor"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(oy.A,{size:16,className:"text-slate-600"}),(0,se.jsx)("span",{className:"text-sm font-normal leading-normal text-slate-600",children:"Built-in backend"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(eb.A,{size:16,className:"text-slate-600"}),(0,se.jsx)("span",{className:"text-sm font-normal leading-normal text-slate-600",children:"User management"})]})]})}),Qw=()=>(0,se.jsx)("div",{className:"flex justify-center mt-[32px] font-base44",children:(0,se.jsx)("div",{className:"flex items-center bg-white px-6 py-3 rounded-[80px] border border-slate-100",children:(0,se.jsx)("p",{className:"text-sm text-black font-base44",children:"Base44 is part of Wix - trusted by 300M+ people worldwide"})})}),Xw=e=>{let{showPeriodSelector:t,selectedPlanType:s,isUpgradeFlow:a,activeView:n,isWorkspaceContext:l,shouldShowLabelOnBillingPage:r,onBackToPlanGrid:i,onViewBillingClick:o}=e;return t?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"block lg:hidden mb-2",children:(0,se.jsxs)(Sw,{billingAction:"back_to_plans",ctaText:"Back to Plans",billingContext:{origin:"BillingPage",view:n,is_workspace_context:l},onClick:i,variant:"ghost",className:"px-2 text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[(0,se.jsx)(vs.A,{className:"h-5 w-5"}),(0,se.jsx)("span",{className:"font-base44",children:"Back"})]})}),(0,se.jsx)("div",{className:"flex flex-col items-center text-center mb-6",children:(0,se.jsxs)("div",{className:"w-full relative",children:[(0,se.jsxs)(Sw,{billingAction:"back_to_plans",ctaText:"Back to Plans",billingContext:{origin:"BillingPage",view:n,is_workspace_context:l},onClick:i,variant:"ghost",className:"hidden lg:flex absolute left-0 px-2 text-gray-600 hover:text-gray-900 items-center gap-1",children:[(0,se.jsx)(vs.A,{className:"h-5 w-5"}),(0,se.jsx)("span",{className:"font-base44",children:"Back"})]}),(0,se.jsxs)("div",{className:"max-w-3xl mx-auto text-center mb-2",children:[(0,se.jsx)("h2",{className:"text-3xl md:text-4xl font-normal text-slate-900 mb-2 font-base44",children:a?"Choose your billing cycle for upgrading to ".concat(s):"Select a billing cycle for your ".concat(s," plan")}),(0,se.jsx)(Jw,{}),r&&(0,se.jsx)(Qw,{})]})]})})]}):(0,se.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[(0,se.jsx)("h1",{className:"md:text-center text-left md:px-0 px-4 text-3xl md:text-4xl font-normal text-slate-900 base44-font",children:"billing"===n?"Choose the plan that's right for you":"Usage"}),(0,se.jsx)(Jw,{}),r&&(0,se.jsx)(Qw,{}),"billing"!==n&&(0,se.jsx)("div",{className:"flex justify-center mt-4",children:(0,se.jsxs)(Sw,{billingAction:"view_billing_click",ctaText:l?"View Billing":"See Pricing",billingContext:{view:n,is_workspace_context:l},onClick:o,variant:"ghost",className:"text-sm text-orange-600 hover:text-orange-700 font-medium flex items-center p-0 h-auto",children:[(0,se.jsx)(su.A,{size:16}),l?"View Billing":"See Pricing"]})})]})},e_=e=>{var t,s,a,n,l;let{isSaleEnabled:r,planType:i,plan:o,allPlans:c,currentTier:d,stats:u,usage:m,onSubscribe:x,onUpgrade:h,onManageSubscription:p,upgrading:g,disabled:f=!1,billingPeriod:v="yearly"}=e;const[b,j]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)((()=>{if("elite"!==i)return"elite";const e=Pw(d);return["elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"].includes(e)?e:"elite"})()),[k,C]=(0,Y.useState)(!1),[A,S]=(0,Y.useState)(!1),E="elite"===i,T=(()=>{if(!E)return o;const e="".concat(w,"_").concat(v),t=c.find(t=>{let[s]=t;return s===e});return t?t[1]:o})(),I=(null==T||null===(t=T.metadata)||void 0===t?void 0:t.monthly_message_limit)||0,P=(null==T||null===(s=T.metadata)||void 0===s?void 0:s.monthly_integration_credits)||0,L=Mw((null==T?void 0:T.nickname)||""),M=E?w:i,R=("active"===(null==u?void 0:u.subscription_status)||"past_due"===(null==u?void 0:u.subscription_status)||"incomplete"===(null==u?void 0:u.subscription_status))&&(null==u||null===(a=u.stripe_subscription)||void 0===a||null===(n=a.plan)||void 0===n?void 0:n.id)===T.id,D=function(e,t){const s=["free","starter","builder","pro","elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"],a=Pw(e).toLowerCase(),n=Pw(t).toLowerCase(),l=s.indexOf(a),r=s.indexOf(n);return r>l&&-1!==l&&-1!==r}(d,M),F=function(e,t){const s=["free","starter","builder","pro","elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"],a=Pw(e).toLowerCase(),n=Pw(t).toLowerCase(),l=s.indexOf(a),r=s.indexOf(n);return r<l&&-1!==l&&-1!==r}(d,M),O="free"===(null==d?void 0:d.toLowerCase()),U=d&&!Iw(d),B=()=>Pw(d).startsWith("elite"),z=(()=>{var e,t,s;if(!c)return(null==T||null===(e=T.metadata)||void 0===e?void 0:e.features)||"";const a=["starter","builder","pro"];let n=Pw(M);const l=n.startsWith("elite");l&&(n="pro");const r=a.indexOf(n);if(-1===r)return(null==T||null===(t=T.metadata)||void 0===t?void 0:t.features)||"";let i=[];for(let u=0;u<=r;u++){var o,d;const e=a[u],t="".concat(e,"_").concat(v),s=c.find(e=>{let[s,a]=e;return s===t});if(s&&null!==(o=s[1])&&void 0!==o&&null!==(d=o.metadata)&&void 0!==d&&d.features){const e=s[1].metadata.features.split(",").map(e=>e.trim()).filter(e=>e.length>0);i=[...i,...e]}}if(l&&null!=T&&null!==(s=T.metadata)&&void 0!==s&&s.features){const e=T.metadata.features.split(",").map(e=>e.trim()).filter(e=>e.length>0);i=[...i,...e]}return i.filter((e,t,s)=>t===s.findIndex(t=>t.toLowerCase()===e.toLowerCase())).join(",")})(),H=g?"Processing...":f?"Not Available":R?"Manage Payments":F?"Downgrade to ".concat(L):D&&!O?"Upgrade to ".concat(L):"Subscribe to ".concat(L),V=g||f,W=(0,Y.useCallback)(()=>{if(!E)return[];return["elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"].map(e=>{const t=e.replace("elite_","").replace("elite","");return{value:e,label:t?"Elite ".concat(t):"Elite"}})},[E]),q=(0,Y.useCallback)(()=>{const e=W();if(!d||"free"===d.toLowerCase())return e;return d&&!Iw(d)?e.filter(e=>function(e,t){if(!e||"free"===e.toLowerCase())return!0;if(Iw(e))return!0;const s=["starter","builder","pro","elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"],a=Pw(e),n=Pw(t),l=s.indexOf(a);return s.indexOf(n)>=l}(d,Lw(e.value))):e},[d,W]);(0,Y.useEffect)(()=>{if(E){const e=Pw(d);if(["elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"].includes(e))_(e);else{const e=q();e.length>0&&!e.find(e=>e.value===w)&&_(e[0].value)}}},[d,E]);const G=T.unit_amount?"month"===(null===(l=T.recurring)||void 0===l?void 0:l.interval)?(T.unit_amount/100).toFixed(0):(T.unit_amount/100/12).toFixed(0):"0",K=Math.ceil(parseFloat(G)*(1-uv.discountPercent)),$=r&&Dw(i,w,v,d),Z=(()=>{if(!U||!c)return null;const e=Lw(Pw(d)),t=c.find(t=>{let[s]=t;return s===e});return t?t[1]:null})(),J=null!=Z&&Z.unit_amount?(Z.unit_amount/100/12).toFixed(0):"0";return(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{className:"relative h-full flex flex-col",children:[R&&(0,se.jsx)("div",{className:"absolute z-10 -top-[26px] left-1/4 -translate-x-1/2 px-3 py-1 bg-slate-700 text-white text-sm rounded-t-[12px]",children:"Current Plan"}),(0,se.jsxs)("div",{className:"bg-white rounded-[20px] p-6 flex flex-col transition-all duration-300 hover:shadow-xl min-h-[480px] h-full ".concat(R?"border-2 border-slate-700":""),children:[(0,se.jsxs)("div",{className:"mb-5",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-5 mt-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-[24px] font-[400] ".concat(f?"text-gray-400":"text-gray-900"),children:L}),"pro"===i&&!f&&!B()&&!r&&(0,se.jsx)("span",{className:"px-2 py-1 text-sm font-light rounded-full bg-gradient-to-r from-[#FFA67C] to-[#FF8047]",children:"Recommended"})]}),r&&$&&(0,se.jsxs)("span",{className:"px-3 py-3 text-[16px] font-medium text-black leading-[14px] rounded-[26px] bg-[#ffccac]",children:[mv()," off"]})]}),(0,se.jsxs)("div",{className:"flex items-end mb-2",children:[$&&(0,se.jsxs)("span",{className:"text-3xl font-regular font-base44 text-gray-400 line-through mr-2",children:[Rw(u),G]}),(0,se.jsx)("span",{className:"text-3xl font-medium ".concat(f?"text-gray-400":"text-gray-900"),children:Rw(u)}),(0,se.jsx)("span",{className:"text-3xl font-medium ".concat(f?"text-gray-400":"text-gray-900"),children:$?K:G}),(0,se.jsx)("span",{className:"font-thin  text-[#C1C1C1] text-xl",children:"/"}),(0,se.jsx)("span",{className:"font-normal text-[#C1C1C1] text-[14px]",children:"mo"})]})]}),(0,se.jsx)("div",{className:"mb-6 px-2",children:(0,se.jsx)("div",{className:"h-[1px] bg-[#ECECEC]"})}),(0,se.jsx)("div",{className:"mb-6",children:E&&!f?(0,se.jsxs)(Wf,{value:w,onValueChange:e=>{Ow({user_id:null},"elite_tier_select",{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,selected_elite_tier:e,element_type:"dropdown"}),_(e)},children:[(0,se.jsx)(Yf,{advancedDropdown:!0,className:"w-full h-auto p-2 bg-white border border-gray-200 -mt-2",children:(0,se.jsx)("div",{className:"w-full text-left",children:(0,se.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,se.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,se.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:Tw(I)}),(0,se.jsx)("span",{className:"font-[400] text-black",children:"Monthly credits"}),(0,se.jsx)("span",{className:"ml-1 font-normal text-[#C1C1C1] text-[14px] font-base44",children:"/mo"})]}),(0,se.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,se.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:Tw(P)}),(0,se.jsx)("span",{className:"font-[400] text-black",children:"Integration credits"}),(0,se.jsx)("span",{className:"ml-1 font-normal text-[#C1C1C1] text-[14px] font-base44",children:"/mo"})]})]})})}),(0,se.jsx)($f,{className:"w-[calc(100%-1rem)] max-w-[320px] z-50 p-1.5",side:"bottom",align:"start",sideOffset:4,avoidCollisions:!1,children:q().map(e=>{var t,s;const a="".concat(e.value,"_").concat(v),n=c.find(e=>{let[t]=e;return t===a}),l=n?n[1]:null,r=(null==l||null===(t=l.metadata)||void 0===t?void 0:t.monthly_message_limit)||0,i=(null==l||null===(s=l.metadata)||void 0===s?void 0:s.monthly_integration_credits)||0;return(0,se.jsx)(Zf,{value:e.value,className:"px-4 py-2 border-b border-gray-100 last:border-b-0",hideCheckIcon:!0,children:(0,se.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,se.jsxs)("div",{className:"text-sm leading-[17px] flex items-center gap-1.5 text-gray-900",children:[(0,se.jsx)("span",{className:"font-bold",children:Tw(r)}),(0,se.jsx)("span",{className:"text-black",children:"monthly credits"})]}),(0,se.jsxs)("div",{className:"text-sm leading-[17px] flex items-center gap-1.5 text-gray-900",children:[(0,se.jsx)("span",{className:"font-bold",children:Tw(i)}),(0,se.jsx)("span",{className:"text-black",children:"integration credits"})]})]})},e.value)})})]}):(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"text-sm ".concat(f?"text-gray-400":"text-gray-900"),children:[(0,se.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:Tw(I)}),(0,se.jsx)("span",{className:"font-[400] text-black",children:"Monthly credits"}),(0,se.jsx)("span",{className:"ml-1 font-normal text-[#C1C1C1] text-[14px] font-base44",children:"/mo"})]}),(0,se.jsxs)("div",{className:"text-sm ".concat(f?"text-gray-400":"text-gray-900"),children:[(0,se.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:Tw(P)}),(0,se.jsx)("span",{className:"font-[400] text-black",children:"Integration credits"}),(0,se.jsx)("span",{className:"ml-1 font-normal text-[#C1C1C1] text-[14px] font-base44",children:"/mo"})]})]})}),(0,se.jsx)("div",{className:de("mb-4",E&&"-mt-[6px]"),children:(0,se.jsx)(Sw,{billingAction:R?"manage_payments_click":F?"downgrade_click":D&&!O?"upgrade_click":"subscribe_click",ctaText:H,billingContext:{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,selected_elite_tier:E?w:void 0,price_id:T.id,subscription_status:(null==u?void 0:u.subscription_status)||null,target_route:R?"/stripe-portal":"/stripe-checkout",is_monthly_user:U,is_free_user:O,is_current_plan:R,can_upgrade:D,is_downgrade:F,is_elite_plan:E,monthly_usage:(null==m?void 0:m.monthly_usage)||0,daily_usage:(null==m?void 0:m.daily_usage)||0,monthly_limit:(null==m?void 0:m.monthly_limit)||0,daily_limit:(null==m?void 0:m.daily_limit)||0,extra_credits:(null==m?void 0:m.extra_credits)||0,is_over_limit:(null==m?void 0:m.is_over_limit)||!1,past_due:(null==m?void 0:m.past_due)||!1,monthly_messages:I,integration_credits:P,plan_display_name:L,button_text:H,button_disabled:V,plan_unit_amount:T.unit_amount,plan_currency:T.currency,organization_id:null==m?void 0:m.organization_id,product_id:null==u?void 0:u.product_id,current_credit_period_start_date:null==m?void 0:m.current_credit_period_start_date,current_credit_period_end_date:null==m?void 0:m.current_credit_period_end_date,next_period_start_date:null==m?void 0:m.next_period_start_date},onClick:()=>{if(!f&&!V)if(R)U?C(!0):p();else if(F)N(!0);else if(D&&!O)if(U){h(E?w:i)}else j(!0);else{x(E?w:i)}},className:(()=>{const e="w-full py-2 text-[16px] font-medium transition-colors cursor-pointer rounded-[8px]";return R?"".concat(e," bg-[#F4F4F5] shadow-sm hover:bg-gray-50 text-gray-700"):f?"".concat(e," bg-gray-100 border border-gray-200 text-gray-400 cursor-not-allowed"):"pro"!==i||B()?"".concat(e," bg-white border border-gray-300 hover:bg-[#FF631F] text-black hover:text-white hover:border-white"):"".concat(e," bg-[rgba(255,99,31,0.85)] hover:bg-[rgba(255,99,31,1)] text-black")})(),disabled:V,children:H})}),(0,se.jsx)("div",{className:"my-4 px-2",children:(0,se.jsx)("div",{className:"h-[1px] bg-[#ECECEC]"})}),(0,se.jsxs)("div",{className:"space-y-1 flex-grow",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-black text-sm",children:"Plan highlights:"}),null==z?void 0:z.split(",").map((e,t)=>(0,se.jsx)(Ew,{text:e.trim(),disabled:f,showGift:!1},t))]})]}),(0,se.jsx)(Og,{open:b,onOpenChange:j,children:(0,se.jsxs)(Hg,{className:"sm:max-w-md",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Confirm Subscription Upgrade"}),(0,se.jsxs)(Yg,{children:["You are about to upgrade to the ",L," plan for"," ",$&&(0,se.jsxs)(se.Fragment,{children:["(",(0,se.jsxs)("span",{className:"line-through",children:[Rw(u),G]}),")"," "]}),Rw(u),$?K:G,"/mo."," ","Your subscription will be updated immediately and you'll be charged a prorated amount for the remainder of your billing cycle."]})]}),(0,se.jsxs)(Wg,{className:"sm:justify-between",children:[(0,se.jsx)(Sw,{billingAction:"dialog_cancel",ctaText:"Cancel",billingContext:{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,dialog_type:"upgrade"},onClick:()=>j(!1),variant:"outline",className:"text-sm",children:"Cancel"}),(0,se.jsx)(Sw,{billingAction:"dialog_confirm",ctaText:g?"Processing...":"Confirm Upgrade",billingContext:{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,selected_elite_tier:E?w:void 0,dialog_type:"upgrade",price_id:T.id,target_route:"/stripe-checkout",is_monthly_user:U,is_free_user:O,can_upgrade:D,is_elite_plan:E,monthly_usage:(null==m?void 0:m.monthly_usage)||0,is_over_limit:(null==m?void 0:m.is_over_limit)||!1,plan_unit_amount:T.unit_amount},onClick:()=>{if(j(!1),U&&D&&!O){h(E?w:i)}else h(T.id)},disabled:g,className:"text-sm bg-teal-600 hover:bg-teal-700",children:g?"Processing...":"Confirm Upgrade"})]})]})}),(0,se.jsx)(Og,{open:y,onOpenChange:N,children:(0,se.jsxs)(Hg,{className:"sm:max-w-md",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Confirm Subscription Downgrade"}),(0,se.jsxs)(Yg,{children:["You are about to downgrade to the ",L," plan for ",Rw(u),G,"/mo. This change will take effect at the end of your current billing cycle."]})]}),(0,se.jsxs)(Wg,{className:"sm:justify-between",children:[(0,se.jsx)(Sw,{billingAction:"dialog_cancel",ctaText:"Cancel",billingContext:{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,dialog_type:"downgrade"},onClick:()=>N(!1),variant:"outline",className:"text-sm",children:"Cancel"}),(0,se.jsx)(Sw,{billingAction:"dialog_confirm",ctaText:"Confirm Downgrade",billingContext:{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,selected_elite_tier:E?w:void 0,dialog_type:"downgrade",price_id:T.id,target_route:"/stripe-checkout",is_monthly_user:U,is_downgrade:F,is_elite_plan:E,monthly_usage:(null==m?void 0:m.monthly_usage)||0,is_over_limit:(null==m?void 0:m.is_over_limit)||!1,plan_unit_amount:T.unit_amount},onClick:()=>{N(!1),h(T.id)},disabled:g,className:"text-sm bg-gray-500 hover:bg-gray-600",children:g?"Processing...":"Confirm Downgrade"})]})]})}),(0,se.jsx)(Og,{open:k,onOpenChange:C,children:(0,se.jsxs)(Hg,{className:"sm:max-w-[500px]",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Manage Your Subscription"}),(0,se.jsxs)(Yg,{children:["Choose how you'd like to manage your ",L," subscription."]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-[12px]",children:[(0,se.jsx)("button",{onClick:()=>{C(!1),S(!0)},disabled:!Z,className:"w-full bg-white border border-[#ff631f] hover:bg-orange-50 rounded-[10px] px-[16px] py-[12px] text-left cursor-pointer transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,se.jsxs)("div",{className:"flex items-start justify-between w-full",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-[2px]",children:[(0,se.jsx)("span",{className:"text-[18px] font-medium leading-[28px] text-[#0a0a0a]",children:"Upgrade to Yearly"}),(0,se.jsx)("span",{className:"text-[18px] font-normal leading-[28px] text-[#6b7280]",children:"starter"===i?"Save money and get 25 credits to share":"Save money and get a free domain + 25 credits to share"})]}),r&&Dw(i,w,"yearly",d)&&(0,se.jsx)("span",{className:"text-[14px] font-medium leading-[20px] text-black text-center px-[6px] py-[1px] rounded-[2px] shrink-0",style:{background:"linear-gradient(118deg, rgba(255, 154, 110, 1) 5.3%, rgba(255, 99, 31, 1) 100%)"},children:"30% off"})]})}),(0,se.jsx)("button",{onClick:()=>{C(!1),p()},className:"w-full h-[111px] bg-white border border-[#e5e5e5] hover:bg-gray-50 rounded-[10px] px-[16px] py-[12px] text-left cursor-pointer transition-colors flex flex-col justify-center",children:(0,se.jsxs)("div",{className:"flex flex-col gap-[2px]",children:[(0,se.jsx)("span",{className:"text-[18px] font-medium leading-[28px] text-[#0a0a0a]",children:"Manage Payments"}),(0,se.jsx)("span",{className:"text-[18px] font-normal leading-[28px] text-[#6b7280]",children:"Update payment method, view invoices and more"})]})})]})]})}),(0,se.jsx)(Og,{open:A,onOpenChange:S,children:(0,se.jsxs)(Hg,{className:"sm:max-w-md",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Confirm Subscription Upgrade"}),(0,se.jsxs)(Yg,{children:["You are about to upgrade to the ",Mw((null==Z?void 0:Z.nickname)||"")," yearly plan for"," ",r&&Dw(i,w,"yearly",d)&&(0,se.jsxs)(se.Fragment,{children:["(",(0,se.jsxs)("span",{className:"line-through",children:[Rw(u),J]}),")"," "]}),Rw(u),r&&Dw(i,w,"yearly",d)?Math.ceil(parseFloat(J)*(1-uv.discountPercent)):Math.round(parseFloat(J)),"/mo."," ","Your subscription will be updated immediately and you'll be charged a prorated amount for the remainder of your billing cycle."]})]}),(0,se.jsx)("div",{className:"py-4",children:(0,se.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,se.jsx)("div",{className:"text-green-800 font-medium mb-2",children:"\u{1f381} Yearly Benefits"}),(0,se.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:["starter"!==i&&(0,se.jsx)("li",{children:"\u2022 Get a free domain for a year"}),(0,se.jsx)("li",{children:"\u2022 25 credits to share with friends"}),(0,se.jsx)("li",{children:"\u2022 Better value with yearly pricing"})]})]})}),(0,se.jsxs)(Wg,{className:"sm:justify-between",children:[(0,se.jsx)(Sw,{billingAction:"dialog_cancel",ctaText:"Cancel",billingContext:{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,dialog_type:"upgrade_to_yearly"},onClick:()=>S(!1),variant:"outline",className:"text-sm",children:"Cancel"}),(0,se.jsx)(Sw,{billingAction:"dialog_confirm",ctaText:"Confirm Upgrade",billingContext:{origin:"PlanCard",billing_period:v,current_tier:d,selected_plan_type:i,selected_elite_tier:E?w:void 0,dialog_type:"upgrade_to_yearly",price_id:(null==Z?void 0:Z.id)||null,target_route:"/stripe-checkout",is_monthly_user:U,is_current_plan:R,is_elite_plan:E,monthly_usage:(null==m?void 0:m.monthly_usage)||0,is_over_limit:(null==m?void 0:m.is_over_limit)||!1,plan_unit_amount:(null==Z?void 0:Z.unit_amount)||0},onClick:()=>{S(!1),Z&&h(Z.id)},disabled:g,className:"text-sm bg-teal-600 hover:bg-teal-700",children:g?"Processing...":"Confirm Upgrade"})]})]})})]})})},t_={pro:"lg:order-2 xl:order-2",builder:"lg:order-3 xl:order-3",starter:"lg:order-4 xl:order-4",elite:"lg:order-1 xl:order-1"},s_=e=>{let{planTypes:t,getPlanForType:s,getAllPlans:a,usage:n,stats:l,billingPeriod:r,isSaleEnabled:i,onSubscribe:o,onUpgrade:c,onManageSubscription:d}=e;return(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 lg:gap-4 max-w-full mx-auto px-4 items-stretch",children:t.map(e=>{const t=s(e);return t?(0,se.jsx)("div",{className:"w-full h-full ".concat(t_[e]||""),children:(0,se.jsx)(e_,{isSaleEnabled:i,planType:e,plan:t[1],allPlans:a(),currentTier:(null==n?void 0:n.tier)||"",stats:l,usage:n,onSubscribe:o,onUpgrade:c,onManageSubscription:d,upgrading:!1,billingPeriod:r})},e):null})})},a_=()=>(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 lg:gap-4 max-w-full mx-auto px-4",children:[(0,se.jsx)(bw,{}),(0,se.jsx)(bw,{}),(0,se.jsx)(bw,{}),(0,se.jsx)(bw,{})]}),n_=e=>{let{stats:t}=e;const[s,a]=(0,Y.useState)({hours:0,minutes:0,seconds:0}),n=Y.useMemo(()=>xv(t),[t]);(0,Y.useEffect)(()=>{const e=()=>{const e=new Date,t=n.getTime()-e.getTime();if(t>0){const e=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4),n=Math.floor(t%6e4/1e3);a({hours:e,minutes:s,seconds:n})}else a({hours:0,minutes:0,seconds:0})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[n]);const l=e=>String(e).padStart(2,"0"),r="".concat(l(s.hours),":").concat(l(s.minutes),":").concat(l(s.seconds));return uv.disclaimerLines?(0,se.jsx)("div",{className:"w-full mx-auto px-4",children:(0,se.jsx)("div",{className:"rounded-lg p-1",children:uv.disclaimerLines.map((e,t)=>(0,se.jsx)("p",{className:"text-sm text-black/80 text-center leading-[18px]",children:e.replace("{timer}",r)},t))})}):null},l_=e=>{var t,s,a;let{origin:n}=e;const{toast:l}=ao(),{user:r}=wd(),{activeWorkspace:i}=qd(),o=(0,Y.useRef)(null),c=(0,Y.useRef)(null),[d,u]=(0,Y.useState)("billing"),[m,x]=(0,Y.useState)("yearly"),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(null),[v,b]=(0,Y.useState)(!0),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(""),[_,k]=(0,Y.useState)(""),[C,A]=(0,Y.useState)(!1),[S,E]=(0,Y.useState)(!1),[T,I]=(0,Y.useState)("Individual"),{hasFlag:P}=ej(),L=P("wix-label-billing-page"),M=hv(g),R=(0,Y.useCallback)(()=>{setTimeout(()=>{const e=(e=>{let t=null==e?void 0:e.parentElement;for(;t;){const{overflowY:e}=window.getComputedStyle(t);if("auto"===e||"scroll"===e)return t;t=t.parentElement}return null})(c.current);e&&e.scrollTo({top:0,behavior:"smooth"})},0)},[]),D=i&&!i.is_personal;(0,Y.useEffect)(()=>{const e=(null==i?void 0:i.id)||null;null!==o.current&&o.current!==e&&(p(null),f(null),b(!0),u("billing"),x("monthly"),y(!1),w(""),k(""),A(!1)),o.current=e},[null==i?void 0:i.id]),(0,Y.useEffect)(()=>{if(D)return;(async()=>{try{b(!0);const[e,t]=await Promise.all([Yd.default.getCurrentUsage(),Yd.default.getStats()]);p(e),f(t);const s=e;if(null!=s&&s.tier)if("free"===s.tier.toLowerCase())x("yearly");else{const e=s.tier.toLowerCase().includes("_yearly");x(e?"yearly":"monthly")}}catch(e){}finally{b(!1)}})()},[D]),(0,Y.useEffect)(()=>{if(r){"true"===new URLSearchParams(window.location.search).get("success")&&r.email&&(Tu("Billing - Purchase",{}),pw("Purchase",{email:(0,fw.sha256)(r.email),price:20,user_id:r.id}))}},[r]),(0,Y.useEffect)(()=>{r&&!D&&(Tu("Package Picker",(0,ue.A)({},n&&{origin:n})),pw("package_picker",{user_id:r.id,email:(0,fw.sha256)(r.email)}))},[r,D,n]);const F=async e=>{const t=["starter","builder","pro","elite"].includes(e),s=["elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"].includes(e);if(t||s)return Ow({user_id:(null==r?void 0:r.id)||null},"select_plan",{origin:"BillingPage",view:d,is_workspace_context:!!D,billing_period:m,current_tier:(null==h?void 0:h.tier)||"",subscription_status:(null==g?void 0:g.subscription_status)||null,selected_plan_type:s?"elite":e,selected_elite_tier:s?e:void 0}),w(t?e:"elite"),k(s?e:""),y(!0),void R();try{Ow({user_id:(null==r?void 0:r.id)||null},"continue_checkout",{origin:"BillingPage",view:d,is_workspace_context:!!D,billing_period:m,current_tier:(null==h?void 0:h.tier)||"",subscription_status:(null==g?void 0:g.subscription_status)||null,price_id:e}),Tu("Hit Subscribe",{}),pw("checkout_initiated",{email:(0,fw.sha256)(r.email),price:20,user_id:r.id});const t=await ow.createCheckoutSession(e),{sessionId:s}=t,a=null==g?void 0:g.publishable_key;if(!a)throw new Error("Stripe publishable key not available");const n=await(0,vt.loadStripe)(a);await n.redirectToCheckout({sessionId:s})}catch(a){l({variant:"destructive",title:"Error",description:"Failed to create checkout session. Please try again later."})}},O=()=>{Ow({user_id:(null==r?void 0:r.id)||null},"back_to_plans",{origin:"BillingPage",view:d,is_workspace_context:!!D}),y(!1),w(""),k(""),A(!1),R()},U=async e=>{try{var t;Ow({user_id:(null==r?void 0:r.id)||null},"upgrade_click",{origin:"BillingPage",view:d,is_workspace_context:!!D,billing_period:m,current_tier:(null==h?void 0:h.tier)||"",subscription_status:(null==g?void 0:g.subscription_status)||null,price_id:e});const s=null===(t=(await ow.updateSubscription(e)).subscription)||void 0===t?void 0:t.is_downgrade;l({title:"Subscription Updated",description:s?"Your subscription has been scheduled to downgrade at the end of your billing cycle.":"Your subscription has been upgraded successfully. Changes will be reflected shortly."}),setTimeout(()=>{window.location.reload()},2e3)}catch(n){var s,a;l({variant:"destructive",title:"Error",description:(null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail)||"Failed to update subscription. Please try again later."})}},B=async()=>{try{Ow({user_id:(null==r?void 0:r.id)||null},"manage_payments_click",{origin:"BillingPage",view:d,is_workspace_context:!!D,billing_period:m,current_tier:(null==h?void 0:h.tier)||"",subscription_status:(null==g?void 0:g.subscription_status)||null});const e=await ow.createPortalSession();window.open(e.url,"_blank")}catch(e){l({variant:"destructive",title:"Error",description:"Failed to open subscription management. Please try again later."})}},z=null==r?void 0:r.subscription_schedule_id,H=!0===(null==g||null===(t=g.stripe_subscription)||void 0===t?void 0:t.cancel_at_period_end)||null!=(null==g||null===(s=g.stripe_subscription)||void 0===s?void 0:s.cancel_at);return(0,se.jsxs)("div",{ref:c,children:[M&&(0,se.jsx)(pv,{stats:g,isLinkToBilling:!1}),(0,se.jsxs)("div",{className:"container mx-auto px-2 sm:px-6 lg:px-6 py-6 sm:py-8 min-h-screen flex flex-col font-base44",children:[!D&&!v&&(null==h?void 0:h.past_due)&&(0,se.jsx)($w,{activeView:d,isWorkspaceContext:!!D}),(0,se.jsx)(Xw,{showPeriodSelector:j,selectedPlanType:N,isUpgradeFlow:C,activeView:d,isWorkspaceContext:!!D,shouldShowLabelOnBillingPage:L,onBackToPlanGrid:O,onViewBillingClick:()=>u("billing"),plansType:T,onPlansTypeChange:I}),D?"billing"===d?(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(mw,{}),(0,se.jsx)(dw,{})]}):(0,se.jsx)("div",{className:"space-y-8"}):"billing"===d?(0,se.jsxs)("div",{className:"space-y-8",children:[(0,se.jsx)(Kw,{hasScheduledChange:!!z,hasCancelledSubscription:H,scheduledTierName:Oj(null==r?void 0:r.subscription_schedule_tier),subscriptionEndDate:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})(null!=g&&null!==(a=g.stripe_subscription)&&void 0!==a&&a.cancel_at?new Date(1e3*g.stripe_subscription.cancel_at).toISOString():null==r?void 0:r.subscription_period_end),cancellingSchedule:S,onCancelSchedule:async()=>{try{E(!0),await ow.cancelSchedule(),l({title:"Success",description:"Subscription schedule cancelled successfully"}),E(!1),setTimeout(()=>{window.location.reload()},2e3)}catch(e){l({variant:"destructive",title:"Error",description:"Failed to cancel subscription schedule. Please try again later."}),E(!1)}},onManageSubscription:B}),v?(0,se.jsx)(a_,{}):j?(0,se.jsx)(Bw,{selectedPlanType:N,stats:g,onSubscribe:F,onBack:O,selectedEliteTier:_,isUpgradeFlow:C,onUpgrade:U,isSaleEnabled:M}):(0,se.jsx)(s_,{planTypes:["starter","builder","pro","elite"],getPlanForType:e=>{if(null==g||!g.pricing)return null;const t=("yearly"===m?g.pricing.yearly:g.pricing.monthly)[e];return t?[e,t]:null},getAllPlans:()=>{if(null==g||!g.pricing)return[];const e=[];return Object.entries(g.pricing.monthly).forEach(t=>{let[s,a]=t;e.push(["".concat(s,"_monthly"),a])}),Object.entries(g.pricing.yearly).forEach(t=>{let[s,a]=t;e.push(["".concat(s,"_yearly"),a])}),e},usage:h,stats:g,billingPeriod:m,isSaleEnabled:M,onSubscribe:F,onUpgrade:async e=>{const t=["elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"];if((["starter","builder","pro","elite"].includes(e)||t.includes(e))&&"monthly"===m)return Ow({user_id:(null==r?void 0:r.id)||null},"upgrade_click",{origin:"BillingPage",view:d,is_workspace_context:!!D,billing_period:m,current_tier:(null==h?void 0:h.tier)||"",subscription_status:(null==g?void 0:g.subscription_status)||null,selected_plan_type:t.includes(e)?"elite":e,selected_elite_tier:t.includes(e)?e:void 0}),w(t.includes(e)?"elite":e),t.includes(e)?k(e):k(""),A(!0),y(!0),void R();await U(e)},onManageSubscription:B}),M&&(0,se.jsx)(n_,{stats:g}),!j&&(0,se.jsx)(qw,{}),(0,se.jsx)(dw,{})]}):(0,se.jsx)("div",{className:"space-y-8"})]})]})},r_=/^[a-zA-Z0-9][a-zA-Z0-9._-]*$/;function i_(e){if(!e||0===e.trim().length)return{isValid:!1,error:"Repository name is required"};if(e.length>100)return{isValid:!1,error:"Repository name must be 100 characters or less (currently ".concat(e.length,")")};const t=e.charAt(0);return/^[a-zA-Z0-9]$/.test(t)?e.toLowerCase().endsWith(".git")?{isValid:!1,error:"Repository name cannot end with .git"}:r_.test(e)?{isValid:!0}:{isValid:!1,error:"Use only letters, numbers, hyphens, underscores, or periods"}:{isValid:!1,error:"Repository name must start with a letter or number"}}const o_={medium:"font-base44 text-base leading-6",small:"font-base44 text-sm leading-5",tiny:"font-base44 text-xs leading-4"},c_={bold:"font-semibold",normal:"font-medium",thin:"font-normal"},d_={premium:"text-purple-600",success:"text-green-600",error:"text-red-600",disabled:"text-gray-400",primary:"text-blue-600"},u_={"break-word":"break-words",anywhere:"break-all"},m_=function(){return o_[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium"]},x_=function(){return c_[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"thin"]},h_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"standard",t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"standard"===e?arguments.length>1&&void 0!==arguments[1]&&arguments[1]?t?"text-gray-300":"text-white":t?"text-slate-500 font-medium":"text-black":d_[e]},p_=e=>e?"checkmark"===e?'[&_ul]:list-none [&_li]:before:content-["\u2713"] [&_li]:before:mr-2':"[&_ul]:list-disc [&_ul]:pl-5":"",g_=e=>"normal"===e?"":u_[e],f_={1:"block overflow-hidden line-clamp-1",2:"block overflow-hidden line-clamp-2",3:"block overflow-hidden line-clamp-3",4:"block overflow-hidden line-clamp-4",5:"block overflow-hidden line-clamp-5",6:"block overflow-hidden line-clamp-6"},v_=(e,t)=>e?t?(e=>e?f_[e]||"block overflow-hidden line-clamp-6":"")(t):"block overflow-hidden text-ellipsis whitespace-nowrap":"",b_=e=>{let{enabled:t,children:s,onEllipsisStateChange:a}=e;const[n,l]=Y.useState(!1),r=Y.useRef(null),i=Y.useRef(n),o=Y.useRef(a);return Y.useEffect(()=>{i.current=n},[n]),Y.useEffect(()=>{o.current=a},[a]),Y.useEffect(()=>{if(!t||!r.current)return;const e=()=>{if(r.current){const t=r.current,s=t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight;var e;if(s!==i.current)l(s),null===(e=o.current)||void 0===e||e.call(o,s)}};e();const s=setTimeout(e,0),a=new ResizeObserver(e);return a.observe(r.current),()=>{clearTimeout(s),a.disconnect()}},[s,t]),{elementRef:r,isEllipsisActive:n}},j_=(e,t)=>Y.useCallback(s=>{t.current=s,"function"==typeof e?e(s):e&&(e.current=s)},[e,t]),y_=["className"],N_=e=>{let{show:t,tooltipContent:s,tooltipProps:a,children:n}=e;if(!t)return n;const l=a||{},{className:r}=l,i=(0,Nt.A)(l,y_);return(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:n}),(0,se.jsx)(pp,(0,ue.A)((0,ue.A)({className:de("bg-[#171717] text-white text-sm !border-none",r)},i),{},{children:s}))]})})},w_=["size","weight","skin","secondary","light","tagName","ellipsis","maxLines","onEllipsisStateChange","showTooltip","tooltipProps","listStyle","suffix","overflowWrap","widows","children","className","dataHook","id"],__=Y.forwardRef((e,t)=>{let{size:s="medium",weight:a="thin",skin:n="standard",secondary:l=!1,light:r=!1,tagName:i="span",ellipsis:o=!1,maxLines:c,onEllipsisStateChange:d,showTooltip:u=!0,tooltipProps:m,listStyle:x,suffix:h,overflowWrap:p="normal",widows:g=!1,children:f,className:v,dataHook:b,id:j}=e,y=(0,Nt.A)(e,w_);const N=i,{elementRef:w,isEllipsisActive:_}=b_({enabled:o,children:f,onEllipsisStateChange:d}),k=j_(t,w);return(0,se.jsx)(N_,{show:u&&_,tooltipContent:f,tooltipProps:m,children:(0,se.jsxs)(N,(0,ue.A)((0,ue.A)({ref:k,id:j,"data-hook":b,className:de(m_(s),x_(a),h_(n,r,l),v_(o,c),p_(x),g_(p),g&&"[widows:2]",v)},y),{},{children:[f,h&&(0,se.jsx)("span",{className:"ml-1",children:h})]}))})});function k_(e){let{onSuccess:t}=e;const[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(null);return(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)(Bx,{variant:"ghost",size:"sm",onClick:async()=>{l(null),a(!0);try{await kx.connect()?t():l("Could not add organization. Please try again.")}finally{a(!1)}},disabled:s,className:"justify-start text-blue-600 hover:text-blue-700 hover:bg-gray-100 bg-gray-100 border border-neutral-200 shadow-xs disabled:opacity-70 disabled:cursor-not-allowed",children:[s?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}):(0,se.jsx)(op.A,{className:"w-4 h-4"}),s?"Adding Organization...":"Add Organization"]}),n&&(0,se.jsx)(__,{size:"tiny",skin:"error",children:n})]})}__.displayName="Text";function C_(e){var t,s;const a=null==e||null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail;if(!a)return{message:"Failed to create repository. Please try again."};const n=e=>{try{const t=e.replace(/'/g,'"').replace(/None/g,"null").replace(/True/g,"true").replace(/False/g,"false");return JSON.parse(t)}catch(t){return null}},l=e=>{const t=e.match(/\{[^{}]*"?message"?\s*:\s*["'][^"']+["'][^{}]*\}/i);if(t){const e=n(t[0])||(()=>{try{return JSON.parse(t[0])}catch(e){return null}})();if(null!=e&&e.message)return{message:e.message,documentationUrl:e.documentation_url}}return null};if("string"==typeof a){if(a.startsWith("{")||a.startsWith("{'")){const e=n(a);if(e){if(e.message&&"string"==typeof e.message){const t=l(e.message);if(t)return t;return{message:e.message.replace(/:\s*\d+\s*\{[\s\S]*\}$/,"").replace(/\s*\d+\s*\{[\s\S]*\}$/,"").trim()||e.message,documentationUrl:e.documentation_url}}return{message:e.error||"An error occurred",documentationUrl:e.documentation_url}}}const e=l(a);return e||{message:a}}if("object"==typeof a){const e=a.message||a.error||"An error occurred";if("string"==typeof e){const t=l(e);if(t)return t}return{message:"string"==typeof e?e:"An error occurred",documentationUrl:a.documentation_url}}return{message:"Failed to create repository. Please try again."}}function A_(e){let{isOpen:t=!1,onClose:s=()=>{},appId:a,appName:n,onSuccess:l,onAuthRequired:r}=e;const[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)(""),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(null),[b,j]=(0,Y.useState)(!1),y=uh(),N=(null!=n?n:"").toLowerCase().replace(/[^a-z0-9._-]+/g,"-").replace(/^[._-]+/,"").replace(/-+$/,"").replace(/\.git$/i,"").replace(/[-_.]{2,}/g,"-").slice(0,100);const w=i_(u),_=b&&!w.isValid;(0,Y.useEffect)(()=>{t&&a&&k()},[t,a]),(0,Y.useEffect)(()=>{t&&!u&&m(N)},[t,N]),(0,Y.useEffect)(()=>{t||(d(""),m(""),v(null),j(!1))},[t]);const k=async()=>{h(!0),v(null);try{const e=await hm.getOrganizations(a);o(e),e.length>0&&d(e[0].login)}catch(t){var e;if(401===(null==t||null===(e=t.response)||void 0===e?void 0:e.status)&&r)return $.default.error("GitHub connection expired. Please reconnect."),s(),void r();v(C_(t))}finally{h(!1)}},C=i.find(e=>e.login===c);return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&!p&&s(),children:(0,se.jsxs)(Hg,{className:"w-full max-w-[500px] p-6 gap-4 rounded-[10px] border border-neutral-200 shadow-lg [&>button]:hidden",children:[(0,se.jsxs)("div",{className:"absolute right-4 top-4 flex items-center gap-3",children:[(0,se.jsx)("button",{className:"text-neutral-500 hover:text-neutral-700 transition-colors",onClick:()=>window.open("https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-new-repository","_blank"),children:(0,se.jsx)(Pj.A,{className:"w-4 h-4"})}),(0,se.jsx)("button",{className:"transition-colors ".concat(p?"text-neutral-300 cursor-not-allowed pointer-events-none":"text-neutral-900/70 hover:text-neutral-900"),onClick:()=>!p&&s(),disabled:p,"aria-disabled":p,children:(0,se.jsx)(la.A,{className:"w-4 h-4"})})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold leading-none text-neutral-950",children:"Create a Repository"}),(0,se.jsx)("p",{className:"text-sm leading-normal text-neutral-500",children:"Create a private GitHub repository to complete the connection."})]}),(0,se.jsxs)("div",{className:"flex flex-col justify-end py-3 gap-6",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-2 w-full max-w-[360px]",children:[(0,se.jsx)("label",{className:"text-sm font-medium leading-none text-neutral-950",children:"Organization"}),x?(0,se.jsx)("div",{className:"flex items-center h-9 px-3 bg-gray-100 border border-neutral-200 rounded-lg shadow-xs",children:(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin text-neutral-400"})}):0===i.length?(0,se.jsx)(k_,{onSuccess:k}):(0,se.jsxs)(Wf,{value:c,onValueChange:d,children:[(0,se.jsx)(Yf,{className:"h-9 px-3 bg-gray-100 border-neutral-200 rounded-lg shadow-xs focus:ring-0 focus:ring-offset-0",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[C&&(0,se.jsxs)(hg,{className:"w-6 h-6",children:[(0,se.jsx)(pg,{src:C.avatar_url,alt:C.login}),(0,se.jsx)(gg,{className:"text-[10px] bg-neutral-100",children:C.login.slice(0,2).toUpperCase()})]}),(0,se.jsx)("span",{className:"text-sm text-gray-600",children:c||"Select organization"})]})}),(0,se.jsx)($f,{children:i.map(e=>(0,se.jsx)(Zf,{value:e.login,children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)(hg,{className:"w-5 h-5",children:[(0,se.jsx)(pg,{src:e.avatar_url,alt:e.login}),(0,se.jsx)(gg,{className:"text-[10px]",children:e.login.slice(0,2).toUpperCase()})]}),(0,se.jsx)("span",{children:e.login})]})},e.id))})]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-1.5 w-full max-w-[360px]",children:[(0,se.jsx)("label",{className:"text-sm font-medium leading-none text-neutral-950",children:"Name your new repository"}),(0,se.jsx)("input",{type:"text",value:u,onChange:e=>{m(e.target.value),j(!0)},placeholder:N,maxLength:100,className:"w-full px-3 py-[7px] text-sm bg-white border rounded-lg shadow-xs focus:outline-none focus:ring-2 focus:ring-neutral-900/10 placeholder:text-neutral-400 ".concat(_?"border-red-300 focus:border-red-400 focus:ring-red-100":"border-neutral-200 focus:border-neutral-300")}),_&&(0,se.jsx)("p",{className:"text-xs text-red-600",children:w.error})]}),f&&(0,se.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-red-50 border border-red-200 w-full max-w-[360px]",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500 mt-0.5 shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-red-700",children:f.message})]})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[p?(0,se.jsx)("p",{className:"text-xs text-neutral-500",children:"Creating repository and syncing code, this may take a few seconds..."}):(0,se.jsx)("div",{}),(0,se.jsx)("button",{onClick:async()=>{if(!c||!u)return;if(!i_(u).isValid)return void j(!0);const e=i.find(e=>e.login===c);if(!e)return void v({message:"Selected organization not found. Please refresh and try again."});g(!0),v(null);const t=performance.now();try{await hm.connectRepository(a,{organization:c,repo_name:u,installation_id:e.installation_id});const n=Math.round(performance.now()-t);px(y,{result:ux.Success,organization:c,repo_name:u,duration_ms:n}),$.default.success("Repository created and connected successfully!"),s(),l()}catch(n){const e=C_(n);v(e);const s=Math.round(performance.now()-t);px(y,{result:ux.Failure,organization:c,repo_name:u,error_message:e.message,duration_ms:s}),$.default.error(e.message)}finally{g(!1)}},disabled:!c||!u||!w.isValid||p||x,className:"h-9 px-4 flex items-center justify-center gap-2 bg-neutral-900 hover:bg-neutral-800 disabled:bg-neutral-400 text-neutral-50 text-sm font-medium rounded-lg shadow-xs transition-colors",children:p?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}),(0,se.jsx)("span",{children:"Creating..."})]}):(0,se.jsx)("span",{children:"Create Repository"})})]})]})})}const S_=["className"],E_=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,S_);return(0,se.jsx)(Rs.bL,(0,ue.A)((0,ue.A)({ref:t,className:de("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s)},a),{},{children:(0,se.jsx)(Rs.C1,{className:de("flex items-center justify-center text-current"),children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})})}))});E_.displayName=Rs.bL.displayName;const T_={extraLarge:"h1",large:"h2",medium:"h3",small:"h4",tiny:"h5",extraTiny:"h6"},I_={extraLarge:"font-base44 text-[51px] font-semibold leading-normal",large:"font-base44 text-[25px] font-normal leading-normal",medium:"font-base44 text-base font-medium leading-6",small:"font-base44 text-sm font-normal leading-5",tiny:"font-base44 text-xs font-normal leading-4",extraTiny:"font-base44 text-[10px] font-normal leading-3"},P_=function(){return I_[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium"]},L_=e=>e?"text-white":"text-black",M_=["size","as","light","ellipsis","maxLines","onEllipsisStateChange","showTooltip","tooltipProps","children","className","dataHook","id"],R_=Y.forwardRef((e,t)=>{let{size:s="medium",as:a,light:n=!1,ellipsis:l=!1,maxLines:r,onEllipsisStateChange:i,showTooltip:o=!0,tooltipProps:c,children:d,className:u,dataHook:m,id:x}=e,h=(0,Nt.A)(e,M_);const p=a||function(){return T_[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium"]}(s),{elementRef:g,isEllipsisActive:f}=b_({enabled:l,children:d,onEllipsisStateChange:i}),v=j_(t,g);return(0,se.jsx)(N_,{show:o&&f,tooltipContent:d,tooltipProps:c,children:(0,se.jsx)(p,(0,ue.A)((0,ue.A)({ref:v,id:x,"data-hook":m,className:de(P_(s),L_(n),v_(l,r),u)},h),{},{children:d}))})});R_.displayName="Heading";class D_ extends te.H{constructor(){super(...arguments),this.publicClient=(0,me.Ay)("/ownership")}getBaseURL(){return"/apps"}async initiateTransfer(e,t){return this.axios.post("/".concat(e,"/ownership/transfer"),t)}async resendTransfer(e){return this.axios.post("/".concat(e,"/ownership/transfer/resend"),{})}async cancelTransfer(e){return this.axios.post("/".concat(e,"/ownership/transfer/cancel"),{})}async getPendingTransfer(e){return this.axios.get("/".concat(e,"/ownership/transfer/pending"))}async getTransferDetails(e){return this.publicClient.get("/accept",{params:{token:e}})}async acceptTransfer(e){return this.publicClient.post("/accept",{},{params:{token:e}})}}const F_=new D_,O_=e=>{let{isOpen:t,onClose:s,title:a,children:n}=e;return t?(0,se.jsx)("div",{className:"modal modal-open",children:(0,se.jsxs)("div",{className:"modal-box",children:[(0,se.jsx)("h3",{className:"font-bold text-lg",children:a}),(0,se.jsx)("div",{className:"py-4",children:n}),(0,se.jsx)("div",{className:"modal-action",children:(0,se.jsx)("button",{className:"btn",onClick:s,children:"Close"})})]})}):null};const U_=e=>{let{value:t,onChange:s,options:a,isMulti:n,placeholder:l,optionsNames:r=null}=e;const i=a.map((e,t)=>null==e?{label:(null==r?void 0:r[t])||"null",value:null}:"object"==typeof e?{label:e.label||r[t],value:e.value}:{label:r?r[t]:e,value:e});let o=[];if(t)if(n)o=t.map(e=>i.find(t=>t.value===e)).filter(Boolean);else{const e=i.find(e=>e.value===t);e&&(o=[e])}const c=e=>{const t=o.filter(t=>t.value!==e.value);s(t.map(e=>e.value))};var d;return n?(0,se.jsxs)(Ta,{className:"border rounded-md",children:[(0,se.jsx)("div",{className:"flex gap-1 flex-wrap p-2",children:null===(d=o)||void 0===d?void 0:d.map(e=>(0,se.jsxs)(gs,{variant:"secondary",className:"max-w-[200px]",children:[(0,se.jsx)("span",{className:"truncate",children:e.label}),(0,se.jsx)("button",{className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:t=>{"Enter"===t.key&&c(e)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:()=>c(e),children:(0,se.jsx)(la.A,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},e.value))}),(0,se.jsx)(Pa,{placeholder:l||"Search...",className:"border-none focus:ring-0"}),(0,se.jsx)(Ra,{className:"max-h-[200px] overflow-auto",children:0===(null==i?void 0:i.length)?(0,se.jsx)("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"No options available"}):null==i?void 0:i.map(e=>{var t;return(0,se.jsx)("div",{className:"cursor-pointer px-2 py-1.5 ".concat(null!==(t=o)&&void 0!==t&&t.some(t=>t.value===e.value)?"bg-muted":""),onClick:()=>(e=>{if(n){const t=o.some(t=>t.value===e.value)?o.filter(t=>t.value!==e.value):[...o,e];s(t.map(e=>e.value))}else s(e.value)})(e),children:e.label},e.value)})})]}):(0,se.jsxs)(br,{value:null==t?void 0:t.toString(),onValueChange:e=>s(e),children:[(0,se.jsx)(Nr,{children:(0,se.jsx)(yr,{placeholder:l})}),(0,se.jsx)(kr,{children:(0,se.jsx)(jr,{children:0===i.length?(0,se.jsx)("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"No options available"}):i.map(e=>{var t;return(0,se.jsx)(Ar,{value:(null===(t=e.value)||void 0===t?void 0:t.toString())||null,children:e.label},e.value||"null")})})})]})};function B_(e){let{value:t,onChange:s,name:a,itemSchema:n,isMulti:l=!1}=e;const{getEntitiesSDK:r,onAppError:i}=lp(),[o,c]=(0,Y.useState)([]),[d,u]=(0,Y.useState)(!1),m=r(i);return(0,Y.useEffect)(()=>{u(!0);const e=n.$ref.split("/");if(4!==e.length||""!==e[0]||"entities"!==e[1]||"id"!==e[3])throw new Error("Error in ".concat(a," field. Invalid $ref format: ").concat(n.$ref,". should be like /entities/EntityName/id"));const t=e[2];m[t].list().then(e=>{c(e.map(e=>{const s=m[t].schema();let a="id";for(const t in s.properties)if(t.toLowerCase().includes("name")||t.toLowerCase().includes("title")){a=t;break}return{label:e[a],value:e.id}})),u(!1)})},[n.$ref]),d?(0,se.jsx)("div",{children:"Loading..."}):(0,se.jsx)(U_,{options:o,onChange:s,isMulti:l,value:t})}var z_=s(32264),H_=s(19201);function V_(e){let{value:t,onChange:s,format:a="date",className:n="",closeOnSelect:l=!1}=e;const[r,i]=Y.useState(!1),o=(e,t)=>{if(t){const[s,a]=t.split(":");e.setHours(parseInt(s)),e.setMinutes(parseInt(a))}s(e),l&&e&&i(!1)};let c=t;return c=null==t||""===t?null:new Date(t),(0,se.jsxs)(Zl,{open:r,onOpenChange:i,children:[(0,se.jsx)(Jl,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"outline",className:de("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",n),children:[(0,se.jsx)(H_.A,{className:"mr-2 h-4 w-4"}),c?"date"===a?(0,z_.GP)(c,"PPP"):"date-time"===a?(0,z_.GP)(c,"PPP HH:mm:ss"):(0,z_.GP)(c,"HH:mm:ss"):(0,se.jsx)("span",{children:"Pick a date"})]})}),(0,se.jsx)(Ql,{className:"w-auto p-0",style:{zIndex:9999,position:"relative",isolation:"isolate",pointerEvents:"auto"},onInteractOutside:e=>{e.target.closest('[role="dialog"]')&&e.preventDefault()},forceMount:!0,children:(0,se.jsxs)("div",{className:"p-3 bg-popover shadow-lg rounded-md border",style:{pointerEvents:"auto"},children:[(0,se.jsx)(Ns,{mode:"single",selected:c,onSelect:e=>o(e),initialFocus:!0,className:"pointer-events-auto"}),("date-time"===a||"time"===a)&&(0,se.jsx)("input",{type:"time",className:"mt-3 w-full px-3 py-2 border rounded pointer-events-auto",value:c?(0,z_.GP)(c,"HH:mm"):"",onChange:e=>o(c||new Date,e.target.value)})]})})]})}var W_=s(77834);function q_(e){let{value:t,onChange:s,isMulti:a}=e;const n=lp(),[l,r]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{if(t){r((a?t:[t]).map(e=>({name:e.split("/").pop(),url:e})))}},[t,a]);const c=(0,Y.useCallback)(async e=>{o(!0);try{const t=await Promise.all(e.map(async e=>{const t=null!=n&&n.app?await ip.uploadAppFile(e,n.app.id):await ip.uploadFile(e);return{name:e.name,url:t.url}}));r(e=>{const s=a?[...e,...t]:t;return d(s),s})}catch(t){}finally{o(!1)}},[a,s]),d=e=>{s(a?e.map(e=>e.url):e.length>0?e[0].url:null)};return(0,se.jsxs)("div",{className:"w-full",children:[(0,se.jsxs)("div",{className:de("flex items-center justify-center w-full rounded-lg border border-dashed","border-muted-foreground/25 hover:border-primary transition-colors","p-4 cursor-pointer"),onClick:()=>{var e;return null===(e=document.getElementById("fileInput"))||void 0===e?void 0:e.click()},children:[i?(0,se.jsx)("div",{className:"loading loading-spinner"}):(0,se.jsx)(W_.A,{className:"h-5 w-5 text-muted-foreground"}),(0,se.jsx)("input",{id:"fileInput",type:"file",multiple:a,className:"hidden",onChange:e=>c(Array.from(e.target.files||[])),disabled:i})]}),l.length>0&&(0,se.jsx)("div",{className:"mt-2 space-y-1",children:l.map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center justify-between bg-muted/50 p-1 rounded",children:[(0,se.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline truncate",children:e.name}),(0,se.jsx)(zt,{variant:"ghost",size:"icon",onClick:()=>{return t=e,void r(e=>{const s=e.filter(e=>e!==t);return d(s),s});var t},className:"h-4 w-4 p-0",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]},t))})]})}const Y_=e=>{let{value:t,onChange:s}=e;return(0,se.jsx)(Os,{checked:t,onCheckedChange:s})},G_=e=>{let{value:t,onChange:s,className:a}=e;const[n,l]=(0,Y.useState)("");return(0,se.jsxs)("div",{className:de("flex flex-wrap items-center border rounded-md p-1",a),children:[t&&t.map((e,a)=>(0,se.jsxs)("span",{className:"bg-gray-200 rounded-md px-2 py-1 m-1 flex items-center",children:[e,(0,se.jsx)("button",{type:"button",onClick:()=>(e=>{const a=t.filter((t,s)=>s!==e);s(a)})(a),className:"ml-1 text-gray-500 hover:text-gray-700 focus:outline-none",children:"\xd7"})]},a)),(0,se.jsx)("input",{type:"text",value:n,onChange:e=>{l(e.target.value)},onKeyDown:e=>{if("Enter"!==e.key&&","!==e.key||!n.trim()){if("Backspace"===e.key&&!n&&t&&t.length>0){const e=t.slice(0,-1);s(e)}}else{e.preventDefault();const a=[...t||[],n.trim()];s(a),l("")}},className:"flex-grow outline-none px-2 py-1",placeholder:"enter values..."})]})},K_=Y.memo(e=>{let{path:t,value:s,setValueAt:a}=e;const[n,l]=Y.useState(null),[r,i]=Y.useState(()=>"string"==typeof s?s:JSON.stringify(s||{},null,2));Y.useEffect(()=>{const e="string"==typeof s?s:JSON.stringify(s||{},null,2);i(e)},[s]);return(0,se.jsxs)("div",{children:[(0,se.jsx)(ki,{value:r,onChange:e=>{const s=e.target.value;i(s);try{const e=JSON.parse(s);a(t,e),l(null)}catch(n){l("Invalid JSON")}},rows:10,className:"font-mono text-sm",placeholder:"{}"}),n&&(0,se.jsx)("div",{className:"text-xs text-red-500 mt-1",children:n})]})});function $_(e){if(void 0!==e.default)return e.default;switch(e.type){case"string":return"";case"number":return 0;case"boolean":return!1;default:return null}}const Z_=Y.memo(e=>{let{path:t,schema:s,value:a,setValueAt:n,getValueAt:l,uiSchema:r,validationErrors:i={}}=e;const o=a||[];if("string"===s.items.type&&!s.items.$ref&&!s.items.enum&&!s.items.format)return(0,se.jsx)(G_,{value:o,onChange:e=>n(t,e)});if("string"===s.items.type&&s.items.enum)return(0,se.jsx)(U_,{options:s.items.enum,isMulti:!0,value:o,onChange:e=>n(t,e),optionsNames:s.items.enumNames});if("string"===s.items.type&&"file"===s.items.format)return(0,se.jsx)(q_,{value:o,onChange:e=>n(t,e),isMulti:!0});if(s.items.$ref)return(0,se.jsx)(B_,{value:o,onChange:e=>n(t,e),name:t[t.length-1],itemSchema:s.items,isMulti:!0});const c=s.items.default||"object"===s.items.type?{}:null;if(!s.hasOwnProperty("items"))throw new Error("Error in json schema for array: items is required. path: ".concat(t.join(".")));return(0,se.jsxs)("div",{className:"space-y-4 ps-4 border-s-2 border-gray-200",children:[o.map((e,a)=>{const c=((e,t)=>e&&"object"==typeof e&&e.id?e.id:"string"==typeof e||"number"==typeof e?"".concat(e,"-").concat(t):"item-".concat(t))(e,a);return(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("button",{className:"absolute top-0 right-0 p-1 text-gray-500 hover:text-gray-700",onClick:()=>(e=>{const s=[...o];s.splice(e,1),n(t,s)})(a),children:(0,se.jsx)(la.A,{size:16})}),(0,se.jsx)(Q_,{path:[...t,a],value:e,schema:s.items,setValueAt:n,getValueAt:l,uiSchema:r,validationErrors:i[a]||{}})]},c)}),(0,se.jsx)("div",{className:"mt-2",children:(0,se.jsxs)("button",{type:"button",onClick:e=>{e.preventDefault(),n([...t,o.length],c)},className:"btn btn-outline btn-sm",children:[(0,se.jsx)(op.A,{size:16})," Add Item"]})})]})}),J_=Y.memo(e=>{let{path:t,schema:s,value:a,setValueAt:n,getValueAt:l,uiSchema:r,validationErrors:i={},suppressLabel:o}=e;const c=a||{},[d,u]=Y.useState(""),[m,x]=Y.useState($_(s.additionalProperties));return(0,se.jsxs)("div",{className:"space-y-2 ps-4 border-s-2 border-gray-200",children:[Object.entries(c).map(e=>{let[a,o]=e;return(0,se.jsx)("div",{children:(0,se.jsxs)("div",{className:"flex items-center gap-4 mb-1",children:[(0,se.jsx)("div",{className:"flex-1 mt-4",children:(0,se.jsx)(nl,{type:"text",value:a,disabled:!0,className:"bg-gray-50"})}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)(Q_,{path:[...t,a],value:o,schema:s.additionalProperties,setValueAt:n,getValueAt:l,uiSchema:r,validationErrors:i[a]||{},suppressLabel:!0})}),(0,se.jsx)("button",{className:"mt-4 p-1 text-gray-500 hover:text-gray-700",onClick:()=>(e=>{const s=(0,ue.A)({},c);delete s[e],n(t,s)})(a),"aria-label":"Remove",children:(0,se.jsx)(la.A,{size:16})})]})},a)}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("div",{className:"flex-1 mt-4",children:(0,se.jsx)(nl,{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"Key",className:"flex-1"})}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)(Q_,{path:[...t,"new"],value:m,schema:s.additionalProperties,setValueAt:(e,t)=>x(t),getValueAt:()=>m,uiSchema:r,validationErrors:{},suppressLabel:!0})})]}),(0,se.jsx)("div",{className:"mt-2 flex",children:(0,se.jsx)("button",{type:"button",onClick:e=>{if(e.preventDefault(),!d)return;const a=(0,ue.A)({},c);a[d]=m,n(t,a),u(""),x($_(s.additionalProperties))},className:"btn btn-outline btn-sm",children:"+ Add"})})]})]})});function Q_(e){let{path:t,getValueAt:s,setValueAt:a,schema:n,uiSchema:l={},validationErrors:r={},suppressLabel:i}=e;if("hidden"===l["ui:widget"])return(0,se.jsx)(se.Fragment,{});if(!n)throw new Error("Error in json schema: schema for the property is required. property path: ".concat(t.join(".")));const o=void 0===s(t)?n.default||null:s(t);let c;if(!i)if(l["ui:title"])c=l["ui:title"];else if(n.title)c=n.title;else{const e=t[t.length-1];c="number"==typeof e?void 0:e}return(0,se.jsxs)("div",{className:"mt-4",children:[c&&(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsx)("label",{htmlFor:t.join("__"),className:"text-sm font-medium text-gray-900",children:c}),n.description&&(0,se.jsx)("p",{className:"text-sm text-gray-500",children:n.description})]}),dc().isFunction(l["ui:widget"])?l["ui:widget"]({value:o,onChange:e=>a(t,e),getValueAt:s,setValueAt:a,schema:n,uiSchema:l,path:t}):n.enum&&"array"!==n.type&&"object"!==n.type?(0,se.jsx)(U_,{options:n.enum,optionsNames:n.enumNames,value:o,onChange:e=>a(t,e)}):n.$ref?(0,se.jsx)(B_,{value:o,onChange:e=>a(t,e),name:t[t.length-1],itemSchema:n}):"string"===n.type?"date"===n.format||"date-time"===n.format||"time"===n.format?(0,se.jsx)(V_,{format:n.format,value:o,onChange:e=>a(t,e)}):"file"===n.format?(0,se.jsx)(q_,{value:o,onChange:e=>a(t,e)}):"textarea"===l["ui:widget"]?(0,se.jsx)(ki,{value:null!=o?o:"",onChange:e=>a(t,e.target.value)}):(0,se.jsx)(nl,{type:"text",value:null!=o?o:"",onChange:e=>a(t,e.target.value)}):"number"===n.type||"integer"===n.type?(0,se.jsx)(nl,{type:"number",value:null!=o?o:"",onChange:e=>{const s=e.target.value;if(""===s)return void a(t,null);const l="integer"===n.type?parseInt(s,10):parseFloat(s);isNaN(l)||a(t,l)},min:n.minimum,max:n.maximum,step:"integer"===n.type?1:"any"}):"boolean"===n.type?(0,se.jsx)(Y_,{value:o,onChange:e=>a(t,e)}):"array"===n.type?(0,se.jsx)(Z_,{path:t,schema:n,value:o,setValueAt:a,getValueAt:s,uiSchema:l.hasOwnProperty("items")?l.items:l,validationErrors:r}):"object"===n.type?n.additionalProperties?(0,se.jsx)(J_,{path:t,schema:n,value:o,setValueAt:a,getValueAt:s,uiSchema:l,validationErrors:r,suppressLabel:i}):n.properties?(0,se.jsx)("div",{className:"space-y-4 ps-4 border-s-2 border-gray-200",children:Object.entries(n.properties).map(e=>{let[n,i]=e;return(0,se.jsx)(Q_,{path:[...t,n],getValueAt:s,setValueAt:a,schema:i,uiSchema:l[n]||{},validationErrors:r[n]||{}},n)})}):(0,se.jsx)(K_,{path:t,value:o,setValueAt:a}):void 0,r&&dc().isString(r)&&(0,se.jsx)("div",{className:"text-red-500 text-sm mt-1",children:r})]})}function X_(e,t,s){if(0===t.length)return s;const[a,...n]=t,l=dc().isNumber(n[0]),r=dc().isArray(e)?[...e]:(0,ue.A)({},e);return 0===n.length?r[a]=s:r[a]=X_(l?r[a]||[]:r[a]||{},n,s),r}function ek(e,t){if(dc().isNil(e)||0===t.length)return e;const[s,...a]=t;return 0===a.length?e[s]:ek(e[s],a)}const tk=e=>{let{schema:t,onChange:s,onSubmit:a,initialValues:n,uiSchema:l}=e;const[r,i]=(0,Y.useState)(n||{}),[o,c]=(0,Y.useState)({});if(!t||dc().isEmpty(t)||dc().isEmpty(t.properties))throw new Error("Error In JsonSchemaForm: valid json schema is required, but got: "+JSON.stringify(t));const d=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a={};if("object"===e.type&&e.properties){Object.entries(e.properties).forEach(e=>{let[n,l]=e;const r=[...s,n],i=d(l,t,r);dc().isEmpty(i)||(a[n]=i)});const n=function(e){if(!e||(0,cc.isEmpty)(e))throw new Error("JSON Schema error is required, got: "+JSON.stringify(e));if((0,cc.isEmpty)(e.properties))throw new Error("JSON Schema error: properties are required in schema, got schema: "+JSON.stringify(e));return e.required||[]}(e)||[];n.forEach(n=>{const r=[...s,n],i=ek(t,r)||e.properties[n].default,o=ek(l,r),c="hidden"===(null==o?void 0:o["ui:widget"]);"boolean"===e.properties[n].type||null!=i&&""!==i||c||(a[n]="This field is required")})}else if("array"===e.type&&e.items){(ek(t,s)||[]).forEach((n,l)=>{const r=[...s,l],i=d(e.items,t,r);dc().isEmpty(i)||(a[l]=i)})}return a},u=(e,t)=>{const a=X_(r,e,t);i(a),s&&s(a)};if(dc().isFunction(l)&&(l=l(r)),l&&"object"==typeof l){const e={};Object.entries(l).forEach(t=>{let[s,a]=t;const n=s.split(".");let l=e;for(let e=0;e<n.length-1;e++)l[n[e]]||(l[n[e]]={}),l=l[n[e]];l[n[n.length-1]]=a}),l=e}return(0,se.jsxs)("form",{className:"pt-4",children:[Object.entries(t.properties).map(e=>{let[t,s]=e;return(0,se.jsx)(Q_,{path:[t],value:r[t],setValueAt:u,getValueAt:e=>ek(r,e),schema:s,uiSchema:(l||{})[t]||{},validationErrors:o[t]||{}},t)}),a&&(0,se.jsx)("div",{className:"mt-4",children:(0,se.jsx)(zt,{onClick:e=>{e.preventDefault();(()=>{const e=d(t,r);return c(e),dc().isEmpty(e)})()?a(r):(0,$.toast)("some fields are required: "+Object.keys(o).join(", "))},children:"Submit"})})]})},sk=tk,ak={type:"object",properties:{title:{type:"string",title:"Title",default:""},description:{type:"string",title:"Description",default:null},type:{type:"string",title:"Type",default:"string",enum:["string","number","boolean","object","array","binary"]}}};function nk(e){let t=dc().cloneDeep(ak);return"array"===e.type&&(e.items?t.properties.items=nk(e.items):t.properties.items=dc().cloneDeep(ak)),"string"===e.type&&(t.properties.format={type:"string",title:"Format",default:null,enum:["date","email","file","uri","date-time","ipv4","ipv6","regex"]},"file"!==e.format&&(t.properties.enum={type:"array",title:"Enum",default:null,items:{type:"string"}})),e.type,t}function lk(e){let{value:t,onSubmit:s}=e;const[a,n]=(0,Y.useState)(t),l=nk(a);return(0,se.jsx)(sk,{schema:l,initialValues:a,onChange:e=>{n(e)},onSubmit:s})}var rk=s(59807),ik=s(81807),ok=s(78541),ck=s(14754);function dk(e,t){if(t.$ref)return(0,se.jsx)(Rj.A,{size:16});switch(e){case"array":return(0,se.jsx)(jv.A,{size:16});case"date-time":case"date":return(0,se.jsx)(H_.A,{size:16});case"email":return(0,se.jsx)(Hc.A,{size:16});case"uri":case"url":return(0,se.jsx)(rk.A,{size:16});case"number":return(0,se.jsx)(ik.A,{size:16});case"boolean":return(0,se.jsx)(ok.A,{size:16});case"object":return(0,se.jsx)(ck.A,{size:16});default:return(0,se.jsx)(xb.A,{size:16})}}function uk(e){let{name:t,prop:s,schema:a,onEdit:n}=e;const l=Object.entries(s).filter(e=>{let[t]=e;return!["type","description","default","title","format","$ref","enum","items","properties","required"].includes(t)}),r=function(e){if("array"===e.type)return"array";if("string"===e.type){if("date-time"===e.format)return"date-time";if("date"===e.format)return"date";if("email"===e.format)return"email";if("uri"===e.format)return"uri";if("url"===e.format)return"url";if(e.$ref){const t=e.$ref.split("/");return t[t.length-2]}return"text"}return e.type}(s);return(0,se.jsx)("li",{className:"py-4",children:(0,se.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,se.jsx)("div",{className:"flex items-center justify-between",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("h5",{className:"font-semibold text-gray-900 me-2",children:s.title||t}),"  ("," ",dk(r,s),(0,se.jsx)("span",{className:"ml-1",children:r}),a.required&&a.required.includes(t)&&(0,se.jsx)("span",{className:"ml-2",children:", required"}),")"]})}),s.description&&(0,se.jsx)("p",{className:"text-sm text-gray-700",children:s.description}),void 0!==s.default&&(0,se.jsxs)("div",{className:"text-sm",children:[(0,se.jsx)("span",{className:"font-medium",children:"Default:"})," ",JSON.stringify(s.default)]}),s.enum&&(0,se.jsxs)("div",{className:"text-sm",children:[(0,se.jsx)("span",{className:"font-medium",children:"Options:"})," ",s.enum.join(", ")]}),s.items&&(0,se.jsx)("div",{className:"ps-6 border-s-4 border-gray-300",children:(0,se.jsx)(mk,{schema:s.items})}),s.properties&&(0,se.jsx)("div",{className:"ps-6 border-s-4 border-gray-300",children:(0,se.jsx)(mk,{schema:s})}),l.length>0&&(0,se.jsxs)("div",{className:"mt-2",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Additional Properties:"}),(0,se.jsx)("ul",{className:"mt-1 space-y-1",children:l.map(e=>{let[t,s]=e;return(0,se.jsxs)("li",{className:"text-sm text-gray-600",children:[(0,se.jsxs)("span",{className:"font-medium",children:[t,":"]})," ",JSON.stringify(s)]},t)})})]})]})},t)}function mk(e){let{schema:t,onEdit:s}=e;const[a,n]=(0,Y.useState)(null),l=(e,t)=>{n({name:e,prop:t})};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("ul",{className:"ps-4 border-s-4 border-gray-300",children:Object.entries(t.properties||{}).map(e=>{let[a,n]=e;return(0,se.jsx)(uk,{name:a,prop:n,schema:t,onEdit:s?l:null},a)})}),a&&(0,se.jsx)(O_,{isOpen:!!a,onClose:()=>{n(null)},title:"Edit ".concat(a.name),children:(0,se.jsx)(lk,{value:a.prop,onSubmit:e=>{s&&s(a.name,e),n(null)}})})]})}const xk=e=>{let{entity:t}=e;const{app:s,updateApp:a}=lp();return null!=t?(0,se.jsx)(mk,{schema:t,onEdit:(e,n)=>{const l=(0,ue.A)((0,ue.A)({},t),{},{properties:(0,ue.A)((0,ue.A)({},t.properties),{},{[e]:n})}),r=(0,ue.A)((0,ue.A)({},s.entities),{},{[t.name]:l});a({entities:r})}}):null},hk=["className","variant"],pk=(0,ft.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function gk(e){let{className:t,variant:s}=e,a=(0,Nt.A)(e,hk);return(0,se.jsx)("div",(0,ue.A)({className:de(pk({variant:s}),t)},a))}const fk=e=>{let{open:t,onOpenChange:s,title:a,description:n,confirmText:l="Continue",cancelText:r="Cancel",variant:i="default",onConfirm:o,dataHook:c}=e;return(0,se.jsx)(NN,{open:t,onOpenChange:s,children:(0,se.jsxs)(kN,{"data-hook":c,children:[(0,se.jsxs)(CN,{children:[(0,se.jsx)(SN,{children:a}),(0,se.jsx)(EN,{children:n})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{"data-hook":c?"".concat(c,"-cancel"):void 0,children:r}),(0,se.jsx)(TN,{onClick:()=>{o(),null==s||s(!1)},"data-hook":c?"".concat(c,"-confirm"):void 0,className:"destructive"===i?"bg-red-600 hover:bg-red-700 text-white":"",children:l})]})]})})};var vk=s(80026),bk=s(79017),jk=s(89445);const yk=["query"],Nk=["appId","timeRange","eventName","query"],wk=["appId","timeRange","eventName"];class _k extends te.H{getBaseURL(){return"/apps"}queryEvents(e,t){return this.axios.post("/".concat(e,"/analytics/query"),t)}getEventNames(e){return this.axios.get("/".concat(e,"/analytics/names"))}getEventPropertyKeys(e,t){return this.axios.get("/".concat(e,"/analytics/").concat(encodeURIComponent(t),"/properties"))}getUserStats(e){return this.axios.get("/".concat(e,"/analytics/stats/users"))}timeseries(e,t){let s,{query:a}=t,n=(0,Nt.A)(t,yk);try{const e=(new Date(n.end_time).getTime()-new Date(n.start_time).getTime())/36e5,t=Math.floor(e/24),a=36e5;s=t>3?24*a:a}catch(l){}return this.axios.post("/".concat(e,"/analytics/timeseries"),(0,ue.A)((0,ue.A)({},n),{},{q:a,bucket_size_ms:s}))}grouped(e,t){return this.axios.post("/".concat(e,"/analytics/grouped"),t)}getSuggestions(e){return this.axios.get("/".concat(e,"/analytics/suggestions"))}async timeAggregation(e){const{appId:t,timeRange:s,eventName:a,query:n}=e,l=(0,Nt.A)(e,Nk),{buckets:r,totals:i}=await this.timeseries(t,{event_name:a,start_time:s.from.toISOString(),end_time:s.to.toISOString(),query:n?JSON.stringify((0,jk.m9)(n)):void 0,metrics:[{name:l.valueName,function:l.func,field:l.field}]});return{data:Ak(r.map(e=>({[l.categoryName]:e.bucket,[l.valueName]:e.metrics[l.valueName]})),s),total:i[l.valueName]}}async groupAggregation(e){const{appId:t,timeRange:s,eventName:a}=e,n=(0,Nt.A)(e,wk),l=await this.grouped(t,{event_name:a,start_time:s.from.toISOString(),end_time:s.to.toISOString(),metrics:[{name:n.valueName,function:n.func,field:n.field}]});return{data:l.groups.filter(e=>null!=e.metrics[n.valueName]).map(e=>({[n.categoryName]:e.group,[n.valueName]:e.metrics[n.valueName]})),total:l.totals[n.valueName]}}}const kk=new _k;function Ck(e){var t;if(!e)return{categoryKey:"",category:"",valueKey:"",value:0};const[s,a]=null!==(t=Object.entries(e))&&void 0!==t?t:[];return"number"==typeof s[1]?{categoryKey:null==a?void 0:a[0],category:null==a?void 0:a[1],valueKey:null==s?void 0:s[0],value:null==s?void 0:s[1]}:{categoryKey:null==s?void 0:s[0],category:null==s?void 0:s[1],valueKey:null==a?void 0:a[0],value:null==a?void 0:a[1]}}function Ak(e,t){if(!e.length)return[];const s=e=>[new Date(Ck(e).category).getTime(),Ck(e).value],a=t=>({[Ck(e[0]).categoryKey]:new Date(t[0]).toISOString(),[Ck(e[0]).valueKey]:t[1]}),n=e.map(s),l=Math.min(...n.map(e=>e[0])),r=Math.max(...n.map(e=>e[0])),i=Math.min(l,t.from.getTime()),o=Math.max(r,t.to.getTime());let c=1/0;for(let m=0;m<n.length-1;m++){const e=n[m+1][0]-n[m][0];e<c&&(c=e)}const d=[[i,0],...e.map(s),[o,0]],u=[];for(let m=0;m<d.length-1;m++){const e=d[m],t=d[m+1];if(u.push(a(e)),!t)break;t[0]-e[0]>c&&u.push(a([(e[0]+t[0])/2,0]))}return u.push(a([o,0])),u}const Sk=vk.Ay.object({event_name:vk.Ay.string(),user_id:vk.Ay.string(),session_id:vk.Ay.string(),page_url:vk.Ay.string().optional(),properties:vk.Ay.record(vk.Ay.string(),vk.Ay.any()).optional(),metadata:vk.Ay.object({device_type:vk.Ay.string().optional(),os:vk.Ay.string().optional(),country_code:vk.Ay.string().optional()}),timestamp:vk.Ay.number().int()}),Ek=((0,bk.Ay)(Sk),e=>{let{suggestion:t,onClick:s}=e;return(0,se.jsxs)("button",{onClick:s,className:"w-full text-left bg-blue-50 rounded-lg p-3 hover:bg-blue-100 transition-colors cursor-pointer group flex items-center gap-2 font-base44",children:[(0,se.jsx)(Xx.A,{className:"w-4 h-4 text-slate-500 flex-shrink-0"}),(0,se.jsx)("p",{className:"flex-1 text-sm text-gray-600 leading-6 group-hover:text-gray-800 font-base44",children:t})]})}),Tk=()=>(0,se.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 flex items-center gap-2",children:[(0,se.jsx)($r,{className:"w-4 h-4 rounded flex-shrink-0"}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)($r,{className:"h-4 w-4/5"})})]}),Ik=(0,Y.createContext)(null),Pk=()=>{const e=(0,Y.useContext)(Ik);if(!e)throw new Error("Table compound components must be used within Table");return e},Lk={position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:0},Mk={xxTiny:"py-0.5",xTiny:"py-1.5",tiny:"py-3",small:"py-4",compact:"py-[18px]",medium:"py-5",large:"py-7"},Rk={start:"justify-start text-left",center:"justify-center text-center",end:"justify-end text-right"},Dk=e=>Rk[e]||Rk.start,Fk=e=>{if(null==e)return;const t="number"==typeof e?"".concat(e,"px"):e;return{width:t,maxWidth:t}},Ok=e=>e.reduce((e,t)=>{if(t.stickyActionCell)return e;if(null!=t.width){return e+(e=>{if("number"==typeof e)return e<0?0:e;const t=e.trim().match(/^(\d+(?:\.\d+)?)(px|rem|em|%)?$/);if(!t)return 0;const s=parseFloat(t[1]);switch(t[2]||"px"){case"px":return s;case"rem":case"em":return 16*s;default:return 0}})(t.width)}return e+150},0);var Uk=s(14703);const Bk=Y.memo(e=>{let{isDescending:t,className:s,"data-testid":a}=e;const n="h-4 w-4 text-slate-400";return(0,se.jsx)("span",{className:s||"flex-shrink-0","data-testid":a||"sort-icon",children:t?(0,se.jsx)(Uk.A,{className:n,"aria-label":"Sort descending"}):(0,se.jsx)(kp.A,{className:n,"aria-label":"Sort ascending"})})});Bk.displayName="SortIcon";const zk=e=>{let{column:t,colIndex:s,onSortClick:a}=e;const{showLeftShadow:n}=Pk(),l=Dk(t.align),r=Fk(t.width),i=t.sortable&&void 0!==t.sortDescending,o=t.sortable;return(0,se.jsx)("th",{style:r,className:de("h-[42px]",t.stickyActionCell?"pl-2 pr-4":"px-6",{"cursor-pointer select-none hover:text-gray-900 transition-colors":o,"sticky right-0 z-20":t.stickyActionCell,"sticky left-0 z-10 bg-slate-50":t.sticky,"after:content-[''] after:absolute after:top-0 after:bottom-0 after:left-full after:w-8 after:pointer-events-none after:bg-gradient-to-r after:from-slate-100 after:to-transparent after:shadow-[inset_8px_0_8px_-8px_rgba(0,0,0,0.15)]":t.sticky&&n}),onClick:o?()=>{a&&a(t,s)}:void 0,children:(0,se.jsxs)("div",{className:de("flex items-center gap-2",l),children:["end"===t.align&&i&&(0,se.jsx)(Bk,{isDescending:t.sortDescending}),(0,se.jsx)(__,{size:"small",secondary:!0,tagName:"span",children:t.title}),"end"!==t.align&&i&&(0,se.jsx)(Bk,{isDescending:t.sortDescending})]})})};zk.displayName="TableHeaderCell";const Hk=["titleBarDisplay","className"],Vk=e=>{let{titleBarDisplay:t=!0,className:s}=e,a=(0,Nt.A)(e,Hk);const{columns:n,onSortClick:l}=Pk();return(0,se.jsx)("thead",(0,ue.A)((0,ue.A)({"data-testid":"table-header",className:de(t&&"sticky top-0 z-20 border-b bg-slate-50",s),style:t?void 0:Lk},a),{},{children:(0,se.jsx)("tr",{children:n.map((e,t)=>(0,se.jsx)(zk,{column:e,colIndex:t,onSortClick:l},e.id))})}))};Vk.displayName="TableHeader";const Wk=e=>{let{column:t,row:s,rowIndex:a,paddingClass:n,isActive:l,isHighlight:r,isDisabled:i}=e;const{showLeftShadow:o}=Pk(),c=Dk(t.align),d=Fk(t.width),u=t.render(s,a),m=Y.isValidElement(u)?u:(0,se.jsx)(__,{size:"small",weight:t.important?"normal":"thin",tagName:"span",ellipsis:!0,children:u});return(0,se.jsx)("td",{style:d,className:de("bg-white",t.stickyActionCell?"pl-2 pr-4":"px-6",n,{"sticky right-0 z-10 overflow-visible before:content-[''] before:absolute before:left-[-40px] before:top-0 before:bottom-0 before:w-[40px] before:bg-gradient-to-r before:from-transparent before:to-white before:pointer-events-none before:z-[-1] group-hover:before:to-slate-50":t.stickyActionCell,"sticky left-0 z-10":t.sticky,"after:content-[''] after:absolute after:top-0 after:bottom-0 after:left-full after:w-8 after:pointer-events-none after:bg-gradient-to-r after:from-white after:to-transparent after:shadow-[inset_8px_0_8px_-8px_rgba(0,0,0,0.15)] group-hover:after:from-slate-50":t.sticky&&o,"group-hover:bg-slate-50":!r&&!l,"bg-teal-50/30 group-hover:bg-teal-100/50":r,"bg-orange-50/50 group-hover:bg-orange-100/50":l&&!r}),onClick:e=>{t.onCellClick&&!i&&(e.stopPropagation(),t.onCellClick(t,s,a,e))},children:(0,se.jsx)("div",{className:de("flex items-center min-h-[28px]",c),children:m})})};Wk.displayName="TableCell";const qk=e=>{let{colSpan:t,isLastRow:s,removePadding:a,children:n}=e;const{showLastRowDivider:l}=Pk();return(0,se.jsx)("tr",{className:de("border-b bg-slate-50/30",{"border-b-0":!l&&s}),children:(0,se.jsx)("td",{colSpan:t,className:de({"p-0":a,"px-6 py-4":!a}),children:n})})};qk.displayName="TableRowDetails";const Yk=e=>{let{row:t,rowIndex:s,isActive:a,isHighlight:n,isDisabled:l,dynamicClass:r,isLastRow:i,isExpanded:o,isExpandable:c}=e;const{columns:d,onRowClick:u,onMouseEnterRow:m,onMouseLeaveRow:x,rowVerticalPadding:h,rowClass:p,showLastRowDivider:g,rowDetails:f,removeRowDetailsPadding:v}=Pk(),b=Mk[h]||Mk.compact;const j=c&&o&&f||!g&&i;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("tr",{className:de("group border-b",{"hover:bg-slate-50/50":!l,"cursor-pointer":u&&!l,"bg-orange-50/50":a,"bg-teal-50/30":n,"opacity-50 cursor-not-allowed":l,"border-b-0":j},p,r),onClick:()=>{u&&!l&&u(t,s)},onMouseEnter:()=>{m&&m(t,s)},onMouseLeave:()=>{x&&x(t,s)},children:d.map(e=>(0,se.jsx)(Wk,{column:e,row:t,rowIndex:s,paddingClass:b,isActive:a,isHighlight:n,isDisabled:l},e.id))}),c&&o&&f&&(0,se.jsx)(qk,{colSpan:d.length,isLastRow:i,removePadding:v,children:f(t)})]})};Yk.displayName="TableRow";const Gk=()=>(0,se.jsx)("div",{className:"h-24 px-6 flex items-center justify-center",children:(0,se.jsx)(__,{secondary:!0,children:"No data available"})});Gk.displayName="DefaultEmptyState";const Kk=e=>{let t=Object.assign({},((0,fs.A)(e),e));const{data:s,columns:a,isRowActive:n,isRowHighlight:l,isRowDisabled:r,dynamicRowClass:i,emptyStateElement:o,rowDetails:c,expandedRowIds:d}=Pk();return 0===s.length?(0,se.jsx)("tbody",(0,ue.A)((0,ue.A)({},t),{},{children:(0,se.jsx)("tr",{children:(0,se.jsx)("td",{colSpan:a.length,className:"p-0",children:null!=o?o:(0,se.jsx)(Gk,{})})})})):(0,se.jsx)("tbody",(0,ue.A)((0,ue.A)({},t),{},{children:s.map((e,t)=>(0,se.jsx)(Yk,{row:e,rowIndex:t,isActive:null==n?void 0:n(e),isHighlight:null==l?void 0:l(e),isDisabled:null==r?void 0:r(e),dynamicClass:null==i?void 0:i(e),isLastRow:t===s.length-1,isExpanded:!!c&&(null==d?void 0:d.has(e.id)),isExpandable:!!c&&e.expandable},e.id))}))};Kk.displayName="TableBody";const $k=["className","titleBarDisplay","headerClassName"],Zk=Y.forwardRef((e,t)=>{let{className:s,titleBarDisplay:a=!0,headerClassName:n}=e,l=(0,Nt.A)(e,$k);const{minTableWidth:r,data:i}=Pk(),o=i.length>0;return(0,se.jsx)("div",(0,ue.A)((0,ue.A)({ref:t,className:de("relative w-full",s)},l),{},{children:(0,se.jsxs)("table",{className:"w-full caption-bottom text-sm",style:o?{minWidth:"".concat(r,"px")}:void 0,children:[o&&(0,se.jsx)(Vk,{titleBarDisplay:a,className:n}),(0,se.jsx)(Kk,{})]})}))});Zk.displayName="Table.Content";const Jk=["className"],Qk=["className"],Xk=["className","variant"],eC=["className"],tC=["className"],sC=["className"],aC=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,Jk);return(0,se.jsx)("div",(0,ue.A)({ref:t,"data-slot":"empty",className:de("flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12",s)},a))});function nC(e){let{className:t}=e,s=(0,Nt.A)(e,Qk);return(0,se.jsx)("div",(0,ue.A)({"data-slot":"empty-header",className:de("flex max-w-sm flex-col items-center gap-2 text-center",t)},s))}aC.displayName="Empty";const lC=(0,ft.cva)("mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0",{variants:{variant:{default:"bg-transparent",icon:"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6"}},defaultVariants:{variant:"default"}});function rC(e){let{className:t,variant:s="default"}=e,a=(0,Nt.A)(e,Xk);return(0,se.jsx)("div",(0,ue.A)({"data-slot":"empty-icon","data-variant":s,className:de(lC({variant:s,className:t}))},a))}function iC(e){let{className:t}=e,s=(0,Nt.A)(e,eC);return(0,se.jsx)("div",(0,ue.A)({"data-slot":"empty-title",className:de("text-base font-medium tracking-tight leading-none",t)},s))}function oC(e){let{className:t}=e,s=(0,Nt.A)(e,tC);return(0,se.jsx)("div",(0,ue.A)({"data-slot":"empty-description",className:de("text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4",t)},s))}function cC(e){let{className:t}=e,s=(0,Nt.A)(e,sC);return(0,se.jsx)("div",(0,ue.A)({"data-slot":"empty-content",className:de("flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm",t)},s))}const dC=["className","title","subtitle","image","children"],uC=Y.forwardRef((e,t)=>{let{className:s,title:a,subtitle:n,image:l,children:r}=e,i=(0,Nt.A)(e,dC);return(0,se.jsxs)(aC,(0,ue.A)((0,ue.A)({ref:t,className:de("border-0 py-12",s)},i),{},{children:[(0,se.jsxs)(nC,{children:[l&&(0,se.jsx)(rC,{children:l}),a&&(0,se.jsx)(iC,{children:a}),n?"string"==typeof n&&n.includes("\n")?(0,se.jsx)(oC,{children:n.split("\n").map((e,t)=>(0,se.jsxs)(Y.Fragment,{children:[e,t<n.split("\n").length-1&&(0,se.jsx)("br",{})]},t))}):(0,se.jsx)(oC,{children:n}):null]}),r&&(0,se.jsx)(cC,{children:r})]}))});uC.displayName="Table.EmptyState";const mC=["className","children","autoCollapseToolbar"],xC=Y.forwardRef((e,t)=>{let{className:s,children:a,autoCollapseToolbar:n=!0}=e,l=(0,Nt.A)(e,mC);const{collapseToolbar:r}=Pk(),i=n&&r;return(0,se.jsx)("div",{"data-testid":"table-toolbar-wrapper",className:"transition-all duration-300 ease-in-out overflow-hidden w-full",style:{maxHeight:i?"0px":"200px",opacity:i?0:1},children:(0,se.jsx)("div",(0,ue.A)((0,ue.A)({ref:t,className:de("flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4 px-4 sm:px-6 py-3 border-b bg-slate-50/50",s)},l),{},{children:a}))})});xC.displayName="Table.Toolbar";const hC=["className"],pC=e=>{let{className:t}=e,s=(0,Nt.A)(e,hC);const{hasMore:a,loadMore:n,horizontalScrollRef:l}=Pk(),[r,i]=Y.useState(!1),{isLoading:o,handleLoadMore:c,canLoadMore:d}=(e=>{let{hasMore:t,loadMore:s,scrollContainerRef:a,scrollDistance:n=250,scrollDelay:l=100}=e;const[r,i]=Y.useState(!1),o=Y.useRef(null),c=Boolean(t&&s);return Y.useEffect(()=>()=>{o.current&&(clearTimeout(o.current),o.current=null)},[]),{isLoading:r,handleLoadMore:Y.useCallback(async()=>{if(s){o.current&&(clearTimeout(o.current),o.current=null),i(!0);try{const e=null==a?void 0:a.current,t=s();t instanceof Promise&&await t,o.current=setTimeout(()=>{e&&"function"==typeof e.scrollBy&&e.scrollBy({top:n,behavior:"smooth"}),o.current=null},l)}finally{i(!1)}}},[s,a,n,l]),canLoadMore:c}})({hasMore:a,loadMore:n,scrollContainerRef:l,scrollDistance:250,scrollDelay:100});return Y.useEffect(()=>{const e=null==l?void 0:l.current;if(!e||!d)return;const t=()=>{const{scrollTop:t,scrollHeight:s,clientHeight:a}=e;i(s-t-a<=200)};t(),e.addEventListener("scroll",t);const s=new ResizeObserver(t);return s.observe(e),()=>{e.removeEventListener("scroll",t),s.disconnect()}},[l,d]),d&&r?(0,se.jsx)("div",(0,ue.A)((0,ue.A)({className:de("flex items-center justify-center py-4 bg-white border-t border-slate-200",t)},s),{},{children:(0,se.jsx)("button",{onClick:c,disabled:o,className:de("text-sm text-blue-600 hover:text-blue-700 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed",{"cursor-wait":o}),children:o?(0,se.jsxs)("span",{className:"flex items-center gap-2",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):"Load more"})})):null};pC.displayName="LoadMoreButton";const gC=e=>{let{showTop:t,showBottom:s,showLeft:a,hasStickyLeftColumn:n}=e;return(0,se.jsxs)(se.Fragment,{children:[t&&(0,se.jsx)("div",{"data-testid":"scroll-indicator-top",className:"absolute top-0 left-0 right-0 h-6 pointer-events-none z-20 bg-gradient-to-b from-white via-white/60 to-transparent","aria-hidden":"true"}),s&&(0,se.jsx)("div",{"data-testid":"scroll-indicator-bottom",className:"absolute bottom-[6px] left-0 right-0 h-6 pointer-events-none z-20 bg-gradient-to-t from-white via-white/60 to-transparent","aria-hidden":"true"}),a&&!n&&(0,se.jsx)("div",{"data-testid":"scroll-indicator-left",className:"absolute top-0 bottom-0 left-0 w-6 pointer-events-none z-20 bg-gradient-to-r from-white via-white/60 to-transparent","aria-hidden":"true"})]})},fC=["className","data","columns","hasMore","loadMore","onRowClick","onMouseEnterRow","onMouseLeaveRow","isRowActive","isRowHighlight","isRowDisabled","onSortClick","rowVerticalPadding","rowClass","dynamicRowClass","showLastRowDivider","rowDetails","allowMultiDetailsExpansion","removeRowDetailsPadding","children"],vC=de("[&::-webkit-scrollbar]:h-[6px]","[&::-webkit-scrollbar]:w-[6px]","[&::-webkit-scrollbar-track]:bg-transparent","[&::-webkit-scrollbar-thumb]:bg-[#737373]","[&::-webkit-scrollbar-thumb]:rounded-full","[&::-webkit-scrollbar-thumb]:hover:bg-[#5a5a5a]","[&::-webkit-scrollbar-corner]:bg-transparent"),bC=["className","children","subtitle","titleTooltip","subtitleTooltip"],jC=Y.forwardRef((e,t)=>{let{className:s,children:a,subtitle:n,titleTooltip:l,subtitleTooltip:r}=e,i=(0,Nt.A)(e,bC);const o=Boolean(l||r),c=(0,se.jsxs)("div",(0,ue.A)((0,ue.A)({ref:t,className:de("flex flex-col gap-0.5",s)},i),{},{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(R_,{size:"medium",className:"flex items-center gap-2",children:a}),l&&(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("button",{type:"button",className:"text-slate-400 hover:text-slate-600 transition-colors","aria-label":"More information",children:(0,se.jsx)(Oy.A,{className:"h-4 w-4"})})}),(0,se.jsx)(pp,{children:l})]})]}),n&&(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(__,{size:"small",secondary:!0,children:n}),r&&(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("button",{type:"button",className:"text-slate-400 hover:text-slate-600 transition-colors","aria-label":"More information about subtitle",children:(0,se.jsx)(Oy.A,{className:"h-4 w-4"})})}),(0,se.jsx)(pp,{children:r})]})]})]}));return o?(0,se.jsx)(mp,{delayDuration:0,skipDelayDuration:0,children:c}):c});jC.displayName="Table.Toolbar.Title";const yC=["className","children"],NC=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,yC);return(0,se.jsx)("div",(0,ue.A)((0,ue.A)({ref:t,className:de("flex flex-wrap items-center gap-2 w-full sm:w-auto",s)},n),{},{children:a}))});NC.displayName="Table.Toolbar.Actions";const wC=Object.assign(e=>{let{className:t,data:s,columns:a,hasMore:n,loadMore:l,onRowClick:r,onMouseEnterRow:i,onMouseLeaveRow:o,isRowActive:c,isRowHighlight:d,isRowDisabled:u,onSortClick:m,rowVerticalPadding:x="compact",rowClass:h,dynamicRowClass:p,showLastRowDivider:g=!1,rowDetails:f,allowMultiDetailsExpansion:v=!1,removeRowDetailsPadding:b=!1,children:j}=e,y=(0,Nt.A)(e,fC);const N=Y.useMemo(()=>Ok(a),[a]),w=Y.useMemo(()=>a.some(e=>e.sticky),[a]),_=Y.useRef(null),{showTop:k,showBottom:C,showLeft:A,collapseToolbar:S}=((e,t)=>{const[s,a]=Y.useState({showTop:!1,showBottom:!1,showLeft:!1,showRight:!1,collapseToolbar:!1}),n=Y.useRef(!1);return Y.useEffect(()=>{const s=e.current,l=t.current;if(!s||!l)return;const r=()=>{const{scrollTop:e,scrollHeight:t,clientHeight:r}=s,{scrollLeft:i,scrollWidth:o,clientWidth:c}=l,d=(u=e,m=n.current,u>20||!(u<5)&&m);var u,m;n.current=d,a({showTop:e>1,showBottom:e<t-r-1,showLeft:i>1,showRight:i<o-c-1,collapseToolbar:d})};r(),s.addEventListener("scroll",r),l.addEventListener("scroll",r);const i=new ResizeObserver(r);return i.observe(s),i.observe(l),()=>{s.removeEventListener("scroll",r),l.removeEventListener("scroll",r),i.disconnect()}},[e,t]),s})(_,_),{expandedRowIds:E,toggleRowExpansion:T}=((e,t)=>{const[s,a]=Y.useState(new Set);return Y.useEffect(()=>{const t=new Set(e.map(e=>e.id));a(e=>{const s=Array.from(e);return s.some(e=>!t.has(e))?new Set(s.filter(e=>t.has(e))):e})},[e]),{expandedRowIds:Y.useMemo(()=>{const t=new Set;return e.forEach(e=>{void 0!==e.expanded?e.expanded&&t.add(e.id):s.has(e.id)&&t.add(e.id)}),t},[e,s]),toggleRowExpansion:Y.useCallback(e=>{a(s=>{const a=new Set(s);return a.has(e)?a.delete(e):(t||a.clear(),a.add(e)),a})},[t])}})(s,v),{toolbarChildren:I,contentChildren:P,emptyStateElement:L,hasContentChild:M}=(e=>Y.useMemo(()=>{const t=[],s=[];let a=null,n=!1;return Y.Children.forEach(e,e=>{var l,r;Y.isValidElement(e)?e.type!==uC?e.type===xC||"Table.Toolbar"===(null===(l=e.type)||void 0===l?void 0:l.displayName)?t.push(e):(s.push(e),e.type!==Zk&&"Table.Content"!==(null===(r=e.type)||void 0===r?void 0:r.displayName)||(n=!0)):a=e:s.push(e)}),{toolbarChildren:t,contentChildren:s,emptyStateElement:a,hasContentChild:n}},[e]))(j),R=Y.useMemo(()=>({data:s,columns:a,onRowClick:r,onMouseEnterRow:i,onMouseLeaveRow:o,isRowActive:c,isRowHighlight:d,isRowDisabled:u,onSortClick:m,rowVerticalPadding:x,rowClass:h,dynamicRowClass:p,showLastRowDivider:g,hasMore:n,loadMore:l,minTableWidth:N,emptyStateElement:L,collapseToolbar:S,horizontalScrollRef:_,showLeftShadow:A,rowDetails:f,allowMultiDetailsExpansion:v,removeRowDetailsPadding:b,expandedRowIds:E,toggleRowExpansion:T}),[s,a,r,i,o,c,d,u,m,x,h,p,g,n,l,N,L,S,_,A,f,v,b,E,T]);return(0,se.jsx)(Ik.Provider,{value:R,children:(0,se.jsxs)("div",(0,ue.A)((0,ue.A)({className:de("flex-1 w-full h-full flex flex-col rounded-lg border bg-white shadow-sm overflow-hidden",t)},y),{},{children:[I.length>0&&(0,se.jsx)("div",{className:"relative w-full",children:I}),(0,se.jsxs)("div",{className:"relative w-full flex-1 flex flex-col min-h-0",children:[(0,se.jsx)(gC,{showTop:k,showBottom:C,showLeft:A,hasStickyLeftColumn:w}),(0,se.jsxs)("div",{ref:_,"data-testid":"table-vertical-scroll-container",className:de("relative w-full flex-1 overflow-auto overscroll-none",vC),children:[P,!M&&(0,se.jsx)(Zk,{})]}),(0,se.jsx)(pC,{})]})]}))})},{Toolbar:Object.assign(xC,{Actions:NC,Title:jC}),Content:Zk,EmptyState:uC}),_C=["className","primaryAction","secondaryActions","alwaysVisible"],kC=Y.forwardRef((e,t)=>{let{className:s,primaryAction:a,secondaryActions:n,alwaysVisible:l=!1}=e,r=(0,Nt.A)(e,_C);return(0,se.jsxs)("div",(0,ue.A)((0,ue.A)({ref:t,"data-testid":"table-action-cell",className:de("flex items-center justify-end gap-2",{"md:opacity-0 md:group-hover:opacity-100 md:has-[[data-dropdown-open='true']]:opacity-100 md:transition-opacity":!l},s)},r),{},{children:[a,n]}))});function CC(e){return null==e?e:Array.isArray(e)?e.filter(e=>void 0!==e).map(CC).sort():"object"==typeof e?Object.entries(e).filter(e=>{let[t,s]=e;return void 0!==s}).sort((e,t)=>e[0].localeCompare(t[0])).map(e=>{let[t,s]=e;return[t,CC(s)]}).flat():e}kC.displayName="TableActionCell";const AC=["id"],SC=["id"],EC=e=>{Kd.invalidateQueries({predicate:t=>"filtered-crud"===t.queryKey[0]&&t.queryKey[1]===e})},TC=(e,t,s)=>{var a;const n=null!==(a=null==s?void 0:s.pageSize)&&void 0!==a?a:25,l=Y.useMemo(()=>null!=s&&s.query?(0,jk.I5)(null==s?void 0:s.query).query():null,[JSON.stringify(null==s?void 0:s.query)]),r=Ix(l,700),i=r!==l,{data:{items:o,hasMore:c},isLoading:d,error:u,resetData:m,refetch:x}=Xd({initialData:{items:[],hasMore:!0},query:async a=>{var l,i,c;const d=null!==(l=null==a||null===(i=a.refetchData)||void 0===i?void 0:i.nextPage)&&void 0!==l&&l?[...o]:[],u=d.length,m=n,x=await Kd.fetchQuery((0,ue.A)({queryKey:[null!==(c=null==s?void 0:s.queryKeyTag)&&void 0!==c?c:"filtered-crud",e,m,u,CC(r)],queryFn:async()=>t.filter(r,null,m,u)},Gd.DEFAULT)),h=x.length>=m,p=null!=s&&s.sort?[...x].sort((e,t)=>s.sort(e,t)):x;return{items:[...d,...p],hasMore:h}}},[r,e]),h=()=>{EC(e)},p=()=>{h(),m({data:{items:[],hasMore:!0},refetch:!0})},{mutate:g}=eu({mutate:async e=>{const s=o.find(t=>t.id===e);if(!s)return;const a=await t.get(s.id);a&&m(t=>{const s=t.items.findIndex(t=>t.id===e);if(-1===s)return!1;const n=[...t.items];return n[s]=a,{data:{items:n,hasMore:t.hasMore},refetch:!1}})}}),{mutate:f,isLoading:v}=eu({mutate:async e=>{const{id:s}=e,a=(0,Nt.A)(e,AC);if(!!s)return await t.update(s,a),(0,ue.A)({id:s},a);{const{id:e}=await t.create(a);return(0,ue.A)({id:e},a)}},toastSuccess:"Item updated successfully",toastError:"Failed to save item",onSuccess:e=>{let{id:t}=e,s=(0,Nt.A)(e,SC);m(e=>{const a=[...e.items],n=a.findIndex(e=>e.id===t);return-1!==n?(a[n]=(0,ue.A)((0,ue.A)({},a[n]),s),h(),{data:{items:a,hasMore:e.hasMore},refetch:!1}):(p(),!1)})}}),{mutate:b,isLoading:j}=eu({mutate:async e=>{let{id:s}=e;null!=s&&(await t.delete(s),m(e=>{const t=e.items.filter(e=>e.id!==s);return h(),{data:{items:t,hasMore:e.hasMore},refetch:!1}}))},toastSuccess:"Item deleted successfully",toastError:"Failed to delete item"});return{items:o,hasMore:c,reload:p,upsertItem:f,deleteItem:b,reloadItem:g,loadMore:()=>x({nextPage:!0}),isLoading:d||v||j,isFilterChanging:i,error:u}},IC={us:{name:"United States",code:"us",currency:"USD",currencySymbol:"$",currencyCode:"USD",flag:"\u{1f1fa}\u{1f1f8}"},uk:{name:"United Kingdom",code:"uk",currency:"GBP",currencySymbol:"\xa3",currencyCode:"GBP",flag:"\u{1f1ec}\u{1f1e7}"},jp:{name:"Japan",code:"jp",currency:"JPY",currencySymbol:"\xa5",currencyCode:"JPY",flag:"\u{1f1ef}\u{1f1f5}"},kr:{name:"South Korea",code:"kr",currency:"KRW",currencySymbol:"\u20a9",currencyCode:"KRW",flag:"\u{1f1f0}\u{1f1f7}"},au:{name:"Australia",code:"au",currency:"AUD",currencySymbol:"AU$",currencyCode:"AUD",flag:"\u{1f1e6}\u{1f1fa}"},nz:{name:"New Zealand",code:"nz",currency:"NZD",currencySymbol:"NZ$",currencyCode:"NZD",flag:"\u{1f1f3}\u{1f1ff}"},cn:{name:"China",code:"cn",currency:"CNY",currencySymbol:"\xa5",currencyCode:"CNY",flag:"\u{1f1e8}\u{1f1f3}"},mx:{name:"Mexico",code:"mx",currency:"MXN",currencySymbol:"$",currencyCode:"MXN",flag:"\u{1f1f2}\u{1f1fd}"},br:{name:"Brazil",code:"br",currency:"BRL",currencySymbol:"R$",currencyCode:"BRL",flag:"\u{1f1e7}\u{1f1f7}"},ar:{name:"Argentina",code:"ar",currency:"ARS",currencySymbol:"$",currencyCode:"ARS",flag:"\u{1f1e6}\u{1f1f7}"},gb:{name:"United Kingdom",code:"gb",currency:"GBP",currencySymbol:"\xa3",currencyCode:"GBP",flag:"\u{1f1ec}\u{1f1e7}"},fr:{name:"France",code:"fr",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1eb}\u{1f1f7}"},de:{name:"Germany",code:"de",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1e9}\u{1f1ea}"},it:{name:"Italy",code:"it",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1ee}\u{1f1f9}"},es:{name:"Spain",code:"es",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1ea}\u{1f1f8}"},pt:{name:"Portugal",code:"pt",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1f5}\u{1f1f9}"},nl:{name:"Netherlands",code:"nl",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1f3}\u{1f1f1}"},be:{name:"Belgium",code:"be",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1e7}\u{1f1ea}"},ch:{name:"Switzerland",code:"ch",currency:"CHF",currencySymbol:"CHF",currencyCode:"CHF",flag:"\u{1f1e8}\u{1f1ed}"},at:{name:"Austria",code:"at",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1e6}\u{1f1f9}"},se:{name:"Sweden",code:"se",currency:"SEK",currencySymbol:"kr",currencyCode:"SEK",flag:"\u{1f1f8}\u{1f1ea}"},no:{name:"Norway",code:"no",currency:"NOK",currencySymbol:"kr",currencyCode:"NOK",flag:"\u{1f1f3}\u{1f1f4}"},fi:{name:"Finland",code:"fi",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1eb}\u{1f1ee}"},dk:{name:"Denmark",code:"dk",currency:"DKK",currencySymbol:"kr",currencyCode:"DKK",flag:"\u{1f1e9}\u{1f1f0}"},pl:{name:"Poland",code:"pl",currency:"PLN",currencySymbol:"z\u0142",currencyCode:"PLN",flag:"\u{1f1f5}\u{1f1f1}"},cz:{name:"Czech Republic",code:"cz",currency:"CZK",currencySymbol:"K\u010d",currencyCode:"CZK",flag:"\u{1f1e8}\u{1f1ff}"},hu:{name:"Hungary",code:"hu",currency:"HUF",currencySymbol:"Ft",currencyCode:"HUF",flag:"\u{1f1ed}\u{1f1fa}"},ie:{name:"Ireland",code:"ie",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1ee}\u{1f1ea}"},gr:{name:"Greece",code:"gr",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1ec}\u{1f1f7}"},ru:{name:"Russia",code:"ru",currency:"RUB",currencySymbol:"\u20bd",currencyCode:"RUB",flag:"\u{1f1f7}\u{1f1fa}"},tr:{name:"Turkey",code:"tr",currency:"TRY",currencySymbol:"\u20ba",currencyCode:"TRY",flag:"\u{1f1f9}\u{1f1f7}"},in:{name:"India",code:"in",currency:"INR",currencySymbol:"\u20b9",currencyCode:"INR",flag:"\u{1f1ee}\u{1f1f3}"},sg:{name:"Singapore",code:"sg",currency:"SGD",currencySymbol:"S$",currencyCode:"SGD",flag:"\u{1f1f8}\u{1f1ec}"},id:{name:"Indonesia",code:"id",currency:"IDR",currencySymbol:"Rp",currencyCode:"IDR",flag:"\u{1f1ee}\u{1f1e9}"},th:{name:"Thailand",code:"th",currency:"THB",currencySymbol:"\u0e3f",currencyCode:"THB",flag:"\u{1f1f9}\u{1f1ed}"},my:{name:"Malaysia",code:"my",currency:"MYR",currencySymbol:"RM",currencyCode:"MYR",flag:"\u{1f1f2}\u{1f1fe}"},ph:{name:"Philippines",code:"ph",currency:"PHP",currencySymbol:"\u20b1",currencyCode:"PHP",flag:"\u{1f1f5}\u{1f1ed}"},za:{name:"South Africa",code:"za",currency:"ZAR",currencySymbol:"R",currencyCode:"ZAR",flag:"\u{1f1ff}\u{1f1e6}"},eg:{name:"Egypt",code:"eg",currency:"EGP",currencySymbol:"E\xa3",currencyCode:"EGP",flag:"\u{1f1ea}\u{1f1ec}"},ng:{name:"Nigeria",code:"ng",currency:"NGN",currencySymbol:"\u20a6",currencyCode:"NGN",flag:"\u{1f1f3}\u{1f1ec}"},ke:{name:"Kenya",code:"ke",currency:"KES",currencySymbol:"KSh",currencyCode:"KES",flag:"\u{1f1f0}\u{1f1ea}"},ma:{name:"Morocco",code:"ma",currency:"MAD",currencySymbol:"\u062f.\u0645.",currencyCode:"MAD",flag:"\u{1f1f2}\u{1f1e6}"},sa:{name:"Saudi Arabia",code:"sa",currency:"SAR",currencySymbol:"\ufdfc",currencyCode:"SAR",flag:"\u{1f1f8}\u{1f1e6}"},ae:{name:"United Arab Emirates",code:"ae",currency:"AED",currencySymbol:"\u062f.\u0625",currencyCode:"AED",flag:"\u{1f1e6}\u{1f1ea}"},il:{name:"Israel",code:"il",currency:"ILS",currencySymbol:"\u20aa",currencyCode:"ILS",flag:"\u{1f1ee}\u{1f1f1}"},ir:{name:"Iran",code:"ir",currency:"IRR",currencySymbol:"\ufdfc",currencyCode:"IRR",flag:"\u{1f1ee}\u{1f1f7}"},qa:{name:"Qatar",code:"qa",currency:"QAR",currencySymbol:"\u0631.\u0642",currencyCode:"QAR",flag:"\u{1f1f6}\u{1f1e6}"},kw:{name:"Kuwait",code:"kw",currency:"KWD",currencySymbol:"\u062f.\u0643",currencyCode:"KWD",flag:"\u{1f1f0}\u{1f1fc}"},bh:{name:"Bahrain",code:"bh",currency:"BHD",currencySymbol:".\u062f.\u0628",currencyCode:"BHD",flag:"\u{1f1e7}\u{1f1ed}"},pk:{name:"Pakistan",code:"pk",currency:"PKR",currencySymbol:"\u20a8",currencyCode:"PKR",flag:"\u{1f1f5}\u{1f1f0}"},bd:{name:"Bangladesh",code:"bd",currency:"BDT",currencySymbol:"\u09f3",currencyCode:"BDT",flag:"\u{1f1e7}\u{1f1e9}"},np:{name:"Nepal",code:"np",currency:"NPR",currencySymbol:"\u20a8",currencyCode:"NPR",flag:"\u{1f1f3}\u{1f1f5}"},lk:{name:"Sri Lanka",code:"lk",currency:"LKR",currencySymbol:"\u20a8",currencyCode:"LKR",flag:"\u{1f1f1}\u{1f1f0}"},mn:{name:"Mongolia",code:"mn",currency:"MNT",currencySymbol:"\u20ae",currencyCode:"MNT",flag:"\u{1f1f2}\u{1f1f3}"},mm:{name:"Myanmar",code:"mm",currency:"MMK",currencySymbol:"K",currencyCode:"MMK",flag:"\u{1f1f2}\u{1f1f2}"},vn:{name:"Vietnam",code:"vn",currency:"VND",currencySymbol:"\u20ab",currencyCode:"VND",flag:"\u{1f1fb}\u{1f1f3}"},kh:{name:"Cambodia",code:"kh",currency:"KHR",currencySymbol:"\u17db",currencyCode:"KHR",flag:"\u{1f1f0}\u{1f1ed}"},la:{name:"Laos",code:"la",currency:"LAK",currencySymbol:"\u20ad",currencyCode:"LAK",flag:"\u{1f1f1}\u{1f1e6}"},tw:{name:"Taiwan",code:"tw",currency:"TWD",currencySymbol:"NT$",currencyCode:"TWD",flag:"\u{1f1f9}\u{1f1fc}"},hk:{name:"Hong Kong",code:"hk",currency:"HKD",currencySymbol:"HK$",currencyCode:"HKD",flag:"\u{1f1ed}\u{1f1f0}"},mo:{name:"Macau",code:"mo",currency:"MOP",currencySymbol:"MOP$",currencyCode:"MOP",flag:"\u{1f1f2}\u{1f1f4}"},uz:{name:"Uzbekistan",code:"uz",currency:"UZS",currencySymbol:"so'm",currencyCode:"UZS",flag:"\u{1f1fa}\u{1f1ff}"},kz:{name:"Kazakhstan",code:"kz",currency:"KZT",currencySymbol:"\u20b8",currencyCode:"KZT",flag:"\u{1f1f0}\u{1f1ff}"},tj:{name:"Tajikistan",code:"tj",currency:"TJS",currencySymbol:"\u0405\u041c",currencyCode:"TJS",flag:"\u{1f1f9}\u{1f1ef}"},kg:{name:"Kyrgyzstan",code:"kg",currency:"KGS",currencySymbol:"\u20b4",currencyCode:"KGS",flag:"\u{1f1f0}\u{1f1ec}"},tm:{name:"Turkmenistan",code:"tm",currency:"TMT",currencySymbol:"m",currencyCode:"TMT",flag:"\u{1f1f9}\u{1f1f2}"},af:{name:"Afghanistan",code:"af",currency:"AFN",currencySymbol:"\u060b",currencyCode:"AFN",flag:"\u{1f1e6}\u{1f1eb}"},ua:{name:"Ukraine",code:"ua",currency:"UAH",currencySymbol:"\u20b4",currencyCode:"UAH",flag:"\u{1f1fa}\u{1f1e6}"},by:{name:"Belarus",code:"by",currency:"BYN",currencySymbol:"Br",currencyCode:"BYN",flag:"\u{1f1e7}\u{1f1fe}"},ro:{name:"Romania",code:"ro",currency:"RON",currencySymbol:"lei",currencyCode:"RON",flag:"\u{1f1f7}\u{1f1f4}"},bg:{name:"Bulgaria",code:"bg",currency:"BGN",currencySymbol:"\u043b\u0432",currencyCode:"BGN",flag:"\u{1f1e7}\u{1f1ec}"},rs:{name:"Serbia",code:"rs",currency:"RSD",currencySymbol:"\u0434\u0438\u043d",currencyCode:"RSD",flag:"\u{1f1f7}\u{1f1f8}"},hr:{name:"Croatia",code:"hr",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1ed}\u{1f1f7}"},si:{name:"Slovenia",code:"si",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1f8}\u{1f1ee}"},sk:{name:"Slovakia",code:"sk",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1f8}\u{1f1f0}"},al:{name:"Albania",code:"al",currency:"ALL",currencySymbol:"L",currencyCode:"ALL",flag:"\u{1f1e6}\u{1f1f1}"},me:{name:"Montenegro",code:"me",currency:"EUR",currencySymbol:"\u20ac",currencyCode:"EUR",flag:"\u{1f1f2}\u{1f1ea}"},mk:{name:"North Macedonia",code:"mk",currency:"MKD",currencySymbol:"\u0434\u0435\u043d",currencyCode:"MKD",flag:"\u{1f1f2}\u{1f1f0}"},bs:{name:"Bahamas",code:"bs",currency:"BSD",currencySymbol:"B$",currencyCode:"BSD",flag:"\u{1f1e7}\u{1f1f8}"},cu:{name:"Cuba",code:"cu",currency:"CUP",currencySymbol:"$",currencyCode:"CUP",flag:"\u{1f1e8}\u{1f1fa}"},jm:{name:"Jamaica",code:"jm",currency:"JMD",currencySymbol:"J$",currencyCode:"JMD",flag:"\u{1f1ef}\u{1f1f2}"},do:{name:"Dominican Republic",code:"do",currency:"DOP",currencySymbol:"RD$",currencyCode:"DOP",flag:"\u{1f1e9}\u{1f1f4}"},co:{name:"Colombia",code:"co",currency:"COP",currencySymbol:"$",currencyCode:"COP",flag:"\u{1f1e8}\u{1f1f4}"},pe:{name:"Peru",code:"pe",currency:"PEN",currencySymbol:"S/",currencyCode:"PEN",flag:"\u{1f1f5}\u{1f1ea}"},cl:{name:"Chile",code:"cl",currency:"CLP",currencySymbol:"$",currencyCode:"CLP",flag:"\u{1f1e8}\u{1f1f1}"},ve:{name:"Venezuela",code:"ve",currency:"VES",currencySymbol:"Bs.S",currencyCode:"VES",flag:"\u{1f1fb}\u{1f1ea}"},ec:{name:"Ecuador",code:"ec",currency:"USD",currencySymbol:"$",currencyCode:"USD",flag:"\u{1f1ea}\u{1f1e8}"},bo:{name:"Bolivia",code:"bo",currency:"BOB",currencySymbol:"Bs.",currencyCode:"BOB",flag:"\u{1f1e7}\u{1f1f4}"},py:{name:"Paraguay",code:"py",currency:"PYG",currencySymbol:"\u20b2",currencyCode:"PYG",flag:"\u{1f1f5}\u{1f1fe}"},uy:{name:"Uruguay",code:"uy",currency:"UYU",currencySymbol:"$U",currencyCode:"UYU",flag:"\u{1f1fa}\u{1f1fe}"},na:{name:"Namibia",code:"na",currency:"NAD",currencySymbol:"$",currencyCode:"NAD",flag:"\u{1f1f3}\u{1f1e6}"},bw:{name:"Botswana",code:"bw",currency:"BWP",currencySymbol:"P",currencyCode:"BWP",flag:"\u{1f1e7}\u{1f1fc}"},zw:{name:"Zimbabwe",code:"zw",currency:"ZWL",currencySymbol:"$",currencyCode:"ZWL",flag:"\u{1f1ff}\u{1f1fc}"},ao:{name:"Angola",code:"ao",currency:"AOA",currencySymbol:"Kz",currencyCode:"AOA",flag:"\u{1f1e6}\u{1f1f4}"},et:{name:"Ethiopia",code:"et",currency:"ETB",currencySymbol:"Br",currencyCode:"ETB",flag:"\u{1f1ea}\u{1f1f9}"},gh:{name:"Ghana",code:"gh",currency:"GHS",currencySymbol:"\u20b5",currencyCode:"GHS",flag:"\u{1f1ec}\u{1f1ed}"},sn:{name:"Senegal",code:"sn",currency:"XOF",currencySymbol:"CFA",currencyCode:"XOF",flag:"\u{1f1f8}\u{1f1f3}"},ci:{name:"Ivory Coast",code:"ci",currency:"XOF",currencySymbol:"CFA",currencyCode:"XOF",flag:"\u{1f1e8}\u{1f1ee}"},cm:{name:"Cameroon",code:"cm",currency:"XAF",currencySymbol:"FCFA",currencyCode:"XAF",flag:"\u{1f1e8}\u{1f1f2}"},ml:{name:"Mali",code:"ml",currency:"XOF",currencySymbol:"CFA",currencyCode:"XOF",flag:"\u{1f1f2}\u{1f1f1}"},mr:{name:"Mauritania",code:"mr",currency:"MRU",currencySymbol:"UM",currencyCode:"MRU",flag:"\u{1f1f2}\u{1f1f7}"},td:{name:"Chad",code:"td",currency:"XAF",currencySymbol:"FCFA",currencyCode:"XAF",flag:"\u{1f1f9}\u{1f1e9}"}};var PC=s(63752),LC=s(19732);const MC="analytics-queries",RC=e=>null==e?void 0:e.split("_").join(" "),DC={default:{toNumberic:e=>{var t;return Number.parseInt(null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:"0")},formatter:e=>{var t;return null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:""}},defaultNullable:e=>({toNumberic:t=>{var s;return Number.parseInt(null!==(s=null==t?void 0:t.toString())&&void 0!==s?s:e.numeric.toString())},formatter:t=>{var s;return null!==(s=null==t?void 0:t.toString())&&void 0!==s?s:e.text}}),date:{toNumberic:e=>new Date(e).getTime(),formatter:e=>new Date(e).toLocaleTimeString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},time:{toNumberic:e=>new Date(e).getTime(),formatter:e=>new Date(e).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})},duration:{toNumberic:e=>Math.floor(e/6e4),formatter:e=>0===e?"0 s":(0,PC.a)({minutes:Math.floor(e/6e4),seconds:Number.parseFloat((e%6e4/1e3).toFixed(1))},{format:["hours","minutes","seconds"]})},count:{toNumberic:e=>{var t;return Number.parseInt(null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:"0")},formatter:e=>{var t;return null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:""}},urlPageFormatter:{toNumberic:e=>e,formatter:e=>{if(!e)return"Unknown";try{var t;const s=new URL(null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:"");return null==s?void 0:s.pathname}catch(s){return"Unknown"}}},countryCode:{toNumberic:e=>e,formatter:e=>{var t,s,a,n;if("string"!=typeof e)return"Unknown";const l=null==e?void 0:e.toLowerCase(),r=null!==(t=IC[l])&&void 0!==t?t:Object.values(IC).find(e=>e.name.toLowerCase()===l);return"".concat(null!==(s=null==r?void 0:r.flag)&&void 0!==s?s:""," ").concat(null!==(a=null!==(n=null==r?void 0:r.name)&&void 0!==n?n:e)&&void 0!==a?a:"Unknown")}}},FC={category:DC.default,value:DC.count},OC=e=>{if(null!=e)return Array.isArray(e)?e.map(OC):"object"==typeof e?Object.fromEntries(Object.entries(e).map(e=>{let[t,s]=e;return[(a=t,"$"!==(null==a?void 0:a[0])?a:a.slice(1)),OC(s)];var a})):e},UC=["items"],BC=(e,t)=>{var s;const{app:a}=lp(),n=Y.useMemo(()=>((e,t)=>({filter:async(s,a,n,l)=>{const r=OC(s);return(await kk.queryEvents(e,{event_name:t,limit:n,offset:l,q:JSON.stringify(r)})).events.map(e=>(0,ue.A)({id:e.event_id},e))},get:async s=>{var a,n;const l=await kk.queryEvents(e,{limit:1,offset:0,q:JSON.stringify({id:s}),event_name:t});return(0,ue.A)({id:null!==(a=null===(n=l.events[0])||void 0===n?void 0:n.event_id)&&void 0!==a?a:""},l.events[0])},create:async e=>{throw new Error("Not implemented")},update:async(e,t)=>{throw new Error("Not implemented")},delete:async e=>{throw new Error("Not implemented")}}))(null==a?void 0:a.id,e),[null==a?void 0:a.id,e]),l=Y.useMemo(()=>{var e,s,a;const n=(0,jk.I5)({timestamp:{$gte:null==t||null===(e=t.timeRange)||void 0===e?void 0:e.from.getTime(),$lte:null==t||null===(s=t.timeRange)||void 0===s?void 0:s.to.getTime()}}).query();return(0,jk.I5)(null!==(a=null==t?void 0:t.query)&&void 0!==a?a:{}).and(n).query()},[null==t?void 0:t.query,null==t?void 0:t.timeRange]),r=TC("event-queries-".concat(e),n,{query:l,pageSize:null!==(s=null==t?void 0:t.limit)&&void 0!==s?s:25,queryKeyTag:MC}),{items:i}=r,o=(0,Nt.A)(r,UC);return(0,ue.A)({events:i},o)},zC=["events","hasMore","loadMore","isLoading"],HC=e=>{var t;let{eventName:s,timeRange:a}=e;const{app:n}=lp(),l=BC(s,{timeRange:a}),{events:r,hasMore:i,loadMore:o,isLoading:c}=l,d=((0,Nt.A)(l,zC),r[0]),u=[{id:"timestamp",render:e=>DC.date.formatter(e.timestamp),title:"Date"},{id:"user_id",title:"User ID",render:e=>e.user_id},{id:"country",title:"Country",render:e=>{var t;return DC.countryCode.formatter(null===(t=e.metadata)||void 0===t?void 0:t.country)}},{id:"device_type",title:"Device Type",render:e=>{var t;return null===(t=e.metadata)||void 0===t?void 0:t.device_type}},...Object.keys(null!==(t=null==d?void 0:d.properties)&&void 0!==t?t:{}).map(e=>({id:e,render:t=>{var s,a;return"object"==typeof(a=null===(s=t.properties)||void 0===s?void 0:s[e])?(0,se.jsx)(se.Fragment,{children:JSON.stringify(a)}):(0,se.jsx)(__,{size:"small",ellipsis:!0,children:String(a)})},title:e}))],m=eu({mutate:async()=>{!async function(e,t){var s;const a=["timestamp","user_id","country","device_type",...Object.keys((null===(s=t[0])||void 0===s?void 0:s.properties)||{})],n=[a.join(","),...Object.values(t).map(e=>a.map(t=>{var s;const a=e.metadata,n=(0,ue.A)({timestamp:e.timestamp,user_id:e.user_id,country:null==a?void 0:a.country,device_type:null==a?void 0:a.device_type},e.properties),l={timestamp:DC.date.formatter,country:DC.countryCode.formatter},r=n[t],i=(null!==(s=l[t])&&void 0!==s?s:e=>{var t;return null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:""})(r),o=null==i?void 0:i.replace(/"/g,'""');return'"'.concat(o,'"')}).join(","))],l=n.join("\n"),r=new Blob([l],{type:"text/csv"}),i=window.URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download="".concat(e,"_export.csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i)}(s,r)},toastSuccess:"CSV exported successfully",toastError:"Failed to export CSV"});return(0,se.jsx)("div",{className:"flex flex-col h-full w-full gap-4 overflow-auto",children:(0,se.jsxs)(wC,{hasMore:i,loadMore:o,data:r,columns:u,className:"h-full w-full overflow-auto",children:[(0,se.jsx)(wC.Toolbar,{children:(0,se.jsx)(wC.Toolbar.Actions,{children:(0,se.jsxs)(Bx,{variant:"outline",size:"tiny",onClick:()=>{Tu("Export Initiated",{type:"csv",origin:"analytics_event_details",app_id:null==n?void 0:n.id}),m.mutate()},children:[(0,se.jsx)(xN.A,{className:"h-4 w-4"}),"Export CSV"]})})}),(0,se.jsx)(wC.Content,{}),(0,se.jsx)(wC.EmptyState,{title:c?"Loading...":"No events found"})]})})};var VC=s(84450),WC=s(30284),qC=s(36972);const YC=e=>{let{isLoading:t,children:s,className:a}=e;return(0,se.jsxs)("div",{className:de("w-full h-full flex",a,{"opacity-50 pointer-events-none relative":t}),children:[t&&(0,se.jsx)("div",{className:de("w-full h-full flex items-center justify-center absolute top-0 left-0"),children:(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"})}),s]})},GC=(e,t,s,a)=>{let{from:n,to:l}=t,{func:r,field:i,categoryName:o,valueName:c}=s;const{app:d}=lp(),u=null!=a&&a.query?JSON.stringify(a.query):void 0,{data:m,isLoading:x,refetch:h}=Xd({initialData:{data:[],total:0,changePct:0},enabled:!(null==d||!d.id),logErrorMsg:"Failed to fetch aggregation data",query:async()=>{const{data:t,total:s}=await Kd.fetchQuery((0,ue.A)((0,ue.A)({},Gd.DEFAULT),{},{retry:!1,queryKey:[MC,"time-series-data",e,null==d?void 0:d.id,n,l,r,i,o,c,u],queryFn:async()=>kk.timeAggregation({appId:null==d?void 0:d.id,eventName:e,timeRange:{from:n,to:l},func:r,field:i,categoryName:o,valueName:c,query:null==a?void 0:a.query})}));return{data:t,total:s,changePct:KC(t)}}},[e,n,l,r,i,o,c,null==d?void 0:d.id,u]);return{data:null==m?void 0:m.data,total:null==m?void 0:m.total,changePct:null==m?void 0:m.changePct,isLoading:x,reload:()=>{Kd.invalidateQueries({predicate:t=>{let{queryKey:s}=t;const[a,n,l]=s;return a===MC&&"time-series-data"===n&&l===e}}),h()}}};function KC(e){var t;if((null!==(t=null==e?void 0:e.length)&&void 0!==t?t:0)<2)return 0;const s=new Date(Ck(e[0]).category).getTime(),a=s+(new Date(Ck(e[e.length-1]).category).getTime()-s)/2,n=e.filter(e=>new Date(Ck(e).category).getTime()<=a),l=e.filter(e=>new Date(Ck(e).category).getTime()>a),r=.5*(Ck(n[n.length-1]).value+Ck(l[0]).value),i=n.reduce((e,t)=>e+Ck(t).value,r)/(n.length+1),o=(l.reduce((e,t)=>e+Ck(t).value,r)/(l.length+1)-i)/(i||1)*100;return Number(Math.min(Math.max(o,-999),999).toFixed(0))}const $C=e=>"number"==typeof e||"string"==typeof e&&!isNaN(Number(e)),ZC=e=>{let{title:t,actions:s,children:a,className:n}=e;return(0,se.jsxs)("div",{className:de("flex flex-col w-full h-full p-4 gap-5 font-base44",n),children:[(0,se.jsxs)("div",{className:"flex flex-row w-full justify-between items-center",children:[(0,se.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,se.jsx)("span",{className:"font-semibold",children:t})}),s]}),(0,se.jsx)("div",{className:"flex flex-col w-full h-full min-h-[100px]",children:a})]})};var JC=s(81095),QC=s(68354),XC=s(93245),eA=s(60158),tA=s(44813),sA=s(10734),aA=s(40992);const nA=e=>{let{data:t,metricConverter:s,range:a,color:n="#F97316"}=e;return(0,se.jsx)("div",{className:"w-full h-full font-base44 min-h-[100px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(QC.Q,{data:t,margin:{left:0,right:0,top:20,bottom:0},children:[(0,se.jsx)("defs",{children:(0,se.jsxs)("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,se.jsx)("stop",{offset:"0%",stopColor:n,stopOpacity:.3}),(0,se.jsx)("stop",{offset:"100%",stopColor:n,stopOpacity:.05})]})}),(0,se.jsx)(XC.d,{strokeDasharray:"0",vertical:!1,stroke:"#E2E8F0"}),(0,se.jsx)(eA.W,{dataKey:e=>{var t;return s.category.toNumberic(null===(t=Ck(e))||void 0===t?void 0:t.category)},tickFormatter:s.category.formatter,axisLine:!1,tickLine:!1,type:"number",scale:"auto",domain:null!=a?a:["dataMin","dataMax"],allowDataOverflow:!1,tick:{fill:"#94A3B8",fontSize:12},dy:10}),(0,se.jsx)(tA.h,{hide:!0}),(0,se.jsx)(sA.G,{type:"linear",dataKey:e=>{var t,a;return s.value.toNumberic(null!==(t=null===(a=Ck(e))||void 0===a?void 0:a.value)&&void 0!==t?t:0)},stroke:n,strokeWidth:2,fill:"url(#colorGradient)"}),(0,se.jsx)(aA.m,{content:e=>{let{active:t,payload:a,label:n}=e;if(!t||null==a||!a.length)return null;const l=a[0].payload,{category:r,value:i}=Ck(l),{valueKey:o}=Ck(l);return(0,se.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-lg px-3 py-2",children:[(0,se.jsx)("p",{className:"text-slate-500 text-xs",children:s.category.formatter(r)}),(0,se.jsxs)("p",{className:"text-slate-900 font-semibold text-sm",children:[s.value.formatter(i)," ",o]})]})}})]})})})};var lA=s(7838),rA=s(80369);const iA=[{value:"count",label:"Count"},{value:"count_unique",label:"Unique Count"},{value:"sum",label:"Sum"},{value:"avg",label:"Average"},{value:"min",label:"Min"},{value:"max",label:"Max"},{value:"p50",label:"P50"},{value:"p90",label:"P90"},{value:"p95",label:"P95"},{value:"p99",label:"P99"}],oA=e=>{var t,s;let{dashboardName:a,timeRange:n,className:l,customData:r,setCustomData:i}=e;const o=a,{requiresUpgrade:c,aggregationFunc:d="count",aggregationField:u}=r,{data:m,isLoading:x}=GC(o,n,{categoryName:"Date",valueName:null!==(t=null===(s=iA.find(e=>e.value===d))||void 0===s?void 0:s.label)&&void 0!==t?t:"Count",func:d,field:u});return(0,se.jsxs)(YC,{isLoading:x,className:de("min-h-[300px]",l,{"relative cursor-pointer":c}),children:[c&&(0,se.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full flex-col gap-4 bg-white/50 flex items-center justify-center text-sm text-muted-foreground",children:[(0,se.jsx)(my,{origin:"analytics_custom_event_dashboard"}),"Upgrade to enable view"]}),(0,se.jsx)(ZC,{title:RC(o),className:de({"blur-sm pointer-events-none":c}),actions:(0,se.jsx)(cA,{eventName:o,timeRange:n,config:r,update:e=>i((0,ue.A)((0,ue.A)({},r),e))}),children:(0,se.jsx)(nA,{data:m,range:[n.from.getTime(),n.to.getTime()],metricConverter:{category:DC.date,value:DC.count}})})]})},cA=e=>{var t,s;let{eventName:a,timeRange:n,config:l,update:r}=e;const[i,o]=Y.useState(!1),{propertyKeys:c,isLoading:d}=(e=>{var t;let{eventName:s,enabled:a=!0}=e;const{app:n}=lp(),{data:l,isLoading:r,refetch:i}=Xd({initialData:{property_keys:[]},enabled:!(null==n||!n.id)&&!!s&&a,logErrorMsg:"Failed to fetch event property keys",query:async()=>Kd.fetchQuery((0,ue.A)((0,ue.A)({},Gd.DEFAULT),{},{queryKey:[MC,"event-property-keys",null==n?void 0:n.id,s],queryFn:async()=>{const e=(await kk.queryEvents(null==n?void 0:n.id,{event_name:s,limit:1})).events[0],t=await kk.getEventPropertyKeys(null==n?void 0:n.id,s);if(null==e||!e.properties)return t;const a=Object.keys(e.properties),l=Object.entries(e.properties).filter(e=>{let[t,s]=e;return $C(s)}).map(e=>{let[t]=e;return t});return{property_keys:t.property_keys.filter(e=>l.includes(e)||!a.includes(e))}}}))},[null==n?void 0:n.id,s,a]);return{propertyKeys:null!==(t=null==l?void 0:l.property_keys)&&void 0!==t?t:[],isLoading:r,reload:i}})({eventName:a,enabled:i}),u=null!==(t=l.aggregationFunc)&&void 0!==t?t:"count",m=l.aggregationField,x=e=>e?e.replace(/^properties\./,"").split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"None";return(0,se.jsxs)(Nj,{open:i,onOpenChange:o,children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",children:(0,se.jsx)(Nv.A,{className:"w-4 h-4"})})}),(0,se.jsxs)(Aj,{align:"end",className:"w-56",children:[(0,se.jsxs)(Sj,{onClick:()=>dS.openModal("EventQueriesDrawer",{eventName:a,timeRange:n}),children:[(0,se.jsx)(Oy.A,{className:"w-4 h-4 mr-2"}),"Event Details"]}),(0,se.jsxs)(Sj,{onClick:()=>OA.updateDashboardLayoutData(a,{hidden:!0}),children:[(0,se.jsx)(lA.A,{className:"w-4 h-4 mr-2"}),"Hide"]}),(0,se.jsx)(Tj,{}),(0,se.jsxs)(_j,{children:[(0,se.jsxs)(kj,{children:[(0,se.jsx)(rA.A,{className:"w-4 h-4 mr-2"}),"Function: ",null===(s=iA.find(e=>e.value===u))||void 0===s?void 0:s.label]}),(0,se.jsx)(Cj,{children:iA.map(e=>(0,se.jsxs)(Sj,{onClick:()=>r({aggregationFunc:e.value,aggregationField:"count"===e.value?void 0:m}),children:[u===e.value?(0,se.jsx)(Ds.A,{className:"w-4 h-4 mr-2"}):(0,se.jsx)("span",{className:"w-4 mr-2"}),e.label]},e.value))})]}),(0,se.jsxs)(_j,{children:[(0,se.jsxs)(kj,{children:[(0,se.jsx)(ik.A,{className:"w-4 h-4 mr-2"}),"Field: ",x(m)]}),(0,se.jsx)(Cj,{className:"max-h-[300px] overflow-y-auto",children:d?(0,se.jsxs)(Sj,{disabled:!0,children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Sj,{onClick:()=>r({aggregationField:void 0}),children:[m?(0,se.jsx)("span",{className:"w-4 mr-2"}):(0,se.jsx)(Ds.A,{className:"w-4 h-4 mr-2"}),"None"]}),(0,se.jsx)(Tj,{}),c.map(e=>(0,se.jsxs)(Sj,{onClick:()=>r({aggregationField:"properties.".concat(e),aggregationFunc:"count"===u?"sum":u}),children:[m==="properties.".concat(e)?(0,se.jsx)(Ds.A,{className:"w-4 h-4 mr-2"}):(0,se.jsx)("span",{className:"w-4 mr-2"}),x(e)]},e))]})})]})]})]})},dA="__user_in_app__",uA="__initialization_event__",mA=(e,t,s)=>{let{from:a,to:n}=t,{func:l,field:r,categoryName:i,valueName:o}=s;const{app:c}=lp(),{data:d,isLoading:u,refetch:m}=Xd({initialData:{data:[],total:0},enabled:!(null==c||!c.id),logErrorMsg:"Failed to fetch grouped data",query:async()=>Kd.fetchQuery((0,ue.A)((0,ue.A)({},Gd.DEFAULT),{},{queryKey:[MC,"grouped-data",e,null==c?void 0:c.id,a,n,l,r,i,o],queryFn:async()=>kk.groupAggregation({appId:null==c?void 0:c.id,eventName:e,timeRange:{from:a,to:n},func:l,field:r,categoryName:i,valueName:o})}))},[e,a,n,l,r,i,o,null==c?void 0:c.id]);return{data:d.data,total:d.total,isLoading:u,reload:()=>{Kd.invalidateQueries({predicate:t=>{let{queryKey:s}=t;const[a,n,l]=s;return a===MC&&"grouped-data"===n&&l===e}}),m()}}};var xA=s(80294),hA=s(85706),pA=s(67628);const gA=e=>{let{data:t,direction:s="vertical",metricConverter:a=FC}=e;const n=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{if(n.current){n.current.clientWidth}},[n.current]);const l=e=>{var t;return null==a?void 0:a.category.formatter(null===(t=Ck(e))||void 0===t?void 0:t.category)},r=e=>{var t;return null==a?void 0:a.value.toNumberic(null===(t=Ck(e))||void 0===t?void 0:t.value)};return(0,se.jsx)(JC.u,{ref:n,width:"100%",height:56*t.length,children:(0,se.jsxs)(xA.E,{data:t,layout:s,margin:{left:0,right:0,top:0,bottom:0},barGap:4,children:[(0,se.jsx)(aA.m,{cursor:!1,content:e=>{let{payload:t}=e;if(null==t||!t.length)return null;const s=t[0].payload,a=l(s),n=r(s);return(0,se.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-lg px-3 py-2",children:[(0,se.jsx)("p",{className:"text-slate-500 text-xs",children:a}),(0,se.jsx)("p",{className:"text-slate-900 font-semibold text-sm",children:n})]})}}),"vertical"===s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(eA.W,{type:"number",hide:!0,domain:[0,"dataMax"]}),(0,se.jsx)(tA.h,{type:"category",hide:!0})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(tA.h,{type:"number",hide:!0,domain:[0,"dataMax"]}),(0,se.jsx)(eA.W,{type:"category",hide:!0})]}),(0,se.jsxs)(hA.y,{dataKey:r,fill:"#EFF6FF",radius:12,barSize:48,background:{fill:"transparent"},direction:s,children:[(0,se.jsx)(pA.Z,{dataKey:l,content:e=>{var t;const a=null===(t=n.current)||void 0===t?void 0:t.getBoundingClientRect(),{x:l,y:r,height:i,width:o,value:c}=e,d="vertical"===s?((null==a?void 0:a.width)||200)-80:o-16,u=((e,t,s)=>{if(!e)return e;const a=.55*s,n=Math.floor(t/a);return e.length<=n?e:e.slice(0,n-1)+"\u2026"})(String(c||""),d,14),m="vertical"===s?[l+12,r+i/2]:[l+o/2,r+i-12];return(0,se.jsx)("text",{x:m[0],y:m[1],fill:"#334155",fontSize:14,textAnchor:"vertical"===s?"start":"middle",dominantBaseline:"middle",children:u})}}),(0,se.jsx)(pA.Z,{dataKey:e=>{var t;return null==a?void 0:a.value.formatter(null===(t=Ck(e))||void 0===t?void 0:t.value)},content:e=>{var t;const a=null===(t=n.current)||void 0===t?void 0:t.getBoundingClientRect(),{x:l,y:r,height:i,width:o,value:c}=e,d="vertical"===s?[(null==a?void 0:a.width)-8,r+i/2]:[l+o/2+8,12];return(0,se.jsx)("text",{x:d[0],y:d[1],fill:"#64748B",fontSize:14,textAnchor:"end",dominantBaseline:"middle",children:c})},fontStyle:"normal"})]})]})})};var fA=s(12671),vA=s(54203),bA=s(72528);var jA=s(24183),yA=s(55184);const NA={horizontalBar:e=>{let{data:t,metricConverter:s}=e;return(0,se.jsxs)("div",{className:"flex flex-col gap-2 w-full h-full font-base44",children:[(0,se.jsx)("div",{className:"flex flex-row w-full gap-2 text-sm text-gray-500 justify-between"}),(0,se.jsx)(gA,{data:t,direction:"vertical",metricConverter:s})]})},verticalBar:e=>{let{data:t,metricConverter:s}=e;return(0,se.jsxs)("div",{className:"flex flex-row gap-2 w-full h-full font-base44 items-end",children:[(0,se.jsx)("div",{className:"flex flex-col w-min text-sm text-gray-500 justify-between"}),(0,se.jsx)(gA,{data:t,direction:"horizontal",metricConverter:s})]})},pie:e=>{var t;let{data:s,metricConverter:a=FC}=e;const n=Y.useRef([Math.random(),Math.random(),Math.random()]),l=(e,t)=>{const a=1-.8*e/(s.length+1),l=n.current.map(e=>e*a*255*t),r=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return"#"+t.map(e=>Number(e.toFixed(0)).toString(16).padStart(2,"0")).join("")}(...l);return r};return(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(fA.r,{children:[(0,se.jsx)(vA.F,{data:s,dataKey:null===(t=Ck(s[0]))||void 0===t?void 0:t.valueKey,cx:"50%",cy:"50%",paddingAngle:2,outerRadius:"90%",fill:"#8884d8",stroke:l(0,1),strokeWidth:2,isAnimationActive:!0,children:s.map((e,t)=>(0,se.jsx)(bA.f,{fill:l(t,.8),stroke:"none"},"cell-".concat(t)))}),(0,se.jsx)(aA.m,{content:e=>{let{active:t,payload:s}=e;if(!t||null==s||!s.length)return null;try{var a,n,l;const{value:e,category:t}=null!==(a=Ck(null===(n=s[0])||void 0===n||null===(l=n.payload)||void 0===l?void 0:l.payload))&&void 0!==a?a:{};return(0,se.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-lg px-3 py-2",children:[(0,se.jsx)("p",{className:"text-slate-500 text-xs",children:t}),(0,se.jsx)("p",{className:"text-slate-900 font-semibold text-sm",children:e})]})}catch(r){return null}}})]})})}},wA=e=>{let{title:t,data:s,metricConverter:a,chartType:n,setChartType:l}=e;const r=NA[n];return(0,se.jsx)(ZC,{title:t,actions:(0,se.jsx)(CA,{chartType:n,setChartType:l}),children:(0,se.jsx)("div",{className:"flex w-full h-full max-h-[250px] overflow-auto",children:(0,se.jsx)(r,{data:s,metricConverter:a})})})},_A={horizontalBar:"Horizontal Bar",verticalBar:"Vertical Bar",pie:"Pie Chart"},kA={horizontalBar:(0,se.jsx)(jA.A,{className:"w-4 h-4"}),verticalBar:(0,se.jsx)(Xv.A,{className:"w-4 h-4"}),pie:(0,se.jsx)(yA.A,{className:"w-4 h-4"})},CA=e=>{let{chartType:t,setChartType:s}=e;return(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",children:(0,se.jsx)(Nv.A,{className:"w-4 h-4"})})}),(0,se.jsx)(Aj,{align:"end",children:Object.keys(NA).map(e=>(0,se.jsxs)(Sj,{className:de("rounded-[8px] ",{"bg-slate-100":t===e},"flex flex-row gap-2 items-center"),onClick:()=>s(e),children:[kA[e],_A[e]]},e))})]})},AA=["dashboardName"],SA={pageTraffic:{Dashboard:e=>{var t;let{timeRange:s,customData:a,setCustomData:n}=e;const l=null!==(t=a.chartType)&&void 0!==t?t:"horizontalBar",r=mA(dA,s,{categoryName:"Page URL",valueName:"Users",func:"count",field:"properties.page_name"}),{filteredData:i}=OA.useBuiltInFilter("pageTraffic",r.data);return(0,se.jsx)(YC,{isLoading:r.isLoading,children:(0,se.jsx)(wA,{title:"Page Traffic",data:i,chartType:l,setChartType:e=>n((0,ue.A)((0,ue.A)({},a),{},{chartType:e})),metricConverter:{category:DC.default,value:DC.count}})})},eventField:"properties.page_name",displayName:"Page traffic",eventName:dA},country:{Dashboard:e=>{var t;let{timeRange:s,customData:a,setCustomData:n}=e;const l=null!==(t=a.chartType)&&void 0!==t?t:"horizontalBar",r=mA(uA,s,{categoryName:"Country",valueName:"Users",func:"count",field:"metadata.country"}),{filteredData:i}=OA.useBuiltInFilter("country",r.data);return(0,se.jsx)(YC,{isLoading:r.isLoading,children:(0,se.jsx)(wA,{title:"Country",data:i,chartType:l,setChartType:e=>n((0,ue.A)((0,ue.A)({},a),{},{chartType:e})),metricConverter:{category:DC.countryCode,value:DC.count}})})},eventField:"metadata.country",displayName:"Country",eventName:uA},operatingSystem:{Dashboard:e=>{var t;let{timeRange:s,customData:a,setCustomData:n}=e;const l=null!==(t=a.chartType)&&void 0!==t?t:"horizontalBar",r=mA(uA,s,{categoryName:"OperatingSystem",valueName:"Users",func:"count",field:"metadata.os"}),{filteredData:i}=OA.useBuiltInFilter("operatingSystem",r.data);return(0,se.jsx)(YC,{isLoading:r.isLoading,children:(0,se.jsx)(wA,{title:"Operating System",data:i,chartType:l,setChartType:e=>n((0,ue.A)((0,ue.A)({},a),{},{chartType:e})),metricConverter:{category:DC.default,value:DC.count}})})},eventField:"metadata.os",displayName:"Operating systems",eventName:uA},referrer:{Dashboard:e=>{var t;let{timeRange:s,customData:a,setCustomData:n}=e;const l=null!==(t=a.chartType)&&void 0!==t?t:"horizontalBar",r=mA(uA,s,{categoryName:"Referrer",valueName:"Users",func:"count",field:"referrer"}),{filteredData:i}=OA.useBuiltInFilter("referrer",r.data);return(0,se.jsx)(YC,{isLoading:r.isLoading,children:(0,se.jsx)(wA,{title:"Referrer",data:i,chartType:l,setChartType:e=>n((0,ue.A)((0,ue.A)({},a),{},{chartType:e})),metricConverter:{category:DC.defaultNullable({numeric:0,text:"Direct"}),value:DC.count}})})},eventField:"referrer",displayName:"Referrers",eventName:uA},devices:{Dashboard:e=>{var t;let{timeRange:s,customData:a,setCustomData:n}=e;const l=null!==(t=a.chartType)&&void 0!==t?t:"horizontalBar",r=mA(uA,s,{categoryName:"Device",valueName:"Users",func:"count",field:"metadata.device_type"}),{filteredData:i}=OA.useBuiltInFilter("devices",r.data);return(0,se.jsx)(YC,{isLoading:r.isLoading,children:(0,se.jsx)(wA,{title:"Devices",data:i,chartType:l,setChartType:e=>n((0,ue.A)((0,ue.A)({},a),{},{chartType:e})),metricConverter:{category:DC.defaultNullable({numeric:0,text:"Unknown"}),value:DC.count}})})},eventField:"metadata.device_type",displayName:"Devices",eventName:uA}},EA=Object.freeze(Object.keys(SA)),TA=e=>SA[e].eventField,IA=e=>{var t,s;let{dashboardName:a}=e,n=(0,Nt.A)(e,AA);const l=null!==(t=null===(s=SA[a])||void 0===s?void 0:s.Dashboard)&&void 0!==t?t:oA;return(0,se.jsx)(l,(0,ue.A)({dashboardName:a},n))},PA={pageTraffic:{span:3,hidden:!1},country:{span:3,hidden:!1},operatingSystem:{span:3,hidden:!1},referrer:{span:3,hidden:!1},devices:{span:3,hidden:!1}};var LA;const MA={Today:()=>({from:(0,VC.o)(new Date),to:new Date}),Yesterday:()=>({from:(0,VC.o)((0,WC.e)(new Date,1)),to:(0,qC.D)((0,WC.e)(new Date,1))}),"Last 7 days":()=>({from:(0,WC.e)(new Date,7),to:new Date}),"Last 30 days":()=>({from:(0,WC.e)(new Date,30),to:new Date}),"Last 90 days":()=>({from:(0,WC.e)(new Date,90),to:new Date})},RA=["Today","Yesterday","Last 7 days"],DA="Today",FA=null===(LA=MA[DA])||void 0===LA?void 0:LA.call(MA),OA=hu({dashboardsOrder:[],builtinFiltersOptions:{},builtinFiltersValues:{}},{_selectedTimeFilter:DA,_timeRange:FA,_dashboardsNames:[],_dashboardsCustomData:{},_dashboardsLayoutData:{}}).use(rm("analyticsPage",{pick:["dashboardsOrder","_dashboardsLayoutData"],storage:localStorage,sanitizeUndefined:!0})).use(()=>({timeFilters:Object.keys(MA)})).use(mu({dashboardsNames:e=>[...e._dashboardsNames].sort((t,s)=>e.dashboardsOrder.findIndex(e=>e===t)-e.dashboardsOrder.findIndex(e=>e===s)),selectedTimeFilter:e=>e._selectedTimeFilter,timeRange:e=>e._timeRange,isEnabledForFreeUser:(e,t)=>RA.includes(t),dashboardsLayoutData:e=>(0,ue.A)((0,ue.A)({},PA),e._dashboardsLayoutData),dashboardsCustomData:e=>(0,ue.A)({},e._dashboardsCustomData),builtInFilterValue:(e,t)=>{var s,a;return null!==(s=null===(a=e.builtinFiltersValues[t])||void 0===a?void 0:a.values)&&void 0!==s?s:[]},builtInFiltersClickHouseQuery:e=>{const t={and:Object.entries(e.builtinFiltersValues).filter(e=>{var t;let[s,a]=e;return null==a||null===(t=a.values)||void 0===t?void 0:t.length}).map(e=>{let[t,s]=e;return{[TA(t)]:{in:null==s?void 0:s.values}}})};return(0,jk.m9)(t)}})).use(pu({setDashboardsNames:(e,t)=>{let{store:s}=e;s._dashboardsNames=t},updateDashboardLayoutData:(e,t,s)=>{let{store:a}=e;const n=a.dashboardsLayoutData()[t];a.setState(e=>{e._dashboardsLayoutData[t]=(0,ue.A)((0,ue.A)({},n),s)})},setDashboardCustomData:(e,t,s)=>{let{store:a}=e;a.setState(e=>{e._dashboardsCustomData[t]=(0,ue.A)((0,ue.A)({},e._dashboardsCustomData[t]),s)})},setTimeFilter:(e,t)=>{var s;let{store:a}=e;a._selectedTimeFilter=t;const n=null===(s=MA[t])||void 0===s?void 0:s.call(MA);n&&(a._timeRange=n)},setTimeRange:(e,t)=>{let{store:s}=e;s._timeRange=t,s._selectedTimeFilter=null},refreshTimeRange:e=>{var t;let{store:s}=e;s._selectedTimeFilter&&(s._timeRange=null===(t=MA[s._selectedTimeFilter])||void 0===t?void 0:t.call(MA))},useBuiltInFilter:(e,t,s)=>{let{store:a}=e;const n=a.useBuiltInFilterValue(t),l=Y.useMemo(()=>{var e;const t=null!==(e=null==s?void 0:s.map(e=>Ck(e).category).filter(Boolean))&&void 0!==e?e:[];return Array.from(new Set(t))},[s]);Y.useEffect(()=>{a.setState(e=>{e.builtinFiltersOptions[t]={values:l}})},[l.join(",")]);return{filteredData:Y.useMemo(()=>null!=n&&n.length?(null!=s?s:[]).filter(e=>null==n?void 0:n.includes(Ck(e).category)):null!=s?s:[],[s,n])}}}));var UA=s(81646),BA=s(93718),zA=s(78045),HA=s(48989);const VA=e=>{let{id:t,isVisible:s,onToggleVisibility:a,draggable:n}=e;const{attributes:l,listeners:r,setNodeRef:i,transform:o,transition:c,isDragging:d}=(0,zA.gl)({id:t}),u={transform:HA.Ks.Transform.toString(o),transition:c};return(0,se.jsxs)("div",{ref:i,style:u,className:de("flex items-center gap-3 py-3 px-1 rounded-lg","hover:bg-slate-50 transition-colors duration-150",d&&"opacity-50 bg-slate-100 shadow-lg z-50"),children:[(0,se.jsx)("button",(0,ue.A)((0,ue.A)((0,ue.A)({className:de("flex items-center justify-center p-1 rounded cursor-grab active:cursor-grabbing","text-slate-400 hover:text-slate-600 transition-colors","focus:outline-none focus-visible:ring-2 focus-visible:ring-slate-400"),disabled:!1===n},l),r),{},{children:(0,se.jsx)(UA.A,{className:"h-5 w-5"})})),(0,se.jsx)(E_,{checked:s,onCheckedChange:e=>a(!0===e),className:de("h-5 w-5 rounded border-2","border-slate-300","data-[state=checked]:bg-slate-900 data-[state=checked]:border-slate-900","data-[state=checked]:text-white","focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2","transition-colors duration-200")}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700 select-none",children:(m=t,null!==(x=null===(h=SA[m])||void 0===h?void 0:h.displayName)&&void 0!==x?x:RC(m))})]});var m,x,h};const WA=s.p+"static/media/social_reddit.81f0b7198b09025ed6cd9e898ded75a6.svg";const qA=s.p+"static/media/social_whatsapp.0de342cbc8c183c6b73e9bb1ade8fbc8.svg";const YA=s.p+"static/media/social_facebook.a60d22bd133d0437b74f763375872146.svg";const GA=s.p+"static/media/social_linkedin.650f581748c57baa20c275e5472fdd99.svg";const KA=s.p+"static/media/social_x.288fa6b3d0a1e81ec8ccd5aebbdd06a1.svg",$A=s.p+"static/media/superbowl_helmet.8bc9e142fa0f4c9f84e1.png",ZA=()=>{const e=uh();return{reportPublishPopoverOpen:()=>{Tu("Publish: Popover Open",(0,ue.A)({},e))},reportPublishButtonClick:t=>{let{origin:s,target_route:a,userId:n,appId:l}=t;Vu(e,{cta:"publish",origin:s,target_route:a}),Tu("User Clicked Publish Button",{user_id:n,app_id:l,origin:s,target_route:a})},reportPublishModalOpen:()=>{Tu("Publish: Modal Open",(0,ue.A)({},e))},reportPublishModalViewAppClick:()=>{Tu("Publish: Modal View App Click",(0,ue.A)({},e))},reportPublishModalCopyLinkClick:()=>{Tu("Publish: Modal Copy Link Click",(0,ue.A)({},e))},reportPublishSocialShare:t=>{Tu("Publish: Social Share",(0,ue.A)((0,ue.A)({},e),{},{platform:t}))},reportSuperbowlBannerView:()=>{Tu("Superbowl Banner View",(0,ue.A)({},e))},reportSuperbowlBannerClickCta:t=>{let{theme:s}=t;Tu("Superbowl Banner Click",(0,ue.A)((0,ue.A)({},e),{},{theme:s}))}}},JA=new RegExp(["superbowl","super bowl","football","nfl","superball","super ball"].join("|"),"i"),QA=()=>{const{hasFlag:e}=ej(),{app:t}=lp();return{getSuperbowlBannerTheme:()=>{var s,a,n;if(!e(rj))return null;let l=null;const r="superbowl-lp"===dm.referrer,i=JA.test(null!==(s=null==t?void 0:t.name)&&void 0!==s?s:"");return r||i||null!==(a=gu.messages)&&void 0!==a&&a.slice(-25).filter(e=>"user"===e.role).some(e=>JA.test(e.content))?l="superbowlApplication":e(lj)&&(l="superbowlUser"),null!==(n=l)&&void 0!==n?n:null}}},XA={superbowlApplication:{title:"Turn Your App Into a Touchdown",description:"Enter now. $50,000 up for grabs.",cta:"Submit Your App",link:"https://base44.com/biggame/form"},superbowlUser:{title:"Want to Win Big? Build a Game Day app",description:"Compete for $50,000 in prizes.",cta:"Learn More",link:"https://base44.com/biggame"}},eS=e=>{let{theme:t,onClose:s}=e;const a=ZA(),{getSuperbowlBannerTheme:n}=QA(),l=null!=t?t:n();if(Y.useEffect(()=>{l&&a.reportSuperbowlBannerView()},[]),!l)return null;const{title:r,description:i,link:o,cta:c}=XA[l];return(0,se.jsxs)("div",{className:"relative flex w-full  rounded-xl p-4 ",style:{background:"radial-gradient(100% 130% at 50% -20%, rgb(253 184 94) 0%, rgb(255 142 29) 35%, rgb(255 167 59) 65%, rgb(246 218 206) 100%)"},children:[s&&(0,se.jsx)("div",{className:"absolute flex justify-center items-center overflow-visible  w-4 h-4 -top-2 -right-2 z-50  border border-gray-200 bg-white p-2 shadow-md cursor-pointer",onClick:s,children:(0,se.jsx)(la.A,{className:"absolute w-4 h-4"})}),(0,se.jsxs)("div",{className:"relative z-10",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:r}),(0,se.jsx)("p",{className:"mt-1 text-sm text-foreground",children:i}),(0,se.jsxs)("button",{onClick:()=>{a.reportSuperbowlBannerClickCta({theme:l}),gd(o)},className:"mt-4 inline-flex items-center gap-2 rounded-lg bg-white px-4 py-2 text-sm font-medium text-gray-900 shadow-sm transition-all hover:bg-gray-50 hover:shadow-md",children:[c,(0,se.jsx)(Rj.A,{className:"h-4 w-4"})]})]}),(0,se.jsx)("div",{className:"absolute -right-[100px] bottom-[50px] top-[-50px] flex items-center pointer-events-none",children:(0,se.jsx)("img",{src:$A,alt:"Football helmet",className:"h-[150%] w-auto object-contain drop-shadow-lg rotate-45"})})]})},tS=eS,sS=e=>{let{text:t,onCopy:s,className:a,iconClassName:n,title:l="Copy to clipboard"}=e;const[r,i]=Y.useState(!1);return(0,se.jsx)("button",{onClick:async e=>{e.stopPropagation(),await navigator.clipboard.writeText(t),i(!0),null==s||s(),setTimeout(()=>i(!1),2e3)},title:l,className:de("flex items-center justify-center transition-colors",a),children:r?(0,se.jsx)(Ds.A,{className:de("text-green-500",n)}):(0,se.jsx)(ob.A,{className:de("text-neutral-500",n)})})},aS=e=>{let{domain:t,onCopy:s,onOpen:a,className:n}=e;const{toast:l}=ao(),r=t.startsWith("http")?t:"https://".concat(t),i=t.replace(/^https?:\/\//,"");return(0,se.jsxs)("div",{className:de("grid grid-cols-5 gap-2 w-full sm:flex sm:items-center",n),children:[(0,se.jsxs)("button",{onClick:()=>{gd(r),null==a||a()},className:de("group col-span-4 sm:flex-1 min-w-0 flex items-center h-8 pl-3 pr-2 rounded-lg border text-left overflow-hidden","bg-[#f5f5f5] border-[#e5e5e5]","shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]","hover:bg-[#efefef] transition-colors"),children:[(0,se.jsx)("span",{className:"flex-1 min-w-0 text-sm leading-5 text-foreground truncate",children:i}),(0,se.jsx)(au.A,{className:"w-3.5 h-3.5 text-neutral-500 sm:hidden"}),(0,se.jsxs)("span",{className:"hidden sm:flex items-center gap-1.5 text-neutral-500 text-sm whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:["Open in new tab",(0,se.jsx)(au.A,{className:"w-3.5 h-3.5"})]})]}),(0,se.jsx)(sS,{text:r,onCopy:()=>{l({title:"Link copied to clipboard",description:"You can now paste it anywhere"}),null==s||s()},title:"Copy link",className:de("col-span-1 h-8 rounded-lg","sm:w-8 sm:shrink-0","border border-[#e5e5e5] bg-white","shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]","hover:bg-neutral-50"),iconClassName:"w-4 h-4"})]})},nS=()=>{const{app:e}=lp(),{domains:t}=vy.usePublishUrl(),[s,a]=Y.useState(!1),n=ZA(),l=Y.useMemo(()=>{const s=[];let a=null;if(null!=e&&e.slug){a=Tc(e).replace(/^https?:\/\//,"")}if(0===t.length)a&&s.push(a);else{for(const e of t)s.includes(e)||s.push(e);a&&!s.includes(a)&&s.push(a)}return s},[t,null==e?void 0:e.slug]),r=l.length,i=r>=3,o=!i||s?l:l.slice(0,1),c=s&&r>5;return(0,se.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,se.jsx)("span",{className:"text-sm font-medium leading-none text-foreground",children:"Your app links"}),(0,se.jsx)("div",{className:de("flex flex-col gap-2",c&&"overflow-y-auto"),style:c?{maxHeight:192}:void 0,children:o.map(e=>(0,se.jsx)(aS,{domain:e,onCopy:()=>n.reportPublishModalCopyLinkClick(),onOpen:()=>n.reportPublishModalViewAppClick()},e))}),i&&(0,se.jsx)("button",{onClick:()=>a(!s),className:"flex items-center gap-1.5 text-neutral-600 hover:text-neutral-800 text-sm leading-6 font-normal transition-colors w-fit",children:s?(0,se.jsxs)(se.Fragment,{children:["Hide",(0,se.jsx)(ur.A,{className:"w-4 h-4"})]}):(0,se.jsxs)(se.Fragment,{children:["View all links",(0,se.jsx)(_t.A,{className:"w-4 h-4"})]})})]})},lS=()=>{const{shareToSocial:e}=vy.useSocialShare(),t=ZA();return(0,se.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,se.jsx)("span",{className:"text-sm font-medium leading-none text-foreground",children:"Sharing options"}),(0,se.jsx)("div",{className:"grid grid-cols-5 gap-2.5 sm:flex sm:items-center",children:rS.map(s=>(0,se.jsx)("button",{onClick:()=>{return a=s.platform,e(a),void t.reportPublishSocialShare(a);var a},title:s.label,className:de("flex items-center justify-center h-8 rounded-lg","sm:w-8","border border-[#e5e5e5] bg-white","shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]","hover:bg-neutral-50 transition-colors"),children:(0,se.jsx)("img",{src:s.svg,alt:s.label,className:"w-4 h-4"})},s.platform))})]})},rS=[{svg:YA,label:"Share on Facebook",platform:"facebook"},{svg:GA,label:"Share on LinkedIn",platform:"linkedin"},{svg:KA,label:"Share on X (Twitter)",platform:"twitter"},{svg:qA,label:"Share on WhatsApp",platform:"whatsapp"},{svg:WA,label:"Share on Reddit",platform:"reddit"}],iS=((e,t)=>{const s=Object.keys(e).reduce((e,s)=>{var a;return e[s]=(0,ue.A)({open:!1},null==t||null===(a=t.defaultProps)||void 0===a?void 0:a[s]),e},{}),a=hu({modals:s}),n=(e,t)=>{const s=a.getState().modals[e],n="function"==typeof t?t(s):t;a.setState(t=>{t.modals[e]=(0,ue.A)((0,ue.A)((0,ue.A)({},s),n),{},{open:!0})})},l=e=>{a.setState(s=>{var a;s.modals[e]=(0,ue.A)({open:!1},null==t||null===(a=t.defaultProps)||void 0===a?void 0:a[e])})},r=e=>{let{name:t,children:s,Openable:r}=e,i=(0,Nt.A)(e,jy);const o=a.useStore(e=>e.modals[t]),{open:c}=o,d=(0,Nt.A)(o,yy),u=()=>{var e,s,a,n,r,o;null==d||null===(e=d.onOpenChange)||void 0===e||e.call(d,!1),null==i||null===(s=i.onOpenChange)||void 0===s||s.call(i,!1),null==d||null===(a=d.onClose)||void 0===a||a.call(d),null==i||null===(n=i.onClose)||void 0===n||n.call(i),null==d||null===(r=d.onCancel)||void 0===r||r.call(d),null==i||null===(o=i.onCancel)||void 0===o||o.call(i),l(t)};return(0,se.jsx)(se.Fragment,{children:s((0,ue.A)((0,ue.A)((0,ue.A)({},i),d),{},{open:c,isVisible:c,isOpen:c,onOpenChange:e=>{var s,a;e?(null==d||null===(s=d.onOpenChange)||void 0===s||s.call(d,e),null==i||null===(a=i.onOpenChange)||void 0===a||a.call(i,e),n(t)):u()},onClose:()=>{u()},onCancel:()=>{u()}}))})};return{Render:Object.entries(e).reduce((e,t)=>{let[s,a]=t;return e[s]=e=>(0,se.jsx)(r,(0,ue.A)((0,ue.A)({},e),{},{name:s,children:a})),e},{}),RenderAllModals:t=>(0,se.jsx)(se.Fragment,{children:Object.entries(e).map(e=>{let[s,a]=e;return(0,se.jsx)(r,(0,ue.A)((0,ue.A)({},null==t?void 0:t[s]),{},{name:s,children:a}),s)})}),useIsOpen:e=>a.useStore(t=>t.modals[e].open),openModal:n,closeModal:l,closeAllModals:()=>{a.reset()}}})({InviteUser:by,ExportToGithub:function(e){let{isOpen:t,onClose:s}=e;const{user:a}=wd(),{app:n}=lp(),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)("update"),[u,m]=(0,Y.useState)([]),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(""),b=(0,Y.useRef)(null),j=(0,Y.useRef)(null),y=(0,Y.useRef)(null),[N,w]=(0,Y.useState)(null),[_,k]=(0,Y.useState)((null==n?void 0:n.github_repo_url)||null),[C,A]=(0,Y.useState)(""),[S,E]=(0,Y.useState)(0),[T,I]=(0,Y.useState)(!1),P=Hj(a);(0,Y.useEffect)(()=>{"invite"===c&&y.current&&y.current.focus()},[c]),(0,Y.useEffect)(()=>{if(i.includes("@")||i.includes("."))return v("GitHub usernames cannot contain @ or . characters"),m([]),void g(!1);if(v(""),i.trim().length>=2){b.current&&clearTimeout(b.current);const e=Date.now()-S,t=1e3;if(i.trim()===C)return void g(u.length>0);h(!0);const s=e<t?t-e+500:500;b.current=setTimeout(()=>{L(i),A(i.trim()),E(Date.now())},s)}else m([]),g(!1);return()=>{b.current&&clearTimeout(b.current)}},[i,null==n?void 0:n.id,C,S,u.length]);const L=async e=>{try{h(!0);const t=await lu.searchGithubUsers(n.id,e);m(t.users||[]),g(t.users&&t.users.length>0)}catch(t){}finally{h(!1)}};return(0,se.jsx)(ma,{open:t,onOpenChange:s,children:(0,se.jsxs)(fa,{className:"sm:max-w-[500px]",children:[(0,se.jsxs)(va,{children:[(0,se.jsxs)(ja,{className:"flex items-center gap-2",children:[(0,se.jsx)(dh.A,{className:"h-5 w-5"}),"GitHub Integration"]}),(0,se.jsx)(ya,{children:null!=n&&n.github_repo_url?"Manage your GitHub repository and collaborators":"Export your app to GitHub to collaborate with others"})]}),(()=>{if(!N)return null;const e="success"===N.type?"bg-green-50 border-green-200":"error"===N.type?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200",t="success"===N.type?"text-green-700":"error"===N.type?"text-red-700":"text-blue-700",s="success"===N.type?sd.A:"error"===N.type?ad.A:null;return(0,se.jsxs)("div",{className:"flex items-center gap-2 p-3 my-3 rounded-md border ".concat(e),children:[s&&(0,se.jsx)(s,{className:"h-5 w-5 ".concat(t)}),(0,se.jsx)("p",{className:"text-sm ".concat(t),children:N.text})]})})(),P?_?(0,se.jsxs)("div",{className:"space-y-4 py-2",children:[(0,se.jsxs)("div",{className:"rounded-lg bg-muted p-3 mb-4",children:[(0,se.jsx)("p",{className:"text-sm font-medium mb-1",children:"Repository URL:"}),(0,se.jsx)("a",{href:_,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 hover:underline break-all",children:_})]}),T&&(0,se.jsxs)("div",{className:"rounded-lg bg-blue-50 border border-blue-200 p-4 mb-4",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-blue-800 mb-1",children:"Important Next Step"}),(0,se.jsx)("p",{className:"text-sm text-blue-700",children:"To access this repository directly from your GitHub account, you need to invite yourself as a collaborator."}),(0,se.jsxs)(zt,{variant:"outline",className:"mt-3 border-blue-300 hover:bg-blue-100 text-blue-800",onClick:()=>{o(a.github_username||""),d("invite")},children:[(0,se.jsx)(ay.A,{className:"h-4 w-4 mr-2"}),"Invite Yourself as Collaborator",(0,se.jsx)(Ws.A,{className:"h-4 w-4 ml-2"})]})]}),(0,se.jsxs)(ji,{defaultValue:"update",value:c,onValueChange:d,children:[(0,se.jsxs)(yi,{className:"grid w-full grid-cols-2",children:[(0,se.jsx)(Ni,{value:"update",children:"Update Repository"}),(0,se.jsx)(Ni,{value:"invite",children:"Invite Collaborator"})]}),(0,se.jsxs)(wi,{value:"update",className:"space-y-4 pt-4",children:[(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Push the latest changes from your app to the GitHub repository."}),(0,se.jsx)(zt,{onClick:async()=>{try{r(!0),w({type:"loading",text:"Updating GitHub repository..."});const e=await lu.updateGithubRepo(n.id);e&&e.repository_url&&k(e.repository_url),w({type:"success",text:"Successfully updated GitHub repository"})}catch(i){var e,t,s,a,l;if(null!==(e=i.response)&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&null!==(s=t.message)&&void 0!==s&&s.includes("nothing to commit, working tree clean"))w({type:"success",text:"Repository is already up to date. No changes to commit."});else w({type:"error",text:"Failed to update GitHub repository: "+((null===(a=i.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||i.message||"Unknown error")})}finally{r(!1)}},className:"w-full",disabled:l,children:l?"Updating...":"Update Repository"})]}),(0,se.jsxs)(wi,{value:"invite",className:"space-y-4 pt-4",children:[(0,se.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Invite a collaborator to work on your GitHub repository.",!T&&(0,se.jsx)("span",{className:"block mt-1 font-medium text-blue-600",children:"Don't forget to invite yourself to access the repository directly from your GitHub account."})]}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsxs)("div",{className:"flex space-x-2",children:[(0,se.jsxs)("div",{className:"relative flex-1",children:[(0,se.jsx)(nl,{ref:y,placeholder:"Enter GitHub username",value:i,onChange:e=>o(e.target.value),disabled:l,onFocus:()=>i.trim().length>=2&&!f&&g(!0)}),x&&(0,se.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,se.jsx)(na.A,{className:"h-4 w-4 animate-pulse text-muted-foreground"})})]}),(0,se.jsx)(zt,{onClick:async()=>{if(i.trim())try{r(!0),w({type:"loading",text:"Inviting ".concat(i,"...")}),await lu.inviteCollaborator(n.id,i),w({type:"success",text:"Successfully invited ".concat(i," as a collaborator")}),o(""),I(!1)}catch(s){var e,t;w({type:"error",text:"Failed to invite collaborator: "+((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||s.message||"Unknown error")})}finally{r(!1)}else w({type:"error",text:"Please enter a GitHub username"})},disabled:l||!i.trim()||f,children:l?"Inviting...":"Invite"})]}),f&&(0,se.jsx)("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded-md border border-red-200",children:f}),p&&!f&&(0,se.jsx)("div",{ref:j,className:"absolute z-10 mt-1 w-full max-h-48 overflow-auto bg-background border rounded-md shadow-lg",children:0===u.length?(0,se.jsx)("div",{className:"p-2 text-sm text-muted-foreground",children:"No users found"}):(0,se.jsx)("ul",{children:u.map(e=>(0,se.jsxs)("li",{className:"flex items-center gap-2 p-2 hover:bg-accent cursor-pointer",onClick:()=>{return t=e.username,o(t),void g(!1);var t},children:[(0,se.jsx)("img",{src:e.avatar_url,alt:e.username,className:"w-8 h-8 rounded-full"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium",children:e.username}),e.name&&(0,se.jsx)("div",{className:"text-xs text-muted-foreground",children:e.name})]})]},e.username))})})]})]})]})]}):(0,se.jsxs)("div",{className:"space-y-4 py-4",children:[(0,se.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Export your app to GitHub to enable version control, collaboration, and easier deployment."}),(0,se.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:[(0,se.jsx)("strong",{children:"Important:"})," After exporting, you'll need to invite yourself as a collaborator to access the repository directly."]})]}),(0,se.jsx)(zt,{onClick:async()=>{try{r(!0),w({type:"loading",text:"Exporting to GitHub..."});const e=await lu.exportToGithub(n.id);k(e.repository_url),w({type:"success",text:"Successfully exported to GitHub"}),I(!0),d("invite")}catch(s){var e,t;w({type:"error",text:"Failed to export to GitHub: "+((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||s.message||"Unknown error")})}finally{r(!1)}},className:"w-full",disabled:l,children:l?"Exporting...":"Export to GitHub"})]}):(0,se.jsx)("div",{className:"space-y-4 py-4",children:(0,se.jsxs)("div",{className:"rounded-lg bg-amber-50 border border-amber-200 p-4",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-amber-800 mb-1",children:"Upgrade Required"}),(0,se.jsx)("p",{className:"text-sm text-amber-700",children:"GitHub integration is only available on Builder, Pro, Elite and Enterprise plans."}),(0,se.jsx)(Z.Link,{to:"/billing",children:(0,se.jsx)(zt,{variant:"outline",className:"mt-3 border-amber-300 hover:bg-amber-100 text-amber-800",children:"Upgrade Your Plan"})})]})}),(0,se.jsx)(ba,{children:(0,se.jsx)(zt,{variant:"outline",onClick:s,children:"Close"})})]})})},ExportToZipModal:function(e){let{isOpen:t,onClose:s}=e;const{user:a}=wd(),{app:n}=lp(),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),c=Hj(a);return(0,se.jsx)(ma,{open:t,onOpenChange:s,children:(0,se.jsxs)(fa,{className:"sm:max-w-[500px]",children:[(0,se.jsxs)(va,{children:[(0,se.jsxs)(ja,{className:"flex items-center gap-2",children:[(0,se.jsx)(xN.A,{className:"h-5 w-5"}),"Export to ZIP"]}),(0,se.jsx)(ya,{children:"Download your app code as a ZIP file"})]}),(()=>{if(!i)return null;const e="success"===i.type?"bg-green-50 border-green-200":"error"===i.type?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200",t="success"===i.type?"text-green-700":"error"===i.type?"text-red-700":"text-blue-700",s="success"===i.type?sd.A:"error"===i.type?ad.A:null;return(0,se.jsxs)("div",{className:"flex items-center gap-2 p-3 my-3 rounded-md border ".concat(e),children:[s&&(0,se.jsx)(s,{className:"h-5 w-5 ".concat(t)}),(0,se.jsx)("p",{className:"text-sm ".concat(t),children:i.text})]})})(),c?(0,se.jsxs)("div",{className:"space-y-4 py-4",children:[(0,se.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Export your app to a ZIP file to download the code for local development or deployment."}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"This will include all your app's code and the necessary project structure to run it locally."})]}),null!=a&&a.api_key?(0,se.jsx)("a",{href:(()=>{if(null==n||!n.id||null==a||!a.api_key)return null;const e="/apps/".concat(n.id,"/coding/export-to-zip?api_key=").concat(a.api_key);return"".concat((0,fe.Gt)()).concat(e)})(),download:"".concat((null==n?void 0:n.slug)||"app",".zip"),className:"w-full inline-block",onClick:()=>(o({type:"success",text:"Download started. If it doesn't begin automatically, click the download button again."}),void r(!1)),children:(0,se.jsx)(zt,{className:"w-full",disabled:l,onClick:()=>{r(!0),o({type:"loading",text:"Initiating download..."}),setTimeout(()=>{r(!1),o({type:"success",text:"Download initiated. Check your downloads folder."})},1e3)},children:l?"Preparing Download...":"Download ZIP"})}):(0,se.jsx)(zt,{className:"w-full",disabled:!0,children:"Unable to generate download link"})]}):(0,se.jsx)("div",{className:"space-y-4 py-4",children:(0,se.jsxs)("div",{className:"rounded-lg bg-amber-50 border border-amber-200 p-4",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-amber-800 mb-1",children:"Upgrade Required"}),(0,se.jsx)("p",{className:"text-sm text-amber-700",children:"ZIP file export is only available on Builder, Pro, Elite and Enterprise plans."}),(0,se.jsx)(Z.Link,{to:"/billing",children:(0,se.jsx)(zt,{variant:"outline",className:"mt-3 border-amber-300 hover:bg-amber-100 text-amber-800",children:"Upgrade Your Plan"})})]})}),(0,se.jsx)(ba,{children:(0,se.jsx)(zt,{variant:"outline",onClick:s,children:"Close"})})]})})},NetworkSidePanel:e=>{let{open:t,onOpenChange:s}=e;return(0,se.jsx)(Sy,{open:t,onOpenChange:s,children:(0,se.jsx)(Ly,{side:"right",className:"min-w-[600px]",children:(0,se.jsx)(Vy,{onClose:()=>null==s?void 0:s(!1)})})})},CodeEditorSidePanel:e=>{let{open:t,onOpenChange:s,selectedFileEditorPath:a}=e;return(0,se.jsx)(Sy,{open:t,onOpenChange:s,children:(0,se.jsxs)(Ly,{side:"right",className:"min-w-[70%]",children:[(0,se.jsx)(My,{children:(0,se.jsxs)(Ry,{children:["Code Editor - ",a]})}),(0,se.jsx)("div",{className:"block h-full w-full mt-4",children:(0,se.jsx)(Xy,{selectedLine:null,onEdit:null,isFunction:!1,onRedeployFunction:null,functionHelperRef:null,cachedAppFiles:null,isLoadingAppFiles:!1,shouldFetchFilesFromSandbox:!1,onUpdateCachedFile:null,filepath:a,onSaveOrDiscard:()=>{dS.closeModal("CodeEditorSidePanel"),setTimeout(()=>{dS.openModal("CodeEditorSidePanel",{selectedFileEditorPath:a})},150)}})})]})})},AppLogoModal:e=>{let{onClose:t,isOpen:s}=e;return(0,se.jsx)(Og,{open:s,onOpenChange:e=>!e&&t(),children:(0,se.jsxs)(Hg,{className:"w-full gap-4 font-base44",children:[(0,se.jsx)(va,{className:"space-y-0",children:(0,se.jsx)(qg,{children:"Edit App Logo"})}),(0,se.jsx)(lN,{onSubmit:t})]})})},PublishVersionModal:e=>{let{open:t,onOpenChange:s,checkpoint:a}=e;const{publishApp:n}=vy.usePublishApp(),l=vy.useIsPublishing();return(0,se.jsx)(NN,{open:t,onOpenChange:s,children:(0,se.jsxs)(wN,{children:[(0,se.jsx)(_N,{className:"bg-black/20"}),(0,se.jsxs)(ot.Content,{className:de("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg sm:max-w-[425px]"),children:[(0,se.jsxs)(CN,{children:[(0,se.jsx)(SN,{children:"Publish this version?"}),(0,se.jsx)(EN,{children:"It will become the live version for all users."})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{disabled:l,children:"Cancel"}),(0,se.jsx)(TN,{onClick:async()=>{null!=a&&n({checkpointId:a.id}),s(!1)},disabled:l,className:"bg-gray-900 hover:bg-gray-800",children:l?"Publishing...":"Publish"})]})]})]})})},RestoreVersionModal:e=>{let{open:t,onOpenChange:s,checkpoint:a}=e;const{restoreCheckpoint:n,isLoading:l}=Tx();return(0,se.jsx)(NN,{open:t,onOpenChange:s,children:(0,se.jsxs)(wN,{children:[(0,se.jsx)(_N,{className:"bg-black/20"}),(0,se.jsxs)(ot.Content,{className:de("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg sm:max-w-[425px]"),children:[(0,se.jsxs)(CN,{children:[(0,se.jsx)(SN,{children:"Revert to this version?"}),(0,se.jsx)(EN,{children:"Are you sure you want to revert to this checkpoint? This will create a new version from this checkpoint."})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{disabled:l,children:"Cancel"}),(0,se.jsx)(TN,{onClick:()=>{null!=a&&n(a),s(!1)},disabled:l,className:"bg-gray-900 hover:bg-gray-800",children:l?"Reverting...":"Revert"})]})]})]})})},VersionRevertDialog:e=>{let{open:t,onOpenChange:s,checkpoint:a}=e;return(0,se.jsx)(NN,{open:t&&null!=a,onOpenChange:s,children:(0,se.jsxs)(kN,{children:[(0,se.jsxs)(CN,{children:[(0,se.jsx)(SN,{children:"Are you sure?"}),(0,se.jsxs)(EN,{children:['This action is irreversible. Your app will be reverted to "',null==a?void 0:a.name,'".']})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{children:"Cancel"}),(0,se.jsx)(TN,{onClick:()=>{alert("Reverted to: ".concat(null==a?void 0:a.name)),s(!1)},children:"Revert"})]})]})})},CustomSenderDetailsModal:HN,ConnectDomainModal:VN,DnsInstructionsModal:rw,MigrateToNewInfraModal:e=>{let{open:t,onOpenChange:s,closeAfterSec:a=0,migrateBtnId:n="migrate-to-new-infra-btn"}=e;const{app:l}=lp(),[r,i]=(0,Y.useState)(!a),{handleMigrate:o}=dN(),c=qu();return(0,Y.useEffect)(()=>{if(t&&a>0){i(!1);const e=setTimeout(()=>{i(!0)},1e3*a);return()=>{clearTimeout(e)}}i(!0)},[t,a]),(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsx)(Hg,{showClose:r,className:"p-0 gap-0 font-base44  border-none max-w-none w-auto overflow-clip",children:(0,se.jsxs)("div",{className:"flex md:w-[650px] md:flex-row flex-col-reverse  ",children:[(0,se.jsxs)("div",{className:"flex flex-col p-6 pt-10 w-[350px] gap-4",children:[(0,se.jsxs)("div",{className:"text-[28px] font-semibold text-slate-900 leading-tight tracking-tight",children:["Update Your App to the",(0,se.jsx)("br",{}),"New Infrastructure"]}),(0,se.jsxs)("p",{className:"text-sm font-normal",children:["We've upgraded Base44's backend to support",(0,se.jsx)("br",{}),"the latest improvements and new capabilities",(0,se.jsx)("br",{}),"across the platform.",(0,se.jsx)("br",{}),(0,se.jsx)("br",{}),"Update once and enjoy faster performance,",(0,se.jsx)("br",{}),"greater reliability, and ",(0,se.jsx)("strong",{children:"15 free credits"})," to get started."]}),(0,se.jsx)("div",{}),(0,se.jsx)(Bx,{onClick:()=>{o({}),rN(l.id),null==s||s(!1)},size:"tiny",className:"w-[170px]",children:"Update Infrastructure"}),(0,se.jsxs)("div",{className:"flex flex-col flex-1 justify-end gap-3",children:[(0,se.jsx)("div",{className:"h-[1px] bg-slate-200 w-full"}),(0,se.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Your app can remain on the old infrastructure until Feb 1st. After that, editing will be paused until the migration is completed.",(0,se.jsx)("br",{}),"For more info, ",(0,se.jsx)("a",{className:"text-blue-500",href:Ky,target:"_blank",children:"visit our Docs"})]})]})]}),(0,se.jsx)("img",{src:c?mN:uN,alt:"Migrate to new infrastructure",className:" md:w-[300px] w-full h-full object-cover"})]})})})},RevertToOldInfraModal:e=>{var t;let{open:s,onOpenChange:a}=e;const{handleRevert:n}=dN(),{app:l}=lp();return(0,se.jsx)(Og,{open:s,onOpenChange:a,children:(0,se.jsxs)(Hg,{className:"p-0 font-base44 gap-0",children:[(0,se.jsxs)("div",{className:"flex flex-col p-6 gap-[18px] font-base44",children:[(0,se.jsx)("p",{className:"text-lg font-bold",children:"Are you sure you want to switch back?"}),(0,se.jsxs)("p",{className:"text-sm text-gray-700",children:["If you move your app back to the old infrastructure, you won't get the latest performance, stability, and feature improvements.",(0,se.jsx)("br",{}),"After ",(0,se.jsx)("strong",{children:"February 1, 2026"}),", you'll only be able to edit your app if it's on the new infrastructure.",(0,se.jsx)("br",{}),(0,se.jsx)("br",{}),"To make things smoother, we've added ",(0,se.jsx)("strong",{children:"15 free credits"})," so you can explore, test, and resolve any issues while updating.",(0,se.jsx)("br",{})]}),(0,se.jsxs)("div",{className:"flex flex-row justify-end gap-2 mt-2",children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>{null==a||a(!1),n({}),oN(l.id)},children:"Switch Back"}),(0,se.jsx)(Bx,{size:"sm",onClick:()=>{null==a||a(!1)},children:"Stay on new infrastructure"})]})]}),(0,se.jsx)("div",{className:"px-6 py-3 self-start align-start bg-muted rounded-b-lg",children:(0,se.jsxs)("div",{className:"flex items-start  text-xs text-muted-foreground flex-row gap-2",children:[(0,se.jsxs)("p",{children:["For more info, ",(0,se.jsx)("a",{className:"text-blue-500",href:Ky,target:"_blank",children:"visit our Docs"})]}),(0,se.jsx)("div",{className:"h-4 w-px bg-gray-400"}),(0,se.jsx)("a",{href:"/support?appId=".concat(null!==(t=null==l?void 0:l.id)&&void 0!==t?t:""),className:"text-blue-500",target:"_blank",children:"Contact Support"})]})})]})})},UpgradeModal:e=>{let{open:t,onOpenChange:s,origin:a}=e;return(0,se.jsx)(ma,{open:t,onOpenChange:s,children:(0,se.jsxs)(gt.Portal,{children:[(0,se.jsx)(Ig,{className:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,se.jsx)(gt.Content,{className:de("fixed left-[50%] top-[50%] z-50 w-full translate-x-[-50%] translate-y-[-50%] shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-[16px]","max-w-[90vw] h-[90vh] overflow-hidden"),style:{background:"linear-gradient(148deg, rgba(242, 225, 208, 0.3) 3.86%, rgba(227, 232, 241, 0.3) 100%), rgb(248, 250, 252)"},children:(0,se.jsxs)("div",{className:"h-full flex flex-col",children:[(0,se.jsx)("div",{className:"flex-shrink-0 flex items-center justify-end px-6 pt-4",children:(0,se.jsxs)("button",{onClick:()=>null==s?void 0:s(!1),className:"h-8 w-8 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 flex items-center justify-center",children:[(0,se.jsx)(la.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Close"})]})}),(0,se.jsx)("div",{className:"flex-1 overflow-auto",children:(0,se.jsx)(l_,{origin:a})})]})})]})})},GitHubConnectConfirmDialog:Qb,CreateRepositoryModal:A_,TransferOwnershipModal:e=>{let{isVisible:t,open:s,onCancel:a,onClose:n,onTransferSuccess:l,preSelectedEmail:r}=e;const i=t||s,o=a||n||(()=>{}),{app:c,getEntitiesSDK:d,onAppError:u}=lp(),{toast:m}=ao(),[x,h]=(0,Y.useState)(r?2:1),[p,g]=(0,Y.useState)(r||""),[f,v]=(0,Y.useState)(!1),[b,j]=(0,Y.useState)(!0),[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)([]),[k,C]=(0,Y.useState)(!1),A=(0,Y.useCallback)(async()=>{try{const e=d(u),t=(await e.User.filter({role:"admin"},null,100,0)).filter(e=>{var t,s;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())!==(null===(s=c.owner_email)||void 0===s?void 0:s.toLowerCase())});_(t)}catch(e){m({title:"Error",description:e.message||"Failed to load admins",variant:"destructive"})}},[d,u,c.owner_email,m]);(0,Y.useEffect)(()=>{i&&(h(r?2:1),g(r||""),v(!1),j(!0),A(),C(!0))},[i,r,A]);return(0,se.jsx)(Og,{open:i,onOpenChange:e=>!e&&o(),children:(0,se.jsx)(Hg,{className:"sm:max-w-[480px] p-6 gap-4",children:3===x?(0,se.jsxs)("div",{className:"flex flex-col items-center text-center py-4",children:[(0,se.jsx)("div",{className:"w-14 h-14 bg-emerald-500 rounded-full flex items-center justify-center mb-5",children:(0,se.jsx)(Ds.A,{className:"w-8 h-8 text-white",strokeWidth:3})}),(0,se.jsx)(R_,{size:"large",className:"mb-1",children:"Ownership invite sent"}),(0,se.jsxs)(__,{size:"small",secondary:!0,className:"mb-4",children:["The invite was sent to ",p]}),(0,se.jsxs)(__,{size:"small",secondary:!0,className:"mb-6",children:["The new owner needs to accept the transfer via the invite email.",(0,se.jsx)("br",{}),"The invite expires in 7 days.",(0,se.jsx)("br",{}),"You'll get an email when the transfer is complete."]}),(0,se.jsx)(Bx,{onClick:()=>{o()},className:"h-9 px-6 bg-neutral-900 hover:bg-neutral-800",children:"Got it"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Vg,{className:"space-y-1.5 text-left",children:[(0,se.jsx)(qg,{className:"text-lg font-semibold text-neutral-900 text-left",children:3===x?null:1===x?"Change app owner":"Transfer app to a new owner"}),(0,se.jsx)(Yg,{className:"text-sm text-neutral-500 text-left",children:3===x?null:"Give ownership of this app to another person."})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[1===x&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[c.logo_url?(0,se.jsx)("img",{src:c.logo_url,alt:c.name,className:"w-10 h-10 rounded-lg object-cover border border-black/10"}):(0,se.jsx)("div",{className:"w-10 h-10 rounded-lg border border-black/10 bg-neutral-100"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(__,{size:"small",weight:"normal",children:"Transfer app:"}),(0,se.jsx)(__,{size:"small",children:c.name})]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)(aN,{className:"text-sm font-medium text-neutral-900",children:"Who will be the new app owner?"}),(0,se.jsxs)(Wf,{value:p,onValueChange:g,children:[(0,se.jsx)(Yf,{className:"w-full h-10",children:p?(0,se.jsx)(__,{size:"small",children:p}):(0,se.jsx)(qf,{placeholder:"Select admin"})}),(0,se.jsx)($f,{side:"bottom",avoidCollisions:!1,className:"max-h-[200px]",hideScrollButtons:0===w.length,children:0===w.length?(0,se.jsx)(__,{size:"small",secondary:!0,className:"px-3 py-2",children:"No admins available. Add an admin first."}):w.map(e=>(0,se.jsx)(Zf,{value:e.email,textValue:e.email,children:(0,se.jsxs)("div",{className:"flex flex-col gap-0.5 items-start",children:[(0,se.jsx)(__,{size:"small",className:"font-medium",children:e.full_name||e.email}),e.full_name&&(0,se.jsx)(__,{size:"tiny",secondary:!0,children:e.email})]})},e.email))})]})]})]}),2===x&&(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[c.logo_url?(0,se.jsx)("img",{src:c.logo_url,alt:c.name,className:"w-10 h-10 rounded-lg object-cover border border-black/10"}):(0,se.jsx)("div",{className:"w-10 h-10 rounded-lg border border-black/10 bg-neutral-100"}),(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(__,{size:"small",weight:"normal",children:"Transfer app:"}),(0,se.jsx)(__,{size:"small",children:c.name})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(__,{size:"small",weight:"normal",children:"New owner:"}),(0,se.jsx)(__,{size:"small",children:p})]})]})]}),(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(E_,{id:"confirm",checked:f,onCheckedChange:e=>v(!0===e),className:"mt-0.5"}),(0,se.jsxs)(aN,{htmlFor:"confirm",className:"text-sm text-neutral-700 cursor-pointer leading-relaxed text-left",children:["I understand that by transferring this app, ",p," becomes the new owner, including all app data, media, connected third-party services and accounts."]})]}),k&&(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(E_,{id:"disconnect",checked:b,onCheckedChange:e=>j(!0===e),className:"mt-0.5"}),(0,se.jsxs)("div",{className:"flex flex-col text-left",children:[(0,se.jsx)(aN,{htmlFor:"disconnect",className:"text-sm text-neutral-700 cursor-pointer",children:"Disconnect integrations after transfer"}),(0,se.jsx)(__,{size:"tiny",secondary:!0,children:"Recommended for security. The new owner can reconnect their own accounts."})]})]})]})]}),(0,se.jsx)(Wg,{className:"pt-3 gap-2 ".concat(2===x?"flex-row":""),children:1===x?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Bx,{variant:"outline",onClick:o,className:"h-9",children:"Cancel"}),(0,se.jsx)(Bx,{onClick:()=>{p&&h(2)},disabled:!p,className:"h-9 bg-neutral-900 hover:bg-neutral-800 disabled:opacity-50",children:"Continue"})]}):(0,se.jsxs)(se.Fragment,{children:[!r&&(0,se.jsxs)(Bx,{variant:"ghost",onClick:()=>{r||(h(1),v(!1))},className:"h-9 mr-auto",children:[(0,se.jsx)(vs.A,{className:"w-4 h-4 mr-1"}),"Back"]}),(0,se.jsx)(Bx,{variant:"outline",onClick:o,className:"h-9 hidden sm:inline-flex",children:"Cancel"}),(0,se.jsx)(Bx,{onClick:async()=>{if(f&&p){N(!0);try{await F_.initiateTransfer(c.id,{new_owner_email:p,disconnect_integrations:b}),h(3),null==l||l()}catch(s){var e,t;const a=(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||s.message||"Failed to initiate transfer";m({title:"Error",description:a,variant:"destructive"})}finally{N(!1)}}},disabled:!f||y,className:"h-9 bg-neutral-900 hover:bg-neutral-800 disabled:opacity-50",children:y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Sending invite..."]}):"Change Ownership"})]})})]})})})},EntitySchemaDrawer:e=>{let{isOpen:t,onClose:s,entity:a}=e;return(0,se.jsx)(Sy,{open:t&&null!=a,onOpenChange:e=>!e&&(null==s?void 0:s()),children:(0,se.jsxs)(Ly,{className:"w-[600px] overflow-y-auto",children:[(0,se.jsx)(My,{children:(0,se.jsx)(Ry,{children:"Schema Editor"})}),(0,se.jsx)("div",{className:"py-4",children:a&&(0,se.jsx)(xk,{entity:a})})]})})},EditEntityDrawer:e=>{let{isOpen:t,onClose:s,editingItem:a,entitySchema:n,onSubmit:l,hiddenProperties:r}=e;const{app:i,dataEnv:o}=lp(),c=null==i?void 0:i.dev_environment_enabled;return n?(0,se.jsx)(Sy,{open:t,onOpenChange:e=>!e&&(null==s?void 0:s()),children:(0,se.jsxs)(Ly,{className:"w-[400px] overflow-y-auto",children:[(0,se.jsxs)(My,{children:[(0,se.jsx)(Ry,{children:a?"Edit ".concat(null==n?void 0:n.name):"Add New ".concat(null==n?void 0:n.name)}),c&&("dev"===o?(0,se.jsx)(gk,{className:"bg-green-500 text-white hover:bg-green-500 h-5 w-fit px-1.5 rounded text-xs",children:"Test"}):(0,se.jsx)(gk,{className:"bg-gray-200 text-gray-600 hover:bg-gray-200 h-5 w-fit px-1.5 rounded text-xs",children:"Production"}))]}),(0,se.jsx)("div",{className:"py-4",children:(0,se.jsx)(sk,{schema:n,onSubmit:l,initialValues:a||{},onChange:()=>{},uiSchema:null==r?void 0:r.reduce((e,t)=>(0,ue.A)((0,ue.A)({},e),{},{[t]:{"ui:widget":"hidden"}}),{})})})]})}):null},ConfirmDialog:fk,AddEventDrawer:e=>{let{open:t,onOpenChange:s}=e;const{app:a}=lp(),n=qu(),{data:{suggestions:l,prefix:r},isLoading:i,refetch:o}=Xd({initialData:{suggestions:[],prefix:""},enabled:!(null==a||!a.id||!t),logErrorMsg:"Failed to fetch analytics event suggestions",query:async()=>{const e=await kk.getSuggestions(a.id);return{suggestions:e.suggestions,prefix:e.prefix}}},[null==a?void 0:a.id]),c=e=>{Tu("Analytics - Prompt Suggestion Selected",{origin:"add_event_drawer_suggestion_click",prefix:r,app_id:null==a?void 0:a.id});var t;t=r+e,null!=a&&a.id&&null!=a&&a.main_page&&(n&&sessionStorage.setItem("pendingChatMessage",t),window.dispatchEvent(new CustomEvent("pendingChatMessage",{detail:{message:t}})),s(!1),n?et.toast.success("Prompt added to chat"):et.toast.success("Prompt added to chat. Press Enter to send."))};return(0,se.jsx)(Sy,{open:t,onOpenChange:s,children:(0,se.jsxs)(Ly,{side:"right",noOverlay:!0,className:"flex flex-col gap-4 w-[400px] sm:max-w-[400px] p-6 font-base44",children:[(0,se.jsxs)(My,{className:"gap-2 items-start",children:[(0,se.jsx)(Ry,{className:"text-lg font-semibold leading-7 text-foreground",children:(0,se.jsx)("span",{className:"font-base44",children:"Create analytics events with AI"})}),(0,se.jsx)(Dy,{className:"text-sm text-muted-foreground leading-5 text-left",children:(0,se.jsx)("span",{className:"font-base44",children:"Describe the user action you want to track, or click a prompt below to get started."})})]}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col justify-between min-h-0",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsxs)("div",{className:"flex items-end justify-between gap-3",children:[(0,se.jsx)("span",{className:"flex-1 text-sm font-medium text-foreground leading-6 font-base44",children:"Suggested prompts:"}),(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:o,disabled:i,className:"h-auto px-2 py-1 gap-1.5 shadow-xs font-base44",children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 ".concat(i?"animate-spin":"")}),(0,se.jsx)("span",{className:"text-sm font-medium leading-5",children:"Refresh"})]})]}),(0,se.jsx)("div",{className:"flex flex-col gap-3",children:i?(0,se.jsx)(se.Fragment,{children:[1,2,3,4,5].map(e=>(0,se.jsx)(Tk,{},e))}):l.length>0?l.map((e,t)=>(0,se.jsx)(Ek,{suggestion:e,onClick:()=>c(e)},t)):(0,se.jsx)("div",{className:"bg-blue-50 rounded-lg p-3 text-center font-base44",children:(0,se.jsx)("p",{className:"text-sm text-gray-600",children:"Unable to load suggestions. Click refresh to try again."})})})]}),(0,se.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg px-4 py-3 mt-6",children:(0,se.jsxs)("p",{className:"text-sm text-muted-foreground leading-5 font-base44",children:[(0,se.jsx)("span",{className:"font-base44",children:"Custom events let you measure specific user actions, like button clicks, sign\u2011ups, or form submissions."})," ",(0,se.jsx)("a",{href:"https://docs.base44.com/documentation/performance-and-seo/app-analytics",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-foreground font-base44",children:"Learn more."})]})})]})]})})},EventQueriesDrawer:e=>{let{eventName:t,timeRange:s,open:a,onOpenChange:n}=e;return(0,se.jsx)(Sy,{open:a,onOpenChange:n,children:(0,se.jsxs)(Ly,{className:"flex flex-col min-w-[50vw] gap-6 p-6",children:[(0,se.jsx)(My,{children:(0,se.jsxs)(Ry,{children:[RC(t)," Details"]})}),(0,se.jsx)(HC,{eventName:t,timeRange:s})]})})},CustomizeDashboardsDrawer:e=>{var t;let{open:s,onOpenChange:a}=e;const n=OA.useDashboardsLayoutData(),l=null!==(t=OA.useDashboardsNames())&&void 0!==t?t:[],r=(0,BA.FR)((0,BA.MS)(BA.AN,{activationConstraint:{distance:5}}),(0,BA.MS)(BA.uN,{coordinateGetter:zA.JR})),i=e=>{const t=n[e];if(t)return!t.hidden;const s=PA[e];return!s||!s.hidden};return(0,se.jsx)(Sy,{open:s,onOpenChange:a,children:(0,se.jsxs)(Ly,{side:"right",noOverlay:!0,className:"flex flex-col gap-4 w-[400px] sm:max-w-[400px] p-6 font-base44",children:[(0,se.jsxs)(My,{className:"gap-2 items-start",children:[(0,se.jsx)(Ry,{className:"text-xl font-semibold leading-7 text-foreground",children:(0,se.jsx)("span",{className:"font-base44",children:"Customize dashboard"})}),(0,se.jsx)(Dy,{className:"text-sm text-muted-foreground leading-5 text-left",children:"Set up your dashboard to show the data that matters most to you."})]}),(0,se.jsx)("div",{className:"flex flex-col mt-4",children:(0,se.jsx)(BA.Mp,{sensors:r,collisionDetection:BA.fp,onDragEnd:e=>{const{active:t,over:s}=e;if(s&&t.id!==s.id){const e=l.indexOf(t.id),a=l.indexOf(s.id),n=(0,zA.be)(l,e,a);OA.setState(e=>{e.dashboardsOrder=n})}},children:(0,se.jsx)(zA.gB,{items:l,strategy:zA._G,children:l.map(e=>{var t;return(0,se.jsx)(VA,{id:e,isVisible:i(e),onToggleVisibility:t=>((e,t)=>{OA.updateDashboardLayoutData(e,{hidden:!t})})(e,t),draggable:null===(t=n[e])||void 0===t?void 0:t.draggable},e)})})})})]})})},PublishAppModal:e=>{let{open:t,onOpenChange:s,isFirstTimePublishing:a}=e;const n=ZA(),{getSuperbowlBannerTheme:l}=QA(),r=l();return Y.useEffect(()=>{t&&(n.reportPublishModalOpen(),a&&(0,bc.default)({particleCount:100,spread:70,origin:{y:.6}}))},[t]),(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsx)(Hg,{className:"p-0 font-base44 text-sm w-full max-w-[85vw] sm:max-w-[500px] block",children:(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("div",{className:"pt-6 px-6 border-b border-[#e5e5e5]",children:(0,se.jsx)(qg,{className:"text-lg font-semibold leading-none text-foreground pb-4",children:"Your app is published and live online!"})}),(0,se.jsxs)("div",{className:"flex flex-col gap-5 pt-4 pb-6 px-6",children:[(0,se.jsx)(nS,{}),r&&(0,se.jsx)(eS,{theme:r}),(0,se.jsx)("div",{className:"h-px bg-[#e5e5e5]"}),(0,se.jsx)(lS,{})]})]})})})}},{defaultProps:{InviteUser:{onInviteSuccess:()=>{kh.invalidateAppData()}}}}),{RenderAllModals:oS,Render:cS}=iS,dS=(0,Nt.A)(iS,["RenderAllModals","Render"]);function uS(e){var t,s,a,n,l,r,i,o,c;let{appId:d,appName:u,appStage:m,usingSandbox:x}=e;const{user:h}=wd(),{hasFlag:p}=ej(),g=p(sj),f=uh(),{isLoading:v,isConnecting:b,isDisconnecting:j}=kx.usePick("isLoading","isConnecting","isDisconnecting"),y=kx.useOauth(),N=kx.useRepo(),w=kx.useHasRepoConnectionError(),[_,k]=(0,Y.useState)(!1),C=(0,Y.useMemo)(()=>Uj(h,"builder"),[h]),A="pending"===m,S=null!==(t=null===(s=N.fullName)||void 0===s?void 0:s.split("/")[0])&&void 0!==t?t:"",E=null!==(a=null===(n=N.fullName)||void 0===n?void 0:n.split("/")[1])&&void 0!==a?a:"",T=null!==(l=null===(r=N.cloneUrls)||void 0===r?void 0:r.https)&&void 0!==l?l:"",I=null!==(i=null===(o=N.cloneUrls)||void 0===o?void 0:o.ssh)&&void 0!==i?i:"",P=async()=>{await kx.connect()&&L()},L=()=>{dS.openModal("CreateRepositoryModal",{appId:d,appName:u,onSuccess:O,onAuthRequired:P})},M=async()=>{if(!(y.connected&&y.status===um.Active)||w){if(await kx.connect())try{const e=await hm.getConnectionStatus(d);null!=e&&e.connected?await kx.fetchStatus():L()}catch(e){$.default.error("Failed to check existing connection. Please try again.")}return}L()},R=async()=>{var e;dS.closeModal("GitHubConnectConfirmDialog"),Tu(ym,e=f),Vu(e,{cta:Um,origin:nx,target_route:null}),await M()},D=()=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nx;Tu(bm,e),Vu(e,{cta:Om,origin:t,target_route:null})}(f,nx),Tu(jm,f),dS.openModal("GitHubConnectConfirmDialog",{onConfirm:R,isConnecting:b})},F=async()=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ix;Tu(Lm,e),Vu(e,{cta:Xm,origin:t,target_route:null})}(f,nx),await M()},O=async()=>{await kx.fetchStatus()},U=()=>{window.open("https://docs.base44.com/developers/app-code/local-development/github","_blank")};if(v)return(0,se.jsx)("div",{className:"p-4",children:(0,se.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,se.jsx)("div",{className:"h-5 bg-slate-200 rounded w-32"}),(0,se.jsx)("div",{className:"h-4 bg-slate-100 rounded w-full"}),(0,se.jsx)("div",{className:"h-9 bg-slate-100 rounded w-full"})]})});if(!C)return(0,se.jsxs)("div",{className:"p-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-slate-900",children:"GitHub Connection"}),(0,se.jsxs)(xp,{delayDuration:300,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("button",{className:"text-slate-400 hover:text-slate-600 transition-colors",tabIndex:-1,children:(0,se.jsx)(Pj.A,{className:"w-4 h-4"})})}),(0,se.jsx)(pp,{side:"left",className:"max-w-[200px] bg-gray-900 text-white border-gray-900",children:"Connect your project to GitHub to speed up updates and collaboration."})]})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Connect with GitHub to make changes directly from your repo."}),(0,se.jsx)(xj,{text:"Unlock this feature with the Builder plan.",layout:"vertical",trackingOrigin:"github-connection-card",userId:null==h?void 0:h.id,appId:d})]});if(w)return(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,se.jsx)("h3",{className:"text-base font-medium text-zinc-950",children:"GitHub Connection"}),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)("button",{className:"p-1 rounded hover:bg-neutral-100",children:(0,se.jsx)(Nv.A,{className:"w-5 h-5 text-neutral-500"})})}),(0,se.jsx)(Aj,{align:"end",children:(0,se.jsxs)(Sj,{onClick:U,children:[(0,se.jsx)(Lj.A,{className:"w-4 h-4 mr-2"}),"Documentation"]})})]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4 px-6 pb-4",children:[(0,se.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-100 rounded-lg",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-red-700",children:"Connection Issue"}),(0,se.jsxs)("p",{className:"text-sm text-red-700",children:["Install the Base44 GitHub App on ",S||"your"," organization with access to ",E||"this repository"," (or all repositories)."]})]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:"Organization"}),(0,se.jsx)("span",{className:"text-sm font-medium text-zinc-950",children:S||"\u2014"})]}),(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:"Repository"}),(0,se.jsx)("span",{className:"text-sm font-medium text-zinc-950",children:E||"\u2014"})]})]}),(0,se.jsx)(Bx,{onClick:F,disabled:b,className:"w-full bg-slate-900 hover:bg-slate-800 text-white",children:b?"Connecting...":"Reconnect to GitHub"})]})]});if(!N.connected){const e=!x,t=b||A||e,s=(()=>e?"GitHub connection is only available in the new infrastructure.":A?"GitHub connection requires app code to be generated first.":null)();return(0,se.jsxs)("div",{className:"p-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-slate-900",children:"GitHub Connection"}),(0,se.jsx)(Wj,{tier:"Builder+"})]}),(0,se.jsxs)(xp,{delayDuration:300,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("button",{className:"text-slate-400 hover:text-slate-600 transition-colors",tabIndex:-1,children:(0,se.jsx)(Pj.A,{className:"w-4 h-4"})})}),(0,se.jsx)(pp,{side:"left",className:"max-w-[200px] bg-gray-900 text-white border-gray-900",children:"Connect your project to GitHub to speed up updates and collaboration."})]})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Connect your project to GitHub to speed up updates and collaboration."}),(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("span",{className:"w-full block",children:(0,se.jsx)(Bx,{onClick:D,disabled:t,className:"w-full bg-slate-900 hover:bg-slate-800 text-white",children:b?"Connecting...":"Connect to GitHub"})})}),s&&(0,se.jsx)(pp,{side:"bottom",className:"bg-gray-900 text-white border-gray-900",children:s})]})]})}return(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,se.jsx)("h3",{className:"text-base font-medium text-zinc-950",children:"GitHub Connection"}),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 -mr-2",children:(0,se.jsx)(Nv.A,{className:"w-4 h-4 text-zinc-950"})})}),(0,se.jsxs)(Aj,{align:"end",children:[(0,se.jsxs)(Sj,{onClick:U,children:[(0,se.jsx)(Lj.A,{className:"w-4 h-4 mr-2"}),"Documentation"]}),g&&(0,se.jsxs)(Sj,{onClick:()=>{var e;Tu(Mm,e=f),Vu(e,{cta:ex,origin:ix,target_route:null}),k(!0)},className:"text-red-600 focus:text-red-600",children:[(0,se.jsx)(Mj.A,{className:"w-4 h-4 mr-2"}),"Disconnect from GitHub"]})]})]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 px-6 pb-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-sm text-[#229954]",children:"Connected"}),(0,se.jsx)("div",{className:"w-5 h-5 flex items-center justify-center",children:(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z",fill:"#25A55A"}),(0,se.jsx)("path",{d:"M7 10L9 12L13 8",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 py-2",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:"Organization"}),(0,se.jsx)("span",{className:"text-sm font-medium text-zinc-950",children:S})]}),(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:"Repository"}),(0,se.jsx)("span",{className:"text-sm font-medium text-zinc-950",children:E})]})]}),(0,se.jsxs)(Bx,{onClick:()=>{var e,t;!function(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(Im,s),Vu(e,(0,ue.A)({cta:Jm,origin:ix,target_route:null},t))}(f,{repo_full_name:null!==(e=N.fullName)&&void 0!==e?e:""}),window.open(null!==(t=N.url)&&void 0!==t?t:"","_blank")},variant:"outline",className:"h-8 px-4 bg-white border-neutral-200 shadow-sm text-sm font-medium text-zinc-950 hover:bg-neutral-50",children:["Go to Repository",(0,se.jsx)(Rj.A,{className:"w-4 h-4 ml-2"})]})]}),N.cloneUrls&&(0,se.jsx)("div",{className:"border-t border-neutral-200 px-6 py-4",children:(0,se.jsx)(sy,{httpsUrl:T,sshUrl:I,repoFullName:null!==(c=N.fullName)&&void 0!==c?c:""})}),(0,se.jsx)(Jb,{open:_,onOpenChange:k,onConfirm:async()=>{var e;Tu(Rm,e=f),Vu(e,{cta:tx,origin:ix,target_route:null});try{await kx.disconnect(),k(!1)}catch(t){$.default.error("Failed to disconnect repository. Please try again.")}},isDisconnecting:j,message:"This will disconnect this app from the GitHub repository. You can reconnect at any time."})]})}const mS=ct.Root,xS=ct.Trigger,hS=Y.forwardRef((e,t)=>(0,se.jsx)(Ql,(0,ue.A)({ref:t},e)));function pS(){const{app:e}=lp(),{user:t}=wd(),{workspaces:s}=qd(),[a,n]=(0,Y.useState)(!1),[l,r]=(0,Y.useState)(!0);return(0,Y.useEffect)(()=>{(()=>{if(!e.organization_id||!t)return n(!1),void r(!1);const a=null==s?void 0:s.find(t=>t.id===e.organization_id);if(a){const e=!a.is_personal&&a.id!==t.personal_organization_id;return n(e),void r(!1)}if(Zp(t.platform_role)){const s=e.organization_id!==t.personal_organization_id;return n(s),void r(!1)}n(!1),r(!1)})()},[e.organization_id,s,t]),{isInSharedWorkspace:a,isLoading:l}}function gS(e){let{appId:t,appName:s}=e;const[a,n]=(0,Y.useState)(!1),{isLoading:l,_isEnabled:r}=kx.usePick("isLoading","_isEnabled"),i=kx.useRepo(),o=kx.useHasRepoConnectionError(),{isInSharedWorkspace:c}=pS(),{app:d}=lp(),{activeWorkspace:u}=qd(),m=uh(),x=l?"none":i.connected?i.status===mm.Active?"connected":i.status===mm.Error||i.status===mm.Revoked?"error":"none":"none";if((0,Y.useEffect)(()=>{if(!a)return;const e=()=>{setTimeout(()=>n(!1),0)};return window.addEventListener("blur",e),()=>window.removeEventListener("blur",e)},[a]),!r||c)return(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",onClick:()=>{dS.openModal("ExportToGithub")},children:(0,se.jsx)(dh.A,{size:16})})}),(0,se.jsx)(pp,{side:"bottom",className:"bg-gray-900 text-white border-gray-900",children:"Connect GitHub [Beta]"})]});return(0,se.jsxs)(mS,{open:a,onOpenChange:e=>{var t;(n(e),e)&&function(e,t){const s=(0,ue.A)((0,ue.A)({},e),t);Tu(vm,s),Vu(e,(0,ue.A)({cta:Fm,origin:nx,target_route:null},t))}(m,{workspace_type:u?u.is_personal?xx.Personal:xx.Shared:null,workspace_id:null!==(t=null==u?void 0:u.id)&&void 0!==t?t:null,connection_status:i.connected?o?dx.Error:dx.Active:dx.NotConnected})},children:[(0,se.jsxs)(xp,{delayDuration:400,disableHoverableContent:!0,open:!a&&void 0,children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",className:"text-slate-700 hover:text-slate-900",children:(0,se.jsxs)("span",{className:"relative",children:[(0,se.jsx)(dh.A,{size:16}),"error"===x&&(0,se.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white"}),"connected"===x&&(0,se.jsx)("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-emerald-500 rounded-full border-2 border-white"})]})})})}),!a&&(0,se.jsx)(pp,{side:"bottom",className:"bg-gray-900 text-white border-gray-900",children:"GitHub Connection"})]}),(0,se.jsx)(hS,{className:"w-80 p-0 shadow-lg",align:"end",sideOffset:8,onInteractOutside:()=>n(!1),onFocusOutside:()=>n(!1),onEscapeKeyDown:()=>n(!1),children:(0,se.jsx)(uS,{appId:t,appName:s,appStage:null==d?void 0:d.app_stage,usingSandbox:null==d?void 0:d.using_sandbox})})]})}hS.displayName=ct.Content.displayName;const fS=e=>{let{onRetry:t}=e;return(0,se.jsx)("div",{className:"px-4 py-3 rounded-lg bg-red-50 border border-red-100 sm:mx-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,se.jsx)(Zb,{className:"w-5 h-5 text-red-500"})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("p",{className:"text-sm text-red-600 font-medium",children:"We couldn't sync the latest changes from GitHub. Refresh the builder to try again."}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:t,className:"mt-2 text-red-600 border-red-200 hover:bg-red-50 hover:text-red-700",children:"Refresh"})]})]})})},vS=e=>{var t;let{message:s}=e;const[a,n]=(0,Y.useState)(!1),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!1),u=null===(t=s.custom_context)||void 0===t?void 0:t.find(e=>"github_sync"===e.type),m=null==u?void 0:u.data;if(!m||!m.commits||0===m.commits.length)return null;const x=m.commits,h=1===x.length,p=(()=>{var e;if(m.repo_url)return m.repo_url;const t=null===(e=x[0])||void 0===e?void 0:e.url;if(t){const e=t.match(/^(https:\/\/github\.com\/[^/]+\/[^/]+)/);if(e)return e[1]}return""})(),g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;const s=e.split("\n")[0];return s.length>t?s.substring(0,t)+"...":s},f=(e,t)=>e.split("\n")[0].length>t,v=e=>{window.open(e,"_blank","noopener,noreferrer")},b=()=>{n(!a)},j=(0,se.jsx)("div",{className:"transition-opacity ".concat(l||c?"opacity-100":"opacity-0"),children:(0,se.jsxs)(Nj,{open:c,onOpenChange:d,children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded flex-shrink-0",children:(0,se.jsx)(mb.A,{className:"w-4 h-4 text-gray-400"})})}),(0,se.jsx)(Aj,{side:"bottom",align:"end",className:"w-40",children:(0,se.jsx)(Sj,{onClick:()=>{h?v(x[0].url):p&&window.open("".concat(p,"/commits/main/"),"_blank","noopener,noreferrer")},className:"cursor-pointer",children:"View on GitHub"})})]})});return(0,se.jsxs)("div",{className:"mb-6 relative",children:[(0,se.jsx)("div",{className:"flex flex-row justify-between mr-3",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)("img",{src:Wx,alt:"Base44 AI",className:"w-6 h-6 object-cover rounded-full opacity-75"}),(0,se.jsx)("span",{className:"text-xs text-gray-500",children:"Base44"})]})}),(0,se.jsx)("div",{className:"text-sm ps-2 rounded-lg pl-8",children:(0,se.jsxs)("div",{className:"relative",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[(0,se.jsx)("div",{className:"flex items-center gap-2 text-sm rounded-md p-1",children:h?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"ml-3 inline-flex items-center",children:(0,se.jsx)(Zb,{className:"h-4 w-4 text-gray-400"})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0 flex items-center justify-between gap-2",children:[f(x[0].message,40)?(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)("span",{className:"text-black truncate cursor-default",children:['Synced "',g(x[0].message,40),'"']})}),(0,se.jsx)(pp,{className:"bg-gray-900 text-white border-gray-900 max-w-md",children:(0,se.jsxs)("p",{children:['"',x[0].message.split("\n")[0],'"']})})]}):(0,se.jsxs)("span",{className:"text-black truncate",children:['Synced "',g(x[0].message,40),'"']}),j]})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"ml-3 inline-flex items-center cursor-pointer",onClick:b,children:l||a?(0,se.jsx)(Kb.A,{className:"h-4 w-4 text-gray-400"}):(0,se.jsx)(Zb,{className:"h-4 w-4 text-gray-400"})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0 flex items-center justify-between gap-2",children:[(0,se.jsxs)("span",{className:"cursor-pointer hover:text-slate-600 text-black text-left",onClick:b,children:["Synced ",x.length," commits from GitHub"]}),j]})]})}),!h&&a&&(0,se.jsxs)("div",{className:"mt-2 ml-[40px]",children:[(0,se.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Commits:"}),(0,se.jsx)("div",{className:"space-y-0.5",children:x.map(e=>{const t=e.message.split("\n")[0],s=g(e.message,15),a=i===e.sha,n=f(e.message,15),l=(0,se.jsxs)("div",{className:"flex items-center text-sm py-0.5 cursor-pointer group/commit",onClick:()=>v(e.url),onMouseEnter:()=>o(e.sha),onMouseLeave:()=>o(null),children:[(0,se.jsxs)("span",{className:"text-gray-500 ".concat(a?"underline decoration-gray-400":""),children:['"',s,'"',(0,se.jsxs)("span",{className:"ml-1",children:["by ",e.author_name]})]}),a&&(0,se.jsx)(au.A,{className:"w-4 h-4 text-gray-400 ml-1 flex-shrink-0"})]});return n?(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:l}),(0,se.jsx)(pp,{className:"bg-gray-900 text-white border-gray-900 max-w-md",children:(0,se.jsxs)("p",{children:['"',t,'"']})})]},e.sha):(0,se.jsx)("div",{children:l},e.sha)})})]})]})})]})},bS=e=>{let{reasoning:t}=e;const[s,a]=(0,Y.useState)(!1);if(!t)return null;const n=null!==t.end_date&&void 0!==t.end_date,l=(()=>{if(!n)return null;const e=He()(t.start_date),s=He()(t.end_date),a=He().duration(s.diff(e));if(a.asSeconds()<1)return"less than a second";if(a.asSeconds()<60){const e=Math.round(a.asSeconds());return"".concat(e,"s")}if(a.asMinutes()<60){const e=Math.round(a.asMinutes());return"".concat(e,"m")}{const e=Math.round(a.asHours());return"".concat(e,"h")}})();return(0,se.jsxs)("div",{className:"mb-3",children:[(0,se.jsx)("div",{className:"inline-flex items-start gap-2",children:(0,se.jsx)("button",{onClick:()=>a(!s),className:"flex items-center gap-1.5 px-2.5 py-1 rounded-md transition-all ".concat(n?"bg-slate-50 hover:bg-slate-100 text-slate-600":"bg-gradient-to-r from-slate-50 to-slate-100 text-slate-600"),disabled:!n||!t.content,children:n?(0,se.jsxs)(se.Fragment,{children:[t.content&&(s?(0,se.jsx)(_t.A,{className:"h-3 w-3"}):(0,se.jsx)(bs.A,{className:"h-3 w-3"})),(0,se.jsxs)("span",{className:"text-xs font-medium",children:["Thought ",l&&(0,se.jsxs)("span",{className:"text-xs text-slate-500",children:["for ",l]})]})]}):(0,se.jsx)(se.Fragment,{children:(0,se.jsx)("span",{className:"text-xs font-medium animate-pulse",children:"Planning next steps..."})})})}),n&&t.content&&s&&(0,se.jsx)("div",{className:"mt-2 ml-0 animate-in slide-in-from-top-1 duration-200",children:(0,se.jsxs)("div",{className:"relative pl-4 py-2 pr-3 rounded-md bg-gradient-to-r from-slate-50 to-transparent",children:[(0,se.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-0.5 bg-gradient-to-b from-orange-300 to-teal-300 rounded-full"}),(0,se.jsx)("p",{className:"text-xs text-slate-600 leading-relaxed whitespace-pre-wrap",children:t.content})]})})]})};var jS=s(77737),yS=s(25692),NS=s(82981);const wS=e=>"string"==typeof e?e:JSON.stringify(e,null,2),_S=()=>(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",children:[(0,se.jsx)("circle",{cx:"8",cy:"8",r:"3.5",fill:"#3B82F6",stroke:"#BFDBFE"}),(0,se.jsxs)("circle",{cx:"8",cy:"8",r:"3.5",fill:"none",stroke:"#3B82F6",strokeWidth:"1.5",children:[(0,se.jsx)("animate",{attributeName:"r",values:"3.5;6.5;3.5",dur:"1s",repeatCount:"indefinite"}),(0,se.jsx)("animate",{attributeName:"opacity",values:"1;0;1",dur:"1s",repeatCount:"indefinite"})]})]});function kS(e){let{icon:t,status:s,isLastAssistantMessage:a,isLastRunningTool:n,children:l,secondaryContent:r=null,requiresUserInput:i=!1,onClick:o,messageId:c,toolCallId:d,showViewChanges:u=!1,debugInfo:m=null,result:x=null}=e;const{user:h}=wd(),{app:p}=lp(),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(!1),{data:_,isLoading:k,error:C}=Xd({query:()=>zc.getToolCall(null==p?void 0:p.id,c,d),enabled:v&&!(null==p||!p.id)&&!!c&&!!d,logErrorMsg:"Failed to fetch full tool call"},[null==p?void 0:p.id,c,d]),A="running"===s,S="error"===s||"failed"===s,E="success"===s,T=o&&"function"==typeof o&&E;return(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsxs)("div",{className:de("flex items-center gap-2 text-sm transition-all duration-1000 rounded-md p-1",A&&!n?"text-slate-400":"text-slate-600",S&&"text-slate-700",T&&"cursor-pointer hover:bg-slate-100 rounded-md p-1 "),onClick:e=>{e.target.closest("[data-dropdown-menu]")||T&&o(e)},onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:["waiting_for_user_input"===s||"pending"===s?(0,se.jsx)(_S,{}):t&&(0,se.jsx)(t,{className:"h-4 w-4 text-gray-400"}),(0,se.jsx)("div",{className:de("flex-1 min-w-0 text-black",S&&"relative"),children:l}),(0,se.jsx)("div",{className:"ml-auto","data-dropdown-menu":!0,children:(j||N)&&(u||(m||d)&&$p(null==h?void 0:h.platform_role))&&(E||S)?(0,se.jsxs)(yn,{onOpenChange:w,children:[(0,se.jsx)(Nn,{className:"flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:(0,se.jsx)(mb.A,{size:16})}),(0,se.jsxs)(En,{align:"end",children:[u&&c&&(0,se.jsxs)(Tn,{onClick:e=>{e.stopPropagation(),f(!0)},className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(xb.A,{size:14,className:"text-gray-400"}),(0,se.jsx)("span",{children:"View Changes"})]}),(m||d)&&$p(null==h?void 0:h.platform_role)&&(0,se.jsxs)(se.Fragment,{children:[u&&c&&(0,se.jsx)(Mn,{}),(0,se.jsxs)(Tn,{onClick:e=>{e.stopPropagation(),b(!0)},className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(NS.A,{size:14,className:"text-gray-400"}),(0,se.jsx)("span",{children:"Debug Info"})]})]})]})]}):(0,se.jsx)("span",{})})]}),r,g&&c&&(0,se.jsx)(fb,{msgId:c,isOpen:g,onClose:()=>f(!1)}),v&&(m||d)&&(0,se.jsx)(ma,{open:v,onOpenChange:b,children:(0,se.jsxs)(fa,{className:"max-w-3xl max-h-[80vh] overflow-auto",children:[(0,se.jsx)(va,{children:(0,se.jsx)(ja,{children:"Debug Info"})}),(e=>{if(k&&!m)return(0,se.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin text-slate-500"}),(0,se.jsx)("span",{className:"ml-2 text-sm text-slate-500",children:"Loading full data..."})]});const t=null!=_&&_.arguments_string?(e=>{try{return JSON.parse(e)}catch(t){return e}})(_.arguments_string):null==m?void 0:m.input,s=null!==(e=null==_?void 0:_.results)&&void 0!==e?e:null==m?void 0:m.output,a=C&&!_;return(0,se.jsxs)("div",{className:"space-y-4",children:[a&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Failed to load debug info."})]}),null!=t&&(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Input:"}),(0,se.jsx)("pre",{className:"bg-slate-50 rounded-md p-3 text-xs text-slate-700 overflow-auto max-h-64",children:wS(t)})]}),null!=s&&(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Output:"}),(0,se.jsx)("pre",{className:"bg-slate-50 rounded-md p-3 text-xs text-slate-700 overflow-auto max-h-96 whitespace-pre-wrap",children:wS(s)})]})]})})()]})})]})}function CS(e){if(!e)return"file";let t=e.replace(/^(src\/|app\/|components\/|lib\/|utils\/)/,"");if(t=t.replace(/\.(jsx?|tsx?|css|scss|json|md|html|py|java|go|rb|php)$/i,""),e.match(/pages?\/.*\.jsx?$/i)){const e=t.split("/").pop(),s=e?e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[-_]/g," ").trim():"";return"".concat(s.charAt(0).toUpperCase()+s.slice(1)," Page")}if(e.match(/api\/.*\.jsx?$/i)){const e=t.split("/").slice(0,-1).pop()||t.split("/").pop(),s=e?e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[-_]/g," ").trim():"";return"".concat(s.charAt(0).toUpperCase()+s.slice(1)," API")}return t.split("/").map(e=>e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[-_]/g," ").trim()).join("/").trim()}function AS(e,t){if(!e||!t)return null;if(e.startsWith("agents/")){let s=e.split("/").pop();return s&&s.endsWith(".json")&&(s=s.slice(0,-5)),"/apps/".concat(t,"/editor/workspace/agents?agent=").concat(s)}return"/apps/".concat(t,"/editor/workspace/code?filePath=").concat(e)}const SS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,se.jsx)("path",{d:"M9.33341 1.33301V3.99967C9.33341 4.3533 9.47389 4.69244 9.72394 4.94248C9.97399 5.19253 10.3131 5.33301 10.6667 5.33301H13.3334M6.66675 7.99967C6.48994 7.99967 6.32037 8.06991 6.19534 8.19494C6.07032 8.31996 6.00008 8.48953 6.00008 8.66634V9.33301C6.00008 9.50982 5.92984 9.67939 5.80482 9.80441C5.67979 9.92944 5.51023 9.99967 5.33341 9.99967C5.51023 9.99967 5.67979 10.0699 5.80482 10.1949C5.92984 10.32 6.00008 10.4895 6.00008 10.6663V11.333C6.00008 11.5098 6.07032 11.6794 6.19534 11.8044C6.32037 11.9294 6.48994 11.9997 6.66675 11.9997M9.33341 11.9997C9.51023 11.9997 9.67979 11.9294 9.80482 11.8044C9.92984 11.6794 10.0001 11.5098 10.0001 11.333V10.6663C10.0001 10.4895 10.0703 10.32 10.1953 10.1949C10.3204 10.0699 10.4899 9.99967 10.6667 9.99967C10.4899 9.99967 10.3204 9.92944 10.1953 9.80441C10.0703 9.67939 10.0001 9.50982 10.0001 9.33301V8.66634C10.0001 8.48953 9.92984 8.31996 9.80482 8.19494C9.67979 8.06991 9.51023 7.99967 9.33341 7.99967M10.0001 1.33301H4.00008C3.64646 1.33301 3.30732 1.47348 3.05727 1.72353C2.80722 1.97358 2.66675 2.31272 2.66675 2.66634V13.333C2.66675 13.6866 2.80722 14.0258 3.05727 14.2758C3.30732 14.5259 3.64646 14.6663 4.00008 14.6663H12.0001C12.3537 14.6663 12.6928 14.5259 12.9429 14.2758C13.1929 14.0258 13.3334 13.6866 13.3334 13.333V4.66634L10.0001 1.33301Z",stroke:"currentColor",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function ES(e){let{toolCall:t,parsedArgs:s,messageId:a,isLastAssistantMessage:n,isLastRunningTool:l,debugInfo:r}=e;const i=(0,J.Zp)(),{app:o}=lp(),c=t.status,d=(null==s?void 0:s.file_path)||(null==s?void 0:s.target_file)||"file",u=CS(d),m="running"===c;return(0,se.jsx)(kS,{icon:SS,status:c,isLastAssistantMessage:n,isLastRunningTool:l,onClick:()=>{const e=AS(d,null==o?void 0:o.id);e&&i(e)},messageId:a,toolCallId:t.id,showViewChanges:!0,debugInfo:r,children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[m?"Writing":"Wrote"," ","file"!==u&&(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-[2px] bg-gray-200 text-gray-700 rounded font-[400] text-xs ",children:u})]})})}const TS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,se.jsx)("path",{d:"M9.33341 1.33301V3.99967C9.33341 4.3533 9.47389 4.69244 9.72394 4.94248C9.97399 5.19253 10.3131 5.33301 10.6667 5.33301H13.3334M6.66675 7.99967C6.48994 7.99967 6.32037 8.06991 6.19534 8.19494C6.07032 8.31996 6.00008 8.48953 6.00008 8.66634V9.33301C6.00008 9.50982 5.92984 9.67939 5.80482 9.80441C5.67979 9.92944 5.51023 9.99967 5.33341 9.99967C5.51023 9.99967 5.67979 10.0699 5.80482 10.1949C5.92984 10.32 6.00008 10.4895 6.00008 10.6663V11.333C6.00008 11.5098 6.07032 11.6794 6.19534 11.8044C6.32037 11.9294 6.48994 11.9997 6.66675 11.9997M9.33341 11.9997C9.51023 11.9997 9.67979 11.9294 9.80482 11.8044C9.92984 11.6794 10.0001 11.5098 10.0001 11.333V10.6663C10.0001 10.4895 10.0703 10.32 10.1953 10.1949C10.3204 10.0699 10.4899 9.99967 10.6667 9.99967C10.4899 9.99967 10.3204 9.92944 10.1953 9.80441C10.0703 9.67939 10.0001 9.50982 10.0001 9.33301V8.66634C10.0001 8.48953 9.92984 8.31996 9.80482 8.19494C9.67979 8.06991 9.51023 7.99967 9.33341 7.99967M10.0001 1.33301H4.00008C3.64646 1.33301 3.30732 1.47348 3.05727 1.72353C2.80722 1.97358 2.66675 2.31272 2.66675 2.66634V13.333C2.66675 13.6866 2.80722 14.0258 3.05727 14.2758C3.30732 14.5259 3.64646 14.6663 4.00008 14.6663H12.0001C12.3537 14.6663 12.6928 14.5259 12.9429 14.2758C13.1929 14.0258 13.3334 13.6866 13.3334 13.333V4.66634L10.0001 1.33301Z",stroke:"currentColor",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function IS(e){let{toolCall:t,parsedArgs:s,messageId:a,isLastAssistantMessage:n,isLastRunningTool:l,debugInfo:r}=e;const i=(0,J.Zp)(),{app:o}=lp(),c=t.status,d=(null==s?void 0:s.file_path)||(null==s?void 0:s.target_file)||"file",u=CS(d),m="running"===c;return(0,se.jsx)(kS,{icon:TS,status:c,isLastAssistantMessage:n,isLastRunningTool:l,onClick:()=>{const e=AS(d,null==o?void 0:o.id);e&&i(e)},messageId:a,toolCallId:t.id,showViewChanges:!0,debugInfo:r,children:(0,se.jsxs)("div",{className:"flex items-center gap-2.5",children:[m?"Reading":"Read"," ",(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-1 bg-gray-200 text-gray-700 rounded font-[400] text-xs",children:u})]})})}const PS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,se.jsx)("path",{d:"M2 4H3.33333M3.33333 4H14M3.33333 4V13.3333C3.33333 13.687 3.47381 14.0261 3.72386 14.2761C3.97391 14.5262 4.31304 14.6667 4.66667 14.6667H11.3333C11.687 14.6667 12.0261 14.5262 12.2761 14.2761C12.5262 14.0261 12.6667 13.687 12.6667 13.3333V4H3.33333ZM5.33333 4V2.66667C5.33333 2.31304 5.47381 1.97391 5.72386 1.72386C5.97391 1.47381 6.31304 1.33333 6.66667 1.33333H9.33333C9.68696 1.33333 10.0261 1.47381 10.2761 1.72386C10.5262 1.97391 10.6667 2.31304 10.6667 2.66667V4M6.66667 7.33333V11.3333M9.33333 7.33333V11.3333",stroke:"currentColor",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function LS(e){let{toolCall:t,parsedArgs:s,messageId:a,isLastAssistantMessage:n,isLastRunningTool:l,debugInfo:r}=e;const i=(0,J.Zp)(),{app:o}=lp(),c=t.status,d=(null==s?void 0:s.file_path)||(null==s?void 0:s.target_file)||"file",u=CS(d),m="running"===c;return(0,se.jsx)(kS,{icon:PS,status:c,isLastAssistantMessage:n,isLastRunningTool:l,onClick:()=>{const e=AS(d,null==o?void 0:o.id);e&&i(e)},messageId:a,toolCallId:t.id,showViewChanges:!0,debugInfo:r,children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[m?"Deleting":"Deleted"," ",(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-[2px] bg-gray-200 text-gray-700 rounded font-[400] text-xs ",children:"file"===u?"":u})]})})}const MS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,se.jsx)("path",{d:"M14 3.33301C14 4.43758 11.3137 5.33301 8 5.33301C4.68629 5.33301 2 4.43758 2 3.33301M14 3.33301C14 2.22844 11.3137 1.33301 8 1.33301C4.68629 1.33301 2 2.22844 2 3.33301M14 3.33301V12.6663C14 13.1968 13.3679 13.7055 12.2426 14.0806C11.1174 14.4556 9.5913 14.6663 8 14.6663C6.4087 14.6663 4.88258 14.4556 3.75736 14.0806C2.63214 13.7055 2 13.1968 2 12.6663V3.33301M2 7.99967C2 8.53011 2.63214 9.03882 3.75736 9.41389C4.88258 9.78896 6.4087 9.99967 8 9.99967C9.5913 9.99967 11.1174 9.78896 12.2426 9.41389C13.3679 9.03882 14 8.53011 14 7.99967",stroke:"#9CA3AF",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function RS(e){var t;let{toolCall:s,parsedArgs:a,isLastAssistantMessage:n,isLastRunningTool:l}=e;const{app:r}=lp(),i=(0,J.Zp)(),o=s.status,c=(null==a?void 0:a.entity_name)||"entities",d=null==a||null===(t=a.data)||void 0===t?void 0:t.length,u="running"===o;return(0,se.jsx)(kS,{icon:MS,status:o,isLastAssistantMessage:n,isLastRunningTool:l,onClick:()=>{null!=r&&r.id&&c&&i("/apps/".concat(r.id,"/editor/workspace/entity-").concat(c))},children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[u?"Creating":"Created","",d&&(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)("span",{children:[d," ","records"," "]}),(0,se.jsx)("span",{className:"flex items-center gap-1 flex items-center justify-center px-1 py-[2px] bg-gray-200 text-gray-700 rounded font-[400] text-xs",children:c})]})]})})}const DS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,se.jsx)("path",{d:"M14 3.33301C14 4.43758 11.3137 5.33301 8 5.33301C4.68629 5.33301 2 4.43758 2 3.33301M14 3.33301C14 2.22844 11.3137 1.33301 8 1.33301C4.68629 1.33301 2 2.22844 2 3.33301M14 3.33301V12.6663C14 13.1968 13.3679 13.7055 12.2426 14.0806C11.1174 14.4556 9.5913 14.6663 8 14.6663C6.4087 14.6663 4.88258 14.4556 3.75736 14.0806C2.63214 13.7055 2 13.1968 2 12.6663V3.33301M2 7.99967C2 8.53011 2.63214 9.03882 3.75736 9.41389C4.88258 9.78896 6.4087 9.99967 8 9.99967C9.5913 9.99967 11.1174 9.78896 12.2426 9.41389C13.3679 9.03882 14 8.53011 14 7.99967",stroke:"#9CA3AF",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function FS(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastRunningTool:n}=e;const{app:l}=lp(),r=(0,J.Zp)(),i=t.status,o=(null==s?void 0:s.entity_name)||"entities",c=(null==s?void 0:s.query)||{},d=null==s?void 0:s.limit,u=null==s?void 0:s.skip,m=null==s?void 0:s.sort,x="running"===i,h="success"===i,p=!c||0===Object.keys(c).length,g=(()=>{if(!t.results)return null;try{const e="string"==typeof t.results?JSON.parse(t.results):t.results;return Array.isArray(e)?e:null}catch(e){return null}})(),f=null==g?void 0:g.length;return(0,se.jsx)(kS,{icon:DS,status:i,isLastAssistantMessage:a,isLastRunningTool:n,onClick:()=>{null!=l&&l.id&&o&&r("/apps/".concat(l.id,"/editor/workspace/entity-").concat(o))},children:(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2.5",children:[x?"Reading":"Read"," ",(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-1 bg-gray-200 text-gray-700 rounded font-[400] text-xs",children:o}),h&&void 0!==f&&(0,se.jsxs)("span",{className:"ml-1.5 text-slate-500",children:["\xb7 ",f," ",1===f?"record":"records"]})]}),(!p||d||u||m)&&(0,se.jsxs)("div",{className:"mt-1 text-xs text-slate-500 space-y-0.5",children:[!p&&(0,se.jsxs)("div",{children:["Filter: ",(0,se.jsx)("span",{className:"font-mono",children:JSON.stringify(c)})]}),(d||u)&&(0,se.jsxs)("div",{children:[d&&"Limit: ".concat(d),d&&u&&" \xb7 ",u&&"Skip: ".concat(u)]}),m&&(0,se.jsxs)("div",{children:["Sort: ",(0,se.jsx)("span",{className:"font-mono",children:JSON.stringify(m)})]})]})]})})}const OS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,se.jsx)("path",{d:"M14 3.33301C14 4.43758 11.3137 5.33301 8 5.33301C4.68629 5.33301 2 4.43758 2 3.33301M14 3.33301C14 2.22844 11.3137 1.33301 8 1.33301C4.68629 1.33301 2 2.22844 2 3.33301M14 3.33301V12.6663C14 13.1968 13.3679 13.7055 12.2426 14.0806C11.1174 14.4556 9.5913 14.6663 8 14.6663C6.4087 14.6663 4.88258 14.4556 3.75736 14.0806C2.63214 13.7055 2 13.1968 2 12.6663V3.33301M2 7.99967C2 8.53011 2.63214 9.03882 3.75736 9.41389C4.88258 9.78896 6.4087 9.99967 8 9.99967C9.5913 9.99967 11.1174 9.78896 12.2426 9.41389C13.3679 9.03882 14 8.53011 14 7.99967",stroke:"#9CA3AF",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function US(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastRunningTool:n}=e;const{submitToolCallInput:l,app:r}=lp(),i=(0,J.Zp)(),[o,c]=(0,Y.useState)(!1),d=t.status,u=(null==s?void 0:s.entity_name)||"entities",m=(null==s?void 0:s.query)||{},x="running"===d,h="waiting_for_user_input"===d,p="success"===d,g="stopped"===d,f=!m||0===Object.keys(m).length,v=async()=>{c(!0);try{await l(t.id,!0,{})}catch(e){}finally{c(!1)}},b=async()=>{c(!0);try{await l(t.id,!1,{})}catch(e){}finally{c(!1)}},j=()=>h?(0,se.jsx)("div",{className:"border border-slate-200 bg-slate-50 rounded-lg p-4 space-y-3 mt-2",children:(0,se.jsx)("div",{className:"flex items-start gap-2.5",children:(0,se.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900 mb-4",children:"Approval Required"}),(0,se.jsx)("div",{className:"text-sm text-slate-600",children:f?(0,se.jsxs)(se.Fragment,{children:["Delete all"," ",(0,se.jsx)("span",{className:"font-mono text-xs bg-white px-1.5 py-0.5 rounded border border-slate-200",children:u})," records"]}):(0,se.jsxs)(se.Fragment,{children:["Delete"," ",(0,se.jsx)("span",{className:"font-mono text-xs bg-white px-1.5 py-0.5 rounded border border-slate-200",children:u})," records matching:"]})})]}),!f&&(0,se.jsx)("pre",{className:"text-xs bg-white rounded-md p-3 text-slate-700 overflow-x-auto border border-slate-200",children:JSON.stringify(m,null,2)}),a?(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(zt,{size:"sm",onClick:v,disabled:o,className:"h-8 text-xs bg-slate-900 hover:bg-slate-800 disabled:opacity-50",children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 mr-1.5 animate-spin"}),"Approving..."]}):"Approve"}),(0,se.jsx)(zt,{size:"sm",variant:"outline",onClick:b,disabled:o,className:"h-8 text-xs border-slate-300 hover:bg-slate-50 disabled:opacity-50",children:"Reject"})]}):(0,se.jsx)("div",{className:"text-xs text-slate-500 italic",children:"This approval request is from a previous message"})]})})}):null;return(0,se.jsx)(kS,{icon:OS,status:d,isLastAssistantMessage:a,isLastRunningTool:n,onClick:()=>{null!=r&&r.id&&u&&i("/apps/".concat(r.id,"/editor/workspace/entity-").concat(u))},secondaryContent:(0,se.jsx)(j,{}),result:t.results,children:(0,se.jsx)("div",{children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[x?"Deleting":p?"Deleted":"Delete"," ",f&&(x||p)?"all records":"",(0,se.jsx)("span",{className:"flex items-center gap-1 flex items-center justify-center px-[6px] py-[2px] bg-gray-200 text-gray-500 rounded font-[400] font-mon text-xs",children:u}),g&&t.requires_user_input&&(0,se.jsx)("span",{className:"text-slate-400 text-xs italic",children:"rejected"})]})})})}const BS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,se.jsx)("path",{d:"M14 3.33301C14 4.43758 11.3137 5.33301 8 5.33301C4.68629 5.33301 2 4.43758 2 3.33301M14 3.33301C14 2.22844 11.3137 1.33301 8 1.33301C4.68629 1.33301 2 2.22844 2 3.33301M14 3.33301V12.6663C14 13.1968 13.3679 13.7055 12.2426 14.0806C11.1174 14.4556 9.5913 14.6663 8 14.6663C6.4087 14.6663 4.88258 14.4556 3.75736 14.0806C2.63214 13.7055 2 13.1968 2 12.6663V3.33301M2 7.99967C2 8.53011 2.63214 9.03882 3.75736 9.41389C4.88258 9.78896 6.4087 9.99967 8 9.99967C9.5913 9.99967 11.1174 9.78896 12.2426 9.41389C13.3679 9.03882 14 8.53011 14 7.99967",stroke:"#9CA3AF",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function zS(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastRunningTool:n}=e;const{submitToolCallInput:l,app:r}=lp(),i=(0,J.Zp)(),[o,c]=(0,Y.useState)(!1),d=t.status,u=(null==s?void 0:s.entity_name)||"entities",m=(null==s?void 0:s.query)||{},x=(null==s?void 0:s.data)||{},h="running"===d,p="waiting_for_user_input"===d,g="success"===d,f="stopped"===d,v=!m||0===Object.keys(m).length,b=async()=>{c(!0);try{await l(t.id,!0,{})}catch(e){}finally{c(!1)}},j=async()=>{c(!0);try{await l(t.id,!1,{})}catch(e){}finally{c(!1)}};return p?(0,se.jsx)("div",{className:"border border-slate-200 bg-slate-50/50 rounded-lg p-4 space-y-3",children:(0,se.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900 mb-1",children:"Approval Required"}),(0,se.jsx)("div",{className:"text-sm text-slate-600",children:v?(0,se.jsxs)(se.Fragment,{children:["Update all"," ",(0,se.jsx)("span",{className:"font-mono text-xs bg-white px-1.5 py-0.5 rounded border border-slate-200",children:u})," records"]}):(0,se.jsxs)(se.Fragment,{children:["Update"," ",(0,se.jsx)("span",{className:"font-mono text-xs bg-white px-1.5 py-0.5 rounded border border-slate-200",children:u})," records matching:"]})})]}),!v&&(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Query:"}),(0,se.jsx)("pre",{className:"text-xs bg-white rounded-md p-3 text-slate-700 overflow-x-auto border border-slate-200",children:JSON.stringify(m,null,2)})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Update with:"}),(0,se.jsx)("pre",{className:"text-xs bg-white rounded-md p-3 text-slate-700 overflow-x-auto border border-slate-200",children:JSON.stringify(x,null,2)})]}),a?(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(zt,{size:"sm",onClick:b,disabled:o,className:"h-8 text-xs bg-slate-900 hover:bg-slate-800 disabled:opacity-50",children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 mr-1.5 animate-spin"}),"Approving..."]}):"Approve"}),(0,se.jsx)(zt,{size:"sm",variant:"outline",onClick:j,disabled:o,className:"h-8 text-xs border-slate-300 hover:bg-slate-50 disabled:opacity-50",children:"Reject"})]}):(0,se.jsx)("div",{className:"text-xs text-slate-500 italic",children:"This approval request is from a previous message"})]})]})}):(0,se.jsx)(kS,{icon:BS,status:d,isLastAssistantMessage:a,isLastRunningTool:n,onClick:()=>{null!=r&&r.id&&u&&i("/apps/".concat(r.id,"/editor/workspace/entity-").concat(u))},children:(0,se.jsxs)("div",{className:"flex items-center gap-2.5",children:[h?"Updating":g?"Updated":"Update"," ",v&&(h||g)?"all ":"",(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-1 bg-gray-200 text-gray-700 rounded font-[400] text-xs",children:u})," records",f&&t.requires_user_input&&(0,se.jsx)("span",{className:"text-slate-400 text-xs italic",children:"rejected"})]})})}const HS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,se.jsx)("path",{d:"M2.66683 14.6663H12.0002C12.3538 14.6663 12.6929 14.5259 12.943 14.2758C13.193 14.0258 13.3335 13.6866 13.3335 13.333V4.66634L10.0002 1.33301H4.00016C3.64654 1.33301 3.3074 1.47348 3.05735 1.72353C2.80731 1.97358 2.66683 2.31272 2.66683 2.66634V6.66634M9.3335 1.33301V3.99967C9.3335 4.3533 9.47397 4.69244 9.72402 4.94248C9.97407 5.19253 10.3132 5.33301 10.6668 5.33301H13.3335M6.66683 6.66634L3.66683 9.66634M6.00016 7.33301L6.66683 7.99967M4.00016 10.6663C4.00016 11.4027 3.40321 11.9997 2.66683 11.9997C1.93045 11.9997 1.3335 11.4027 1.3335 10.6663C1.3335 9.92996 1.93045 9.33301 2.66683 9.33301C3.40321 9.33301 4.00016 9.92996 4.00016 10.6663Z",stroke:"#9CA3AF",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function VS(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastRunningTool:n}=e;const{submitToolCallInput:l}=lp(),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)({}),d=t.status;let u=[];const m=null==s?void 0:s.secrets_schema;if("string"==typeof m)try{u=JSON.parse(m)}catch(b){u=[]}else Array.isArray(m)&&(u=m);const x="running"===d,h="waiting_for_user_input"===d,p="success"===d,g=async e=>{e.preventDefault(),i(!0);try{await l(t.id,!0,{secrets:o})}catch(s){}finally{i(!1)}},f=async()=>{i(!0);try{await l(t.id,!1,{})}catch(e){}finally{i(!1)}},v=(0,Y.useMemo)(()=>h?(0,se.jsx)("div",{className:"border-l-2 border-l-blue-500 bg-slate-50 p-4 space-y-3 ml-[11px]",children:(0,se.jsx)("div",{className:"flex items-start gap-2.5",children:(0,se.jsxs)("div",{className:"flex-1 min-w-0 space-y-3",children:[(0,se.jsx)("div",{children:(0,se.jsx)("div",{className:"text-sm text-slate-600 break-words",children:"Please provide the following secrets to continue"})}),Array.isArray(u)&&u.length>0&&a?(0,se.jsxs)("form",{onSubmit:g,className:"space-y-3",children:[u.map(e=>{const t=e.secretName;return(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsxs)(aN,{htmlFor:t,className:"text-xs font-medium text-slate-700",children:[t,(0,se.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),e.description&&(0,se.jsx)("p",{className:"text-xs text-slate-500",children:e.description}),(0,se.jsx)(Df,{id:t,type:"password",placeholder:"Enter ".concat(t),value:o[t]||"",onChange:e=>((e,t)=>{c(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))})(t,e.target.value),className:"text-xs h-8",disabled:r})]},t)}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Bx,{type:"submit",size:"sm",disabled:r,className:"h-8 text-xs bg-slate-900 hover:bg-slate-800 disabled:opacity-50",children:r?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 mr-1.5 animate-spin"}),"Submitting..."]}):"Submit Secrets"}),(0,se.jsx)(Bx,{type:"button",variant:"outline",size:"sm",onClick:f,disabled:r,className:"h-8 text-xs border-slate-300 hover:bg-slate-50 disabled:opacity-50",children:"Skip"})]})]}):a?(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"No secret fields defined in schema"}):(0,se.jsx)("div",{className:"text-xs text-slate-500 italic break-words",children:"This secrets request is from a previous message"})]})})}):null,[h,u,a,o,r,g,f]);return(0,se.jsx)(kS,{icon:HS,status:d,isLastAssistantMessage:a,isLastRunningTool:n,secondaryContent:v,children:(0,se.jsx)("div",{children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[x?"Setting secrets":p?"Set secret":"Set secrets"," ",Array.isArray(u)&&u.length>0&&(0,se.jsxs)("span",{className:"text-slate-400 text-xs",children:["\xb7 ",u.length," ",1===u.length?"field":"fields"]})]})})})}const WS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,se.jsx)("path",{d:"M9.33341 1.33301V3.99967C9.33341 4.3533 9.47389 4.69244 9.72394 4.94248C9.97399 5.19253 10.3131 5.33301 10.6667 5.33301H13.3334M6.66675 7.99967C6.48994 7.99967 6.32037 8.06991 6.19534 8.19494C6.07032 8.31996 6.00008 8.48953 6.00008 8.66634V9.33301C6.00008 9.50982 5.92984 9.67939 5.80482 9.80441C5.67979 9.92944 5.51023 9.99967 5.33341 9.99967C5.51023 9.99967 5.67979 10.0699 5.80482 10.1949C5.92984 10.32 6.00008 10.4895 6.00008 10.6663V11.333C6.00008 11.5098 6.07032 11.6794 6.19534 11.8044C6.32037 11.9294 6.48994 11.9997 6.66675 11.9997M9.33341 11.9997C9.51023 11.9997 9.67979 11.9294 9.80482 11.8044C9.92984 11.6794 10.0001 11.5098 10.0001 11.333V10.6663C10.0001 10.4895 10.0703 10.32 10.1953 10.1949C10.3204 10.0699 10.4899 9.99967 10.6667 9.99967C10.4899 9.99967 10.3204 9.92944 10.1953 9.80441C10.0703 9.67939 10.0001 9.50982 10.0001 9.33301V8.66634C10.0001 8.48953 9.92984 8.31996 9.80482 8.19494C9.67979 8.06991 9.51023 7.99967 9.33341 7.99967M10.0001 1.33301H4.00008C3.64646 1.33301 3.30732 1.47348 3.05727 1.72353C2.80722 1.97358 2.66675 2.31272 2.66675 2.66634V13.333C2.66675 13.6866 2.80722 14.0258 3.05727 14.2758C3.30732 14.5259 3.64646 14.6663 4.00008 14.6663H12.0001C12.3537 14.6663 12.6928 14.5259 12.9429 14.2758C13.1929 14.0258 13.3334 13.6866 13.3334 13.333V4.66634L10.0001 1.33301Z",stroke:"currentColor",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function qS(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastRunningTool:n}=e;const l=t.status,r=(null==s?void 0:s.url)||"",i=(null==s?void 0:s.formats)||["markdown"],o="running"===l,c=(()=>{try{return new URL(r).hostname.replace("www.","")}catch(e){return r}})();return(0,se.jsx)(kS,{icon:WS,status:l,isLastAssistantMessage:a,isLastRunningTool:n,children:(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[o?"Fetching":"Fetched"," ",(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-[2px] bg-gray-200 text-gray-700 rounded font-[400] text-xs",children:c})]}),i&&i.length>0&&(0,se.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:[1===i.length?"Format":"Formats",":"," ",i.map((e,t)=>(0,se.jsxs)("span",{children:[(0,se.jsx)("span",{className:"font-medium ml-1",children:e}),t<i.length-1&&", "]},t))]})]})})}const YS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,se.jsx)("path",{d:"M14.0001 14L11.1335 11.1333M12.6667 7.33333C12.6667 10.2789 10.2789 12.6667 7.33333 12.6667C4.38781 12.6667 2 10.2789 2 7.33333C2 4.38781 4.38781 2 7.33333 2C10.2789 2 12.6667 4.38781 12.6667 7.33333Z",stroke:"#9CA3AF",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function GS(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastRunningTool:n}=e;const l=t.status,r=(null==s?void 0:s.query)||"",i="running"===l,o="success"===l,c=(()=>{if(!t.results)return null;try{const e="string"==typeof t.results?t.results:JSON.stringify(t.results);return(e.match(/----------/g)||[]).length}catch(e){return null}})();return(0,se.jsx)(kS,{icon:YS,status:l,isLastAssistantMessage:a,isLastRunningTool:n,children:(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[i?"Searching":"Searched"," for"," ",(0,se.jsxs)("span",{className:"flex items-center justify-center gap-2.5 px-1 bg-gray-100 text-gray-700 rounded font-[400] text-xs",children:['"',r,'"']})]}),o&&null!==c&&(0,se.jsxs)("div",{className:"mt-1 text-gray-500 text-xs",children:["Found ",c," ",1===c?"result":"results"]})]})})}const KS=e=>{let{className:t}=e;return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,se.jsx)("path",{d:"M9.33341 1.33301V3.99967C9.33341 4.3533 9.47389 4.69244 9.72394 4.94248C9.97399 5.19253 10.3131 5.33301 10.6667 5.33301H13.3334M6.66675 7.99967C6.48994 7.99967 6.32037 8.06991 6.19534 8.19494C6.07032 8.31996 6.00008 8.48953 6.00008 8.66634V9.33301C6.00008 9.50982 5.92984 9.67939 5.80482 9.80441C5.67979 9.92944 5.51023 9.99967 5.33341 9.99967C5.51023 9.99967 5.67979 10.0699 5.80482 10.1949C5.92984 10.32 6.00008 10.4895 6.00008 10.6663V11.333C6.00008 11.5098 6.07032 11.6794 6.19534 11.8044C6.32037 11.9294 6.48994 11.9997 6.66675 11.9997M9.33341 11.9997C9.51023 11.9997 9.67979 11.9294 9.80482 11.8044C9.92984 11.6794 10.0001 11.5098 10.0001 11.333V10.6663C10.0001 10.4895 10.0703 10.32 10.1953 10.1949C10.3204 10.0699 10.4899 9.99967 10.6667 9.99967C10.4899 9.99967 10.3204 9.92944 10.1953 9.80441C10.0703 9.67939 10.0001 9.50982 10.0001 9.33301V8.66634C10.0001 8.48953 9.92984 8.31996 9.80482 8.19494C9.67979 8.06991 9.51023 7.99967 9.33341 7.99967M10.0001 1.33301H4.00008C3.64646 1.33301 3.30732 1.47348 3.05727 1.72353C2.80722 1.97358 2.66675 2.31272 2.66675 2.66634V13.333C2.66675 13.6866 2.80722 14.0258 3.05727 14.2758C3.30732 14.5259 3.64646 14.6663 4.00008 14.6663H12.0001C12.3537 14.6663 12.6928 14.5259 12.9429 14.2758C13.1929 14.0258 13.3334 13.6866 13.3334 13.333V4.66634L10.0001 1.33301Z",stroke:"currentColor",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function $S(e){let{toolCalls:t,filePath:s,messageId:a,isLastAssistantMessage:n,isLastRunningTool:l}=e;const r=(0,J.Zp)(),{app:i}=lp();if(!t||!Array.isArray(t)||0===t.length)return null;const o=t.every(e=>"success"===e.status),c=t.some(e=>"running"===e.status),d=t.some(e=>"error"===e.status||"failed"===e.status),u=c?"running":d?"error":o?"success":"pending",m=CS(s),x="running"===u,h={input:t.map(e=>{try{return e.arguments_string?JSON.parse(e.arguments_string):null}catch(t){return null}}),output:t.map(e=>{try{return"string"==typeof e.results?JSON.parse(e.results):e.results}catch(t){return e.results}})};return(0,se.jsx)(kS,{icon:KS,status:u,isLastAssistantMessage:n,isLastRunningTool:l,onClick:()=>{const e=AS(s,null==i?void 0:i.id);e&&r(e)},messageId:a,showViewChanges:!0,debugInfo:h,children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[x?"Editing":"Edited"," ",(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-[2px] bg-gray-200 text-gray-700 rounded font-[400] text-xs",children:"file"===m?"":m})]})})}var ZS=s(93249);class JS extends te.H{getBaseURL(){return"/apps"}async listIntegrations(e){return this.axios.get("/".concat(e,"/external-auth/list"))}async disconnectIntegration(e,t){await this.axios.delete("/".concat(e,"/external-auth/integrations/").concat(t))}async removeIntegration(e,t){await this.axios.delete("/".concat(e,"/external-auth/integrations/").concat(t,"/remove"))}initiateOAuthConnection(e,t){return this.axios.post("/".concat(e,"/external-auth/initiate"),t)}getIntegrationStatus(e,t,s){return this.axios.get("/".concat(e,"/external-auth/status"),{params:{integration_type:t,connection_id:s}})}getIntegrationSuggestions(e,t){return this.axios.get("/".concat(e,"/external-auth/suggestions/").concat(t))}}const QS=new JS,XS="Integration Initiated",eE="Integration Result",tE="Disconnect Integration",sE="Remove Integration",aE="Connectors Upgrade Overlay Viewed",nE="Connector Use Clicked",lE="Connector Prompt Clicked",rE="integration initiated",iE="integration already authorized",oE="integration error",cE="integration popup blocked",dE="integration success",uE="integration failed",mE="integration canceled",xE="integration timeout",hE="disconnect integration",pE="disconnect integration failed",gE="remove integration",fE="remove integration failed",vE="connectors upgrade overlay view",bE="connector use",jE="connector prompt select",yE="auth_integrations";function NE(e,t,s,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const l=(0,ue.A)((0,ue.A)((0,ue.A)({},s),a),n);var r;Tu(e,l),Vu(s,(0,ue.A)((0,ue.A)({cta:t,origin:(r=a.source,r.toLowerCase().replace(" ","_")),target_route:null},a),n))}function wE(e,t,s,a,n){const l={user_id:e,app_id:t,conversation_id:null},r=(0,ue.A)({integration_type:s,status:a},n&&{error:n});Tu(sE,(0,ue.A)((0,ue.A)({},l),r));const i="Success"===a?gE:fE;Vu(l,(0,ue.A)({cta:i,origin:yE,target_route:null},r))}function _E(e,t,s,a,n){const l={user_id:e,app_id:t,conversation_id:null},r=(0,ue.A)({integration_type:s,status:a},n&&{error:n});Tu(tE,(0,ue.A)((0,ue.A)({},l),r));const i="Success"===a?hE:pE;Vu(l,(0,ue.A)({cta:i,origin:yE,target_route:null},r))}function kE(e,t,s,a,n){const l="use"===a?nE:lE,r="use"===a?bE:jE,i=(0,ue.A)({connector_id:t,connector_name:s},n&&{prompt_text:n});Tu(l,(0,ue.A)((0,ue.A)({},e),i)),Vu(e,(0,ue.A)({cta:r,origin:yE,target_route:null},i))}const CE="SUCCESS";async function AE(e){const{appId:t,integrationType:s,scopes:a=null,forceReconnect:n=!1,onSuccess:l,onError:r,onCancel:i,trackingContext:o}=e,c=o||{source:"Chat",userId:null,conversationId:null,messageId:null,prompt:null,isInitialMessage:null},d={user_id:c.userId,app_id:t,conversation_id:c.conversationId},u={integration_type:s,scopes:a||[],source:c.source,message_id:c.messageId,prompt:c.prompt,is_initial_message:c.isInitialMessage};let m=null,x=null,h=!1,p=null;const g=()=>{m&&(clearInterval(m),m=null),x&&!x.closed&&x.close(),p&&(window.removeEventListener("message",p),p=null)};try{NE(XS,rE,d,u);const e=await QS.initiateOAuthConnection(t,{integration_type:s,scopes:a,force_reconnect:n});if(e.already_authorized)return NE(eE,iE,d,u,{status:"Success"}),await l(),null;if(e.error)return NE(eE,oE,d,u,{status:"Failed",error:e.error}),"different_user"===e.error?(await r({type:"different_user",message:e.error_message||"This integration is already connected by a different user.",userEmail:e.other_user_email,retryable:!1}),null):(await r({type:"unknown_error",message:e.error_message||"An error occurred",retryable:!0}),null);const o=600,c=700,f=window.screen.width/2-o/2,v=window.screen.height/2-c/2;if(x=window.open(e.redirect_url,"oauth_authorization","width=".concat(o,",height=").concat(c,",left=").concat(f,",top=").concat(v,",toolbar=no,menubar=no,location=no")),!x||x.closed||void 0===x.closed)return NE(eE,cE,d,u,{status:"Failed",error:"popup_blocked"}),await r({type:"popup_blocked",message:"Popup was blocked by your browser. Please allow popups for this site and try again.",retryable:!0}),null;p=async e=>{if(e.data&&"oauth_callback"===e.data.type){const{status:t,message:s}=e.data;h=!0,g(),t===CE?(NE(eE,dE,d,u,{status:"Success"}),await l()):(NE(eE,uE,d,u,{status:"Failed",error:t}),await r({type:"connection_failed",message:s||"OAuth connection failed.",retryable:!0}))}},window.addEventListener("message",p);const b=80;let j=0;return m=setInterval(async()=>{if(j++,!h){try{const a=await QS.getIntegrationStatus(t,s,e.connection_id);if("ACTIVE"===a.status)return g(),void(h||(NE(eE,dE,d,u,{status:"Success"}),await l()));if("FAILED"===a.status)return g(),void(h||(NE(eE,uE,d,u,{status:"Failed",error:"connection_failed"}),await r({type:"connection_failed",message:"OAuth connection failed.",retryable:!0})))}catch(a){}return x&&x.closed?(g(),void(h||(NE(eE,mE,d,u,{status:"Canceled"}),await i()))):j>=b?(g(),NE(eE,xE,d,u,{status:"Failed",error:"timeout"}),void await r({type:"timeout",message:"Connection timed out after 2 minutes.",retryable:!0})):void 0}g()},1500),g}catch(v){var f;g();const e=null!==(f=v.response)&&void 0!==f&&f.status?"http_".concat(v.response.status):"network_error";if(NE(eE,oE,d,u,{status:"Failed",error:e}),v.response){const e=v.response.status;if(422===e)return await r({type:"validation_error",message:"Invalid request.",statusCode:e,retryable:!1}),null;if(400===e)return await r({type:"validation_error",message:"Bad request.",statusCode:e,retryable:!1}),null;if(e>=500)return await r({type:"network_error",message:"Server error. Please try again later.",statusCode:e,retryable:!0}),null;await r({type:"network_error",message:v.message||"An error occurred",statusCode:e,retryable:!0})}else await r({type:"network_error",message:v.message||"Network error. Please check your connection.",retryable:!0});return null}}const SE=e=>{let{className:t}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128",className:t,children:[(0,se.jsx)("rect",{width:"128",height:"128",rx:"16",fill:"#635BFF"}),(0,se.jsx)("path",{fill:"#ffffff",d:"M64 45.9c-6.1 0-10 2.4-10 6.5 0 5 5.4 6.9 12.2 8.4 9.7 2.2 20.8 5 20.8 16.8 0 11.1-9.2 16.4-21.9 16.4-6.3 0-13.3-1.6-20.1-5.5l2.9-8.6c5.4 3.1 11.5 5.1 17.2 5.1 6.6 0 10.8-2.4 10.8-6.8 0-5.5-5.7-7.3-12.9-9-9.5-2.3-20-5.3-20-16.4 0-10.8 9.1-16.2 21-16.2 5.6 0 11.6 1.1 17.1 3.8l-2.8 8.5c-4.5-2.2-9.8-3.5-14.3-3.5z"})]})},EE=[{id:"stripe",name:"Stripe",description:"Accept payments, manage subscriptions, and handle checkout flows.",subtitle:"Sell products or subscriptions and get paid online.",icon:SE,category:"Payments",status:"active"},{id:"salesforce",name:"Salesforce",description:"Connect with Salesforce to manage leads, opportunities, and customer data.",subtitle:"Automate and sync CRM records.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0.5 -149.38 999 999",className:t,children:[(0,se.jsx)("path",{fill:"#00A1E0",d:"M416.224 76.763c32.219-33.57 77.074-54.391 126.682-54.391 65.946 0 123.48 36.772 154.12 91.361 26.626-11.896 56.098-18.514 87.106-18.514 118.94 0 215.368 97.268 215.368 217.247 0 119.993-96.428 217.261-215.368 217.261a213.735 213.735 0 0 1-42.422-4.227c-26.981 48.128-78.397 80.646-137.412 80.646-24.705 0-48.072-5.706-68.877-15.853-27.352 64.337-91.077 109.448-165.348 109.448-77.344 0-143.261-48.939-168.563-117.574-11.057 2.348-22.513 3.572-34.268 3.572C75.155 585.74.5 510.317.5 417.262c0-62.359 33.542-116.807 83.378-145.937-10.26-23.608-15.967-49.665-15.967-77.06C67.911 87.25 154.79.5 261.948.5c62.914 0 118.827 29.913 154.276 76.263"}),(0,se.jsx)("path",{fill:"#FFF",d:"M145.196 363.11c-.626 1.637.228 1.979.427 2.263 1.878 1.366 3.786 2.349 5.707 3.444 10.189 5.407 19.81 6.986 29.871 6.986 20.492 0 33.214-10.9 33.214-28.447v-.341c0-16.224-14.358-22.115-27.835-26.37l-1.75-.569c-10.161-3.302-18.927-6.147-18.927-12.836v-.355c0-5.721 5.123-9.934 13.064-9.934 8.823 0 19.297 2.932 26.042 6.66 0 0 1.978 1.281 2.704-.64.398-1.025 3.814-10.218 4.17-11.214.384-1.082-.299-1.879-.996-2.306-7.699-4.682-18.344-7.884-29.358-7.884l-2.049.014c-18.756 0-31.848 11.328-31.848 27.565v.342c0 17.119 14.444 22.669 27.978 26.54l2.177.669c9.862 3.031 18.358 5.635 18.358 12.58v.342c0 6.347-5.521 11.071-14.43 11.071-3.458 0-14.487-.071-26.398-7.6-1.438-.84-2.277-1.451-3.387-2.12-.583-.37-2.049-1.011-2.689.925l-4.045 11.215zM445.194 363.11c-.626 1.637.228 1.979.427 2.263 1.878 1.366 3.786 2.349 5.706 3.444 10.189 5.407 19.811 6.986 29.871 6.986 20.492 0 33.215-10.9 33.215-28.447v-.341c0-16.224-14.359-22.115-27.836-26.37l-1.75-.569c-10.161-3.302-18.928-6.147-18.928-12.836v-.355c0-5.721 5.123-9.934 13.064-9.934 8.823 0 19.297 2.932 26.043 6.66 0 0 1.978 1.281 2.703-.64.398-1.025 3.814-10.218 4.17-11.214.385-1.082-.299-1.879-.996-2.306-7.699-4.682-18.344-7.884-29.358-7.884l-2.05.014c-18.756 0-31.848 11.328-31.848 27.565v.342c0 17.119 14.444 22.669 27.978 26.54l2.177.669c9.862 3.031 18.373 5.635 18.373 12.58v.342c0 6.347-5.536 11.071-14.445 11.071-3.457 0-14.486-.071-26.397-7.6-1.438-.84-2.291-1.423-3.372-2.12-.371-.242-2.107-.911-2.705.925l-4.042 11.215zM649.995 328.74c0 9.919-1.85 17.731-5.493 23.253-3.601 5.465-9.051 8.126-16.649 8.126-7.613 0-13.035-2.647-16.579-8.126-3.587-5.507-5.407-13.334-5.407-23.253 0-9.904 1.82-17.703 5.407-23.168 3.544-5.407 8.966-8.04 16.579-8.04 7.599 0 13.049 2.633 16.664 8.04 3.629 5.464 5.478 13.263 5.478 23.168m17.106-18.386c-1.68-5.679-4.298-10.688-7.784-14.857-3.487-4.184-7.898-7.542-13.136-9.99-5.223-2.433-11.398-3.671-18.328-3.671-6.945 0-13.121 1.238-18.344 3.671-5.237 2.448-9.648 5.807-13.149 9.99-3.472 4.184-6.091 9.193-7.784 14.857-1.665 5.649-2.505 11.825-2.505 18.386s.84 12.751 2.505 18.386c1.693 5.664 4.298 10.674 7.799 14.857 3.486 4.184 7.912 7.528 13.135 9.904 5.236 2.377 11.398 3.586 18.344 3.586 6.93 0 13.092-1.209 18.328-3.586 5.223-2.376 9.648-5.721 13.136-9.904 3.486-4.17 6.104-9.179 7.784-14.857 1.68-5.649 2.519-11.84 2.519-18.386s-.841-12.737-2.52-18.386M807.568 357.47c-.569-1.665-2.177-1.039-2.177-1.039-2.49.954-5.138 1.836-7.955 2.277-2.861.44-6.006.669-9.379.669-8.281 0-14.856-2.462-19.566-7.329-4.725-4.867-7.372-12.736-7.344-23.381.029-9.691 2.362-16.978 6.561-22.527 4.17-5.521 10.517-8.354 18.984-8.354 7.059 0 12.438.811 18.072 2.59 0 0 1.352.583 1.992-1.181 1.494-4.156 2.604-7.13 4.198-11.698.456-1.295-.654-1.85-1.053-2.007-2.22-.868-7.457-2.276-11.413-2.874-3.7-.569-8.026-.868-12.836-.868-7.188 0-13.591 1.224-19.069 3.672-5.465 2.433-10.104 5.791-13.775 9.976-3.672 4.184-6.461 9.192-8.325 14.856-1.85 5.649-2.789 11.854-2.789 18.415 0 14.188 3.828 25.657 11.385 34.054 7.57 8.425 18.941 12.708 33.77 12.708 8.766 0 17.76-1.778 24.221-4.326 0 0 1.238-.598.697-2.034l-4.199-11.599zM837.497 319.238c.811-5.507 2.334-10.09 4.682-13.661 3.544-5.422 8.951-8.396 16.551-8.396s12.623 2.988 16.223 8.396c2.391 3.571 3.43 8.354 3.843 13.661h-41.299zm57.592-12.111c-1.451-5.479-5.052-11.015-7.414-13.548-3.729-4.013-7.371-6.816-10.986-8.382-4.725-2.021-10.389-3.358-16.593-3.358-7.229 0-13.79 1.21-19.112 3.714-5.336 2.505-9.818 5.921-13.334 10.176-3.516 4.24-6.162 9.292-7.842 15.027-1.693 5.707-2.547 11.926-2.547 18.485 0 6.675.883 12.894 2.633 18.486 1.765 5.636 4.582 10.602 8.396 14.714 3.799 4.142 8.695 7.387 14.558 9.648 5.821 2.249 12.894 3.416 21.019 3.401 16.722-.057 25.53-3.785 29.159-5.792.641-.355 1.253-.981.483-2.774l-3.785-10.603c-.568-1.579-2.177-.996-2.177-.996-4.142 1.537-10.032 4.298-23.766 4.27-8.979-.014-15.64-2.661-19.81-6.803-4.283-4.24-6.375-10.474-6.745-19.268l57.905.057s1.522-.028 1.68-1.509c.057-.624 1.993-11.895-1.722-24.945M373.762 319.238c.825-5.507 2.334-10.09 4.682-13.661 3.543-5.422 8.951-8.396 16.55-8.396s12.623 2.988 16.237 8.396c2.376 3.571 3.415 8.354 3.828 13.661h-41.297zm57.577-12.111c-1.451-5.479-5.037-11.015-7.399-13.548-3.729-4.013-7.372-6.816-10.986-8.382-4.725-2.021-10.388-3.358-16.593-3.358-7.215 0-13.79 1.21-19.112 3.714-5.336 2.505-9.819 5.921-13.334 10.176-3.515 4.24-6.162 9.292-7.841 15.027-1.679 5.707-2.547 11.926-2.547 18.485 0 6.675.882 12.894 2.633 18.486 1.765 5.636 4.583 10.602 8.396 14.714 3.8 4.142 8.695 7.387 14.558 9.648 5.821 2.249 12.893 3.416 21.019 3.401 16.721-.057 25.53-3.785 29.159-5.792.641-.355 1.252-.981.484-2.774l-3.771-10.603c-.584-1.579-2.191-.996-2.191-.996-4.141 1.537-10.019 4.298-23.78 4.27-8.965-.014-15.625-2.661-19.795-6.803-4.284-4.24-6.375-10.474-6.746-19.268l57.905.057s1.522-.028 1.679-1.509c.055-.624 1.99-11.895-1.738-24.945M248.601 357.153c-2.263-1.808-2.576-2.263-3.344-3.43-1.139-1.779-1.722-4.312-1.722-7.528 0-5.095 1.679-8.752 5.166-11.214-.042.015 4.981-4.34 16.792-4.184 8.296.114 15.71 1.338 15.71 1.338v26.327h.014s-7.357 1.579-15.639 2.077c-11.783.712-17.02-3.4-16.977-3.386m23.039-40.686c-2.348-.171-5.394-.271-9.037-.271-4.966 0-9.762.626-14.259 1.836-4.525 1.209-8.595 3.103-12.096 5.606a27.927 27.927 0 0 0-8.396 9.549c-2.049 3.814-3.088 8.311-3.088 13.349 0 5.123.882 9.577 2.647 13.221 1.765 3.657 4.312 6.702 7.556 9.051 3.216 2.348 7.187 4.069 11.797 5.108 4.54 1.039 9.691 1.565 15.327 1.565 5.934 0 11.854-.483 17.589-1.466 5.678-.968 12.651-2.377 14.586-2.817a146.25 146.25 0 0 0 4.056-1.039c1.438-.355 1.324-1.893 1.324-1.893l-.029-52.952c0-11.613-3.102-20.223-9.207-25.559-6.077-5.322-15.028-8.013-26.597-8.013-4.341 0-11.328.599-15.512 1.438 0 0-12.651 2.448-17.86 6.518 0 0-1.138.712-.512 2.306l4.099 11.015c.512 1.423 1.893.939 1.893.939s.441-.171.954-.47c11.143-6.062 25.231-5.877 25.231-5.877 6.262 0 11.072 1.252 14.316 3.742 3.159 2.419 4.767 6.076 4.767 13.789v2.448c-4.981-.711-9.549-1.123-9.549-1.123M738.669 286.631c.44-1.31-.484-1.936-.869-2.078-.981-.384-5.905-1.423-9.705-1.665-7.271-.441-11.312.783-14.928 2.405-3.586 1.622-7.57 4.24-9.791 7.215v-7.044c0-.982-.697-1.765-1.665-1.765h-14.843c-.967 0-1.664.782-1.664 1.765v86.366c0 .968.797 1.765 1.764 1.765h15.213a1.76 1.76 0 0 0 1.75-1.765v-43.147c0-5.792.641-11.569 1.922-15.198 1.252-3.587 2.96-6.461 5.066-8.525 2.12-2.049 4.525-3.486 7.158-4.297 2.689-.826 5.663-1.096 7.77-1.096 3.031 0 6.361.782 6.361.782 1.109.128 1.736-.555 2.105-1.565.997-2.647 3.815-10.574 4.356-12.153"}),(0,se.jsx)("path",{fill:"#FFF",d:"M595.874 246.603c-1.85-.569-3.529-.954-5.721-1.366-2.221-.398-4.867-.598-7.869-.598-10.475 0-18.729 2.96-24.52 8.794-5.764 5.807-9.678 14.644-11.642 26.271l-.712 3.913h-13.148s-1.594-.057-1.936 1.68l-2.148 12.053c-.157 1.139.342 1.864 1.878 1.864h12.794l-12.979 72.463c-1.011 5.835-2.178 10.631-3.473 14.273-1.267 3.587-2.504 6.276-4.041 8.24-1.48 1.879-2.875 3.273-5.295 4.084-1.992.669-4.297.982-6.816.982-1.395 0-3.258-.229-4.639-.513-1.366-.271-2.092-.569-3.131-1.011 0 0-1.494-.568-2.092.926-.47 1.238-3.885 10.615-4.298 11.769-.398 1.152.171 2.049.896 2.319 1.708.598 2.974.996 5.294 1.551 3.217.755 5.934.797 8.481.797 5.322 0 10.189-.754 14.217-2.205 4.042-1.466 7.57-4.014 10.701-7.457 3.373-3.729 5.493-7.628 7.515-12.964 2.006-5.266 3.729-11.812 5.094-19.439l13.05-73.815h19.069s1.607.057 1.936-1.693l2.162-12.039c.143-1.152-.341-1.864-1.893-1.864h-18.514c.1-.412.939-6.931 3.06-13.063.911-2.604 2.618-4.725 4.056-6.177 1.424-1.423 3.06-2.433 4.854-3.017 1.835-.598 3.928-.882 6.219-.882 1.736 0 3.457.199 4.752.469 1.793.385 2.49.584 2.961.727 1.893.569 2.148.014 2.519-.896l4.426-12.153c.455-1.312-.669-1.867-1.067-2.023M337.194 371.834c0 .968-.697 1.751-1.665 1.751h-15.355c-.968 0-1.651-.783-1.651-1.751v-123.58c0-.967.683-1.75 1.651-1.75h15.355c.968 0 1.665.783 1.665 1.75v123.58z"})]})},category:"CRM",status:"active"},{id:"slack",name:"Slack",description:"Send notifications, messages, and updates directly to your Slack channels and users.",subtitle:"Send updates and notifications to your team.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128",className:t,children:[(0,se.jsx)("path",{fill:"#de1c59",d:"M27.255 80.719c0 7.33-5.978 13.317-13.309 13.317S.63 88.049.63 80.719s5.987-13.317 13.317-13.317h13.309zm6.709 0c0-7.33 5.987-13.317 13.317-13.317s13.317 5.986 13.317 13.317v33.335c0 7.33-5.986 13.317-13.317 13.317c-7.33 0-13.317-5.987-13.317-13.317zm0 0"}),(0,se.jsx)("path",{fill:"#35c5f0",d:"M47.281 27.255c-7.33 0-13.317-5.978-13.317-13.309S39.951.63 47.281.63s13.317 5.987 13.317 13.317v13.309zm0 6.709c7.33 0 13.317 5.987 13.317 13.317s-5.986 13.317-13.317 13.317H13.946C6.616 60.598.63 54.612.63 47.281c0-7.33 5.987-13.317 13.317-13.317zm0 0"}),(0,se.jsx)("path",{fill:"#2eb57d",d:"M100.745 47.281c0-7.33 5.978-13.317 13.309-13.317s13.317 5.987 13.317 13.317s-5.987 13.317-13.317 13.317h-13.309zm-6.709 0c0 7.33-5.987 13.317-13.317 13.317s-13.317-5.986-13.317-13.317V13.946C67.402 6.616 73.388.63 80.719.63c7.33 0 13.317 5.987 13.317 13.317zm0 0"}),(0,se.jsx)("path",{fill:"#ebb02e",d:"M80.719 100.745c7.33 0 13.317 5.978 13.317 13.309s-5.987 13.317-13.317 13.317s-13.317-5.987-13.317-13.317v-13.309zm0-6.709c-7.33 0-13.317-5.987-13.317-13.317s5.986-13.317 13.317-13.317h33.335c7.33 0 13.317 5.986 13.317 13.317c0 7.33-5.987 13.317-13.317 13.317zm0 0"})]})},category:"Communication",status:"active"},{id:"notion",name:"Notion",description:"Create, update, and manage pages, databases, and content in your Notion workspace.",subtitle:"Organize and sync knowledge or project data.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-10 h-10",viewBox:"0 0 256 256",children:[(0,se.jsx)("path",{fill:"#fff",d:"M16.092 11.538L164.09.608c18.179-1.56 22.85-.508 34.28 7.801l47.243 33.282C253.406 47.414 256 48.975 256 55.207v182.527c0 11.439-4.155 18.205-18.696 19.24L65.44 267.378c-10.913.517-16.11-1.043-21.825-8.327L8.826 213.814C2.586 205.487 0 199.254 0 191.97V29.726c0-9.352 4.155-17.153 16.092-18.188"}),(0,se.jsx)("path",{d:"M164.09.608L16.092 11.538C4.155 12.573 0 20.374 0 29.726v162.245c0 7.284 2.585 13.516 8.826 21.843l34.789 45.237c5.715 7.284 10.912 8.844 21.825 8.327l171.864-10.404c14.532-1.035 18.696-7.801 18.696-19.24V55.207c0-5.911-2.336-7.614-9.21-12.66l-1.185-.856L198.37 8.409C186.94.1 182.27-.952 164.09.608M69.327 52.22c-14.033.945-17.216 1.159-25.186-5.323L23.876 30.778c-2.06-2.086-1.026-4.69 4.163-5.207l142.274-10.395c11.947-1.043 18.17 3.12 22.842 6.758l24.401 17.68c1.043.525 3.638 3.637.517 3.637L71.146 52.095zm-16.36 183.954V81.222c0-6.767 2.077-9.887 8.3-10.413L230.02 60.93c5.724-.517 8.31 3.12 8.31 9.879v153.917c0 6.767-1.044 12.49-10.387 13.008l-161.487 9.361c-9.343.517-13.489-2.594-13.489-10.921M212.377 89.53c1.034 4.681 0 9.362-4.681 9.897l-7.783 1.542v114.404c-6.758 3.637-12.981 5.715-18.18 5.715c-8.308 0-10.386-2.604-16.609-10.396l-50.898-80.079v77.476l16.1 3.646s0 9.362-12.989 9.362l-35.814 2.077c-1.043-2.086 0-7.284 3.63-8.318l9.351-2.595V109.823l-12.98-1.052c-1.044-4.68 1.55-11.439 8.826-11.965l38.426-2.585l52.958 81.113v-71.76l-13.498-1.552c-1.043-5.733 3.111-9.896 8.3-10.404z"})]})},category:"Productivity",status:"active"},{id:"googlecalendar",name:"Google Calendar",description:"Create, update, and manage events and schedules in your Google Calendar.",subtitle:"Manage your schedule and calendar events.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",className:t,children:[(0,se.jsx)("path",{fill:"#fff",d:"M195.368 60.632H60.632v134.736h134.736z"}),(0,se.jsx)("path",{fill:"#ea4335",d:"M195.368 256L256 195.368l-30.316-5.172l-30.316 5.172l-5.533 27.73z"}),(0,se.jsx)("path",{fill:"#188038",d:"M0 195.368v40.421C0 246.956 9.044 256 20.21 256h40.422l6.225-30.316l-6.225-30.316l-33.033-5.172z"}),(0,se.jsx)("path",{fill:"#1967d2",d:"M256 60.632V20.21C256 9.044 246.956 0 235.79 0h-40.422q-5.532 22.554-5.533 33.196q0 10.641 5.533 27.436q20.115 5.76 30.316 5.76T256 60.631"}),(0,se.jsx)("path",{fill:"#fbbc04",d:"M256 60.632h-60.632v134.736H256z"}),(0,se.jsx)("path",{fill:"#34a853",d:"M195.368 195.368H60.632V256h134.736z"}),(0,se.jsx)("path",{fill:"#4285f4",d:"M195.368 0H20.211C9.044 0 0 9.044 0 20.21v175.158h60.632V60.632h134.736z"}),(0,se.jsx)("path",{fill:"#4285f4",d:"M88.27 165.154c-5.036-3.402-8.523-8.37-10.426-14.94l11.689-4.816q1.59 6.063 5.558 9.398c2.627 2.223 5.827 3.318 9.566 3.318q5.734 0 9.852-3.487c2.746-2.324 4.127-5.288 4.127-8.875q0-5.508-4.345-8.994c-2.897-2.324-6.535-3.486-10.88-3.486h-6.754v-11.57h6.063q5.608 0 9.448-3.033c2.56-2.02 3.84-4.783 3.84-8.303c0-3.132-1.145-5.625-3.435-7.494c-2.29-1.87-5.188-2.813-8.708-2.813c-3.436 0-6.164.91-8.185 2.745a16.1 16.1 0 0 0-4.413 6.754l-11.57-4.817c1.532-4.345 4.345-8.185 8.471-11.503s9.398-4.985 15.798-4.985c4.733 0 8.994.91 12.767 2.745c3.772 1.836 6.736 4.379 8.875 7.613c2.14 3.25 3.2 6.888 3.2 10.93c0 4.126-.993 7.613-2.98 10.476s-4.43 5.052-7.327 6.585v.69a22.25 22.25 0 0 1 9.398 7.327c2.442 3.284 3.672 7.208 3.672 11.79c0 4.58-1.163 8.673-3.487 12.26c-2.324 3.588-5.54 6.417-9.617 8.472c-4.092 2.055-8.69 3.1-13.793 3.1c-5.912.016-11.369-1.685-16.405-5.087m71.797-58.005l-12.833 9.28l-6.417-9.734l23.023-16.607h8.825v78.333h-12.598z"})]})},category:"Productivity",status:"active"},{id:"googledrive",name:"Google Drive",description:"Upload and save files created by your app to Google Drive.",subtitle:"Export and back up app-generated files.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{viewBox:"0 0 112 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,se.jsxs)("g",{"clip-path":"url(#clip0_1:142)",children:[" 1Code has comments. Press enter to view.",(0,se.jsx)("path",{d:"M8.46154 85.7051L13.3974 94.2308C14.4231 96.0256 15.8974 97.4359 17.6282 98.4615L35.2564 67.9487H0C0 69.9359 0.512821 71.9231 1.53846 73.7179L8.46154 85.7051Z",fill:"#0066DA"}),(0,se.jsx)("path",{d:"M55.9615 32.0513L38.3333 1.53846C36.6026 2.5641 35.1282 3.97436 34.1026 5.76923L1.53846 62.1795C0.531683 63.9357 0.00134047 65.9244 0 67.9487H35.2564L55.9615 32.0513Z",fill:"#00AC47"}),(0,se.jsx)("path",{d:"M94.2949 98.4615C96.0256 97.4359 97.5 96.0256 98.5256 94.2308L100.577 90.7051L110.385 73.7179C111.41 71.9231 111.923 69.9359 111.923 67.9487H76.6641L84.1667 82.6923L94.2949 98.4615Z",fill:"#EA4335"}),(0,se.jsx)("path",{d:"M55.9615 32.0513L73.5898 1.53846C71.859 0.512821 69.8718 0 67.8205 0H44.1026C42.0513 0 40.0641 0.576923 38.3333 1.53846L55.9615 32.0513Z",fill:"#00832D"}),(0,se.jsx)("path",{d:"M76.6667 67.9487H35.2564L17.6282 98.4615C19.359 99.4872 21.3462 100 23.3974 100H88.5256C90.5769 100 92.5641 99.4231 94.2949 98.4615L76.6667 67.9487Z",fill:"#2684FC"}),(0,se.jsx)("path",{d:"M94.1026 33.9744L77.8205 5.76923C76.7949 3.97436 75.3205 2.5641 73.5897 1.53846L55.9615 32.0513L76.6667 67.9487H111.859C111.859 65.9615 111.346 63.9744 110.321 62.1795L94.1026 33.9744Z",fill:"#FFBA00"})]}),(0,se.jsx)("defs",{children:(0,se.jsx)("clipPath",{id:"clip0_1:142",children:(0,se.jsx)("rect",{width:"111.923",height:"100",fill:"white"})})})]})},category:"Productivity",status:"active"},{id:"gmail",name:"Gmail",description:"Send, read, and manage emails programmatically with Gmail.",subtitle:"Automate email sending and inbox management.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"2 6 44 36",className:t,children:[(0,se.jsx)("path",{fill:"#4caf50",d:"M45,16.2l-5,2.75l-5,4.75L35,40h7c1.657,0,3-1.343,3-3V16.2z"}),(0,se.jsx)("path",{fill:"#1e88e5",d:"M3,16.2l3.614,1.71L13,23.7V40H6c-1.657,0-3-1.343-3-3V16.2z"}),(0,se.jsx)("polygon",{fill:"#e53935",points:"35,11.2 24,19.45 13,11.2 12,17 13,23.7 24,31.95 35,23.7 36,17"}),(0,se.jsx)("path",{fill:"#c62828",d:"M3,12.298V16.2l10,7.5V11.2L9.876,8.859C9.132,8.301,8.228,8,7.298,8h0C4.924,8,3,9.924,3,12.298z"}),(0,se.jsx)("path",{fill:"#fbc02d",d:"M45,12.298V16.2l-10,7.5V11.2l3.124-2.341C38.868,8.301,39.772,8,40.702,8h0 C43.076,8,45,9.924,45,12.298z"})]})},category:"Communication",status:"active"},{id:"googlesheets",name:"Google Sheets",description:"Read, write, and update data in your Google Sheets spreadsheets.",subtitle:"Sync and manage spreadsheet data.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{viewBox:"0 0 74 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,se.jsx)("mask",{id:"mask0_1:52",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"1",width:"71",height:"98",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask0_1:52)",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L56.4365 16.8843L45.398 1.43036Z",fill:"#0F9D58"})}),(0,se.jsx)("mask",{id:"mask1_1:52",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"1",width:"71",height:"98",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask1_1:52)",children:(0,se.jsx)("path",{d:"M18.9054 48.8962V80.908H54.2288V48.8962H18.9054ZM34.3594 76.4926H23.3209V70.9733H34.3594V76.4926ZM34.3594 67.6617H23.3209V62.1424H34.3594V67.6617ZM34.3594 58.8309H23.3209V53.3116H34.3594V58.8309ZM49.8134 76.4926H38.7748V70.9733H49.8134V76.4926ZM49.8134 67.6617H38.7748V62.1424H49.8134V67.6617ZM49.8134 58.8309H38.7748V53.3116H49.8134V58.8309Z",fill:"#F1F1F1"})}),(0,se.jsx)("mask",{id:"mask2_1:52",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"1",width:"71",height:"98",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask2_1:52)",children:(0,se.jsx)("path",{d:"M47.3352 25.9856L71.8905 50.5354V27.9229L47.3352 25.9856Z",fill:"url(#paint0_linear_1:52)"})}),(0,se.jsx)("mask",{id:"mask3_1:52",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"1",width:"71",height:"98",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask3_1:52)",children:(0,se.jsx)("path",{d:"M45.398 1.43036V21.2998C45.398 24.959 48.3618 27.9229 52.0211 27.9229H71.8905L45.398 1.43036Z",fill:"#87CEAC"})}),(0,se.jsx)("mask",{id:"mask4_1:52",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"1",width:"71",height:"98",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask4_1:52)",children:(0,se.jsx)("path",{d:"M7.86688 1.43036C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V8.60542C1.24374 4.9627 4.22415 1.98229 7.86688 1.98229H45.398V1.43036H7.86688Z",fill:"white",fillOpacity:"0.2"})}),(0,se.jsx)("mask",{id:"mask5_1:52",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"1",width:"71",height:"98",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask5_1:52)",children:(0,se.jsx)("path",{d:"M65.2674 98.0177H7.86688C4.22415 98.0177 1.24374 95.0373 1.24374 91.3946V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V91.3946C71.8905 95.0373 68.9101 98.0177 65.2674 98.0177Z",fill:"#263238",fillOpacity:"0.2"})}),(0,se.jsx)("mask",{id:"mask6_1:52",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"1",width:"71",height:"98",children:(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask6_1:52)",children:(0,se.jsx)("path",{d:"M52.0211 27.9229C48.3618 27.9229 45.398 24.959 45.398 21.2998V21.8517C45.398 25.511 48.3618 28.4748 52.0211 28.4748H71.8905V27.9229H52.0211Z",fill:"#263238",fillOpacity:"0.1"})}),(0,se.jsx)("path",{d:"M45.398 1.43036H7.86688C4.22415 1.43036 1.24374 4.41077 1.24374 8.0535V91.9465C1.24374 95.5893 4.22415 98.5697 7.86688 98.5697H65.2674C68.9101 98.5697 71.8905 95.5893 71.8905 91.9465V27.9229L45.398 1.43036Z",fill:"url(#paint1_radial_1:52)"}),(0,se.jsxs)("defs",{children:[(0,se.jsxs)("linearGradient",{id:"paint0_linear_1:52",x1:"59.6142",y1:"28.0935",x2:"59.6142",y2:"50.5388",gradientUnits:"userSpaceOnUse",children:[(0,se.jsx)("stop",{stopColor:"#263238",stopOpacity:"0.2"}),(0,se.jsx)("stop",{offset:"1",stopColor:"#263238",stopOpacity:"0.02"})]}),(0,se.jsxs)("radialGradient",{id:"paint1_radial_1:52",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(3.48187 3.36121) scale(113.917)",children:[(0,se.jsx)("stop",{stopColor:"white",stopOpacity:"0.1"}),(0,se.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]})]})]})},category:"Productivity",status:"active"},{id:"googleslides",name:"Google Slides",description:"Create and edit presentations in Google Slides.",subtitle:"Generate and manage presentations.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{viewBox:"0 0 73 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,se.jsx)("mask",{id:"mask0_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask0_1:2)",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L56.029 15.6881L44.8232 0Z",fill:"#F4B400"})}),(0,se.jsx)("mask",{id:"mask1_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask1_1:2)",children:(0,se.jsx)("path",{d:"M50.4261 44.8232H21.291C19.4421 44.8232 17.9293 46.336 17.9293 48.185V77.3201C17.9293 79.169 19.4421 80.6818 21.291 80.6818H50.4261C52.2751 80.6818 53.7879 79.169 53.7879 77.3201V48.185C53.7879 46.336 52.2751 44.8232 50.4261 44.8232ZM49.3056 70.5966H22.4116V54.9085H49.3056V70.5966Z",fill:"#F1F1F1"})}),(0,se.jsx)("mask",{id:"mask2_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask2_1:2)",children:(0,se.jsx)("path",{d:"M46.7899 24.9273L71.7172 49.849V26.8939L46.7899 24.9273Z",fill:"url(#paint0_linear_1:2)"})}),(0,se.jsx)("mask",{id:"mask3_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask3_1:2)",children:(0,se.jsx)("path",{d:"M44.8232 0V20.1705C44.8232 23.8852 47.832 26.8939 51.5467 26.8939H71.7172L44.8232 0Z",fill:"#FADA80"})}),(0,se.jsx)("mask",{id:"mask4_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask4_1:2)",children:(0,se.jsx)("path",{d:"M44.8232 0V0.56029L71.1569 26.8939H71.7172L44.8232 0Z",fill:"white",fillOpacity:"0.1"})}),(0,se.jsx)("mask",{id:"mask5_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask5_1:2)",children:(0,se.jsx)("path",{d:"M6.72348 0C3.02557 0 0 3.02557 0 6.72348V7.28377C0 3.58586 3.02557 0.56029 6.72348 0.56029H44.8232V0H6.72348Z",fill:"white",fillOpacity:"0.2"})}),(0,se.jsx)("mask",{id:"mask6_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask6_1:2)",children:(0,se.jsx)("path",{d:"M64.9937 98.0508H6.72348C3.02557 98.0508 0 95.0253 0 91.3273V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V91.3273C71.7172 95.0253 68.6916 98.0508 64.9937 98.0508Z",fill:"#BF360C",fillOpacity:"0.2"})}),(0,se.jsx)("mask",{id:"mask7_1:2",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"72",height:"99",children:(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask7_1:2)",children:(0,se.jsx)("path",{d:"M51.5467 26.8939C47.832 26.8939 44.8232 23.8852 44.8232 20.1705V20.7307C44.8232 24.4455 47.832 27.4542 51.5467 27.4542H71.7172V26.8939H51.5467Z",fill:"#BF360C",fillOpacity:"0.1"})}),(0,se.jsx)("path",{d:"M44.8232 0H6.72348C3.02557 0 0 3.02557 0 6.72348V91.8876C0 95.5855 3.02557 98.6111 6.72348 98.6111H64.9937C68.6916 98.6111 71.7172 95.5855 71.7172 91.8876V26.8939L44.8232 0Z",fill:"url(#paint1_radial_1:2)"}),(0,se.jsxs)("defs",{children:[(0,se.jsxs)("linearGradient",{id:"paint0_linear_1:2",x1:"59.2549",y1:"27.0671",x2:"59.2549",y2:"49.8525",gradientUnits:"userSpaceOnUse",children:[(0,se.jsx)("stop",{stopColor:"#BF360C",stopOpacity:"0.2"}),(0,se.jsx)("stop",{offset:"1",stopColor:"#BF360C",stopOpacity:"0.02"})]}),(0,se.jsxs)("radialGradient",{id:"paint1_radial_1:2",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(2.27204 1.9601) scale(115.643)",children:[(0,se.jsx)("stop",{stopColor:"white",stopOpacity:"0.1"}),(0,se.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]})]})]})},category:"Productivity",status:"active"},{id:"googledocs",name:"Google Docs",description:"Create, read, and edit documents in Google Docs.",subtitle:"Manage and automate document creation.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{viewBox:"0 0 73 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,se.jsxs)("g",{clipPath:"url(#clip0_1:149)",children:[(0,se.jsx)("mask",{id:"mask0_1:149",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"73",height:"100",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask0_1:149)",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L56.4904 15.9091L45.1923 0Z",fill:"#4285F4"})}),(0,se.jsx)("mask",{id:"mask1_1:149",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"73",height:"100",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask1_1:149)",children:(0,se.jsx)("path",{d:"M47.1751 25.2784L72.3077 50.5511V27.2727L47.1751 25.2784Z",fill:"url(#paint0_linear_1:149)"})}),(0,se.jsx)("mask",{id:"mask2_1:149",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"73",height:"100",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask2_1:149)",children:(0,se.jsx)("path",{d:"M18.0769 72.7273H54.2308V68.1818H18.0769V72.7273ZM18.0769 81.8182H45.1923V77.2727H18.0769V81.8182ZM18.0769 50V54.5455H54.2308V50H18.0769ZM18.0769 63.6364H54.2308V59.0909H18.0769V63.6364Z",fill:"#F1F1F1"})}),(0,se.jsx)("mask",{id:"mask3_1:149",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"73",height:"100",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask3_1:149)",children:(0,se.jsx)("path",{d:"M45.1923 0V20.4545C45.1923 24.2216 48.2258 27.2727 51.9712 27.2727H72.3077L45.1923 0Z",fill:"#A1C2FA"})}),(0,se.jsx)("mask",{id:"mask4_1:149",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"73",height:"100",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask4_1:149)",children:(0,se.jsx)("path",{d:"M6.77885 0C3.05048 0 0 3.06818 0 6.81818V7.38636C0 3.63636 3.05048 0.568182 6.77885 0.568182H45.1923V0H6.77885Z",fill:"white",fillOpacity:"0.2"})}),(0,se.jsx)("mask",{id:"mask5_1:149",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"73",height:"100",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask5_1:149)",children:(0,se.jsx)("path",{d:"M65.5288 99.4318H6.77885C3.05048 99.4318 0 96.3636 0 92.6136V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V92.6136C72.3077 96.3636 69.2572 99.4318 65.5288 99.4318Z",fill:"#1A237E",fillOpacity:"0.2"})}),(0,se.jsx)("mask",{id:"mask6_1:149",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"73",height:"100",children:(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask6_1:149)",children:(0,se.jsx)("path",{d:"M51.9712 27.2727C48.2258 27.2727 45.1923 24.2216 45.1923 20.4545V21.0227C45.1923 24.7898 48.2258 27.8409 51.9712 27.8409H72.3077V27.2727H51.9712Z",fill:"#1A237E",fillOpacity:"0.1"})}),(0,se.jsx)("path",{d:"M45.1923 0H6.77885C3.05048 0 0 3.06818 0 6.81818V93.1818C0 96.9318 3.05048 100 6.77885 100H65.5288C69.2572 100 72.3077 96.9318 72.3077 93.1818V27.2727L45.1923 0Z",fill:"url(#paint1_radial_1:149)"})]}),(0,se.jsxs)("defs",{children:[(0,se.jsxs)("linearGradient",{id:"paint0_linear_1:149",x1:"59.7428",y1:"27.4484",x2:"59.7428",y2:"50.5547",gradientUnits:"userSpaceOnUse",children:[(0,se.jsx)("stop",{stopColor:"#1A237E",stopOpacity:"0.2"}),(0,se.jsx)("stop",{offset:"1",stopColor:"#1A237E",stopOpacity:"0.02"})]}),(0,se.jsxs)("radialGradient",{id:"paint1_radial_1:149",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(2.29074 1.9765) scale(116.595)",children:[(0,se.jsx)("stop",{stopColor:"white",stopOpacity:"0.1"}),(0,se.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]}),(0,se.jsx)("clipPath",{id:"clip0_1:149",children:(0,se.jsx)("rect",{width:"72.3077",height:"100",fill:"white"})})]})]})},category:"Productivity",status:"active"},{id:"hubspot",name:"HubSpot",description:"Connect with HubSpot to manage contacts, deals, and marketing automation.",subtitle:"Sync CRM data and automate marketing.",icon:e=>{let{className:t}=e;return(0,se.jsx)("svg",{viewBox:"6.20856283 .64498824 244.26943717 251.24701176",className:t,xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"m191.385 85.694v-29.506a22.722 22.722 0 0 0 13.101-20.48v-.677c0-12.549-10.173-22.722-22.721-22.722h-.678c-12.549 0-22.722 10.173-22.722 22.722v.677a22.722 22.722 0 0 0 13.101 20.48v29.506a64.342 64.342 0 0 0 -30.594 13.47l-80.922-63.03c.577-2.083.878-4.225.912-6.375a25.6 25.6 0 1 0 -25.633 25.55 25.323 25.323 0 0 0 12.607-3.43l79.685 62.007c-14.65 22.131-14.258 50.974.987 72.7l-24.236 24.243c-1.96-.626-4-.959-6.057-.987-11.607.01-21.01 9.423-21.007 21.03.003 11.606 9.412 21.014 21.018 21.017 11.607.003 21.02-9.4 21.03-21.007a20.747 20.747 0 0 0 -.988-6.056l23.976-23.985c21.423 16.492 50.846 17.913 73.759 3.562 22.912-14.352 34.475-41.446 28.985-67.918-5.49-26.473-26.873-46.734-53.603-50.792m-9.938 97.044a33.17 33.17 0 1 1 0-66.316c17.85.625 32 15.272 32.01 33.134.008 17.86-14.127 32.522-31.977 33.165",fill:"#ff7a59"})})},category:"CRM",status:"active"},{id:"linkedin",name:"LinkedIn",description:"Access LinkedIn profile data, share posts, and manage professional networking activities.",subtitle:"Share updates and access professional profiles.",icon:e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 382 382",className:t,children:(0,se.jsx)("path",{fill:"#0077B7",d:"M347.445,0H34.555C15.471,0,0,15.471,0,34.555v312.889C0,366.529,15.471,382,34.555,382h312.889 C366.529,382,382,366.529,382,347.444V34.555C382,15.471,366.529,0,347.445,0z M118.207,329.844c0,5.554-4.502,10.056-10.056,10.056 H65.345c-5.554,0-10.056-4.502-10.056-10.056V150.403c0-5.554,4.502-10.056,10.056-10.056h42.806 c5.554,0,10.056,4.502,10.056,10.056V329.844z M86.748,123.432c-22.459,0-40.666-18.207-40.666-40.666S64.289,42.1,86.748,42.1 s40.666,18.207,40.666,40.666S109.208,123.432,86.748,123.432z M341.91,330.654c0,5.106-4.14,9.246-9.246,9.246H286.73 c-5.106,0-9.246-4.14-9.246-9.246v-84.168c0-12.556,3.683-55.021-32.813-55.021c-28.309,0-34.051,29.066-35.204,42.11v97.079 c0,5.106-4.139,9.246-9.246,9.246h-44.426c-5.106,0-9.246-4.14-9.246-9.246V149.593c0-5.106,4.14-9.246,9.246-9.246h44.426 c5.106,0,9.246,4.14,9.246,9.246v15.655c10.497-15.753,26.097-27.912,59.312-27.912c73.552,0,73.131,68.716,73.131,106.472 L341.91,330.654L341.91,330.654z"})})},category:"Social",status:"active"},{id:"tiktok",name:"TikTok",description:"Access your TikTok profile info, follower stats, and public videos.",subtitle:"Track your profile stats and browse your videos.",icon:e=>{let{className:t}=e;return(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"optimizeQuality",fillRule:"evenodd",clipRule:"evenodd",viewBox:"0 0 512 512",className:t,children:[(0,se.jsx)("rect",{width:"512",height:"512",rx:"116.056",ry:"116.056"}),(0,se.jsx)("path",{fill:"#2DCCD3",fillRule:"nonzero",d:"M348.868 152.076c12.815 13.213 28.795 21.265 44.9 24.93v-9.922c-15.132-1.073-30.964-5.834-44.9-15.008zm-92.569-65.444v221.885c0 29.069-20.892 47.767-46.296 47.767-8.427 0-16.43-1.969-23.386-5.609 8.826 11.269 22.762 17.751 38.045 17.751 25.405 0 46.297-18.698 46.297-47.793V98.748h40.263a110.44 110.44 0 01-2.693-12.116h-52.23zm-33.033 128.992V204.63c-5.086-.848-10.172-1.122-14.385-1.122-57.316 0-105.309 45.998-105.309 103.04 0 37.446 18.225 69.457 45.923 88.405-19.296-19.147-31.263-45.948-31.263-76.289 0-56.943 47.843-102.915 105.034-103.04z"}),(0,se.jsx)("path",{fill:"#F1204A",fillRule:"nonzero",d:"M314.438 304.852c0 70.854-54.199 108.4-105.283 108.4-22.114 0-42.657-6.681-59.66-18.299 19.097 18.947 45.375 30.415 74.319 30.415 51.084 0 105.284-37.546 105.284-108.399V201.514c-5.086-3.441-9.973-7.455-14.66-12.142v115.48zm-127.82 45.824c-6.233-7.879-9.948-18.076-9.948-30.043 0-33.582 26.252-51.332 61.255-47.643v-56.244c-5.085-.847-10.171-1.122-14.41-1.122h-.249v45.225c-35.003-3.664-61.256 14.061-61.256 47.668 0 19.645 10.048 34.554 24.608 42.159zm207.151-173.67v42.009c-23.261 0-45.275-4.438-64.671-17.501 22.587 22.587 49.986 29.642 79.33 29.642V179.2a90.834 90.834 0 01-14.659-2.194zm-44.901-24.93c-12.391-12.74-21.84-30.292-25.679-53.328h-11.967c6.831 24.906 20.892 42.283 37.646 53.328z"}),(0,se.jsx)("path",{fill:"#fff",fillRule:"nonzero",d:"M209.155 413.252c51.083 0 105.283-37.547 105.283-108.4v-115.48c4.688 4.687 9.574 8.701 14.66 12.141 19.396 13.065 41.41 17.502 64.671 17.502v-42.009c-16.106-3.664-32.087-11.717-44.901-24.93-16.754-11.045-30.815-28.422-37.646-53.328h-40.263v221.886c0 29.094-20.893 47.792-46.297 47.792-15.283 0-29.219-6.482-38.045-17.751-14.559-7.603-24.606-22.513-24.606-42.158 0-33.607 26.252-51.333 61.255-47.668v-45.225c-57.192.125-105.035 46.098-105.035 103.04 0 30.341 11.967 57.141 31.265 76.288 17.002 11.618 37.545 18.3 59.659 18.3z"})]})},category:"Social Media",status:"active"}];function TE(e){return EE.find(t=>t.id===e)}const IE=e=>{let{scopes:t}=e;return(0,se.jsxs)("div",{className:"text-sm text-slate-500",children:[(0,se.jsx)("div",{className:"text-gray-500 mb-1",children:"We need your permission to access"}),(0,se.jsx)("div",{className:"flex flex-wrap gap-1",children:t.map((e,t)=>(0,se.jsx)("span",{className:"font-mono px-1.5 py-0.5 rounded border border-slate-200 break-all",children:e},t))})]})},PE=e=>{let{errorInfo:t}=e;return(0,se.jsxs)("div",{className:"flex items-start gap-1.5 ".concat(t.retryable?"text-amber-600":"text-red-600"),children:[(0,se.jsx)(Oy.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("div",{className:"text-xs break-words",children:[t.message,t.retryable&&(0,se.jsx)("span",{className:"font-medium",children:" You can try connecting again."}),"different_user"===t.type&&t.userEmail&&(0,se.jsxs)("span",{className:"break-all",children:[" Currently connected by ",t.userEmail,"."]})]})]})},LE=e=>{let{isSubmitting:t,isSuccess:s,errorInfo:a,config:n,integrationName:l,onConnect:r,onSkip:i}=e;const o=t||s||a&&!a.retryable,c=t||s;return(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Bx,{size:"sm",type:"button",onClick:r,disabled:o,className:"h-8 text-xs disabled:opacity-50 bg-slate-900 hover:bg-slate-800",children:t?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 mr-1.5 animate-spin"}),n.getConnectingLabel()]}):s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(hb.A,{className:"h-3 w-3 mr-1.5"}),n.getConnectedLabel()]}):n.getConnectLabel(l)}),(0,se.jsx)(Bx,{onClick:i,variant:"outline",size:"sm",type:"button",disabled:c,className:"h-8 text-xs border-slate-300 hover:bg-slate-50 disabled:opacity-50",children:"Reject"})]})},ME=e=>{let{isWaitingForInput:t,errorInfo:s,description:a,scopes:n,isLastAssistantMessage:l,isSubmitting:r,isSuccess:i,config:o,integrationName:c,onConnect:d,onSkip:u,extraContent:m,footerContent:x}=e;return t||s?(0,se.jsx)("div",{className:"border-l-2 border-l-blue-500 bg-slate-50 p-4 space-y-3 ml-[11px]",children:(0,se.jsx)("div",{className:"flex items-start gap-2.5",children:(0,se.jsxs)("div",{className:"flex-1 min-w-0 space-y-3",children:[m,(0,se.jsx)("div",{children:(0,se.jsx)("div",{className:"text-sm text-slate-600 break-words",children:a})}),n&&n.length>0&&(0,se.jsx)(IE,{scopes:n}),l?(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(LE,{isSubmitting:r,isSuccess:i,errorInfo:s,config:o,integrationName:c,onConnect:d,onSkip:u}),s&&(0,se.jsx)(PE,{errorInfo:s})]}):(0,se.jsx)("div",{className:"text-xs text-slate-500 italic break-words",children:"This request is from a previous message"}),x]})})}):null};function RE(e){let{toolCall:t,parsedArgs:s,messageId:a,isLastAssistantMessage:n,isLastRunningTool:l,isInitialMessage:r=!1,messageContent:i="",debugInfo:o,extraContent:c,footerContent:d}=e;const{submitToolCallInput:u,app:m}=lp(),{user:x}=wd(),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(null),v=(0,Y.useRef)(null),b="suggest_stripe_installation"===t.name?{type:"stripe",getName:()=>"Stripe",getDescription:()=>"To set up payments, approve Stripe integration installation",getConnectLabel:()=>"Install Stripe",getConnectingLabel:()=>"Installing...",getConnectedLabel:()=>"Installed",getStatusText:(e,t,s)=>"running"===e?"Connecting to":"success"===e?"Connected to":"Connect to",getCancelledLabel:()=>"cancelled"}:{type:"oauth",getName:e=>{const t=TE(e);return(null==t?void 0:t.name)||e},getDescription:e=>e||"Authorization required",getConnectLabel:e=>"Connect to ".concat(e),getConnectingLabel:()=>"Connecting...",getConnectedLabel:()=>"Connected",getStatusText:(e,t,s)=>"running"===e?"Connecting to":"success"===e?"Connected to":"Connect to",getCancelledLabel:()=>"cancelled"};const j=t.status,y=(null==s?void 0:s.integration_type)||"unknown",N=(null==s?void 0:s.reason)||"",w=(null==s?void 0:s.scopes)||null,_=b.getName(y),k=b.getDescription(N),C="waiting_for_user_input"===j,A="success"===j,S="stopped"===j,E="error"===j;(0,Y.useEffect)(()=>()=>{v.current&&v.current()},[]);const T=b.getStatusText(j,_,t.requires_user_input),I="stripe"===b.type&&C;return(0,se.jsxs)("div",{children:[I&&(0,se.jsx)("p",{className:"text-slate-700 mb-3",children:"I'll set up Stripe payments for your app in a test environment so you can start accepting payments safely."}),(0,se.jsx)(kS,{icon:ZS.A,status:j,isLastAssistantMessage:n,isLastRunningTool:l,messageId:a,toolCallId:t.id,debugInfo:o,secondaryContent:(0,se.jsx)(ME,{isWaitingForInput:C,errorInfo:g,description:k,scopes:w,isLastAssistantMessage:n,isSubmitting:h,isSuccess:A,config:b,integrationName:_,onConnect:async()=>{if(p(!0),f(null),"oauth"===b.type){const e=await AE({appId:m.id,integrationType:y,scopes:w,forceReconnect:!1,trackingContext:{source:"Chat",userId:(null==x?void 0:x.id)||null,conversationId:gu.id||null,messageId:a,prompt:i,isInitialMessage:r},onSuccess:async()=>{await u(t.id,!0,{}),p(!1)},onError:async e=>{f(e),e.retryable||await u(t.id,!1,{}),p(!1)},onCancel:async()=>{await u(t.id,!1,{}),p(!1)}});e?v.current=e:p(!1)}else try{await u(t.id,!0,{}),Tu("Stripe Setup - Completed",{app_id:(null==m?void 0:m.id)||null,entry_point:"Chat",monetization_request:(null==s?void 0:s.reason)||null,used_suggestion:null,suggestion_index:null,modified_suggestion:null,country:null})}catch(e){}finally{p(!1)}},onSkip:async()=>{p(!0);try{await u(t.id,!1,{})}catch(e){}finally{p(!1)}},extraContent:c,footerContent:d}),result:t.results,children:(0,se.jsx)("div",{children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[T," ",(0,se.jsx)("span",{className:"flex items-center gap-1 px-[6px] py-[2px] bg-gray-200 text-gray-500 rounded font-[400] font-mono text-xs",children:_}),(S||E)&&t.requires_user_input&&(0,se.jsx)("span",{className:"text-slate-400 text-xs italic",children:b.getCancelledLabel()})]})})})]})}const DE="user_country_code";function FE(){try{const e=localStorage.getItem(DE);if(!e)return null;const{code:t,timestamp:s}=JSON.parse(e);return Date.now()-s>864e5?null:t}catch(e){return null}}function OE(){const[e,t]=(0,Y.useState)(()=>FE()),[s,a]=(0,Y.useState)(!FE()),[n,l]=(0,Y.useState)(null);return(0,Y.useEffect)(()=>{const e=FE();if(e)return t(e),void a(!1);(async()=>{try{a(!0);const e=await fetch("https://ipapi.co/country_code/",{method:"GET",headers:{Accept:"text/plain"}});if(!e.ok)throw new Error("Failed to fetch country: ".concat(e.status));const s=(await e.text()).trim().toLowerCase();if(!s||2!==s.length)throw new Error("Invalid country code received");!function(e){try{const t={code:e,timestamp:Date.now()};localStorage.setItem(DE,JSON.stringify(t))}catch(t){}}(s),t(s)}catch(e){l(e instanceof Error?e:new Error("Unknown error"))}finally{a(!1)}})()},[]),{countryCode:e,isLoading:s,error:n}}var UE=s(34432),BE=s(56003);const zE=["Application Development","UI/UX Design","Security Expert","Strategic Consulting","Mobile Development","AI Expert","API & Integrations","QA & Testing","Other"],HE=[{label:"English",value:"en"},{label:"Hebrew",value:"he"},{label:"Spanish",value:"es"},{label:"French",value:"fr"},{label:"German",value:"de"},{label:"Italian",value:"it"},{label:"Portuguese",value:"pt"},{label:"Russian",value:"ru"},{label:"Chinese",value:"zh"},{label:"Japanese",value:"ja"},{label:"Korean",value:"ko"},{label:"Arabic",value:"ar"},{label:"Turkish",value:"tr"},{label:"Dutch",value:"nl"},{label:"Polish",value:"pl"},{label:"Romanian",value:"ro"},{label:"Czech",value:"cs"},{label:"Hungarian",value:"hu"},{label:"Bulgarian",value:"bg"},{label:"Croatian",value:"hr"},{label:"Serbian",value:"sr"},{label:"Slovak",value:"sk"},{label:"Slovenian",value:"sl"},{label:"Estonian",value:"et"},{label:"Latvian",value:"lv"}],VE=[{label:"Afghanistan",value:"af"},{label:"\xc5land Islands",value:"ax"},{label:"Albania",value:"al"},{label:"Algeria",value:"dz"},{label:"American Samoa",value:"as"},{label:"Andorra",value:"ad"},{label:"Angola",value:"ao"},{label:"Anguilla",value:"ai"},{label:"Antigua & Barbuda",value:"ag"},{label:"Argentina",value:"ar"},{label:"Armenia",value:"am"},{label:"Aruba",value:"aw"},{label:"Australia",value:"au"},{label:"Austria",value:"at"},{label:"Azerbaijan",value:"az"},{label:"Bahamas",value:"bs"},{label:"Bahrain",value:"bh"},{label:"Bangladesh",value:"bd"},{label:"Barbados",value:"bb"},{label:"Belarus",value:"by"},{label:"Belgium",value:"be"},{label:"Belize",value:"bz"},{label:"Benin",value:"bj"},{label:"Bermuda",value:"bm"},{label:"Bhutan",value:"bt"},{label:"Bolivia",value:"bo"},{label:"Bosnia & Herzegovina",value:"ba"},{label:"Botswana",value:"bw"},{label:"Brazil",value:"br"},{label:"British Indian Ocean Territory",value:"io"},{label:"British Virgin Islands",value:"vg"},{label:"Brunei",value:"bn"},{label:"Bulgaria",value:"bg"},{label:"Burkina Faso",value:"bf"},{label:"Burundi",value:"bi"},{label:"Cambodia",value:"kh"},{label:"Cameroon",value:"cm"},{label:"Canada",value:"ca"},{label:"Cape Verde",value:"cv"},{label:"Caribbean Netherlands",value:"bq"},{label:"Cayman Islands",value:"ky"},{label:"Central African Republic",value:"cf"},{label:"Chad",value:"td"},{label:"Chile",value:"cl"},{label:"China",value:"cn"},{label:"Christmas Island",value:"cx"},{label:"Cocos (Keeling) Islands",value:"cc"},{label:"Colombia",value:"co"},{label:"Comoros",value:"km"},{label:"Congo - Brazzaville",value:"cg"},{label:"Congo - Kinshasa",value:"cd"},{label:"Cook Islands",value:"ck"},{label:"Costa Rica",value:"cr"},{label:"C\xf4te d'Ivoire",value:"ci"},{label:"Croatia",value:"hr"},{label:"Cura\xe7ao",value:"cw"},{label:"Cyprus",value:"cy"},{label:"Czechia",value:"cz"},{label:"Denmark",value:"dk"},{label:"Djibouti",value:"dj"},{label:"Dominica",value:"dm"},{label:"Dominican Republic",value:"do"},{label:"Ecuador",value:"ec"},{label:"Egypt",value:"eg"},{label:"El Salvador",value:"sv"},{label:"Equatorial Guinea",value:"gq"},{label:"Eritrea",value:"er"},{label:"Estonia",value:"ee"},{label:"Eswatini",value:"sz"},{label:"Ethiopia",value:"et"},{label:"Falkland Islands",value:"fk"},{label:"Faroe Islands",value:"fo"},{label:"Fiji",value:"fj"},{label:"Finland",value:"fi"},{label:"France",value:"fr"},{label:"French Guiana",value:"gf"},{label:"French Polynesia",value:"pf"},{label:"Gabon",value:"ga"},{label:"Gambia",value:"gm"},{label:"Georgia",value:"ge"},{label:"Germany",value:"de"},{label:"Ghana",value:"gh"},{label:"Gibraltar",value:"gi"},{label:"Greece",value:"gr"},{label:"Greenland",value:"gl"},{label:"Grenada",value:"gd"},{label:"Guadeloupe",value:"gp"},{label:"Guam",value:"gu"},{label:"Guatemala",value:"gt"},{label:"Guernsey",value:"gg"},{label:"Guinea",value:"gn"},{label:"Guinea-Bissau",value:"gw"},{label:"Guyana",value:"gy"},{label:"Haiti",value:"ht"},{label:"Honduras",value:"hn"},{label:"Hong Kong SAR China",value:"hk"},{label:"Hungary",value:"hu"},{label:"Iceland",value:"is"},{label:"India",value:"in"},{label:"Indonesia",value:"id"},{label:"Iraq",value:"iq"},{label:"Ireland",value:"ie"},{label:"Isle of Man",value:"im"},{label:"Israel",value:"il"},{label:"Italy",value:"it"},{label:"Jamaica",value:"jm"},{label:"Japan",value:"jp"},{label:"Jersey",value:"je"},{label:"Jordan",value:"jo"},{label:"Kazakhstan",value:"kz"},{label:"Kenya",value:"ke"},{label:"Kiribati",value:"ki"},{label:"Kuwait",value:"kw"},{label:"Kyrgyzstan",value:"kg"},{label:"Laos",value:"la"},{label:"Latvia",value:"lv"},{label:"Lebanon",value:"lb"},{label:"Lesotho",value:"ls"},{label:"Liberia",value:"lr"},{label:"Libya",value:"ly"},{label:"Liechtenstein",value:"li"},{label:"Lithuania",value:"lt"},{label:"Luxembourg",value:"lu"},{label:"Macao SAR China",value:"mo"},{label:"Madagascar",value:"mg"},{label:"Malawi",value:"mw"},{label:"Malaysia",value:"my"},{label:"Maldives",value:"mv"},{label:"Mali",value:"ml"},{label:"Malta",value:"mt"},{label:"Marshall Islands",value:"mh"},{label:"Martinique",value:"mq"},{label:"Mauritania",value:"mr"},{label:"Mauritius",value:"mu"},{label:"Mayotte",value:"yt"},{label:"Mexico",value:"mx"},{label:"Micronesia",value:"fm"},{label:"Moldova",value:"md"},{label:"Monaco",value:"mc"},{label:"Mongolia",value:"mn"},{label:"Montenegro",value:"me"},{label:"Montserrat",value:"ms"},{label:"Morocco",value:"ma"},{label:"Mozambique",value:"mz"},{label:"Myanmar (Burma)",value:"mm"},{label:"Namibia",value:"na"},{label:"Nauru",value:"nr"},{label:"Nepal",value:"np"},{label:"Netherlands",value:"nl"},{label:"New Caledonia",value:"nc"},{label:"New Zealand",value:"nz"},{label:"Nicaragua",value:"ni"},{label:"Niger",value:"ne"},{label:"Nigeria",value:"ng"},{label:"Niue",value:"nu"},{label:"Norfolk Island",value:"nf"},{label:"North Macedonia",value:"mk"},{label:"Northern Mariana Islands",value:"mp"},{label:"Norway",value:"no"},{label:"Oman",value:"om"},{label:"Pakistan",value:"pk"},{label:"Palau",value:"pw"},{label:"Palestinian Territories",value:"ps"},{label:"Panama",value:"pa"},{label:"Papua New Guinea",value:"pg"},{label:"Paraguay",value:"py"},{label:"Peru",value:"pe"},{label:"Philippines",value:"ph"},{label:"Poland",value:"pl"},{label:"Portugal",value:"pt"},{label:"Puerto Rico",value:"pr"},{label:"Qatar",value:"qa"},{label:"R\xe9union",value:"re"},{label:"Romania",value:"ro"},{label:"Rwanda",value:"rw"},{label:"Samoa",value:"ws"},{label:"San Marino",value:"sm"},{label:"S\xe3o Tom\xe9 & Pr\xedncipe",value:"st"},{label:"Saudi Arabia",value:"sa"},{label:"Senegal",value:"sn"},{label:"Serbia",value:"rs"},{label:"Seychelles",value:"sc"},{label:"Sierra Leone",value:"sl"},{label:"Singapore",value:"sg"},{label:"Sint Maarten",value:"sx"},{label:"Slovakia",value:"sk"},{label:"Slovenia",value:"si"},{label:"Solomon Islands",value:"sb"},{label:"Somalia",value:"so"},{label:"South Africa",value:"za"},{label:"South Korea",value:"kr"},{label:"South Sudan",value:"ss"},{label:"Spain",value:"es"},{label:"Sri Lanka",value:"lk"},{label:"St. Barth\xe9lemy",value:"bl"},{label:"St. Helena",value:"sh"},{label:"St. Kitts & Nevis",value:"kn"},{label:"St. Lucia",value:"lc"},{label:"St. Martin",value:"mf"},{label:"St. Pierre & Miquelon",value:"pm"},{label:"St. Vincent & Grenadines",value:"vc"},{label:"Sudan",value:"sd"},{label:"Suriname",value:"sr"},{label:"Svalbard & Jan Mayen",value:"sj"},{label:"Sweden",value:"se"},{label:"Switzerland",value:"ch"},{label:"Syria",value:"sy"},{label:"Taiwan",value:"tw"},{label:"Tajikistan",value:"tj"},{label:"Tanzania",value:"tz"},{label:"Thailand",value:"th"},{label:"Timor-Leste",value:"tl"},{label:"Togo",value:"tg"},{label:"Tokelau",value:"tk"},{label:"Tonga",value:"to"},{label:"Trinidad & Tobago",value:"tt"},{label:"Tunisia",value:"tn"},{label:"Turkey",value:"tr"},{label:"Turkmenistan",value:"tm"},{label:"Turks & Caicos Islands",value:"tc"},{label:"Tuvalu",value:"tv"},{label:"U.S. Virgin Islands",value:"vi"},{label:"Uganda",value:"ug"},{label:"Ukraine",value:"ua"},{label:"United Arab Emirates",value:"ae"},{label:"United Kingdom",value:"gb"},{label:"United States",value:"us"},{label:"Uruguay",value:"uy"},{label:"Uzbekistan",value:"uz"},{label:"Vanuatu",value:"vu"},{label:"Vatican City",value:"va"},{label:"Venezuela",value:"ve"},{label:"Vietnam",value:"vn"},{label:"Wallis & Futuna",value:"wf"},{label:"Western Sahara",value:"eh"},{label:"Yemen",value:"ye"},{label:"Zambia",value:"zm"},{label:"Zimbabwe",value:"zw"}],WE=e=>{const t=VE.find(t=>t.value===e);return t?t.label:e},qE=UE.Yj().url("Please enter a valid URL"),YE=UE.Ik({url:UE.Yj(),allow_public_showcase:UE.zM().default(!0)}),GE=UE.Yj().url("Please enter a valid URL").refine(e=>e.toLowerCase().includes("linkedin.com"),"Please enter a valid LinkedIn URL"),KE=UE.Yj().optional().refine(e=>!e||""===e.trim()||!isNaN(Number(e))&&Number(e)>=0,"Please enter a valid number"),$E=(e,t)=>{const s=e.website_url&&""!==e.website_url.trim(),a=e.linkedin_url&&""!==e.linkedin_url.trim();if(s||a||(t.addIssue({code:BE.eq.custom,message:"Please provide either a website or LinkedIn URL",path:["website_url"]}),t.addIssue({code:BE.eq.custom,message:"Please provide either a website or LinkedIn URL",path:["linkedin_url"]})),s){qE.safeParse(e.website_url).success||t.addIssue({code:BE.eq.custom,message:"Please enter a valid URL",path:["website_url"]})}if(a){const s=GE.safeParse(e.linkedin_url);var n;if(!s.success)t.addIssue({code:BE.eq.custom,message:(null===(n=s.error.errors[0])||void 0===n?void 0:n.message)||"Please enter a valid LinkedIn URL",path:["linkedin_url"]})}},ZE=(e,t)=>{const s=e.budget_starting_from_dollars&&""!==e.budget_starting_from_dollars.trim(),a=e.hourly_rate&&""!==e.hourly_rate.trim();s||a||t.addIssue({code:BE.eq.custom,message:"Please provide at least one pricing option",path:["pricing"]})},JE=(e,t)=>{var s;null===(s=e.services)||void 0===s||!s.includes("Other")||e.other_service_description&&""!==e.other_service_description.trim()||t.addIssue({code:BE.eq.custom,message:"Please describe your other service",path:["other_service_description"]})},QE=(e,t)=>{if(e.has_apps_to_share){0===(e.apps||[]).filter(e=>e.url&&e.url.trim()).length&&t.addIssue({code:BE.eq.custom,message:"Please provide at least one app URL",path:["apps"]}),e.apps&&e.apps.length>0&&e.apps.forEach((e,s)=>{e.url&&e.url.trim()&&(UE.Yj().url().safeParse(e.url).success||t.addIssue({code:BE.eq.custom,message:"App ".concat(s+1," must be a valid URL"),path:["apps"]}))})}else(!e.no_apps_explanation||e.no_apps_explanation.trim().length<20)&&t.addIssue({code:BE.eq.custom,message:"Please provide an explanation of at least 20 characters",path:["no_apps_explanation"]})},XE=UE.Ik({name:UE.Yj().min(1,"Company/Personal name is required").max(100,"Name must be less than 100 characters"),description:UE.Yj().min(20,"Please provide at least 20 characters").max(500,"Description must be less than 500 characters"),logo_url:UE.Yj().optional(),country:UE.Yj().min(1,"Country is required"),city:UE.Yj().min(1,"City is required").max(50,"City name must be less than 50 characters"),individual_or_team:UE.k5(["individual","team"],{required_error:"Please select team size"}),website_url:UE.Yj().optional(),linkedin_url:UE.Yj().optional(),languages:UE.YO(UE.Yj()).min(1,"Please select at least one language"),budget_starting_from_dollars:KE,hourly_rate:KE,services:UE.YO(UE.Yj()).min(1,"Please select at least one service"),other_service_description:UE.Yj().max(30,"Service description must be 30 characters or less").optional(),apps:UE.YO(YE).max(5,"Maximum 5 apps allowed").default([]),has_apps_to_share:UE.zM().default(!0),no_apps_explanation:UE.Yj().max(500,"Explanation must be less than 500 characters").optional(),terms_accepted:UE.zM().refine(e=>!0===e,"You must agree to the terms of use to continue")}),eT=XE.superRefine((e,t)=>{$E(e,t),ZE(e,t),JE(e,t),QE(e,t)}),tT=XE.pick({name:!0,description:!0,country:!0,city:!0}).extend({logo:UE.zM().refine(e=>!0===e,"Logo upload is required")}),sT=XE.pick({individual_or_team:!0,website_url:!0,linkedin_url:!0,languages:!0,budget_starting_from_dollars:!0,hourly_rate:!0}).superRefine((e,t)=>{$E(e,t),ZE(e,t)}),aT=XE.pick({services:!0,other_service_description:!0}).superRefine((e,t)=>{JE(e,t)}),nT=XE.pick({apps:!0,has_apps_to_share:!0,no_apps_explanation:!0}).superRefine((e,t)=>{QE(e,t)}),lT=e=>{const t={};return e.errors.forEach(e=>{const s=e.path.join(".");s&&(t[s]=e.message)}),t},rT=["ae","ar","at","au","be","bg","br","ca","ch","ci","cr","cy","cz","de","dk","do","ee","es","fi","fr","gb","gi","gr","gt","hk","hr","hu","id","ie","in","it","jp","kr","li","lt","lu","lv","mt","mx","my","nl","no","nz","pe","ph","pl","pt","ro","rs","se","sg","si","sk","sn","th","tt","us","uy"];const iT=e=>{let{countryCode:t}=e;const s=WE(t);return(0,se.jsxs)("div",{className:"text-sm text-slate-600",children:[(0,se.jsxs)("span",{className:"font-semibold text-slate-900",children:["Stripe isn't supported in ",s,"."]}),(0,se.jsx)("br",{}),"You can still connect if your business is registered in a Stripe-supported region."," ",(0,se.jsx)("a",{href:"https://stripe.com/global",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-slate-700",children:"See supported countries"})]})},oT=()=>(0,se.jsxs)("p",{className:"text-xs text-slate-500",children:["Base44 may share your information with Stripe. See"," ",(0,se.jsx)("a",{href:"https://stripe.com/privacy",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-slate-700",children:"Stripe's Privacy Policy"})," ","to learn how Stripe will handle your data."]});function cT(e){const{countryCode:t,isLoading:s}=OE(),a=!s&&t&&!function(e){return!!e&&rT.includes(e.toLowerCase())}(t);return(0,se.jsx)(RE,(0,ue.A)((0,ue.A)({},e),{},{extraContent:a?(0,se.jsx)(iT,{countryCode:t}):void 0,footerContent:(0,se.jsx)(oT,{})}))}const dT=e=>{if(!e)return{};try{return JSON.parse(e)}catch(n){}let t=e.trim();t.endsWith("...")&&(t=t.slice(0,-3));try{return JSON.parse(t)}catch(n){}const s={},a=["filePath","file_path","filename","name","reasoning","query","url","code","content","instruction"];for(const l of a){const e='"'.concat(l,'"\\s*:\\s*"'),a=t.match(new RegExp(e));if(a&&void 0!==a.index){const e=a.index+a[0].length;let r=-1,i=!1;for(let s=e;s<t.length;s++)if("\\"!==t[s]){if('"'===t[s]&&!i){r=s;break}i=!1}else i=!i;if(-1!==r)try{s[l]=JSON.parse('"'.concat(t.slice(e,r),'"'))}catch(n){s[l]=t.slice(e,r)}else s[l]=t.slice(e)}}return s};function uT(e){let{toolCall:t,parsedArgs:s,messageId:a,isLastAssistantMessage:n,isLastRunningTool:l,debugInfo:r}=e;const{submitToolCallInput:i}=lp(),[o,c]=(0,Y.useState)(!1),d=t.status,u="running"===d,m="waiting_for_user_input"===d,x="success"===d,h="stopped"===d;let p=[];if(null!=s&&s.packages)g=s.packages,p=Array.isArray(g)?g.map(e=>e&&"object"==typeof e&&e.name?e.semver?"".concat(e.name,"@").concat(e.semver):e.name:String(e)).filter(Boolean):"string"==typeof g&&g&&g.trim()?g.includes(",")?g.split(",").map(e=>e.trim()).filter(Boolean):g.trim().split(/\s+/).filter(Boolean):[];else if(null!=s&&s.package_name){const e=s.package_name,t=s.version;p=[t?"".concat(e,"@").concat(t):e]}var g;0===p.length&&(p=["package"]);const f=async()=>{c(!0);try{await i(t.id,!0,{})}catch(e){}finally{c(!1)}},v=async()=>{c(!0);try{await i(t.id,!1,{})}catch(e){}finally{c(!1)}},b=()=>!m||!n||u||x||h?null:(0,se.jsx)("div",{className:"border border-slate-200 bg-slate-50 rounded-lg p-4 space-y-3 mt-2",children:(0,se.jsx)("div",{className:"flex items-start gap-2.5",children:(0,se.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900 mb-2",children:"Approval Required"}),(0,se.jsx)("div",{className:"text-xs text-slate-500 italic",children:"Other tools will run after approval"})]}),(0,se.jsx)("div",{className:"flex flex-col gap-1.5",children:p.map((e,t)=>(0,se.jsx)("span",{className:"flex items-center gap-2.5 px-2 py-1.5 bg-orange-50 text-orange-700 rounded font-[400] text-xs border border-orange-200 w-fit",children:e},t))}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(zt,{size:"sm",onClick:f,disabled:o,className:"h-8 text-xs bg-slate-900 hover:bg-slate-800 disabled:opacity-50",children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 mr-1.5 animate-spin"}),"Approving..."]}):"Approve"}),(0,se.jsx)(zt,{size:"sm",variant:"outline",onClick:v,disabled:o,className:"h-8 text-xs border-slate-300 hover:bg-slate-50 disabled:opacity-50",children:"Reject"})]})]})})});return(0,se.jsx)(kS,{status:d,isLastAssistantMessage:n,isLastRunningTool:l,messageId:a,toolCallId:t.id,debugInfo:r,secondaryContent:(0,se.jsx)(b,{}),result:t.results,children:(0,se.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,se.jsx)(tu.A,{className:"h-4 w-4 text-gray-400 mt-0.5 shrink-0"}),(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[m?"Install":u?"Installing":x?"Installed":"Analyzing",p.length>1&&(0,se.jsxs)("span",{children:[p.length," packages:"]}),h&&t.requires_user_input&&(0,se.jsx)("span",{className:"text-slate-400 text-xs italic",children:"rejected"})]}),!m&&(0,se.jsx)("div",{className:"flex flex-col gap-1.5",children:p.map((e,t)=>(0,se.jsx)("span",{className:"flex items-center gap-2.5 px-2 py-1.5 bg-blue-100 text-gray-700 rounded font-[400] text-xs w-fit",children:e},t))})]})]})})}const mT=e=>{let{className:t}=e;return(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,se.jsx)("path",{d:"M6 2L6 6M10 2V6M4 6H12C12.5523 6 13 6.44772 13 7V12C13 13.1046 12.1046 14 11 14H5C3.89543 14 3 13.1046 3 12V7C3 6.44772 3.44772 6 4 6Z",stroke:"currentColor",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"}),(0,se.jsx)("path",{d:"M6 9.5L7.5 11L10 8.5",stroke:"currentColor",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})]})};function xT(e){let{toolCall:t,parsedArgs:s,messageId:a,isLastAssistantMessage:n,isLastRunningTool:l,debugInfo:r}=e;const i=t.status,o=(null==s?void 0:s.function_name)||"function",c=void 0!==(null==s?void 0:s.payload)&&null!==(null==s?void 0:s.payload),d="running"===i;return(0,se.jsx)(kS,{icon:mT,status:i,isLastAssistantMessage:n,isLastRunningTool:l,messageId:a,toolCallId:t.id,debugInfo:r,children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[d?c?"Testing":"Checking":c?"Tested":"Checked"," ",(0,se.jsx)("span",{className:"flex items-center justify-center gap-2.5 px-1 py-1 bg-gray-200 text-gray-700 rounded font-[400] text-xs",children:o})]})})}var hT=s(3252);const pT={create:["Creating","Created"],update:["Updating","Updated"],delete:["Deleting","Deleted"],toggle:["Toggling","Toggled"],list:["Listing","Listed"]};function gT(e){const{toolToAction:t,icon:s,iconSelector:a,itemLabel:n,pluralLabel:l,labelSelector:r,navigatePath:i,idFieldName:o,defaultNewName:c,actionArgName:d}=e;return function(e){let{toolCall:u,parsedArgs:m,messageId:x,isLastAssistantMessage:h,isLastRunningTool:p,debugInfo:g}=e;const f=(0,J.Zp)(),{app:v}=lp(),b=d&&(null==m?void 0:m[d])||t[u.name],j="running"===u.status,y="error"===u.status||"failed"===u.status,[N,w]=pT[b],_=a?a(m,u.name):s,{itemLabel:k,pluralLabel:C}=r?r(m,u.name):{itemLabel:n,pluralLabel:l},A=(()=>{if(m){if("create"===b){const e=m.name;return e&&e!==c?e:void 0}var e,t;if("update"===b)return m.name||m.automation_name||(null===(e=m[o])||void 0===e?void 0:e.slice(0,8));if("delete"===b||"toggle"===b)return m.automation_name||(null===(t=m[o])||void 0===t?void 0:t.slice(0,8))}})(),S="list"===b?C:k;return(0,se.jsx)(kS,{icon:e=>{let{className:t}=e;return(0,se.jsx)(_,{className:t})},status:u.status,isLastAssistantMessage:h,isLastRunningTool:p,onClick:()=>(null==v?void 0:v.id)&&f("/apps/".concat(v.id,"/editor/workspace/").concat(i)),messageId:x,toolCallId:u.id,debugInfo:g,children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[j?N:y?"Failed to ".concat(b):w," ",S,A&&(0,se.jsx)("span",{className:"px-1 py-[2px] bg-gray-200 text-gray-700 rounded text-xs",children:A})]})})}}const fT=e=>{let{className:t}=e;return(0,se.jsx)(jS.A,{className:t,size:16})},vT=e=>{let{className:t}=e;return(0,se.jsx)(hT.A,{className:t,size:16})},bT=e=>{let{className:t}=e;return(0,se.jsx)(yS.A,{className:t,size:16})},jT=gT({toolToAction:{create_scheduled_task:"create",update_scheduled_task:"update",delete_scheduled_task:"delete",toggle_scheduled_task:"toggle",list_scheduled_tasks:"list"},icon:fT,itemLabel:"scheduled automation",pluralLabel:"scheduled automations",navigatePath:"automations",idFieldName:"task_id",defaultNewName:"automation"}),yT=gT({toolToAction:{list_automations:"list",create_automation:"create",manage_automation:"update"},icon:bT,iconSelector:(e,t)=>{if("list_automations"===t)return bT;const s=null==e?void 0:e.automation_type;return"scheduled"===s?fT:"entity"===s?vT:bT},itemLabel:"automation",pluralLabel:"automations",labelSelector:(e,t)=>{if("list_automations"===t)return{itemLabel:"automation",pluralLabel:"automations"};const s=null==e?void 0:e.automation_type;return"scheduled"===s?{itemLabel:"scheduled automation",pluralLabel:"scheduled automations"}:"entity"===s?{itemLabel:"data automation",pluralLabel:"data automations"}:{itemLabel:"automation",pluralLabel:"automations"}},navigatePath:"automations",idFieldName:"automation_id",defaultNewName:"automation",actionArgName:"action"}),NT=jT,wT=yT,_T=e=>{let{className:t}=e;return(0,se.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:t,children:(0,se.jsx)("path",{d:"M9.33333 1.51318V4.26669C9.33333 4.64005 9.33333 4.82674 9.406 4.96935C9.46958 5.09488 9.57179 5.19709 9.69732 5.26067C9.83993 5.33335 10.0266 5.33335 10.4 5.33335H13.1535M9.33333 11.3334H4.66667M11.3333 8.66669H4.66667M13.3333 6.65888V11.4667C13.3333 12.5868 13.3333 13.1468 13.1154 13.5747C12.9236 13.951 12.6176 14.257 12.2413 14.4487C11.8134 14.6667 11.2534 14.6667 10.1333 14.6667H5.86667C4.74656 14.6667 4.18651 14.6667 3.75869 14.4487C3.38236 14.257 3.0764 13.951 2.88465 13.5747C2.66667 13.1468 2.66667 12.5868 2.66667 11.4667V4.53335C2.66667 3.41325 2.66667 2.85319 2.88465 2.42537C3.0764 2.04905 3.38236 1.74309 3.75869 1.55134C4.18651 1.33335 4.74656 1.33335 5.86667 1.33335H8.00779C8.49703 1.33335 8.74164 1.33335 8.97189 1.38861C9.17618 1.43771 9.37138 1.51856 9.55059 1.62831C9.75315 1.75243 9.92693 1.92621 10.2745 2.27378L12.3926 4.39191C12.7402 4.73948 12.914 4.91327 13.0381 5.11582C13.1478 5.29503 13.2287 5.49023 13.2778 5.69453C13.3333 5.92477 13.3333 6.16939 13.3333 6.65888Z",stroke:"#9CA3AF",strokeWidth:"1.33",strokeLinecap:"round",strokeLinejoin:"round"})})};function kT(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastRunningTool:n}=e;const l=t.status,r=(null==s?void 0:s.query)||"",i="running"===l,o=r.length>50?r.substring(0,50)+"...":r;return(0,se.jsx)(kS,{icon:_T,status:l,isLastAssistantMessage:a,isLastRunningTool:n,children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[i?"Searching":"Searched"," docs for"," ",(0,se.jsxs)("span",{className:"flex items-center justify-center gap-2.5 px-1 bg-gray-100 text-gray-700 rounded font-[400] text-xs",children:['"',o,'"']})]})})}function CT(e){let{toolCall:t,parsedArgs:s,isLastAssistantMessage:a,isLastMessageInChat:n=!1,isLastRunningTool:l}=e;const{submitToolCallInput:r}=lp(),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)({}),[u,m]=(0,Y.useState)({}),[x,h]=(0,Y.useState)(0),p=(0,Y.useRef)(!1),g=t.status,f=(Array.isArray(null==s?void 0:s.questions)?s.questions:[]).filter(e=>null!=e&&"object"==typeof e&&Array.isArray(e.options)&&e.options.length>=2&&e.options.length<=3&&e.options.every(e=>null!=e&&"object"==typeof e&&"label"in e)).slice(0,3),v="waiting_for_user_input"===g;(0,Y.useEffect)(()=>{v&&a&&n&&f.length>0&&!p.current&&(p.current=!0,Tu("Clarification Questions - Suggested",{number_of_questions:f.length,options_per_question:f.map(e=>e.options.length)}))},[v,a,n,f]);const b="success"===g,j=f[x],y=x===f.length-1,N=0===x,w=f.length>1,_=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];d(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:{question_index:e,selected_label:t.label}})),s||m(t=>{const s=(0,ue.A)({},t);return delete s[e],s})},k=async e=>{o(!0);try{const s=f.map((e,t)=>t).filter(t=>{var s;if(void 0!==e&&t===e)return!1;const a=c[t];return!!a&&!!("Something else"!==a.selected_label||null!==(s=u[t])&&void 0!==s&&s.trim())});if(0===s.length)return Tu("Clarification Questions - Submitted",{selected_answers:0,something_else_answers:0}),void await r(t.id,!1,{});const a=s.map(e=>(0,ue.A)((0,ue.A)({},c[e]),{},{custom_text:u[e]||void 0})),n=a.filter(e=>"Something else"!==e.selected_label).length,l=a.filter(e=>e.custom_text).length;Tu("Clarification Questions - Submitted",{selected_answers:n,something_else_answers:l}),await r(t.id,!0,{answers:a})}catch(s){}finally{o(!1)}},C=()=>{d(e=>{const t=(0,ue.A)({},e);return delete t[x],t}),m(e=>{const t=(0,ue.A)({},e);return delete t[x],t}),y?k(x):h(e=>e+1)},A=(e=>{const t=c[x];return!!t&&!!("Something else"!==t.selected_label||null!==(e=u[x])&&void 0!==e&&e.trim())})(),S=()=>{y||h(e=>e+1)},E=()=>{N||h(e=>e-1)};if(v&&a&&n){var T,I;if(0===f.length)return(0,se.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 space-y-3",children:[(0,se.jsx)("span",{className:"text-sm text-slate-600",children:"I wanted to ask clarifying questions but couldn't generate them properly."}),(0,se.jsx)("div",{className:"flex gap-2",children:(0,se.jsx)(Bx,{onClick:()=>k(),disabled:i,className:"text-sm",children:i?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):"Continue anyway"})})]});const e=((null==j?void 0:j.options)||[]).filter(e=>"something else"!==e.label.toLowerCase()),t={label:"Something else"};return(0,se.jsxs)("div",{className:"relative pb-2",children:[w&&!y&&(0,se.jsx)("div",{className:"absolute inset-x-2 top-2 bottom-0 rounded-xl border border-[#E6EBF1] bg-white opacity-80"}),(0,se.jsxs)("div",{className:"relative rounded-[14px] border border-[#DADEEC] pt-3 overflow-hidden",style:{background:"linear-gradient(0deg, rgba(241, 241, 241, 0.00) 39.67%, rgba(226, 232, 240, 0.84) 68.65%, rgba(226, 232, 240, 0.84) 100%), #FFF"},children:[(0,se.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-2 px-4",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-slate-800",children:null==j?void 0:j.question}),w&&(0,se.jsxs)("span",{className:"text-sm text-slate-400 flex-shrink-0",children:[x+1,"/",f.length]})]}),(0,se.jsxs)("div",{className:"rounded-t-[14px] border-t border-x border-[#CBD6E3] bg-white px-4 py-3",style:{boxShadow:"0 -2px 8px 0 rgba(14, 33, 75, 0.05), 0 0 1.6px 0 rgba(53, 71, 158, 0.10)"},children:[(0,se.jsxs)("div",{className:"space-y-3",children:[e.map((e,t)=>{var s;const a=(null===(s=c[x])||void 0===s?void 0:s.selected_label)===e.label;return(0,se.jsxs)("button",{onClick:()=>_(x,e),className:"w-full flex items-center gap-3 text-left group",children:[(0,se.jsx)("div",{className:de("w-[18px] h-[18px] rounded-full border-[1.5px] flex items-center justify-center flex-shrink-0 transition-colors",a?"border-slate-400":"border-slate-300 group-hover:border-slate-400"),children:a&&(0,se.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-slate-500"})}),(0,se.jsx)("span",{className:"text-sm text-slate-700",children:e.label})]},t)}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("button",{onClick:()=>_(x,t,!0),className:"flex-shrink-0",children:(0,se.jsx)("div",{className:de("w-[18px] h-[18px] rounded-full border-[1.5px] flex items-center justify-center transition-colors","Something else"===(null===(T=c[x])||void 0===T?void 0:T.selected_label)?"border-slate-400":"border-slate-300 hover:border-slate-400"),children:"Something else"===(null===(I=c[x])||void 0===I?void 0:I.selected_label)&&(0,se.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-slate-500"})})}),(0,se.jsx)("input",{type:"text",placeholder:"Something else",value:u[x]||"",onChange:e=>{return t=x,s=e.target.value,m(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:s})),void(s.trim()&&!c[t]&&_(t,{label:"Something else"},!0));var t,s},onFocus:()=>_(x,t,!0),className:"flex-1 text-sm text-slate-700 placeholder:text-slate-400 bg-slate-50 rounded-lg px-3 py-2 border border-slate-200 focus:outline-none focus:border-slate-300"})]})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,se.jsx)("div",{children:!N&&(0,se.jsx)(Bx,{variant:"outline",onClick:E,disabled:i,className:"h-8 px-3 text-sm text-slate-700 border-slate-200 hover:bg-slate-50",children:"\u2039 Back"})}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Bx,{variant:"ghost",onClick:C,disabled:i,className:"h-8 px-3 text-sm text-slate-600 hover:text-slate-800 hover:bg-transparent",children:"Skip"}),(0,se.jsx)(Bx,{onClick:y?()=>k():S,disabled:i||!A,className:"h-8 px-4 text-sm bg-slate-600 hover:bg-slate-700 text-white rounded-lg disabled:opacity-40",children:i?(0,se.jsx)(Ac.A,{className:"h-3.5 w-3.5 animate-spin"}):y?"Submit":"Next"})]})]})]})]})]})}if(b){var P;const e=new Set(((null===(P=t.user_input)||void 0===P?void 0:P.answers)||[]).map(e=>e.question_index)),s=f.filter((t,s)=>e.has(s)),a=s.length>1;return(0,se.jsx)("div",{className:"space-y-1",children:s.map((e,t)=>(0,se.jsxs)("div",{className:"text-sm text-slate-700",children:[a?"".concat(t+1,". "):"",e.question]},t))})}const L=v&&!n;return"stopped"===g?null:(0,se.jsx)(kS,{icon:Pj.A,status:L?"stopped":g,isLastAssistantMessage:a,isLastRunningTool:l,result:t.results,children:(0,se.jsx)("div",{className:"flex items-center gap-2",children:"running"===g?"Asking for clarification...":"error"===g?"Failed to ask clarification":L?"Clarification skipped":"Waiting for clarification"})})}const AT=e=>{let{className:t}=e;return(0,se.jsx)(hb.A,{className:t,size:16})};function ST(e){let{toolCall:t,messageId:s,isLastAssistantMessage:a,isLastRunningTool:n,debugInfo:l}=e;const r=t.status,i="running"===r;return(0,se.jsx)(kS,{icon:AT,status:r,isLastAssistantMessage:a,isLastRunningTool:n,messageId:s,toolCallId:t.id,debugInfo:l,children:(0,se.jsx)("div",{className:"flex items-center gap-2",children:i?"Searching for bugs...":"Searched bugs"})})}function ET(e){let{toolCall:t,messageId:s,isLastAssistantMessage:a,isLastMessageInChat:n=!1,isLastRunningTool:l,isLastTool:r=!1,isBlockedByPackage:i=!1,isInitialMessage:o=!1,messageContent:c=""}=e;const[d,u]=(0,Y.useState)(!1),m=(null==t?void 0:t.name)||"Function",x=(null==t?void 0:t.status)||"pending",h=null==t?void 0:t.results,p=null!=t&&t.arguments_string?dT(t.arguments_string):null,g=(()=>{if(!h)return null;try{return"string"==typeof h?JSON.parse(h):h}catch(e){return h}})(),f={write_file:ES,edit_file:ES,delete_file:LS,read_file:IS,create_entities:RS,create_entity_records:RS,read_entities:FS,update_entities:zS,delete_entities:US,set_secrets:VS,fetch_website:qS,search_web:GS,find_replace:$S,request_oauth_authorization:RE,suggest_stripe_installation:cT,install_npm_package:uT,test_backend_function:xT,create_scheduled_task:NT,update_scheduled_task:NT,delete_scheduled_task:NT,toggle_scheduled_task:NT,list_scheduled_tasks:NT,list_automations:wT,create_automation:wT,manage_automation:wT,search_base44_docs:kT,ask_clarifying_questions:CT,get_runtime_logs:ST}[m];if(f){if("find_replace"===m&&t.grouped)return(0,se.jsx)("div",{className:de("px-3 mb-2",r&&"running"===x&&"animate-pulse"),children:(0,se.jsx)(f,{toolCalls:t.toolCalls,filePath:t.filePath,messageId:s,isLastAssistantMessage:a,isLastRunningTool:l,isInitialMessage:o,messageContent:c})});const e=p||g?{input:p,output:g}:null;return(0,se.jsx)("div",{className:de("px-3 mb-2",r&&"running"===x&&"animate-pulse"),children:(0,se.jsx)(f,{toolCall:t,parsedArgs:p,messageId:s,isLastAssistantMessage:a,isLastMessageInChat:n,isLastRunningTool:l,isInitialMessage:o,messageContent:c,debugInfo:e})})}const v={pending:{icon:jS.A,color:"text-slate-400",text:i?"Pending approval...":"Pending"},waiting_for_user_input:{icon:jS.A,color:"text-slate-400",text:i?"Pending approval...":"Waiting for user input"},running:{icon:Ac.A,color:"text-slate-500",text:"Running...",spin:!0},success:{icon:hb.A,color:"text-green-600",text:"Success"},failed:{icon:ad.A,color:"text-red-500",text:"Failed"},error:{icon:ad.A,color:"text-red-500",text:"Failed"}}[x]||{icon:yS.A,color:"text-slate-500",text:""},b=v.icon,j=m.split(".").reverse().join(" ").toLowerCase(),y=(()=>{if(!p)return"";if("write_file"===m||"read_file"===m){return p.file_path||""}if("fetch_website"===m){const e=p.url||"";return e.length>50?e.substring(0,50)+"...":e}if("search_web"===m){const e=p.query||"";return e.length>40?e.substring(0,40)+"...":e}if("stripe_create_price"===m){const e=p.unit_amount,t=(p.currency||"usd").toUpperCase(),s=p.recurring_interval;if(void 0!==e){const a="".concat(t," ").concat((e/100).toFixed(2));return s?"".concat(a,"/").concat(s):a}return""}const e=Object.keys(p)[0];if(e){const t=p[e],s="string"==typeof t?t:JSON.stringify(t),a=s.length>30?s.substring(0,30)+"...":s;return"".concat(e,": ").concat(a)}return""})();return(0,se.jsxs)("div",{className:de("text-xs",r&&"running"===x&&"animate-pulse"),children:[(0,se.jsxs)("button",{onClick:()=>u(!d),className:de("flex items-center gap-2 px-3 py-1.5 rounded-lg border transition-all","hover:bg-slate-50",d?"bg-slate-50 border-slate-300":"bg-white border-slate-200"),children:[(0,se.jsx)(b,{className:de("h-3 w-3",v.color,v.spin&&"animate-spin")}),(0,se.jsx)("span",{className:"text-slate-700",children:j}),y&&(0,se.jsx)("span",{className:"text-slate-600 font-mono text-xs bg-slate-100 px-1.5 py-0.5 rounded",children:y}),!v.spin&&(t.arguments_string||h)&&(0,se.jsx)(bs.A,{className:de("h-3 w-3 text-slate-400 transition-transform ml-auto",d&&"rotate-90")})]}),d&&!v.spin&&(0,se.jsxs)("div",{className:"mt-1.5 ml-3 pl-3 border-l-2 border-slate-200 space-y-2",children:[t.arguments_string&&(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Parameters:"}),(0,se.jsx)("pre",{className:"bg-slate-50 rounded-md p-2 text-xs text-slate-600 whitespace-pre-wrap",children:(()=>{try{const e=dT(t.arguments_string);return 0===Object.keys(e).length&&t.arguments_string.trim()?t.arguments_string:JSON.stringify(e,null,2)}catch(e){return t.arguments_string}})()})]}),g&&(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Result:"}),(0,se.jsx)("pre",{className:"bg-slate-50 rounded-md p-2 text-xs text-slate-600 whitespace-pre-wrap max-h-48 overflow-auto",children:"object"==typeof g?JSON.stringify(g,null,2):g})]})]}),"request_secrets"===m&&"success"===x&&(()=>{try{const e=JSON.parse(h);if("request_secrets"===e.type&&e.secrets)return(0,se.jsx)("div",{className:"mt-2",children:(0,se.jsx)(Sb,{content:e.secrets})})}catch(e){}return null})()]})}const TT=e=>{let{item:t,isInitialMessage:s}=e;const a=t.tool_calls||[],n=t.id,l=t.content||"",r=t.isLastAssistantMessage||!1,i=t.isLastMessageInChat||!1,[o,c]=(0,Y.useState)(!0);if(!a||0===a.length)return null;const d=[],u={};a.forEach(e=>{if("find_replace"===e.name)try{const t="string"==typeof e.arguments_string?dT(e.arguments_string):e.arguments_string,s=(null==t?void 0:t.file_path)||"unknown";u[s]||(u[s]=[]),u[s].push(e)}catch(t){d.push(e)}else d.push(e)}),Object.entries(u).forEach(e=>{var t;let[s,a]=e;d.push({name:"find_replace",grouped:!0,filePath:s,toolCalls:a,status:(null===(t=a[0])||void 0===t?void 0:t.status)||"pending"})});const m=[...d].sort((e,t)=>{var s,a,n,l;const r="install_npm_package"===e.name||e.grouped&&(null===(s=e.toolCalls)||void 0===s?void 0:s.some(e=>"install_npm_package"===e.name)),i="install_npm_package"===t.name||t.grouped&&(null===(a=t.toolCalls)||void 0===a?void 0:a.some(e=>"install_npm_package"===e.name)),o="waiting_for_user_input"===e.status||e.grouped&&(null===(n=e.toolCalls)||void 0===n?void 0:n.some(e=>"waiting_for_user_input"===e.status)),c="waiting_for_user_input"===t.status||t.grouped&&(null===(l=t.toolCalls)||void 0===l?void 0:l.some(e=>"waiting_for_user_input"===e.status));return!r||!o||i&&c?!i||!c||r&&o?r&&!i&&c?-1:i&&!r&&o?1:0:1:-1}),x=m.map((e,t)=>e.grouped&&e.toolCalls?e.toolCalls.some(e=>"running"===e.status)?t:-1:"running"===e.status?t:-1).filter(e=>-1!==e),h=x.length>0?x[x.length-1]:-1,p=m.some(e=>{var t;return"install_npm_package"===e.name&&"waiting_for_user_input"===e.status||!(!e.grouped||null===(t=e.toolCalls)||void 0===t||!t.some(e=>"install_npm_package"===e.name&&"waiting_for_user_input"===e.status))}),g=1===m.length;return(0,se.jsx)("div",{className:"",children:(0,se.jsxs)(se.Fragment,{children:[!g&&(0,se.jsx)("div",{className:"flex items-center gap-2 px-3",children:(0,se.jsx)("span",{className:"text-sm text-slate-700 font-medium",children:-1===h&&p?"Waiting for approval...":""})}),o&&(0,se.jsx)("div",{className:"",children:m.map((e,t)=>{var a;const o=["write_file","find_replace","delete_file"].includes(e.name||""),c=p&&"install_npm_package"!==e.name&&("waiting_for_user_input"===e.status||o&&"running"===e.status)&&!(e.grouped&&null!==(a=e.toolCalls)&&void 0!==a&&a.some(e=>"install_npm_package"===e.name));return(0,se.jsx)(ET,{toolCall:e,messageId:n,isLastAssistantMessage:r,isLastMessageInChat:i,isLastRunningTool:t===h,isLastTool:t===m.length-1,isBlockedByPackage:c,isInitialMessage:s,messageContent:l},t)})})]})})};var IT=s(72215);const PT=rt.Root,LT=rt.Trigger,MT=Y.forwardRef((e,t)=>(0,se.jsx)(sl,(0,ue.A)({ref:t},e)));MT.displayName=rt.Content.displayName;const RT="admin_analysis_strip_visible";let DT="undefined"!=typeof window&&"true"===localStorage.getItem(RT);const FT=new Set;function OT(){const[e,t]=(0,Y.useState)(DT);(0,Y.useEffect)(()=>{const e=e=>t(e);return FT.add(e),()=>{FT.delete(e)}},[]);return[e,e=>{DT=e,localStorage.setItem(RT,String(e)),FT.forEach(t=>t(e))}]}const UT={visual:{abbr:"vis",label:"Visual Change",color:"text-green-600"},feature:{abbr:"feat",label:"New Feature",color:"text-blue-600"},bug:{abbr:"bug",label:"Bug Fix",color:"text-orange-600"},refactor:{abbr:"refac",label:"Refactor",color:"text-purple-600"},question:{abbr:"?",label:"Question",color:"text-gray-600"}},BT=["\u{1f60a}","\u{1f610}","\u{1f615}","\u{1f624}","\u{1f92c}"],zT={is_web_app:{icon:"\u{1f310}",label:"Web App"},is_website:{icon:"\u{1f4c4}",label:"Website"},is_saas:{icon:"\u{1f4bc}",label:"SaaS"},is_game:{icon:"\u{1f3ae}",label:"Game"},is_ai_based:{icon:"\u{1f916}",label:"AI-Based"},is_internal_tool:{icon:"\u{1f527}",label:"Internal Tool"},is_marketplace:{icon:"\u{1f3ea}",label:"Marketplace"},is_mobile_app:{icon:"\u{1f4f1}",label:"Mobile App"}};function HT(e){return"vision_clarity"in e}const VT={frustration:"bg-red-50 border-red-200",loop:"bg-orange-50 border-orange-200",vague_hard:"bg-yellow-50 border-yellow-200"};function WT(e){let{value:t,max:s=5,label:a}=e;return(0,se.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,se.jsx)("span",{className:"text-gray-500 w-20",children:a}),(0,se.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:s}).map((e,s)=>(0,se.jsx)("div",{className:"w-3 h-2 rounded-sm ".concat(s<t?"bg-slate-600":"bg-slate-200")},s))}),(0,se.jsxs)("span",{className:"text-gray-400 text-[10px]",children:[t,"/",s]})]})}function qT(e){let{analysis:t}=e;if(HT(t)){const e=Object.entries(zT).filter(e=>{let[s]=e;return t[s]}).map(e=>{let[,{icon:t}]=e;return t}).slice(0,3).join("");return(0,se.jsxs)("span",{className:"text-[10px] text-gray-500 font-mono tracking-tight",children:[e," \xb7 cx",t.estimated_complexity," \xb7 v",t.vision_clarity]})}if(!HT(t)){const e=function(e){return e.is_visual_change?"visual":e.is_new_feature?"feature":e.is_bug_fix?"bug":e.is_refactor?"refactor":e.is_question?"question":null}(t),s=e?UT[e]:null,a=BT[t.frustration_level-1]||"\u{1f60a}";return(0,se.jsxs)("span",{className:"text-[10px] text-gray-500 font-mono tracking-tight",children:[s&&(0,se.jsx)("span",{className:s.color,children:s.abbr})," \xb7 ","d",t.difficulty," \xb7 c",t.request_clarity," \xb7 ",a,t.stuck_in_loop&&(0,se.jsxs)("span",{className:"text-orange-500",children:[" \xb7 \u21ba",t.loop_count]})]})}return null}function YT(e){let{label:t,value:s,color:a}=e;const n="boolean"==typeof s?s?"yes":"no":s;return(0,se.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,se.jsx)("span",{className:"text-gray-400",children:t}),(0,se.jsx)("span",{className:a||"text-gray-600",children:n})]})}function GT(e){let{analysis:t}=e;if(HT(t)){const e=[t.is_web_app&&"web_app",t.is_website&&"website",t.is_saas&&"saas",t.is_game&&"game",t.is_ai_based&&"ai_based",t.is_internal_tool&&"internal_tool",t.is_marketplace&&"marketplace",t.is_mobile_app&&"mobile_app"].filter(Boolean).join(", ")||"none";return(0,se.jsxs)("div",{className:"space-y-2 text-xs min-w-[220px]",children:[(0,se.jsx)("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-2",children:"First Prompt Analysis"}),(0,se.jsx)(WT,{value:t.vision_clarity,label:"Vision"}),(0,se.jsx)(WT,{value:t.estimated_complexity,label:"Complexity"}),(0,se.jsxs)("div",{className:"border-t border-gray-100 pt-2 mt-2 space-y-1",children:[(0,se.jsx)(YT,{label:"app_types",value:e}),(0,se.jsx)(YT,{label:"target_industry",value:t.target_industry||"unknown"})]})]})}if(!HT(t)){const e=[t.is_visual_change&&"visual",t.is_bug_fix&&"bug_fix",t.is_new_feature&&"new_feature",t.is_refactor&&"refactor",t.is_question&&"question"].filter(Boolean).join(", ")||"none";return(0,se.jsxs)("div",{className:"space-y-2 text-xs min-w-[220px]",children:[(0,se.jsx)("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-2",children:"Prompt Analysis"}),(0,se.jsx)(WT,{value:t.difficulty,label:"Difficulty"}),(0,se.jsx)(WT,{value:t.request_clarity,label:"Clarity"}),(0,se.jsx)(WT,{value:t.frustration_level,label:"Frustration"}),(0,se.jsxs)("div",{className:"border-t border-gray-100 pt-2 mt-2 space-y-1",children:[(0,se.jsx)(YT,{label:"request_type",value:e}),(0,se.jsx)(YT,{label:"files_affected",value:t.estimated_files_affected}),(0,se.jsx)(YT,{label:"iteration_on_prev",value:t.is_iteration_on_previous}),(0,se.jsx)(YT,{label:"prev_change_ok",value:null===t.previous_change_successful?"n/a":t.previous_change_successful,color:!0===t.previous_change_successful?"text-green-600":!1===t.previous_change_successful?"text-red-600":void 0}),(0,se.jsx)(YT,{label:"stuck_in_loop",value:t.stuck_in_loop?"yes (".concat(t.loop_count,"x)"):"no",color:t.stuck_in_loop?"text-orange-600":void 0})]})]})}return null}function KT(e){let{enabled:t,onChange:s}=e;return t?(0,se.jsx)("button",{onClick:()=>s(!1),className:"text-[10px] text-gray-400 hover:text-gray-600 mt-3 pt-2 border-t border-gray-100 w-full text-left",children:"stop showing strip"}):(0,se.jsxs)("label",{className:"flex items-center gap-2 text-[10px] text-gray-500 cursor-pointer mt-3 pt-2 border-t border-gray-100",children:[(0,se.jsx)("input",{type:"checkbox",checked:t,onChange:e=>s(e.target.checked),className:"w-3 h-3 rounded border-gray-300 text-slate-600 focus:ring-slate-500"}),"Always show strip"]})}function $T(e){let{analysis:t}=e;const[s,a]=OT(),n=function(e){return HT(e)?null:e.frustration_level>=4?"frustration":e.stuck_in_loop&&e.loop_count>=3?"loop":e.request_clarity<=2&&e.difficulty>=4?"vague_hard":null}(t),l=n?VT[n]:"";return s?(0,se.jsx)("div",{className:"mt-1",children:(0,se.jsxs)(PT,{openDelay:100,closeDelay:100,children:[(0,se.jsx)(LT,{asChild:!0,children:(0,se.jsx)("button",{className:"cursor-pointer hover:opacity-70 transition-opacity ".concat(l?"px-1.5 py-0.5 rounded ".concat(l):""),children:(0,se.jsx)(qT,{analysis:t})})}),(0,se.jsxs)(MT,{className:"w-auto min-w-[220px] p-3",align:"end",side:"top",sideOffset:8,children:[(0,se.jsx)(GT,{analysis:t}),(0,se.jsx)(KT,{enabled:s,onChange:a})]})]})}):null}const ZT=e=>{var t;let{conversationMessage:s,loopMessageWithCredits:a,userMessageAnalysis:n}=e;const{app:l}=lp(),{user:r}=wd(),{toast:i}=ao(),[o,c]=(0,Y.useState)(!1),d=a||s,u=null==d||null===(t=d.usage)||void 0===t?void 0:t.credits_charged,m="number"==typeof u,x=$p(null==r?void 0:r.platform_role),h=null==d?void 0:d.usage,p=h?(h.prompt_tokens||0)+(h.completion_tokens||0):0,g=null==d?void 0:d.model,[f,v]=OT(),b=x&&n&&!f;return(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{size:"xTiny",variant:"ghost",children:(0,se.jsx)(Nv.A,{size:16})})}),(0,se.jsxs)(Aj,{align:"end",className:"min-w-[200px]",children:[(0,se.jsx)(Sj,{asChild:!0,onClick:()=>{const e="".concat(window.location.origin,"/apps/").concat(null==l?void 0:l.id,"/editor/preview?msgId=").concat(s.id);navigator.clipboard.writeText(e),i({title:"Copied to clipboard",variant:"success",description:"The link to this message has been copied to your clipboard.",duration:2e3})},className:"rounded-[8px]",children:(0,se.jsx)("div",{className:"flex flex-row justify-between",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)("div",{className:"relative",children:(0,se.jsx)(Jx.A,{size:16})}),"Copy message link"]})})}),m&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Tj,{}),(0,se.jsx)(Sj,{asChild:!0,className:"rounded-[8px] pointer-events-none text-gray-500",children:(0,se.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,se.jsx)("span",{children:"Credits Used"}),(0,se.jsx)("span",{children:u.toFixed(1)})]})}),(0,se.jsx)("a",{href:"https://docs.base44.com/Account-and-billing/Credits#credits",target:"_blank",className:"text-xs text-blue-500 hover:text-blue-600 cursor-pointer px-2 pb-1",children:"How credits usage works"})]}),x&&(g||b)&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Tj,{}),(0,se.jsxs)("div",{className:"px-2 py-1.5 text-[10px] text-gray-400 cursor-default",children:[(0,se.jsx)("strong",{children:"Admin info:"}),g&&(0,se.jsxs)("div",{className:"mt-1 truncate max-w-[200px]",title:p>0?"Model: ".concat(g,"\nTokens: ").concat(p.toLocaleString()):void 0,children:[g," ",p>0&&"(".concat(p.toLocaleString()," tok)")]}),b&&n&&(0,se.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[(0,se.jsxs)("button",{onClick:()=>c(!o),className:"flex items-center gap-1.5 text-gray-500 hover:text-gray-700 transition-colors w-full",children:[(0,se.jsx)(IT.A,{className:"w-3 h-3"}),(0,se.jsx)("span",{children:"Prompt Analysis"}),o?(0,se.jsx)(ur.A,{className:"w-3 h-3 ml-auto"}):(0,se.jsx)(_t.A,{className:"w-3 h-3 ml-auto"})]}),o&&(0,se.jsxs)("div",{className:"mt-2",children:[(0,se.jsx)(GT,{analysis:n}),(0,se.jsx)(KT,{enabled:f,onChange:v})]})]})]})]})]})]})},JT=e=>{let{files:t}=e;const[s,a]=(0,Y.useState)(!1);if(!t||0===t.length)return null;const n=t.reduce((e,t)=>(t.startsWith("entities/")?e.entities.push(t):t.startsWith("pages/")||t.startsWith("components/")||t.startsWith("layout")?e.code.push(t):e.other.push(t),e),{entities:[],code:[],other:[]});return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"text-xs text-gray-400 cursor-pointer hover:underline",onClick:()=>a(!0),children:(0,se.jsxs)("span",{className:"flex items-center gap-1",children:[(0,se.jsx)(xb.A,{className:"h-3 w-3"}),"see context"]})}),s&&(0,se.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,se.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[80vh] flex flex-col",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center p-4 border-b dark:border-gray-700",children:[(0,se.jsx)("h3",{className:"font-medium text-lg",children:"Files Selected for Context"}),(0,se.jsx)("button",{onClick:()=>a(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:(0,se.jsx)(la.A,{className:"h-5 w-5"})})]}),(0,se.jsxs)("div",{className:"p-5 overflow-y-auto flex-1",children:[(0,se.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-5",children:["In complex projects, for every user message, the platform automatically selects which code files ",(0,se.jsx)("b",{children:"might"})," be relevant for potential changes."]}),(0,se.jsxs)("p",{className:"text-sm text-teal-700 dark:text-teal-400 mb-5 border-l-2 border-teal-600 pl-3",children:[(0,se.jsx)("b",{children:"Important:"})," If you intended to modify a file that doesn't appear in this list, the AI might get confused and make changes in the wrong place or not make the changes at all. Consider mentioning the specific file path in your message for better results."]}),n.code.length>0&&(0,se.jsxs)("div",{className:"mb-5",children:[(0,se.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",children:[(0,se.jsx)(Jv.A,{className:"h-4 w-4"}),"Code Files"]}),(0,se.jsx)("div",{className:"space-y-1 pl-2",children:n.code.map((e,t)=>(0,se.jsx)("div",{className:"text-sm py-1.5 px-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-100 dark:border-blue-800 text-gray-800 dark:text-gray-200",children:e},t))})]}),n.entities.length>0&&(0,se.jsxs)("div",{className:"mb-5",children:[(0,se.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",children:[(0,se.jsx)(fv.A,{className:"h-4 w-4"}),"Entity Files"]}),(0,se.jsx)("div",{className:"space-y-1 pl-2",children:n.entities.map((e,t)=>(0,se.jsx)("div",{className:"text-sm py-1.5 px-3 bg-purple-50 dark:bg-purple-900/20 rounded border border-purple-100 dark:border-purple-800 text-gray-800 dark:text-gray-200",children:e},t))})]}),n.other.length>0&&(0,se.jsxs)("div",{children:[(0,se.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",children:[(0,se.jsx)(xb.A,{className:"h-4 w-4"}),"Other Files"]}),(0,se.jsx)("div",{className:"space-y-1 pl-2",children:n.other.map((e,t)=>(0,se.jsx)("div",{className:"text-sm py-1.5 px-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-100 dark:border-gray-600 text-gray-800 dark:text-gray-200",children:e},t))})]})]}),(0,se.jsx)("div",{className:"p-4 border-t dark:border-gray-700 flex justify-end",children:(0,se.jsx)("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 rounded text-sm font-medium transition-colors",children:"Close"})})]})})]})};function QT(e){var t,s,a,n,l,r,i,o;let{item:c,undoMessage:d,itemIndex:u}=e;const{app:m}=lp(),{user:x}=wd(),h="user"===c.role,p=h&&((null===(t=c.content)||void 0===t?void 0:t.split("\n").length)>3||(null===(s=c.content)||void 0===s?void 0:s.length)>200),[g,f]=(0,Y.useState)(p),[v,b]=(0,Y.useState)(!h),j=uh(),y=$p(null==x?void 0:x.platform_role)&&c.prompt_analysis&&h,N=(0,Y.useCallback)(e=>{b(e)},[]);if(null===(a=c.additional_message_params)||void 0===a?void 0:a.automated_fix)return(0,se.jsx)("div",{className:"mb-6 relative",children:(0,se.jsx)(Bb,{message:c})});if(null===(n=c.additional_message_params)||void 0===n?void 0:n.diff_message)return(0,se.jsx)("div",{className:"mb-6 relative",children:(0,se.jsx)(Gb,{message:c})});if("github_sync"===(null===(l=c.additional_message_params)||void 0===l?void 0:l.type))return(0,se.jsx)(vS,{message:c});const w=null===(r=c.custom_context)||void 0===r?void 0:r.find(e=>{var t;return"files"===e.type&&(null===(t=e.data)||void 0===t?void 0:t.files)}),_=(null==w||null===(i=w.data)||void 0===i?void 0:i.files)||[],k="user"===c.role||c.isLastAssistantMessage;return(0,se.jsxs)("div",{className:"".concat(k?"mb-6":"mb-2"," relative ").concat(h?"flex justify-end":""),children:["assistant"===c.role&&c.isFirstAssistantMessage&&(0,se.jsxs)("div",{className:"flex flex-row justify-between mr-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)("img",{src:Wx,alt:"Base44 AI",className:"w-6 h-6 object-cover rounded-full opacity-75"}),(0,se.jsx)("span",{className:"text-xs text-gray-500",children:"Base44"})]}),(0,se.jsx)(ZT,{conversationMessage:c,loopMessageWithCredits:c.loopMessageWithCredits,userMessageAnalysis:c.previousUserAnalysis})]}),(0,se.jsx)(bS,{reasoning:c.reasoning}),(0,se.jsxs)("div",{className:"text-sm ps-2 rounded-lg ".concat(h?"pr-4 bg-slate-200 max-w-[85%] py-4 relative":"pl-8"),children:[p&&(0,se.jsx)("button",{onClick:()=>f(!g),className:"absolute top-2 right-2 p-1 text-gray-400 hover:text-gray-600 transition-colors z-10",children:g?(0,se.jsx)(_t.A,{className:"h-4 w-4"}):(0,se.jsx)(ur.A,{className:"h-4 w-4"})}),(0,se.jsxs)("div",{className:p&&g?"line-clamp-3":"",children:[c.custom_context&&c.custom_context.map((e,t)=>{var s;if("element"===e.type&&null!==(s=e.data)&&void 0!==s&&s.element_tag_name){const s=e.data.element_tag_name.toLowerCase(),a=qb[s]||(0,se.jsx)(Jv.A,{className:"h-3 w-3"});return(0,se.jsx)("div",{className:"mb-2 flex items-center gap-2 text-xs",children:(0,se.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-900 text-white rounded-md",children:[a,(0,se.jsx)("span",{children:s})]})},t)}return null}),c.file_urls&&c.file_urls.length>0&&(0,se.jsx)("div",{className:"mb-4 flex flex-wrap gap-4",children:c.file_urls.map((e,t)=>(0,se.jsx)("div",{className:"relative",children:e.match(/\.(jpg|jpeg|png|gif)$/i)?(0,se.jsx)("img",{src:e,alt:"Attached content",className:"max-w-[300px] max-h-[300px] rounded-lg border border-gray-200 shadow-sm"}):(0,se.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-white rounded-lg border border-gray-200",children:[(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-500",children:[(0,se.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,se.jsx)("polyline",{points:"14 2 14 8 20 8"})]}),(0,se.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Attached file"})]})},t))}),(0,se.jsx)(Ub,{content:c.content,msgId:c.id,role:c.role,onTypingStateChange:N}),!v&&(0,se.jsx)(TT,{item:c,isInitialMessage:u<=1}),(null===(o=c.metadata)||void 0===o?void 0:o.created_date)&&("user"===c.role||c.isLastAssistantMessage)&&(0,se.jsxs)("div",{className:"text-xs text-gray-400 mt-2 flex items-center",children:[He().utc(c.metadata.created_date,He().ISO_8601).fromNow(),"user"===c.role&&_.length>0&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"mx-2",children:"\u2022"}),(0,se.jsx)(JT,{files:_})]})]}),y&&(0,se.jsx)($T,{analysis:c.prompt_analysis})]})]}),"user"===c.role&&u>0&&c.checkpoint_id&&(0,se.jsx)("div",{className:"cursor-pointer absolute bottom-[-10px] right-0 bg-white border border-gray-200 rounded-md p-1 text-xs text-gray-400",children:(0,se.jsxs)("a",{onClick:()=>{window.confirm("Are you sure you want to undo this message? This will load the state of the app before this message.")&&(Tu("User clicked - revert this",{app_id:null==m?void 0:m.id,message_id:c.id}),Vu(j,{cta:"revert this",origin:"chat_message",message_id:c.id,target_route:null}),d(c.id))},className:"flex items-center gap-1",children:[(0,se.jsx)(Yb.A,{className:"h-3 w-3"}),"Revert this"]})})]})}class XT extends Y.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){Pd(e,{source:Id.REACT,component:"MessageErrorBoundary",context:{componentStack:t.componentStack}})}render(){return this.state.hasError?(0,se.jsx)("div",{className:"mx-4 my-3 px-6 py-4 rounded-lg bg-slate-50 border border-slate-200 text-slate-600 text-base",children:(0,se.jsx)("p",{className:"text-sm",children:"Could not render this message. It might contain special characters."})}):this.props.children}}const eI=e=>{let{undoMessage:t}=e;const s=(0,Y.useRef)(null),a=gu.useEnrichedMessages(),n=gu.useHasMore(),l=gu.useIsLoading(),[r,i]=(0,Z.useSearchParams)(),{toast:o}=ao();return(0,Y.useEffect)(()=>{const e=r.get("msgId");if(!e)return;r.delete("msgId"),i(r);(async()=>{const{dismiss:t}=o({title:"Loading previous messages...",description:"",variant:"warning",dismissible:!0,duration:5e3});await gu.loadUptoMessage({messageId:e}),gu.hasMessage(e)&&setTimeout(()=>{const s=document.getElementById("message-".concat(e));null==s||s.scrollIntoView({behavior:"smooth",block:"center"}),t()},1e3)})()},[r]),(0,se.jsxs)("div",{ref:s,className:"relative",children:[n&&(0,se.jsx)("div",{className:"flex justify-center py-2",children:(0,se.jsxs)("button",{onClick:()=>gu.loadMore({}),disabled:l,className:"text-sm text-blue-500 hover:text-blue-600 hover:underline disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[l&&(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin"}),"Load previous messages"]})}),a.map((e,s)=>(0,se.jsx)("div",{id:"message-".concat(e.id),children:(0,se.jsx)(XT,{children:(0,se.jsx)(QT,{item:e,itemIndex:s,undoMessage:t})})},e.id||s))]})},tI=e=>{let{status:t}=e;const[s,a]=(0,Y.useState)(!1),n=t.details||"",l=n.length>150;return(0,se.jsx)("div",{className:"mx-4 my-3 px-4 py-3 rounded-lg bg-red-50 border border-red-200 text-red-700 text-xs",children:(0,se.jsxs)("div",{className:"flex items-start gap-2",children:[l&&(0,se.jsx)("button",{onClick:()=>a(!s),className:"flex-shrink-0 mt-0.5 hover:bg-red-100 rounded p-0.5 transition-colors",children:s?(0,se.jsx)(_t.A,{className:"w-4 h-4"}):(0,se.jsx)(bs.A,{className:"w-4 h-4"})}),(0,se.jsx)("div",{className:"flex-1 min-w-0 ".concat(l&&!s?"line-clamp-2":""," break-words"),children:n})]})})};function sI(e){let{status:t}=e;const[s,a]=(0,Y.useState)((new Date).getTime()),[n,l]=(0,Y.useState)(window.innerWidth<=768),r=gu.useEnrichedMessages();(0,Y.useEffect)(()=>{const e=()=>{l(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,Y.useEffect)(()=>{const e=new Date(t.last_updated_date).getTime();a(t=>!t||e>t?e:t)},[t.last_updated_date]),(0,Y.useEffect)(()=>{"processing"===t.state&&a((new Date).getTime())},[t.state]);const i=(s&&"processing"===t.state&&null!=r&&r.length?(new Date).getTime()-new Date(s).getTime():0)>6e5,o=n||(null==r?void 0:r.length)>2;return(0,se.jsxs)("div",{children:["error"===t.state&&(0,se.jsx)(tI,{status:t}),"processing"===t.state&&(0,se.jsxs)("div",{className:"",children:[i&&(0,se.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["This has been running for a while. It might be stuck.",(0,se.jsxs)("div",{className:"mt-1",children:["If this persists, try to stop the chat, *revert your last message* and try again, or ",(0,se.jsx)("button",{type:"button",onClick:()=>gd("/support"),className:"underline text-primary hover:text-orange-500 transition-colors",children:"contact support"}),"."]})]}),o&&(0,se.jsxs)("div",{className:"text-gray-500 mt-3 ml-4 flex items-center gap-2",children:[(0,se.jsx)("img",{src:Wx,alt:"Logo",className:"w-4 h-4 grayscale"}),(0,se.jsx)(zx,{status:t.details,className:"text-xs"})]})]})]})}const aI=["starter","builder","pro","elite","elite_2","elite_3","elite_4","elite_5","elite_6","elite_7","elite_8","elite_9"];function nI(e){return e&&"free"!==e.toLowerCase()?Iw(e)?"yearly":"monthly":"yearly"}function lI(e){if(!e||"free"===e.toLowerCase())return"starter";const t=Pw(e),s=aI.indexOf(t);return-1===s||s===aI.length-1?null:aI[s+1]}function rI(e){if(null==e||!e.metadata)return{messageCredits:0,integrationCredits:0};return{messageCredits:parseInt(e.metadata.monthly_message_limit||"0",10),integrationCredits:parseInt(e.metadata.monthly_integration_credits||"0",10)}}function iI(e){return Tw(e)}function oI(e){if(!e)return"";return{starter:"Starter",builder:"Builder",pro:"Pro",elite:"Elite",elite_2:"Elite 2",elite_3:"Elite 3",elite_4:"Elite 4",elite_5:"Elite 5",elite_6:"Elite 6",elite_7:"Elite 7",elite_8:"Elite 8",elite_9:"Elite 9"}[e]||e}function cI(e,t){const s=nI(e),a=lI(e),n=function(e,t){if(null==t||!t.pricing)return null;const s=lI(e);return s&&("yearly"===nI(e)?t.pricing.yearly:t.pricing.monthly)[s]||null}(e,t);return{currentTier:e||"free",nextTier:a,billingPeriod:s,nextPlan:n}}function dI(e,t){const s=function(e){let{currentUsage:t,stats:s}=e;const[a,n]=(0,Y.useState)(!0),[l,r]=(0,Y.useState)(null),i=(0,Y.useMemo)(()=>{if(!t||!s)return{currentPlan:null,nextPlan:null,billingPeriod:"yearly"};try{var e;const a=cI(t.tier,s);return{currentPlan:null!==(e=s.stripe_subscription)&&void 0!==e&&e.plan&&Object.values(s.pricing.monthly).concat(Object.values(s.pricing.yearly)).find(e=>{var t,a;return e.id===(null===(t=s.stripe_subscription)||void 0===t||null===(a=t.plan)||void 0===a?void 0:a.id)})||null,nextPlan:a.nextPlan,billingPeriod:a.billingPeriod}}catch(a){return r("Failed to calculate billing information"),{currentPlan:null,nextPlan:null,billingPeriod:"yearly"}}},[t,s]);return(0,Y.useEffect)(()=>{null!==t&&null!==s?(n(!1),r(null)):n(!0)},[t,s]),{currentPlan:i.currentPlan,nextPlan:i.nextPlan,billingPeriod:i.billingPeriod,isLoading:a,error:l}}({currentUsage:e,stats:t}),a=(0,Y.useMemo)(()=>s.nextPlan?rI(s.nextPlan):{messageCredits:0,integrationCredits:0},[s.nextPlan]);return(0,ue.A)((0,ue.A)({},s),{},{nextPlanCredits:a,hasNextPlan:null!==s.nextPlan})}const uI=s.p+"static/media/credits.354a5e89258e9a8ef11bed837f5192db.svg",mI=["className","children"],xI=e=>{let{className:t,children:s}=e,a=(0,Nt.A)(e,mI);return(0,se.jsxs)(gt.Portal,{children:[(0,se.jsx)(Ig,{className:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,se.jsx)(gt.Content,(0,ue.A)((0,ue.A)({className:de("fixed left-[50%] top-[50%] z-50 w-full translate-x-[-50%] translate-y-[-50%] shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-[16px]","max-w-[90vw] h-[90vh] overflow-hidden",t),style:{background:"linear-gradient(148deg, rgba(242, 225, 208, 0.3) 3.86%, rgba(227, 232, 241, 0.3) 100%), rgb(248, 250, 252)"}},a),{},{children:s}))]})},hI=e=>{let{isOpen:t,onClose:s,onSubscriptionSuccess:a}=e;return(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsx)(xI,{className:"bg-white",children:(0,se.jsxs)("div",{className:"h-full flex flex-col",children:[(0,se.jsx)("div",{className:"flex-shrink-0 flex items-center justify-end px-6 pt-4",children:(0,se.jsxs)("button",{onClick:s,className:"h-8 w-8 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 flex items-center justify-center",children:[(0,se.jsx)(la.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Close"})]})}),(0,se.jsx)("div",{className:"flex-1 overflow-auto",children:(0,se.jsx)(l_,{})})]})})})},pI=()=>(0,se.jsx)("div",{className:"flex items-center justify-center w-[18px] h-[18px]",children:(0,se.jsx)("img",{src:uI,alt:"",className:"w-[14px] h-[14px]"})}),gI=e=>{let{stats:t,onUpgradeClick:s,isLoading:a=!1}=e;const[n,l]=(0,Y.useState)({hours:0,minutes:0,seconds:0}),r=(0,Y.useMemo)(()=>xv(t),[t]);(0,Y.useEffect)(()=>{const e=()=>{const e=new Date,t=r.getTime()-e.getTime();if(t>0){const e=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4),a=Math.floor(t%6e4/1e3);l({hours:e,minutes:s,seconds:a})}else l({hours:0,minutes:0,seconds:0})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[r]);const i=e=>String(e).padStart(2,"0"),o=mv(uv);return(0,se.jsx)("div",{className:"border border-[#ff631f] rounded-[10px] p-3 w-full font-base44",style:{background:"linear-gradient(80.58deg, rgba(255, 102, 0, 0.26) 53.515%, rgba(255, 222, 162, 0.182) 99.099%), #fff",boxShadow:"0px -2px 8px 0px rgba(14, 33, 75, 0.05), 0px 0px 1.6px 0px rgba(53, 71, 158, 0.1), 0px 6px 6px 0px rgba(64, 82, 171, 0.05)"},children:(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)("div",{className:"flex items-start gap-1",children:[(0,se.jsx)(pI,{}),(0,se.jsx)("span",{className:"text-sm font-medium leading-5 text-[#171717]",children:"0 credits remaining"})]}),(0,se.jsx)("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-[#ff631f]/30 to-transparent"}),(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsxs)("p",{className:"text-sm leading-5 text-[#171717] text-left",children:["Don't stop now - ",(0,se.jsxs)("span",{className:"font-medium",children:["Get ",o," off select yearly plans"]})," and keep building."]}),(0,se.jsxs)("p",{className:"text-sm font-semibold leading-5 text-[#09090b] text-left",children:["Limited time offer ",i(n.hours),":",i(n.minutes),":",i(n.seconds)]})]}),(0,se.jsxs)("button",{onClick:s,disabled:a,className:"inline-flex items-center gap-1.5 px-2 py-1 bg-[#ff631f] text-white text-sm font-medium leading-5 rounded-lg hover:bg-[#e55a1c] transition-colors disabled:opacity-50 disabled:cursor-not-allowed w-fit",style:{boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)"},children:["Upgrade Plan",(0,se.jsx)(au.A,{className:"w-4 h-4"})]})]})]})})};function fI(e){let{currentUsage:t,stats:s,className:a=""}=e;const{toast:n}=ao(),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1),{app:x}=lp(),{user:h}=wd(),{activeWorkspace:p}=qd(),g=uh(),f=p&&!p.is_personal,v=hv(s),{nextPlan:b,billingPeriod:j,isLoading:y,error:N}=dI(t,s),w=(null==t?void 0:t.tier)||null,_=!w||"free"===w.toLowerCase(),k=nI(w),C=lI(w),A=_&&(null==t?void 0:t.daily_usage)>=(null==t?void 0:t.daily_limit),S=(()=>{if(!C||null==s||!s.pricing)return null;return("yearly"===k?s.pricing.yearly:s.pricing.monthly)[C]||null})();(0,Y.useEffect)(()=>{try{if(t&&s){var e;const a={user_id:(null==h?void 0:h.id)||null,user_email_domain:t.user_email?null===(e=t.user_email.split("@")[1])||void 0===e?void 0:e.toLowerCase():null,organization_id:t.organization_id,app_id:(null==x?void 0:x.id)||null,conversation_id:gu.id||null,monthly_usage:t.monthly_usage,daily_usage:t.daily_usage,monthly_limit:t.monthly_limit,daily_limit:t.daily_limit,extra_credits:t.extra_credits,is_over_limit:t.is_over_limit,current_tier:w,is_free_user:_,next_tier:C,billing_period:k,hit_daily_limit:A,hit_monthly_limit:!A&&t.is_over_limit,current_period_start:t.current_credit_period_start_date,current_period_end:t.current_credit_period_end_date,next_period_start:t.next_period_start_date,past_due:t.past_due,has_pricing_data:!(null==s||!s.pricing),next_plan_price:(null==S?void 0:S.unit_amount)||null,next_plan_id:(null==S?void 0:S.id)||null};Tu("User out of credits",a)}}catch(N){}},[]);const E=(e,s)=>{try{const a={cta:e,origin:"chat out of credits message",target_route:_||!C?"/billing":"direct_upgrade",current_tier:w,next_tier:C,billing_period:k,upgrade_type:s,daily_usage:(null==t?void 0:t.daily_usage)||null,daily_limit:(null==t?void 0:t.daily_limit)||null,monthly_usage:(null==t?void 0:t.monthly_usage)||null,monthly_limit:(null==t?void 0:t.monthly_limit)||null,is_daily_limit_hit:A};Tu("User clicked upgrade",(0,ue.A)((0,ue.A)({},g),a)),Vu(g,a)}catch(N){}},T=()=>{m(!0);const e=_?"billing_dialog":"direct_upgrade",t=I();E(t,e),_?(d(!0),o(!0)):(async()=>{if(null!=S&&S.id){r(!0);try{var e;const t=null===(e=(await ow.updateSubscription(S.id)).subscription)||void 0===e?void 0:e.is_downgrade;n({title:"Subscription Updated",description:t?"Your subscription has been scheduled to downgrade at the end of your billing cycle.":"Your subscription has been upgraded successfully. Changes will be reflected shortly."}),setTimeout(()=>{window.location.reload()},2e3)}catch(N){var t;n({variant:"destructive",title:"Error",description:(null===(t=N.response)||void 0===t?void 0:t.detail)||"Failed to update subscription. Please try again later."})}finally{r(!1),m(!1)}}})()},I=()=>{if(_)return c?"Opening...":"View All Plans";if(!C)return"View All Plans";const e=oI(C),t=k.charAt(0).toUpperCase()+k.slice(1);return"Upgrade to ".concat(e," ").concat(t)},P=()=>rI(b),L=()=>{if(null==b||!b.unit_amount)return{price:"0",billingText:"billed monthly",hasDiscount:!1};const e="yearly"===j,t=e?b.unit_amount/100/12:b.unit_amount/100,s=e?"billed yearly":"billed monthly",a=v&&e&&uv.eligibleTiers.includes(C||"");return{price:a?(t*(1-uv.discountPercent)).toFixed(0):t.toFixed(0),billingText:s,originalPrice:a?t.toFixed(0):void 0,hasDiscount:a}};return y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"py-2 px-2 ".concat(a," align-center w-full"),children:(0,se.jsx)("div",{className:"min-h-[100px] font-base44 rounded-[16px]",children:(0,se.jsxs)("div",{className:"p-2 text-center",children:[(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)("div",{className:"font-light text-gray-700 mb-4 leading-relaxed",children:(0,se.jsxs)("div",{className:"animate-pulse",children:[(0,se.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2 w-3/4 mx-auto"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 mx-auto"})]})})}),(0,se.jsx)("div",{className:"",children:(0,se.jsx)("div",{className:"animate-pulse",children:(0,se.jsx)("div",{className:"w-full h-[32px] bg-gray-200 rounded-[10px]"})})})]})})}),(0,se.jsx)(hI,{isOpen:i,onClose:()=>{o(!1),d(!1),m(!1)},onSubscriptionSuccess:()=>{o(!1),d(!1),m(!1),setTimeout(()=>{window.location.reload()},1e3)}})]}):N?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"py-6 px-6 ".concat(a," font-base44"),children:(0,se.jsxs)("div",{className:"max-w-lg",children:[(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)("p",{className:"text-md font-light text-gray-700 mb-6 leading-relaxed",children:A?(0,se.jsxs)(se.Fragment,{children:["Looks like you've reached your daily credit limit. Your credits will reset tomorrow, or"," ",(0,se.jsx)("button",{onClick:()=>{E("upgrade now","billing_dialog"),o(!0)},className:"text-orange-600 underline hover:text-orange-700 bg-transparent border-none cursor-pointer",children:"upgrade now"})," ","for more credits immediately."]}):(0,se.jsxs)(se.Fragment,{children:["Looks like you've used all your credits for this month."," ",(0,se.jsx)("button",{onClick:()=>{E("See all plans","billing_dialog"),o(!0)},className:"text-orange-600 underline hover:text-orange-700 bg-transparent border-none cursor-pointer",children:"See all plans"}),"."]})})}),_?(0,se.jsx)("button",{onClick:T,disabled:c||u,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 bg-orange-500 text-white text-md font-medium rounded-lg hover:bg-orange-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:I()}):(0,se.jsx)("button",{onClick:T,disabled:l||u,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 bg-orange-500 text-white text-md font-medium rounded-lg hover:bg-orange-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Upgrading...":I()})]})}),(0,se.jsx)(hI,{isOpen:i,onClose:()=>{o(!1),d(!1),m(!1)},onSubscriptionSuccess:()=>{o(!1),d(!1),m(!1),setTimeout(()=>{window.location.reload()},1e3)}})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"py-2 px-2 ".concat(a," align-center w-full"),children:[v&&(0,se.jsx)(gI,{stats:s,onUpgradeClick:()=>{E("Upgrade Plan (Sale Promo)","billing_dialog"),T()},isLoading:c||u||l}),!v&&(0,se.jsx)("div",{className:" min-h-[100px] font-base44  rounded-[16px]",children:(0,se.jsxs)("div",{className:"p-2 text-center",children:[(0,se.jsx)("div",{className:"mb-2",children:_?(0,se.jsx)("div",{className:"font-light text-gray-700 mb-4 leading-relaxed",children:A?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"text-black text-[16px]",children:"You're out of daily credits on your Free plan"}),(0,se.jsx)("div",{className:"text-[14px]",children:"Upgrade to a Premium plan and unlock instant credits and more power for your app"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"text-black text-[16px]",children:"You're out of monthly credits on your Free plan"}),(0,se.jsx)("div",{className:"text-[14px]",children:"Upgrade to a Premium plan and unlock instant credits and more power for your app"})]})}):C?f?(0,se.jsxs)("p",{className:"text-md font-light text-gray-700 mb-4 leading-relaxed",children:[(0,se.jsx)("span",{className:"font-bold text-md text-black",children:"You've hit this month's limit"}),(0,se.jsx)("br",{}),(0,se.jsx)("span",{children:"Out of credits but still full of ideas? Your workspace administrator can help upgrade your seat ."})]}):(0,se.jsxs)("p",{className:"text-md font-light text-gray-700 mb-4 leading-relaxed",children:[(0,se.jsx)("span",{className:"font-bold text-md text-black",children:"You've hit this month's limit"}),(0,se.jsx)("br",{}),(0,se.jsxs)("span",{children:["Out of credits but still full of ideas? Upgrade to unlock more power for your app ",(0,se.jsx)("button",{onClick:()=>{E("Compare all plans","billing_dialog"),o(!0)},className:"text-indigo-500 hover:text-indigo-600 bg-transparent border-none cursor-pointer",children:"Compare all plans"})]})]}):(0,se.jsxs)("div",{className:"font-light text-gray-700 mb-4 leading-relaxed",children:[(0,se.jsx)("div",{className:"text-black text-[16px]",children:"You've hit the limit on our highest plan"}),(0,se.jsx)("div",{className:"text-[14px]",children:"Let's take it further - contact our sales team to create a custom plan for you"})]})}),_&&(0,se.jsx)("div",{className:"",children:(0,se.jsx)("button",{onClick:T,disabled:c||u,className:"font-base44 w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:I()})}),!_&&!C&&(0,se.jsx)("div",{className:"",children:(0,se.jsx)("a",{href:"https://base44.com/enterprise",target:"_blank",rel:"noopener noreferrer",onClick:()=>E("Contact Sales","contact_sales"),className:"font-base44 w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600",children:"Contact Sales"})}),!_&&C&&(f?(0,se.jsxs)("div",{className:"bg-white/50 rounded-[12px] p-4 font-base44",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-teal-100 rounded-full flex items-center justify-center",children:(0,se.jsx)(uw.A,{className:"w-5 h-5 text-teal-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-[15px] font-semibold text-slate-900",children:"Workspace Plan"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Managed by your workspace"})]})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed",children:"Need more credits? Contact your workspace administrator to upgrade your team's plan."})]}):(0,se.jsxs)("div",{className:"bg-white/50 rounded-[12px] p-4 font-base44",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,se.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 font-base44",children:[oI(C)," Plan"]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 bg-white p-0.5 px-4 rounded-full",children:[L().hasDiscount&&(0,se.jsxs)("div",{className:"text-lg font-semibold text-slate-400 line-through",children:["$",L().originalPrice]}),(0,se.jsxs)("div",{className:"text-lg font-semibold text-slate-900",children:["$",L().price]}),(0,se.jsx)("div",{className:"text-xs text-slate-500 font-base44",children:L().billingText})]})]}),(0,se.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,se.jsxs)("div",{className:"text-sm text-slate-600 flex",children:[(0,se.jsx)("span",{className:"text-orange-500 font-semibold min-w-[40px]",children:iI(P().messageCredits)})," Monthly credits"]}),(0,se.jsxs)("div",{className:"text-sm text-slate-600 flex",children:[(0,se.jsx)("span",{className:"text-orange-500 font-semibold min-w-[40px]",children:iI(P().integrationCredits)})," Integration credits"]})]}),(0,se.jsx)("div",{className:"mb-2 cursor-pointer",children:_?(0,se.jsx)("button",{onClick:T,disabled:c||u,className:"font-base44 w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:I()}):(0,se.jsx)("button",{onClick:T,disabled:l||u,className:"font-base44 cursor-pointer w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Upgrading...":I()})}),(0,se.jsx)("p",{className:"text-center text-sm font-thin text-slate-500",children:"Clicking Upgrade will confirm your payment"})]}))]})})]}),(0,se.jsx)(hI,{isOpen:i,onClose:()=>{o(!1),d(!1),m(!1)},onSubscriptionSuccess:()=>{o(!1),d(!1),m(!1),setTimeout(()=>{window.location.reload()},1e3)}})]})}function vI(e){let{endDate:t,isDaily:s=!1,className:a}=e;const[n,l]=(0,Y.useState)("");return(0,Y.useEffect)(()=>{const e=()=>{if(s){const e=new Date,t=new Date(e);t.setUTCHours(24,0,0,0);const s=t.getTime()-e.getTime();if(s>0){const e=Math.floor(s/36e5),t=Math.floor(s%36e5/6e4);l(e>0?"".concat(e,"h : ").concat(t,"m"):"".concat(t,"m"))}else l("")}else{if(!t)return;const e=new Date,s=/Z|[+-]\d{2}:\d{2}$/.test(t),a=new Date(s?t:t+"Z").getTime()-e.getTime();if(a>0){const e=Math.floor(a/864e5),t=Math.floor(a%864e5/36e5),s=Math.floor(a%36e5/6e4);l(e>0?"".concat(e,"d : ").concat(t,"h"):t>0?"".concat(t,"h : ").concat(s,"m"):"".concat(s,"m"))}else l("Expired")}};e();const a=setInterval(e,6e4);return()=>clearInterval(a)},[t,s]),(0,se.jsx)("span",{className:null!=a?a:"flex text-md text-white justify-center",children:n&&"Credits renew in ".concat(n)})}function bI(e){let{changeCount:t,onRevert:s,onDiscardAll:a,onSaveAll:n,isSaving:l,onClose:r}=e;return 0===t?null:(0,se.jsx)("div",{className:"w-full mb-3 font-base44",children:(0,se.jsxs)("div",{className:"bg-white border border-gray-200 rounded-[12px] px-5 py-2 flex items-center justify-between gap-4 backdrop-blur-sm shadow-md",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,se.jsxs)("span",{className:"text-[13px] font-medium text-slate-700",children:["You have ",t," unsaved change",t>1?"s":""]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)("button",{onClick:s,disabled:l||0===t,className:"flex items-center justify-center w-7 h-7 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed",title:"Revert last change",children:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,se.jsx)("path",{d:"M2 4.6665V8.6665H6",stroke:"black","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M14 11.3335C14 9.7422 13.3679 8.21607 12.2426 7.09086C11.1174 5.96564 9.5913 5.3335 8 5.3335C6.52341 5.335 5.09924 5.88094 4 6.86683L2 8.66683",stroke:"black","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"})]})}),(0,se.jsx)("div",{className:"w-px h-4 bg-slate-200"}),(0,se.jsx)("button",{onClick:a,disabled:l,className:"text-[12px] font-medium px-3 py-1 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Discard"}),(0,se.jsx)("button",{onClick:n,disabled:l,className:"text-[12px] font-medium px-3.5 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm hover:shadow transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed",children:"Save"})]})]})})}function jI(e){let{onUpdateClick:t}=e;return(0,se.jsx)("div",{className:"w-full mb-3 font-base44",children:(0,se.jsx)("div",{className:"bg-[#FFF0D1] border border-[#FFC23D] rounded-xl p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,se.jsx)(ad.A,{className:"w-5 h-5 text-slate-800 flex-shrink-0 mt-0.5",strokeWidth:1.5}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col gap-2.5",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-semibold",children:"Infrastructure Update Required"}),(0,se.jsx)("p",{className:"text-sm text-gray-800",children:"To continue working on your app, please complete the infrastructure update."})]}),(0,se.jsx)("button",{onClick:t,className:"self-start text-sm text-neutral-950 px-2 py-1 border border-gray-600 rounded-lg",children:"Update Infrastructure"}),(0,se.jsxs)("a",{href:Ky,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-neutral-950 inline-flex items-center gap-1",children:["For more info, ",(0,se.jsx)("span",{className:"underline",children:"visit our Docs"}),(0,se.jsx)(au.A,{className:"w-4 h-4"})]})]})]})})})}const yI=function(e){let{minimizedChat:t=!1,addMessage:s,undoMessage:a,status:n,onStop:l,showStopFeedback:r=!1,suggestions:i=null,isDisabled:o=!1,isOutOfCredits:c=!1,currentUsage:d=null,billingStats:u=null,customButtomRight:m=null,customButtomLeft:x=null,placeholder:h="What would you like to build?",isDiscussionMode:p=!1,isVisualEditMode:g=!1,changeCount:f=0,onRevertChange:v=null,onDiscardAllChanges:b=null,onSaveAllChanges:j=null,isSavingChanges:y=!1,bannerDismissed:N=!1,onBannerDismiss:w=null,githubSyncError:_=null,onGitHubSyncRetry:k=null,showInfrastructureUpdateBanner:C=!1,onInfrastructureUpdate:A=null}=e;const{user:S}=wd(),[E,T]=(0,Y.useState)(()=>localStorage.getItem("chat_draft_prompt")||""),[I,P]=(0,Y.useState)([]),[L,M]=(0,Y.useState)(null),R=(0,Y.useRef)(null),D=(0,Y.useRef)(null),[F,O]=(0,Y.useState)(!1),[U,B]=(0,Y.useState)(!0),[z,H]=(0,Y.useState)(!1),V=gu.useMessages(),W=$p(null==S?void 0:S.platform_role);(0,Y.useEffect)(()=>{E?localStorage.setItem("chat_draft_prompt",E):localStorage.removeItem("chat_draft_prompt")},[E]);const q=(!(null!=d&&d.tier)||"free"===(null==d?void 0:d.tier.toLowerCase()))&&(null==d?void 0:d.daily_usage)>=(null==d?void 0:d.daily_limit);(0,Y.useEffect)(()=>{const e=sessionStorage.getItem("pendingChatMessage");e&&(T(e),sessionStorage.removeItem("pendingChatMessage"));const t=async e=>{if(e.detail&&e.detail.message){const a=e.detail.message;if(e.detail.autoSend){try{const e={content:a,file_urls:[]};T(""),B(!0),O(!1),await s(e)}catch(t){T(a)}return}T(a),setTimeout(()=>{if(D.current&&D.current.focus&&(D.current.focus(),D.current.setSelectionRange)){var e;const t=(null===(e=D.current.value)||void 0===e?void 0:e.length)||0;D.current.setSelectionRange(t,t)}},100)}};return window.addEventListener("pendingChatMessage",t),()=>{window.removeEventListener("pendingChatMessage",t)}},[]);const G=()=>{R.current&&U&&(R.current.scrollTop=R.current.scrollHeight)},K=()=>{const e=(()=>{if(!R.current)return!0;const e=R.current;return e.scrollHeight-e.scrollTop-e.clientHeight<=100})();O(!e),B(e),H(!0),clearTimeout(K.timeout),K.timeout=setTimeout(()=>{H(!1)},1500)},Z=async()=>{if(E.trim()&&"processing"!==n.state){if(E.length>Bp)return void $.toast.error("Message is too long (max ".concat(Bp.toLocaleString()," characters)"));try{var e;if(L)Tu("Suggestion - Sent",{suggestion_text:L.prompt,suggestion_title:L.title,suggestion_position:L.position,user_message_count:(null===(e=gu.messages)||void 0===e?void 0:e.filter(e=>"user"===e.role).length)||0});const t={content:E,file_urls:I};T(""),P([]),M(null),B(!0),O(!1),await s(t)}catch(t){$.toast.error("Failed to send message")}}};return(0,Y.useEffect)(()=>{new URLSearchParams(window.location.search).get("msgId")||F||G()},[V,F]),(0,Y.useEffect)(()=>{F||G()},[n,F]),(0,Y.useEffect)(()=>{if(!R.current)return;const e=new MutationObserver(()=>{F||G()});e.observe(R.current,{childList:!0,subtree:!0,characterData:!0});const t=R.current;return t.addEventListener("scroll",K),()=>{e.disconnect(),t.removeEventListener("scroll",K)}},[F]),t?(0,se.jsx)(Hp,{className:"shadow-none",value:E,onValueChange:T,files:I,onFilesChange:P,onSend:Z,onStop:l,placeholder:h,disabled:"processing"===n.state||o,customButtomRight:m,customButtomLeft:x,isProcessing:"processing"===n.state,showStopFeedback:r,isDiscussionMode:p,isVisualEditMode:g}):(0,se.jsxs)("div",{className:"flex flex-col h-full w-full sm:bg-[#F8FAFC] relative p-0  ",children:[(0,se.jsx)("div",{className:""}),(0,se.jsxs)("div",{ref:R,className:de("flex-grow overflow-y-auto px-4 sm:px-0 sm:py-2 space-y-2 pb-4 scrollbar-auto-hide relative z-10",{"scrollbar-visible":z}),onMouseEnter:()=>{H(!0)},onMouseLeave:()=>{clearTimeout(K.timeout),setTimeout(()=>{H(!1)},300)},children:[(0,se.jsx)(eI,{undoMessage:a?e=>{const t=V.find(t=>t.id===e);"user"===t.role&&(a(e),T(t.content))}:null}),_&&k&&(0,se.jsx)(fS,{onRetry:k})]}),!N&&f>0&&v&&b&&j&&(0,se.jsx)(bI,{changeCount:f,onRevert:v,onDiscardAll:b,onSaveAll:j,isSaving:y,onClose:w}),C&&A&&(0,se.jsx)("div",{className:"px-4 sm:px-0",children:(0,se.jsx)(jI,{onUpdateClick:A})}),(0,se.jsxs)("div",{className:"rounded-[12px] relative z-10",children:[(0,se.jsx)("div",{className:"relative flex-shrink-0",children:(0,se.jsx)("div",{className:de("w-full rounded-[16px] sm:rounded-none sm:shadow-none"),children:(0,se.jsxs)("div",{className:de("join w-full px-4 sm:px-0 pb-2","bg-slate-50",{"shadow-[0_-10px_20px_8px_rgba(248,250,252,1)]":!C},{"bg-[linear-gradient(0deg,rgba(238,86,225,0.1)_0%,rgba(238,86,225,0.1)_52%,rgba(249,115,22,0.1)_79%,rgba(239,198,168,0.1)_100%)] shadow-[0_-10px_20px_8px_rgba(247,244,243,1)]":c}),children:[c&&(0,se.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,se.jsx)(fI,{currentUsage:d,stats:u}),(null==d?void 0:d.current_credit_period_end_date)&&(0,se.jsx)("div",{className:"flex justify-center -mb-3",children:(0,se.jsx)("div",{className:"bg-[#C7BECF] rounded-t-[16px] pt-2 pb-4 px-4 w-full text-center",children:(0,se.jsx)(vI,{endDate:d.next_period_start_date,isDaily:q})})})]}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)(sI,{status:n}),!c&&!C&&("ready"!==n.state||!i||c?null:(0,se.jsxs)("div",{className:"px-4 py-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1.5 text-gray-400 mb-3",children:[(0,se.jsx)(ib.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{className:"text-xs",children:"Suggestions"})]}),(0,se.jsx)("div",{className:"flex items-center justify-start",children:[i.suggestion_1,i.suggestion_2,i.suggestion_3].map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center",children:[t>0&&(0,se.jsx)("div",{className:"h-6 w-px bg-gray-300 mx-2"}),(0,se.jsx)("button",{className:"text-xs text-gray-600 hover:text-gray-900 cursor-pointer transition-colors px-2 text-left",onClick:()=>((e,t)=>{Tu("Suggestion - Clicked",{suggestion_text:e.prompt,suggestion_title:e.title,suggestion_position:t+1,user_message_count:(null==V?void 0:V.filter(e=>"user"===e.role).length)||0}),T(e.prompt),M((0,ue.A)((0,ue.A)({},e),{},{position:t+1}))})(e,t),children:e.title})]},t))})]}))]}),(0,se.jsx)(Hp,{className:"md:shadow-none",ref:D,value:E,onValueChange:e=>{T(e),L&&e!==L.prompt&&M(null)},files:I,onFilesChange:P,onSend:Z,onStop:l,placeholder:h,disabled:o,customButtomRight:m,customButtomLeft:x,isProcessing:"processing"===n.state,showStopFeedback:r,isDiscussionMode:p,isVisualEditMode:g,isOutOfCredits:c})]})})}),W&&(0,se.jsx)("div",{className:"flex items-center gap-2 absolute bottom-0 right-0",children:(0,se.jsx)("div",{className:"text-xs text-gray-400 text-center opacity-0 hover:opacity-100 transition-opacity duration-200",children:(0,se.jsxs)("a",{onClick:()=>{const e=V.slice(-8).map(e=>"".concat(e.role,":\n").concat(e.content)).join("\n\n");navigator.clipboard.writeText(e)},className:"hover:underline inline-flex items-center gap-1",children:[(0,se.jsx)(ob.A,{className:"w-3 h-3"}),"Copy"]})})})]})]})};var NI=s(50253);function wI(e){let{isVisualEditMode:t,toggleVisualEditMode:s,isSaving:a}=e;return(0,se.jsxs)("button",{onClick:s,className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-xs ".concat(t?"bg-blue-50 text-blue-600 hover:bg-blue-100":"text-gray-600 bg-gray-100 hover:bg-gray-200"),disabled:a,children:[(0,se.jsx)(NI.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Visual Edit"})]})}const _I="palette",kI="custom",CI="bg",AI="text",SI="#000000",EI=[{name:"Slate",prefix:"slate"},{name:"Gray",prefix:"gray"},{name:"Zinc",prefix:"zinc"},{name:"Neutral",prefix:"neutral"},{name:"Stone",prefix:"stone"},{name:"Red",prefix:"red"},{name:"Orange",prefix:"orange"},{name:"Amber",prefix:"amber"},{name:"Yellow",prefix:"yellow"},{name:"Lime",prefix:"lime"},{name:"Green",prefix:"green"},{name:"Emerald",prefix:"emerald"},{name:"Teal",prefix:"teal"},{name:"Cyan",prefix:"cyan"},{name:"Sky",prefix:"sky"},{name:"Blue",prefix:"blue"},{name:"Indigo",prefix:"indigo"},{name:"Violet",prefix:"violet"},{name:"Purple",prefix:"purple"},{name:"Fuchsia",prefix:"fuchsia"},{name:"Pink",prefix:"pink"},{name:"Rose",prefix:"rose"}],TI=[50,100,200,300,400,500,600,700,800,900,950],II=e=>e<500?"text-gray-900":"text-white",PI=e=>{let{color:t}=e;if(!t)return(0,se.jsx)("span",{className:"text-sm text-gray-500",children:"None"});const s=t.type===kI?{backgroundColor:t.value,border:"1px solid rgba(0,0,0,0.1)"}:null,a=t.type===_I?"bg-".concat(t.name,"-").concat(t.shade," border border-black/10"):"";return(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("div",{className:"h-6 w-6 rounded-sm mr-2 ".concat(a),style:s}),(0,se.jsx)("span",{className:"text-sm text-gray-700",children:t.type===_I?"".concat(t.name.charAt(0).toUpperCase()+t.name.slice(1)," ").concat(t.shade):t.value})]})},LI=e=>{let{mode:t,onModeChange:s}=e;return(0,se.jsx)("div",{className:"w-full",children:(0,se.jsxs)("div",{className:"flex h-8 items-center rounded-md bg-gray-100 p-0.5",children:[(0,se.jsx)("button",{type:"button",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 ".concat(t===_I?"bg-white text-slate-950 shadow-sm":"text-slate-500 hover:text-slate-900"),onClick:()=>s(_I),children:"Palettes"}),(0,se.jsx)("button",{type:"button",className:"flex-1  inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 ".concat(t===kI?"bg-white text-slate-950 shadow-sm":"text-slate-500 hover:text-slate-900"),onClick:()=>s(kI),children:"Custom"})]})})},MI=e=>{let{color:t,onChange:s}=e;const[a,n]=(0,Y.useState)(100),[l,r]=(0,Y.useState)(50),[i,o]=(0,Y.useState)(0),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1),x=(0,Y.useRef)(null),h=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{if(t&&t.startsWith("#")&&7===t.length){const[e,s,a]=(e=>{if(!e||!e.startsWith("#")||7!==e.length)return[0,100,50];const t=parseInt(e.slice(1,3),16)/255,s=parseInt(e.slice(3,5),16)/255,a=parseInt(e.slice(5,7),16)/255,n=Math.max(t,s,a),l=Math.min(t,s,a);let r,i,o=(n+l)/2;if(n===l)r=i=0;else{const e=n-l;switch(i=o>.5?e/(2-n-l):e/(n+l),n){case t:r=(s-a)/e+(s<a?6:0);break;case s:r=(a-t)/e+2;break;case a:r=(t-s)/e+4;break;default:r=0}r/=6}return r=Math.max(0,Math.min(360,Math.round(360*r))),i=Math.max(0,Math.min(100,Math.round(100*i))),o=Math.max(0,Math.min(100,Math.round(100*o))),[r,i,o]})(t);o(e),n(s),r(a)}else o(0),n(100),r(50)},[t]);const p=(e,t,s)=>{e=Math.max(0,Math.min(360,e))/360,t=Math.max(0,Math.min(100,t))/100;const a=(e,t,s)=>(s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e),n=(s=Math.max(0,Math.min(100,s))/100)<.5?s*(1+t):s+t-s*t,l=2*s-n,r=a(l,n,e+1/3),i=a(l,n,e),o=a(l,n,e-1/3),c=e=>{const t=Math.max(0,Math.min(255,Math.round(255*e))).toString(16);return 1===t.length?"0"+t:t};return"#".concat(c(r)).concat(c(i)).concat(c(o))},g=(e,t)=>{if(!x.current)return;const o=x.current.getBoundingClientRect(),c=Math.max(0,Math.min(e-o.left,o.width)),d=Math.max(0,Math.min(t-o.top,o.height)),u=Math.round(c/o.width*100),m=Math.round(100-d/o.height*100),[h,g,f]=((e,t,s)=>{const a=(s/=100)*(2-(t/=100))/2,n=0!==a&&1!==a?(s-a)/Math.min(a,1-a):0;return[e,Math.round(100*n),Math.round(100*a)]})(i,u,m);if(Math.abs(g-a)>.5||Math.abs(f-l)>.5){n(g),r(f);const e=p(h,g,f);s(e)}},f=e=>{if(!h.current)return;const t=h.current.getBoundingClientRect(),n=Math.max(0,Math.min(e-t.left,t.width-1)),r=Math.max(0,Math.min(360,n/(t.width-1)*360));if(Math.abs(r-i)>1){o(r);const e=p(r,a,l);s(e)}};(0,Y.useEffect)(()=>{const e=e=>{e.preventDefault(),c?g(e.clientX,e.clientY):u&&f(e.clientX)},t=e=>{e.preventDefault(),d(!1),m(!1)};return(c||u)&&(document.addEventListener("mousemove",e,{passive:!1}),document.addEventListener("mouseup",t,{passive:!1}),document.body.style.userSelect="none",document.body.style.cursor=c?"crosshair":"pointer"),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.body.style.userSelect="",document.body.style.cursor=""}},[c,u,i,a,l]);const[v,b,j]=((e,t,s)=>{const a=(s/=100)+(t/=100)*Math.min(s,1-s),n=0===a?0:2*(1-s/a);return[e,Math.round(100*n),Math.round(100*a)]})(i,a,l);return(0,se.jsxs)("div",{className:"p-4 space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-lg border border-gray-200 shadow-sm",style:{backgroundColor:t||"#000000"}}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)("input",{type:"text",value:t||"",onChange:e=>s(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"#000000"})})]}),(0,se.jsx)("div",{className:"relative",children:(0,se.jsx)("div",{ref:x,className:"w-full h-32 rounded-md border border-gray-200 relative overflow-hidden select-none ".concat(c?"cursor-grabbing":"cursor-crosshair"),style:{background:"linear-gradient(to top, #000000, transparent), linear-gradient(to right, #ffffff, hsl(".concat(i,", 100%, 50%))")},onMouseDown:e=>{e.preventDefault(),"mousedown"===e.type&&d(!0),g(e.clientX,e.clientY)},children:(0,se.jsx)("div",{className:"absolute w-3 h-3 border-2 border-white rounded-full shadow-md transform -translate-x-1/2 -translate-y-1/2 pointer-events-none transition-transform ".concat(c?"scale-110":"scale-100"),style:{left:"".concat(Math.max(0,Math.min(100,b)),"%"),top:"".concat(Math.max(0,Math.min(100,100-j)),"%"),boxShadow:"0 0 0 1px rgba(0,0,0,0.3), 0 2px 4px rgba(0,0,0,0.2)"}})})}),(0,se.jsx)("div",{className:"relative",children:(0,se.jsx)("div",{ref:h,className:"w-full h-4 rounded-md border border-gray-200 relative overflow-hidden select-none ".concat(u?"cursor-grabbing":"cursor-pointer"),style:{background:"linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%)"},onMouseDown:e=>{e.preventDefault(),"mousedown"===e.type&&m(!0),f(e.clientX)},children:(0,se.jsx)("div",{className:"absolute w-4 h-6 border-2 border-white rounded-sm shadow-md transform -translate-x-1/2 -translate-y-1/2 pointer-events-none top-1/2 transition-transform ".concat(u?"scale-110":"scale-100"),style:{left:"".concat(Math.max(0,Math.min(100,i/360*100)),"%"),boxShadow:"0 0 0 1px rgba(0,0,0,0.3), 0 2px 4px rgba(0,0,0,0.2)"}})})})]})},RI=e=>{let{selectedColorInfo:t,onColorSelect:s}=e;return(0,se.jsx)("div",{className:"overflow-y-auto max-h-64 p-2",children:EI.map(e=>(0,se.jsxs)("div",{className:"mb-3",children:[(0,se.jsx)("div",{className:"text-xs font-medium text-gray-900 mb-1",children:e.name}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:TI.map(a=>{const n=(null==t?void 0:t.name)===e.prefix&&(null==t?void 0:t.shade)===a;return(0,se.jsx)("button",{type:"button",className:"\n                  aspect-square border border-black/10 rounded-sm flex items-center hover:ring-2 hover:ring-offset-1 hover:ring-blue-500 justify-center w-6 h-6 bg-".concat(e.prefix,"-").concat(a," \n                  ").concat(II(a)," ").concat(n?"ring-2 ring-offset-1 ring-blue-500":"","\n                "),onClick:()=>s(e.prefix,a),children:n&&(0,se.jsx)(Ds.A,{className:"h-3 w-3"})},a)})})]},e.prefix))})};const DI=function(e){let{label:t,selectedColor:s,onChange:a,zIndexClass:n,onOpen:l,onClose:r,shouldClose:i,forceClose:o,direction:c="bottom"}=e;const[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(_I),[h,p]=(0,Y.useState)(SI),[g,f]=(0,Y.useState)(null),v=(0,Y.useRef)(null),b=(0,Y.useRef)(null),j=(0,Y.useRef)(null),y=t.toLowerCase().includes("background")?CI:AI;(0,Y.useEffect)(()=>{const e=(e=>{if(!e)return null;const t=e.match(/^(bg|text)-([a-z]+)-(\d+)$/);if(t)return{type:_I,name:t[2],shade:parseInt(t[3])};const s=e.match(/^(bg|text)-\[(.+)\]$/);return s?{type:kI,value:s[2]}:null})(s);if(!e)return f(null),void p(SI);e.type===kI?(x(kI),p(e.value),f(null)):(x(_I),f({name:e.name,shade:e.shade}),p(SI))},[s]),(0,Y.useEffect)(()=>{i&&d&&(u(!1),r&&r(t))},[i,d,r,t]),(0,Y.useEffect)(()=>{void 0!==o&&u(!1)},[o]),(0,Y.useEffect)(()=>{const e=e=>{d&&j.current&&!j.current.contains(e.target)&&b.current&&!b.current.contains(e.target)&&(u(!1),r&&r(t))};return d&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[d,r,t]);const N=()=>{f(null),p(SI),a("".concat(y,y===CI?"-transparent":"-black"))};return(0,se.jsxs)("div",{ref:v,className:"relative ".concat(n),children:[(0,se.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsxs)("div",{className:"flex gap-4",children:[(0,se.jsx)("label",{className:"text-sm font-light text-gray-700 min-w-[100px] pt-2",children:t}),(0,se.jsxs)("button",{ref:b,type:"button",onClick:()=>{const e=!d;u(e),e&&l&&l(t)},className:"flex-1 flex items-center bg-gray-100 justify-between px-2 py-2 rounded-md  hover:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-300",children:[PI({color:g?{type:_I,name:g.name,shade:g.shade}:h!==SI?{type:kI,value:h}:null}),d?(0,se.jsx)(ur.A,{className:"h-4 w-4 text-gray-500"}):(0,se.jsx)(_t.A,{className:"h-4 w-4 text-gray-500"})]})]})})}),d&&(0,se.jsx)("div",{ref:j,id:"color-dropdown",className:"absolute ".concat(n||"z-[10020]"," bg-white shadow-lg rounded-[8px] border border-gray-200 w-[320px] ").concat("top"===c?"bottom-full mb-1":"top-full mt-1"," left-0"),style:{maxHeight:"400px"},onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,se.jsxs)("div",{className:"flex flex-col h-full",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-2 border-b border-gray-200",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Choose Color"}),(0,se.jsx)("button",{onClick:()=>{u(!1),r&&r(t)},className:"p-1 rounded-md hover:bg-gray-100 transition-colors",title:"Close color picker",children:(0,se.jsx)(la.A,{className:"h-4 w-4 text-gray-500"})})]}),(0,se.jsx)("div",{className:"p-2",children:(0,se.jsx)(LI,{mode:m,onModeChange:x})}),(0,se.jsx)("div",{className:"flex-1 overflow-auto",children:m===_I?(0,se.jsx)(RI,{selectedColorInfo:g,onColorSelect:(e,t)=>{f({name:e,shade:t}),a("".concat(y,"-").concat(e,"-").concat(t))}}):(0,se.jsx)(MI,{color:h,onChange:e=>{p(e),a("".concat(y,"-[").concat(e,"]"))}})}),(0,se.jsx)("div",{className:"border-t border-gray-200",children:(0,se.jsxs)("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 cursor-pointer",onClick:N,children:[(0,se.jsx)("span",{className:"text-sm font-light text-gray-700",children:"Clear Color"}),(0,se.jsx)("button",{className:"w-6 h-6 rounded-sm border border-gray-300 relative hover:bg-gray-50",onClick:N,children:(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,se.jsx)("div",{className:"w-[2px] h-[120%] bg-red-500 rotate-45 transform origin-center"})})})]})})]})})]})};var FI=s(72995),OI=s(56404),UI=s(25146);const BI=[0,1,2,3,4,5,6,8,10,12,16,20,24,32,40,48,64];const zI=function(e){let{label:t,spacing:s,onChange:a}=e;const n=t.toLowerCase().startsWith("m")?"m":"p",[l,r]=(0,Y.useState)({all:0,t:0,r:0,b:0,l:0,x:0,y:0}),[i,o]=(0,Y.useState)("axes"),[c,d]=(0,Y.useState)(!1),u=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{const e={all:0,t:0,r:0,b:0,l:0,x:0,y:0};let t=!1,a=!1,l=!1,i=!1;const c=s||{},m=e=>{if(!e)return 0;if("mx-auto"===e)return t=!0,0;const s=e.match(new RegExp("^".concat(n,"[ytrlbx]?-(\\d+)$")));if(!s)return 0;const a=parseInt(s[1]),l=BI.indexOf(a);return-1!==l?l:0};c.all&&(e.all=m(c.all),e.t=e.all,e.r=e.all,e.b=e.all,e.l=e.all,a=!0),"mx-auto"===c.x?(t=!0,l=!0):(c.x&&(e.x=m(c.x),e.l=e.x,e.r=e.x,l=!0),c.y&&(e.y=m(c.y),e.t=e.y,e.b=e.y,l=!0)),c.t&&(e.t=m(c.t),i=!0),c.r&&(e.r=m(c.r),i=!0),c.b&&(e.b=m(c.b),i=!0),c.l&&(e.l=m(c.l),i=!0),r(e),d(t);let x=u.current;x||(x=l?"axes":i?"sides":a?"all":"axes"),o(x)},[s,n]);const m=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;const l={};"all"===t?l.all="".concat(n,"-").concat(BI[e.all]):"axes"===t?(s&&"m"===n?l.x="mx-auto":e.x>0&&(l.x="".concat(n,"x-").concat(BI[e.x])),e.y>0&&(l.y="".concat(n,"y-").concat(BI[e.y]))):(e.t>0&&(l.t="".concat(n,"t-").concat(BI[e.t])),e.r>0&&(l.r="".concat(n,"r-").concat(BI[e.r])),e.b>0&&(l.b="".concat(n,"b-").concat(BI[e.b])),e.l>0&&(l.l="".concat(n,"l-").concat(BI[e.l]))),a(l)},x=(e,t)=>{const s=Math.max(0,Math.min(t,BI.length-1)),a=(0,ue.A)({},l);a[e]=s,"all"===i?(a.t=s,a.r=s,a.b=s,a.l=s,a.x=s,a.y=s):"axes"===i&&("x"===e?(a.l=s,a.r=s):"y"===e&&(a.t=s,a.b=s)),s>0&&"x"===e&&c&&d(!1),r(a),m(a,i,"x"!==e&&c)},h=()=>{const e=!c;if(d(e),e){const e=(0,ue.A)((0,ue.A)({},l),{},{x:0,l:0,r:0});r(e),m(e,"axes",!0)}else m(l,i,!1)},p=(e,t)=>{const s=l[e];x(e,s+(t?1:-1))},g=e=>{let{label:t,icon:s,value:a,onChange:n}=e;return(0,se.jsx)("div",{className:"flex items-center space-x-2",children:(0,se.jsx)("div",{className:"flex-1 flex items-center",children:(0,se.jsx)("div",{className:"relative flex-1 w-full min-w-[90px] max-w-[140px]",children:(0,se.jsxs)("div",{className:"relative w-full",children:[(0,se.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2",children:(0,se.jsx)("div",{className:"scale-75",children:s})}),(0,se.jsx)("input",{type:"text",value:BI[a],onChange:e=>{const t=parseInt(e.target.value),s=BI.indexOf(t);-1!==s&&n(s)},className:"w-full pl-9 pr-3 py-1.5 rounded-md bg-gray-100 hover:bg-gray-200 hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500 focus:ring-1 focus:ring-gray-300 text-sm"}),(0,se.jsxs)("div",{className:"absolute inset-y-0 right-0 flex flex-col pr-1",children:[(0,se.jsx)("button",{type:"button",onClick:()=>p(t.toLowerCase(),!0),disabled:a>=BI.length-1,className:"flex-1 px-1 flex items-center justify-center hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500",children:(0,se.jsx)(ur.A,{className:"h-3 w-3"})}),(0,se.jsx)("button",{type:"button",onClick:()=>p(t.toLowerCase(),!1),disabled:a<=0,className:"flex-1 px-1 flex items-center justify-center hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500",children:(0,se.jsx)(_t.A,{className:"h-3 w-3"})})]})]})})})})};return(0,se.jsx)("div",{className:"space-y-3",children:(0,se.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsxs)("div",{className:"flex gap-4",children:[(0,se.jsx)("label",{className:"text-xs font-light text-gray-700 min-w-[100px] pt-2",children:t}),(0,se.jsxs)("div",{className:"flex-1 space-y-3",children:["axes"===i&&"m"===n&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"flex items-center space-x-2",children:(0,se.jsx)("div",{className:"flex items-center gap-2 w-full",children:c?(0,se.jsxs)("button",{type:"button",onClick:h,className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-indigo-50 rounded-md min-w-[90px] max-w-[140px] w-full",children:[(0,se.jsx)(FI.A,{className:"h-4 w-4 text-indigo-500"}),(0,se.jsx)("span",{className:"text-xs text-indigo-700",children:"mx-auto"})]}):(0,se.jsx)(g,{label:"x",icon:(0,se.jsx)(OI.A,{className:"h-4 w-4 text-gray-500"}),value:l.x,onChange:e=>x("x",e)})})}),(0,se.jsx)(g,{label:"y",icon:(0,se.jsx)(UI.A,{className:"h-4 w-4 text-gray-500"}),value:l.y,onChange:e=>x("y",e)})]}),"axes"===i&&"m"!==n&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(g,{label:"x",icon:(0,se.jsx)(Ws.A,{className:"h-4 w-4 text-gray-500"}),value:l.x,onChange:e=>x("x",e)}),(0,se.jsx)(g,{label:"y",icon:(0,se.jsx)(Uk.A,{className:"h-4 w-4 text-gray-500"}),value:l.y,onChange:e=>x("y",e)})]}),"sides"===i&&(0,se.jsxs)("div",{className:"grid auto-rows-auto gap-3",style:{gridTemplateColumns:"repeat(auto-fit, minmax(90px, 140px))"},children:[(0,se.jsx)(g,{label:"t",icon:(0,se.jsx)(kp.A,{className:"h-4 w-4 text-gray-500"}),value:l.t,onChange:e=>x("t",e)}),(0,se.jsx)(g,{label:"r",icon:(0,se.jsx)(Ws.A,{className:"h-4 w-4 text-gray-500"}),value:l.r,onChange:e=>x("r",e)}),(0,se.jsx)(g,{label:"b",icon:(0,se.jsx)(Uk.A,{className:"h-4 w-4 text-gray-500"}),value:l.b,onChange:e=>x("b",e)}),(0,se.jsx)(g,{label:"l",icon:(0,se.jsx)(Vs.A,{className:"h-4 w-4 text-gray-500"}),value:l.l,onChange:e=>x("l",e)})]})]})]})}),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)("div",{className:"rounded-md overflow-hidden",children:(0,se.jsx)("button",{type:"button",className:"p-2 ".concat("axes"===i?"bg-white text-gray-700 hover:bg-gray-100":"bg-indigo-50 text-indigo-700 hover:bg-indigo-100"),onClick:()=>(e=>{o(e),u.current=e;const t=(0,ue.A)({},l);"sides"===e?(l.x>0&&(t.l=l.x,t.r=l.x),l.y>0&&(t.t=l.y,t.b=l.y)):"axes"===e&&(t.x=l.l>0?l.l:l.r,t.y=l.t>0?l.t:l.b),r(t),"axes"!==e&&c?(d(!1),m(t,e,!1)):m(t,e,c)})("axes"===i?"sides":"axes"),children:(0,se.jsx)(rA.A,{size:16})})}),"Margin"===t&&"axes"===i&&(0,se.jsx)("div",{children:(0,se.jsx)("button",{type:"button",onClick:h,className:"p-2 rounded ".concat(c?"bg-white text-gray-500 border-gray-300":"hover:bg-gray-100 text-gray-700"),children:(0,se.jsx)(FI.A,{className:"h-4 w-4"})})})]})]})})};var HI=s(14666),VI=s(92530),WI=s(54413),qI=s(69367),YI=s(66291),GI=s(68215);const KI=[{label:"XS",value:"text-xs",size:"xs"},{label:"S",value:"text-sm",size:"sm"},{label:"Base",value:"text-base",size:"base"},{label:"L",value:"text-lg",size:"lg"},{label:"XL",value:"text-xl",size:"xl"},{label:"2XL",value:"text-2xl",size:"2xl"},{label:"3XL",value:"text-3xl",size:"3xl"},{label:"4XL",value:"text-4xl",size:"4xl"}],$I=[{label:"Thin",value:"font-thin",weight:100},{label:"Extra Light",value:"font-extralight",weight:200},{label:"Light",value:"font-light",weight:300},{label:"Normal",value:"font-normal",weight:400},{label:"Medium",value:"font-medium",weight:500},{label:"Semi Bold",value:"font-semibold",weight:600},{label:"Bold",value:"font-bold",weight:700},{label:"Extra Bold",value:"font-extrabold",weight:800},{label:"Black",value:"font-black",weight:900}],ZI=[{label:"Left",value:"text-left",icon:(0,se.jsx)(HI.A,{className:"h-4 w-4"})},{label:"Center",value:"text-center",icon:(0,se.jsx)(VI.A,{className:"h-4 w-4"})},{label:"Right",value:"text-right",icon:(0,se.jsx)(WI.A,{className:"h-4 w-4"})},{label:"Justify",value:"text-justify",icon:(0,se.jsx)(qI.A,{className:"h-4 w-4"})}],JI=[{label:"Underline",value:"underline",icon:(0,se.jsx)(YI.A,{className:"h-4 w-4"})},{label:"Line Through",value:"line-through",icon:(0,se.jsx)("span",{className:"text-xs line-through",children:"abc"})}],QI=[{label:"Normal",value:"normal-case",icon:(0,se.jsx)(GI.A,{className:"h-4 w-4"})},{label:"Uppercase",value:"uppercase",icon:(0,se.jsx)("span",{className:"text-xs",children:"AA"})},{label:"Lowercase",value:"lowercase",icon:(0,se.jsx)("span",{className:"text-xs",children:"aa"})},{label:"Capitalize",value:"capitalize",icon:(0,se.jsx)("span",{className:"text-xs",children:"Aa"})}];function XI(e){let{value:t,onChange:s,zIndexClass:a,forceClose:n,direction:l="bottom"}=e;const[r,i]=(0,Y.useState)(!1),o=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{n&&i(!1)},[n]),(0,Y.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};return r&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[r]);const c=KI.findIndex(e=>e.value===t),d=-1===c?2:c,u=KI[d];return(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("label",{className:"text-sm font-light text-gray-700 whitespace-nowrap min-w-[100px]",children:"Size"}),(0,se.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,se.jsxs)("div",{ref:o,className:"relative",children:[(0,se.jsxs)("button",{type:"button",onClick:()=>i(!r),className:"w-[80px] h-8 flex items-center justify-between text-sm font-light bg-gray-100 rounded-[6px] border-none hover:bg-gray-200 focus:outline-none focus:ring-0 px-3",children:[u.label,(0,se.jsx)(_t.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]}),r&&(0,se.jsx)("div",{className:"absolute ".concat(a||"z-[10020]"," ").concat("top"===l?"bottom-full mb-1":"top-full mt-1"," left-0 w-[120px] bg-white border border-gray-200 rounded-lg shadow-lg p-1"),children:KI.map(e=>(0,se.jsx)("div",{className:"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 px-2 text-xs outline-none hover:bg-gray-100 ".concat(t===e.value?"bg-gray-100 font-medium":""),onMouseDown:t=>((e,t)=>{t.preventDefault(),t.stopPropagation(),s(e.value)})(e,t),children:e.label},e.value))})]}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)("input",{type:"range",min:"0",max:KI.length-1,value:d,onChange:e=>s(KI[parseInt(e.target.value)].value),className:"w-full h-2 bg-gray-100 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:bg-gray-800 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:bg-black [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",style:{background:"linear-gradient(to right, rgb(75, 85, 99) 0%, rgb(75, 85, 99) ".concat(d/(KI.length-1)*100,"%, #f3f4f6 ").concat(d/(KI.length-1)*100,"%, #f3f4f6 100%)")}})})]})]})}function eP(e){let{value:t,onChange:s,zIndexClass:a,forceClose:n,direction:l="bottom"}=e;const[r,i]=(0,Y.useState)(!1),o=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{n&&i(!1)},[n]),(0,Y.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};return r&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[r]);const c=$I.findIndex(e=>e.value===t),d=$I[-1===c?3:c];return(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("label",{className:"text-sm font-light text-gray-700 whitespace-nowrap min-w-[100px] max-w-[120px]",children:"Weight"}),(0,se.jsxs)("div",{ref:o,className:"relative flex-1",children:[(0,se.jsxs)("button",{type:"button",onClick:()=>i(!r),className:"w-full h-8 flex items-center justify-between text-sm font-light bg-gray-100 rounded-[6px] border-none hover:bg-gray-200 focus:outline-none focus:ring-0 px-3",children:[d.label,(0,se.jsx)(_t.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]}),r&&(0,se.jsx)("div",{className:"absolute ".concat(a||"z-[10020]"," ").concat("top"===l?"bottom-full mb-1":"top-full mt-1"," left-0 w-[160px] bg-white border border-gray-200 rounded-lg shadow-lg p-1"),children:$I.map(e=>(0,se.jsx)("div",{className:"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 px-2 text-xs outline-none hover:bg-gray-100 ".concat(t===e.value?"bg-gray-100 font-medium":""),onMouseDown:t=>((e,t)=>{t.preventDefault(),t.stopPropagation(),s(e.value)})(e,t),children:e.label},e.value))})]})]})}const tP=function(e){let{typography:t,onChange:s,zIndexClass:a,forceClose:n,direction:l="bottom"}=e;const[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)([]),[h,p]=(0,Y.useState)(null);return(0,Y.useEffect)(()=>{i((null==t?void 0:t.size)||KI[2].value),c((null==t?void 0:t.weight)||$I[3].value),u((null==t?void 0:t.align)||ZI[0].value);const e=((null==t?void 0:t.decoration)||"").split(" ").filter(e=>JI.some(t=>t.value===e));x(e),p((null==t?void 0:t.transform)||QI[0].value)},[t]),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(XI,{value:r,onChange:e=>{i(e),s((0,ue.A)((0,ue.A)({},t),{},{size:e}))},zIndexClass:a,forceClose:n,direction:l}),(0,se.jsx)(eP,{value:o,onChange:e=>{c(e),s((0,ue.A)((0,ue.A)({},t),{},{weight:e}))},zIndexClass:a,forceClose:n,direction:l}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("label",{className:"text-sm font-light text-gray-700 shrink-0 min-w-[105px]",children:"Decoration"}),(0,se.jsx)("div",{className:"flex border rounded-[6px] divide-x flex-1 overflow-hidden",children:JI.map((e,a)=>(0,se.jsx)("button",{type:"button",className:"flex-1 flex justify-center py-1.5 ".concat(m.includes(e.value)?"bg-gray-200 text-gray-700":"bg-white text-gray-700 hover:bg-gray-50"),onClick:()=>(e=>{let a;a=m.includes(e)?m.filter(t=>t!==e):[...m,e],x(a),s((0,ue.A)((0,ue.A)({},t),{},{decoration:a.join(" ")}))})(e.value),title:e.label,children:e.icon},e.value))})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("label",{className:"text-sm font-light text-gray-700 shrink-0 min-w-[105px]",children:"Alignment"}),(0,se.jsx)("div",{className:"flex border rounded-[6px] divide-x flex-1 overflow-hidden",children:ZI.map((e,a)=>(0,se.jsx)("button",{type:"button",className:"flex-1 flex justify-center py-1.5 ".concat(d===e.value?"bg-gray-200 text-gray-700":"bg-white text-gray-700 hover:bg-gray-50"),onClick:()=>{return a=e.value,u(a),void s((0,ue.A)((0,ue.A)({},t),{},{align:a}));var a},title:e.label,children:e.icon},e.value))})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("label",{className:"text-sm font-light text-gray-700 shrink-0 min-w-[105px]",children:"Transform"}),(0,se.jsx)("div",{className:"flex border rounded-[6px] divide-x flex-1 overflow-hidden",children:QI.map((e,a)=>(0,se.jsx)("button",{type:"button",className:"flex-1 flex justify-center py-1.5 ".concat(h===e.value?"bg-gray-200 text-gray-700":"bg-white text-gray-700 hover:bg-gray-50"),onClick:()=>{return a=e.value,p(a),void s((0,ue.A)((0,ue.A)({},t),{},{transform:a}));var a},title:e.label,children:e.icon},e.value))})]})]})};function sP(e){const t={colors:{bg:null,text:null},spacing:{margin:{t:null,r:null,b:null,l:null,x:null,y:null,all:null},padding:{t:null,r:null,b:null,l:null,x:null,y:null,all:null}},typography:{size:null,weight:null,align:null,decoration:null,transform:null,tracking:null,leading:null},opacity:null,borderRadius:null,other:[]};if(!e)return t;if("string"!=typeof e)return t;return e.trim().split(/\s+/).forEach(e=>{if(!e)return;let s=!1;e.startsWith("bg-")?(t.colors.bg=e,s=!0):!e.startsWith("text-")||e.startsWith("text-xs")||e.startsWith("text-sm")||e.startsWith("text-base")||e.startsWith("text-lg")||e.startsWith("text-xl")||e.startsWith("text-2xl")||e.startsWith("text-3xl")||e.startsWith("text-4xl")||e.startsWith("text-5xl")||e.startsWith("text-6xl")||e.startsWith("text-7xl")||e.startsWith("text-8xl")||e.startsWith("text-9xl")||e.startsWith("text-left")||e.startsWith("text-center")||e.startsWith("text-right")||e.startsWith("text-justify")?e.startsWith("m-")?(t.spacing.margin.x=e,t.spacing.margin.y=e,s=!0):e.startsWith("mt-")?(t.spacing.margin.t=e,s=!0):e.startsWith("mr-")?(t.spacing.margin.r=e,s=!0):e.startsWith("mb-")?(t.spacing.margin.b=e,s=!0):e.startsWith("ml-")?(t.spacing.margin.l=e,s=!0):e.startsWith("mx-")?(t.spacing.margin.x=e,s=!0):e.startsWith("my-")?(t.spacing.margin.y=e,s=!0):e.startsWith("p-")?(t.spacing.padding.x=e,t.spacing.padding.y=e,s=!0):e.startsWith("pt-")?(t.spacing.padding.t=e,s=!0):e.startsWith("pr-")?(t.spacing.padding.r=e,s=!0):e.startsWith("pb-")?(t.spacing.padding.b=e,s=!0):e.startsWith("pl-")?(t.spacing.padding.l=e,s=!0):e.startsWith("px-")?(t.spacing.padding.x=e,s=!0):e.startsWith("py-")?(t.spacing.padding.y=e,s=!0):e.startsWith("text-xs")||e.startsWith("text-sm")||e.startsWith("text-base")||e.startsWith("text-lg")||e.startsWith("text-xl")||e.startsWith("text-2xl")||e.startsWith("text-3xl")||e.startsWith("text-4xl")||e.startsWith("text-5xl")||e.startsWith("text-6xl")||e.startsWith("text-7xl")||e.startsWith("text-8xl")||e.startsWith("text-9xl")?(t.typography.size=e,s=!0):e.startsWith("font-")?(t.typography.weight=e,s=!0):e.startsWith("text-left")||e.startsWith("text-center")||e.startsWith("text-right")||e.startsWith("text-justify")?(t.typography.align=e,s=!0):e.startsWith("underline")||e.startsWith("line-through")||e.startsWith("no-underline")?(t.typography.decoration=e,s=!0):e.startsWith("uppercase")||e.startsWith("lowercase")||e.startsWith("capitalize")||e.startsWith("normal-case")?(t.typography.transform=e,s=!0):e.startsWith("tracking-")?(t.typography.tracking=e,s=!0):e.startsWith("leading-")?(t.typography.leading=e,s=!0):e.startsWith("opacity-")?(t.opacity=e,s=!0):e.startsWith("rounded")&&(t.borderRadius=e,s=!0):(t.colors.text=e,s=!0),s||t.other.push(e)}),t}function aP(e){const t=new Set;if(e.colors&&(e.colors.bg&&t.add(e.colors.bg),e.colors.text&&t.add(e.colors.text)),e.spacing&&e.spacing.margin){const s=e.spacing.margin;s.all?t.add(s.all):(s.t&&t.add(s.t),s.r&&t.add(s.r),s.b&&t.add(s.b),s.l&&t.add(s.l),s.x&&t.add(s.x),s.y&&t.add(s.y))}if(e.spacing&&e.spacing.padding){const s=e.spacing.padding;s.all?t.add(s.all):(s.t&&t.add(s.t),s.r&&t.add(s.r),s.b&&t.add(s.b),s.l&&t.add(s.l),s.x&&t.add(s.x),s.y&&t.add(s.y))}if(e.typography){const{size:s,weight:a,align:n,decoration:l,transform:r,tracking:i,leading:o}=e.typography;s&&t.add(s),a&&t.add(a),n&&t.add(n),l&&t.add(l),r&&t.add(r),i&&t.add(i),o&&t.add(o)}return e.opacity&&t.add(e.opacity),e.borderRadius&&t.add(e.borderRadius),e.other&&Array.isArray(e.other)&&e.other.forEach(e=>{e&&t.add(e)}),Array.from(t).join(" ")}const nP=[0,2,4,6,8,10,12,14,16,20,24,28,32,40,48,64,9999];function lP(e){let{parsedClasses:t,onBorderRadiusChange:s}=e;const[a,n]=(0,Y.useState)("simple"),[l,r]=(0,Y.useState)({all:4,tl:4,tr:4,br:4,bl:4}),i=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{const e={all:4,tl:4,tr:4,br:4,bl:4};let s=!1;const a=t.borderRadius;if(a&&"rounded"!==a)if("rounded-none"===a)e.all=0;else if("rounded-sm"===a)e.all=2;else if("rounded-md"===a)e.all=6;else if("rounded-lg"===a)e.all=8;else if("rounded-xl"===a)e.all=12;else if("rounded-2xl"===a)e.all=16;else if("rounded-3xl"===a)e.all=24;else if("rounded-full"===a)e.all=9999;else if(a.startsWith("rounded-[")&&a.endsWith("]")){const t=a.match(/rounded-\[(\d+)px_(\d+)px_(\d+)px_(\d+)px\]/);if(t)e.tl=parseInt(t[1]),e.tr=parseInt(t[2]),e.br=parseInt(t[3]),e.bl=parseInt(t[4]),e.all=e.tl,s=!0;else{const t=a.match(/rounded-\[(\d+)px\]/);t&&(e.all=parseInt(t[1]))}}else a.includes(" ")&&(s=!0);else e.all=4;r(e),i.current||n(s?"advanced":"simple")},[t.borderRadius]);const o=e=>0===e?"rounded-none":2===e?"rounded-sm":4===e?"rounded":6===e?"rounded-md":8===e?"rounded-lg":12===e?"rounded-xl":16===e?"rounded-2xl":24===e?"rounded-3xl":9999===e?"rounded-full":"rounded-[".concat(e,"px]"),c=(e,t)=>{if("simple"===t){const t=o(e.all);s(t)}else if(e.tl===e.tr&&e.tr===e.br&&e.br===e.bl){const t=o(e.tl);s(t)}else{const t="rounded-[".concat(e.tl,"px_").concat(e.tr,"px_").concat(e.br,"px_").concat(e.bl,"px]");s(t)}},d=(e,t)=>{const s=Math.max(0,t),n=(0,ue.A)({},l);n[e]=s,"simple"!==a&&"all"!==e||(n.tl=s,n.tr=s,n.br=s,n.bl=s),r(n),c(n,a)},u=(e,t)=>{const s=l[e];if(t){const t=nP.find(e=>e>s);d(e,void 0!==t?t:s+4)}else{const t=[...nP].reverse().find(e=>e<s);d(e,void 0!==t?t:Math.max(0,s-4))}},m=e=>{if(n(e),i.current=e,"simple"===e){const t={all:l.tl,tl:l.tl,tr:l.tl,br:l.tl,bl:l.tl};r(t),c(t,e)}},x=e=>{let{label:t,value:s,onChange:a}=e;return(0,se.jsx)("div",{className:"flex items-center space-x-2",children:(0,se.jsx)("div",{className:"flex-1 flex items-center",children:(0,se.jsx)("div",{className:"relative flex-1 w-full min-w-[90px] max-w-[140px]",children:(0,se.jsxs)("div",{className:"relative w-full",children:[(0,se.jsx)("input",{type:"text",value:s,onChange:e=>{const t=e.target.value;if(""===t||"-"===t)return void a(0);const s=parseInt(t);isNaN(s)||a(s)},onBlur:e=>{const t=parseInt(e.target.value);(isNaN(t)||t<0)&&a(0)},className:"w-full pl-3 pr-12 py-1.5 rounded-md bg-gray-100 hover:bg-gray-200 hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500 focus:ring-1 focus:ring-gray-300 text-sm"}),(0,se.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-1",children:(0,se.jsx)("span",{className:"text-xs text-gray-400 mr-1",children:"px"})}),(0,se.jsxs)("div",{className:"absolute inset-y-0 right-6 flex flex-col",children:[(0,se.jsx)("button",{type:"button",onClick:()=>u(t.toLowerCase(),!0),className:"flex-1 px-1 flex items-center justify-center hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500",children:(0,se.jsx)(ur.A,{className:"h-3 w-3"})}),(0,se.jsx)("button",{type:"button",onClick:()=>u(t.toLowerCase(),!1),disabled:s<=0,className:"flex-1 px-1 flex items-center justify-center hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500",children:(0,se.jsx)(_t.A,{className:"h-3 w-3"})})]})]})})})})},h=e=>{let{children:t}=e;return(0,se.jsx)("span",{className:"text-xs text-gray-500 font-mono w-6",children:t})};return(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"flex items-center justify-between gap-3",children:(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Corner Radius"})}),(0,se.jsxs)("div",{className:"space-y-2",children:["simple"===a&&(0,se.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)(x,{label:"all",value:l.all,onChange:e=>d("all",e)})}),(0,se.jsx)("button",{type:"button",className:"p-1.5 rounded bg-gray-100 text-gray-700 hover:bg-gray-200 shrink-0",onClick:()=>m("advanced"),title:"Show individual corners",children:(0,se.jsx)(rA.A,{size:14})})]}),"advanced"===a&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1 flex-1",children:[(0,se.jsx)(h,{children:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,se.jsx)("rect",{width:"24",height:"24",fill:"white"}),(0,se.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5 9.5V20H4V9.5C4 7.01472 6.01472 5 8.5 5H19V6H8.5C6.567 6 5 7.567 5 9.5Z",fill:"#767574"})]})}),(0,se.jsx)(x,{label:"tl",value:l.tl,onChange:e=>d("tl",e)})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1 flex-1",children:[(0,se.jsx)(h,{children:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,se.jsxs)("g",{"clip-path":"url(#clip0_22_5272)",children:[(0,se.jsx)("rect",{width:"24",height:"24",fill:"white"}),(0,se.jsx)("mask",{id:"mask0_22_5272",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"24",height:"24",children:(0,se.jsx)("path",{d:"M24 0H0V24H24V0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask0_22_5272)",children:(0,se.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.5 6H4V5H14.5C16.9853 5 19 7.01472 19 9.5V20H18V9.5C18 7.567 16.433 6 14.5 6Z",fill:"#767574"})})]}),(0,se.jsx)("defs",{children:(0,se.jsx)("clipPath",{id:"clip0_22_5272",children:(0,se.jsx)("rect",{width:"24",height:"24",fill:"white"})})})]})}),(0,se.jsx)(x,{label:"tr",value:l.tr,onChange:e=>d("tr",e)})]})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1 flex-1",children:[(0,se.jsx)(h,{children:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,se.jsxs)("g",{"clip-path":"url(#clip0_22_5260)",children:[(0,se.jsx)("rect",{width:"24",height:"24",fill:"white"}),(0,se.jsx)("mask",{id:"mask0_22_5260",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"24",height:"24",children:(0,se.jsx)("path",{d:"M24 0H0V24H24V0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask0_22_5260)",children:(0,se.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.5 19H19V20H8.5C6.01472 20 4 17.9853 4 15.5V5H5V15.5C5 17.433 6.567 19 8.5 19Z",fill:"#767574"})})]}),(0,se.jsx)("defs",{children:(0,se.jsx)("clipPath",{id:"clip0_22_5260",children:(0,se.jsx)("rect",{width:"24",height:"24",fill:"white"})})})]})}),(0,se.jsx)(x,{label:"bl",value:l.bl,onChange:e=>d("bl",e)})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1 flex-1",children:[(0,se.jsx)(h,{children:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,se.jsxs)("g",{"clip-path":"url(#clip0_22_5285)",children:[(0,se.jsx)("rect",{width:"24",height:"24",fill:"white"}),(0,se.jsx)("mask",{id:"mask0_22_5285",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"24",height:"24",children:(0,se.jsx)("path",{d:"M24 0H0V24H24V0Z",fill:"white"})}),(0,se.jsx)("g",{mask:"url(#mask0_22_5285)",children:(0,se.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18 15.5V5H19V15.5C19 17.9853 16.9853 20 14.5 20H4V19H14.5C16.433 19 18 17.433 18 15.5Z",fill:"#767574"})})]}),(0,se.jsx)("defs",{children:(0,se.jsx)("clipPath",{id:"clip0_22_5285",children:(0,se.jsx)("rect",{width:"24",height:"24",fill:"white"})})})]})}),(0,se.jsx)(x,{label:"br",value:l.br,onChange:e=>d("br",e)})]})]}),(0,se.jsx)("button",{type:"button",className:"w-full p-1.5 rounded bg-indigo-50 text-gray-700 hover:bg-indigo-100 text-xs font-medium",onClick:()=>m("simple"),title:"Show all corners",children:"Show all corners"})]})]})]})}function rP(e){let{icon:t,tooltip:s,children:a,isOpen:n,onToggle:l,align:r="left",availableSpace:i,direction:o="bottom"}=e;const c=(0,Y.useRef)(null),d=(()=>{if("auto"!==r)return r;if(i){const e=280,t=10;if(i.right<e+t&&i.left>=e+t)return"right";if(i.right<e+t&&i.left<e+t){return i.left>i.right?"right":"left"}}return"left"})();return(0,Y.useEffect)(()=>{function e(e){c.current&&!c.current.contains(e.target)&&l(!1)}return n&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[n,l]),(0,se.jsxs)("div",{className:"relative",ref:c,children:[(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("button",{onClick:()=>l(!n),className:"flex items-center justify-center w-[32px] h-[32px] rounded transition-colors duration-200 ".concat(n?"bg-gray-300 text-black":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"),children:t})}),(0,se.jsx)(Ki,{children:(0,se.jsx)("p",{children:s})})]}),n&&(0,se.jsx)("div",{className:"absolute bg-white border border-gray-200 rounded-lg shadow-lg z-[10000] min-w-[280px] ".concat("top"===o?"bottom-full mb-1":"top-full mt-1"," ").concat("right"===d?"right-0":"left-0"),children:(0,se.jsx)("div",{className:"p-3",children:a})})]})}function iP(e){let{element:t,onContentChange:s,isOpen:a,onToggle:n,availableSpace:l,direction:r}=e;return t.isTextElement?(0,se.jsx)(rP,{icon:(0,se.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M14.25 3C14.6642 3 15 3.33579 15 3.75V6C15 6.41421 14.6642 6.75 14.25 6.75C13.8358 6.75 13.5 6.41421 13.5 6V4.5H9.75V13.5H11.25C11.6642 13.5 12 13.8358 12 14.25C12 14.6642 11.6642 15 11.25 15H6.75C6.33579 15 6 14.6642 6 14.25C6 13.8358 6.33579 13.5 6.75 13.5H8.25V4.5H4.5V6C4.5 6.41421 4.16421 6.75 3.75 6.75C3.33579 6.75 3 6.41421 3 6V3.75C3 3.33579 3.33579 3 3.75 3H14.25Z",fill:"#545454"})}),tooltip:"Edit content",isOpen:a,onToggle:n,align:"auto",availableSpace:l,direction:r,children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"flex items-center justify-between",children:(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Text Content"})}),t.isDynamicContent?(0,se.jsx)("p",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded",children:"This content is dynamically generated and cannot be edited directly. You can modify the content via the chat."}):(0,se.jsx)("textarea",{className:"w-full p-2 border border-gray-200 text-sm rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3,value:t.content||"",onChange:e=>s(e.target.value),placeholder:"Enter text content..."})]})}):null}function oP(e){let{parsedClasses:t,onColorChange:s,isOpen:a,onToggle:n,resetKey:l,availableSpace:r,direction:i}=e;const[o,c]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{c(null)},[l]);const d=e=>{c(e)},u=e=>{c(null)};return(0,se.jsx)(rP,{icon:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,se.jsxs)("g",{"clip-path":"url(#clip0_23_2101)",children:[(0,se.jsx)("path",{d:"M12.6667 7.33333L7.33335 2L1.60002 7.73333C1.35571 7.98257 1.21887 8.31766 1.21887 8.66667C1.21887 9.01567 1.35571 9.35076 1.60002 9.6L5.06668 13.0667C5.60002 13.6 6.40002 13.6 6.93335 13.0667L12.6667 7.33333Z",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M3.33331 1.33334L6.66665 4.66668",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M1.33331 8.66666H11.3333",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M14.6667 13.3333C14.6667 13.6869 14.5262 14.0261 14.2761 14.2761C14.0261 14.5262 13.687 14.6667 13.3333 14.6667C12.9797 14.6667 12.6406 14.5262 12.3905 14.2761C12.1405 14.0261 12 13.6869 12 13.3333C12 12.2667 13.1333 11.7333 13.3333 10.6667C13.5333 11.7333 14.6667 12.2667 14.6667 13.3333Z",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"})]}),(0,se.jsx)("defs",{children:(0,se.jsx)("clipPath",{id:"clip0_23_2101",children:(0,se.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),tooltip:"Colors",isOpen:a,onToggle:n,align:"auto",availableSpace:r,direction:i,children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("div",{className:"relative ".concat("Background"===o?"z-[10025]":"z-0"),children:(0,se.jsx)(DI,{label:"Background",selectedColor:t.colors.bg,onChange:e=>s("bg",e),zIndexClass:"z-[10020]",onOpen:d,onClose:u,shouldClose:null!==o&&"Background"!==o,forceClose:l,direction:i})}),(0,se.jsx)("div",{className:"relative ".concat("Text Color"===o?"z-[10025]":"z-0"),children:(0,se.jsx)(DI,{label:"Text Color",selectedColor:t.colors.text,onChange:e=>s("text",e),zIndexClass:"z-[10020]",onOpen:d,onClose:u,shouldClose:null!==o&&"Text Color"!==o,forceClose:l,direction:i})})]})})}function cP(e){let{element:t,parsedClasses:s,onTypographyChange:a,isOpen:n,onToggle:l,availableSpace:r,direction:i}=e;const[o,c]=(0,Y.useState)(0);if(!t.isTextElement)return null;return(0,se.jsx)(rP,{icon:(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M5.5 5.25V4.5H12.5V5.25C12.5 5.66 12.84 6 13.25 6C13.66 6 14 5.66 14 5.25V4C14 3.45 13.55 3 13 3H5C4.45 3 4 3.45 4 4V5.25C4 5.66 4.34 6 4.75 6C5.16 6 5.5 5.66 5.5 5.25Z",fill:"#545454"}),(0,se.jsx)("path",{d:"M9 3V12",stroke:"#545454","stroke-width":"1.5","stroke-miterlimit":"10"}),(0,se.jsx)("path",{d:"M11.25 10.5H6.75C6.33579 10.5 6 10.8358 6 11.25C6 11.6642 6.33579 12 6.75 12H11.25C11.6642 12 12 11.6642 12 11.25C12 10.8358 11.6642 10.5 11.25 10.5Z",fill:"#545454"}),(0,se.jsx)("path",{d:"M3.75 14.25H14.25",stroke:"#545454","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})]}),tooltip:"Text style",isOpen:n,onToggle:l,align:"auto",availableSpace:r,direction:i,children:(0,se.jsxs)("div",{className:"space-y-3",onClick:e=>{const t=e.target;"BUTTON"===t.tagName||"INPUT"===t.tagName||t.closest("button")||t.closest('[role="combobox"]')||c(e=>e+1)},children:[(0,se.jsx)("div",{className:"flex items-center justify-between",children:(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Text Style"})}),(0,se.jsx)(tP,{typography:s.typography,onChange:a,zIndexClass:"z-[10020]",forceClose:o,direction:i})]})})}function dP(e){let{parsedClasses:t,onSpacingChange:s,isOpen:a,onToggle:n,availableSpace:l,direction:r}=e;return(0,se.jsx)(rP,{icon:(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M8.66667 4.66666H7.33333C6.59695 4.66666 6 5.26361 6 5.99999V9.99999C6 10.7364 6.59695 11.3333 7.33333 11.3333H8.66667C9.40305 11.3333 10 10.7364 10 9.99999V5.99999C10 5.26361 9.40305 4.66666 8.66667 4.66666Z",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M2.66663 14.6667V1.33334",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M13.3334 14.6667V1.33334",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"})]}),tooltip:"Spacing",isOpen:a,onToggle:n,align:"auto",availableSpace:l,direction:r,children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("div",{children:(0,se.jsx)(zI,{label:"Margin",spacing:t.spacing.margin||{},onChange:e=>s("margin",e)})}),(0,se.jsx)("div",{className:"border-t border-gray-100 pt-4",children:(0,se.jsx)(zI,{label:"Padding",spacing:t.spacing.padding||{},onChange:e=>s("padding",e)})})]})})}function uP(e){let{parsedClasses:t,onOpacityChange:s,isOpen:a,onToggle:n,availableSpace:l,direction:r}=e;const i=(e=>{if(!e)return 100;const t=e.match(/opacity-(\d+)/);return t?parseInt(t[1]):100})(t.opacity);return(0,se.jsx)(rP,{icon:(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,se.jsxs)("g",{"clip-path":"url(#clip0_23_2106)",children:[(0,se.jsx)("path",{d:"M6.00004 10.6667C8.57737 10.6667 10.6667 8.57734 10.6667 6.00001C10.6667 3.42268 8.57737 1.33334 6.00004 1.33334C3.42271 1.33334 1.33337 3.42268 1.33337 6.00001C1.33337 8.57734 3.42271 10.6667 6.00004 10.6667Z",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M10 14.6667C12.5774 14.6667 14.6667 12.5773 14.6667 10C14.6667 7.42268 12.5774 5.33334 10 5.33334C7.42271 5.33334 5.33337 7.42268 5.33337 10C5.33337 12.5773 7.42271 14.6667 10 14.6667Z",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"})]}),(0,se.jsx)("defs",{children:(0,se.jsx)("clipPath",{id:"clip0_23_2106",children:(0,se.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),tooltip:"Opacity",isOpen:a,onToggle:n,align:"auto",availableSpace:l,direction:r,children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Opacity"}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("input",{type:"range",min:"0",max:"100",step:"5",value:i,onChange:e=>{return s((t=parseInt(e.target.value),"opacity-".concat(t)));var t},className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),(0,se.jsxs)("span",{className:"text-sm text-gray-500 min-w-[3rem] text-right",children:[i,"%"]})]})]})})}function mP(e){let{parsedClasses:t,onBorderRadiusChange:s,isOpen:a,onToggle:n,availableSpace:l,direction:r}=e;return(0,se.jsx)(rP,{icon:(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M14 7.33333C14 5.91885 13.4381 4.56229 12.4379 3.5621C11.4377 2.5619 10.0811 2 8.66663 2",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M14 10V12.6667C14 13.0203 13.8595 13.3594 13.6095 13.6095C13.3594 13.8595 13.0203 14 12.6667 14H3.33333C2.97971 14 2.64057 13.8595 2.39052 13.6095C2.14048 13.3594 2 13.0203 2 12.6667V3.33333C2 2.97971 2.14048 2.64057 2.39052 2.39052C2.64057 2.14048 2.97971 2 3.33333 2H6",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"})]}),tooltip:"Corners",isOpen:a,onToggle:n,align:"auto",availableSpace:l,direction:r,children:(0,se.jsx)(lP,{parsedClasses:t,onBorderRadiusChange:s})})}function xP(e){let{rawClasses:t,onRawClassChange:s,isOpen:a,onToggle:n,availableSpace:l,direction:r}=e;return(0,se.jsx)(rP,{icon:(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M14.6667 11.3333C14.6667 11.687 14.5262 12.0261 14.2762 12.2761C14.0261 12.5262 13.687 12.6667 13.3334 12.6667H4.55204C4.19845 12.6667 3.85936 12.8073 3.60937 13.0573L2.14137 14.5253C2.07518 14.5915 1.99084 14.6366 1.89903 14.6548C1.80722 14.6731 1.71206 14.6637 1.62558 14.6279C1.5391 14.5921 1.46518 14.5314 1.41316 14.4536C1.36115 14.3758 1.33339 14.2843 1.33337 14.1907V3.33333C1.33337 2.97971 1.47385 2.64057 1.7239 2.39052C1.97395 2.14048 2.31309 2 2.66671 2H13.3334C13.687 2 14.0261 2.14048 14.2762 2.39052C14.5262 2.64057 14.6667 2.97971 14.6667 3.33333V11.3333Z",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M6.66663 5.33334L4.66663 7.33334L6.66663 9.33334",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),(0,se.jsx)("path",{d:"M9.33337 9.33334L11.3334 7.33334L9.33337 5.33334",stroke:"#545454","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"})]}),tooltip:"Edit Tailwind",isOpen:a,onToggle:n,align:"auto",availableSpace:l,direction:r,children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"flex items-center justify-between",children:(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Tailwind Classes"})}),(0,se.jsx)("textarea",{className:"w-full p-2 border border-gray-200 text-sm font-mono rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4,value:t,onChange:s,placeholder:"Enter Tailwind classes..."}),(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"Enter custom Tailwind CSS classes for advanced styling"})]})})}function hP(e){var t,s,a,n;let{element:l,onChange:r,onContentChange:i,onDragStart:o,onClose:c,onCodeNavigation:d,onAskClick:u,onOpenDropdownsChange:m,popoverPosition:x,dropdownDirection:h="bottom",dimensions:p,currentElement:g,addToChangedElements:f,hasUnsavedChanges:v,isDiscussionMode:b}=e;const[j,y]=(0,Y.useState)({}),N=null!==(t=null==g?void 0:g.key)&&void 0!==t?t:null,w=null!==(s=null==g?void 0:g.parsedClasses)&&void 0!==s?s:{colors:{bg:null,text:null},spacing:{margin:{t:null,r:null,b:null,l:null,x:null,y:null,all:null},padding:{t:null,r:null,b:null,l:null,x:null,y:null,all:null}},typography:{size:null,weight:null,align:null,decoration:null,transform:null,tracking:null,leading:null},opacity:null,borderRadius:null,other:[]},_=null!==(a=null==g?void 0:g.rawClasses)&&void 0!==a?a:"",k=null!==(n=null==g?void 0:g.updateClasses)&&void 0!==n?n:()=>{},C=null!=f?f:()=>{},A=x||{left:300,right:300};(0,Y.useEffect)(()=>{if(l){(l.dataSourceLocation||l.tagName+JSON.stringify(l.linenumber))!==N&&y({})}},[null==l?void 0:l.dataSourceLocation,null==l?void 0:l.linenumber,null==l?void 0:l.tagName,N]);const S=(e,t)=>{y(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))};(0,Y.useEffect)(()=>{const e=e=>{var t;"close-dropdowns"===(null===(t=e.data)||void 0===t?void 0:t.type)&&y({})};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,Y.useEffect)(()=>{m&&m(j),Wu.postMessageToPreview({type:"dropdown-state",data:{isOpen:Object.values(j).some(Boolean)}})},[j,m]);const E=p?{minHeight:p.minHeight}:{};return(0,se.jsxs)("div",{className:(null==p?void 0:p.containerClassName)||"flex items-center bg-[#feffff] rounded-[10px] border border-[#E5E5E5] shadow-[0_6px_6px_0_rgba(22,45,61,0.06),0_0_18px_0_rgba(22,45,61,0.12)]",style:E,children:[(0,se.jsx)("div",{className:"flex items-center gap-2 px-2 py-2",children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[u&&(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("button",{disabled:v,onClick:u,className:"flex items-center gap-1.5 px-2.5 py-[7px] rounded-md text-[12px] transition-all duration-200 text-black whitespace-nowrap ".concat(b?"bg-violet-50 hover:bg-violet-100":"bg-[#F5F5F5] hover:bg-gray-200"," ").concat(!b&&v&&"text-gray-400 hover:bg-[#F5F5F5]"),children:(0,se.jsx)("span",{className:"font-[500] font-base44 ".concat(v?"text-gray-400":b?"text-violet-600":""),children:b?"Discuss":"Edit Element"})})}),(0,se.jsx)(Ki,{children:v&&(0,se.jsx)("p",{children:"Save changes before typing"})})]}),(0,se.jsx)(iP,{element:l,onContentChange:e=>{C("content",e),i(e)},isOpen:j.content||!1,onToggle:e=>S("content",e),availableSpace:A,direction:h}),(0,se.jsx)(cP,{element:l,parsedClasses:w,onTypographyChange:e=>{const t=(0,ue.A)({},w);t.typography=(0,ue.A)((0,ue.A)({},t.typography),e);const s=aP(t);k(s),C("classes",s),r(s)},isOpen:j.typography||!1,onToggle:e=>S("typography",e),availableSpace:A,direction:h}),(0,se.jsx)(oP,{parsedClasses:w,onColorChange:(e,t)=>{const s=(0,ue.A)({},w);s.colors[e]=t;const a=aP(s);k(a),C("classes",a),r(a)},isOpen:j.colors||!1,onToggle:e=>S("colors",e),resetKey:N,availableSpace:A,direction:h}),(0,se.jsx)(uP,{parsedClasses:w,onOpacityChange:e=>{const t=(0,ue.A)({},w);t.opacity=e;const s=aP(t);k(s),C("classes",s),r(s)},isOpen:j.transparency||!1,onToggle:e=>S("transparency",e),availableSpace:A,direction:h}),(0,se.jsx)(dP,{parsedClasses:w,onSpacingChange:(e,t)=>{const s=(0,ue.A)({},w);s.spacing[e]=t;const a=aP(s);k(a),C("classes",a),r(a)},isOpen:j.spacing||!1,onToggle:e=>S("spacing",e),availableSpace:A,direction:h}),(0,se.jsx)(mP,{parsedClasses:w,onBorderRadiusChange:e=>{const t=(0,ue.A)({},w);t.borderRadius=e;const s=aP(t);k(s),C("classes",s),r(s)},isOpen:j.borderRadius||!1,onToggle:e=>S("borderRadius",e),availableSpace:A,direction:h}),(0,se.jsx)(xP,{rawClasses:_,onRawClassChange:e=>{const t=e.target.value;k(t),C("classes",t),r(t)},isOpen:j.advanced||!1,onToggle:e=>S("advanced",e),availableSpace:A,direction:h}),l.dataSourceLocation&&d&&(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("button",{onClick:d,className:"flex items-center justify-center w-7 h-7 text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors duration-200",children:(0,se.jsx)(Jv.A,{className:"h-3.5 w-3.5"})})}),(0,se.jsx)(Ki,{children:(0,se.jsx)("p",{children:"Code"})})]})]})}),l.dataSourceLocation&&d&&(0,se.jsx)("div",{className:"w-px h-6 bg-gray-200"}),(0,se.jsx)("div",{onClick:c,className:"flex items-center justify-center w-6 h-8 m-1 text-[#545454] hover:text-gray-600 hover:text-black cursor-pointer",title:"Close editor",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})}function pP(e){let{element:t,onAskQuestion:s,onClose:a,onBack:n,dimensions:l,isDiscussionMode:r}=e;const[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(!1),u=(0,Y.useRef)(null),m=e=>{e&&e.preventDefault(),i.trim()&&s&&!c&&(d(!0),s(i,t),o(""))};if((0,Y.useEffect)(()=>{u.current&&u.current.focus()},[]),(0,Y.useEffect)(()=>{if(c){const e=setTimeout(()=>{a()},3e3);return()=>clearTimeout(e)}},[c,a]),!s)return null;const x=l?(0,ue.A)({minHeight:l.minHeight},l.width?{width:"".concat(l.width,"px")}:{}):{};return(0,se.jsxs)("div",{className:(null==l?void 0:l.containerClassName)||"flex font-base44 items-center bg-[#feffff] rounded-[10px] border border-[#E5E5E5] shadow-[0_6px_6px_0_rgba(22,45,61,0.06),0_0_18px_0_rgba(22,45,61,0.12)]",style:x,children:[(0,se.jsx)("div",{onClick:n,className:"flex items-center justify-center w-8 h-8 text-[#545454] hover:text-gray-900 cursor-pointer ml-1",title:"Back to editor",children:(0,se.jsx)(Vs.A,{className:"h-4 w-4"})}),(0,se.jsxs)("form",{onSubmit:m,className:"flex-1 flex items-center px-2 py-2 gap-2",children:[(0,se.jsx)("input",{ref:u,type:"text",value:i,onChange:e=>o(e.target.value),onKeyDown:e=>{"Escape"===e.key&&a()},placeholder:r?"What to discuss?":"What to change?",disabled:c,className:"flex-1 px-2 py-1 text-sm border-none focus:outline-none focus:ring-0 bg-transparent disabled:opacity-50"}),(0,se.jsx)("button",{type:"button",onClick:()=>m(),disabled:!i.trim()||c,className:"flex justify-center items-center w-7 h-7 p-1 rounded-[8px] transition-colors ".concat(!i.trim()||c?r?"bg-purple-300 cursor-not-allowed":"bg-blue-300 cursor-not-allowed":r?"bg-purple-600 hover:bg-purple-700":"bg-blue-600 hover:bg-blue-700"," text-white"),title:c?"Processing...":"Send message",children:c?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}):(0,se.jsx)(kp.A,{className:"w-4 h-4"})})]}),(0,se.jsx)("div",{className:"w-px h-6 bg-gray-200"}),(0,se.jsx)("div",{onClick:a,className:"flex items-center justify-center w-6 h-8 m-1 text-[#545454] hover:text-gray-900 hover:text-black cursor-pointer",title:"Cancel",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})}const gP={minHeight:"50px",containerClassName:"flex font-base44 items-center bg-[#feffff] rounded-[10px] border border-[#E5E5E5] shadow-[0_6px_6px_0_rgba(22,45,61,0.06),0_0_18px_0_rgba(22,45,61,0.12)]"};function fP(e){let{isVisible:t,selectedElement:s,position:a,onClose:n,onSave:l,onDiscard:r,onChange:i,onContentChange:o,isSaving:c,onElementRevert:d,onAskQuestion:u,openDropdowns:m={},onOpenDropdownsChange:x,currentElement:h,addToChangedElements:p,hasUnsavedChanges:g,isDiscussionMode:f}=e;const v=(0,J.Zp)(),{app:b}=lp(),j=(0,Y.useRef)(null),[y,N]=(0,Y.useState)({top:0,left:0}),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)({x:0,y:0}),[A,S]=(0,Y.useState)(null),[E,T]=(0,Y.useState)(!0),[I,P]=(0,Y.useState)("bottom"),[L,M]=(0,Y.useState)(!1),[R,D]=(0,Y.useState)(null),F=(0,Y.useRef)(null),O=Wu.usePreviewIframe();(0,Y.useEffect)(()=>{var e;if(!t||!a||!O)return;const n=O.getBoundingClientRect(),l=n.top+a.top,r=n.left+a.left,i=40,o=Math.min(350,Math.max(200,.25*window.innerWidth)),c=window.innerWidth,d=window.innerHeight,u=(null==s||null===(e=s.tagName)||void 0===e?void 0:e.toLowerCase())||"",m=["body","html","main"].includes(u)||a.height>.5*d||a.width>.8*c,x=d-(l+a.height),h=l;let p,g;m?(p=r+10,g=l+10):(p=r,g=l+a.height+10,x<60&&(g=h>=60?l-i-10:Math.max(l+10,l+a.height/2-20)),p+o>c-10&&(p=Math.max(10,r+a.width-o))),p+o>c&&(p=c-o-10),p<10&&(p=10),g+i>d&&(g=d-i-10),g<10&&(g=10);P(g>d-d/3||d-(g+i)<250?"top":"bottom"),N(A||{top:g,left:p})},[t,a,O,null==s?void 0:s.tagName,A]),(0,Y.useEffect)(()=>{if(!t||!O)return;const e=e=>{if("element-position-update"===e.data.type&&e.data.position){const t=!1!==e.data.isInViewport;if(T(t),O){const t=O.getBoundingClientRect(),s=t.top+e.data.position.top,a=t.left+e.data.position.left,n=40,l=Math.min(350,Math.max(200,.25*window.innerWidth)),r=window.innerWidth,i=window.innerHeight;let o=a,c=s+e.data.position.height+10;c+n>i&&(c=s-n-10),o+l>r&&(o=r-l-10),o<10&&(o=10),c<10&&(c=10),A||N({top:c,left:o})}}};return window.addEventListener("message",e),Wu.postMessageToPreview({type:"request-element-position"}),()=>{window.removeEventListener("message",e)}},[t,O]),(0,Y.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,n]);const U=e=>{if(!w)return;const t={left:e.clientX-k.x,top:e.clientY-k.y},s=Math.min(350,Math.max(200,.25*window.innerWidth)),a=window.innerWidth,n=window.innerHeight;t.left=Math.max(10,Math.min(t.left,a-s-10)),t.top=Math.max(10,Math.min(t.top,n-40-10));const l=n-(t.top+40),r=n/3,i=t.top>n-r||l<250;P(i?"top":"bottom"),S(t),N(t)},B=()=>{_(!1),Wu.postMessageToPreview({type:"popover-drag-state",data:{isDragging:!1}})};(0,Y.useEffect)(()=>(w&&(document.addEventListener("mousemove",U),document.addEventListener("mouseup",B)),()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",B)}),[w,k]),(0,Y.useEffect)(()=>{t||(S(null),T(!0))},[t]),(0,Y.useEffect)(()=>{t&&s&&T(!0)},[s,t]),(0,Y.useEffect)(()=>{s&&M(!1)},[s]),(0,Y.useEffect)(()=>{if(!L&&F.current){const e=F.current.offsetWidth;D(e)}},[L,s]);if(!t||!s)return null;const z=(0,se.jsx)("div",{ref:j,className:"fixed z-[9999] transition-opacity duration-200",style:{top:y.top,left:y.left,cursor:w?"grabbing":"default",opacity:E?1:0,pointerEvents:E?"auto":"none"},children:L?(0,se.jsx)(pP,{element:s,onAskQuestion:u,onClose:()=>{n()},onBack:()=>{M(!1)},dimensions:(0,ue.A)((0,ue.A)({},gP),{},{width:R||void 0}),isDiscussionMode:f}):(0,se.jsx)("div",{ref:F,children:(0,se.jsx)(hP,{element:s,onChange:i,onContentChange:o,onSave:l,onDiscard:r,isSaving:c,onDragStart:e=>{var t;_(!0);const s=null===(t=j.current)||void 0===t?void 0:t.getBoundingClientRect();s&&C({x:e.clientX-s.left,y:e.clientY-s.top}),Wu.postMessageToPreview({type:"popover-drag-state",data:{isDragging:!0}}),e.preventDefault()},onClose:n,onElementRevert:d,onCodeNavigation:()=>{if(null==s||!s.dataSourceLocation||null==b||!b.id)return;const e=s.dataSourceLocation,[t,a]=e.split(":");if(!t)return;const n=encodeURIComponent(t);let l="/apps/".concat(b.id,"/editor/workspace/code?filePath=").concat(n);a&&(l+="&line=".concat(a)),v(l)},onAskQuestion:u,onAskClick:()=>{M(!0)},onOpenDropdownsChange:x,popoverPosition:(()=>{const e=window.innerWidth,t=Math.min(350,Math.max(200,.25*window.innerWidth));return{left:y.left,right:e-(y.left+t)}})(),dropdownDirection:I,dimensions:gP,isDiscussionMode:f,currentElement:h,addToChangedElements:p,hasUnsavedChanges:g})})});return(0,xc.createPortal)(z,document.body)}var vP=s(89318),bP=s(81745);function jP(e){let{isOpen:t,onClose:s}=e;const{app:a,pages:n,components:l,updateApp:r}=lp(),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)([]),[u,m]=(0,Y.useState)([]),[x,h]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{if(a){o(a.custom_instructions||""),d(a.frozen_files||[]);const e=[["pages",n],["functions",a.functions],["components",l]].flatMap(e=>{let[t,s]=e;return Object.keys(s||{}).map(e=>"".concat(t,"/").concat(e))});m(e)}},[a,n,l,t]);const p=e=>{d(e?[...u]:[])};return(0,se.jsx)(ma,{open:t,onOpenChange:s,children:(0,se.jsxs)(fa,{className:"max-w-[90vw] sm:max-w-[500px] p-0 overflow-hidden rounded-lg shadow-lg border-0",children:[(0,se.jsx)(va,{className:"px-6 pt-5 pb-3 bg-gradient-to-r from-slate-50 to-gray-50",children:(0,se.jsxs)(ja,{className:"flex items-center gap-2 text-lg font-medium",children:[(0,se.jsx)(vP.A,{className:"h-5 w-5 text-gray-700"}),"AI Controls"]})}),(0,se.jsxs)("div",{className:"p-6 space-y-5 overflow-y-auto max-h-[70vh]",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(On,{htmlFor:"custom-instructions",className:"text-sm font-medium flex items-center",children:"Custom Instructions"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Provide additional instructions that will be included in every interaction with the AI. These can help guide the AI's behavior and responses."}),(0,se.jsx)(ki,{id:"custom-instructions",value:i,onChange:e=>o(e.target.value),placeholder:"e.g., Keep dark themes, always break down to small files, RTL...",className:"min-h-[100px] resize-none border-gray-200 focus:border-gray-300 transition-colors"})]}),(0,se.jsx)(Tr,{className:"my-5"}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsxs)(On,{className:"text-sm font-medium flex items-center gap-2",children:[(0,se.jsx)(Vc.A,{className:"h-4 w-4 text-gray-700"}),"Freeze Files",c.length>0&&(0,se.jsxs)(gs,{variant:"secondary",className:"ml-1 bg-blue-50 text-blue-700 hover:bg-blue-100",children:[c.length," frozen"]})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",className:"h-8 text-xs border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-colors",onClick:()=>p(!0),children:"Freeze All"}),(0,se.jsx)(zt,{variant:"outline",size:"sm",className:"h-8 text-xs border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-colors",onClick:()=>p(!1),children:"Unfreeze All"})]})]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select files that should be protected from AI edits. The AI will not modify frozen files."}),(0,se.jsx)(cr,{className:"h-[200px] border border-gray-200 rounded-lg overflow-hidden",children:(0,se.jsx)("div",{className:"p-1",children:u.map(e=>{const t=c.includes(e);return(0,se.jsxs)("div",{className:"flex items-center p-2 rounded-md transition-colors ".concat(t?"bg-blue-50 text-blue-800":"hover:bg-gray-50"),children:[(0,se.jsx)(Os,{id:"freeze-".concat(e),checked:t,onCheckedChange:()=>(e=>{d(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),className:t?"border-blue-500 text-blue-600":""}),(0,se.jsxs)("div",{className:"flex-1 flex items-center ml-3",children:[(0,se.jsx)(On,{htmlFor:"freeze-".concat(e),className:"cursor-pointer text-sm font-normal flex-1",children:e}),t?(0,se.jsx)(Vc.A,{className:"h-3.5 w-3.5 text-blue-500 ml-2"}):(0,se.jsx)(bP.A,{className:"h-3.5 w-3.5 text-gray-300 ml-2"})]})]},e)})})})]})]}),(0,se.jsx)(ba,{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:(0,se.jsxs)("div",{className:"flex w-full gap-3 sm:justify-end",children:[(0,se.jsx)(zt,{type:"button",variant:"outline",onClick:s,disabled:x,className:"flex-1 sm:flex-initial border-gray-200",children:"Cancel"}),(0,se.jsx)(zt,{type:"button",onClick:async()=>{try{h(!0),await r({custom_instructions:i,frozen_files:c}),s()}catch(e){}finally{h(!1)}},disabled:x,className:"flex-1 sm:flex-initial bg-[#2b3440] hover:bg-[#3a4555] text-white",children:x?(0,se.jsxs)("span",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"Saving..."]}):(0,se.jsxs)("span",{className:"flex items-center gap-1",children:[(0,se.jsx)(Ds.A,{className:"h-4 w-4"}),"Save Changes"]})})]})})]})})}function yP(e,t,s,a){try{const n=(0,Te.parse)(e,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","objectRestSpread","functionBind","exportDefaultFrom","exportNamespaceFrom","dynamicImport","nullishCoalescingOperator","optionalChaining","asyncGenerators","bigInt","optionalCatchBinding","throwExpressions"]});let l=!1;if((0,Ie.default)(n,{JSXElement(e){const n=e.node.openingElement,{start:r}=n.loc||{};if(r&&r.line===t&&r.column===s){if(void 0!==a.className){const e=n.attributes.findIndex(e=>Le.isJSXAttribute(e)&&Le.isJSXIdentifier(e.name)&&"className"===e.name.name),t=Le.jsxAttribute(Le.jsxIdentifier("className"),Le.stringLiteral(a.className));e>=0?n.attributes[e]=t:n.attributes.push(t)}if(void 0!==a.content&&!n.selfClosing){const t=Le.jsxText(a.content);e.node.children=[t]}l=!0,e.stop()}}}),!l)return{code:e,success:!0,found:!1,error:"Element not found at line ".concat(t,", column ").concat(s)};return{code:(0,Pe.default)(n,{retainLines:!0,compact:!1,concise:!1}).code,success:!0,found:!0}}catch(n){return{code:e,success:!1,found:!1,error:n instanceof Error?n.message:"Unknown error"}}}var NP=s(33252);var wP=s(69830),_P=s(27304),kP=s(51981);const CP={"Claude Sonnet 4.5":"claude_sonnet_4_5","Gemini 3 Pro":"gemini_3_pro","GPT-5":"gpt_5","Claude Opus 4.5":"claude_opus_4_5"},AP=e=>{if(!e||"default"===e)return"Automatic";const t=Object.entries(CP).find(t=>{let[,s]=t;return s===e});return t?t[0]:"Automatic"},SP=e=>{var t,s;let{onOpenChatSettings:a}=e;const[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!1),{app:o,updateApp:c}=lp(),d=(null==o?void 0:o.model)&&"default"!==o.model,[u,m]=(0,Y.useState)(!!d);(0,Y.useEffect)(()=>{d&&m(!0)},[d]);const{user:x}=wd(),{toast:h}=ao(),p=qu(),g=null!==(t=null==o||null===(s=o.frozen_files)||void 0===s?void 0:s.length)&&void 0!==t?t:0,f=Uj(x,"builder"),v=async e=>{if(!f&&"default"!==e)return;const t=(null==o?void 0:o.model)||"default";i(!0);try{await c({model:e}),Tu("AI Model Changed",{app_id:null==o?void 0:o.id,previous_model:t,new_model:e}),h({title:"AI model updated",description:"Your app is now using a different AI model"})}catch(s){h({title:"Error",description:"Failed to update AI model",variant:"destructive"})}finally{i(!1)}};return(0,se.jsxs)(Nj,{open:n,children:[(0,se.jsx)(wj,{onClick:()=>l(!n),children:(0,se.jsx)(vP.A,{className:de("h-4 w-4 transition-transform duration-300 ease-in-out",{"rotate-90":n})})}),(0,se.jsxs)(Aj,{align:p?"end":"start",onMouseLeave:()=>{l(!1),m(!!d)},children:[(0,se.jsxs)(_j,{children:[(0,se.jsx)(kj,{children:(0,se.jsxs)("div",{className:"flex items-center gap-2 min-w-[140px]",children:[(0,se.jsx)(wP.A,{className:"w-4 h-4 text-neutral-950"}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-950",children:"AI Model"}),(0,se.jsx)("span",{className:"text-sm text-gray-600",children:AP(null==o?void 0:o.model)})]})]})}),(0,se.jsxs)(Cj,{sideOffset:-5,alignOffset:f?-60:-160,collisionPadding:16,className:de("w-[280px] p-1",r&&"opacity-50 pointer-events-none"),children:[(0,se.jsxs)(Sj,{onClick:()=>v("default"),className:"flex items-center justify-between px-2 py-1.5 h-[72px] rounded-md cursor-pointer antialiased",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-950",children:"Automatic"}),(0,se.jsx)(_P.A,{className:"w-4 h-4 text-neutral-950"})]}),(0,se.jsx)("span",{className:"text-sm text-gray-600 leading-5",children:"Matched with the best AI model for each request"})]}),("default"===(null==o?void 0:o.model)||!(null!=o&&o.model))&&(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-neutral-950 ml-2 flex-shrink-0"})]}),(0,se.jsx)(Tj,{className:"my-0.5"}),f?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{onClick:()=>m(!u),className:"flex items-center justify-between px-2 py-1.5 rounded-md cursor-pointer bg-neutral-100 antialiased",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-950",children:"Manual"}),(0,se.jsxs)("span",{className:"text-sm text-gray-600 leading-5",children:["Select a specific AI model.",(0,se.jsx)("br",{}),"Credit usage may vary by model"]})]}),(0,se.jsx)(_t.A,{className:de("w-4 h-4 text-neutral-500 transition-transform flex-shrink-0",u&&"rotate-180")})]}),(0,se.jsx)("div",{className:de("grid transition-all duration-200 ease-out",u?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"),children:(0,se.jsx)("div",{className:"overflow-hidden",children:(0,se.jsx)("div",{className:"flex flex-col pt-1",children:Object.entries(CP).map(e=>{let[t,s]=e;return(0,se.jsxs)("div",{onClick:()=>v(s),className:de("flex items-center justify-between px-2 py-1.5 text-sm cursor-pointer rounded-md transition-colors hover:bg-gray-50",(null==o?void 0:o.model)===s?"text-neutral-950":"text-gray-600"),children:[(0,se.jsx)("span",{children:t}),(null==o?void 0:o.model)===s&&(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-neutral-950"})]},s)})})})})]}):(0,se.jsxs)("div",{className:"px-2 py-1.5 antialiased",children:[(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1 h-5 mb-0.5",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"Manual"}),(0,se.jsx)("span",{className:"text-sm font-medium text-[#FF631F] px-1.5 h-5 leading-5 border border-[#FFCBB4] rounded-md inline-flex items-center justify-center",children:"Builder+"})]}),(0,se.jsxs)("span",{className:"text-sm text-gray-400 leading-5",children:["Select a specific AI model (",Object.keys(CP).join(", "),"). Available on the Builder plan and above."]})]}),(0,se.jsxs)("a",{href:"/billing",className:"flex items-center gap-1.5 h-6 mt-1 text-sm text-[#FF631F] hover:text-orange-600",children:[(0,se.jsx)(ry.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:"Upgrade to select an AI model"})]})]})]})]}),(0,se.jsx)(Tj,{}),(0,se.jsxs)(Sj,{onClick:()=>{l(!1),a()},children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(kP.A,{className:"w-4 h-4 mr-2 text-neutral-950"}),(0,se.jsx)("span",{className:"text-sm text-neutral-950",children:"AI Controls"})]}),g>0&&(0,se.jsxs)("span",{className:"text-xs text-blue-600 font-medium bg-blue-50 px-1.5 py-0.5 rounded",children:[g," frozen"]})]})]})]})},EP=e=>{let{isDiscussionMode:t,setIsDiscussionMode:s}=e;return(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsxs)("button",{onClick:()=>s(!t),className:"flex items-center gap-1 px-2 py-1.5 rounded-md text-xs transition-all duration-200 ".concat(t?"bg-violet-50 text-violet-600 hover:bg-violet-100":"text-gray-600 bg-gray-100 hover:bg-gray-200"),children:[(0,se.jsx)(NP.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Discuss"})]})}),(0,se.jsx)(Ki,{side:"top",align:"end",className:"max-w-[280px]",children:(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"font-medium",children:"Discuss Mode"}),(0,se.jsx)("p",{className:"text-xs text-muted-foreground",children:"Chat with the AI about anything without making code changes. Uses 0.3 credits per request."})]})})]})};function TP(e){var t;let{minimizedChat:s=!1}=e;const[a,n]=(0,Y.useState)(!1),[l,r]=(0,Y.useState)(null),{app:i,addChatMessage:o,undoMessage:c,stopChat:d,suggestions:u,currentUsage:m}=lp(),{syncError:x,initialSyncState:h}=kx.usePick("syncError","initialSyncState"),p="complete"!==h,[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)({}),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(!1),_=(0,Y.useRef)(null),k=(0,Y.useRef)(null),{isSplitScreenMode:C}=dm.usePick("isSplitScreenMode"),A=$y.useIsLegacyAppBlocked();(0,Y.useEffect)(()=>{var e;const t=null==i||null===(e=i.status)||void 0===e?void 0:e.state;null!==k.current&&k.current!==t&&(w(!1),_.current&&(clearTimeout(_.current),_.current=null)),k.current=t},[null==i||null===(t=i.status)||void 0===t?void 0:t.state]);const{isVisualEditMode:S,selectedElement:E,isPopoverVisible:T,elementPosition:I,isSaving:P,shouldHideSelectElement:L,toggleVisualEditMode:M,handleClassesChange:R,handleContentChange:D,handleClosePopover:F,handleSave:O,handleBatchSave:U,handleDiscard:B,handleElementRevert:z}=function(){const{pages:e,pageNames:t,components:s,layout:a,setSelectedElement:n,writeCodeToFile:l}=lp(),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),v=(0,Y.useRef)(null),b=()=>!(null!=t&&t.size)||!window.location.pathname.includes("preview")||window.innerWidth<768;(0,Y.useEffect)(()=>{dm.isVisualEditMode=r},[r]),(0,Y.useEffect)(()=>{b()&&(i(!1),u(!1),c(null),x(null),n(null))},[window.location.pathname,t,n]),(0,Y.useEffect)(()=>{if(b())return;const e=e=>{var t;const s=e.data;switch(s.type){case"element-selected":let e=null==s?void 0:s.filename,r=null==s?void 0:s.linenumber;if(!e||!r){var a,l;const[t,n]=null!==(a=null==s||null===(l=s.dataSourceLocation)||void 0===l?void 0:l.split(":"))&&void 0!==a?a:[];e=e||t,r=r||n}const i={tagName:s.tagName,classes:s.classes,linenumber:r,dataSourceLocation:s.dataSourceLocation,filename:e,visualSelectorId:s.visualSelectorId,content:s.content,isDynamicContent:s.isDynamicContent,isTextElement:["p","h1","h2","h3","h4","h5","h6","span","a","label"].includes(null===(t=s.tagName)||void 0===t?void 0:t.toLowerCase())};c(i),v.current=s.visualSelectorId,x(s.position),u(!0),n({tagName:s.tagName,dataset:{filename:e,linenumber:r}});break;case"element-position-update":s.visualSelectorId===v.current&&x(s.position)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[n,window.location.pathname,t]);const j=e=>{u(!1),x(null),"boolean"==typeof e&&i(e),Wu.postMessageToPreview({type:"unselect-element"},{log:!0}),c(null),v.current=null,n(null)},y=t=>{if(!t)return null;try{if("layout"===t.toLowerCase())return a;if(t.startsWith("pages/")){const s=t.split("pages/")[1];return e[s]}if(t.startsWith("components/")){const e=t.split("components/")[1];return s[e]}}catch(n){}return null},N=async e=>{if(e&&0!==e.length)try{p(!0);const t={};for(const s of e){const{elementId:e,classes:a,content:n,isTextElement:l,isDynamicContent:r}=s;if(!e)continue;const[i,o,c]=e.split(":");let d=i;d.endsWith(".js")&&(d=d.replace(".js",""));const u=parseInt(o,10),m=parseInt(c,10);isNaN(u)||isNaN(m)||(t[d]||(t[d]=[]),t[d].push({line:u,column:m,classes:a,content:n,isTextElement:l,isDynamicContent:r}))}for(const[e,s]of Object.entries(t)){let t=y(e);if(t){for(let e=0;e<s.length;e++){const a=s[e],n={className:a.classes};a.isTextElement&&!a.isDynamicContent&&(n.content=a.content);const l=yP(t,a.line,a.column,n);l.success&&l.found&&(t=l.code)}await l(e,t)}}Wu.postMessageToPreview({type:"refresh-page"}),j(),i(!1)}catch(t){}finally{p(!1)}};return{isVisualEditMode:r,selectedElement:o,isPopoverVisible:d,elementPosition:m,isSaving:h,shouldHideSelectElement:b(),toggleVisualEditMode:()=>{const e=!r;i(e),Wu.postMessageToPreview({type:"toggle-visual-edit-mode",data:{enabled:e}},{log:!0}),e||(c(null),v.current=null,u(!1),x(null),n(null),Wu.postMessageToPreview({type:"unselect-element"},{log:!0}))},handleClassesChange:e=>{v.current&&(c(t=>(0,ue.A)((0,ue.A)({},t),{},{classes:e})),Wu.postMessageToPreview({type:"update-classes",data:{classes:e,visualSelectorId:v.current}},{log:!0}))},handleContentChange:e=>{c(t=>(0,ue.A)((0,ue.A)({},t),{},{content:e})),f(!0),Wu.postMessageToPreview({type:"update-content",data:{content:e,visualSelectorId:v.current}},{log:!0})},handleClosePopover:j,handleSave:async function(e,t){const s=[{elementId:e.dataSourceLocation,classes:t,content:e.content,isTextElement:e.isTextElement,isDynamicContent:e.isDynamicContent}];await N(s)},handleBatchSave:N,handleDiscard:()=>{Wu.postMessageToPreview({type:"refresh-page"},{log:!0})&&(j(),i(!1))},handleElementRevert:e=>{let{elementId:t,originalClasses:s,originalContent:a}=e;o&&o.dataSourceLocation===t&&c(e=>(0,ue.A)((0,ue.A)({},e),{},{classes:s,content:a}))}}}(),{changedElements:H,addToChangedElements:V,revertLastChangedElement:W,discardAllChanges:q,saveAllChanges:G,currentElement:K}=function(e){let{element:t,onElementRevert:s,onChange:a,onContentChange:n,onBatchSave:l,onDiscard:r,parseTailwindClasses:i,closeAllDropdowns:o}=e;const c=Wu.usePreviewIframe(),[d,u]=(0,Y.useState)({}),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)({}),[g,f]=(0,Y.useState)(""),[v,b]=(0,Y.useState)({colors:{bg:null,text:null},spacing:{margin:{t:null,r:null,b:null,l:null,x:null,y:null,all:null},padding:{t:null,r:null,b:null,l:null,x:null,y:null,all:null}},typography:{size:null,weight:null,align:null,decoration:null,transform:null,tracking:null,leading:null},opacity:null,borderRadius:null,other:[]}),j=(0,Y.useCallback)((e,s)=>{const a=m;if(!a)return;const n=h[a];("classes"===e?(null==n?void 0:n.classes)||t.classes||"":(null==n?void 0:n.content)||t.content||"")!==s&&u(l=>l[a]?(0,ue.A)((0,ue.A)({},l),{},{[a]:(0,ue.A)((0,ue.A)({},l[a]),{},{currentClasses:"classes"===e?s:l[a].currentClasses,currentContent:"content"===e?s:l[a].currentContent,lastModified:Date.now()})}):(0,ue.A)((0,ue.A)({},l),{},{[a]:{originalClasses:(null==n?void 0:n.classes)||t.classes||"",originalContent:(null==n?void 0:n.content)||t.content||"",currentClasses:"classes"===e?s:t.classes||"",currentContent:"content"===e?s:t.content||"",lastModified:Date.now(),isTextElement:t.isTextElement||!1,isDynamicContent:t.isDynamicContent||!1}}))},[m,h,t.classes,t.content,t.isTextElement,t.isDynamicContent]),y=(0,Y.useCallback)(()=>{const e=Object.entries(d);if(0===e.length)return;const[t,l]=e.reduce((e,t)=>t[1].lastModified>e[1].lastModified?t:e);if(t===m){f(l.originalClasses);const e=i(l.originalClasses);b(e)}if(c){const e={type:"update-classes",data:{classes:l.originalClasses,visualSelectorId:t,replace:!0}};if(Wu.postMessageToPreview(e),l.originalContent!==l.currentContent){const e={type:"update-content",data:{content:l.originalContent,visualSelectorId:t}};Wu.postMessageToPreview(e)}s&&s({elementId:t,originalClasses:l.originalClasses,originalContent:l.originalContent}),t===m&&(a(l.originalClasses),l.originalContent!==l.currentContent&&n(l.originalContent))}else a(l.originalClasses),l.originalContent!==l.currentContent&&n(l.originalContent);u(e=>{const s=(0,ue.A)({},e);return delete s[t],s})},[d,m,c,s,a,n,f,b,i]),N=(0,Y.useCallback)(()=>{if(0!==Object.keys(d).length){if(null!=c&&c.contentWindow&&Object.entries(d).forEach(e=>{let[t,s]=e;Wu.postMessageToPreview({type:"update-classes",data:{classes:s.originalClasses,visualSelectorId:t,replace:!0}}),s.originalContent!==s.currentContent&&Wu.postMessageToPreview({type:"update-content",data:{content:s.originalContent,visualSelectorId:t}})}),m&&h[m]){const e=h[m];f(e.classes),b(i(e.classes)),a(e.classes),void 0!==e.content&&n(e.content)}u({}),o(),r&&r()}},[d,o,r,c,m,h,i,a,n]),w=(0,Y.useCallback)(async()=>{if(o(),0===Object.keys(d).length)return;const e=(0,ue.A)({},d);if(l){const e=Object.entries(d).map(e=>{let[t,s]=e;return{elementId:t,classes:s.currentClasses,content:s.currentContent,isTextElement:s.isTextElement,isDynamicContent:s.isDynamicContent}});try{await l(e)}catch(t){return}}p(t=>{const s=(0,ue.A)({},t);return Object.entries(e).forEach(e=>{let[t,a]=e;s[t]={classes:a.currentClasses,content:a.currentContent}}),s}),u({})},[d,t,l,o,p]),_=Object.keys(d).length>0,k=(0,Y.useCallback)(e=>{if(null==(null==e?void 0:e.classes))return;const t=e.dataSourceLocation||e.tagName+JSON.stringify(e.linenumber);if(t!==m){x(t),f(e.classes);const s=i(e.classes);b(s),p(s=>s[t]?s:(0,ue.A)((0,ue.A)({},s),{},{[t]:{classes:e.classes,content:e.content||""}}))}},[m,i]),C=(0,Y.useCallback)(e=>{f(e);const t=i(e);b(t)},[i]);return(0,Y.useEffect)(()=>{t&&k(t)},[null==t?void 0:t.dataSourceLocation,null==t?void 0:t.linenumber,null==t?void 0:t.classes,null==t?void 0:t.content,null==t?void 0:t.tagName,k]),{changedElements:d,addToChangedElements:j,revertLastChangedElement:y,discardAllChanges:N,saveAllChanges:w,hasChanges:_,currentElement:{key:m,parsedClasses:v,rawClasses:g,updateClasses:C},selectElement:k}}({element:E||{classes:"",content:"",isTextElement:!1,tagName:""},onElementRevert:z,onChange:R,onContentChange:D,onBatchSave:U,onDiscard:B,parseTailwindClasses:sP,closeAllDropdowns:()=>{b({})}}),Z=Object.keys(H).length>0;(0,Y.useEffect)(()=>{Object.keys(H).length>0&&j&&y(!1)},[H,j]),(0,Y.useEffect)(()=>{m&&(async()=>{try{const e=await Yd.default.getStats();r(e)}catch(e){}})()},[m]);const J=!!m&&(m.daily_usage>=(m.daily_limit||1e6)||null!==m.monthly_limit&&void 0!==m.monthly_limit&&m.monthly_usage>=m.monthly_limit),Q=p?"Fetching from GitHub...":J?"0 credits remaining":Z?"Save changes before typing":a?"What would you like to discuss?":"What would you like to change?";return(0,se.jsxs)("div",{className:"h-full flex flex-col relative",children:[p&&(0,se.jsx)("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-50 flex items-center justify-center rounded-lg"}),(0,se.jsx)(yI,{githubSyncError:p?null:x,onGitHubSyncRetry:kx.performSync,addMessage:e=>(S&&B(),a&&(e.additional_message_params=e.additional_message_params||{},e.additional_message_params.discussion_mode=!0),o(e)),status:i.status,undoMessage:c,onStop:()=>{_.current&&clearTimeout(_.current),w(!0),d(),_.current=setTimeout(()=>{w(!1)},2e4)},showStopFeedback:N,suggestions:u,isDisabled:J||Z||p||A,isOutOfCredits:J,currentUsage:m,billingStats:l,placeholder:Q,isDiscussionMode:a,isVisualEditMode:S,minimizedChat:s,changeCount:Object.keys(H).length,onRevertChange:W,onDiscardAllChanges:()=>{0!==Object.keys(H).length&&(q(),y(!1))},onSaveAllChanges:async()=>{try{await G(),y(!1)}catch(e){$.toast.error("Failed to save changes: ".concat(e.message||"Unknown error"))}},isSavingChanges:P,bannerDismissed:j,onBannerDismiss:()=>{y(!0)},showInfrastructureUpdateBanner:A,onInfrastructureUpdate:()=>{dS.openModal("MigrateToNewInfraModal")},customButtomRight:null,customButtomLeft:(e,t)=>!A&&(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(SP,{onOpenChatSettings:()=>f(!0)}),(0,se.jsx)("div",{className:"h-6 w-px bg-gray-200 mx-2"}),e,!L&&(0,se.jsx)(wI,{isVisualEditMode:S,toggleVisualEditMode:M,isSaving:P}),!J&&(0,se.jsx)(EP,{isDiscussionMode:a,setIsDiscussionMode:n})]})}),(0,se.jsx)(fP,{isVisible:T&&!C,selectedElement:E,position:I,onClose:F,onSave:O,onDiscard:B,onChange:R,onContentChange:D,isSaving:P,onElementRevert:z,onAskQuestion:(e,t)=>{var s,n;const l={content:e,custom_context:[{type:"element",data:{element_tag_name:t.tagName,filename:(null===(s=t.dataSourceLocation)||void 0===s?void 0:s.split(":")[0])||"",linenumber:t.linenumber},message:"User has selected an element to edit, here's the element's code position: file: ".concat((null===(n=t.dataSourceLocation)||void 0===n?void 0:n.split(":")[0])||"",", line number: ").concat(t.linenumber)}]};a&&(l.additional_message_params=l.additional_message_params||{},l.additional_message_params.discussion_mode=!0),o(l)},openDropdowns:v,onOpenDropdownsChange:b,currentElement:K,addToChangedElements:V,hasUnsavedChanges:Z,isDiscussionMode:a}),(0,se.jsx)(jP,{isOpen:g,onClose:()=>f(!1)})]})}var IP=s(13129);const PP=["className"],LP=["withHandle","className","handle"],MP=e=>{let{className:t}=e,s=(0,Nt.A)(e,PP);return(0,se.jsx)(IP.YZ,(0,ue.A)({className:de("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t)},s))},RP=IP.Zk,DP=e=>{let{withHandle:t,className:s,handle:a}=e,n=(0,Nt.A)(e,LP);return(0,se.jsx)(IP.TW,(0,ue.A)((0,ue.A)({className:de("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",s)},n),{},{children:t&&(0,se.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:null!=a?a:(0,se.jsx)(UA.A,{className:"h-2.5 w-2.5"})})}))},FP=()=>(0,se.jsx)("div",{className:"flex flex-col h-full p-4",children:(0,se.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,se.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 animate-pulse",children:[(0,se.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-2 w-3/4"}),(0,se.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]},e))})});var OP=s(3255),UP=s(81103);const BP=e=>{let{isCurrentlyPublished:t,publishedDate:s,isPublishing:a}=e;if(a)return(0,se.jsxs)("div",{className:"px-2 py-0.5 rounded-[6px] bg-slate-100 border border-slate-300 inline-flex items-center gap-1.5",children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin text-slate-600"}),(0,se.jsx)("span",{className:"text-[11px] font-medium font-base44 text-slate-600",children:"publishing..."})]});const n="px-2 py-0.5 border border-transparent rounded-[6px] text-[11px] font-medium font-base44 inline-block ".concat(t?"bg-green-100 text-green-700":"bg-white text-gray-600 border border-gray-200"),l=t?"live":"published";if(s){const{absolute:e}=am(s),a=t?"Published on ".concat(e):"Previously published on ".concat(e);return(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("span",{className:n,children:l})}),(0,se.jsx)(pp,{className:"bg-gray-900 text-white border-gray-900 font-base44 max-w-[200px]",children:(0,se.jsx)("p",{children:a})})]})})}return(0,se.jsx)("div",{className:n,children:l})},zP=e=>{let{status:t,buildError:s}=e;const[a,n]=(0,Y.useState)(!1);return t&&"ready"!==t?"building"===t||"pending"===t?(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)("div",{className:"px-2 py-0.5 rounded-[6px] bg-amber-50 border border-amber-200 inline-flex items-center gap-1.5",children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin text-amber-600"}),(0,se.jsx)("span",{className:"text-[11px] font-medium font-base44 text-amber-700",children:"building"})]})}),(0,se.jsx)(pp,{className:"bg-gray-900 text-white border-gray-900 font-base44 max-w-[200px]",children:(0,se.jsx)("p",{children:"Preview is being built. Please wait..."})})]})}):"failed"===t?s?(0,se.jsxs)(Og,{open:a,onOpenChange:n,children:[(0,se.jsx)(Ug,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,se.jsxs)("button",{className:"px-2 py-0.5 rounded-[6px] bg-red-50 border border-red-200 inline-flex items-center gap-1.5 hover:bg-red-100 transition-colors cursor-pointer",children:[(0,se.jsx)(ad.A,{className:"h-3 w-3 text-red-600"}),(0,se.jsx)("span",{className:"text-[11px] font-medium font-base44 text-red-700",children:"failed"})]})}),(0,se.jsxs)(Hg,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)(qg,{className:"font-base44 flex items-center gap-2",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-red-600"}),"Build Failed"]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-auto space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Error Message"}),(0,se.jsx)("pre",{className:"bg-gray-100 rounded-lg p-3 text-sm text-red-700 whitespace-pre-wrap break-words font-mono",children:s.message})]}),s.stdout&&(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Build Output"}),(0,se.jsx)("pre",{className:"bg-gray-900 rounded-lg p-3 text-sm text-gray-100 whitespace-pre-wrap break-words font-mono max-h-48 overflow-auto",children:s.stdout})]}),s.stderr&&(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Error Output"}),(0,se.jsx)("pre",{className:"bg-gray-900 rounded-lg p-3 text-sm text-red-400 whitespace-pre-wrap break-words font-mono max-h-48 overflow-auto",children:s.stderr})]})]})]})]}):(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)("div",{className:"px-2 py-0.5 rounded-[6px] bg-red-50 border border-red-200 inline-flex items-center gap-1.5",children:[(0,se.jsx)(ad.A,{className:"h-3 w-3 text-red-600"}),(0,se.jsx)("span",{className:"text-[11px] font-medium font-base44 text-red-700",children:"failed"})]})}),(0,se.jsx)(pp,{className:"bg-gray-900 text-white border-gray-900 font-base44 max-w-[200px]",children:(0,se.jsx)("p",{children:"Preview build failed"})})]})}):null:null},HP=e=>{let{checkpoint:t,size:s="default",messageId:a,onGoToMessage:n}=e;const{app:l}=lp(),{setSelectedCheckpoint:r,selectedCheckpoint:i,isLoading:o,isSyncingSandboxCheckpoint:c,getGitHubCommitUrl:d}=Tx(),u=vy.usePublishingCheckpointId(),m=o||c,x=null!=t.last_deployed_at,h=l.last_deployed_checkpoint_id===t.id,p=(null==i?void 0:i.id)===t.id,{hasGitCommitHash:g,isPreviewBuilding:f,isPreviewFailed:v,isPreviewReady:b}=Rh(t),{retryBuild:j,isRetrying:y}=Mh(t),N=u===t.id,w=(null==l?void 0:l.last_deployed_checkpoint_id)===t.id,_=h,{relative:k,absolute:C}=am(t.created_date);return(0,se.jsxs)("div",{className:de("sm:border border-b border-gray-200 dark:border-gray-700 sm:rounded-lg ".concat("px-3 py-3"," relative cursor-pointer transition-all flex flex-col"),{"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":p,"hover:border-blue-200 dark:hover:border-blue-800 hover:bg-gray-50 dark:hover:bg-gray-800/50":!p&&!f,"opacity-50 pointer-events-none":m&&!p,"cursor-not-allowed opacity-70":f}),onClick:()=>{f||r(t)},role:"button",tabIndex:f?-1:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),f||r(t))},children:[(0,se.jsxs)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex flex-row items-center gap-1 justify-end",children:[m&&p&&(0,se.jsx)(Ac.A,{className:"h-3.5 w-3.5 text-blue-500 animate-spin"}),g&&(0,se.jsx)(zP,{status:t.preview_status,buildError:t.build_error}),(x||N||w||h)&&(0,se.jsx)("div",{className:"",children:(0,se.jsx)(BP,{isCurrentlyPublished:_,publishedDate:t.last_deployed_at,isPublishing:N})}),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,se.jsx)(Bx,{variant:"ghost",size:"xTiny","aria-label":"More options",children:(0,se.jsx)(mb.A,{className:"h-3.5 w-3.5 text-gray-500 dark:text-gray-400"})})}),(0,se.jsxs)(Aj,{align:"end",className:"w-56 font-base44",children:[(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),dS.openModal("PublishVersionModal",{checkpoint:t})},disabled:_||m,children:[(0,se.jsx)(OP.A,{className:"mr-2 h-4 w-4"}),(0,se.jsx)("span",{children:"Publish this version"})]}),(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),dS.openModal("RestoreVersionModal",{checkpoint:t})},disabled:m,children:[(0,se.jsx)(UP.A,{className:"mr-2 h-4 w-4"}),(0,se.jsx)("span",{children:"Revert to this version"})]}),v&&(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),j()},disabled:y,children:[y?(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,se.jsx)(Fx.A,{className:"mr-2 h-4 w-4"}),(0,se.jsx)("span",{children:y?"Retrying...":"Retry build"})]}),(()=>{const e=d(t);return e?(0,se.jsxs)(Sj,{onClick:t=>{t.stopPropagation(),gd(e,"_blank","noopener,noreferrer")},disabled:m,children:[(0,se.jsx)(Rj.A,{className:"mr-2 h-4 w-4"}),(0,se.jsx)("span",{children:"View in GitHub"})]}):(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),r(t),dm.codeViewVisible=!0},disabled:m||!b,children:[(0,se.jsx)(Jv.A,{className:"mr-2 h-4 w-4"}),(0,se.jsx)("span",{children:"View code"})]})})(),a&&n&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Tj,{}),(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),n(a)},children:[(0,se.jsx)(Xx.A,{className:"mr-2 h-4 w-4"}),(0,se.jsx)("span",{children:"Go to message in chat"})]})]})]})]})]}),(0,se.jsx)("div",{className:"text-sm leading-none font-medium font-base44 pr-2",children:t.name}),(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)("div",{className:"text-xs leading-none font-normal font-base44 text-gray-500 inline-flex items-center gap-1 mt-1",children:[t.is_github_sync&&(0,se.jsx)(Zb,{className:"w-3.5 h-3.5"}),k]})}),(0,se.jsx)(pp,{side:"bottom",align:"start",className:"bg-gray-900 text-white border-gray-900 font-base44 max-w-[200px]",children:(0,se.jsx)("p",{children:C})})]})})]})},VP=()=>{const{app:e}=lp(),t=(0,J.Zp)(),s=(0,J.zy)(),{showCheckpoints:a}=dm.usePick("showCheckpoints"),{checkpointsWithChatMatch:n,checkpointsWithNoMatch:l,allCheckpoints:r,isLoading:i,showOtherCheckpoints:o,setShowOtherCheckpoints:c,setSelectedCheckpoint:d,isSyncingSandboxCheckpoint:u,refreshCheckpoints:m,loadMoreCheckpoints:x,hasNextPage:h}=Tx();(0,Y.useEffect)(()=>{a&&m()},[a]);const p=a=>{dm.showCheckpoints=!1,d(null);if("workspace"===dm.view){const n=s.pathname.match(/\/workspace\/([^/?]+)/),l=n?n[1]:"overview";t("/apps/".concat(e.id,"/editor/workspace/").concat(l,"?msgId=").concat(a))}else{const n=s.pathname.match(/\/preview\/([^/?]+)/),l=n?"/".concat(n[1]):"";t("/apps/".concat(e.id,"/editor/preview").concat(l,"?msgId=").concat(a))}};return i&&r.length<3?(0,se.jsx)(FP,{}):(0,se.jsxs)("div",{className:"flex flex-col h-full gap-4",children:[(0,se.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,se.jsx)(HP,{checkpoint:e,size:"default",messageId:e.message_id,onGoToMessage:p},e.id))}),h&&(0,se.jsx)(Bx,{onClick:x,variant:"ghost",disabled:i||u,className:"text-sm text-blue-500 hover:text-blue-600 hover:underline disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:"Load Previous Versions"}),l.length>0&&(0,se.jsxs)("div",{className:"mt-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,se.jsx)(Bx,{variant:"ghost",className:"w-full justify-start p-3 h-auto text-left hover:bg-gray-50 dark:hover:bg-gray-800/50",onClick:()=>c(!o),disabled:i,children:(0,se.jsxs)("div",{className:"flex items-start justify-between w-full",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0 mr-3",children:[(0,se.jsx)("div",{className:"font-medium text-sm mb-1",children:"Alternative Versions"}),(0,se.jsxs)("div",{className:"text-xs text-gray-500 leading-relaxed",children:["These versions may be from alternative paths,",(0,se.jsx)("br",{}),"created when reverting to previous checkpoints"]})]}),(0,se.jsx)("div",{className:"flex-shrink-0 ml-2",children:o?(0,se.jsx)(_t.A,{className:"h-4 w-4 text-gray-400"}):(0,se.jsx)(bs.A,{className:"h-4 w-4 text-gray-400"})})]})}),o&&(0,se.jsx)("div",{className:"space-y-2 mt-3",children:l.map(e=>(0,se.jsx)(HP,{checkpoint:e,size:"small",messageId:e.message_id,onGoToMessage:void 0},e.id))})]})]})},WP=e=>{var t;const{user:s}=wd(),a=(0,Y.useRef)(null),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!0),o=(0,Y.useRef)(null),c=(0,Y.useRef)(0),d=gu.useMessages();(0,Y.useEffect)(()=>{const e=()=>{i(!document.hidden)},t=()=>{i(!0)},s=()=>{i(!1)};return i(!document.hidden),document.addEventListener("visibilitychange",e),window.addEventListener("focus",t),window.addEventListener("blur",s),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("focus",t),window.removeEventListener("blur",s)}},[]),(0,Y.useEffect)(()=>{if(!s||"never"===(null==s?void 0:s.notification_preference))return;if(!a.current){const e=new Audio("/sounds/notification.mp3");let t=!1;e.addEventListener("error",s=>{t||(t=!0),e.src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT"}),a.current=e}const e=()=>{n||(l(!0),(()=>{const e=new Audio("data:audio/wav;base64,UklGRiIAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=");e.volume=0,e.play().catch(()=>{})})(),document.removeEventListener("click",e),document.removeEventListener("keydown",e))};return document.addEventListener("click",e),document.addEventListener("keydown",e),()=>{document.removeEventListener("click",e),document.removeEventListener("keydown",e)}},[n,s,null==s?void 0:s.notification_preference]),(0,Y.useEffect)(()=>()=>{a.current&&(a.current.pause(),a.current=null)},[]),(0,Y.useEffect)(()=>{var t;if(!a.current)return;const n=null===(t=e.status)||void 0===t?void 0:t.state,l=(null==d?void 0:d.length)||0,i=(null==d?void 0:d.some(e=>"user"===e.role))||!1;if("processing"===o.current&&"ready"===n&&i){(()=>!r&&("never"!==(null==s?void 0:s.notification_preference)&&("every_prompt"===(null==s?void 0:s.notification_preference)||"on_first_prompt"===(null==s?void 0:s.notification_preference)&&l<=2)))()&&(a.current.volume=.5,a.current.play().catch(()=>{}))}o.current=n||null,c.current=l},[null==e||null===(t=e.status)||void 0===t?void 0:t.state,d,null==s?void 0:s.notification_preference,r])},qP=()=>{const{app:e,setApp:t,refreshSuggestions:s}=lp(),a=(0,J.zy)(),n=(0,J.Zp)(),{user:l}=wd();WP(e),(0,Y.useEffect)(()=>{const e=new URLSearchParams(a.search).get("referrer");e&&(dm.referrer=e)},[a.search]),(0,Y.useEffect)(()=>(null!=e&&e.name?document.title="".concat(e.name," | Base44"):document.title="Base44",()=>{document.title="Base44"}),[null==e?void 0:e.name]),(0,Y.useEffect)(()=>{if(null!=e&&e.id){var r,i;let o=(null===(r=a.state)||void 0===r?void 0:r.initialPrompt)||(null===(i=a.state)||void 0===i?void 0:i.initialMessage);if(!o){const e=new URLSearchParams(a.search).get("initialPrompt");e&&(o=e)}if(o){const r="string"==typeof o?{content:o}:o;if(Gh(e.id,r,null==l?void 0:l.id).then(e=>{e&&(t(e),s())}),a.search.includes("initialPrompt")){const e=new URLSearchParams(a.search);e.delete("initialPrompt");const t=e.toString();n(a.pathname+(t?"?".concat(t):""),{replace:!0,state:{}})}else n(a.pathname,{replace:!0,state:{}})}}},[a.state,a.search,null==e?void 0:e.id,null==l?void 0:l.id,n,a.pathname,t])};var YP=s(24276),GP=s(18134),KP=s(29126),$P=s(25867);const ZP={overview:YP.A,data:oy.A,users:eb.A,analytics:GP.A,domains:KP.A,"app-connections":$P.A,security:Yc.A,code:jg.A,logs:xb.A,settings:vP.A,payments:su.A,secrets:xb.A,api:jg.A,agents:wP.A,automations:yS.A},JP=e=>{if(e.id&&e.id.startsWith("entity-"))return null;const t=ZP[e.id];return!t&&e.icon?(0,se.jsx)("div",{className:"min-w-[16px] flex items-center justify-center",children:e.icon}):t?(0,se.jsx)(t,{className:"w-4 h-4"}):null},QP=e=>{let{badge:t,className:s}=e;return null==t?null:(0,se.jsx)("div",{className:s,children:"number"==typeof t?(0,se.jsx)("div",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full text-white text-xs font-semibold",style:{backgroundColor:"#FFB700"},children:t}):(0,se.jsx)(gk,{variant:"secondary",className:"px-1.5 py-0 text-xs",children:t})})},XP=(e,t)=>e.id===t||!!e.subitems&&e.subitems.some(e=>XP(e,t)),eL=e=>{let{item:t,selected:s,onSelect:a,searchTerm:n,level:l=0}=e;const r=s===t.id,i=t.subitems&&t.subitems.some(e=>s===e.id||!!e.subitems&&XP(e,s));return!n||t.label.toLowerCase().includes(n.toLowerCase())||t.subitems&&t.subitems.some(e=>e.label.toLowerCase().includes(n.toLowerCase())||e.subitems&&e.subitems.some(e=>e.label.toLowerCase().includes(n.toLowerCase())))?t.subitems?(0,se.jsxs)(Qj,{defaultOpen:r||i,className:de("group",l>0?"ml-3":""),children:[(0,se.jsxs)("div",{className:"flex items-center w-full",children:[(0,se.jsx)(Xj,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"ghost",className:de("flex-1 justify-start px-3 py-2.5 text-sm rounded-lg transition-colors",r||i?"bg-primary/10 text-primary":"text-foreground hover:bg-gray-100"),children:[(0,se.jsx)("div",{className:de("w-6 h-6 flex items-center justify-center",r?"text-primary":"text-muted-foreground"),children:JP(t)}),(0,se.jsx)("span",{className:"ml-3 truncate",children:t.label}),(0,se.jsx)(QP,{badge:t.badge,className:"ml-auto mr-2"}),(0,se.jsx)("div",{className:t.badge?"":"ml-auto",children:(0,se.jsx)(_t.A,{className:"h-4 w-4 transition-transform group-data-[state=open]:rotate-180 text-muted-foreground"})})]})}),t.headerAction&&(0,se.jsx)("div",{className:"pr-2",onClick:e=>e.stopPropagation(),children:t.headerAction})]}),(0,se.jsxs)(ey,{className:"mt-1 relative",children:[(0,se.jsx)("div",{className:"absolute left-6 top-0 bottom-0 w-px bg-gray-200"}),t.subitems.map((e,t)=>(0,se.jsx)(eL,{item:e,selected:s,onSelect:a,searchTerm:n,level:l+1},t))]})]}):(0,se.jsxs)(Bx,{variant:"ghost",className:de("w-full justify-start px-3 py-2.5 text-sm rounded-lg transition-colors",r?"bg-primary/10 text-primary":"text-foreground hover:bg-gray-100"),onClick:()=>a(t.id),children:[(0,se.jsx)("div",{className:de("w-6 h-6 flex items-center justify-center",r?"text-primary":"text-muted-foreground"),children:JP(t)}),(0,se.jsx)("span",{className:"ml-3 truncate",children:t.label}),(0,se.jsx)(QP,{badge:t.badge,className:"ml-auto"})]}):null},tL=e=>{let{items:t,selected:s,onSelect:a,isOpen:n,onClose:l,title:r,showBackButton:i,onBack:o,showSearch:c=!1,style:d,trackingOrigin:u="app_dashboard_sidebar",variant:m="drawer"}=e;const[x,h]=(0,Y.useState)(""),[p,g]=(0,Y.useState)(!1),f=(0,Y.useCallback)((e,t)=>{for(const s of t){if(s.id===e)return s.label;if(s.subitems){const t=f(e,s.subitems);if(void 0!==t)return t}}},[]),v=(0,Y.useCallback)(e=>e.startsWith("trash-entity-")?{id:"data-trash",label:"Data-Trash"}:e.startsWith("entity-")?{id:"data",label:"Data"}:null,[]),b=(0,Y.useCallback)(e=>{var s,n,l;const r=v(e),i=null!==(s=null==r?void 0:r.id)&&void 0!==s?s:e,o=null!==(n=null!==(l=null==r?void 0:r.label)&&void 0!==l?l:f(e,t))&&void 0!==n?n:e;Tu("Dashboard Menu - Click",{menu_item_id:i,menu_item_label:o,origin:u}),a(e)},[t,a,f,v,u]),j=(0,se.jsxs)(se.Fragment,{children:[i&&(0,se.jsxs)(Bx,{variant:"ghost",className:"justify-start mx-3 mb-2 px-4 text-sm",onClick:o,children:[(0,se.jsx)(bs.A,{className:"h-4 w-4 mr-2 rotate-180"}),"Back to Editor"]}),c&&(0,se.jsx)("div",{className:"px-3 pt-2 pb-4",children:(0,se.jsxs)("div",{className:de("relative flex items-center",p?"ring-2 ring-ring":""),children:[(0,se.jsx)(na.A,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),(0,se.jsx)("input",{type:"text",placeholder:"Search...",value:x,onChange:e=>h(e.target.value),className:de("w-full py-2 pl-9 pr-3 bg-gray-100 rounded-lg text-sm","focus:outline-none transition-all","placeholder:text-muted-foreground","text-foreground"),onFocus:()=>g(!0),onBlur:()=>g(!1)})]})}),(0,se.jsx)("nav",{className:"flex-1 overflow-y-auto py-1 px-3 space-y-1 scrollbar-thin scrollbar-thumb-muted",children:t.map((e,t)=>(0,se.jsx)(eL,{item:e,selected:s,onSelect:b,searchTerm:x},t))})]});return"sheet"===m?(0,se.jsx)(Sy,{open:n,onOpenChange:e=>!e&&l(),children:(0,se.jsxs)(Ly,{side:"bottom",showDragHandle:!1,className:"h-[70vh] rounded-t-2xl px-0 pt-2 flex flex-col",children:[(0,se.jsx)(Fy,{onClose:l}),(0,se.jsx)("div",{className:"flex flex-col flex-1 overflow-hidden",children:j})]})}):(0,se.jsx)("div",{className:"bg-white border-r w-full h-full flex flex-col",style:d,children:j})};var sL=s(58907),aL=s(27255),nL=s(98989);const lL=e=>{let{children:t,className:s,title:a,prefix:n,subtitle:l,primaryAction:r,actions:i,filters:o,content:c}=e;return(0,se.jsxs)("div",{className:de("flex flex-col p-6 gap-6 h-full font-base44 md:max-w-[1200px] mx-auto",s),children:[(0,se.jsxs)("div",{className:"flex flex-row items-center justify-between gap-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[n&&(0,se.jsx)("div",{className:"flex shrink-0",children:n}),(0,se.jsxs)("div",{className:"flex flex-col gap-1 min-w-0",children:[(0,se.jsx)("h2",{className:"font-semibold text-xl truncate",children:a}),l&&(0,se.jsx)("p",{className:"text-sm text-[#737373] font-normal",children:l})]})]}),(i||r)&&(0,se.jsxs)("div",{className:"flex flex-row gap-2 items-center shrink-0",children:[i,r]})]}),o&&(0,se.jsx)("div",{className:"flex md:flex-row md:items-center flex-wrap gap-2 w-full items-left",children:o}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col gap-3 min-h-0",children:[c,t]})]})},rL=e=>{if((e=>e.startsWith("data:")&&e.includes(";base64,"))(e)){const t=e.match(/^data:([^;]+);base64,/),s=t?t[1]:"unknown";return"[Base64 ".concat(s,"]")}return e.length>500?e.slice(0,500)+"...":e},iL=e=>{let{entity:t,onDelete:s}=e;return Y.useMemo(()=>{const e=Object.keys(t.properties).map(e=>({id:e,title:t.properties[e].title||e,render:t=>(e=>{var t;if(null==e)return(0,se.jsx)(__,{size:"small",ellipsis:!0});const s="object"==typeof e?null!==(t=JSON.stringify(e))&&void 0!==t?t:"":String(e),a=rL(s);return(0,se.jsx)(__,{size:"small",ellipsis:!0,children:a})})(t[e]),width:200}));return e.push({id:"actions",title:"",align:"end",stickyActionCell:!0,width:50,render:e=>(0,se.jsx)(kC,{alwaysVisible:!1,primaryAction:(0,se.jsx)(Bx,{size:"tiny",variant:"outline",onClick:t=>s(e,t),className:"text-red-500 hover:text-red-600",children:(0,se.jsx)(nL.A,{className:"h-3 w-3"})})})}),e},[t,s])},oL=e=>{let{className:t,size:s="md",text:a,textPosition:n="bottom","aria-label":l}=e;const r="sm"===s?"tiny":"lg"===s?"medium":"small",i=l||a||"Loading";return(0,se.jsx)("div",{className:"h-full w-full flex items-center justify-center",role:"status","aria-live":"polite","aria-busy":"true",children:(0,se.jsxs)("div",{className:de("flex items-center gap-3",{"flex-col":"bottom"===n,"flex-row":"right"===n}),children:[(0,se.jsx)(Ac.A,{className:de("animate-spin text-muted-foreground shrink-0",{"h-4 w-4":"sm"===s,"h-8 w-8":"md"===s,"h-12 w-12":"lg"===s},t),"aria-hidden":"true"}),a?(0,se.jsx)(__,{size:r,secondary:!0,children:a}):(0,se.jsx)("span",{className:"sr-only",children:i})]})})},cL=e=>{let{onRowClick:t,onDelete:s,loadMore:a,entities:n,hasMore:l,isLoading:r,isFilterChanging:i,entity:o,actions:c,isDevMode:d}=e;const u=iL({entity:o,onDelete:async(e,t)=>{t.stopPropagation(),window.confirm("Are you sure you want to delete this record?")&&s(e)}});return(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)(wC,{data:n,columns:u,onRowClick:t,hasMore:l,loadMore:a,children:[(0,se.jsx)(wC.Toolbar,{autoCollapseToolbar:!1,children:c}),r&&0===n.length?(0,se.jsx)(uC,{title:"Loading ".concat(o.name,"..."),subtitle:"",children:(0,se.jsx)("div",{className:"flex justify-center items-center py-6",children:(0,se.jsx)(oL,{})})}):(0,se.jsx)(uC,{title:"No records found",subtitle:"Get started by adding your first record."}),(0,se.jsx)(wC.Content,{className:de({"opacity-50 pointer-events-none":i||r}),headerClassName:d?"bg-green-50":void 0})]})})},dL={isValidSchema:e=>"string"===(null==e?void 0:e.type)&&null==(null==e?void 0:e.format)&&!Array.isArray(null==e?void 0:e.enum),FilterComponent:e=>{let{schema:t,value:s,onChange:a,className:n}=e;const l=null!=s?s:(e=>{var t;return null!==(t=e.default)&&void 0!==t?t:""})(t);return(0,se.jsx)(Df,{type:"text",value:l,onChange:e=>a(e.target.value),className:n})},filterTypeLabel:()=>"Text Search",constructQuery:(e,t)=>{if(null!=t&&t.length&&(e=>"string"==typeof e)(t))return{[e.join(".")]:{$regex:Tv(t),$options:"i"}}}},uL=e=>{let{value:t,onChange:s,placeholder:a="Search...",debounce:n=500,className:l}=e;const[r,i]=(0,Y.useState)(t),o=Ix(r,n);(0,Y.useEffect)(()=>{i(t)},[t]),(0,Y.useEffect)(()=>{o!==t&&s(o)},[o,t,s]);return(0,se.jsxs)("div",{className:de("relative flex-1 sm:flex-initial sm:min-w-64",l),children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-950 pointer-events-none"}),(0,se.jsx)("input",{type:"text",placeholder:a,className:de("w-full h-9 rounded-lg border border-input bg-white","pl-9 pr-3 py-1","text-sm font-normal leading-5 text-foreground placeholder:text-muted-foreground","focus-visible:outline-none focus-visible:border-neutral-500","disabled:cursor-not-allowed disabled:opacity-50","transition-colors"),value:r,onChange:e=>{const t=e.target.value;i(t)}})]})},mL=e=>{var t;let{filters:s,upsertFilter:a,placeholder:n}=e;const l=qu(),r=Y.useMemo(()=>{var e;return null!==(e=Object.keys(s).filter(e=>dL.isValidSchema(s[e].schema)))&&void 0!==e?e:[]},[s]),i=r[0];return(0,se.jsxs)("div",{className:"flex flex-row w-full gap-2",children:[(0,se.jsx)(uL,{debounce:500,placeholder:null!=n?n:"Search by ".concat(r.join(", ")),value:null===(t=s[i])||void 0===t?void 0:t.value,onChange:e=>{const t=e;r.forEach(e=>{a(e,{enabled:t.length>2,queryOperator:"$or",value:t})})}}),r.length>2&&!l&&(0,se.jsx)(st.TooltipProvider,{children:(0,se.jsxs)(st.Tooltip,{delayDuration:400,children:[(0,se.jsx)(st.TooltipTrigger,{children:(0,se.jsx)(Oy.A,{className:"h-4 w-4"})}),(0,se.jsxs)(st.TooltipContent,{align:"end",className:"z-50 flex flex-col gap-2 text-xs bg-foreground rounded-md p-2 shadow-md text-white",children:[(0,se.jsx)("div",{className:"text-sm  flex w-full justify-start",children:"Search by:"}),(0,se.jsx)("div",{className:"grid grid-cols-".concat(r.length%2==0?2:3," gap-2 max-h-[200px] overflow-y-auto "),children:r.map(e=>(0,se.jsx)("div",{className:"flex items-center",children:e},e))})]})]})})]})},xL=["type"],hL={isValidSchema:e=>"string"===(null==e?void 0:e.type)&&("date"===(null==e?void 0:e.format)||"date-time"===(null==e?void 0:e.format)||"time"===(null==e?void 0:e.format)),FilterComponent:e=>{let{value:t,onChange:s}=e;const a=(0,ue.A)({type:null,from:null,to:null},t),{type:n}=a,l=(0,Nt.A)(a,xL),{Component:r,fromDateRange:i,toDateRange:o}=(0,ue.A)({toDateRange:()=>({from:null,to:null}),fromDateRange:e=>e,Component:()=>null},gL[n]);return Y.useEffect(()=>{const e=o(i(l));s((0,ue.A)((0,ue.A)({},e),{},{type:n}))},[n]),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)(Wf,{value:null!=n?n:void 0,onValueChange:e=>{s((0,ue.A)((0,ue.A)({},l),{},{type:e}))},children:[(0,se.jsx)(Yf,{children:(0,se.jsx)(qf,{placeholder:(0,se.jsx)("span",{className:"text-sm font-base44 text-gray-500",children:"Select Date"})})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"pastWeek",children:"in the last 7 days"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"pastMonth",children:"in the last 30 days"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"past90Days",children:"in the last 90 days"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"afterDate",children:"is or after"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"beforeDate",children:"is or before"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"betweenDates",children:"is between"})]})]}),r&&(0,se.jsx)(r,{dates:i(l),onChangeDates:e=>s((0,ue.A)({type:n},o(e)))})]})},filterTypeLabel:()=>"Date Range",constructQuery:(e,t)=>{var s,a;if((e=>(null==e?void 0:e.to)instanceof Date||(null==e?void 0:e.from)instanceof Date)(t))return{[e.join(".")]:{$gte:null===(s=t.from)||void 0===s?void 0:s.toISOString(),$lte:null===(a=t.to)||void 0===a?void 0:a.toISOString()}}}};function pL(e){let{dates:t,onChangeDates:s}=e;return(0,se.jsx)(V_,{format:"date",closeOnSelect:!0,className:"",value:t,onChange:e=>s(e)})}const gL={pastWeek:{toDateRange:()=>({from:new Date((new Date).setDate((new Date).getDate()-7)),to:new Date})},pastMonth:{toDateRange:()=>({from:new Date((new Date).setDate((new Date).getDate()-30)),to:new Date})},past90Days:{toDateRange:()=>({from:new Date((new Date).setDate((new Date).getDate()-90)),to:new Date})},afterDate:{Component:pL,toDateRange:e=>({from:e,to:null}),fromDateRange:e=>e.from},beforeDate:{Component:pL,toDateRange:e=>({from:null,to:e}),fromDateRange:e=>e.to},betweenDates:{Component:function(e){let{dates:t,onChangeDates:s}=e;return(0,se.jsxs)("div",{className:de("grid grid-cols-[min-content_1fr] gap-1 w-full items-center"),children:[(0,se.jsx)(aN,{children:"From"}),(0,se.jsx)(V_,{format:"date",closeOnSelect:!0,className:"",value:null==t?void 0:t.from,onChange:e=>s((0,ue.A)((0,ue.A)({},t),{},{from:e}))}),(0,se.jsx)(aN,{children:"To"}),(0,se.jsx)(V_,{format:"date",closeOnSelect:!0,className:"",value:null==t?void 0:t.to,onChange:e=>s((0,ue.A)((0,ue.A)({},t),{},{to:e}))})]})},toDateRange:e=>{let{from:t,to:s}=e;return{from:t,to:s}}}},fL=["type"],vL={isValidSchema:e=>"number"===(null==e?void 0:e.type)||"integer"===(null==e?void 0:e.type),FilterComponent:e=>{var t;let{schema:s,value:a,onChange:n}=e;const l=(0,ue.A)({type:null,from:null,to:null},a),{type:r}=l,i=(0,Nt.A)(l,fL),{Component:o,fromNumberRange:c,toNumberRange:d}=Y.useMemo(()=>(0,ue.A)({toNumberRange:()=>({from:null,to:null}),fromNumberRange:e=>e,Component:()=>null},jL[r]),[r,s,a,i]);return Y.useEffect(()=>{const e=d(c(i));n((0,ue.A)((0,ue.A)({},e),{},{type:r}))},[r]),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)(Wf,{value:null!=r?r:void 0,onValueChange:e=>{n((0,ue.A)((0,ue.A)({},i),{},{type:e}))},children:[(0,se.jsx)(Yf,{children:(0,se.jsx)(qf,{placeholder:(0,se.jsx)("span",{className:"text-sm font-base44 text-gray-500",children:"Select Number"})})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"lessThan",children:"Smaller than"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"greaterThan",children:"Greater than"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"between",children:"Range"}),(0,se.jsx)(Zf,{hideCheckIcon:!0,value:"equalTo",children:"Exact"})]})]}),o&&(0,se.jsx)(o,{value:null!==(t=c(i))&&void 0!==t?t:null,onChangeNumbers:e=>n((0,ue.A)({type:r},d(e)))})]})},filterTypeLabel:()=>"Number Range",constructQuery:(e,t)=>{if((e=>null!=(null==e?void 0:e.to)||null!=(null==e?void 0:e.from))(t))return{[e.join(".")]:{$gte:null!=t.from?Number(t.from):void 0,$lte:null!=t.to?Number(t.to):void 0}}}};function bL(e){let{value:t,onChangeNumbers:s}=e;return(0,se.jsx)(Df,{type:"number",placeholder:"number",value:t,className:"focus-visible:ring-0",onChange:e=>s(e.target.value?Number(e.target.value):void 0)})}const jL={lessThan:{toNumberRange:e=>({from:null,to:e}),fromNumberRange:e=>e.to,Component:bL},greaterThan:{toNumberRange:e=>({from:e,to:null}),fromNumberRange:e=>e.from,Component:bL},between:{toNumberRange:e=>({from:e.from,to:e.to}),Component:function(e){let{value:t,onChangeNumbers:s}=e;return(0,se.jsxs)("div",{className:de("grid grid-cols-[min-content_1fr] text-sm gap-2 w-full items-center"),children:[(0,se.jsx)(aN,{children:"From:"}),(0,se.jsx)(Df,{type:"number",placeholder:"from",value:null==t?void 0:t.from,className:"focus-visible:ring-0",onChange:e=>s({to:null==t?void 0:t.to,from:e.target.value?Number(e.target.value):void 0})}),(0,se.jsx)(aN,{children:"To:"}),(0,se.jsx)(Df,{type:"number",className:" focus-visible:ring-0",placeholder:"to",value:null==t?void 0:t.to,onChange:e=>s({from:null==t?void 0:t.from,to:e.target.value?Number(e.target.value):void 0})})]})}},equalTo:{toNumberRange:e=>({from:e,to:e}),fromNumberRange:e=>e.from,Component:bL}},yL={isValidSchema:e=>"string"===(null==e?void 0:e.type)&&Array.isArray(null==e?void 0:e.enum),FilterComponent:e=>{var t,s;let{schema:a,value:n,onChange:l,className:r}=e;const i=null!=n?n:{values:[]},o=null!==(t=a.enum)&&void 0!==t?t:[],c=null!==(s=null==i?void 0:i.values)&&void 0!==s?s:[];return(0,se.jsx)("div",{className:de("flex flex-col gap-2 w-full",r),children:null==o?void 0:o.map(e=>(0,se.jsxs)("div",{className:de("flex flex-row gap-2",{}),onClick:t=>{t.stopPropagation(),t.preventDefault(),(e=>{const t=c.includes(e);let s=[...c];t?s=s.filter(t=>t!==e):s.push(e),l({values:s})})(e)},children:[(0,se.jsx)(E_,{checked:c.includes(e)}),(0,se.jsx)(aN,{className:"text-sm font-normal",children:e})]},e))})},filterTypeLabel:()=>"Multiple Selection",constructQuery:(e,t)=>{var s;if(null!=t&&null!==(s=t.values)&&void 0!==s&&s.length&&(e=>(null==e?void 0:e.values)instanceof Array)(t))return{[e.join(".")]:{$in:t.values}}}},NL={isValidSchema:e=>{const t="object"==typeof(null==e?void 0:e.items)?null==e?void 0:e.items:{};return"array"===(null==e?void 0:e.type)&&!t.enum&&!t.format&&!t.$ref},FilterComponent:e=>{var t;let{value:s,onChange:a,className:n}=e;return(0,se.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,se.jsx)(G_,{value:null!==(t=null==s?void 0:s.values)&&void 0!==t?t:[],onChange:e=>a({values:e}),className:de("text-xs max-w-[250px]",n)}),(0,se.jsx)("div",{className:"flex text-sm text-gray-500",children:"Use commas to separate multiple values"})]})},filterTypeLabel:()=>"Values Collection",constructQuery:(e,t)=>{var s;if(null!=t&&null!==(s=t.values)&&void 0!==s&&s.length&&(e=>(null==e?void 0:e.values)instanceof Array)(t))return{[e.join(".")]:{$in:t.values}}}},wL={isValidSchema:e=>"boolean"===(null==e?void 0:e.type),FilterComponent:e=>{let{value:t,onChange:s,className:a}=e;const n=null==t?void 0:t.value,[l,r]=(0,Y.useState)(!0===n),[i,o]=(0,Y.useState)(!1===n);(0,Y.useEffect)(()=>{!0!==n||l||r(!0),!1!==n||i||o(!0)},[n]);const c=e=>{e?(r(e=>!e),o(!1)):(o(e=>!e),r(!1))};return(0,Y.useEffect)(()=>{s({value:l===i?null:!!l})},[l,i]),(0,se.jsxs)("div",{className:de("flex flex-row gap-4",a),children:[(0,se.jsx)("div",{className:de("flex flex-row gap-2",a),children:(0,se.jsx)(Bx,{variant:"outline",className:de("bg-transparent hover:bg-transparent ",{"bg-slate-200 hover:bg-slate-200":l,"":!l}),onClick:()=>c(!0),children:"True"})}),(0,se.jsx)("div",{className:de("flex flex-row gap-2",a),children:(0,se.jsx)(Bx,{variant:"outline",className:de("bg-transparent hover:bg-transparent ",{"bg-slate-200 hover:bg-slate-200":i,"":!i}),onClick:()=>c(!1),children:"False"})})]})},filterTypeLabel:()=>"True/False",constructQuery:(e,t)=>{if((e=>"boolean"==typeof(null==e?void 0:e.value))(t))return{[e.join(".")]:{$eq:t.value}}}},_L=["schema"],kL=e=>{let{schema:t}=e,s=(0,Nt.A)(e,_L);const a=[yL,NL,hL,vL,wL,dL,CL],n=Y.useMemo(()=>{var e;return null===(e=a.find(e=>e.isValidSchema(t)))||void 0===e?void 0:e.FilterComponent},[t]);return n?(0,se.jsx)(n,(0,ue.A)({schema:t},s)):null},CL={isValidSchema:e=>"object"===(null==e?void 0:e.type)&&null!=(null==e?void 0:e.properties)&&Object.keys(null==e?void 0:e.properties).length>0,FilterComponent:e=>{var t;let{schema:s,value:a,onChange:n,className:l}=e;const r=s.properties,i=null!==(t=null==a?void 0:a.properties)&&void 0!==t?t:{};return(0,se.jsx)("div",{className:de("flex flex-col gap-2",l),children:Object.entries(r).map(e=>{var t;let[s,a]=e;return(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[s,(0,se.jsx)(kL,{schema:a,value:null===(t=i[s])||void 0===t?void 0:t.value,onChange:e=>{n({properties:(0,ue.A)((0,ue.A)({},i),{},{[s]:{schema:a,value:e}})})}})]},s)})})},filterTypeLabel:()=>"Object",constructQuery:(e,t)=>{var s;const a=[yL,NL,hL,vL,wL,dL,CL],n=Object.entries(null!==(s=null==t?void 0:t.properties)&&void 0!==s?s:{}).map(t=>{let[s,n]=t;const l=a.find(e=>e.isValidSchema(n.schema));return null==l?void 0:l.constructQuery([...e,s],n.value)});return(0,jk.I5)({$and:n}).query()}},AL=["schema"],SL=[yL,NL,hL,vL,wL,dL,CL],EL=e=>{let{schema:t}=e,s=(0,Nt.A)(e,AL);const a=Y.useMemo(()=>{var e;return null===(e=SL.find(e=>e.isValidSchema(t)))||void 0===e?void 0:e.FilterComponent},[t]);return a?(0,se.jsx)(a,(0,ue.A)({schema:t},s)):null},TL=e=>e.replace(/_/g," ").charAt(0).toUpperCase()+e.replace(/_/g," ").slice(1),IL=e=>{var t,s,a;let{filters:n,upsertFilter:l,filtersCount:r,resetFilters:i,clearFilter:o,onFilterSelected:c}=e;const d=Y.useMemo(()=>Object.fromEntries(Object.entries(n).filter(e=>{let[t,s]=e;return!dL.isValidSchema(s.schema)})),[n]),u=Y.useMemo(()=>Object.keys(d),[d]),m=Y.useRef(u[0]),[x,h]=Y.useState(m.current);return(0,se.jsxs)("div",{className:"flex flex-col h-full w-full sm:w-auto",children:[(0,se.jsx)("div",{className:"flex flex-row w-full border-b-[1px] border-slate-200 px-4 py-3",children:(0,se.jsx)("h1",{className:"font-base44 text-md font-semibold",children:"Filters"})}),(0,se.jsxs)("div",{className:"grid sm:grid-cols-[min-content_1fr] grid-cols-[50%_1fr]",children:[(0,se.jsx)("div",{className:"p-2 flex flex-col sm:w-full bg-slate-50 text-base44 min-h-[250px] max-h-[400px]  overflow-y-auto ",children:Object.entries(d).map(e=>{var t;let[s,{schema:a,query:n}]=e;return(0,se.jsxs)(Bx,{variant:"ghost",className:de("justify-between min-w-[150px] hover:bg-slate-200 rounded-[8px] px-2",{"font-bold":x===s}),onClick:()=>{null==c||c(s),h(s),l(s,{enabled:!0})},children:[null!==(t=a.title)&&void 0!==t?t:TL(s),(0,se.jsx)(bs.A,{className:de("w-2 h-2",{hidden:null==n})})]},s)})}),null!=x&&(0,se.jsxs)("div",{className:de("p-4 border-l-[1px] border-slate-200 flex flex-col gap-4 min-h-[250px] max-h-[400px] sm:min-w-[300px] bg-white text-base44 overflow-y-auto"),children:[(0,se.jsxs)("div",{className:"text-md flex flex-row justify-between items-center",children:[TL(x),(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",className:"text-blue-500 hover:text-blue-600 hover:bg-transparent cursor-pointer text-sm",onClick:()=>o(x),children:"Clear filter"})]}),(0,se.jsx)(EL,{schema:null===(t=d[x])||void 0===t?void 0:t.schema,value:null!==(s=null===(a=d[x])||void 0===a?void 0:a.value)&&void 0!==s?s:null,onChange:e=>l(x,{value:e,enabled:!0}),className:"truncate max-w-[300px]"},x)]})]}),(0,se.jsxs)("div",{className:de("flex flex-row justify-between w-full bg-white p-4 border-t-[1px] border-slate-200 items-center rounded-b-[8px]"),children:[(0,se.jsx)(aN,{className:"text-sm text-slate-600",children:r>0?"".concat(r," filters applied"):""}),(0,se.jsx)(Bx,{variant:"ghost",disabled:0===r,className:"text-blue-500 hover:text-blue-600 hover:bg-transparent cursor-pointer",size:"sm",onClick:i,children:"Clear"})]})]})},PL=["size","align","onFilterSelected"],LL=["size","onFilterSelected"],ML=e=>uo()?(0,se.jsx)(DL,(0,ue.A)({},e)):(0,se.jsx)(RL,(0,ue.A)({},e)),RL=e=>{let{size:t="sm",align:s="end",onFilterSelected:a}=e,n=(0,Nt.A)(e,PL);return 0===Object.keys(n.filters).length?null:(0,se.jsxs)(mS,{children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsxs)(Bx,{size:t,variant:"outline",className:"relative",children:[(0,se.jsx)(By.A,{className:"h-4 w-4 mr-2"}),"Filters",n.filtersCount>0&&(0,se.jsx)("div",{className:"absolute flex items-center justify-center top-[-5px] right-[-5px] bg-blue-200 rounded-full text-xs w-4 h-4",children:n.filtersCount})]})}),(0,se.jsx)(hS,{align:s,className:"flex p-0 w-full rounded-[8px]",children:(0,se.jsx)(IL,(0,ue.A)((0,ue.A)({},n),{},{onFilterSelected:a}))})]})},DL=e=>{let{size:t="sm",onFilterSelected:s}=e,a=(0,Nt.A)(e,LL);return(0,se.jsxs)(Sy,{children:[(0,se.jsx)(Ey,{asChild:!0,children:(0,se.jsxs)(Bx,{size:t,variant:"outline",className:"relative",children:[(0,se.jsx)(By.A,{className:"h-4 w-4"}),a.filtersCount>0&&(0,se.jsx)("div",{className:"absolute flex items-center justify-center top-[-5px] right-[-5px] bg-gray-300 rounded-full text-xs w-4 h-4",children:a.filtersCount})]})}),(0,se.jsx)(Ly,{side:"bottom",className:"flex w-full p-0",children:(0,se.jsx)(IL,(0,ue.A)((0,ue.A)({},a),{},{onFilterSelected:s}))})]})},FL=["items","upsertItem","deleteItem","reloadItem","reload"],OL=(e,t)=>{const{enabledByDefault:s=!1}=null!=t?t:{},a=Object.keys(e).sort().join(","),n=()=>Object.entries(e).reduce((e,t)=>{let[a,n]=t;return(0,ue.A)((0,ue.A)({},e),{},{[a]:{schema:n,enabled:s}})},{}),[l,r]=Y.useState(n);Y.useEffect(()=>{r(n())},[a]),Y.useEffect(()=>{Object.entries(e).forEach(e=>{let[t,s]=e;o(t,s)})},[e]);const i=(e,t)=>{var s;const{schema:a,query:n}=null!==(s=l[e])&&void 0!==s?s:{};if(!a)return;const i=null!=(null==t?void 0:t.value)?(e=>{let{propName:t,schema:s,value:a}=e;const n=SL.find(e=>e.isValidSchema(s));if(n)return n.constructQuery([t],a)})({propName:e,schema:a,value:t.value}):n;r(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:(0,ue.A)((0,ue.A)((0,ue.A)({},s[e]),t),{},{query:i})}))},o=(e,t)=>{r(s=>{var a;return(0,ue.A)((0,ue.A)({},s),{},{[e]:(0,ue.A)((0,ue.A)({},s[e]),{},{schema:(0,ue.A)((0,ue.A)({},null===(a=s[e])||void 0===a?void 0:a.schema),t)})})})},c=Y.useMemo(()=>Object.entries(l).filter(e=>{let[t,s]=e;return s.enabled&&s.query}).reduce((e,t)=>{let[s,{query:a}]=t;return(0,ue.A)((0,ue.A)({},e),{},{[s]:a})},{}),[l]),d=Y.useMemo(()=>Object.entries(l).filter(e=>{let[t,s]=e;return s.enabled&&s.value}).reduce((e,t)=>{let[s,{value:a}]=t;return(0,ue.A)((0,ue.A)({},e),{},{[s]:a})},{}),[l]),u=Y.useMemo(()=>Object.entries(l).filter(e=>{let[t,s]=e;return s.enabled&&s.query}).length,[l]);return{filters:l,upsertFilter:i,resetFilters:()=>{r(n())},toggleFilter:e=>{var t;const s=null===(t=l[e])||void 0===t?void 0:t.enabled;i(e,{enabled:!s})},filtersQueries:c,filtersValues:d,filtersCount:u,clearFilter:e=>{r(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:(0,ue.A)((0,ue.A)({},t[e]),{},{value:void 0,query:void 0})}))},isFilterActive:e=>{var t,s;return(null===(t=l[e])||void 0===t?void 0:t.enabled)&&(null===(s=l[e])||void 0===s?void 0:s.query)}}},UL={searchFields:[dL],nonSearchFields:{exclude:[dL]}},BL=(e,t)=>{const{filter:s}=null!=t?t:{},{getEntitiesSDK:a}=lp(),n=Y.useMemo(()=>a()[e].schema(),[a,e]),l="string"==typeof s?UL[s]:void 0,r=Array.isArray(l)?l:void 0,i=Array.isArray(l)||null==l?void 0:l.exclude;return Y.useMemo(()=>{const e=n.properties;return null!=r&&r.length||null!=i&&i.length?Object.fromEntries(Object.entries(e).filter(e=>{let[t,s]=e;return null!=r&&r.length?r.some(e=>e.isValidSchema(s)):null!=i&&i.length?!(null!=i&&i.some(e=>e.isValidSchema(s))):void 0})):e},[e,a,r,i])},zL=["children","className"],HL=["className","children","theme"],VL=["children","className","tooltip","tooltipOpen","onTooltipOpen","hidden","disabled"],WL=["children","className","tooltip","tooltipOpen","onTooltipOpen","hidden"],qL=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return e=>{var s;const a=t.map(e=>e.displayName);return"object"==typeof e&&a.includes(null===(s=e.type)||void 0===s?void 0:s.displayName)}},YL=e=>{let{children:t,className:s}=e,a=(0,Nt.A)(e,zL);return(0,se.jsx)(Rx.P.div,(0,ue.A)((0,ue.A)({className:s,initial:{opacity:0,x:-30},animate:{opacity:1,x:0},exit:{opacity:0,x:-30},transition:{duration:.3,ease:"easeInOut"}},a),{},{children:t}))},GL=e=>{let{className:t,children:s,theme:a="gray"}=e,n=(0,Nt.A)(e,HL);const[l,r,i,o,c]=(0,Y.useMemo)(()=>{const e=Y.Children.toArray(s);return[e.filter(qL(GL)),e.filter(qL($L)),e.filter(qL(ZL)),e.filter(qL(JL,XL)),e.filter(qL(tM))].map(e=>e.length>0?e:null)},[s]);return n.hidden?null:(0,se.jsxs)(Mx.N,{children:[null==l?void 0:l.map((e,t)=>(0,se.jsx)("div",{children:e},"nested-toolbar-".concat(t))),(0,se.jsx)(YL,{"data-theme":a,className:de("flex flex-row justify-between gap-2 py-2 w-full font-base44 group",{"bg-white border border-gray-200":"white"===a},t),children:(0,se.jsxs)(mp,{children:[r,o,i]})}),c]})};GL.displayName="Toolbar";const KL="flex flex-row gap-2 items-stretch",$L=e=>{let{children:t,className:s}=e;return(0,se.jsx)(YL,{className:de(KL,"justify-start overflow-hidden",s),children:t})};$L.displayName="Toolbar.Left";const ZL=e=>{let{children:t,className:s}=e;return(0,se.jsx)(YL,{className:de(KL,"justify-end",s),children:t})};ZL.displayName="Toolbar.Right";const JL=e=>{let{children:t,className:s}=e;return(0,se.jsx)(YL,{className:de(KL,"justify-between flex-1",s),children:t})};JL.displayName="Toolbar.Middle";const QL=e=>{let{className:t}=e;return(0,se.jsx)("div",{className:de("my-1 w-px bg-gray-300",t)})};QL.displayName="Toolbar.Separator";const XL=e=>{let{children:t,className:s,tooltip:a,tooltipOpen:n,onTooltipOpen:l,hidden:r,disabled:i}=e,o=(0,Nt.A)(e,VL);return(0,se.jsx)(Mx.N,{children:!r&&(0,se.jsx)(YL,(0,ue.A)((0,ue.A)({},o),{},{className:de("flex items-center align-middle",{"opacity-50 pointer-events-none":i},s),children:a?(0,se.jsxs)(xp,{delayDuration:800,onOpenChange:l,open:n,children:[(0,se.jsx)(hp,{className:de("flex items-center align-middle",s),children:t}),(0,se.jsx)(pp,{className:"bg-[#171717] border-none text-[#FAFAFA] rounded-lg pointer-events-none",children:a})]}):(0,se.jsx)(se.Fragment,{children:t})}))})};XL.displayName="Toolbar.Item";const eM=e=>{let{children:t,className:s,tooltip:a,tooltipOpen:n,onTooltipOpen:l,hidden:r}=e,i=(0,Nt.A)(e,WL);return(0,se.jsx)(XL,{tooltip:a,tooltipOpen:n,onTooltipOpen:l,hidden:r,children:(0,se.jsx)(Bx,(0,ue.A)((0,ue.A)({variant:"ghost",size:"tiny",className:"aspect-square h-full align-middle w-full"},i),{},{children:t}))})};eM.displayName="Toolbar.Button";const tM=e=>{let{children:t}=e;return(0,se.jsx)(se.Fragment,{children:t})};tM.displayName="Toolbar.Child",GL.Left=$L,GL.Right=ZL,GL.Middle=JL,GL.Separator=QL,GL.Item=XL,GL.Button=eM,GL.Child=tM;const sM=e=>{let{filters:t,clearFilter:s,isFilterActive:a,resetFilters:n,className:l}=e;const[r,i]=Y.useState([]),o=Y.useMemo(()=>Object.keys(t).filter(a),[t]);return Y.useEffect(()=>{const e=[...r.filter(e=>o.includes(e))];e.push(...o.filter(t=>!e.includes(t))),i(e)},[o]),(0,se.jsx)(GL,{hidden:0===r.length,className:de("p-0",l),children:(0,se.jsxs)(GL.Left,{className:"flex-wrap gap-2",children:[(0,se.jsx)(GL.Item,{className:"text-xs text-gray-500",children:"Filter By:"}),r.map((e,a)=>{var n,l;return(0,se.jsxs)(GL.Item,{className:"flex flex-row h-[24px] justify-between rounded-lg bg-blue-200 focus:outline-none text-sm p-2",children:[null!==(n=null===(l=t[e])||void 0===l?void 0:l.schema.title)&&void 0!==n?n:TL(e),(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",className:"p-0 h-[10px]",onClick:()=>s(e),children:(0,se.jsx)(la.A,{className:"w-2 h-2 p-[2px]"})})]},"".concat(e,"-").concat(a))}),(0,se.jsx)(GL.Item,{hidden:r.length<2,children:(0,se.jsx)(Bx,{variant:"outline",size:"xTiny",className:"w-auto text-sm",onClick:n,children:"Clear"})})]})})},aM=e=>{let{variant:t="compact",dataEnv:s,setDataEnv:a}=e;const{app:n,dataEnv:l,setDataEnv:r}=lp(),i=null!=s?s:l,o=null!=a?a:r;if(null==n||!n.dev_environment_enabled)return null;const c="compact"===t;return(0,se.jsx)(Kj,{value:i,onValueChange:e=>o(e),className:de(!c&&"w-full"),children:(0,se.jsxs)($j,{className:de("flex-shrink-0 justify-start bg-slate-200 p-[3px] rounded-lg",c?"h-[28px]":"mb-2 h-[36px] w-full md:w-[350px]"),children:[(0,se.jsx)(Zj,{value:"prod",className:de("h-full data-[state=active]:bg-white data-[state=active]:shadow-[0px_1px_3px_0px_rgba(0,0,0,0.1),0px_1px_2px_-1px_rgba(0,0,0,0.1)] data-[state=active]:border data-[state=active]:border-slate-200 data-[state=active]:!border-t-white data-[state=inactive]:bg-transparent data-[state=inactive]:shadow-none data-[state=inactive]:border-0 flex items-center",c?"px-2.5 text-xs":"flex-1"),style:{borderRadius:c?"6px":"8px"},children:"Production"}),(0,se.jsx)(Zj,{value:"dev",className:de("h-full data-[state=active]:bg-white data-[state=active]:shadow-[0px_1px_3px_0px_rgba(0,0,0,0.1),0px_1px_2px_-1px_rgba(0,0,0,0.1)] data-[state=active]:border data-[state=active]:border-slate-200 data-[state=active]:!border-t-white data-[state=inactive]:bg-transparent data-[state=inactive]:shadow-none data-[state=inactive]:border-0 flex items-center",c?"px-2.5 text-xs":"flex-1"),style:{borderRadius:c?"6px":"8px"},children:"Test"})]})})},nM=e=>{let{entity:t}=e;const{app:s,getEntitiesSDK:a,onAppError:n,dataEnv:l,setDataEnv:r}=lp(),i=(0,J.Zp)(),[o,c]=(0,Y.useState)({}),{entities:d,hasMore:u,isLoading:m,loadMore:x,reload:h,upsertEntity:p,deleteEntity:g,isFilterChanging:f}=((e,t)=>{const{app:s,getEntitiesSDK:a,dataEnv:n}=lp(),l=Y.useMemo(()=>a()[e],[a,e,n]),r="".concat(e,"-").concat(n),i=TC(r,l,t),{items:o,upsertItem:c,deleteItem:d,reloadItem:u,reload:m}=i,x=(0,Nt.A)(i,FL);return Y.useEffect(()=>{o.length&&m()},[null==s?void 0:s.id,n]),(0,ue.A)({entities:o,upsertEntity:c,deleteEntity:d,reloadEntity:u,reload:m},x)})(t.name,{query:o}),{toast:v}=ao(),b=(0,Y.useRef)(null),[j,y]=(0,Y.useState)(!1),N=async()=>{y(!0);try{const e=a(n);await e[t.name].deleteMany({}),await h(),v({title:"Success",description:"All records moved to trash successfully"}),dS.closeModal("ConfirmDialog")}catch(l){var e,s;v({title:"Error",description:(null===(e=l.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||l.message,variant:"destructive"})}finally{y(!1)}};return(0,se.jsxs)(lL,{title:t.name,subtitle:t.description,primaryAction:(0,se.jsxs)(Bx,{size:"sm",onClick:()=>dS.openModal("EditEntityDrawer",{entitySchema:t,onSubmit:e=>{p(e),dS.closeModal("EditEntityDrawer")}}),children:[(0,se.jsx)(op.A,{className:"h-4 w-4 mr-2"}),"Add"]}),actions:[(0,se.jsx)(Df,{type:"file",accept:".csv",className:"hidden",ref:b,onChange:async e=>{var s;const l=null===(s=e.target.files)||void 0===s?void 0:s[0];if(l){y(!0);try{const e=a(n),s=await e[t.name].importEntities(l);"success"===s.status&&(v({title:"Import Successful",description:"Successfully imported ".concat(s.n_entities_created," ").concat(t.name," records")}),await h())}catch(o){var r,i;v({title:"Import Failed",description:(null===(r=o.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.message)||o.message,variant:"destructive"})}finally{y(!1),e.target&&(e.target.value="")}}},disabled:j},"file-upload"),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{size:"sm",variant:"outline",children:(0,se.jsx)(Nv.A,{className:"h-4 w-4"})})}),(0,se.jsxs)(Aj,{align:"end",children:[(0,se.jsxs)(Sj,{onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},disabled:j,children:[j?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,se.jsx)(sL.A,{className:"h-4 w-4 mr-2"}),"Import"]}),(0,se.jsxs)(Sj,{onClick:async()=>{y(!0);try{const e=a(n),s=await e[t.name].list(),l=Object.keys(s[0]||{}),r=[l.join(","),...Object.values(s).map(e=>l.map(t=>{const s=e[t];let a;a="object"==typeof s&&null!==s?JSON.stringify(s):String(null!=s?s:"");const n=a.replace(/"/g,'""');return'"'.concat(n,'"')}).join(","))],i=r.join("\n"),o=new Blob([i],{type:"text/csv"}),c=window.URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download="".concat(t.name,"_export.csv"),document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c),v({title:"Export Successful",description:"Successfully exported entities to CSV"})}catch(l){var e,s;v({title:"Export Failed",description:(null===(e=l.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||l.message,variant:"destructive"})}finally{y(!1)}},disabled:j,children:[j?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,se.jsx)(aL.A,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,se.jsxs)(Sj,{onClick:()=>dS.openModal("EntitySchemaDrawer",{entity:t}),children:[(0,se.jsx)(rA.A,{className:"h-4 w-4 mr-2"}),"Schema"]}),(0,se.jsxs)(Sj,{onClick:()=>i("/apps/".concat(s.id,"/editor/workspace/trash-entity-").concat(t.name)),children:[(0,se.jsx)(zy.A,{className:"h-4 w-4 mr-2"}),"Recently Deleted"]}),(0,se.jsxs)(Sj,{onClick:()=>{dS.openModal("ConfirmDialog",{title:"Move All Records to Trash",description:"Are you sure you want to move all record(s) to trash? You can restore them later from the trash.",confirmText:"Move to Trash",variant:"destructive",onConfirm:N})},disabled:j||0===d.length,className:"text-red-500 hover:text-red-600 focus:text-red-600",children:[j?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,se.jsx)(nL.A,{className:"h-4 w-4 mr-2"}),"Delete All"]})]})]},"actions-menu")],children:[(0,se.jsx)(aM,{variant:"full",dataEnv:l,setDataEnv:r}),(0,se.jsx)("div",{className:de("flex flex-col min-h-0 h-[600px] pb-6"),children:(0,se.jsx)(cL,{onRowClick:e=>{dS.openModal("EditEntityDrawer",{editingItem:e,entitySchema:t,onSubmit:e=>{p(e),dS.closeModal("EditEntityDrawer")}})},onDelete:g,loadMore:x,entities:d,hasMore:u,isLoading:m,isFilterChanging:f,entity:t,actions:(0,se.jsx)(rM,{entityName:t.name,onQueryChange:c}),isDevMode:"dev"===l})})]})},lM=e=>{const[t]=Y.useState(()=>new Q.E);return(0,se.jsx)(X.Ht,{client:t,children:(0,se.jsx)(nM,(0,ue.A)({},e))})},rM=e=>{let{entityName:t,onQueryChange:s}=e;const a=BL(t,{filter:"nonSearchFields"}),n=OL(a),l=BL(t,{filter:"searchFields"}),r=OL(l);return Y.useEffect(()=>{const e=(0,jk.I5)({$and:Object.values(n.filtersQueries),$or:Object.values(r.filtersQueries)});s(e.query())},[n.filtersQueries,r.filtersQueries]),(0,se.jsxs)("div",{className:"flex flex-col w-full gap-2 justify-between ",children:[(0,se.jsxs)("div",{className:"flex flex-row w-full justify-between ",children:[(0,se.jsx)(mL,(0,ue.A)({},r)),(0,se.jsx)(ML,(0,ue.A)({},n))]}),(0,se.jsx)(sM,(0,ue.A)({},n))]})};var iM=s(90770),oM=s(52298);const cM=50;class dM extends te.H{getBaseURL(){return"/apps"}requestAccess(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.axios.post("/".concat(e,"/access-requests"),{email:t,full_name:s||void 0})}listAccessRequests(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={};return t&&"all"!==t&&(a.role=t),s&&(a.q=JSON.stringify(s)),this.axios.get("/".concat(e,"/access-requests/all"),{params:a})}reviewAccessRequest(e,t,s){return this.axios.post("/".concat(e,"/access-requests/").concat(t,"/").concat(s))}}const uM=new dM,mM=hu({isDrawerOpen:!1,isSchemaDrawerOpen:!1,editingItem:null,searchQuery:"",roleFilter:"all"}).use(pu({openDrawer:(e,t)=>{let{store:s}=e;s.setState(e=>{e.editingItem=null!=t?t:null}),s.isDrawerOpen=!0},closeDrawer:e=>{let{store:t}=e;t.isDrawerOpen=!1,t.setState(e=>{e.editingItem=null})},openSchemaDrawer:e=>{let{store:t}=e;t.isSchemaDrawerOpen=!0},closeSchemaDrawer:e=>{let{store:t}=e;t.isSchemaDrawerOpen=!1},setSearchQuery:(e,t)=>{let{store:s}=e;s.searchQuery=t},setRoleFilter:(e,t)=>{let{store:s}=e;s.roleFilter=t}})),xM=()=>{const{user:e}=wd(),{getEntitiesSDK:t,onAppError:s,app:a}=lp(),{toast:n}=ao(),l=mM.useSearchQuery(),r=mM.useRoleFilter(),i=(e,t)=>{const s=new Map;return e.forEach(e=>{s.set(e.email.toLowerCase(),e)}),t.forEach(e=>{s.set(e.email,e)}),Array.from(s.values())},{data:o,fetchNextPage:c,hasNextPage:d,isFetching:u,refetch:m,error:x}=(0,oM.q)({queryKey:["users",l,r],queryFn:async n=>{let{pageParam:l=1}=n;const r=t(s),{searchQuery:o,roleFilter:c}=mM.getState(),d=Tv(o),u=o&&""!==o.trim(),m=(e=>e&&"all"!==e?{role:e}:{})(c),h=yh(null==e?void 0:e.email);try{const e=1===l?await(async e=>{if(null==a||!a.id)return[];try{return(await uM.listAccessRequests(a.id,e)).map(e=>({id:"".concat(e.status,"-").concat(e.id),email:e.email,full_name:e.full_name||e.email.split("@")[0],role:e.role||"user",status:e.status,created_date:e.requested_at,access_request:e,is_verified:!1}))}catch(x){return[]}})(c):[];if(u){const t=l*cM+cM,s=(0,ue.A)((0,ue.A)({},m),{},{email:{$regex:d,$options:"i"}}),a=(0,ue.A)((0,ue.A)({},m),{},{full_name:{$regex:d,$options:"i"}}),[n,c]=await Promise.all([r.User.filter(s,null,t,0),r.User.filter(a,null,t,0)]),u=((e,t,s)=>{const a=[...e,...t],n=Array.from(new Map(a.map(e=>[e.id,e])).values()).sort((e,t)=>{const s=new Date(e.created_date||0).getTime();return new Date(t.created_date||0).getTime()-s});return s?n:Nh(n)})(n,c,h),x=((e,t)=>{const s=t.toLowerCase();return e.filter(e=>e.email.toLowerCase().includes(s)||e.full_name&&e.full_name.toLowerCase().includes(s))})(e,o).filter(e=>"completed"!==e.status),p=i(x,u),g=(l-1)*cM,f=g+cM,v=p.slice(g,f),b=p.length>f;return{users:v,hasMore:b,nextPage:b?l+1:void 0}}{const t=(l-1)*cM,s=await r.User.filter(m,null,51,t),a=h?s:Nh(s),n=a.length>cM,o=a.slice(0,cM),c=e.filter(e=>"completed"!==e.status);return{users:i(c,o),hasMore:n,nextPage:n?l+1:void 0}}}catch(x){throw x}},initialPageParam:1,getNextPageParam:e=>e.nextPage,refetchOnWindowFocus:!1});(0,Y.useEffect)(()=>{x&&n({title:"Error",description:"Failed to load users",variant:"destructive"})},[x,n]);const h=(null==o?void 0:o.pages.flatMap(e=>e.users))||[];return{store:mM,loadUsers:()=>m(),loadMore:c,users:h,hasMore:!!d,isFetching:u}};var hM=s(92626),pM=s(58085),gM=s(69204);const fM=[{value:"admin",label:"Admin"},{value:"user",label:"User"}],vM=e=>{let{icon:t,label:s,onClick:a,variant:n="default",showChevron:l=!1}=e;return(0,se.jsxs)(Bx,{variant:"ghost",className:"flex items-center w-full justify-start h-auto py-3 px-0 hover:bg-transparent ".concat("destructive"===n?"hover:text-red-500":""),onClick:a,children:[(0,se.jsx)(t,{className:"h-5 w-5 mr-3 ".concat("destructive"===n?"text-red-500":"text-slate-400")}),(0,se.jsx)(__,{size:"medium",className:"flex-1 text-left ".concat("destructive"===n?"text-red-500":"text-slate-700"),children:s}),l&&(0,se.jsx)(bs.A,{className:"h-5 w-5 text-slate-400"})]})},bM=e=>{let{row:t,isUnverified:s,removeActionLabel:a,onEdit:n,onDelete:l,onResendInvitation:r,onRoleChange:i,ownerEmail:o,isOpen:c,onOpenChange:d,hideTrigger:u=!1,loadUsers:m,ownershipTransfer:x}=e;const[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)("main"),[v,b]=(0,Y.useState)(t.role||"user"),j=void 0!==c?c:h,y=d||p,N=()=>{y(!1)},{currentUserIsOwner:w=!1,pendingTransferEmail:_=null,hasPendingTransfer:k=()=>!1,handleChangeOwner:C=()=>{},handleMakeOwner:A=()=>{},handleResendTransfer:S=async()=>{},handleCancelTransfer:E=async()=>{}}=null!=x?x:{},T=()=>{C(),N()},I=()=>{A(t),N()},P=async()=>{await S(),N()},L=async()=>{await E(),N()},M=t.full_name||t.email||"User",R=xy(t.email,o),D=hy(t.role),F=k(t.email),O=!!_;(0,Y.useEffect)(()=>{j&&(b(t.role||"user"),f("main"))},[j,t.role]);const U=w&&R&&!O,B=w&&!R&&D&&!O&&!s,z=w&&F,H=w&&F,V=!R,W=()=>{v!==t.role&&i?i(t,v):n&&n((0,ue.A)((0,ue.A)({},t),{},{role:v})),y(!1)};return(0,se.jsxs)(se.Fragment,{children:[!u&&(0,se.jsx)(Bx,{size:"icon",variant:"outline",className:"h-8 w-8 rounded-md border border-[#E5E5E5] bg-white shadow-xs px-4 py-2",onClick:e=>{e.stopPropagation(),y(!0)},children:(0,se.jsx)(Nv.A,{className:"h-4 w-4"})}),(0,se.jsx)(Sy,{open:j,onOpenChange:y,children:(0,se.jsx)(Ly,{side:"bottom",className:"rounded-t-2xl px-4 pb-8 pt-4 min-h-[250px]",onClick:e=>e.stopPropagation(),children:s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(My,{className:"pb-4",children:(0,se.jsx)(Ry,{className:"text-lg font-semibold",children:"Manage invitation"})}),(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[r&&(0,se.jsxs)(Bx,{variant:"outline",className:"w-full justify-start gap-3 h-12 text-slate-700",onClick:e=>{r(t,e),y(!1)},children:[(0,se.jsx)(Hc.A,{className:"h-4 w-4 text-slate-500"}),"Resend invitation"]}),(0,se.jsxs)(Bx,{variant:"outline",className:"w-full justify-start gap-3 h-12 text-slate-700",onClick:e=>{l(t,e),y(!1)},children:[(0,se.jsx)(la.A,{className:"h-4 w-4 text-slate-500"}),"Cancel invite"]})]})]}):"main"===g?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(My,{className:"text-left pb-2",children:[(0,se.jsx)(Ry,{className:"text-lg font-semibold",children:M}),t.email&&t.full_name&&(0,se.jsx)(__,{size:"small",secondary:!0,className:"text-left",children:t.email})]}),(0,se.jsxs)("div",{className:"flex flex-col pt-4 border-t border-slate-100 mt-2",children:[V&&(0,se.jsx)(vM,{icon:hM.A,label:"Change role",onClick:()=>f("change-role"),showChevron:!0}),U&&(0,se.jsx)(vM,{icon:hM.A,label:"Change owner",onClick:T}),B&&(0,se.jsx)(vM,{icon:hM.A,label:"Make app owner",onClick:I}),z&&(0,se.jsx)(vM,{icon:pM.A,label:"Resend ownership request",onClick:P}),H&&(0,se.jsx)(vM,{icon:la.A,label:"Cancel ownership request",onClick:L}),!R&&(0,se.jsx)(vM,{icon:la.A,label:a,onClick:()=>{l(t,{stopPropagation:()=>{}}),N()},variant:"destructive"})]})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(My,{className:"text-left",children:(0,se.jsx)(Ry,{className:"text-lg font-semibold text-left",children:"Change role"})}),(0,se.jsxs)(Dy,{className:"text-left mt-6 mb-4 text-slate-900",children:["Select a new role for ",M,":"]}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("div",{className:"flex flex-col gap-2 mb-8",children:(0,se.jsxs)(Wf,{value:v,onValueChange:b,children:[(0,se.jsx)(Yf,{className:"w-full h-10",children:(0,se.jsx)(qf,{children:null===(q=fM.find(e=>e.value===v))||void 0===q?void 0:q.label})}),(0,se.jsx)($f,{position:"popper",side:"bottom",avoidCollisions:!1,sideOffset:4,className:"z-[100]",children:fM.map(e=>(0,se.jsx)(Zf,{value:e.value,children:e.label},e.value))})]})}),(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsx)(Bx,{variant:"outline",className:"flex-1",onClick:()=>f("main"),children:"Back"}),(0,se.jsx)(Bx,{className:"flex-1 bg-slate-900 hover:bg-slate-800 text-white",onClick:W,children:"Save"})]})]})]})})})]});var q},jM=e=>qu()?(0,se.jsx)(bM,(0,ue.A)({},e)):(0,se.jsx)(yM,(0,ue.A)({},e)),yM=e=>{let{row:t,isUnverified:s,removeActionLabel:a,onEdit:n,onDelete:l,onResendInvitation:r,ownerEmail:i,loadUsers:o,ownershipTransfer:c}=e;const[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1),h=(0,Y.useRef)(),{currentUserIsOwner:p=!1,pendingTransferEmail:g=null,hasPendingTransfer:f=()=>!1,handleChangeOwner:v=()=>{},handleMakeOwner:b=()=>{},handleResendTransfer:j=async()=>{},handleCancelTransfer:y=async()=>{}}=null!=c?c:{},N=xy(t.email,i),w=hy(t.role),_=f(t.email),k=!!g,C=p&&N&&!k,A=p&&!N&&w&&!k&&!s,S=p&&_,E=p&&_,T=C||A||S||E,I=!d&&!m&&void 0;return(0,se.jsx)("div",{"data-dropdown-open":d?"true":void 0,children:(0,se.jsxs)(Nj,{open:d,onOpenChange:e=>{u(e),e||(x(!0),clearTimeout(h.current),h.current=setTimeout(()=>x(!1),200))},children:[(0,se.jsx)(mp,{delayDuration:300,children:(0,se.jsxs)(xp,{open:I,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{size:"icon",variant:"outline",className:"h-8 w-8 rounded-md border border-[#E5E5E5] bg-white shadow-xs px-4 py-2",onClick:e=>e.stopPropagation(),children:(0,se.jsx)(Nv.A,{className:"h-4 w-4"})})})}),(0,se.jsx)(pp,{side:"top",sideOffset:8,className:"z-[9999] max-w-[384px] rounded-md bg-[#171717] px-3 py-1.5 text-white text-sm !border-none",children:"More actions"})]})}),(0,se.jsx)(Aj,{align:"end",className:"w-auto min-w-[200px] rounded-lg border border-slate-200 bg-white p-1 shadow-lg",children:s?(0,se.jsxs)(se.Fragment,{children:[r&&(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-slate-700 hover:bg-slate-100",onClick:e=>r(t,e),children:[(0,se.jsx)(Hc.A,{className:"h-4 w-4 text-[#737373]"}),"Resend invitation"]}),(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-slate-700 hover:bg-slate-100",onClick:e=>l(t,e),children:[(0,se.jsx)(la.A,{className:"h-4 w-4 text-[#737373]"}),"Cancel invite"]})]}):(0,se.jsxs)(se.Fragment,{children:[n&&(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-slate-700 hover:bg-slate-100",onClick:e=>{e.stopPropagation(),n(t)},children:[(0,se.jsx)(Zw.A,{className:"h-3.5 w-3.5 text-[#737373]"}),"Edit user"]}),C&&(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-slate-700 hover:bg-slate-100",onClick:e=>(e=>{e.stopPropagation(),v(),u(!1)})(e),children:[(0,se.jsx)(hM.A,{className:"h-4 w-4 text-[#737373]"}),"Change owner"]}),A&&(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-slate-700 hover:bg-slate-100",onClick:e=>(e=>{e.stopPropagation(),b(t),u(!1)})(e),children:[(0,se.jsx)(hM.A,{className:"h-4 w-4 text-[#737373]"}),"Make app owner"]}),S&&(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-slate-700 hover:bg-slate-100",onClick:e=>(async e=>{e.stopPropagation(),await j(),u(!1)})(e),children:[(0,se.jsx)(pM.A,{className:"h-4 w-4 text-[#737373]"}),"Resend ownership request"]}),E&&(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-slate-700 hover:bg-slate-100",onClick:e=>(async e=>{e.stopPropagation(),await y(),u(!1)})(e),children:[(0,se.jsx)(la.A,{className:"h-4 w-4 text-[#737373]"}),"Cancel ownership request"]}),(n||T)&&!N&&(0,se.jsx)(Tj,{className:"my-1 bg-slate-200"}),!N&&(0,se.jsxs)(Sj,{className:"flex items-center gap-2 rounded-md px-3 py-2 text-sm font-normal text-red-500 hover:bg-slate-100 hover:!text-red-500 focus:!text-red-500",onClick:e=>l(t,e),children:[(0,se.jsx)(gM.A,{className:"h-3.5 w-3.5 text-red-500"}),a]})]})})]})})},NM=["email","full_name","role"],wM=e=>{var t;if(null==e)return(0,se.jsx)(__,{size:"small",ellipsis:!0});const s="object"==typeof e?null!==(t=JSON.stringify(e))&&void 0!==t?t:"":String(e),a=rL(s);return(0,se.jsx)(__,{size:"small",ellipsis:!0,children:a})},_M=["admin","user"],kM=e=>{let{selectedRole:t,onRoleChange:s}=e;const a=qu(),n="all"===t?"all roles":t,l="all"!==t;return(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:a?(0,se.jsx)(Bx,{variant:"outline",size:"icon",className:de("h-9 w-9 shrink-0",l&&"border-slate-900 bg-slate-50"),children:(0,se.jsx)(By.A,{className:"h-4 w-4"})}):(0,se.jsxs)(Bx,{variant:"outline",size:"sm",className:de("h-9 gap-2 px-4 py-2","font-medium text-sm leading-5"),children:[n,(0,se.jsx)(_t.A,{className:"h-4 w-4"})]})}),(0,se.jsxs)(Aj,{align:"end",children:[(0,se.jsx)(Sj,{onClick:()=>s("all"),children:"all roles"}),_M.map(e=>(0,se.jsx)(Sj,{onClick:()=>s(e),children:e},e))]})]})},CM=e=>{let{searchQuery:t,roleFilter:s,onInviteClick:a}=e;return t||"all"!==s?null:(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:a,children:[(0,se.jsx)(op.A,{className:"h-4 w-4 mr-2"}),"Invite your first user"]})},AM=e=>{let{isOpen:t,onClose:s,editingUser:a,userEntitySchema:n,onSubmit:l}=e;const r=qu();return(0,se.jsx)(Sy,{open:t,onOpenChange:s,children:(0,se.jsxs)(Ly,{side:r?"bottom":"right",className:r?"rounded-t-2xl max-h-[85vh] overflow-y-auto":"w-[400px] overflow-y-auto",children:[(0,se.jsx)(My,{children:(0,se.jsx)(Ry,{children:"Edit User"})}),(0,se.jsx)("div",{className:"py-4",children:(0,se.jsx)(sk,{schema:n,onSubmit:l,onChange:()=>{},initialValues:a,uiSchema:{email:{"ui:widget":"hidden"},full_name:{"ui:widget":"hidden"}}})})]})})},SM=e=>{let{row:t,isOpen:s,onOpenChange:a,onApprove:n,onDeny:l}=e;if(!t)return null;return(0,se.jsx)(Sy,{open:s,onOpenChange:a,children:(0,se.jsxs)(Ly,{side:"bottom",className:"rounded-t-2xl px-4 pb-8 pt-6",onClick:e=>e.stopPropagation(),children:[(0,se.jsxs)("div",{className:"flex flex-col gap-1 mb-6",children:[(0,se.jsx)(__,{size:"medium",weight:"bold",className:"text-slate-900",children:t.full_name||"Unknown"}),(0,se.jsx)(__,{size:"small",className:"text-slate-500",ellipsis:!0,children:t.email||""})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsx)(Bx,{className:"w-full h-11 bg-slate-900 hover:bg-slate-800 text-white font-medium",onClick:e=>{n(t,e),a(!1)},children:"Approve"}),(0,se.jsx)(Bx,{variant:"outline",className:"w-full h-11 border-slate-300 text-slate-900 hover:bg-slate-50 font-medium",onClick:e=>{l(t,e),a(!1)},children:"Reject"})]})]})})},EM=e=>{let{store:t,loadUsers:s,onLoadMore:a,users:n,hasMore:l,isLoading:r}=e;const{app:i,getEntitiesSDK:o}=lp(),{toast:c}=ao(),d=null==i?void 0:i.owner_email,[u,m]=(0,Y.useState)("all"),x=qu(),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(null),[j,y]=(0,Y.useState)(!1),N=t.useIsDrawerOpen(),w=t.useEditingItem(),_=t.useSearchQuery(),k=t.useRoleFilter(),C=(0,Y.useRef)(0),{filteredUsers:A,pendingCount:S}=(0,Y.useMemo)(()=>{const e=n.filter(e=>wh(e)),t=n.filter(e=>!wh(e)),s=t.find(e=>xy(e.email,d)),a=t.filter(e=>!xy(e.email,d)),l=a.filter(e=>!1===e.is_verified),r=a.filter(e=>!1!==e.is_verified),i=s?[s,...l,...r]:[...l,...r];return"all"===k&&(C.current=t.length),{filteredUsers:"pending"===u?e:i,pendingCount:e.length,allCount:C.current}},[n,u,d,k]),E=(0,Y.useCallback)(e=>t.setSearchQuery(e),[t]),T=(0,Y.useCallback)(e=>t.setRoleFilter(e),[t]),{handleDeleteItem:I,handleUpdateItem:P,handleApproveAccessRequest:L,handleDenyAccessRequest:M,handleResendInvitation:R}=(e=>{let{loadUsers:t,onEditClose:s,editingItem:a}=e;const n=(0,J.Zp)(),{user:l}=wd(),{getEntitiesSDK:r,app:i}=lp(),{toast:o}=ao();return{handleDeleteItem:(0,Y.useCallback)(async(e,s)=>{if(s.stopPropagation(),e.access_request){try{await uM.reviewAccessRequest(i.id,e.access_request.id,"deny"),await t(),o({description:"User removed successfully"})}catch(g){var a,n,l,c,d;const e=null===(a=g.response)||void 0===a?void 0:a.status,s=(null===(n=g.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.message)||(null===(c=g.response)||void 0===c||null===(d=c.data)||void 0===d?void 0:d.detail)||g.message||"";404===e||s.toLowerCase().includes("not found")?(await t(),o({title:"Failed to cancel invitation",description:"This user has logged in since your last refresh. Refresh the page to view their updated status before trying again.",variant:"destructive",duration:6e3})):o({title:"Error",description:s||"Failed to remove user",variant:"destructive"})}return}const u=r(()=>{});try{await u.User.delete(e.id),await t(),o({description:"User removed successfully"})}catch(g){var m,x,h,p;o({title:"Error",description:(null===(m=g.response)||void 0===m||null===(x=m.data)||void 0===x?void 0:x.detail)||(null===(h=g.response)||void 0===h||null===(p=h.data)||void 0===p?void 0:p.message)||g.message,variant:"destructive"})}},[t,o,i.id]),handleUpdateItem:(0,Y.useCallback)(async e=>{if(!a)return;const i=r(()=>{});try{if("admin"===e.role&&"admin"!==a.role&&"free"===l.subscription_tier)return void o({title:"Subscription Required",description:(0,se.jsxs)("div",{children:["Only paying users can make other users admins.",(0,se.jsx)(Bx,{variant:"link",className:"p-0 h-auto font-semibold underline",onClick:()=>n("/billing"),children:"Upgrade your subscription"}),"to continue."]}),variant:"destructive"});await i.User.update(a.id,e),await t(),s(),o({title:"Success",description:"User updated successfully"})}catch(x){var c,d,u,m;o({title:"Error",description:(null===(c=x.response)||void 0===c||null===(d=c.data)||void 0===d?void 0:d.detail)||(null===(u=x.response)||void 0===u||null===(m=u.data)||void 0===m?void 0:m.message)||x.message,variant:"destructive"})}},[a,t,s,o,l,n]),handleApproveAccessRequest:(0,Y.useCallback)(async(e,s)=>{if(s.stopPropagation(),e.access_request&&"pending"===e.access_request.status)try{await uM.reviewAccessRequest(i.id,e.access_request.id,"approve"),await t(),o({description:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-5 w-5 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:"#25A55A"},children:(0,se.jsx)(Ds.A,{className:"h-3 w-3 text-white",strokeWidth:3})}),(0,se.jsx)("span",{children:"User approved successfully"})]}),duration:3e3})}catch(l){var a,n;o({title:"Error",description:(null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||l.message||"Failed to approve access request",variant:"destructive"})}},[i.id,t,o]),handleDenyAccessRequest:(0,Y.useCallback)(async(e,s)=>{if(s.stopPropagation(),e.access_request&&"pending"===e.access_request.status)try{await uM.reviewAccessRequest(i.id,e.access_request.id,"deny"),await t(),o({description:"Invitation rejected",duration:3e3})}catch(l){var a,n;o({title:"Error",description:(null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||l.message||"Failed to deny access request",variant:"destructive"})}},[i.id,t,o]),handleResendInvitation:(0,Y.useCallback)(async(e,t)=>{t.stopPropagation();try{await zc.inviteUser(i.id,e.email,e.role||"user"),o({description:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-5 w-5 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:"#25A55A"},children:(0,se.jsx)(Hc.A,{className:"h-3 w-3 text-white",strokeWidth:2.5})}),(0,se.jsx)("span",{children:"Invitation resent successfully"})]}),duration:3e3})}catch(r){var s,a,n,l;o({title:"Error",description:(null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail)||(null===(n=r.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.message)||r.message||"Failed to resend invitation",variant:"destructive"})}},[i.id,o])}})({loadUsers:s,onEditClose:()=>t.closeDrawer(),editingItem:w}),D=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{loadUsers:t,onActionComplete:s,targetUser:a}=e,{app:n}=lp(),{user:l}=wd(),{toast:r}=ao(),[i,o]=(0,Y.useState)(null),c=!(null==n||!n.owner_id||null==l||!l.id||n.owner_id!==l.id);(0,Y.useEffect)(()=>{(async()=>{if(null!=n&&n.id)try{var e;const t=await F_.getPendingTransfer(n.id);o((null===(e=t.transfer)||void 0===e?void 0:e.new_owner_email)||null)}catch(t){o(null)}})()},[null==n?void 0:n.id]);const d=(0,Y.useCallback)(e=>(null==i?void 0:i.toLowerCase())===(null==e?void 0:e.toLowerCase()),[i]),u=(0,Y.useCallback)(()=>{null==s||s(),dS.openModal("TransferOwnershipModal",{onTransferSuccess:async()=>{if(null!=n&&n.id){var e;const t=await F_.getPendingTransfer(n.id);o((null===(e=t.transfer)||void 0===e?void 0:e.new_owner_email)||null)}null==t||t()}})},[null==n?void 0:n.id,t,s]),m=(0,Y.useCallback)(e=>{const l=e||a;l&&(null==s||s(),dS.openModal("TransferOwnershipModal",{preSelectedEmail:l.email,onTransferSuccess:async()=>{if(null!=n&&n.id){var e;const t=await F_.getPendingTransfer(n.id);o((null===(e=t.transfer)||void 0===e?void 0:e.new_owner_email)||null)}null==t||t()}}))},[null==n?void 0:n.id,t,s,a]),x=(0,Y.useCallback)(async()=>{if(null!=n&&n.id)try{await F_.resendTransfer(n.id),null==t||t(),null==s||s(),r({title:"Email sent",description:"Ownership transfer invitation has been resent."})}catch(l){var e,a;r({title:"Error",description:(null===(e=l.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||l.message||"Failed to resend invitation",variant:"destructive"})}},[null==n?void 0:n.id,r,t,s]),h=(0,Y.useCallback)(async()=>{if(null!=n&&n.id)try{await F_.cancelTransfer(n.id),o(null),null==t||t(),null==s||s(),r({title:"Transfer cancelled",description:"The ownership transfer has been cancelled."})}catch(l){var e,a;r({title:"Error",description:(null===(e=l.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||l.message||"Failed to cancel transfer",variant:"destructive"})}},[null==n?void 0:n.id,r,t,s]);return{currentUserIsOwner:c,pendingTransferEmail:i,hasPendingTransfer:d,handleChangeOwner:u,handleMakeOwner:m,handleResendTransfer:x,handleCancelTransfer:h}}({loadUsers:s}),F=(e=>{let{userEntityProperties:t,onDelete:s,onApprove:a,onDeny:n,onEdit:l,onResendInvitation:r,ownerEmail:i,alwaysShowActions:o=!1,isMobile:c=!1,loadUsers:d,ownershipTransfer:u}=e;return Y.useMemo(()=>{var e;const m=null!==(e=null==u?void 0:u.hasPendingTransfer)&&void 0!==e?e:()=>!1,x=[{id:"full_name",title:"Name",render:e=>{const t=xy(e.email,i),s=m(e.email);return(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[wM(e.full_name),t&&(0,se.jsx)(__,{size:"small",weight:"normal",secondary:!0,children:"Owner"}),s&&(0,se.jsx)(__,{size:"small",weight:"normal",light:!0,className:"inline-flex items-center h-5 px-1.5 rounded-md bg-[#FFB700] text-white",children:"Pending ownership"})]})},width:200,sticky:!c},{id:"user_info_mobile",title:"User",render:e=>(0,se.jsxs)("div",{className:"flex flex-col gap-0.5 min-w-0 max-w-full overflow-hidden",children:[(0,se.jsx)(__,{size:"small",ellipsis:!0,className:"font-medium",children:e.full_name||"Unknown"}),(0,se.jsx)(__,{size:"small",ellipsis:!0,className:"text-slate-500",children:e.email||""})]}),width:150,sticky:!1},{id:"role",title:"Role",render:e=>{var t;const s=!1===e.is_verified;return(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[wM(e.role),s&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-3.5 w-3.5 text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity"})}),(0,se.jsx)(pp,{side:"top",className:"max-w-[384px] rounded-md bg-[#171717] px-3 py-1.5 text-white",children:(0,se.jsxs)("p",{children:["admin"===(null===(t=e.role)||void 0===t?void 0:t.toLowerCase())?"Admin":"User"," hasn't logged in to",(0,se.jsx)("br",{}),"the app yet."]})})]})})]})},width:150},{id:"email",title:"Email",render:e=>wM(e.email),width:200}],h=Object.keys(t).filter(e=>!NM.includes(e)).map(e=>({id:e,title:t[e].title||e,render:t=>wM(t[e]),width:200}));return x.push(...h),x.push({id:"actions",title:"",align:"end",stickyActionCell:!c,width:c?80:56,render:e=>{const t=e.access_request&&"pending"===e.access_request.status,m=!1===e.is_verified,x=m?"Cancel invite":"Remove user";return(0,se.jsx)(kC,{alwaysVisible:o,primaryAction:(0,se.jsxs)(se.Fragment,{children:[t&&n&&(c?(0,se.jsx)(Bx,{size:"icon",variant:"outline",onClick:t=>{t.stopPropagation(),n(e,t)},className:"h-8 w-8 rounded-lg border-slate-300 text-slate-600 hover:text-slate-900 hover:bg-slate-50",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})}):(0,se.jsx)(Bx,{size:"tiny",variant:"outline",onClick:t=>n(e,t),className:"text-slate-900 hover:text-slate-900 hover:bg-slate-50",children:"Reject"})),t&&a&&(c?(0,se.jsx)(Bx,{size:"icon",variant:"default",onClick:t=>{t.stopPropagation(),a(e,t)},className:"h-8 w-8 rounded-lg bg-slate-900 hover:bg-slate-800 text-white",children:(0,se.jsx)(Ds.A,{className:"h-4 w-4"})}):(0,se.jsx)(Bx,{size:"tiny",variant:"default",onClick:t=>a(e,t),className:"bg-slate-900 hover:bg-slate-800 text-white",children:"Approve"})),!t&&(0,se.jsx)(jM,{row:e,isUnverified:m,removeActionLabel:x,onEdit:l,onDelete:s,onResendInvitation:r,ownerEmail:i,loadUsers:d,ownershipTransfer:u})]})})}}),x},[t,i,s,a,n,l,r,o,c,d,u])})({userEntityProperties:i.user_entity.properties,onDelete:I,onApprove:L,onDeny:M,onEdit:e=>t.openDrawer(e),onResendInvitation:R,ownerEmail:d,alwaysShowActions:"pending"===u,isMobile:x,loadUsers:s,ownershipTransfer:D}),O=(0,Y.useMemo)(()=>{if("pending"===u){return(x?["user_info_mobile","actions"]:["full_name","email","actions"]).map(e=>F.find(t=>t.id===e)).filter(e=>void 0!==e)}return x?F.filter(e=>"user_info_mobile"!==e.id&&"actions"!==e.id):F.filter(e=>"user_info_mobile"!==e.id)},[F,u,x]),U=_||"all"!==k?"Try adjusting your search or filters to find what you're looking for.":"Get started by inviting your first user to the app.";return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Kj,{value:u,onValueChange:e=>m(e),className:"w-full h-full flex flex-col min-h-0 overflow-hidden",children:[(0,se.jsxs)($j,{className:"mb-4 flex-shrink-0 justify-start h-[36px] bg-slate-200 p-[3px] rounded-lg w-full md:w-[350px]",children:[(0,se.jsx)(Zj,{value:"all",className:"flex-1 h-full data-[state=active]:bg-white data-[state=active]:shadow-[0px_1px_3px_0px_rgba(0,0,0,0.1),0px_1px_2px_-1px_rgba(0,0,0,0.1)] data-[state=active]:border data-[state=active]:border-slate-200 data-[state=active]:!border-t-white data-[state=inactive]:bg-transparent data-[state=inactive]:shadow-none data-[state=inactive]:border-0 flex items-center gap-2",style:{borderRadius:"8px"},children:"Users"}),(0,se.jsxs)(Zj,{value:"pending",className:"flex-1 h-full data-[state=active]:bg-white data-[state=active]:shadow-[0px_1px_3px_0px_rgba(0,0,0,0.1),0px_1px_2px_-1px_rgba(0,0,0,0.1)] data-[state=active]:border data-[state=active]:border-slate-200 data-[state=active]:!border-t-white data-[state=inactive]:bg-transparent data-[state=inactive]:shadow-none data-[state=inactive]:border-0 flex items-center gap-2",style:{borderRadius:"8px"},children:[(0,se.jsx)("span",{children:"Pending requests"}),S>0&&(0,se.jsx)("div",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full bg-yellow-500 text-white text-xs font-semibold",style:{backgroundColor:"#FFB700"},children:S})]})]}),"all"===u&&(0,se.jsx)("div",{className:"sticky top-0 z-30 flex-shrink-0",children:x?(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-4 bg-transparent",children:[(0,se.jsx)(uL,{value:_,onChange:E,placeholder:"Search by Email or Name"}),(0,se.jsx)(kM,{selectedRole:k,onRoleChange:T})]}):(0,se.jsxs)("div",{className:"flex items-center justify-between gap-4 px-6 h-16 min-h-[40px] border border-b-0 bg-white rounded-t-lg shadow-sm",children:[(0,se.jsx)("span",{className:"text-base font-medium text-slate-900",children:"Users"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(uL,{value:_,onChange:E,placeholder:"Search by Email or Name"}),(0,se.jsx)(kM,{selectedRole:k,onRoleChange:T})]})]})}),"pending"===u&&(0,se.jsx)("div",{className:"sticky top-0 z-30 flex-shrink-0",children:x?(0,se.jsx)("div",{className:"flex items-center gap-2 mb-4 bg-transparent",children:(0,se.jsx)(uL,{value:_,onChange:E,placeholder:"Search by Email or Name"})}):(0,se.jsxs)("div",{className:"flex items-center justify-between gap-4 px-6 h-16 min-h-[40px] border border-b-0 bg-white rounded-t-lg shadow-sm",children:[(0,se.jsx)("span",{className:"text-base font-medium text-slate-900",children:"Pending requests"}),(0,se.jsx)(uL,{value:_,onChange:E,placeholder:"Search by Email or Name"})]})}),(0,se.jsx)(Jj,{value:u,className:"mt-0 flex flex-col min-h-0 flex-1",children:"pending"!==u||0!==A.length||r?(0,se.jsxs)(wC,{data:A,columns:O,onRowClick:e=>x&&wh(e)?(b(e),void y(!0)):wh(e)?void 0:x?(p(e),void f(!0)):void(!1!==e.is_verified&&t.openDrawer(e)),hasMore:l,loadMore:a,className:"!h-auto !flex-initial [&_thead]:bg-slate-100 [&_thead]:border-slate-300 [&_thead_th]:bg-slate-100 [&_thead_th_span]:!text-[#44485F] ".concat(x?"":"!rounded-t-none"),rowVerticalPadding:"small",children:[r&&0===A.length?(0,se.jsx)(uC,{title:"Loading users...",subtitle:"",children:(0,se.jsx)("div",{className:"flex justify-center items-center py-6",children:(0,se.jsx)(oL,{})})}):(0,se.jsx)(uC,{title:"No users found",subtitle:U,children:(0,se.jsx)(CM,{searchQuery:_,roleFilter:k,onInviteClick:()=>{dS.openModal("InviteUser",{onInviteSuccess:()=>{s()}})}})}),(0,se.jsx)(wC.Content,{})]}):(0,se.jsx)("div",{className:"flex-1 flex flex-col border bg-white shadow-sm p-4 ".concat(x?"rounded-lg":"rounded-b-lg"),children:(0,se.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center border border-dashed border-slate-200 rounded-lg bg-white text-center",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"No pending requests"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"There are currently no access requests awaiting approval"})]})})})]}),(0,se.jsx)(AM,{isOpen:N,onClose:()=>t.closeDrawer(),editingUser:w,userEntitySchema:i.user_entity,onSubmit:P}),x&&h&&(0,se.jsx)(bM,{row:h,isUnverified:!1===h.is_verified,removeActionLabel:!1===h.is_verified?"Cancel invite":"Remove user",isOpen:g,onOpenChange:e=>{f(e),e||p(null)},hideTrigger:!0,ownerEmail:d,loadUsers:s,ownershipTransfer:D,onRoleChange:async(e,t)=>{try{const a=o(()=>{});await a.User.update(e.id,{role:t}),await s(),c({title:"Success",description:"User role updated successfully"})}catch(i){var a,n,l,r;c({title:"Error",description:(null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail)||(null===(l=i.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.message)||i.message,variant:"destructive"})}f(!1),p(null)},onDelete:(e,t)=>{I(e,t),p(null)},onResendInvitation:R}),x&&(0,se.jsx)(SM,{row:v,isOpen:j,onOpenChange:e=>{y(e),e||b(null)},onApprove:(e,t)=>{L(e,t),b(null)},onDeny:(e,t)=>{M(e,t),b(null)}})]})},TM=e=>{let{entity:t}=e;const{app:s,updateApp:a}=lp();return(0,se.jsx)(mk,{schema:t,onEdit:(e,n)=>{t.properties[e]=n,s.user_entity=t,a({user_entity:s.user_entity})}})},IM=e=>{let{isOpen:t,onClose:s,entity:a}=e;return(0,se.jsx)(Sy,{open:t,onOpenChange:s,children:(0,se.jsxs)(Ly,{className:"w-full sm:w-[600px] sm:max-w-[600px] overflow-y-auto",children:[(0,se.jsx)(My,{children:(0,se.jsx)(Ry,{children:"User Schema Editor"})}),(0,se.jsx)("div",{className:"py-4",children:(0,se.jsx)(TM,{entity:a})})]})})},PM=()=>{const{app:e}=lp(),{store:t,loadUsers:s,loadMore:a,users:n,hasMore:l,isFetching:r}=xM(),i=qu(),o=t.useIsSchemaDrawerOpen(),c=(n.filter(e=>!wh(e)).length,()=>{dS.openModal("InviteUser",e=>({onInviteSuccess:()=>{var t;s(),null===(t=e.onInviteSuccess)||void 0===t||t.call(e)}}))});return(0,se.jsxs)(lL,{title:"Users",subtitle:"Manage the app's users and their roles",primaryAction:i?(0,se.jsx)(Bx,{size:"icon",variant:"default",onClick:c,className:"h-8 w-8",children:(0,se.jsx)(op.A,{className:"h-4 w-4"})}):(0,se.jsx)(Bx,{size:"sm",onClick:c,children:"Invite User"}),actions:(0,se.jsx)(Bx,{size:"icon",variant:"outline",onClick:()=>t.openSchemaDrawer(),title:"Schema",className:i?"h-8 w-8":"",children:(0,se.jsx)(iM.A,{className:"h-4 w-4"})}),className:"overflow-hidden",children:[(0,se.jsx)("div",{className:"flex-1 flex flex-col min-h-0",children:(0,se.jsx)(EM,{store:t,loadUsers:s,onLoadMore:a,users:n,hasMore:l,isLoading:r})}),(0,se.jsx)(IM,{isOpen:o,onClose:()=>t.closeSchemaDrawer(),entity:e.user_entity})]})},LM=()=>{const[e]=Y.useState(()=>new Q.E);return(0,se.jsx)(X.Ht,{client:e,children:(0,se.jsx)(PM,{})})},MM=(0,Y.createContext)(),RM=e=>{let{children:t}=e;const{appId:s}=(0,J.g)(),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)(!1),x=async()=>{if(s){o(!0);try{const e=await zc.get(s);n(e);try{const e=await Gg.getListingIfExists(s);r(e)}catch(t){r(null)}}catch(t){var e;d(t),403===(null==t||null===(e=t.response)||void 0===e?void 0:e.status)&&d(new Error("You do not have access to this app"))}finally{o(!1)}}};(0,Y.useEffect)(()=>{x()},[s]);const h=(0,Y.useCallback)(()=>{x()},[s]),p=(0,Y.useMemo)(()=>!(null==l||!l.pending_snapshot_id),[null==l?void 0:l.pending_snapshot_id]),g=(0,Y.useMemo)(()=>!(null==l||!l.pending_metadata)&&Object.keys(l.pending_metadata).length>0,[null==l?void 0:l.pending_metadata]),f=(0,Y.useMemo)(()=>p||g,[p,g]),v=(0,Y.useMemo)(()=>{if(null==a||!a.updated_date||null==l||!l.updated_date)return!1;if("approved"!==l.status)return!1;return new Date(a.updated_date)>new Date(l.updated_date)},[null==a?void 0:a.updated_date,null==l?void 0:l.updated_date,null==l?void 0:l.status]),b=(0,Y.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==l||!l.id)throw new Error("No listing to update");m(!0);try{const t=await Gg.submitUpdate(l.id,e);return r(t),t}finally{m(!1)}},[null==l?void 0:l.id]),j=(0,Y.useCallback)(async()=>null!=l&&l.id?await Gg.getPendingChanges(l.id):null,[null==l?void 0:l.id]),y={app:a,listing:l,isLoading:i,error:c,hasListing:!(null==l||!l.id||null!=l&&l.archived),createOrUpdateListing:async e=>{if(null==l||!l.id||null!=l&&l.archived){const t=await Gg.create((0,ue.A)((0,ue.A)({},e),{},{app_id:s}));return r(t),t}{const t=await Gg.update(l.id,e);return r(t),t}},refetch:h,hasPendingUpdate:f,hasPendingSnapshot:p,hasPendingMetadata:g,hasChanges:v,submitUpdate:b,isSubmittingUpdate:u,getPendingChanges:j};return(0,se.jsx)(MM.Provider,{value:y,children:t})},DM=()=>{const e=(0,Y.useContext)(MM);if(!e)throw new Error("useAppListing must be used within an AppListingProvider");return e},FM=["steps","currentStep","title","description","children","onNext","onPrevious","onClose","onSubmit","isNextDisabled","isLoading","nextButtonText","submitButtonText","previousButtonText","hideCloseButton","className","banner","footerLeftContent"];function OM(e){let{steps:t,currentStep:s,title:a,description:n,children:l,onNext:r,onPrevious:i,onClose:o,onSubmit:c,isNextDisabled:d=!1,isLoading:u=!1,nextButtonText:m="Next",submitButtonText:x="Submit",previousButtonText:h="Back",hideCloseButton:p=!1,className:g,banner:f,footerLeftContent:v}=e,b=(0,Nt.A)(e,FM);const j=0===s,y=s===t.length-1,N=(s+1)/t.length*100;return(0,se.jsxs)("div",(0,ue.A)((0,ue.A)({"data-testid":"stepped-wizard",className:de("bg-theme-card bg-white rounded-[20px] shadow-lg inline-flex flex-col justify-start items-start overflow-hidden",g)},b),{},{children:[(0,se.jsx)("div",{className:"w-full h-2 bg-gradient-to-r from-[#FFC787] via-[#FF6900] to-[#5F5DD8] flex flex-col justify-start items-end overflow-hidden",children:(0,se.jsx)("div",{className:"h-2 bg-slate-200 transition-all duration-300 ease-in-out",style:{width:"".concat(100-N,"%")}})}),(0,se.jsxs)("div",{className:"self-stretch px-6 pt-4 pb-3 border-b border-theme-border inline-flex justify-between items-start",children:[(0,se.jsxs)("div",{className:"w-full inline-flex flex-col justify-start items-start gap-1.5",children:[(0,se.jsx)("div",{"data-testid":"wizard-title",className:"justify-start text-2xl font-semibold font-base44",children:a}),n&&(0,se.jsx)("div",{"data-testid":"wizard-description",className:"self-stretch justify-start text-gray-700 text-sm font-normal font-base44 leading-tight",children:n})]}),!p&&o&&(0,se.jsx)("div",{className:"w-36 flex justify-end items-center gap-3",children:(0,se.jsx)("button",{"data-testid":"wizard-close-button",onClick:o,className:"flex justify-start items-start","aria-label":"Close",children:(0,se.jsx)("div",{className:"w-6 h-6 relative",children:(0,se.jsx)("div",{className:"w-5 h-5 absolute",children:(0,se.jsx)(la.A,{className:"w-5 h-5"})})})})})]}),(0,se.jsx)("div",{className:"flex-1 self-stretch overflow-y-auto",children:l}),(0,se.jsx)("div",{className:"self-stretch px-6 py-4 border-t border-gray-200",children:(0,se.jsxs)("div",{className:"flex flex-col gap-3 min-[470px]:flex-row min-[470px]:items-center min-[470px]:gap-2 ".concat(v?"min-[470px]:justify-between":"min-[470px]:justify-end"),children:[v&&(0,se.jsx)("div",{className:"flex justify-start items-center order-1 min-[470px]:order-1",children:v}),(0,se.jsxs)("div",{className:"flex justify-end items-center gap-6 order-2 min-[470px]:order-2",children:[(0,se.jsxs)("div",{"data-testid":"step-indicator",className:"justify-center text-gray-500 text-sm font-normal font-base44 leading-tight",children:["Step ",s+1," of ",t.length]}),(0,se.jsxs)("div",{className:"flex justify-start items-center gap-3",children:[!j&&i&&(0,se.jsx)(Bx,{"data-testid":"wizard-previous-button",variant:"outline",size:"sm",onClick:i,disabled:u,className:"w-9 h-9 rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] flex justify-center items-center p-0",children:(0,se.jsx)(vs.A,{className:"w-4 h-4"})}),(y?c:r)&&(0,se.jsxs)(Bx,{"data-testid":y?"wizard-submit-button":"wizard-next-button",onClick:y?c:r,variant:"default",disabled:d||u,className:"h-9 rounded-lg min-w-24",children:[(0,se.jsx)("span",{className:"text-center justify-center text-sm font-medium font-base44 leading-tight",children:u?"Loading...":y?x:m}),!u&&!y&&(0,se.jsx)(bs.A,{className:"w-4 h-4 "})]})]})]})]})}),f&&f]}))}function UM(e){let{label:t,placeholder:s,value:a,onChange:n,error:l,type:r="text",icon:i,className:o="",required:c=!1,helperText:d,rows:u=4,tooltipText:m}=e;const x="".concat("textarea"===r?"h-20":"h-10"," ").concat(l?"border-red-500":"border-slate-200"," ").concat(o),h=e=>{n(e.target.value)};return(0,se.jsxs)("div",{className:t?"space-y-1":"",children:[t&&(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsxs)(aN,{className:"text-center justify-center text-gray-700 text-sm font-medium font-base44 leading-tight",children:[t,c&&(0,se.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),m&&(0,se.jsxs)(xp,{delayDuration:100,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-gray-600 hover:text-gray-900"})}),(0,se.jsx)(pp,{className:"max-w-[240px] p-3 text-xs",children:(0,se.jsx)("p",{children:m})})]})]}),"textarea"===r?(0,se.jsx)(tN,{placeholder:s,value:a,onChange:h,rows:u,className:x}):(0,se.jsx)(Df,{type:r,placeholder:s,value:a,onChange:h,className:x}),l&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:l}),d&&!l&&(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:d})]})}const BM=e=>{let{value:t,onValueChange:s,placeholder:a="Select a country",error:n,required:l=!1,disabled:r=!1,className:i=""}=e;VE.find(e=>e.value===t);const o="w-full h-10 ".concat(n?"border-red-500":"border-slate-200"," ").concat(i);return(0,se.jsxs)("div",{className:"w-full",children:[(0,se.jsxs)(Wf,{value:t,onValueChange:s,disabled:r,children:[(0,se.jsx)(Yf,{className:"w-full ".concat(o," focus:outline-none focus-visible:outline-none focus:ring-1 focus:ring-black focus:border-black data-[state=open]:ring-1 data-[state=open]:ring-black data-[state=open]:border-black"),style:{color:t?"#000000":"#94a3b8"},children:(0,se.jsx)(qf,{placeholder:a,className:"text-sm font-normal font-base44 leading-tight"})}),(0,se.jsx)($f,{className:"bg-white border border-slate-200 rounded-md shadow-lg max-h-60 w-[var(--radix-select-trigger-width)]",position:"popper",sideOffset:4,children:VE.map(e=>(0,se.jsx)(Zf,{value:e.value,hideCheckIcon:!0,className:"w-full p-1.5 rounded-md cursor-pointer inline-flex justify-start items-center gap-2 hover:!bg-slate-50 focus:!bg-slate-50 data-[highlighted]:!bg-slate-50 data-[state=checked]:!bg-slate-700 data-[state=checked]:!text-white data-[state=checked]:hover:!bg-slate-700 data-[state=checked]:data-[highlighted]:!bg-slate-700",children:(0,se.jsx)("div",{className:"flex-1 justify-start text-sm font-normal font-base44 leading-tight",children:e.label})},e.value))})]}),n&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:n})]})};function zM(e){let{label:t,placeholder:s,value:a,onChange:n,error:l,className:r="",required:i=!1,helperText:o,tooltipText:c,disabled:d=!1}=e;return(0,se.jsxs)("div",{className:"w-full space-y-1",children:[t&&(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsxs)(aN,{className:"text-center justify-center text-gray-700 text-sm font-medium font-base44 leading-tight",children:[t,i&&(0,se.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),c&&(0,se.jsxs)(xp,{delayDuration:100,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-gray-600 hover:text-gray-900"})}),(0,se.jsx)(pp,{className:"max-w-[240px] p-3 text-xs",children:(0,se.jsx)("p",{children:c})})]})]}),(0,se.jsx)(BM,{value:a,onValueChange:n,placeholder:s,error:l,disabled:d,className:r}),l&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:l}),o&&!l&&(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:o})]})}const HM=e=>{let{formData:t,errors:s,onInputChange:a}=e;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(UM,{label:"Business / Seller name",placeholder:"Enter your business or seller name",value:t.business_name,onChange:e=>a("business_name",e),error:s.business_name,required:!0,className:"w-full",tooltipText:"This is how buyers will see you in the marketplace. Use your company name or your own name."})}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(UM,{label:"Description",placeholder:"Tell buyers about yourself and what you create...",value:t.description,onChange:e=>a("description",e),error:s.description,type:"textarea",helperText:"".concat(t.description.length,"/500 characters (minimum 10)"),required:!0,className:"w-full",tooltipText:"Describe your expertise, the types of apps you create, and what makes your templates valuable."})}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(zM,{label:"Country",placeholder:"Select your country",value:t.country,onChange:e=>a("country",e),error:s.country,required:!0,className:"w-full",tooltipText:"Your location helps buyers understand your timezone and context"})}),(0,se.jsx)("div",{className:"w-full p-4 bg-orange-50 rounded-lg border border-orange-200",children:(0,se.jsxs)("p",{className:"text-sm text-gray-700",children:["\u2139\ufe0f ",(0,se.jsx)("strong",{children:"Public Information:"})," All information on this page will be visible to potential buyers on your seller profile."]})})]})},VM=e=>{let{formData:t,errors:s,onInputChange:a}=e;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(UM,{label:"Website URL",placeholder:"https://example.com",value:t.website_url,onChange:e=>a("website_url",e),error:s.website_url,className:"w-full",tooltipText:"Your company or personal website (optional but recommended)"})}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(UM,{label:"LinkedIn URL",placeholder:"https://linkedin.com/in/yourprofile",value:t.linkedin_url,onChange:e=>a("linkedin_url",e),error:s.linkedin_url,className:"w-full",tooltipText:"Link to your LinkedIn profile for credibility"})}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(UM,{label:"Twitter / X URL",placeholder:"https://twitter.com/yourhandle",value:t.twitter_url,onChange:e=>a("twitter_url",e),error:s.twitter_url,className:"w-full",tooltipText:"Link to your Twitter/X profile (optional)"})}),(0,se.jsx)("div",{className:"w-full p-4 bg-orange-50 rounded-lg border border-orange-200",children:(0,se.jsxs)("p",{className:"text-sm text-gray-700",children:["\u2139\ufe0f ",(0,se.jsx)("strong",{children:"Public Information:"})," These links will be shown on your public seller profile to help buyers learn more about you."]})})]})},WM=e=>{let{formData:t,errors:s,onInputChange:a}=e;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsxs)("div",{className:"w-full p-4 bg-blue-50 rounded-lg border border-blue-200 flex gap-3",children:[(0,se.jsx)(ad.A,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("p",{className:"text-sm text-gray-700",children:(0,se.jsx)("strong",{children:"Payout Setup (Optional)"})}),(0,se.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"You can skip this step and complete it later. However, you won't receive payouts until you add your wallet ID."})]})]}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Payout Service"}),(0,se.jsx)("div",{className:"w-full px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:(0,se.jsx)("div",{className:"flex items-center gap-3",children:(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Rewardful"}),(0,se.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Currently the only supported payout provider"})]})})})]})}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(UM,{label:"Rewardful Wallet ID",placeholder:"Enter your Rewardful wallet ID",value:t.wallet_id,onChange:e=>a("wallet_id",e),error:s.wallet_id,className:"w-full",tooltipText:"Your Rewardful account ID where payouts will be sent",helperText:"Don't have a Rewardful account? You can add this later before receiving payouts."})}),(0,se.jsx)("div",{className:"w-full p-4 bg-slate-50 rounded-lg border border-slate-200",children:(0,se.jsxs)("p",{className:"text-sm text-gray-700",children:["\u{1f512} ",(0,se.jsx)("strong",{children:"Private Information:"})," Your wallet ID is kept private and will never be shown to buyers."]})})]})},qM=[{label:"Afghanistan",value:"af"},{label:"\xc5land Islands",value:"ax"},{label:"Albania",value:"al"},{label:"Algeria",value:"dz"},{label:"American Samoa",value:"as"},{label:"Andorra",value:"ad"},{label:"Angola",value:"ao"},{label:"Anguilla",value:"ai"},{label:"Antigua & Barbuda",value:"ag"},{label:"Argentina",value:"ar"},{label:"Armenia",value:"am"},{label:"Aruba",value:"aw"},{label:"Australia",value:"au"},{label:"Austria",value:"at"},{label:"Azerbaijan",value:"az"},{label:"Bahamas",value:"bs"},{label:"Bahrain",value:"bh"},{label:"Bangladesh",value:"bd"},{label:"Barbados",value:"bb"},{label:"Belarus",value:"by"},{label:"Belgium",value:"be"},{label:"Belize",value:"bz"},{label:"Benin",value:"bj"},{label:"Bermuda",value:"bm"},{label:"Bhutan",value:"bt"},{label:"Bolivia",value:"bo"},{label:"Bosnia & Herzegovina",value:"ba"},{label:"Botswana",value:"bw"},{label:"Brazil",value:"br"},{label:"British Indian Ocean Territory",value:"io"},{label:"British Virgin Islands",value:"vg"},{label:"Brunei",value:"bn"},{label:"Bulgaria",value:"bg"},{label:"Burkina Faso",value:"bf"},{label:"Burundi",value:"bi"},{label:"Cambodia",value:"kh"},{label:"Cameroon",value:"cm"},{label:"Canada",value:"ca"},{label:"Cape Verde",value:"cv"},{label:"Caribbean Netherlands",value:"bq"},{label:"Cayman Islands",value:"ky"},{label:"Central African Republic",value:"cf"},{label:"Chad",value:"td"},{label:"Chile",value:"cl"},{label:"China",value:"cn"},{label:"Christmas Island",value:"cx"},{label:"Cocos (Keeling) Islands",value:"cc"},{label:"Colombia",value:"co"},{label:"Comoros",value:"km"},{label:"Congo - Brazzaville",value:"cg"},{label:"Congo - Kinshasa",value:"cd"},{label:"Cook Islands",value:"ck"},{label:"Costa Rica",value:"cr"},{label:"C\xf4te d'Ivoire",value:"ci"},{label:"Croatia",value:"hr"},{label:"Cura\xe7ao",value:"cw"},{label:"Cyprus",value:"cy"},{label:"Czechia",value:"cz"},{label:"Denmark",value:"dk"},{label:"Djibouti",value:"dj"},{label:"Dominica",value:"dm"},{label:"Dominican Republic",value:"do"},{label:"Ecuador",value:"ec"},{label:"Egypt",value:"eg"},{label:"El Salvador",value:"sv"},{label:"Equatorial Guinea",value:"gq"},{label:"Eritrea",value:"er"},{label:"Estonia",value:"ee"},{label:"Eswatini",value:"sz"},{label:"Ethiopia",value:"et"},{label:"Falkland Islands",value:"fk"},{label:"Faroe Islands",value:"fo"},{label:"Fiji",value:"fj"},{label:"Finland",value:"fi"},{label:"France",value:"fr"},{label:"French Guiana",value:"gf"},{label:"French Polynesia",value:"pf"},{label:"Gabon",value:"ga"},{label:"Gambia",value:"gm"},{label:"Georgia",value:"ge"},{label:"Germany",value:"de"},{label:"Ghana",value:"gh"},{label:"Gibraltar",value:"gi"},{label:"Greece",value:"gr"},{label:"Greenland",value:"gl"},{label:"Grenada",value:"gd"},{label:"Guadeloupe",value:"gp"},{label:"Guam",value:"gu"},{label:"Guatemala",value:"gt"},{label:"Guernsey",value:"gg"},{label:"Guinea",value:"gn"},{label:"Guinea-Bissau",value:"gw"},{label:"Guyana",value:"gy"},{label:"Haiti",value:"ht"},{label:"Honduras",value:"hn"},{label:"Hong Kong SAR China",value:"hk"},{label:"Hungary",value:"hu"},{label:"Iceland",value:"is"},{label:"India",value:"in"},{label:"Indonesia",value:"id"},{label:"Iraq",value:"iq"},{label:"Ireland",value:"ie"},{label:"Isle of Man",value:"im"},{label:"Israel",value:"il"},{label:"Italy",value:"it"},{label:"Jamaica",value:"jm"},{label:"Japan",value:"jp"},{label:"Jersey",value:"je"},{label:"Jordan",value:"jo"},{label:"Kazakhstan",value:"kz"},{label:"Kenya",value:"ke"},{label:"Kiribati",value:"ki"},{label:"Kuwait",value:"kw"},{label:"Kyrgyzstan",value:"kg"},{label:"Laos",value:"la"},{label:"Latvia",value:"lv"},{label:"Lebanon",value:"lb"},{label:"Lesotho",value:"ls"},{label:"Liberia",value:"lr"},{label:"Libya",value:"ly"},{label:"Liechtenstein",value:"li"},{label:"Lithuania",value:"lt"},{label:"Luxembourg",value:"lu"},{label:"Macao SAR China",value:"mo"},{label:"Madagascar",value:"mg"},{label:"Malawi",value:"mw"},{label:"Malaysia",value:"my"},{label:"Maldives",value:"mv"},{label:"Mali",value:"ml"},{label:"Malta",value:"mt"},{label:"Marshall Islands",value:"mh"},{label:"Martinique",value:"mq"},{label:"Mauritania",value:"mr"},{label:"Mauritius",value:"mu"},{label:"Mayotte",value:"yt"},{label:"Mexico",value:"mx"},{label:"Micronesia",value:"fm"},{label:"Moldova",value:"md"},{label:"Monaco",value:"mc"},{label:"Mongolia",value:"mn"},{label:"Montenegro",value:"me"},{label:"Montserrat",value:"ms"},{label:"Morocco",value:"ma"},{label:"Mozambique",value:"mz"},{label:"Myanmar (Burma)",value:"mm"},{label:"Namibia",value:"na"},{label:"Nauru",value:"nr"},{label:"Nepal",value:"np"},{label:"Netherlands",value:"nl"},{label:"New Caledonia",value:"nc"},{label:"New Zealand",value:"nz"},{label:"Nicaragua",value:"ni"},{label:"Niger",value:"ne"},{label:"Nigeria",value:"ng"},{label:"Niue",value:"nu"},{label:"Norfolk Island",value:"nf"},{label:"North Macedonia",value:"mk"},{label:"Northern Mariana Islands",value:"mp"},{label:"Norway",value:"no"},{label:"Oman",value:"om"},{label:"Pakistan",value:"pk"},{label:"Palau",value:"pw"},{label:"Palestinian Territories",value:"ps"},{label:"Panama",value:"pa"},{label:"Papua New Guinea",value:"pg"},{label:"Paraguay",value:"py"},{label:"Peru",value:"pe"},{label:"Philippines",value:"ph"},{label:"Poland",value:"pl"},{label:"Portugal",value:"pt"},{label:"Puerto Rico",value:"pr"},{label:"Qatar",value:"qa"},{label:"R\xe9union",value:"re"},{label:"Romania",value:"ro"},{label:"Rwanda",value:"rw"},{label:"Samoa",value:"ws"},{label:"San Marino",value:"sm"},{label:"S\xe3o Tom\xe9 & Pr\xedncipe",value:"st"},{label:"Saudi Arabia",value:"sa"},{label:"Senegal",value:"sn"},{label:"Serbia",value:"rs"},{label:"Seychelles",value:"sc"},{label:"Sierra Leone",value:"sl"},{label:"Singapore",value:"sg"},{label:"Sint Maarten",value:"sx"},{label:"Slovakia",value:"sk"},{label:"Slovenia",value:"si"},{label:"Solomon Islands",value:"sb"},{label:"Somalia",value:"so"},{label:"South Africa",value:"za"},{label:"South Korea",value:"kr"},{label:"South Sudan",value:"ss"},{label:"Spain",value:"es"},{label:"Sri Lanka",value:"lk"},{label:"St. Barth\xe9lemy",value:"bl"},{label:"St. Helena",value:"sh"},{label:"St. Kitts & Nevis",value:"kn"},{label:"St. Lucia",value:"lc"},{label:"St. Martin",value:"mf"},{label:"St. Pierre & Miquelon",value:"pm"},{label:"St. Vincent & Grenadines",value:"vc"},{label:"Sudan",value:"sd"},{label:"Suriname",value:"sr"},{label:"Svalbard & Jan Mayen",value:"sj"},{label:"Sweden",value:"se"},{label:"Switzerland",value:"ch"},{label:"Syria",value:"sy"},{label:"Taiwan",value:"tw"},{label:"Tajikistan",value:"tj"},{label:"Tanzania",value:"tz"},{label:"Thailand",value:"th"},{label:"Timor-Leste",value:"tl"},{label:"Togo",value:"tg"},{label:"Tokelau",value:"tk"},{label:"Tonga",value:"to"},{label:"Trinidad & Tobago",value:"tt"},{label:"Tunisia",value:"tn"},{label:"Turkey",value:"tr"},{label:"Turkmenistan",value:"tm"},{label:"Turks & Caicos Islands",value:"tc"},{label:"Tuvalu",value:"tv"},{label:"U.S. Virgin Islands",value:"vi"},{label:"Uganda",value:"ug"},{label:"Ukraine",value:"ua"},{label:"United Arab Emirates",value:"ae"},{label:"United Kingdom",value:"gb"},{label:"United States",value:"us"},{label:"Uruguay",value:"uy"},{label:"Uzbekistan",value:"uz"},{label:"Vanuatu",value:"vu"},{label:"Vatican City",value:"va"},{label:"Venezuela",value:"ve"},{label:"Vietnam",value:"vn"},{label:"Wallis & Futuna",value:"wf"},{label:"Western Sahara",value:"eh"},{label:"Yemen",value:"ye"},{label:"Zambia",value:"zm"},{label:"Zimbabwe",value:"zw"}],YM=UE.Ik({business_name:UE.Yj().min(2,"Business name must be at least 2 characters").max(100,"Business name must be less than 100 characters"),description:UE.Yj().min(10,"Description must be at least 10 characters").max(500,"Description must be less than 500 characters"),country:UE.Yj().min(1,"Country is required")}),GM=UE.Ik({website_url:UE.Yj().url("Must be a valid URL").optional().or(UE.eu("")),linkedin_url:UE.Yj().refine(e=>!e||e.toLowerCase().includes("linkedin"),'LinkedIn URL must contain "linkedin"').optional().or(UE.eu("")),twitter_url:UE.Yj().url("Must be a valid URL").optional().or(UE.eu(""))}),KM=UE.Ik({wallet_id:UE.Yj().min(3,"Wallet ID must be at least 3 characters").max(100,"Wallet ID must be less than 100 characters").optional().or(UE.eu("")),checkout_service:UE.eu("rewardful").default("rewardful")}),$M=UE.Ik({terms_accepted:UE.zM().refine(e=>!0===e,"You must accept the terms to continue")}),ZM=YM.merge(GM).merge(KM).merge($M),JM={business_name:"",description:"",country:"us",website_url:"",linkedin_url:"",twitter_url:"",wallet_id:"",checkout_service:"rewardful",terms_accepted:!1},QM=e=>{const t={};return e.errors.forEach(e=>{const s=e.path.join(".");s&&(t[s]=e.message)}),t},XM=e=>{let{formData:t,userEmail:s}=e;const a=(()=>{const e=[];return t.website_url&&e.push(t.website_url.replace(/^https?:\/\//,"").replace(/^www\./,"")),t.linkedin_url&&e.push(t.linkedin_url.replace(/^https?:\/\//,"").replace(/^www\./,"")),t.twitter_url&&e.push(t.twitter_url.replace(/^https?:\/\//,"").replace(/^www\./,"")),e})(),n=[{label:"Country",value:t.country?(e=>{const t=qM.find(t=>t.value===e);return t?t.label:e})(t.country):"Not specified"},{label:"Links",value:(0,se.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:a.map((e,t)=>(0,se.jsxs)(Y.Fragment,{children:[(0,se.jsx)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:e}),t<a.length-1&&(0,se.jsx)("div",{className:"w-1 h-1 bg-gray-500 rounded-full flex-shrink-0"})]},t))}),show:a.length>0},{label:"Description",value:(0,se.jsx)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight whitespace-pre-wrap break-words",children:t.description}),show:!!t.description},{label:"Payout Service",value:"Rewardful"},{label:"Wallet ID",value:t.wallet_id?(0,se.jsx)("span",{className:"font-mono text-gray-950 text-sm font-medium",children:t.wallet_id}):(0,se.jsx)("span",{className:"text-amber-600 text-sm",children:"\u26a0\ufe0f Not provided - add later to receive payouts"})}];return(0,se.jsxs)("div",{className:"w-full p-6 bg-white inline-flex flex-col justify-start items-start gap-3 overflow-hidden",children:[(0,se.jsxs)("p",{className:"w-full text-gray-700 text-sm font-normal font-base44 leading-tight",children:["Review your seller profile before submitting. You can edit your profile anytime after creation. You'll use this email:"," ",(0,se.jsx)("span",{className:"font-medium",children:s})," for marketplace communications."]}),(0,se.jsx)("p",{className:"w-full text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Review your seller profile card"}),(0,se.jsxs)("div",{className:"w-full p-4 bg-slate-50 rounded-lg border border-slate-300 flex flex-col justify-start items-start gap-3 overflow-hidden",children:[(0,se.jsxs)("div",{className:"w-full inline-flex justify-start items-center gap-3",children:[(0,se.jsx)("div",{className:"w-10 h-10 rounded-md border border-black/10 bg-gray-100 flex items-center justify-center overflow-hidden",children:(0,se.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-md flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-xs text-gray-400 font-base44",children:t.business_name?t.business_name.charAt(0).toUpperCase():"S"})})}),(0,se.jsx)("div",{className:"flex-1 text-black text-base font-medium font-base44 leading-tight",children:t.business_name||"Seller"})]}),(0,se.jsx)("div",{className:"w-full flex flex-col justify-start items-start gap-[3px] min-w-0",children:n.filter(e=>!1!==e.show).map((e,t)=>(0,se.jsxs)("div",{className:"w-full py-[3px] flex flex-col sm:flex-row sm:items-start gap-1 sm:gap-0",children:[(0,se.jsx)("div",{className:"sm:w-44 sm:flex-shrink-0 justify-start text-black text-sm font-normal font-base44 leading-tight",children:e.label}),(0,se.jsx)("div",{className:"flex-1 justify-start text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:e.value})]},t))})]})]})},eR=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"create";const[s,a]=(0,Y.useState)((0,ue.A)((0,ue.A)({},JM),e)),[n,l]=(0,Y.useState)({}),[r,i]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{e&&a((0,ue.A)((0,ue.A)({},JM),e))},[e]);const o=(e,t)=>{a(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t})),n[e]&&l(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:null}))};return{formData:s,errors:n,isSubmitting:r,handleInputChange:o,handleTermsToggle:()=>{o("terms_accepted",!s.terms_accepted)},validateStep:e=>{let t;switch(e){case 0:t=(e=>{const t=YM.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:QM(t.error)}})(s);break;case 1:t=(e=>{const t=GM.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:QM(t.error)}})(s);break;case 2:t=(e=>{const t=KM.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:QM(t.error)}})(s);break;default:return!0}return l(t.errors),t.success},handleSubmit:async e=>{const a=(e=>{const t=ZM.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:QM(t.error)}})(s);if(!a.success)return l(a.errors),!1;if(!e)return so({title:"Authentication Required",description:"Please log in to submit your seller profile.",variant:"destructive"}),!1;i(!0);try{const e=localStorage.getItem("token");if(!e)throw new Error("Not authenticated");const a=await fetch("".concat((0,fe.Gt)(),"/marketplace-profile/me"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await a.json();if(!a.ok)throw new Error(n.detail||"Failed to save marketplace profile");return so("edit"===t?{title:"Success",description:"Seller profile updated successfully"}:{description:(0,se.jsx)("div",{className:"flex items-start gap-2",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"font-medium",children:"Seller profile created successfully!"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"You can now sell app templates in the marketplace."})]})}),duration:1e4}),!0}catch(n){return so({title:"Submission Failed",description:n.message||"Failed to save marketplace profile. Please try again.",variant:"destructive"}),!1}finally{i(!1)}},resetForm:()=>{a(e?(0,ue.A)((0,ue.A)({},JM),e):JM),l({})}}},tR=(0,se.jsxs)(se.Fragment,{children:["Create your seller profile to start selling app templates in the marketplace."," ",(0,se.jsx)("a",{href:"/marketplace/terms",target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:text-orange-700 underline",children:"Seller terms of service"})]}),sR=e=>{let{isOpen:t,onClose:s,mode:a="create",initialData:n,onSuccess:l}=e;const{user:r}=wd(),[i,o]=(0,Y.useState)(0),{formData:c,errors:d,isSubmitting:u,handleInputChange:m,handleTermsToggle:x,validateStep:h,handleSubmit:p,resetForm:g}=eR(n,a),f=[{id:1,title:"Basic Info",description:"Tell us about yourself"},{id:2,title:"Contact",description:"Add your online presence"},{id:3,title:"Payout",description:"Setup payment information (optional)"},{id:4,title:"Review",description:"Review and submit"}];(0,Y.useEffect)(()=>{t&&o(0)},[t]);return t?(0,se.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,se.jsx)(OM,{steps:f,currentStep:i,onNext:()=>{h(i)&&o(e=>Math.min(e+1,f.length-1))},onPrevious:()=>{o(e=>Math.max(e-1,0))},onSubmit:async()=>{await p(null==r?void 0:r.email)&&(g(),o(0),s(),l&&l())},onClose:()=>{u||(g(),o(0),s())},isLoading:u,title:"create"===a?"Become a Marketplace Seller":"Edit Seller Profile",description:tR,submitButtonText:"create"===a?"Create Seller Profile":"Update Profile",className:"w-[640px] h-[600px]",footerLeftContent:i!==f.length-1||"edit"===a?null:(0,se.jsxs)("div",{className:"flex justify-start items-center gap-2",children:[(0,se.jsx)("button",{type:"button",onClick:x,className:"w-4 h-4 rounded outline outline-1 outline-offset-[-1px] flex justify-center items-center transition-colors ".concat(d.terms_accepted?"bg-white outline-red-500 hover:outline-red-600":c.terms_accepted?"bg-gray-800 outline-gray-800":"bg-white outline-gray-300 hover:outline-gray-400"),children:c.terms_accepted&&(0,se.jsx)(Ds.A,{className:"w-3 h-3 text-white",strokeWidth:2})}),(0,se.jsxs)("div",{className:"flex justify-start items-center gap-1",children:[(0,se.jsxs)("span",{className:"text-gray-700 text-sm font-normal font-base44 leading-tight",children:["Agree to"," "]}),(0,se.jsx)("a",{href:"/marketplace/terms",target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 text-sm font-normal font-base44 underline leading-tight hover:text-gray-800 transition-colors",children:"Marketplace Seller Terms"})]})]}),children:(()=>{switch(i){case 0:return(0,se.jsx)(HM,{formData:c,errors:d,onInputChange:m});case 1:return(0,se.jsx)(VM,{formData:c,errors:d,onInputChange:m});case 2:return(0,se.jsx)(WM,{formData:c,errors:d,onInputChange:m});case 3:return(0,se.jsx)(XM,{formData:c,userEmail:null==r?void 0:r.email});default:return null}})()})}):null},aR={sm:{container:"w-[24px] h-[24px]",iconSize:14},md:{container:"w-[28px] h-[28px]",iconSize:18},lg:{container:"w-[32px] h-[32px]",iconSize:20}};function nR(e){let{size:t="sm",className:s}=e;const a=aR[t];return(0,se.jsxs)("div",{className:de("inline-flex items-center justify-center relative","rounded-lg",a.container,s),style:{background:"linear-gradient(135deg, #fff7ed 0%, #ffedd5 50%, #fff7ed 100%)",border:"1px solid rgba(251, 146, 60, 0.2)",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"},children:[(0,se.jsx)("div",{className:"absolute inset-0 pointer-events-none rounded-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.5) 0%, transparent 50%, transparent 100%)"}}),(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:a.iconSize,height:a.iconSize,viewBox:"0 0 24 24",fill:"none",stroke:"#ea580c",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"relative",children:[(0,se.jsx)("path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6"}),(0,se.jsx)("path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z"}),(0,se.jsx)("path",{d:"M2 9h20"})]})]})}function lR(e){let{secretNames:t,sharedSecrets:s,onConfigureClick:a}=e;const n=null!=s?s:[],l=(null!=t?t:[]).length,r=n.length;return 0===l?null:(0,se.jsxs)(Bv,{className:"border border-slate-200 rounded-[14px]",children:[(0,se.jsx)(zv,{className:"py-4 px-6 border-b border-slate-200",children:(0,se.jsx)(Hv,{className:"text-lg font-semibold",children:"Integration Secrets"})}),(0,se.jsxs)(Wv,{className:"pt-6 px-6 pb-6",children:[(0,se.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure which API keys and secrets are copied when workspace members clone this template."}),(0,se.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors",onClick:a,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),a())},children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center",children:(0,se.jsx)(Qx.A,{className:"w-5 h-5 text-slate-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("p",{className:"text-sm font-medium text-slate-900",children:[r," of ",l," secret",1!==l?"s":""," shared"]}),(0,se.jsx)("p",{className:"text-xs text-slate-500 mt-0.5",children:0===r?"Members will need to provide their own API keys":r===l?"All secrets will be copied to cloned apps":"Some secrets will be copied, others must be provided"})]})]}),(0,se.jsxs)(Bx,{variant:"ghost",size:"sm",className:"text-slate-600 hover:text-slate-900",onClick:e=>{e.stopPropagation(),a()},children:["Configure",(0,se.jsx)(bs.A,{className:"w-4 h-4 ml-1"})]})]})]})]})}function rR(e){let{isOpen:t,onClose:s,secretNames:a,sharedSecrets:n,onSave:l}=e;const r=null!=a?a:[],i=null!=n?n:[],[o,c]=(0,Y.useState)(new Set);(0,Y.useEffect)(()=>{t&&c(new Set(i))},[t,i]);const d=o.size;return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&s(),children:(0,se.jsxs)(Hg,{className:"sm:max-w-[600px] flex flex-col max-h-[85vh]",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{className:"text-xl",children:"Share Integration Secrets"}),(0,se.jsx)(Yg,{className:"text-slate-500 text-[15px]",children:"Choose which integration secrets will be copied when workspace members clone this template"})]}),(0,se.jsx)("div",{className:"overflow-y-auto py-2 min-h-[200px] max-h-[400px] px-1",children:(0,se.jsx)("div",{className:"space-y-3",children:0===r.length?(0,se.jsxs)("div",{className:"text-center py-12 text-slate-500",children:[(0,se.jsx)(Qx.A,{className:"w-10 h-10 mx-auto mb-3 text-slate-300"}),(0,se.jsx)("p",{children:"No secrets configured for this app."})]}):r.map(e=>{const t=o.has(e);return(0,se.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-xl border border-slate-200 bg-white hover:border-slate-300 transition-colors",children:[(0,se.jsx)(E_,{id:"secret-".concat(e),checked:t,onCheckedChange:()=>(e=>{c(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})})(e),className:"h-5 w-5 border-slate-300 data-[state=checked]:bg-slate-900 data-[state=checked]:border-slate-900"}),(0,se.jsx)(aN,{htmlFor:"secret-".concat(e),className:"text-base font-medium text-slate-900 cursor-pointer flex-1",children:e})]},e)})})}),(0,se.jsxs)("div",{className:"flex flex-col pt-6 border-t border-slate-100",children:[(0,se.jsxs)(Wg,{className:"gap-3 sm:gap-0",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>{s()},className:"h-11 px-6 text-[15px] font-medium",children:"Cancel"}),(0,se.jsxs)(Bx,{onClick:()=>{l(Array.from(o)),s()},className:"h-11 px-6 bg-slate-900 hover:bg-slate-800 text-white text-[15px] font-medium",children:["Save (",d," shared)"]})]}),(0,se.jsx)("div",{className:"text-center -mx-6 -mb-6 mt-5 py-5 bg-slate-50/50",children:(0,se.jsxs)("p",{className:"text-slate-500 text-sm leading-relaxed",children:["Shared secrets are copied once at clone time.",(0,se.jsx)("br",{}),"They won't auto-update if you change them later in the source app."]})})]})]})})}const iR=["timestamp"],oR=["Marketing & Sales","Operations","Data & Analytics","Content Generation","HR & Legal","Finance","Education","Community","Lifestyle & Hobbies","Games & Entertainment"],cR=e=>e&&Array.isArray(e)?e.filter(e=>oR.includes(e)):[],dR=(e,t)=>"app_listing_autosave_".concat(e,"_").concat(t||"new"),uR=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const a=dR(e,t),n=localStorage.getItem(a);if(n){const e=JSON.parse(n);if(Date.now()-e.timestamp<6048e5){const{timestamp:t}=e,a=(0,Nt.A)(e,iR);return s&&a.visibility_scope&&a.visibility_scope!==s?null:a}}return null}catch(a){return null}},mR=(e,t)=>{try{const s=dR(e,t);localStorage.removeItem(s)}catch(s){}};function xR(e){let{listingId:t,listing:s,onSave:a,onSubmitUpdate:n,onRefetch:l,onRouteChange:r,onSaveSuccess:i,appHasChanges:o,app:c,initialVisibilityScope:d="public"}=e;const{user:u}=wd(),m=(0,Y.useRef)(null),[x,h]=(0,Y.useState)(s||null),p=(null==u?void 0:u.subscription_tier)&&"free"!==u.subscription_tier,g="approved"===(null==x?void 0:x.status),f=Kg(),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(null),[N,w]=(0,Y.useState)(!1),[_,k]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)(!1),[S,E]=(0,Y.useState)(null),[T,I]=(0,Y.useState)(null),[P,L]=(0,Y.useState)(!1),[M,R]=(0,Y.useState)(!1),[D,F]=(0,Y.useState)(!1),[O,U]=(0,Y.useState)(null),[B,z]=(0,Y.useState)(!1),[H,V]=(0,Y.useState)(null),[W,q]=(0,Y.useState)(!1),G=(0,Y.useRef)(null),K=(0,Y.useRef)(null),[$,Z]=(0,Y.useState)({name:"",description:"",screenshot_urls:[],categories:[],is_private:!1,is_paid:!1,price_usd:"",marketplace_terms_accepted:!1,visibility_scope:d,workspace_id:"workspace"===d?null==c?void 0:c.organization_id:null,shared_secrets:[]}),[J,Q]=(0,Y.useState)(!1),[X,ee]=(0,Y.useState)([]),te=(0,Y.useCallback)(e=>{null!=c&&c.id&&(z(!0),((e,t,s)=>{try{const a=dR(e,t),n=(0,ue.A)((0,ue.A)({},s),{},{timestamp:Date.now()});localStorage.setItem(a,JSON.stringify(n))}catch(j){}})(c.id,t,e),V(new Date),setTimeout(()=>z(!1),500))},[null==c?void 0:c.id,t]),ae=(0,Y.useCallback)(e=>{G.current&&clearTimeout(G.current),G.current=setTimeout(()=>{te(e)},1e3)},[te]);(0,Y.useEffect)(()=>{if(t&&!s)(async()=>{try{b(!0);const e=await Gg.get(t);h(e);const s=null!=c&&c.id?uR(c.id,t,e.visibility_scope):null;if(s){if(Z((0,ue.A)((0,ue.A)({},s),{},{categories:cR(s.categories||[]),screenshot_urls:s.screenshot_urls||[],shared_secrets:s.shared_secrets||[],visibility_scope:s.visibility_scope||e.visibility_scope||"public"})),A(!0),!W){q(!0);const e=so({title:"Draft Restored",description:"Your unsaved changes have been restored from a previous session",variant:"default"});K.current=e}}else Z({name:e.name||"",description:Xg(e.description||""),screenshot_urls:e.screenshot_urls||[],categories:cR(e.categories||[]),is_private:e.is_private||!1,is_paid:e.is_paid||!1,price_usd:e.price_usd||"",marketplace_terms_accepted:e.marketplace_terms_accepted||!1,visibility_scope:e.visibility_scope||"public",workspace_id:e.workspace_id||null,shared_secrets:e.shared_secrets||[]})}catch(e){y(e),so({title:"Error",description:"Failed to load listing",variant:"destructive"})}finally{b(!1)}})();else if(t||s||!c){if(s){const e=s.visibility_scope||d,a=null!=c&&c.id?uR(c.id,t,e):null;if(a){if(Z((0,ue.A)((0,ue.A)({},a),{},{categories:cR(a.categories||[]),screenshot_urls:a.screenshot_urls||[],shared_secrets:a.shared_secrets||[],visibility_scope:a.visibility_scope||e||"public"})),A(!0),!W){q(!0);const e=so({title:"Draft Restored",description:"Your unsaved changes have been restored from a previous session",variant:"default"});K.current=e}}else Z({name:s.name||"",description:Xg(s.description||""),screenshot_urls:s.screenshot_urls||[],categories:cR(s.categories||[]),is_private:s.is_private||!1,is_paid:s.is_paid||!1,price_usd:s.price_usd||"",marketplace_terms_accepted:s.marketplace_terms_accepted||!1,archived:!1,visibility_scope:s.visibility_scope||d,workspace_id:s.workspace_id||("workspace"===(s.visibility_scope||d)?null==c?void 0:c.organization_id:null),shared_secrets:s.shared_secrets||[]})}}else;},[t,s,null==c?void 0:c.id,W]),(0,Y.useEffect)(()=>{m.current&&m.current.scrollIntoView({behavior:"smooth",block:"start"})},[]),(0,Y.useEffect)(()=>{(async()=>{try{const s=localStorage.getItem("token");if(!s)return;const a=await fetch("".concat((0,fe.Gt)(),"/marketplace-profile/me"),{headers:{Authorization:"Bearer ".concat(s)}}),n=await a.json();if(n.has_profile){var e,t;const s=n.profile,a={business_name:s.business_name||"",description:s.description||"",country:s.country||"us",website_url:s.website_url||"",linkedin_url:s.linkedin_url||"",twitter_url:s.twitter_url||"",wallet_id:(null===(e=s.checkout_info)||void 0===e?void 0:e.wallet_id)||"",checkout_service:(null===(t=s.checkout_info)||void 0===t?void 0:t.service)||"rewardful",terms_accepted:s.terms_accepted||!1,onboarding_completed:s.onboarding_completed||!1};U(a)}}catch(j){}})()},[]),(0,Y.useEffect)(()=>()=>{G.current&&clearTimeout(G.current),K.current&&K.current.dismiss()},[]),(0,Y.useEffect)(()=>{!p&&$.is_paid&&Z(e=>(0,ue.A)((0,ue.A)({},e),{},{is_paid:!1,price_usd:null,marketplace_terms_accepted:!1}))},[p,$.is_paid]),(0,Y.useEffect)(()=>{$.is_paid&&$.is_private&&Z(e=>(0,ue.A)((0,ue.A)({},e),{},{is_private:!1}))},[$.is_paid,$.is_private]),(0,Y.useEffect)(()=>{"workspace"===$.visibility_scope&&$.is_paid&&Z(e=>(0,ue.A)((0,ue.A)({},e),{},{is_paid:!1,price_usd:null}))},[$.visibility_scope,$.is_paid]),(0,Y.useEffect)(()=>{(async()=>{if(null!=c&&c.id)try{const e=await zc.remixAppRequirements(c.id);ee(e.app_secret_names||[])}catch(j){ee([])}})()},[null==c?void 0:c.id]);const ne=(e,t)=>{const s="description"===e?Xg(t):t;Z(t=>{const a=(0,ue.A)((0,ue.A)({},t),{},{[e]:s});return ae(a),a}),A(!0)},le=async()=>{if(n){w(!0),R(!0);try{if(!$.name||""===$.name.trim())throw new Error("Template name is required");if(!$.description||""===$.description.trim()||"<p></p>"===$.description||"<p><br></p>"===$.description)throw new Error("Template description is required");if(!$.categories||0===$.categories.length)throw new Error("At least one category is required");if(!$.screenshot_urls||0===$.screenshot_urls.length)throw new Error("At least one screenshot is required");if($.is_paid){const e=parseFloat($.price_usd);if(!$.price_usd||isNaN(e))throw new Error("Please set a valid price");if(e<.99)throw new Error("Price must be at least $0.99");if(e>1e3)throw new Error("Price cannot exceed $1000. Please contact support for higher-priced items.")}const e=(0,ue.A)((0,ue.A)({},$),{},{price_usd:$.is_paid?parseFloat($.price_usd):null,marketplace_terms_accepted:$.marketplace_terms_accepted});await n(e),so({title:"Update submitted",description:"Your changes have been submitted for review. Your listing will remain live until the update is approved."}),A(!1),null!=c&&c.id&&mR(c.id,t),l&&await l(),i?i():r("main")}catch(j){var e,s;so({title:"Error",description:(null===(e=j.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||j.message||"Failed to submit update",variant:"destructive"})}finally{w(!1),R(!1)}}else so({title:"Error",description:"Submit update handler not available",variant:"destructive"})},re=async()=>{w(!0),L(!1),K.current&&(K.current.dismiss(),K.current=null);try{if(!$.name||""===$.name.trim())throw new Error("Template name is required");if(!$.description||""===$.description.trim()||"<p></p>"===$.description||"<p><br></p>"===$.description)throw new Error("Template description is required");if(!$.categories||0===$.categories.length)throw new Error("At least one category is required");if(!$.screenshot_urls||0===$.screenshot_urls.length)throw new Error("At least one screenshot is required");if("public"===$.visibility_scope&&!$.marketplace_terms_accepted)throw new Error("You must accept the terms and conditions to create a listing");if($.is_paid){const e=parseFloat($.price_usd);if(!$.price_usd||isNaN(e))throw new Error("Please set a valid price");if(e<.99)throw new Error("Price must be at least $0.99");if(e>1e3)throw new Error("Price cannot exceed $1000. Please contact support for higher-priced items.")}const s=(0,ue.A)((0,ue.A)({},$),{},{price_usd:$.is_paid?parseFloat($.price_usd):null,marketplace_terms_accepted:$.marketplace_terms_accepted,archived:!1});let n;if(a)n=await a(s);else{if(!(null!=x&&x.id||t))throw new Error("No save handler provided for new listing");n=await Gg.update((null==x?void 0:x.id)||t,s)}if(so({title:"Success",description:(null==x?void 0:x.id)?"Listing updated successfully":"Listing created successfully"}),h(n),A(!1),u&&c){var e;const s=!(null!=x&&x.id||t);f.listingSaved({listing_id:n.id||(null==x?void 0:x.id)||t,app_id:c.id,is_paid:$.is_paid,price_usd:$.is_paid&&parseFloat($.price_usd)||null,status:"draft",is_first_listing:s,has_screenshots:$.screenshot_urls.length>0,has_description:((null===(e=$.description)||void 0===e?void 0:e.length)||0)>0,categories_count:$.categories.length})}null!=c&&c.id&&mR(c.id,t),i?i():r("main")}catch(j){var s,n;so({title:"Error",description:(null===(s=j.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.detail)||j.message||"Failed to save listing",variant:"destructive"})}finally{w(!1)}},ie=(0,Y.useCallback)(async e=>{if($.screenshot_urls.length>7)return void so({title:"Error",description:"Maximum of 7 screenshots allowed",variant:"destructive"});if(["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type))if(e.size>5242880)so({title:"Error",description:"Image size must be less than 5MB",variant:"destructive"});else{k(!0);try{const t=await ip.uploadAppFile(e,c.id),s=t.url||t.file_url||t;Z(e=>{const t=(0,ue.A)((0,ue.A)({},e),{},{screenshot_urls:[...e.screenshot_urls,s]});return ae(t),A(!0),t}),so({title:"Success",description:"Screenshot uploaded successfully"})}catch(j){so({title:"Error",description:"Failed to upload screenshot",variant:"destructive"})}finally{k(!1)}}else so({title:"Error",description:"Only JPEG, JPG, and PNG files are allowed",variant:"destructive"})},[$.screenshot_urls.length,ae]);(0,Y.useEffect)(()=>{const e=async e=>{var t;const s=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(s)for(const a of s)if(-1!==a.type.indexOf("image")){e.preventDefault();const t=a.getAsFile();t&&await ie(t)}};return document.addEventListener("paste",e),()=>document.removeEventListener("paste",e)},[ie]);const oe=async e=>{const t=e.target.files;if(t&&0!==t.length)for(const s of t)await ie(s)},ce=()=>{I(null)},de=(e,t)=>{e.preventDefault(),null!==S&&S!==t&&((e,t)=>{const s=[...$.screenshot_urls],[a]=s.splice(e,1);s.splice(t,0,a),ne("screenshot_urls",s)})(S,t),E(null),I(null)},me=()=>{E(null),I(null)};if(v)return(0,se.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,se.jsx)("div",{className:"text-muted-foreground",children:"Loading listing..."})});if(j)return(0,se.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,se.jsxs)("div",{className:"text-red-600",children:["Error: ",j.message]})});const xe=!(null!=x&&x.id)&&!t||(null==x?void 0:x.archived),he=(()=>{const e=[];if($.name&&""!==$.name.trim()||e.push("Template name is required"),$.description&&""!==$.description.trim()&&"<p></p>"!==$.description&&"<p><br></p>"!==$.description||e.push("Template description is required"),$.categories&&0!==$.categories.length||e.push("At least one category is required"),$.screenshot_urls&&0!==$.screenshot_urls.length||e.push("At least one screenshot is required"),"public"!==$.visibility_scope||$.marketplace_terms_accepted||e.push("Terms & Conditions must be accepted"),$.is_paid){const t=parseFloat($.price_usd);!$.price_usd||isNaN(t)?e.push("Price is required for paid listings"):(t<.99||t>1e3)&&e.push("Price must be between $0.99 and $1000")}return e})(),pe=0===he.length;return(0,se.jsxs)("div",{ref:m,className:"w-full",children:[(0,se.jsxs)("div",{className:"sticky top-0 z-10 bg-slate-50 py-4 mb-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-4",children:[(0,se.jsx)("button",{onClick:()=>r("main"),className:"hover:text-foreground hover:underline transition-colors cursor-pointer",children:"App Settings"}),(0,se.jsx)("span",{children:"/"}),(0,se.jsx)("span",{className:"transition-colors",children:"App Templates Listing"})]}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 w-full",children:[(0,se.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,se.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 truncate",children:xe?"workspace"===$.visibility_scope?"Create Workspace Template":"Create Public Template":"workspace"===$.visibility_scope?"Edit Workspace Template":"Edit Public Template"}),(0,se.jsx)("div",{className:"flex items-center gap-3 mt-1",children:(0,se.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:"workspace"===$.visibility_scope?xe?"Create a template visible only to workspace members":"Update your workspace template listing":xe?"Create a template visible to all Base44 users":"Update your public template listing"})})]}),(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,se.jsx)(zt,{onClick:()=>r(),variant:"outline",className:"border-gray-200 hover:bg-gray-50 hover:text-gray-700 h-8 px-2 sm:px-3 py-1 text-sm",children:"Cancel"}),(0,se.jsx)(qi,{delayDuration:100,children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("span",{children:(0,se.jsx)(zt,{onClick:g?le:async()=>{if(g)return le();xe||"rejected"!==(null==x?void 0:x.status)?await re():L(!0)},disabled:!pe||!C&&!xe&&!(null!=x&&x.archived)&&!(g&&o)||N,className:"bg-gray-900 hover:bg-gray-500 text-white h-8 px-2 sm:px-3 py-1 text-sm whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:N?g?"Submitting...":"Saving...":xe?"Create":g?"Submit Update":"Update Listing"})})}),(!pe||!C&&!xe&&!(null!=x&&x.archived)&&!(g&&o))&&!N&&(0,se.jsx)(Ki,{className:"bg-white text-slate-900 border border-slate-200 max-w-xs",children:pe?(0,se.jsx)("p",{className:"text-xs",children:"No changes to save"}):(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"font-medium text-xs",children:"Please complete the following:"}),(0,se.jsx)("ul",{className:"list-disc list-inside text-xs space-y-0.5",children:he.map((e,t)=>(0,se.jsx)("li",{children:e},t))})]})})]})})]})})]})]}),(0,se.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n    .prose-editor .quill {\n        border: 1px solid hsl(var(--border));\n        border-radius: calc(var(--radius) - 2px);\n        background: hsl(var(--background));\n        width: 100%;\n        max-width: 100%;\n        overflow: hidden;\n    }\n    .prose-editor .ql-toolbar {\n        border: none;\n        border-bottom: 1px solid hsl(var(--border));\n        background: hsl(var(--muted) / 0.3);\n        border-radius: calc(var(--radius) - 2px) calc(var(--radius) - 2px) 0 0;\n        flex-wrap: wrap;\n    }\n    .prose-editor .ql-container {\n        border: none;\n        font-family: inherit;\n        width: 100%;\n        max-width: 100%;\n    }\n    .prose-editor .ql-editor {\n        min-height: 150px;\n        font-size: 0.875rem;\n        line-height: 1.5rem;\n        width: 100%;\n        max-width: 100%;\n        word-wrap: break-word;\n        overflow-wrap: break-word;\n    }\n    .prose-editor .ql-editor.ql-blank::before {\n        color: hsl(var(--muted-foreground));\n        font-style: normal;\n    }\n    .prose-editor .ql-editor p {\n        margin-bottom: 0.75rem;\n    }\n    .prose-editor .ql-editor p:last-child {\n        margin-bottom: 0;\n    }\n    .prose-editor .ql-toolbar button:hover {\n        background: hsl(var(--accent));\n    }\n    .prose-editor .ql-toolbar button.ql-active {\n        background: hsl(var(--accent));\n        color: hsl(var(--accent-foreground));\n    }\n"}}),(0,se.jsxs)("div",{className:"space-y-6 w-full max-w-full overflow-hidden",children:[g&&o&&(0,se.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3 items-start",children:[(0,se.jsx)(Oy.A,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Your app has been updated"}),(0,se.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"workspace"===$.visibility_scope?"Your app has changed since the last submission. Submit to publish the new version.":"Your app has changed since the last submission. Once you submit and it's approved, the new version will be live."})]})]}),(0,se.jsxs)(Es,{className:"border border-slate-200 rounded-[14px]",children:[(0,se.jsx)(Ts,{className:"py-4 px-6 border-b border-slate-200",children:(0,se.jsx)(Is,{className:"text-lg font-semibold",children:"Basic info"})}),(0,se.jsxs)(Ls,{className:"space-y-8 pt-6 px-6 pb-6",children:[(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)(On,{htmlFor:"name",className:"text-sm font-medium",children:["Template Name",(0,se.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,se.jsx)(nl,{id:"name",value:$.name,onChange:e=>ne("name",e.target.value),placeholder:"Enter your app name",className:"w-[calc(50%-6px)]"})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)(On,{htmlFor:"description",className:"text-sm font-medium",children:["Description",(0,se.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tell users what makes your app worth trying."}),(0,se.jsx)("div",{className:"prose-editor w-full max-w-full pt-2",children:(0,se.jsx)(Ze(),{theme:"snow",value:$.description,onChange:e=>ne("description",e),placeholder:"Describe what your app does...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["blockquote","code-block"],["link"],["clean"]]},className:"bg-white rounded-md w-full",style:{minHeight:"150px",maxWidth:"100%"}})})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)(On,{children:["Select Categories",(0,se.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,se.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",$.categories.length," selected)"]})]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select categories that best describe your app to help users discover it. At least one category is required"}),(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-3 gap-y-2 py-3",children:oR.map(e=>(0,se.jsxs)("div",{className:"flex items-center space-x-2 min-w-0",children:[(0,se.jsx)(Os,{id:"category-".concat(e),checked:$.categories.includes(e),onCheckedChange:()=>(e=>{Z(t=>{const s=t.categories.includes(e)?t.categories.filter(t=>t!==e):[...t.categories,e],a=(0,ue.A)((0,ue.A)({},t),{},{categories:s});return ae(a),A(!0),a})})(e),className:"flex-shrink-0 shadow-sm border-slate-200"}),(0,se.jsx)(On,{htmlFor:"category-".concat(e),className:"text-sm font-normal cursor-pointer truncate",children:e})]},e))})]})]})]}),"public"===$.visibility_scope&&(0,se.jsxs)(Es,{className:"border border-slate-200 rounded-[14px]",children:[(0,se.jsx)(Ts,{className:"py-4 px-6 border-b border-slate-200",children:(0,se.jsx)(Is,{className:"text-lg font-semibold",children:"Template Pricing"})}),(0,se.jsxs)(Ls,{className:"space-y-8 pt-6 px-6 pb-6",children:[(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(On,{className:"text-sm font-medium",children:"Listing type"}),(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsxs)("button",{type:"button",onClick:()=>ne("is_paid",!1),className:"flex-1 p-3 border rounded-lg flex items-start gap-3 transition-all ".concat($.is_paid?"border-slate-200 hover:border-slate-300":"border-slate-900 bg-slate-50"),children:[(0,se.jsx)("div",{className:"mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center ".concat($.is_paid?"border-slate-300":"border-slate-900"),children:!$.is_paid&&(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-900"})}),(0,se.jsxs)("div",{className:"flex-1 text-left",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Free listing"}),(0,se.jsx)("div",{className:"text-sm text-slate-600 mt-1",children:"Offer your app for free"})]})]}),(0,se.jsxs)("button",{type:"button",onClick:()=>ne("is_paid",!0),disabled:!p,className:"flex-1 p-3 border rounded-lg flex items-start gap-3 transition-all relative ".concat($.is_paid?"border-slate-900 bg-slate-50":"border-slate-200 hover:border-slate-300"," ").concat(p?"":"cursor-not-allowed"),children:[(0,se.jsx)("div",{className:"mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center ".concat($.is_paid?"border-slate-900":"border-slate-300"," ").concat(p?"":"opacity-50"),children:$.is_paid&&(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-900"})}),(0,se.jsx)("div",{className:"absolute top-2 right-2 inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 rounded-lg border border-transparent",children:(0,se.jsx)("span",{className:"text-xs font-semibold text-blue-600",children:"Beta"})}),(0,se.jsxs)("div",{className:"flex-1 text-left",children:[(0,se.jsxs)("div",{className:"text-sm font-medium text-slate-900 flex items-center gap-2",children:[(0,se.jsx)("span",{className:p?"":"opacity-50",children:"Paid listing"}),(0,se.jsx)(qi,{delayDuration:100,children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:p?(0,se.jsx)("div",{className:"inline-flex relative z-0",children:(0,se.jsx)(nR,{size:"sm"})}):(0,se.jsx)("a",{href:"/billing",target:"_blank",className:"inline-flex hover:opacity-80 transition-opacity relative z-0",onClick:e=>e.stopPropagation(),children:(0,se.jsx)(nR,{size:"sm"})})}),(0,se.jsx)(Ki,{className:"max-w-xs",children:(0,se.jsx)("p",{children:"This feature is only available to users on the Starter plan and above."})})]})})]}),(0,se.jsx)("div",{className:"text-sm text-slate-600 mt-1 ".concat(p?"":"opacity-50"),children:"Sell your app for a chosen price"})]})]})]})]}),$.is_paid&&(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{className:"space-y-2 max-w-[calc(50%-6px)]",children:[(0,se.jsx)(On,{htmlFor:"price_usd",className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Define app price (USD)"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"w-full h-10 px-3 py-2 bg-white rounded-lg border border-slate-200 inline-flex justify-start items-center gap-2",children:[(0,se.jsx)("span",{className:"text-slate-500 text-sm font-normal font-base44 leading-tight",children:"$"}),(0,se.jsx)("input",{id:"price_usd",type:"number",min:"0.99",max:"1000",step:"0.01",placeholder:"9.99",value:$.price_usd,onChange:e=>{const t=e.target.value;if(""===t)ne("price_usd","");else{const e=parseFloat(t);if(!isNaN(e)){const t=Math.round(100*e)/100;ne("price_usd",t.toString())}}},onBlur:e=>{const t=e.target.value;if(t&&!isNaN(parseFloat(t))){const e=parseFloat(t).toFixed(2);ne("price_usd",e)}},className:"flex-1 text-sm font-normal font-base44 leading-tight bg-transparent border-none outline-none placeholder:text-slate-400"})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Tax is determined by the buyer's country and is tax-inclusive where applicable."})]})]})})]})]}),"workspace"===$.visibility_scope&&(0,se.jsx)(lR,{secretNames:X,sharedSecrets:$.shared_secrets,onConfigureClick:()=>Q(!0)}),(0,se.jsxs)(Es,{className:"border border-slate-200 rounded-[14px]",children:[(0,se.jsx)(Ts,{className:"py-4 px-6 border-b border-slate-200",children:(0,se.jsxs)("div",{children:[(0,se.jsx)(Is,{className:"text-lg font-semibold",children:"Template Screenshots"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Upload screenshots that showcase your product - at least one screenshot is required"})]})}),(null==c?void 0:c.slug)&&(0,se.jsxs)("div",{className:"bg-sky-100 px-6 py-3 flex items-center justify-between border-b border-slate-200",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("svg",{className:"w-4 h-4 text-slate-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),(0,se.jsx)("p",{className:"text-sm text-slate-900",children:"Go to your published app and take beautiful screenshots"})]}),(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>window.open(null!=c&&c.slug?"localhost"===window.location.hostname?"http://".concat(c.slug,".localhost:3000"):window.location.hostname.includes("base44.io")||window.location.hostname.includes("beta-base44")?"https://".concat(c.slug,".base44.io"):window.location.hostname.includes("ba11.me")?"https://".concat(c.slug,".ba11.me"):window.location.hostname.includes("ba22.me")?"https://".concat(c.slug,".ba22.me"):window.location.hostname.includes("ba33.me")?"https://".concat(c.slug,".ba33.me"):"https://".concat(c.slug,".base44.app"):"","_blank"),className:"flex items-center gap-2 border-slate-300 bg-white hover:bg-slate-50 h-8 text-xs",children:[(0,se.jsx)("span",{children:"Preview App"}),(0,se.jsx)(Rj.A,{className:"w-3 h-3"})]})]}),(0,se.jsx)(Ls,{className:"space-y-8 pt-6 px-6 pb-6",children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[$.screenshot_urls.map((e,t)=>(0,se.jsxs)("div",{className:"relative group cursor-move min-w-0 ".concat(S===t?"opacity-50":""," ").concat(T===t?"ring-2 ring-orange-400 ring-offset-2":""),draggable:!0,onDragStart:e=>((e,t)=>{E(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.outerHTML),e.dataTransfer.setDragImage(e.target,e.target.offsetWidth/2,e.target.offsetHeight/2)})(e,t),onDragOver:e=>((e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",I(t)})(e,t),onDragLeave:ce,onDrop:e=>de(e,t),onDragEnd:me,children:[0===t&&(0,se.jsx)("div",{className:"absolute top-2 left-2 z-10 bg-orange-500 text-white text-xs px-2 py-1 rounded font-medium shadow-sm",children:"Primary"}),(0,se.jsx)("img",{src:e,alt:"Screenshot ".concat(t+1),className:"w-full h-32 object-cover rounded-lg border shadow-sm",onError:e=>{e.target.src="/placeholder.png",e.target.onerror=null}}),(0,se.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg",children:(0,se.jsx)(zt,{size:"sm",variant:"destructive",onClick:()=>(e=>{const t=$.screenshot_urls.filter((t,s)=>s!==e);ne("screenshot_urls",t)})(t),className:"absolute bottom-2 right-2 h-8 w-8 p-0 bg-red-500 hover:bg-red-600 text-white shadow-lg",children:(0,se.jsx)(zy.A,{className:"h-4 w-4"})})}),(0,se.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-90 transition-opacity",children:(0,se.jsx)("div",{className:"text-white text-xs bg-black/70 px-2 py-1 rounded",children:"Drag to reorder"})})]},t)),0===$.screenshot_urls.length?(0,se.jsx)("div",{className:"col-span-full",children:(0,se.jsxs)("div",{className:"relative border border-dashed border-slate-300 rounded-lg p-6",children:[(0,se.jsx)(nl,{type:"file",accept:".jpg,.jpeg,.png,image/jpeg,image/png",multiple:!0,onChange:oe,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:_}),(0,se.jsx)("div",{className:"flex flex-col items-center justify-center text-center",children:_?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"w-6 h-6 text-gray-400 animate-spin mb-2"}),(0,se.jsx)("span",{className:"text-sm text-gray-500",children:"Uploading..."})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("p",{className:"text-blue-600 text-base font-normal mb-2",children:"Add Images"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Upload images of this product"})]})})]})}):(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(nl,{type:"file",accept:".jpg,.jpeg,.png,image/jpeg,image/png",multiple:!0,onChange:oe,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:_||$.screenshot_urls.length>=7}),(0,se.jsx)("div",{className:"w-full h-32 rounded-lg border-2 border-dashed border-gray-300 flex flex-col items-center justify-center transition-colors ".concat($.screenshot_urls.length>=7?"bg-gray-100 cursor-not-allowed":"bg-gray-50 hover:bg-gray-100 cursor-pointer"),children:_?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"w-6 h-6 text-gray-400 animate-spin mb-2"}),(0,se.jsx)("span",{className:"text-sm text-gray-500",children:"Uploading..."})]}):$.screenshot_urls.length>=7?(0,se.jsx)(se.Fragment,{children:(0,se.jsx)("span",{className:"text-sm text-gray-500",children:"Maximum screenshots reached (7)"})}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(op.A,{className:"w-6 h-6 text-gray-400 mb-2"}),(0,se.jsx)("span",{className:"text-sm text-gray-500",children:"Add Screenshot"})]})})]})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Tip: You can paste screenshots directly from your clipboard (Ctrl/Cmd + V) or drag and drop images to reorder them"})]})})]}),"public"===$.visibility_scope&&(0,se.jsxs)(Es,{className:"border border-slate-200 rounded-[14px]",children:[(0,se.jsx)(Ts,{className:"py-4 px-6 border-b border-slate-200",children:(0,se.jsx)(Is,{className:"text-lg font-semibold",children:"Terms & Conditions"})}),(0,se.jsxs)(Ls,{className:"space-y-3 pt-6 px-6 pb-6",children:[(0,se.jsxs)("div",{className:"flex items-start gap-2",children:[(0,se.jsx)(Os,{id:"marketplace_terms",checked:$.marketplace_terms_accepted,onCheckedChange:e=>ne("marketplace_terms_accepted",e),className:"mt-0.5"}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsxs)(On,{htmlFor:"marketplace_terms",className:"text-sm font-medium cursor-pointer",children:["I agree to the Base44 ",(0,se.jsx)("a",{href:"/marketplace/terms",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:"Terms and Marketplace Terms"}),"."]})})]}),(0,se.jsx)("div",{className:"pl-6",children:(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"I understand this App Template is provided by an independent Creator, who is solely responsible for its quality, support, and compliance. Base44 is not liable for App Templates."})})]})]})]}),(0,se.jsx)(ma,{open:P,onOpenChange:L,children:(0,se.jsxs)(fa,{className:"sm:max-w-md",children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:"Resubmit for Review"}),(0,se.jsx)(ya,{children:"Your listing will be submitted for review again. Once approved, it will be visible in the Templates Marketplace."})]}),(0,se.jsxs)(ba,{className:"flex gap-2",children:[(0,se.jsx)(zt,{variant:"outline",onClick:()=>L(!1),disabled:N,children:"Cancel"}),(0,se.jsx)(zt,{onClick:re,disabled:N,className:"bg-gray-900 hover:bg-gray-500 text-white",children:N?"Submitting...":"Submit for Review"})]})]})}),(0,se.jsx)(ma,{open:M,onOpenChange:()=>{},children:(0,se.jsx)(fa,{className:"sm:max-w-sm",onPointerDownOutside:e=>e.preventDefault(),children:(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center py-6 gap-4",children:[(0,se.jsx)(Fx.A,{className:"w-8 h-8 text-slate-600 animate-spin"}),(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("p",{className:"text-base font-medium text-slate-900",children:"Submitting your update..."}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"This may take a few seconds as we create a snapshot of your app."})]})]})})}),(0,se.jsx)(sR,{isOpen:D,onClose:()=>F(!1),mode:null!=O&&O.onboarding_completed?"edit":"create",initialData:O,onSuccess:()=>{(async()=>{try{const s=localStorage.getItem("token");if(!s)return;const a=await fetch("".concat((0,fe.Gt)(),"/marketplace-profile/me"),{headers:{Authorization:"Bearer ".concat(s)}}),n=await a.json();if(n.has_profile){var e,t;const s=n.profile,a={business_name:s.business_name||"",description:s.description||"",country:s.country||"us",website_url:s.website_url||"",linkedin_url:s.linkedin_url||"",twitter_url:s.twitter_url||"",wallet_id:(null===(e=s.checkout_info)||void 0===e?void 0:e.wallet_id)||"",checkout_service:(null===(t=s.checkout_info)||void 0===t?void 0:t.service)||"rewardful",terms_accepted:s.terms_accepted||!1,onboarding_completed:s.onboarding_completed||!1};U(a)}}catch(j){}})()}}),(0,se.jsx)(rR,{isOpen:J,onClose:()=>Q(!1),secretNames:X,sharedSecrets:$.shared_secrets,onSave:e=>{ne("shared_secrets",e)}})]})}function hR(e){let{onRouteChange:t,onSaveSuccess:s,initialVisibilityScope:a="public"}=e;const{app:n,listing:l,isLoading:r,error:i,createOrUpdateListing:o,submitUpdate:c,refetch:d,hasChanges:u}=DM();return r?(0,se.jsx)("div",{className:"p-6",children:"Loading..."}):i?(0,se.jsxs)("div",{className:"p-6 text-red-600",children:["Error: ",i.message]}):(0,se.jsx)(xR,{listingId:null==l?void 0:l.id,onRouteChange:t,onSaveSuccess:s,onSave:o,onSubmitUpdate:c,onRefetch:d,appHasChanges:u,app:n,initialVisibilityScope:a,listing:l||{name:"",description:Xg((null==n?void 0:n.user_description)||"<p></p>"),screenshot_urls:[],categories:cR((null==n?void 0:n.categories)||[]),is_private:!1}})}function pR(e){let{app:t,onCreateListing:s}=e;const{user:a}=wd(),{workspaces:n}=qd(),[l,r]=(0,Y.useState)(null),i=null==t?void 0:t.purchase_from_id,o=!(null==t||!t.last_deployed_at),c=(()=>{if(null==t||!t.organization_id||!n||!a)return!1;const e=n.find(e=>e.id===t.organization_id);if(!e)return!1;if(e.is_personal||e.id===a.personal_organization_id)return!1;return"member"===(e.user_role||e.role||"member")})(),{title:d,description:u,showSelection:m}=i?{title:"This app cannot be listed",description:"This app was started from a template and cannot be re-listed. Only apps that you created can be added to the templates marketplace.",showSelection:!1}:c?{title:"Admin Access Required",description:"Only workspace administrators can create and manage app template listings. Please contact your workspace admin if you'd like to list this app in the public marketplace or as a workspace template.",showSelection:!1}:o?{title:"Turn your app into a reusable template",description:"Make it easy for you and others to reuse your setup and quickly build their own apps.",showSelection:!0}:{title:"Ready to create a template?",description:"Before you can turn this application into a template, it needs to be live. Click Publish in the top right corner to deploy, then return here to set it up.",showSelection:!1};return(0,se.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-between min-h-[600px] py-12 px-6 bg-slate-50/50",children:[(0,se.jsxs)("div",{className:"flex-1 flex flex-col gap-10 items-center justify-center w-full max-w-4xl",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-3 items-center text-center w-full px-6",children:[(0,se.jsx)("h2",{className:"text-2xl font-medium text-slate-900",children:d}),u&&(0,se.jsx)("p",{className:"text-base text-slate-500 max-w-[544px] leading-relaxed",children:u})]}),m?(0,se.jsxs)("div",{className:"flex flex-col items-center gap-10 w-full max-w-3xl",children:[(0,se.jsxs)("div",{className:"w-full bg-white rounded-2xl p-8 shadow-sm border border-slate-100",children:[(0,se.jsx)("h3",{className:"text-base text-slate-600 mb-6 font-normal",children:"Which type of template do you want to create?"}),(0,se.jsxs)(Nw,{value:l||"",onValueChange:e=>r(e),className:"grid grid-cols-1 sm:grid-cols-2 gap-5 w-full",children:[(0,se.jsxs)("label",{htmlFor:"public",className:de("relative p-6 rounded-xl border-2 transition-all cursor-pointer flex flex-col items-start gap-4 h-full bg-white","public"===l?"border-slate-900":"border-slate-200"),children:[(0,se.jsx)(ww,{value:"public",id:"public",className:"sr-only"}),"public"===l&&(0,se.jsx)("div",{className:"absolute -top-2 -right-2 bg-slate-900 text-white rounded-full p-0.5",children:(0,se.jsx)(Ds.A,{className:"w-3 h-3",strokeWidth:3})}),(0,se.jsx)("div",{className:"p-0",children:(0,se.jsx)(KP.A,{className:"w-6 h-6 text-slate-600",strokeWidth:1.5})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-medium text-slate-900 mb-2 text-base",children:"Public template"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 leading-relaxed",children:"Share this to all Base44 users. Choose whether to offer it for free or sell it."})]})]}),(0,se.jsxs)("label",{htmlFor:"workspace",className:de("relative p-6 rounded-xl border-2 transition-all cursor-pointer flex flex-col items-start gap-4 h-full bg-white","workspace"===l?"border-slate-900":"border-slate-200"),children:[(0,se.jsx)(ww,{value:"workspace",id:"workspace",className:"sr-only"}),"workspace"===l&&(0,se.jsx)("div",{className:"absolute -top-2 -right-2 bg-slate-900 text-white rounded-full p-0.5",children:(0,se.jsx)(Ds.A,{className:"w-3 h-3",strokeWidth:3})}),(0,se.jsx)("div",{className:"p-0",children:(0,se.jsx)(Zg.A,{className:"w-6 h-6 text-slate-600",strokeWidth:1.5})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-medium text-slate-900 mb-2 text-base",children:"Workspace-only"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 leading-relaxed",children:"Share this template exclusively with your workspace members."})]})]})]})]}),(0,se.jsx)(Bx,{onClick:()=>l&&s(l),disabled:!l,className:"h-10 px-8 bg-slate-900 hover:bg-slate-800 text-white font-medium text-sm shadow-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed rounded-lg",children:"Create"})]}):(0,se.jsx)("div",{className:"flex flex-col gap-3 items-center px-6"})]}),m&&(0,se.jsxs)("div",{className:"mt-auto pt-8 flex items-center justify-center gap-4 text-sm",children:[(0,se.jsx)("a",{href:"/app-templates",target:"_blank",className:"text-blue-600 hover:text-blue-700 hover:underline",children:"View templates catalog"}),(0,se.jsx)("span",{className:"text-slate-300",children:"|"}),(0,se.jsx)("a",{href:"https://docs.base44.com/Getting-Started/App-templates",target:"_blank",className:"text-blue-600 hover:text-blue-700 hover:underline",children:"Learn more about templates"})]})]})}const gR=class{static async getSellerTransactions(){let{app_id:e,limit:t=20,offset:s=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=localStorage.getItem("token");if(!a)throw new Error("No authentication token found");const n=new URLSearchParams;n.append("limit",t),n.append("offset",s),e&&n.append("app_id",e);const l=await fetch("".concat((0,fe.Gt)(),"/marketplace/seller/transactions?").concat(n.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!l.ok){const e=await l.json();throw new Error(e.detail||"Failed to fetch transactions")}return await l.json()}};function fR(e){var t;let{listing:s,onEditListing:a,onListingRemoved:n}=e;const{app:l}=lp(),{hasPendingUpdate:r,hasPendingSnapshot:i,hasPendingMetadata:o}=DM(),[c,d]=(0,Y.useState)([]),[u,m]=(0,Y.useState)(!0),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)({totalPurchases:0,totalRevenue:0}),f=(0,Y.useCallback)(async()=>{try{m(!0);const e=await gR.getSellerTransactions({app_id:l.id,limit:50,offset:0});d(e.transactions||[]);const t=e.transactions.filter(e=>{var t;return"completed"===(null===(t=e.payment_info)||void 0===t?void 0:t.status)});g({totalPurchases:t.length,totalRevenue:t.reduce((e,t)=>e+t.pricing_info.seller_earnings_usd,0)})}catch(e){}finally{m(!1)}},[l.id]);(0,Y.useEffect)(()=>{null!=l&&l.id&&f()},[null==l?void 0:l.id,f]);const v=e=>{try{return(0,z_.GP)(new Date(e),"MMMM d, yyyy")}catch(t){return"N/A"}},b=e=>{switch(e){case"completed":return"text-green-600";case"pending":return"text-yellow-600";case"failed":return"text-red-600";default:return"text-gray-500"}},j="approved"===s.status&&!s.archived,y="rejected"===s.status&&!s.archived;return(0,se.jsxs)("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto p-6",children:[(0,se.jsx)("div",{className:"flex items-center justify-between",children:(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900",children:"App Listing"})}),s.is_paid&&(0,se.jsxs)("div",{className:"bg-neutral-50 border border-slate-200 rounded-lg p-3 flex gap-2 items-start",children:[(0,se.jsx)("div",{className:"flex items-center justify-center shrink-0 w-5 h-5",children:(0,se.jsx)(Oy.A,{className:"w-4 h-4 text-slate-900"})}),(0,se.jsx)("p",{className:"text-sm text-slate-900 leading-5",children:"Payouts will be available in a few weeks. We'll email you once you can start onboarding to the payment platform."})]}),(0,se.jsxs)(Bv,{className:"border border-slate-200 rounded-[14px]",children:[(0,se.jsx)(zv,{className:"py-4 px-6 border-b border-slate-200",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)("h2",{className:"text-lg font-medium text-slate-900",children:s.name}),(null===(t=s.pending_metadata)||void 0===t?void 0:t.name)&&s.pending_metadata.name!==s.name&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(jS.A,{className:"w-4 h-4 text-orange-500 cursor-help"})}),(0,se.jsx)(pp,{className:"w-[200px]",children:(0,se.jsxs)("p",{className:"text-sm text-wrap",children:['Pending name change. Once approved, your app will be listed as "',s.pending_metadata.name,'"']})})]})})]}),((e,t,s)=>{if(t)return(0,se.jsx)(gk,{className:"bg-gray-400 text-white pointer-events-none",children:"Archived"});switch(e){case"approved":return(0,se.jsx)(gk,{className:"bg-green-500 text-white pointer-events-none",children:"Published"});case"pending":return(0,se.jsx)(gk,{className:"bg-yellow-200 text-yellow-700 pointer-events-none",children:"Pending"});case"rejected":return s?(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(gk,{className:"bg-red-500 text-white cursor-help",children:"Rejected"})}),(0,se.jsxs)(pp,{className:"max-w-[300px]",children:[(0,se.jsx)("p",{className:"text-sm font-medium mb-1",children:"Rejection reason:"}),(0,se.jsx)("p",{className:"text-sm text-slate-300 whitespace-pre-wrap",children:s})]})]})}):(0,se.jsx)(gk,{className:"bg-red-500 text-white pointer-events-none",children:"Rejected"});default:return(0,se.jsx)(gk,{className:"bg-gray-200 text-gray-700 pointer-events-none",children:"Draft"})}})(s.status,s.archived,s.rejected_reason),r&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(gk,{className:"bg-orange-100 text-orange-700 cursor-help",children:"Update Pending Review"})}),(0,se.jsx)(pp,{className:"max-w-[250px]",children:(0,se.jsx)("p",{className:"text-sm",children:i&&o?"Both app changes and listing details are pending review.":i?"App changes are pending review.":"Listing details changes are pending review."})})]})})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[j&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("span",{children:(0,se.jsx)(Bx,{variant:"default",size:"sm",onClick:a,disabled:r,className:"bg-slate-900 hover:bg-slate-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Submit Update"})})}),r&&(0,se.jsx)(pp,{className:"w-[200px]",children:(0,se.jsx)("p",{className:"text-sm text-wrap",children:"You cannot submit an update while your app is pending review"})})]})}),y&&(0,se.jsx)(Bx,{variant:"default",size:"sm",onClick:a,className:"bg-slate-900 hover:bg-slate-700 text-white",children:"Edit Listing"}),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"outline",size:"sm",className:"w-9 h-9 p-0",children:(0,se.jsx)(Nv.A,{className:"w-4 h-4"})})}),(0,se.jsxs)(Aj,{align:"end",children:[(0,se.jsx)(Sj,{onClick:()=>window.open("/app-templates?category=my-apps","_blank"),children:"See on App Templates"}),(0,se.jsx)(Sj,{onClick:async()=>{if(window.confirm("Are you sure you want to remove this listing? This action will remove it from the App templates.")){h(!0);try{await Gg.archiveItem(null==s?void 0:s.id),so({title:"Success",description:"Listing removed from catalog successfully"}),n&&n()}catch(e){so({title:"Error",description:e.message||"Failed to remove listing from catalog",variant:"destructive"})}finally{h(!1)}}},disabled:x,className:"text-red-600 focus:text-red-600",children:x?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Removing..."]}):"Remove from App Templates"})]})]})]})]})}),(0,se.jsx)(Wv,{className:"p-6 space-y-8",children:"rejected"===s.status&&s.rejected_reason?(0,se.jsxs)("div",{className:"space-y-3 whitespace-pre-wrap text-sm leading-5",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{className:"font-medium text-slate-900",children:"Rejection reason:"}),(0,se.jsx)("p",{className:"font-normal text-gray-600",children:s.rejected_reason})]}),(0,se.jsx)("p",{className:"font-normal text-slate-900",children:"Please update your listing, and we'll review it once the changes are made."})]}):"approved"===s.status&&s.rejected_reason&&!r?(0,se.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 space-y-2",children:[(0,se.jsx)("p",{className:"font-medium text-orange-800",children:"Your last update was declined"}),(0,se.jsx)("p",{className:"text-sm text-orange-700 whitespace-pre-wrap",children:s.rejected_reason}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Your listing remains live with the previously approved version. You can submit a new update with the requested changes."})]}):(0,se.jsxs)(se.Fragment,{children:[s.is_paid&&(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsx)(Bv,{className:"border border-slate-200 rounded-lg",children:(0,se.jsxs)(Wv,{className:"p-4 space-y-2",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Purchases"}),(0,se.jsx)("div",{children:(0,se.jsx)("p",{className:"text-2xl font-semibold text-slate-900",children:p.totalPurchases})})]})}),(0,se.jsx)(Bv,{className:"border border-slate-200 rounded-lg",children:(0,se.jsxs)(Wv,{className:"p-4 space-y-2",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Your Earnings"}),(0,se.jsx)("div",{children:(0,se.jsxs)("p",{className:"text-2xl font-semibold text-slate-900",children:["$",p.totalRevenue.toFixed(2)]})})]})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,se.jsx)("span",{className:"text-slate-600",children:"Published date"}),(0,se.jsx)("span",{className:"text-slate-900",children:s.created_date?v(s.created_date):"Not published"})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,se.jsx)("span",{className:"text-slate-600",children:"Last update"}),(0,se.jsx)("span",{className:"text-slate-900",children:s.updated_date?v(s.updated_date):"N/A"})]}),s.is_paid&&(0,se.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,se.jsx)("span",{className:"text-slate-600",children:"App price"}),(0,se.jsxs)("span",{className:"text-slate-900",children:["$",s.price_usd]})]})]})]})})]}),s.is_paid&&(0,se.jsxs)(Bv,{className:"border border-slate-200 rounded-[14px] overflow-hidden",children:[(0,se.jsx)(zv,{className:"py-4 px-6 border-b border-slate-200",children:(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Recent Transactions"})}),(0,se.jsx)(Wv,{className:"p-0",children:u?(0,se.jsx)("div",{className:"p-6 text-center text-slate-600",children:"Loading transactions..."}):0===c.length?(0,se.jsx)("div",{className:"p-6 text-center text-slate-600",children:"No transactions yet. Your sales will appear here."}):(0,se.jsx)("div",{className:"overflow-x-auto",children:(0,se.jsxs)("table",{className:"w-full",children:[(0,se.jsx)("thead",{className:"bg-slate-50",children:(0,se.jsxs)("tr",{children:[(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-600 uppercase tracking-wider",children:"Date"}),(0,se.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-600 uppercase tracking-wider",children:"Subtotal"}),(0,se.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-600 uppercase tracking-wider",children:"Tax"}),(0,se.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-600 uppercase tracking-wider",children:"Total Paid"}),(0,se.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-600 uppercase tracking-wider",children:(0,se.jsx)("span",{className:"text-slate-900 font-semibold",children:"Your Earnings"})}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-600 uppercase tracking-wider",children:"Status"})]})}),(0,se.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:c.map(e=>{const t=e.pricing_info,s=e.payment_info,a=t.tax_amount_usd>0;return(0,se.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:v((null==s?void 0:s.completed_at)||e.created_date)}),(0,se.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900 text-right",children:["$",t.subtotal_usd.toFixed(2)]}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 text-right",children:a?"$".concat(t.tax_amount_usd.toFixed(2)):"\u2014"}),(0,se.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900 text-right font-medium",children:["$",t.price_usd.toFixed(2)]}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right",children:(0,se.jsxs)("span",{className:"text-slate-900 font-semibold",children:["$",t.seller_earnings_usd.toFixed(2)]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsx)("span",{className:"text-sm font-medium capitalize ".concat(b((null==s?void 0:s.status)||"pending")),children:(null==s?void 0:s.status)||"pending"})})]},e.id)})})]})})})]})]})}var vR=s(85354);class bR extends te.H{getBaseURL(){return"/workspace"}getAppSettings(e){return this.axios.get("/".concat(e,"/app-settings"))}updateAppSettings(e,t){return this.axios.put("/".concat(e,"/app-settings"),t)}}const jR=new bR;let yR=function(e){return e.OWNER="owner",e.ADMIN="admin",e.MEMBER="member",e}({});const NR=e=>e===yR.OWNER||e===yR.ADMIN;function wR(){const{app:e}=lp(),{user:t}=wd(),{workspaces:s}=qd(),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{(async()=>{if(null==e||!e.organization_id||!s||!t)return n(null),o(null),d(null),void r(!1);const a=s.find(t=>t.id===e.organization_id);if(!a)return n(null),o(null),d(null),void r(!1);o(a);const l=a.user_role||a.role||yR.MEMBER;if(d(l),a.is_personal||a.id===t.personal_organization_id)n(null);else try{const t=await jR.getAppSettings(e.organization_id);n((null==t?void 0:t.settings)||null)}catch(i){n(null)}r(!1)})()},[null==e?void 0:e.organization_id,s,t]);return{settings:a,workspace:i,userRole:c,isLoading:l,isEnterpriseWorkspace:null!==i&&!0===i.is_enterprise}}function _R(e,t,s,a){if(NR(s))return["private_with_login","workspace_with_login","public_with_login","public_without_login"];if(!a||!t)return["private_with_login","workspace_with_login","public_with_login","public_without_login"];const n=["private_with_login","workspace_with_login","public_with_login","public_without_login"];return t.members_can_create_public_apps?n:n.filter(e=>"public_with_login"!==e&&"public_without_login"!==e)}const kR=["className","children"],CR=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,kR);return(0,se.jsx)(it.Item,(0,ue.A)((0,ue.A)({ref:t,className:de("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-3 pr-2 text-sm outline-none focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s)},n),{},{children:(0,se.jsx)(it.ItemText,{children:a})}))});CR.displayName="SelectItemNoCheck";const AR=e=>{let{options:t=[],value:s,onValueChange:a,placeholder:n="Select option",disabled:l=!1,className:r}=e;const i=t.find(e=>e.value===s);return(0,se.jsxs)(Wf,{value:s,onValueChange:a,disabled:l,children:[(0,se.jsx)(Yf,{className:de("w-full h-10 px-3 py-2 text-sm","border border-slate-200 rounded-md","bg-white","hover:border-slate-300","focus:border-slate-400 focus:ring-1 focus:ring-slate-400","disabled:bg-slate-50 disabled:text-slate-400 disabled:cursor-not-allowed","transition-colors duration-200",r),children:(0,se.jsx)(qf,{children:i?(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[i.icon&&(0,se.jsx)(i.icon,{className:"w-4 h-4 flex-shrink-0 text-slate-500"}),(0,se.jsx)("span",{className:"truncate text-sm font-medium text-slate-900",children:i.label})]}):(0,se.jsx)("span",{className:"text-slate-400 text-sm",children:n})})}),(0,se.jsx)($f,{className:"bg-white border border-slate-200 rounded-md shadow-lg",children:t.map(e=>(0,se.jsx)(CR,{value:e.value,className:de("py-2 cursor-pointer","hover:bg-slate-50 focus:bg-slate-50","data-[state=checked]:bg-slate-100"),children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[e.icon&&(0,se.jsx)(e.icon,{className:"w-4 h-4 flex-shrink-0 text-slate-500"}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.label})]})},e.value))})]})},SR=e=>{let{checked:t,onCheckedChange:s,label:a,disabled:n=!1,className:l,checkboxClassName:r,labelClassName:i}=e;return(0,se.jsxs)("div",{className:de("flex items-center space-x-2",!n&&"hover:opacity-70 cursor-pointer",n&&"cursor-not-allowed","transition-opacity duration-200",l),onClick:()=>{!n&&s&&s(!t)},children:[(0,se.jsx)(E_,{checked:t,onCheckedChange:()=>{},disabled:n,className:de("h-4 w-4","border-slate-300 rounded-sm","data-[state=checked]:bg-slate-900 data-[state=checked]:border-slate-900","data-[state=checked]:text-white","focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2","disabled:opacity-50","transition-colors duration-200","pointer-events-none",r)}),(0,se.jsx)(aN,{className:de("text-sm text-slate-700","font-normal","select-none","peer-disabled:opacity-50","pointer-events-none",i),children:a})]})},ER=e=>[{value:"private",label:"Private",icon:Vc.A},...e?[{value:"workspace",label:"Workspace",icon:eb.A}]:[],{value:"public",label:"Public",icon:KP.A}];function TR(e,t){return"private"===e?"private_with_login":"workspace"===e?"workspace_with_login":"public"===e?t?"public_with_login":"public_without_login":"private_with_login"}function IR(e){let{value:t,onValueChange:s,disabled:a=!1,showWorkspace:n=!0,className:l,allowedOptions:r}=e;const i=function(e){switch(e){case"private_with_login":default:return"private";case"workspace_with_login":return"workspace";case"public_with_login":case"public_without_login":return"public"}}(t),o="public_without_login"!==t;let c=ER(n);if(r&&r.length>0){const e=new Set;r.includes("public_without_login"),r.includes("public_with_login");r.some(e=>e.startsWith("private"))&&e.add("private"),r.some(e=>e.startsWith("workspace"))&&e.add("workspace"),r.some(e=>e.startsWith("public"))&&e.add("public"),c=c.filter(t=>e.has(t.value)),e.has("public")}const d=a||"public"!==i||r&&"public"===i&&!r.includes("public_without_login");return(0,se.jsxs)("div",{className:de("space-y-2",l),children:[(0,se.jsx)(AR,{options:c,value:i,onValueChange:e=>{let t=!0;"public"===e&&(t=!(!r||r.includes("public_without_login"))||o);const a=TR(e,t);s(a)},disabled:a,placeholder:"Select visibility"}),(0,se.jsx)(SR,{checked:o,onCheckedChange:e=>{if("public"===i){if(!e&&r&&!r.includes("public_without_login"))return;const t=TR(i,e);s(t)}},disabled:d,label:"Require login to access"})]})}const PR=["className","variant"],LR=["className"],MR=["className"],RR=(0,ft.cva)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),DR=Y.forwardRef((e,t)=>{let{className:s,variant:a}=e,n=(0,Nt.A)(e,PR);return(0,se.jsx)("div",(0,ue.A)({ref:t,role:"alert",className:de(RR({variant:a}),s)},n))});DR.displayName="Alert";const FR=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,LR);return(0,se.jsx)("h5",(0,ue.A)({ref:t,className:de("mb-1 font-medium leading-none tracking-tight",s)},a))});FR.displayName="AlertTitle";const OR=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,MR);return(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("text-sm [&_p]:leading-relaxed",s)},a))});OR.displayName="AlertDescription";class UR extends te.H{getBaseURL(){return"/apps"}activateBackendFunctions(e){return this.axios.post("/".concat(e,"/activate-backend-functions"))}getBackendFunctionsLogs(e,t,s){return this.axios.get("/".concat(e,"/functions-mgmt/").concat(t,"/logs"),{params:s})}}const BR=new UR,zR=()=>(0,se.jsxs)(Dt,{variant:"warning",className:"bg-gray-50 border-gray-200",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-gray-500"}),(0,se.jsx)(Ft,{className:"text-gray-800",children:"Premium Feature"}),(0,se.jsxs)(Ot,{className:"text-gray-600",children:["Backend functions are available only for Builder tier and above.",(0,se.jsx)("a",{href:"/billing",className:"ml-1 underline font-medium text-gray-700 hover:text-gray-900",children:"Upgrade your plan"})," to unlock this feature."]})]}),HR=()=>{const{app:e}=lp();return!1===(null==e?void 0:e.is_managed_source_code)},VR=e=>{let{sourceCodeState:t,children:s}=e;const a=HR();return("managed"===t?!a:a)?(0,se.jsx)(se.Fragment,{children:s}):null};const WR=function(e){let{onRouteChange:t}=e;const{user:s}=wd(),{app:a,updateApp:n,pageNames:l,setDataEnv:r}=lp(),i=Array.from(null!=l?l:[]),{isInSharedWorkspace:o}=pS(),{settings:c,userRole:d,isEnterpriseWorkspace:u}=wR(),m=(0,J.Zp)(),x=(0,J.zy)(),{toast:h}=ao(),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(!1),[b,j]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)(!1),[A,S]=(0,Y.useState)(null),E=(0,Y.useRef)(null),T=(0,Y.useRef)(null),I=(0,Y.useRef)(null),P=(0,Y.useRef)(null),L=(0,Y.useRef)(null),M=(0,Y.useRef)(null),R=(0,Y.useRef)(null),D=(0,Y.useRef)(null),F=(0,Y.useRef)(null),O=(0,Y.useRef)(null),U=Bj(s),B=zj(s),z=a.using_sandbox||$p(s.platform_role);(0,Y.useEffect)(()=>{const e=new URLSearchParams(x.search).get("selectedParam");if(e){S(e);let t=null;switch(e){case"main-page":t=E;break;case"visibility":t=T;break;case"branding-badge":t=I;break;case"hide-created-by":t=P;break;case"enable-agents":t=L;break;case"dev-environment":t=M;break;case"clone-app":t=R;break;case"backend-functions":t=D;break;case"delete-app":t=F;break;case"admin-controls":t=O}t&&t.current&&setTimeout(()=>{t.current.scrollIntoView({behavior:"smooth",block:"center"})},300)}},[x.search]);const H=async()=>{try{await zc.delete(a.id),h({title:"Success",description:"App deleted successfully"}),m("/")}catch(e){h({title:"Error",description:"Failed to delete app",variant:"destructive"})}},V=e=>A===e?"selected-section p-4 rounded-md":"";return(0,se.jsxs)(lL,{title:"App Settings",children:[(0,se.jsx)("style",{jsx:!0,global:!0,children:"\n                .selected-section {\n                    position: relative;\n                    border-left: 4px solid #334155;\n                    background-color: rgba(241, 245, 249, 0.7);\n                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\n                    transition: all 0.4s ease;\n                    padding-left: 16px !important;\n                    padding-top: 14px !important;\n                    padding-bottom: 14px !important;\n                    margin: 4px 0 !important;\n                    border-radius: 4px;\n                }\n\n                /* Left border with animated glow */\n                .selected-section::before {\n                    content: '';\n                    position: absolute;\n                    left: -4px;\n                    top: 0;\n                    width: 4px;\n                    height: 100%;\n                    background: linear-gradient(to bottom, #0f766e, #334155);\n                    box-shadow: 0 0 12px rgba(15, 118, 110, 0.5);\n                    animation: border-pulse 2.5s infinite ease-in-out;\n                    z-index: 1;\n                }\n                \n                /* Light effect */\n                .selected-section::after {\n                    content: '';\n                    position: absolute;\n                    left: 0;\n                    top: 0;\n                    height: 100%;\n                    width: 100%;\n                    background: linear-gradient(to right, rgba(15, 118, 110, 0.08), transparent 50%);\n                    animation: light-pulse 2.5s infinite ease-in-out;\n                    pointer-events: none;\n                    border-radius: 4px;\n                }\n                \n                @keyframes border-pulse {\n                    0%, 100% {\n                        box-shadow: 0 0 8px rgba(15, 118, 110, 0.4);\n                    }\n                    50% {\n                        box-shadow: 0 0 20px rgba(15, 118, 110, 0.7);\n                    }\n                }\n                \n                @keyframes light-pulse {\n                    0%, 100% {\n                        opacity: 0.3;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.05), transparent 50%);\n                    }\n                    50% {\n                        opacity: 0.7;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.12), transparent 60%);\n                    }\n                }\n            "}),(0,se.jsx)(qR,{}),(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{className:"border-b border-gray-100",children:(0,se.jsx)(Hv,{className:"text-gray-800",children:"General Settings"})}),(0,se.jsxs)(Wv,{className:"space-y-6 pt-6",children:[(0,se.jsxs)(VR,{sourceCodeState:"managed",children:[(0,se.jsxs)("div",{ref:E,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("main-page")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Main Page"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set the default landing page for your app"})]}),(0,se.jsx)("div",{className:"w-full sm:w-64",children:(0,se.jsxs)(br,{value:a.main_page||"",onValueChange:async e=>{try{n({main_page:e}),null!=a&&a.using_sandbox&&await Gu.updateMainPage(a.id,e),h({title:"Success",description:"Main page updated successfully"})}catch(t){h({title:"Error",description:"Failed to update main page",variant:"destructive"})}},children:[(0,se.jsx)(Nr,{children:(0,se.jsx)(yr,{placeholder:"Select main page"})}),(0,se.jsx)(kr,{children:i.map(e=>(0,se.jsx)(Ar,{value:e,children:e},e))})]})})]}),(0,se.jsx)(Tr,{})]}),(0,se.jsxs)("div",{ref:T,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("visibility")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"App Visibility"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Control who can access your application"})]}),(0,se.jsx)("div",{className:"w-full sm:w-64",children:(0,se.jsx)(IR,{value:a.public_settings||"private_with_login",onValueChange:async e=>{v(!0);try{await n({public_settings:e}),h({title:"Success",description:"App visibility updated successfully"})}catch(t){h({title:"Error",description:"Failed to update app visibility",variant:"destructive"})}finally{v(!1)}},disabled:f,showWorkspace:o,allowedOptions:_R(a.public_settings,c,d,u)})})]}),(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{ref:I,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("platform-badge")),children:[(0,se.jsxs)("div",{className:"flex-grow space-y-1",children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Platform Badge"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:'Show or hide the "Edit with Base44" badge on your app.'}),"free"===s.subscription_tier&&(0,se.jsxs)("p",{className:"text-xs text-orange-500 pt-1",children:[(0,se.jsx)(Vc.A,{className:"h-3 w-3 inline-block mr-1 relative -top-px"}),"Available only for paying users.",(0,se.jsx)("a",{href:"/billing",className:"ml-1 underline font-medium hover:text-orange-700",children:"Upgrade now"})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-2 sm:mt-0",children:[(0,se.jsx)(ei,{id:"platform-badge-switch",checked:!0===a.is_remixable,onCheckedChange:async e=>{j(!0);try{n({is_remixable:e}),h({title:"Success",description:"Platform badge will be ".concat(e?"visible":"hidden",".")})}catch(t){h({title:"Error",description:"Failed to update platform badge visibility.",variant:"destructive"})}finally{j(!1)}},disabled:"free"===s.subscription_tier||b,"aria-label":"Toggle platform badge visibility"}),(0,se.jsx)(On,{htmlFor:"platform-badge-switch",className:"text-sm text-muted-foreground",children:!0===a.is_remixable?"Visible":"Hidden"})]})]}),(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{ref:P,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("hide-created-by")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Hide Entity Creator"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:'Hide who created each record in your app\'s data tables. When enabled, the "created by" field will not be shown to users.'})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-2 sm:mt-0",children:[(0,se.jsx)(ei,{id:"hide-created-by-switch",checked:!0===a.hide_entity_created_by,onCheckedChange:async e=>{N(!0);try{n({hide_entity_created_by:e}),h({title:"Success",description:"Entity creator information will be ".concat(e?"hidden":"visible"," in your app.")})}catch(t){h({title:"Error",description:"Failed to update entity creator visibility.",variant:"destructive"})}finally{N(!1)}},disabled:y,"aria-label":"Toggle hide entity creator"}),(0,se.jsx)(On,{htmlFor:"hide-created-by-switch",className:"text-sm text-muted-foreground",children:!0===a.hide_entity_created_by?"Hidden":"Visible"})]})]}),(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{ref:L,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("enable-agents")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsx)("h3",{className:"text-sm font-medium",children:"AI Agents"})}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Build AI agents into your app using Base44's AI agents infrastructure"})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-2 sm:mt-0",children:[(0,se.jsx)(ei,{id:"enable-agents-switch",checked:!0===a.agents_enabled,onCheckedChange:async e=>{_(!0);try{await n({agents_enabled:e}),h({title:"Success",description:"AI agents ".concat(e?"enabled":"disabled"," successfully.")})}catch(t){h({title:"Error",description:"Failed to update AI agents setting.",variant:"destructive"})}finally{_(!1)}},disabled:w,"aria-label":"Toggle AI agents"}),(0,se.jsx)(On,{htmlFor:"enable-agents-switch",className:"text-sm text-muted-foreground",children:!0===a.agents_enabled?"Enabled":"Disabled"})]})]}),a.agents_enabled&&(0,se.jsxs)(DR,{className:"bg-blue-50 border-blue-200",children:[(0,se.jsx)(wP.A,{className:"h-4 w-4 text-blue-600"}),(0,se.jsx)(FR,{className:"text-blue-800",children:"AI Agents Enabled"}),(0,se.jsx)(OR,{className:"text-blue-700",children:"Your app now has access to Base44's AI agents infrastructure. You can create intelligent agents that can help users with various tasks, answer questions, and interact with your app's data. Use the chat to build and configure your agents."})]}),(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{ref:M,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("dev-environment")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Test Data"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Use test data to safely test changes without affecting live data."}),!B&&(0,se.jsxs)("p",{className:"text-xs text-orange-500 pt-1",children:[(0,se.jsx)(Vc.A,{className:"h-3 w-3 inline-block mr-1 relative -top-px"}),"Available only for Builder plan and above.",(0,se.jsx)("a",{href:"/billing",className:"ml-1 underline font-medium hover:text-orange-700",children:"Upgrade now"})]})]}),(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-2 sm:mt-0",children:[(0,se.jsx)(ei,{id:"dev-environment-switch",checked:!0===a.dev_environment_enabled,onCheckedChange:async e=>{C(!0);try{await n({dev_environment_enabled:e}),e&&r("dev"),Tu("Dev Environment Toggled",{app_id:a.id,enabled:e}),h({title:"Success",description:"Dev environment ".concat(e?"enabled":"disabled"," successfully.")})}catch(t){h({title:"Error",description:"Failed to update dev environment setting.",variant:"destructive"})}finally{C(!1)}},disabled:!B||k,"aria-label":"Toggle dev environment"}),(0,se.jsx)(On,{htmlFor:"dev-environment-switch",className:"text-sm text-muted-foreground",children:!0===a.dev_environment_enabled?"Enabled":"Disabled"})]})}),(0,se.jsx)(Ki,{className:"max-w-xs",children:(0,se.jsx)("p",{children:"To use this, you'll need a newer version of your app. Just make any change\u2014send a message to the AI, tweak some code, or use the visual editor\u2014and you're good to go."})})]})]}),(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{ref:R,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("clone-app")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Clone App"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create a duplicate of this app"})]}),(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("span",{tabIndex:0,children:(0,se.jsxs)(zt,{onClick:async()=>{gd("/remix-app/".concat(a.id,"?clone_history=true"))},variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700",disabled:!z,children:[(0,se.jsx)(ob.A,{className:"mr-2 h-4 w-4"}),"Create Copy"]})})}),!z&&(0,se.jsxs)(Ki,{children:[(0,se.jsx)("p",{children:"You can't clone an app on the old infrastructure."}),(0,se.jsx)("p",{children:"Update infrastructure to clone your app."})]})]})]}),(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{ref:D,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("backend-functions")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Backend Functions"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enable server-side functionality \u2022 Recommended for developers"})]}),U?(0,se.jsxs)(zt,{onClick:async()=>{try{g(!0),await BR.activateBackendFunctions(a.id),h({title:"Success",description:"Backend functions activated successfully. Prompt the chat to build your backend functions."})}catch(e){h({title:"Error",description:"Failed to activate backend functions",variant:"destructive"})}finally{g(!1)}},disabled:p||!!a.has_backend_functions_enabled,variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700",children:[(0,se.jsx)(Jv.A,{className:"mr-2 h-4 w-4"}),p?"Activating...":a.has_backend_functions_enabled?"Activated":"Activate"]}):(0,se.jsxs)(zt,{variant:"outline",className:"flex items-center text-gray-500 border-gray-200 hover:bg-gray-50",onClick:()=>m("/billing"),children:[(0,se.jsx)(Rj.A,{className:"mr-2 h-4 w-4"}),"Upgrade Plan"]})]}),!U&&(0,se.jsx)(zR,{})]})]}),(0,se.jsxs)(Bv,{className:"border-gray-200",children:[(0,se.jsxs)(zv,{className:"border-b border-gray-100",children:[(0,se.jsx)(Hv,{className:"text-gray-800",children:"Danger Zone"}),(0,se.jsx)(Vv,{className:"text-gray-600",children:"Irreversible actions that affect your app"})]}),(0,se.jsxs)(Wv,{className:"space-y-6",children:[(0,se.jsxs)("div",{ref:F,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("delete-app")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Delete App"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Permanently remove this app and all its data"})]}),(0,se.jsxs)(zt,{onClick:()=>{window.confirm("Are you sure you want to delete this app? This action cannot be undone.")&&H()},variant:"destructive",className:"flex items-center bg-red-500/90 hover:bg-red-600 text-white",children:[(0,se.jsx)(zy.A,{className:"mr-2 h-4 w-4"}),"Delete App"]})]}),$p(s.platform_role)&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{ref:O,className:"flex flex-col sm:flex-row justify-between sm:items-center gap-2 ".concat(V("admin-controls")),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Admin Controls"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage app availability"})]}),(0,se.jsxs)(zt,{onClick:async()=>{try{n({is_blocked:!a.is_blocked}),h({title:"Success",description:"App ".concat(a.is_blocked?"unblocked":"blocked"," successfully")})}catch(e){h({title:"Error",description:"Failed to ".concat(a.is_blocked?"unblock":"block"," app"),variant:"destructive"})}},variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700",children:[(0,se.jsx)(vR.A,{className:"mr-2 h-4 w-4"}),a.is_blocked?"Unblock App":"Block App"]})]})]})]})]})]})},qR=()=>{var e,t;const{app:s,updateApp:a}=lp(),[n,l]=(0,Y.useState)(s.description),[r,i]=(0,Y.useState)(!1),o=nN(async e=>{await a({user_description:e})},{toastSuccess:{title:"Description Updated",description:"Your app description has been updated successfully"},toastError:"Failed to update app description"});return(0,Y.useEffect)(()=>{s.user_description&&l(s.user_description)},[s.user_description]),(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsx)(Hv,{children:"App Info"})}),(0,se.jsxs)(Wv,{className:" flex  flex-col gap-4",children:[(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{className:"flex justify-between w-full h-full items-center",children:[(0,se.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,se.jsx)("div",{className:"flex w-12  h-12  rounded-lg bg-white shadow items-center justify-center",children:s.logo_url?(0,se.jsx)("img",{src:s.logo_url,alt:"".concat(s.name," logo"),className:"w-full h-full object-contain rounded-lg"}):(0,se.jsx)("div",{className:"p-1 bg-gray-100 rounded-lg flex items-center justify-center object-contain",children:(0,se.jsx)("span",{className:"text-sm font-bold text-gray-400",children:(null===(e=s.name)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())||"A"})})}),(0,se.jsx)(On,{children:"App Logo"})]}),(0,se.jsx)(Bx,{onClick:()=>{dS.openModal("AppLogoModal")},variant:"outline",size:"tiny",children:"Edit Logo"})]}),(0,se.jsx)(Tr,{}),(0,se.jsxs)("div",{className:"flex flex-col justify-between w-full h-full gap-3",children:[(0,se.jsxs)("div",{className:"flex flex-row gap-3 items-center justify-between",children:[(0,se.jsx)(On,{children:"App Description"}),(0,se.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,se.jsx)(Bx,{size:"tiny",variant:"outline",onClick:()=>{i(e=>!e)},children:r?(0,se.jsx)(la.A,{}):(0,se.jsx)(Qv.A,{})}),r&&(0,se.jsx)(Bx,{disabled:!r,onClick:()=>{o.update(n),i(!1)},size:"tiny",children:"Save Description"})]})]}),(0,se.jsx)("div",{className:"h-20",children:r?(0,se.jsx)(tN,{disabled:!r,value:n,initialValue:s.user_description,onChange:e=>l(e.target.value),placeholder:"Describe your app...",className:"h-full resize-none"}):(0,se.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:n})})]})]})]})})};function YR(e){let{onRouteChange:t}=e;const{app:s}=lp(),{app:a,listing:n,isLoading:l,refetch:r}=DM(),[i,o]=(0,Y.useState)("detail"),[c,d]=(0,Y.useState)("public"),u=(0,Y.useRef)(null==s?void 0:s.last_deployed_at);(0,Y.useEffect)(()=>{null!=s&&s.last_deployed_at&&s.last_deployed_at!==u.current&&(u.current=s.last_deployed_at,r())},[null==s?void 0:s.last_deployed_at,r]);const m=()=>{n&&!n.archived?o("detail"):o("empty")},x=async()=>{await r(),o("detail")},h=()=>{o("form")},p=n&&!n.archived;return(0,Y.useEffect)(()=>{l||(p?"form"!==i&&o("detail"):"form"!==i&&o("empty"))},[p,l,i]),l?(0,se.jsx)("div",{className:"flex items-center justify-center min-h-[500px]",children:(0,se.jsx)("div",{className:"text-slate-600",children:"Loading..."})}):"form"===i?(0,se.jsx)("div",{className:"max-w-8xl mx-auto p-4",children:(0,se.jsx)(hR,{onRouteChange:m,onSaveSuccess:x,initialVisibilityScope:c})}):"detail"===i&&p?(0,se.jsx)(fR,{listing:n,onEditListing:h,onListingRemoved:r}):(0,se.jsx)(pR,{app:s||a,onCreateListing:e=>{e&&d(e),o("form")}})}function GR(){const e=(0,J.zy)(),[t,s]=(0,Y.useState)(()=>{if(e.pathname.endsWith("app-listing"))return"appListing";return"appListing"===new URLSearchParams(e.search).get("tab")?"appListing":"main"}),[a,n]=(0,Y.useState)(0);(0,Y.useEffect)(()=>{if(e.pathname.endsWith("app-listing"))s("appListing");else if(e.pathname.endsWith("app-settings"))s("main");else{const t=new URLSearchParams(e.search).get("tab");"appListing"===t?s("appListing"):t&&s("main")}},[e.pathname,e.search]);const l=e=>{s(e),"main"===e&&n(e=>e+1)},r={main:(0,se.jsx)(WR,{onRouteChange:l},a),appListing:(0,se.jsx)(YR,{onRouteChange:l})};return(0,se.jsx)(RM,{children:r[t]||r.main})}class KR extends te.H{getBaseURL(){return"/workspace"}getSSOSettings(e){return this.axios.get("/".concat(e,"/sso/settings"))}enableSSO(e){return this.axios.post("/".concat(e,"/sso/enable"),{})}disableSSO(e){return this.axios.post("/".concat(e,"/sso/disable"),{})}updateSSOSettings(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=s?{provider_name:s}:{};return this.axios.put("/".concat(e,"/sso/settings"),t,{params:a})}}const $R=new KR,ZR=["value","onChange","onClear","disabled"],JR=e=>{let{children:t,content:s,side:a="left"}=e;const n="right"===a,l="top"===a,r="bottom"===a,i="left"===a;return(0,se.jsxs)("div",{className:"relative group",children:[t,(0,se.jsxs)("div",{className:"\n                absolute px-3 py-2 bg-gray-900 text-white text-xs rounded-md \n                opacity-0 group-hover:opacity-100 transition-opacity duration-200 \n                pointer-events-none whitespace-nowrap z-50 min-w-max\n                ".concat(r?"top-full mt-2 left-1/2 transform -translate-x-1/2":l?"bottom-full mb-2 left-1/2 transform -translate-x-1/2":n?"bottom-full mb-2 right-0":i?"right-full mr-2 top-1/2 transform -translate-y-1/2":"bottom-full mb-2 left-0","\n            "),children:[s,(0,se.jsx)("div",{className:"\n                    absolute border-4 border-transparent\n                    ".concat(r?"bottom-full -mb-1 left-1/2 transform -translate-x-1/2 border-b-gray-900":l?"top-full -mt-1 left-1/2 transform -translate-x-1/2 border-t-gray-900":n?"top-full -mt-1 right-4 border-t-gray-900":i?"left-full -ml-1 top-1/2 transform -translate-y-1/2 border-l-gray-900":"top-full -mt-1 left-4 border-t-gray-900","\n                ")})]})]})},QR=e=>e&&"string"==typeof e&&(e.match(/^x+$/i)||e.match(/^\u2022+$/)),XR=e=>QR(e)?"\u2022".repeat(20):e,eD=e=>{let{value:t,onChange:s,onClear:a,disabled:n}=e,l=(0,Nt.A)(e,ZR);return(0,se.jsx)(nl,(0,ue.A)((0,ue.A)({},l),{},{value:XR(t),onChange:e=>{n||QR(e.target.value)||s(e.target.value)},onFocus:()=>{!n&&QR(t)&&a()},disabled:n}))},tD=e=>{let{provider:t,icon:s,iconBg:a,title:n,description:l,checked:r,onToggle:i,disabled:o,children:c,expanded:d,forceUnchecked:u=!1}=e;const m=a||"bg-white border-gray-200",x=!u&&r;return(0,se.jsxs)("div",{className:"bg-white rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200 overflow-hidden ".concat(o?"opacity-60":""),children:[(0,se.jsxs)("div",{className:"p-4 flex justify-start items-center gap-4",children:[(0,se.jsx)("div",{className:"w-10 h-10 rounded-lg border flex items-center justify-center ".concat(m),children:s}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col justify-start items-start gap-0.5",children:[(0,se.jsx)("div",{className:"flex justify-center items-center gap-2",children:(0,se.jsx)("div",{className:"text-gray-900 text-sm font-medium leading-tight ".concat(o?"text-gray-500":""),children:n})}),(0,se.jsx)("div",{className:"self-stretch flex justify-center items-center gap-2.5",children:(0,se.jsx)("div",{className:"flex-1 text-gray-500 text-sm font-normal leading-tight ".concat(o?"text-gray-400":""),children:l})})]}),(0,se.jsx)(ei,{id:"".concat(t,"-auth-switch"),checked:x,onCheckedChange:e=>i(t,e),disabled:o})]}),r&&d&&c&&(0,se.jsx)("div",{children:c})]})};function sD(){const{user:e}=wd(),{app:t,updateApp:s,updateSecrets:a}=lp(),{activeWorkspace:n}=qd(),l=Uj(e,"elite"),r=Uj(e,"builder"),i=uh(),o=l||!0===(null==n?void 0:n.is_enterprise),c=(0,J.zy)(),{toast:d}=ao(),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(new Set),[f,v]=(0,Y.useState)(!1),[b,j]=(0,Y.useState)({name:"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""}),[y,N]=(0,Y.useState)(""),[w,_]=(0,Y.useState)(null),[k,C]=(0,Y.useState)(null),[A,S]=(0,Y.useState)(!1),[E,T]=(0,Y.useState)(!1),[I,P]=(0,Y.useState)({email_password:!1,google:!1,microsoft:!1,facebook:!1}),[L,M]=(0,Y.useState)({email_password:!1,google:!1,microsoft:!1,facebook:!1}),[R,D]=(0,Y.useState)("default"),[F,O]=(0,Y.useState)("default"),[U,B]=(0,Y.useState)({client_id:"",client_secret:""}),[z,H]=(0,Y.useState)({client_id:"",client_secret:""}),[V,W]=(0,Y.useState)(!1),q=[{id:"email_password",title:"Email and password authentication",description:"Members can log in with email and password",iconBg:"bg-slate-900 border-slate-900",icon:(0,se.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})},{id:"google",title:"Google authentication",description:"Members can log in with a Google account",iconBg:"bg-white border-gray-200",icon:(0,se.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,se.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,se.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,se.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,se.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})},{id:"microsoft",title:"Microsoft authentication",description:"Members can log in with a Microsoft account",iconBg:"bg-white border-gray-200",icon:(0,se.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,se.jsx)("path",{fill:"#F25022",d:"M0 0h11.5v11.5H0z"}),(0,se.jsx)("path",{fill:"#00A4EF",d:"M12.5 0H24v11.5H12.5z"}),(0,se.jsx)("path",{fill:"#7FBA00",d:"M0 12.5h11.5V24H0z"}),(0,se.jsx)("path",{fill:"#FFB900",d:"M12.5 12.5H24V24H12.5z"})]})},{id:"facebook",title:"Facebook authentication",description:"Members can log in with a Facebook account",iconBg:"bg-[#1877F2] border-[#1877F2]",icon:(0,se.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}],G=null!=k&&k.sso_enabled&&n&&!n.is_personal?{workspace_sso:{name:"workspace_sso",displayName:"".concat(k.sso_provider_name||"Workspace"," (Workspace SSO)"),description:"Use the SSO settings configured for your workspace (".concat(n.name,")"),isWorkspaceSSO:!0,fields:[{name:"workspace",label:"Workspace",value:n.name,readOnly:!0,row:1},{name:"provider_name",label:"Provider Name",value:k.sso_provider_name||"Not configured",readOnly:!0,row:2}]}}:{},K=(0,ue.A)((0,ue.A)({},G),{},{google:{name:"google",displayName:"Google Workspace",description:"Google Workspace (formerly G Suite) SSO",defaults:{discovery_url:"https://accounts.google.com/.well-known/openid-configuration",scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:2,tooltip:"OIDC discovery endpoint (pre-configured for Google)"}]},microsoft:{name:"microsoft",displayName:"Microsoft Azure AD",description:"Microsoft Azure Active Directory (requires tenant ID)",defaults:{scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"tenant_id",required:!0,row:2,tooltip:"Azure AD Directory (tenant) ID - found in Azure Portal \u2192 Azure Active Directory \u2192 Overview",placeholder:"Your Azure AD tenant ID"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:3,tooltip:"OIDC discovery endpoint automatically generated from your tenant ID"}],autoGenerate:{field:"tenant_id",template:e=>"https://login.microsoftonline.com/".concat(e,"/v2.0/.well-known/openid-configuration"),target:"discovery_url"}},github:{name:"github",displayName:"GitHub",description:"GitHub OAuth (not OIDC compatible)",defaults:{scope:"user:email",auth_endpoint:"https://github.com/login/oauth/authorize",token_endpoint:"https://github.com/login/oauth/access_token",userinfo_endpoint:"https://api.github.com/user"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (user:email for GitHub)"},{name:"auth_endpoint",required:!1,row:2,tooltip:"GitHub OAuth authorization endpoint (pre-configured)"},{name:"token_endpoint",required:!1,row:3,tooltip:"GitHub OAuth token endpoint (pre-configured)"},{name:"userinfo_endpoint",required:!1,row:3,tooltip:"GitHub API user endpoint (pre-configured)"}]},okta:{name:"okta",displayName:"Okta",description:"Okta (requires your tenant domain)",defaults:{scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"okta_domain",required:!0,row:2,tooltip:"Your Okta domain name (e.g., 'your-company' from your-company.okta.com)",placeholder:"your-company"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:3,tooltip:"OIDC discovery endpoint automatically generated from your Okta domain"}],autoGenerate:{field:"okta_domain",template:e=>"https://".concat(e,".okta.com/.well-known/openid-configuration"),target:"discovery_url"}},advanced:{name:"advanced",displayName:"Advanced / Manual Configuration",description:"Configure all fields manually for any OAuth/OIDC provider",defaults:{scope:"email profile"},fields:[{name:"name",required:!0,row:1,tooltip:"Custom name for your SSO provider"},{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:2,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"discovery_url",required:!1,row:2,tooltip:"OIDC discovery endpoint URL (if supported by your provider)"},{name:"scope",required:!1,row:3,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"auth_endpoint",required:!1,row:3,tooltip:"OAuth authorization endpoint URL"},{name:"token_endpoint",required:!1,row:4,tooltip:"OAuth token endpoint URL"},{name:"userinfo_endpoint",required:!1,row:4,tooltip:"OAuth userinfo endpoint URL"},{name:"jwks_uri",required:!1,row:5,tooltip:"JSON Web Key Set URI for token verification"}]}}),$=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{const e=new URLSearchParams(c.search).get("selectedParam");if(e){_(e);let t=null;if("sso-settings"===e)t=$,h(!0);t&&t.current&&setTimeout(()=>{t.current.scrollIntoView({behavior:"smooth",block:"center"})},300)}},[c.search]),(0,Y.useEffect)(()=>{if(t){const e=$c(t),s=e.enable_sso_login;Object.values(L).some(e=>e)||P({email_password:e.enable_username_password||!1,google:!s&&(e.enable_google_login||!1),microsoft:!s&&(e.enable_microsoft_login||!1),facebook:!s&&(e.enable_facebook_login||!1)})}},[null==t?void 0:t.auth_config,L]),(0,Y.useEffect)(()=>{(async()=>{if(null!=t&&t.id&&null!=t&&t.auth_config)try{const e=$c(t),s=e.google_oauth_mode||"default";D(s),O(s);const a=(await iu.getSecrets(t.id)).google_oauth_client_secret||"",n={client_id:e.google_oauth_client_id||"",client_secret:a};B(n),H(n)}catch(e){}})()},[null==t?void 0:t.id]),(0,Y.useEffect)(()=>{(async()=>{if(null!=t&&t.id)try{const e=$c(t);if(e.use_workspace_sso&&null!=k&&k.sso_enabled)return N("workspace_sso"),void S(!0);const s=await iu.getSecrets(t.id),a=Object.keys(s).filter(e=>e.startsWith("sso_")).reduce((e,t)=>(e[t.replace("sso_","")]=s[t],e),{}),l={name:e.sso_provider_name||"",client_id:a.client_id?a.client_id.match(/^x+$/i)?"\u2022".repeat(20):a.client_id:"",client_secret:a.client_secret?a.client_secret.match(/^x+$/i)?"\u2022".repeat(20):a.client_secret:"",discovery_url:a.discovery_url?a.discovery_url.match(/^x+$/i)?"\u2022".repeat(20):a.discovery_url:"",scope:a.scope?a.scope.match(/^x+$/i)?"\u2022".repeat(20):a.scope:"openid email profile",auth_endpoint:a.auth_endpoint?a.auth_endpoint.match(/^x+$/i)?"\u2022".repeat(20):a.auth_endpoint:"",token_endpoint:a.token_endpoint?a.token_endpoint.match(/^x+$/i)?"\u2022".repeat(20):a.token_endpoint:"",userinfo_endpoint:a.userinfo_endpoint?a.userinfo_endpoint.match(/^x+$/i)?"\u2022".repeat(20):a.userinfo_endpoint:"",jwks_uri:a.jwks_uri?a.jwks_uri.match(/^x+$/i)?"\u2022".repeat(20):a.jwks_uri:"",tenant_id:a.tenant_id?a.tenant_id.match(/^x+$/i)?"\u2022".repeat(20):a.tenant_id:"",okta_domain:a.okta_domain?a.okta_domain.match(/^x+$/i)?"\u2022".repeat(20):a.okta_domain:""};let r="";if(e.sso_provider_name)r=K[e.sso_provider_name]?e.sso_provider_name:"advanced";else if(l.name){const e=Object.entries(K).find(e=>{let[t,s]=e;return s.name===l.name});r=e?e[0]:"advanced"}else f&&!e.sso_provider_name&&(null!=k&&k.sso_enabled&&n&&!n.is_personal?(r="workspace_sso",S(!0)):r="google");let i=l;const o=new Set;if(r&&"advanced"===r)i=(0,ue.A)((0,ue.A)({},l),{},{name:e.sso_provider_name||l.name||""}),e.sso_provider_name&&e.sso_provider_name!==l.name&&o.add("name");else if(r&&K[r]){const e=K[r],t={};if(Object.entries(e.defaults||{}).forEach(e=>{let[s,a]=e;l[s]||(t[s]=a,o.add(s))}),i=(0,ue.A)((0,ue.A)((0,ue.A)({},l),t),{},{name:e.name}),e.name!==l.name&&o.add("name"),e.autoGenerate){const t=i[e.autoGenerate.field];t&&!i[e.autoGenerate.target]&&(i[e.autoGenerate.target]=e.autoGenerate.template(t),o.add(e.autoGenerate.target))}}"workspace_sso"!==r&&j(i),N(r),g(o)}catch(e){const s=$c(t);j({name:s.sso_provider_name||"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""}),null!=k&&k.sso_enabled&&n&&!n.is_personal?(N("workspace_sso"),S(!0)):N(""),g(new Set)}})()},[null==t?void 0:t.id,null==t?void 0:t.auth_config,f,k]),(0,Y.useEffect)(()=>{(async()=>{if(null!=t&&t.organization_id&&n&&!n.is_personal)try{const a=await $R.getSSOSettings(t.organization_id);if(null!=a&&a.config){C(a.config);const n=$c(t);if((n.use_workspace_sso||a.config.apps_must_use_workspace_sso)&&(S(!0),a.config.apps_must_use_workspace_sso&&!n.use_workspace_sso))try{const e=(0,ue.A)((0,ue.A)({},n),{},{use_workspace_sso:!0,enable_sso_login:!1,sso_provider_name:null});await s({auth_config:e})}catch(e){}}}catch(a){C(null)}else C(null)})()},[null==t?void 0:t.organization_id,null==t?void 0:t.id,n]);const Z=(e,t)=>{j(s=>{const a=(0,ue.A)((0,ue.A)({},s),{},{[e]:t}),n=K[y];if(null!=n&&n.autoGenerate&&e===n.autoGenerate.field&&t){const e=n.autoGenerate.template(t);a[n.autoGenerate.target]=e,g(e=>new Set(e).add(n.autoGenerate.target))}return a}),g(t=>new Set(t).add(e))},Q=e=>e&&K[e]&&K[e].fields||[],X=async()=>{W(!0);try{const e={google_oauth_mode:R};"custom"===R?((e,t,s)=>{s&&!QR(s)&&(e[t]=s.trim())})(e,"google_oauth_client_id",U.client_id):e.google_oauth_client_id=null,await s({auth_config:(0,ue.A)((0,ue.A)({},t.auth_config),e)}),"custom"===R&&U.client_secret&&!QR(U.client_secret)&&await a({google_oauth_client_secret:U.client_secret}),O(R),H((0,ue.A)({},U)),d({title:"Success",description:"custom"===R?"Google custom OAuth settings updated successfully":"Switched to default Base44 OAuth"})}catch(e){d({title:"Error",description:"Failed to update Google OAuth settings",variant:"destructive"})}finally{W(!1)}},ee=async(e,a)=>{if(L[e])return;const n=$c(t);if(a&&n.enable_sso_login&&"email_password"!==e)return void d({title:"Cannot Enable Social Provider",description:"Please disable SSO first before enabling social providers",variant:"destructive"});const l={email_password:{field:"enable_username_password",name:"Email and Password"},google:{field:"enable_google_login",name:"Google"},microsoft:{field:"enable_microsoft_login",name:"Microsoft"},facebook:{field:"enable_facebook_login",name:"Facebook"}}[e];if(l){P(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:a})),M(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!0}));try{t.auth_config[l.field]=a,await s({auth_config:(0,ue.A)((0,ue.A)({},t.auth_config),{},{[l.field]:a})}),d({title:"".concat(l.name,a?" Authentication Enabled":" Authentication Disabled"),description:"".concat(l.name,a?" authentication is now enabled for your app":" authentication has been disabled")})}catch(r){P(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!a})),d({title:"Error",description:"Failed to update ".concat(l.name," authentication"),variant:"destructive"})}finally{M(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!1}))}}},te=r,ae=(0,Y.useCallback)(t=>{Tu("User clicked upgrade",(0,ue.A)((0,ue.A)({},i),{},{user_tier:(null==e?void 0:e.subscription_tier)||null,cta:t,origin:"custom google auth",target_route:"/billing"})),Vu((0,ue.A)((0,ue.A)({},i),{},{user_tier:(null==e?void 0:e.subscription_tier)||null}),{cta:t,origin:"custom google auth",target_route:"/billing"})},[i,null==e?void 0:e.subscription_tier]),ne=()=>{if(R!==F)return!0;const e=Object.keys(U).some(e=>{const t=U[e],s=z[e];return(!QR(t)||!QR(s))&&(!(QR(t)||!QR(s))||t!==s)});return e},le=()=>{var e,t;if("custom"!==R)return!0;const s=null===(e=U.client_id)||void 0===e?void 0:e.trim(),a=null===(t=U.client_secret)||void 0===t?void 0:t.trim();return Boolean(s)&&Boolean(a)};return(0,se.jsxs)("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[(0,se.jsx)("style",{jsx:!0,global:!0,children:"\n                .selected-section {\n                    position: relative;\n                    border-left: 4px solid #334155;\n                    background-color: rgba(241, 245, 249, 0.7);\n                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\n                    transition: all 0.4s ease;\n                    padding-left: 16px !important;\n                    padding-top: 14px !important;\n                    padding-bottom: 14px !important;\n                    margin: 4px 0 !important;\n                    border-radius: 4px;\n                }\n\n                /* Left border with animated glow */\n                .selected-section::before {\n                    content: '';\n                    position: absolute;\n                    left: -4px;\n                    top: 0;\n                    width: 4px;\n                    height: 100%;\n                    background: linear-gradient(to bottom, #0f766e, #334155);\n                    box-shadow: 0 0 12px rgba(15, 118, 110, 0.5);\n                    animation: border-pulse 2.5s infinite ease-in-out;\n                    z-index: 1;\n                }\n                \n                /* Light effect */\n                .selected-section::after {\n                    content: '';\n                    position: absolute;\n                    left: 0;\n                    top: 0;\n                    height: 100%;\n                    width: 100%;\n                    background: linear-gradient(to right, rgba(15, 118, 110, 0.08), transparent 50%);\n                    animation: light-pulse 2.5s infinite ease-in-out;\n                    pointer-events: none;\n                    border-radius: 4px;\n                }\n                \n                @keyframes border-pulse {\n                    0%, 100% {\n                        box-shadow: 0 0 8px rgba(15, 118, 110, 0.4);\n                    }\n                    50% {\n                        box-shadow: 0 0 20px rgba(15, 118, 110, 0.7);\n                    }\n                }\n                \n                @keyframes light-pulse {\n                    0%, 100% {\n                        opacity: 0.3;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.05), transparent 50%);\n                    }\n                    50% {\n                        opacity: 0.7;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.12), transparent 60%);\n                    }\n                }\n            "}),(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Authentication"}),(0,se.jsxs)("p",{className:"text-gray-600 mt-1",children:["Configure the authentication methods that members of your app can use to log in to ",(null==t?void 0:t.name)||"(AppName)","."]})]}),null!=k&&k.sso_enabled&&null!=k&&k.apps_must_use_workspace_sso&&n&&!n.is_personal?(0,se.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:(0,se.jsx)("div",{className:"flex items-start justify-between",children:(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,se.jsx)("span",{className:"text-base font-medium text-gray-900",children:"Workspace SSO"}),(0,se.jsx)(ei,{checked:!0,disabled:!0,className:"data-[state=checked]:bg-teal-600 opacity-60"})]}),(0,se.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Single Sign-On (SSO) is managed at the workspace level. All apps in this workspace use the same SSO provider configured by your admin."}),(0,se.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,se.jsxs)("span",{children:["Workspace: ",n.name]}),(0,se.jsx)("span",{children:"\u2022"}),(0,se.jsxs)("span",{children:["Provider: ",k.sso_provider_name||"Configured"]})]})]})})}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"space-y-3",children:q.map(e=>(0,se.jsx)(tD,{provider:e.id,icon:e.icon,iconBg:e.iconBg,title:e.title,description:e.description,checked:I[e.id],onToggle:ee,disabled:(!!$c(t).enable_sso_login||A)&&"email_password"!==e.id,forceUnchecked:(!!$c(t).enable_sso_login||A)&&"email_password"!==e.id,expanded:"google"===e.id,children:"google"===e.id&&(0,se.jsx)(mp,{children:(0,se.jsxs)("div",{className:"p-4 flex flex-col gap-6",children:[(0,se.jsxs)(lr,{value:R,onValueChange:D,className:"flex flex-col gap-6",children:[(0,se.jsxs)("div",{className:"inline-flex items-center gap-3",children:[(0,se.jsx)(rr,{value:"default",id:"google-auth-default",className:"border-slate-300 text-slate-900"}),(0,se.jsx)("label",{htmlFor:"google-auth-default",className:"flex flex-col gap-1.5 cursor-pointer",children:(0,se.jsx)("div",{className:"text-slate-900 text-sm font-medium leading-none",children:"Use the default Base44 OAuth"})})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,se.jsxs)("div",{className:"inline-flex items-center gap-3",children:[(0,se.jsx)(rr,{value:"custom",id:"google-auth-custom",className:"border-slate-300 text-slate-900 self-start mt-0.5",disabled:!te}),(0,se.jsxs)("div",{className:"flex flex-col gap-1.5 flex-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("label",{htmlFor:"google-auth-custom",className:"text-slate-900 text-sm font-medium leading-none ".concat(te?"cursor-pointer":"cursor-not-allowed opacity-60"),children:"Use a custom OAuth from Google console"}),(0,se.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-orange-50 border border-orange-200 rounded-full",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full"}),(0,se.jsx)("span",{className:"text-xs font-medium text-orange-800",children:"Builder+"})]}),!te&&(0,se.jsx)("a",{href:"/billing",className:"text-orange-600 hover:text-orange-700 text-xs font-medium underline",onClick:e=>{e.stopPropagation(),ae("Upgrade now")},children:"Upgrade now"})]}),(0,se.jsxs)("div",{className:"text-slate-500 text-sm font-normal leading-tight ".concat(te?"":"opacity-60"),children:["Ensure users log in using your custom Google authentication."," ",(0,se.jsx)("a",{href:"https://docs.base44.com/Guides/Managing-login-and-registration#customizing-the-google-login",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline",onClick:e=>e.stopPropagation(),children:"Here's how to set it up"})]})]})]}),"custom"===R&&(0,se.jsx)("div",{className:"flex flex-col gap-6",children:(0,se.jsx)("div",{className:"pl-7 flex flex-col gap-3",children:(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"h-8 inline-flex items-center gap-1",children:[(0,se.jsx)(On,{className:"text-slate-500 text-sm font-normal leading-tight",children:"Client ID*"}),(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"w-4 h-4 text-slate-600 hover:text-slate-700"})}),(0,se.jsx)(pp,{side:"bottom",children:(0,se.jsx)("p",{children:"The OAuth client ID from Google Console"})})]})]}),(0,se.jsx)(eD,{className:"px-3 py-1.5 bg-white",type:"text",value:U.client_id,onChange:e=>te&&B((0,ue.A)((0,ue.A)({},U),{},{client_id:e})),onClear:()=>te&&B((0,ue.A)((0,ue.A)({},U),{},{client_id:""})),disabled:!te})]}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"h-8 inline-flex items-center gap-1",children:[(0,se.jsx)(On,{className:"text-slate-500 text-sm font-normal leading-tight",children:"Client Secret*"}),(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"w-4 h-4 text-slate-600 hover:text-slate-700"})}),(0,se.jsx)(pp,{side:"bottom",children:(0,se.jsx)("p",{children:"The OAuth client secret from Google Console (keep this confidential)"})})]})]}),(0,se.jsx)(eD,{className:"px-3 py-1.5 bg-white",type:"password",value:U.client_secret,onChange:e=>te&&B((0,ue.A)((0,ue.A)({},U),{},{client_secret:e})),onClear:()=>te&&B((0,ue.A)((0,ue.A)({},U),{},{client_secret:""})),disabled:!te})]})]})})})]})]}),(0,se.jsx)("div",{className:"flex flex-col items-end gap-2.5",children:(0,se.jsx)(zt,{onClick:X,disabled:!te||V||!ne()||!le(),className:"h-9 px-4 py-2 bg-slate-900 hover:bg-slate-800 text-white rounded-lg shadow-sm",children:V?"Updating...":"Update"})})]})})},e.id))}),(0,se.jsxs)("div",{className:"flex items-center py-2",children:[(0,se.jsx)("div",{className:"flex-1 border-t border-gray-200"}),(0,se.jsx)("div",{className:"px-3 text-gray-500 text-sm font-medium",children:"or"}),(0,se.jsx)("div",{className:"flex-1 border-t border-gray-200"})]}),(0,se.jsxs)("div",{ref:$,className:"bg-white rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200 ".concat((re="sso-settings",w===re?"selected-section p-4 rounded-md":"")," ").concat(o?"":"opacity-75"),children:[(0,se.jsxs)("div",{className:"p-4 flex justify-start items-center gap-4",children:[(0,se.jsx)("div",{className:"w-10 h-10 bg-slate-900 rounded-lg border border-slate-900 flex items-center justify-center",children:(0,se.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col justify-start items-start gap-0.5",children:[(0,se.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,se.jsx)("div",{className:"text-gray-900 text-sm font-medium leading-tight",children:"Single Sign-on (SSO)"}),null!=n&&n.is_enterprise?(0,se.jsx)(JR,{content:"Enterprise workspace feature",side:"top",children:(0,se.jsx)("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 border border-blue-200 rounded-full",children:(0,se.jsx)("span",{className:"text-xs font-medium text-blue-800",children:"Enterprise"})})}):(0,se.jsx)(JR,{content:"Early-stage feature for feedback. Subject to change or removal.",side:"top",children:(0,se.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-orange-50 border border-orange-200 rounded-full",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full animate-pulse"}),(0,se.jsx)("span",{className:"text-xs font-medium text-orange-800",children:"Elite Early Preview"})]})})]}),(0,se.jsx)("div",{className:"self-stretch text-gray-500 text-sm font-normal leading-tight",children:"Allow members to log in using a custom SSO that fits your organization's needs."}),(0,se.jsx)("button",{onClick:()=>window.open("https://docs.base44.com/Guides/Setting-up-SSO","_blank","noopener,noreferrer"),className:"text-blue-600 text-sm font-medium hover:text-blue-700 underline",children:"Learn more about SSO"})]}),(0,se.jsx)("div",{className:"flex items-center gap-3",children:($c(t).sso_provider_name||A||$c(t).use_workspace_sso)&&!f?(0,se.jsx)(ei,{id:"sso-toggle",checked:!0===$c(t).enable_sso_login||A||$c(t).use_workspace_sso,onCheckedChange:async e=>{if(u)return;if(A&&!e){m(!0);try{const e=(0,ue.A)((0,ue.A)({},$c(t)),{},{use_workspace_sso:!1});await s({auth_config:e}),S(!1),d({title:"Workspace SSO Disabled",description:"Your app will use its own authentication settings"})}catch(l){d({title:"Error",description:l.message||"Failed to disable workspace SSO",variant:"destructive"})}finally{m(!1)}return}$c(t).sso_provider_name;const a=(0,ue.A)({},I),n=x;e?(P(e=>(0,ue.A)((0,ue.A)({},e),{},{google:!1,microsoft:!1,facebook:!1})),h(!0)):h(!1),m(!0);try{e?(await s({auth_config:(0,ue.A)((0,ue.A)({},t.auth_config),{},{sso_provider_name:"google",enable_sso_login:!0,enable_google_login:!1,enable_microsoft_login:!1,enable_facebook_login:!1})}),d({title:"SSO Enabled",description:"Single Sign-On has been enabled and social login providers have been disabled. Please configure your SSO settings."})):(await s({auth_config:(0,ue.A)((0,ue.A)({},t.auth_config),{},{enable_sso_login:!1})}),v(!1),d({title:"SSO Disabled",description:"Single Sign-On has been disabled"}))}catch(l){P(a),h(n),d({title:"Error",description:"Failed to update SSO settings",variant:"destructive"})}finally{m(!1)}},disabled:null==k?void 0:k.apps_must_use_workspace_sso}):f?(0,se.jsx)(ei,{id:"sso-toggle",checked:!1,onCheckedChange:()=>{},disabled:!0}):(0,se.jsx)(JR,{content:o?"Configure Single Sign-On for your app":"SSO is available for Elite tier and above or Enterprise workspaces",side:"left",children:(0,se.jsx)("button",{onClick:()=>{o&&(v(!0),h(!0),null!=k&&k.sso_enabled&&n&&!n.is_personal?(N("workspace_sso"),S(!0)):N("google"))},className:"px-4 py-2 border rounded-md text-xs font-medium leading-4 tracking-normal transition-colors ".concat(o?"bg-white border-gray-300 text-gray-700 hover:bg-gray-50":"bg-gray-100 border-gray-200 text-gray-400 cursor-not-allowed"),disabled:u||!o,children:u?"Setting up...":"Set Up"})})})]}),($c(t).sso_provider_name||f||A||$c(t).use_workspace_sso)&&!x&&(0,se.jsx)("div",{className:"px-4 pb-4",children:(0,se.jsxs)("button",{onClick:()=>{const e=x;if(h(!x),e)N(""),g(new Set);else{const e=$c(t);A||e.use_workspace_sso?(N("workspace_sso"),S(!0)):e.sso_provider_name?K[e.sso_provider_name]?N(e.sso_provider_name):N("advanced"):null!=k&&k.sso_enabled&&n&&!n.is_personal?(N("workspace_sso"),S(!0)):N("google")}},className:"w-full h-10 flex items-center justify-between hover:bg-gray-50 transition-colors group bg-white rounded-md border border-gray-200",style:{paddingTop:"4px",paddingRight:"4px",paddingBottom:"4px",paddingLeft:"12px"},children:[(0,se.jsx)("div",{className:"text-gray-900 text-sm font-medium",children:f?"Set up SSO Configuration":((e,s,a)=>{const n=$c(t);return A||n.use_workspace_sso?"".concat((null==k?void 0:k.sso_provider_name)||"Workspace"," (Workspace SSO)"):(null===(e=K[n.sso_provider_name])||void 0===e?void 0:e.displayName)||(null===(s=n.sso_provider_name)||void 0===s?void 0:s.charAt(0).toUpperCase())+(null===(a=n.sso_provider_name)||void 0===a?void 0:a.slice(1))+" SSO"})()}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,se.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),(0,se.jsx)("span",{className:"text-sm",children:f?"Set up":"Configure"}),(0,se.jsx)(_t.A,{className:"w-4 h-4 transition-transform ".concat(x?"rotate-180":"")})]})]})}),x&&($c(t).sso_provider_name||f||A||$c(t).use_workspace_sso)&&(0,se.jsx)("div",{className:"border-t border-gray-100 p-4 bg-white",children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-gray-500 text-sm font-normal leading-tight mb-2",children:"Select SSO Provider"}),(0,se.jsxs)(br,{value:y,onValueChange:e=>{if(N(e),"workspace_sso"===e)return void S(!0);S(!1);const s=$c(t);if("advanced"===e){const e=s.sso_provider_name&&!K[s.sso_provider_name];j(e?e=>(0,ue.A)((0,ue.A)({},e),{},{name:s.sso_provider_name||e.name||"advanced"}):{name:"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""})}else if(e&&K[e]){const t=K[e];if(s.sso_provider_name===e)j(e=>(0,ue.A)((0,ue.A)({},e),{},{name:t.name}));else{const e={name:t.name,client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""},s=(0,ue.A)((0,ue.A)({},e),t.defaults);if(t.autoGenerate){const e=s[t.autoGenerate.field];if(e){const a=t.autoGenerate.template(e);s[t.autoGenerate.target]=a}}j(s)}}},children:[(0,se.jsx)(Nr,{className:"w-full px-4 py-3 bg-white rounded-md shadow-sm outline outline-1 outline-offset-[-1px] outline-gray-200",children:(0,se.jsx)(yr,{placeholder:"Select SSO Provider"})}),(0,se.jsx)(kr,{children:Object.entries(K).map(e=>{let[t,s]=e;return(0,se.jsx)(Ar,{value:t,children:s.displayName},t)})})]})]}),(e=>{if("workspace_sso"===e){const t=K[e];return t&&t.fields?(0,se.jsxs)("div",{className:"space-y-4",children:[t.fields.map(e=>(0,se.jsxs)("div",{children:[(0,se.jsx)(On,{className:"text-gray-500 text-sm",children:e.label}),(0,se.jsx)(nl,{className:"mt-1 w-full h-8 bg-gray-50",type:"text",value:e.value,readOnly:!0,disabled:!0})]},e.name)),(0,se.jsx)("div",{className:"text-sm text-gray-500",children:"SSO settings are managed at the workspace level."})]}):null}const t=Q(e);if(!t.length)return null;const s=t.reduce((e,t)=>{const s=t.row||1;return e[s]||(e[s]=[]),e[s].push(t),e},{});return(0,se.jsx)("div",{className:"space-y-4",children:Object.entries(s).sort((e,t)=>{let[s]=e,[a]=t;return parseInt(s)-parseInt(a)}).map(t=>{let[s,a]=t;return(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map((t,s)=>{var n,l,r,i;const o=a.length>1&&1===s,c=b[t.name]||"",d=t.placeholder||"Enter ".concat(t.name.replace("_"," ")),u=XR(c),m="discovery_url"===t.name&&"discovery_url"===(null===(n=K[e])||void 0===n||null===(l=n.autoGenerate)||void 0===l?void 0:l.target)&&c;return(0,se.jsxs)("div",{children:[(0,se.jsxs)(On,{className:"text-gray-500 text-sm flex items-center gap-1",children:[t.name.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),t.required&&" *",t.name===(null===(r=K[e])||void 0===r||null===(i=r.autoGenerate)||void 0===i?void 0:i.target)&&c&&" (Auto-generated)",(0,se.jsx)(JR,{content:t.tooltip,side:o?"right":"left",children:(0,se.jsx)(Oy.A,{className:"w-3.5 h-3.5 text-gray-400 hover:text-gray-600 cursor-help"})})]}),(0,se.jsx)(nl,{className:"mt-1 w-full h-8 ".concat(m?"bg-gray-50":""),type:"text",placeholder:d,value:u,onChange:e=>{QR(e.target.value)||Z(t.name,e.target.value)},onFocus:e=>{QR(u)&&(e.target.value="",Z(t.name,""))},readOnly:m})]},t.name)})},s)})})})(y),(0,se.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,se.jsx)(zt,{onClick:()=>{h(!1),f&&v(!1),N(""),g(new Set),"workspace_sso"!==y||$c(t).use_workspace_sso||S(!1)},variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:f?"Cancel Setup":"Dismiss"}),(0,se.jsx)(zt,{onClick:"workspace_sso"===y?async()=>{m(!0);try{const e=(0,ue.A)((0,ue.A)({},$c(t)),{},{use_workspace_sso:!0,enable_sso_login:!1,sso_provider_name:null});await s({auth_config:e}),S(!0),h(!1),v(!1),N("workspace_sso"),P(e=>(0,ue.A)((0,ue.A)({},e),{},{google:!1,microsoft:!1,facebook:!1})),d({title:"Workspace SSO Enabled",description:"Your app will now use the workspace SSO settings"})}catch(e){d({title:"Error",description:e.message||"Failed to enable workspace SSO",variant:"destructive"})}finally{m(!1)}}:async()=>{m(!0);try{const e={};Object.keys(b).forEach(t=>{const s=b[t];!s||QR(s)||!p.has(t)&&""===s||(e["sso_".concat(t)]=s)}),Object.keys(e).length>0&&await a(e);let n=null;y&&"advanced"!==y?n=y:"advanced"===y&&(n=b.name||"advanced");const l={sso_provider_name:n,enable_sso_login:!0,use_workspace_sso:!1};f&&(l.enable_google_login=!1,l.enable_microsoft_login=!1,l.enable_facebook_login=!1),await s({auth_config:(0,ue.A)((0,ue.A)({},t.auth_config),l)}),g(new Set),S(!1),f&&(v(!1),P(e=>(0,ue.A)((0,ue.A)({},e),{},{google:!1,microsoft:!1,facebook:!1}))),h(!1);const r=Object.keys(e).length;d({title:"Success",description:f?"SSO has been enabled and configured successfully":r>0?"SSO settings updated successfully (".concat(r," configuration").concat(1===r?"":"s"," saved)"):"SSO provider updated successfully"})}catch(e){d({title:"Error",description:"Failed to update SSO settings",variant:"destructive"})}finally{m(!1)}},disabled:u||!y||"workspace_sso"!==y&&Q(y).some(e=>e.required&&!b[e.name]),className:"bg-gray-900 text-white",children:u?"Saving...":"workspace_sso"===y?"Enable Workspace SSO":f?"Enable SSO":"Save SSO Settings"})]})]})})]})]})]})]});var re}const aD=s.p+"static/media/GradientDiamondIcon.10e37be26c22402a61eda3f59fa45fee.svg",nD={top:"items-start pt-16",upper:"items-start pt-[20%]",center:"items-center"};function lD(e){let{title:t="Unlock this feature",description:s="This feature is only available on the Builder plan or higher. Upgrade to continue working without limits",position:a="center",trackingOrigin:n,userId:l,appId:r,conversationId:i,discountPercent:o=0}=e;return(0,se.jsx)("div",{className:"absolute inset-0 flex justify-center z-10 pointer-events-none ".concat(nD[a]),children:(0,se.jsxs)("div",{className:"flex flex-col items-center bg-white rounded-lg p-6 w-[440px] pointer-events-auto",style:{border:"1px solid #E5E5E5",boxShadow:"0px 0px 18px rgba(0, 6, 36, 0.1), 0px 6px 6px rgba(0, 6, 36, 0.05)",gap:"24px"},children:[(0,se.jsx)("img",{src:aD,alt:"",width:32,height:32}),(0,se.jsxs)("div",{className:"flex flex-col items-center w-full",style:{gap:"12px"},children:[(0,se.jsxs)("div",{className:"flex flex-col items-center w-full",style:{gap:"8px"},children:[(0,se.jsx)("h2",{className:"w-full text-center font-semibold",style:{fontSize:"18px",lineHeight:"100%",color:"#000000"},children:t}),(0,se.jsx)("p",{className:"w-full text-center font-normal",style:{fontSize:"14px",lineHeight:"20px",color:"#374151"},children:s})]}),(0,se.jsx)(mj,{showDiamond:!1,trackingOrigin:n,userId:l,appId:r,conversationId:i,discountPercent:o})]})]})})}function rD(){return(0,se.jsx)("div",{className:"flex flex-col items-center justify-center border border-dashed border-[#E5E5E5] rounded-lg w-full py-12 min-h-[500px]",children:(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,se.jsx)("img",{src:"/assets/appConnections/integrations-app-connections-empty.svg",alt:"Integrations",className:"w-[240px] h-[124px]"}),(0,se.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Set up Integrations"}),(0,se.jsxs)("p",{className:"text-sm text-gray-600",children:["Easily link your app to connectors like Google Calendar, Google Drive, Slack, Notion, Salesforce, HubSpot and more.",(0,se.jsx)("br",{}),"Just describe what you want to connect in the chat, and it will set it up for you."]})]})})}const iD=["className"],oD=["className"],cD=["className"],dD=["className"],uD=["className"],mD=["className"],xD=["className"],hD=["className"],pD=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,iD);return(0,se.jsx)("div",{className:"relative w-full overflow-auto",children:(0,se.jsx)("table",(0,ue.A)({ref:t,className:de("w-full caption-bottom text-sm",s)},a))})});pD.displayName="Table";const gD=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,oD);return(0,se.jsx)("thead",(0,ue.A)({ref:t,className:de("[&_tr]:border-b",s)},a))});gD.displayName="TableHeader";const fD=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,cD);return(0,se.jsx)("tbody",(0,ue.A)({ref:t,className:de("[&_tr:last-child]:border-0",s)},a))});fD.displayName="TableBody";Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,dD);return(0,se.jsx)("tfoot",(0,ue.A)({ref:t,className:de("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s)},a))}).displayName="TableFooter";const vD=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,uD);return(0,se.jsx)("tr",(0,ue.A)({ref:t,className:de("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s)},a))});vD.displayName="TableRow";const bD=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,mD);return(0,se.jsx)("th",(0,ue.A)({ref:t,className:de("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s)},a))});bD.displayName="TableHead";const jD=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,xD);return(0,se.jsx)("td",(0,ue.A)({ref:t,className:de("p-4 align-middle [&:has([role=checkbox])]:pr-0",s)},a))});jD.displayName="TableCell";function yD(){return(0,se.jsx)(pD,{children:(0,se.jsx)(fD,{children:[1,2].map(e=>(0,se.jsxs)(vD,{className:"hover:bg-transparent border-b border-gray-200",children:[(0,se.jsx)(jD,{className:"border-0 align-top w-[280px] py-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"h-10 w-10 rounded-lg bg-gray-200 animate-pulse"}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 min-w-0",children:[(0,se.jsx)("div",{className:"h-4 w-32 bg-gray-200 rounded animate-pulse"}),(0,se.jsx)("div",{className:"h-3 w-40 bg-gray-200 rounded animate-pulse"})]})]})}),(0,se.jsx)(jD,{className:"text-sm text-muted-foreground border-0 py-4",children:(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,se.jsx)("div",{className:"h-6 w-24 bg-gray-200 rounded animate-pulse"}),(0,se.jsx)("div",{className:"h-6 w-32 bg-gray-200 rounded animate-pulse"})]})}),(0,se.jsx)(jD,{className:"text-right border-0 align-top py-4",children:(0,se.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded-lg animate-pulse ml-auto"})})]},e))})})}function ND(e){let{connectorId:t,size:s="md"}=e;const a=TE(t);if(null==a||!a.icon)return null;const n=a.icon;return(0,se.jsx)("div",{className:"".concat({sm:"w-8 h-8 p-1.5",md:"w-10 h-10 p-2",lg:"w-12 h-12 p-2.5"}[s]," bg-white rounded-lg flex items-center justify-center"),children:(0,se.jsx)(n,{className:"".concat({sm:"w-5 h-5",md:"w-6 h-6",lg:"w-7 h-7"}[s]," text-white")})})}Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,hD);return(0,se.jsx)("caption",(0,ue.A)({ref:t,className:de("mt-4 text-sm text-muted-foreground",s)},a))}).displayName="TableCaption";var wD=s(58888);function _D(e){let{status:t}=e;return"expired"===t?(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)("div",{className:"inline-flex items-center gap-1 text-sm","aria-label":"Connection status: Needs attention",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-[#DC2626]","aria-hidden":"true"}),(0,se.jsx)("span",{className:"text-[#DC2626]",children:"Revoked"})]})}),(0,se.jsx)(pp,{side:"top",children:(0,se.jsx)("p",{children:"Connection is lost \u2014 please reconnect"})})]})}):"disconnected"===t?(0,se.jsxs)("span",{className:"inline-flex items-center gap-1 text-sm text-slate-500",children:[(0,se.jsx)(wD.A,{className:"w-4 h-4","aria-hidden":"true"}),"Disconnected"]}):null}function kD(e){let{integrations:t,connectingIntegration:s,onConnectSwitchAccount:a,onDisconnectClick:n,onRemoveClick:l,onShowScopes:r}=e;return(0,se.jsx)("div",{className:"border border-gray-200 bg-white shadow-sm rounded-lg overflow-hidden",children:(0,se.jsx)(pD,{children:(0,se.jsx)(fD,{children:t.map((e,i)=>{const o=TE(e.integration_type);return(0,se.jsxs)(Y.Fragment,{children:[(0,se.jsxs)(vD,{className:"hover:bg-transparent border-0",children:[(0,se.jsx)(jD,{className:"border-0 align-top py-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(ND,{connectorId:e.integration_type,size:"lg"}),(0,se.jsxs)("div",{className:"flex flex-col min-w-0 gap-1",children:[(0,se.jsx)("span",{className:"font-medium text-[16px] truncate",children:null==o?void 0:o.name}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.integration_account_identifier&&(0,se.jsx)("span",{className:"truncate",children:e.integration_account_identifier}),(0,se.jsx)(_D,{status:e.status})]})]})]})}),(0,se.jsx)(jD,{className:"text-right border-0 align-top py-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>r(e),className:"h-8 px-3 rounded-[8px] border border-gray-200 hover:bg-gray-50 text-sm font-medium",children:"View Access"}),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-[8px] border border-2 border-gray-200 hover:bg-gray-50",children:(0,se.jsx)(Nv.A,{className:"h-4 w-4"})})}),(0,se.jsxs)(Aj,{align:"end",children:[(0,se.jsx)(Sj,{onClick:()=>a(e),disabled:s===e.integration_type,className:"cursor-pointer",children:s===e.integration_type?"Connecting...":"active"===e.status?"Switch account":"Reconnect"}),"disconnected"!==e.status&&(0,se.jsx)(Sj,{onClick:()=>n(e),disabled:s===e.integration_type,className:"text-red-600 focus:text-red-600 focus:bg-red-50 cursor-pointer",children:"Disconnect account"}),(0,se.jsxs)(Sj,{onClick:()=>l(e),disabled:s===e.integration_type,className:"text-red-600 focus:text-red-600 focus:bg-red-50 cursor-pointer",children:[(0,se.jsx)(zy.A,{className:"w-4 h-4 mr-2"}),"Remove"]})]})]})]})})]}),i<t.length-1&&(0,se.jsx)(vD,{className:"border-0",children:(0,se.jsx)(jD,{colSpan:2,className:"border-0 py-0 px-6",children:(0,se.jsx)("div",{className:"border-t border-gray-200"})})})]},e.integration_type)})})})})}const CD=e=>{var t,s,a,n;let{connector:l,onPromptClick:r,sessionContext:i,loadSuggestions:o}=e;const[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)([]),[p,g]=(0,Y.useState)(""),[f,v]=(0,Y.useState)(!1),b=(0,Y.useRef)(c),{user:j}=wd(),y=Uj(j,"builder");(0,Y.useEffect)(()=>{b.current=c},[c]),(0,Y.useEffect)(()=>{!c||f||u||(m(!0),o().then(e=>{b.current&&(h(e.suggestions),g(e.prefix))}).catch(e=>{b.current}).finally(()=>{b.current&&(m(!1),v(!0))}))},[c,f,u,o]),(0,Y.useEffect)(()=>{c||(h([]),g(""),v(!1),m(!1))},[c]);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Bv,{className:de("h-full overflow-hidden","bg-gradient-to-br from-white to-slate-50/30 flex flex-col rounded-2xl font-base44","border border-slate-200/60 p-4"),children:[(0,se.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[l.icon?(0,se.jsx)("div",{className:"h-12 w-12 flex-shrink-0 rounded-lg border border-slate-200 bg-white flex items-center justify-center p-2",children:(0,se.jsx)(l.icon,{className:"w-full h-full"})}):(0,se.jsx)(hg,{className:"h-12 w-12 flex-shrink-0 rounded-lg border border-slate-200",children:(0,se.jsx)(gg,{className:"bg-gradient-to-br from-teal-100 to-orange-100 text-teal-700 text-base font-medium rounded-lg",children:(null===(t=l.name)||void 0===t||null===(s=t.charAt(0))||void 0===s?void 0:s.toUpperCase())||"C"})}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>{kE(i,l.id,l.name,"use"),d(!0)},className:"font-normal",children:"Use"})]}),(0,se.jsx)("h3",{className:"text-base font-semibold text-slate-900 mb-1",children:l.name}),(0,se.jsx)("p",{className:"text-sm font-light leading-relaxed text-slate-500 line-clamp-2 mb-2 flex-1",children:l.subtitle}),l.category&&(0,se.jsx)("div",{children:(0,se.jsx)(gk,{variant:"outline",className:"font-normal text-slate-600 bg-slate-50",children:l.category})})]}),(0,se.jsx)(Og,{open:c,onOpenChange:d,children:(0,se.jsxs)(Hg,{className:"w-[95vw] sm:w-[90vw] max-w-[600px] max-h-[80vh] overflow-y-auto font-base44",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[l.icon?(0,se.jsx)("div",{className:"h-24 w-24 rounded-lg border-2 border-white shadow-sm bg-white flex items-center justify-center p-4",children:(0,se.jsx)(l.icon,{className:"w-full h-full"})}):(0,se.jsx)(hg,{className:"h-24 w-24 rounded-lg",children:(0,se.jsx)(gg,{className:"bg-gradient-to-br from-teal-100 to-orange-100 text-teal-700 rounded-lg",children:(null===(a=l.name)||void 0===a||null===(n=a.charAt(0))||void 0===n?void 0:n.toUpperCase())||"C"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)(qg,{className:"text-xl",children:l.name}),(0,se.jsx)(Yg,{className:"text-sm mt-1",children:l.subtitle||l.description})]})]})}),(0,se.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900",children:"Example prompts"}),(0,se.jsx)("div",{className:"font-light text-slate-900 mb-3",children:"Click a prompt to add it to your chat."}),(0,se.jsx)("div",{className:"space-y-2",children:u?(0,se.jsx)(se.Fragment,{children:[1,2,3,4].map(e=>(0,se.jsx)("div",{className:"bg-gray-100 rounded-lg p-3",children:(0,se.jsx)($r,{className:"h-4 w-3/4"})},e))}):x.length>0?x.map((e,t)=>(0,se.jsx)("button",{onClick:()=>(e=>{const t=p+e;kE(i,l.id,l.name,"prompt",t),d(!1),r(t)})(e),className:"w-full text-left bg-gray-100 rounded-lg p-3 hover:bg-gray-200 transition-colors cursor-pointer group",children:(0,se.jsx)("p",{className:"text-sm text-slate-700 leading-relaxed group-hover:text-slate-900",children:e})},t)):(0,se.jsx)("div",{className:"bg-gray-100 rounded-lg p-3",children:(0,se.jsx)("p",{className:"text-sm text-slate-500 leading-relaxed",children:"Unable to load suggestions. Please try again later."})})})]}),!y&&(0,se.jsx)("div",{className:"border-t pt-4",children:(0,se.jsx)("div",{className:"flex items-start gap-2",style:{borderRadius:"8px",background:"linear-gradient(92deg, rgba(255, 176, 137, 0.35) 0.9%, rgba(255, 211, 130, 0.24) 99.3%), linear-gradient(0deg, #FFF 0%, #FFF 100%), linear-gradient(90deg, #FAFAF9 0%, #F5F5F4 100%)",padding:"12px 16px",alignSelf:"stretch"},children:(0,se.jsxs)("p",{className:"text-sm text-slate-700 leading-relaxed",children:["This integration requires backend functions, a feature available only on Builder tier and above."," ",(0,se.jsx)("a",{href:"/billing",target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:text-orange-700 font-medium underline underline-offset-2",children:"See Plans"})]})})})]})]})})]})},AD=e=>{let{onStripeSetupComplete:t}=e;const s=(0,J.Zp)(),{app:a}=lp(),n=uh(),l=e=>{null!=a&&a.id&&(sessionStorage.setItem("pendingChatMessage",e),window.dispatchEvent(new CustomEvent("pendingChatMessage",{detail:{message:e}})),s("/apps/".concat(a.id,"/editor/preview")),et.toast.success("Prompt added to chat. Press Enter to send."),null==t||t())};return(0,se.jsxs)("div",{className:"font-base44",children:[(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Connectors"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 font-light",children:"Connect your app to popular services with quick OAuth connections."})]}),(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-5 gap-y-4",children:EE.map(e=>{return(0,se.jsx)(CD,{connector:e,onPromptClick:l,sessionContext:n,loadSuggestions:(t=e.id,async()=>{if(null==a||!a.id)return{suggestions:[],prefix:""};try{const e=await QS.getIntegrationSuggestions(a.id,t);return{suggestions:e.suggestions||[],prefix:e.prefix||""}}catch(e){return{suggestions:[],prefix:""}}})},e.id);var t})})]})};var SD=s(83153),ED=s(44153);function TD(e){var t,s;let{onClaimSandbox:a,onConfigureKeys:n,hasTestedPayment:l=!1,isSandboxClaimed:r=!1,hasLiveKeys:i=!1}=e;const{toast:o}=ao(),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(""),[x,h]=(0,Y.useState)(""),[p,g]=(0,Y.useState)(!1),f=[{id:"test-payment",title:"Try a test payment",completed:l||r},{id:"claim-sandbox",title:"Claim your Stripe sandbox",completed:r},{id:"add-keys",title:"Add your live API keys from Stripe",completed:i}],v=null!==(t=null===(s=f.find(e=>!e.completed))||void 0===s?void 0:s.id)&&void 0!==t?t:null,[b,j]=(0,Y.useState)(v);(0,Y.useEffect)(()=>{var e,t;const s=null!==(e=null===(t=f.find(e=>!e.completed))||void 0===t?void 0:t.id)&&void 0!==e?e:null;j(s)},[l,r,i]);const y=f.filter(e=>e.completed).length,N=("".concat(y,"/3"),async()=>{try{await navigator.clipboard.writeText("4242424242424242"),d(!0),o({title:"Copied!",description:"Test card number copied to clipboard."}),setTimeout(()=>d(!1),2e3)}catch(e){o({title:"Failed to copy",description:"Please copy manually: 4242 4242 4242 4242",variant:"destructive"})}}),w=async e=>{if(e.preventDefault(),n&&u&&x){g(!0);try{await n(u,x),m(""),h(""),o({title:"Success",description:"API keys saved successfully."})}catch(a){var t,s;const e=a,n=(null==e||null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"Failed to save API keys. Please try again.";o({title:"Error",description:n,variant:"destructive"})}finally{g(!1)}}},_=e=>{switch(e){case"test-payment":return r?(0,se.jsx)("div",{className:"flex flex-col gap-3 sm:gap-4 pl-[26px] pr-0 py-0",children:(0,se.jsxs)("div",{className:"text-sm text-slate-900 leading-5",children:[(0,se.jsx)("p",{className:"mb-0",children:"You've moved out of test mode."}),(0,se.jsx)("p",{children:"No need to run test payments anymore."})]})}):(0,se.jsxs)("div",{className:"flex flex-col gap-3 sm:gap-4 pl-[26px] pr-0 py-0",children:[(0,se.jsxs)("div",{className:de("text-sm",l?"text-slate-500 line-through":"text-slate-900"),children:[(0,se.jsx)("p",{children:"Use this test card to simulate a purchase:"}),(0,se.jsxs)("p",{children:[(0,se.jsx)("span",{className:"font-medium",children:"4242 4242 4242 4242"}),(0,se.jsx)("span",{children:", any future expiry, any 3-digit CVC."})]})]}),(0,se.jsx)("div",{className:de("text-sm",l?"text-slate-500 line-through":"text-slate-500"),children:(0,se.jsx)("p",{children:"Publish your app and open it in a new tab to test the checkout experience"})}),!l&&(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:N,className:"gap-1.5 rounded-lg text-sm",children:[c?(0,se.jsx)(Ds.A,{className:"h-4 w-4"}):(0,se.jsx)(ob.A,{className:"h-4 w-4"}),c?"Copied!":"Copy Card Number"]})})]});case"claim-sandbox":return(0,se.jsxs)("div",{className:"flex flex-col gap-3 sm:gap-4 pl-[26px] pr-0 py-0",children:[(0,se.jsx)("p",{className:"text-sm text-slate-900",children:"Connect to your existing Stripe account or create a new one to start accepting real payments."}),(0,se.jsx)("div",{className:"flex gap-2",children:(0,se.jsxs)(Bx,{size:"sm",onClick:a,className:"gap-1.5 rounded-lg text-sm",children:[(0,se.jsx)(Rj.A,{className:"h-4 w-4"}),"Claim & Go Live"]})})]});case"add-keys":const e=!r;return(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-3 sm:gap-4 pl-[26px] pr-2 sm:pr-6 pb-3",children:[(0,se.jsxs)("p",{className:"text-sm text-neutral-500 leading-5",children:["Copy your live Publishable and Secret keys from your"," ",(0,se.jsx)("a",{href:"https://dashboard.stripe.com/apikeys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"Stripe Dashboard"})," ","to finish setup and enable real payments in your app."]}),(0,se.jsxs)("form",{onSubmit:w,className:"flex flex-col gap-3 sm:gap-4",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)(aN,{htmlFor:"publishable-key",className:"text-sm font-medium text-neutral-500",children:"Publishable key"}),(0,se.jsx)(Df,{id:"publishable-key",type:"text",placeholder:"Enter value",value:u,onChange:e=>m(e.target.value),disabled:e,className:de("text-sm",e&&"opacity-50")})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)(aN,{htmlFor:"secret-key",className:"text-sm font-medium text-neutral-500",children:"Secret key"}),(0,se.jsx)(Df,{id:"secret-key",type:"password",placeholder:"Enter value",value:x,onChange:e=>h(e.target.value),disabled:e,className:de("text-sm",e&&"opacity-50")})]})]}),(0,se.jsx)("div",{children:(0,se.jsx)(Bx,{type:"submit",size:"sm",disabled:e||p||!u||!x,className:de("rounded-lg text-sm",e&&"opacity-50"),children:p?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-1.5 animate-spin"}),"Saving..."]}):"Save API keys"})})]})]}),e&&(0,se.jsx)("div",{className:"bg-slate-100 border-t border-slate-200 rounded-b-lg py-2.5 sm:py-3 px-4 sm:px-6 -mx-3 sm:-mx-4 -mb-4 sm:-mb-5",children:(0,se.jsx)("p",{className:"text-sm text-slate-900",children:"To complete this step, claim sandbox and finish setup in Stripe"})})]});default:return null}};return(0,se.jsx)("div",{className:"flex flex-col gap-2",children:f.map(e=>{const t=b===e.id;return(0,se.jsx)(Qj,{open:t,onOpenChange:t=>j(t?e.id:null),children:(0,se.jsxs)("div",{className:de("rounded-lg transition-all",t?"bg-white":"hover:bg-slate-50"),children:[(0,se.jsx)(Xj,{asChild:!0,children:(0,se.jsxs)("button",{className:"flex items-center gap-2 sm:gap-3 w-full px-2 py-2 text-left transition-colors",children:[(0,se.jsx)("div",{className:"shrink-0",children:(s=e.completed,s?(0,se.jsx)("div",{className:"h-4 w-4 rounded-full bg-green-600 flex items-center justify-center",children:(0,se.jsx)(Ds.A,{className:"h-2.5 w-2.5 text-white",strokeWidth:3})}):(0,se.jsx)(ED.A,{className:"h-4 w-4 text-neutral-400",strokeWidth:1.5}))}),(0,se.jsx)("span",{className:de("flex-1 text-sm font-medium leading-tight",e.completed?"text-slate-500 line-through":"text-slate-900"),children:e.title}),(0,se.jsx)(_t.A,{className:de("h-4 w-4 text-slate-400 transition-transform duration-200 shrink-0",t&&"rotate-180")})]})}),(0,se.jsx)(ey,{className:"overflow-hidden data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down",children:(0,se.jsx)("div",{className:"px-2 pb-4 pt-1 sm:pl-[34px]",children:_(e.id)})})]})},e.id);var s})})}function ID(e){var t,s,a;let{onStatusChange:n,onRemove:l}=e;const{app:r}=lp(),{toast:i}=ao(),o=null==r||null===(t=r.payment_integrations)||void 0===t?void 0:t.stripe,c=!!o,[d,u]=(0,Y.useState)(c),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)(!0),[g,f]=(0,Y.useState)(!1),v=null!==(s=null==m?void 0:m.stripe_mode)&&void 0!==s?s:o,b=null!=v;(0,Y.useEffect)(()=>{null!=r&&r.id&&c&&j()},[null==r?void 0:r.id,c]),(0,Y.useEffect)(()=>{const e=()=>{"visible"===document.visibilityState&&null!=r&&r.id&&c&&j()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[null==r?void 0:r.id,c]);const j=async()=>{if(null!=r&&r.id){u(!0);try{const e=await SD.default.getIntegrationStatus(r.id,!0);x(e)}catch(t){var e;const s=t;null==s||null===(e=s.response)||void 0===e||e.status,x(null)}finally{u(!1)}}};return c?d?(0,se.jsx)("div",{className:"border border-slate-200 rounded-lg p-6 bg-white",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"h-12 w-12 rounded-lg border border-slate-200 bg-white flex items-center justify-center p-2",children:(0,se.jsx)(SE,{className:"w-full h-full"})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("h3",{className:"font-medium text-slate-900",children:"Stripe"}),(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-slate-400"})]}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Loading..."})]})]})}):b?(0,se.jsxs)("div",{className:"border border-slate-200 rounded-lg bg-white overflow-hidden",children:[(0,se.jsx)("div",{className:"p-4 sm:p-6",children:(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4 sm:gap-0",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"h-10 w-10 rounded-lg bg-[#635BFF] flex items-center justify-center shrink-0",children:(0,se.jsx)(SE,{className:"w-6 h-6 text-white"})}),(0,se.jsxs)("div",{className:"min-w-0",children:[(0,se.jsxs)("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1 mb-0.5",children:[(0,se.jsx)("h3",{className:"font-medium text-slate-900",children:"Stripe"}),v?"sandbox"===v?(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(gk,{variant:"secondary",className:"bg-amber-100 text-amber-800 hover:bg-amber-100 border-amber-200 px-2 py-0.5 h-6 font-medium",children:"Pending Setup"}),(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-slate-400 cursor-help"})}),(0,se.jsx)(pp,{children:(0,se.jsx)("p",{children:"Complete the setup guide to accept real payments"})})]})})]}):"live"===v?(0,se.jsx)(gk,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Live"}):null:null]}),(0,se.jsx)("p",{className:"text-sm text-slate-500 truncate",children:"live"===v?"Accepting real payments":(null==m?void 0:m.sandbox_account_id)||"{stripe account details}"})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 self-end sm:self-auto",children:["sandbox"===v&&(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>p(!h),className:"h-8 text-xs font-medium",children:h?"Hide Guide":"Show Guide"}),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,se.jsx)(Nv.A,{className:"h-4 w-4"})})}),(0,se.jsxs)(Aj,{align:"end",className:"w-[180px]",children:[(0,se.jsxs)(Sj,{onClick:()=>{const e=null!=m&&m.live_account_id?"https://dashboard.stripe.com/".concat(m.live_account_id):"https://dashboard.stripe.com/";window.open(e,"_blank")},children:[(0,se.jsx)(Rj.A,{className:"mr-2 h-4 w-4"}),"Go to Stripe"]}),(0,se.jsxs)(Sj,{onClick:()=>f(!0),children:[(0,se.jsx)(Oy.A,{className:"mr-2 h-4 w-4"}),"About Integration"]}),(0,se.jsxs)(Sj,{onClick:l,className:"text-red-600 focus:text-red-600 focus:bg-red-50",children:[(0,se.jsx)(zy.A,{className:"mr-2 h-4 w-4"}),"Remove"]})]})]})]})]})}),"sandbox"===v&&h&&(0,se.jsx)("div",{className:"px-4 sm:px-6 pb-6 pt-0 animate-in slide-in-from-top-2 duration-200",children:(0,se.jsx)("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-slate-100",children:(0,se.jsx)(TD,{onClaimSandbox:async()=>{if(null!=r&&r.id)if(Tu("Stripe Sandbox - Claim Started",{app_id:r.id}),null!=m&&m.sandbox_claim_url)window.open(m.sandbox_claim_url,"_blank");else try{const e=await SD.default.getClaimUrl(r.id),t=null==e?void 0:e.claim_url;t?window.open(t,"_blank"):i({title:"Unable to claim sandbox",description:"The sandbox may have expired or already been claimed. Please refresh the page.",variant:"destructive"})}catch(e){i({title:"Failed to get claim URL",description:"Please try again or refresh the page.",variant:"destructive"})}},onConfigureKeys:async(e,t)=>{null!=r&&r.id&&(await SD.default.configureLiveKeys(r.id,e,t),await j(),null==n||n())},hasTestedPayment:null!==(a=null==m?void 0:m.has_tested_payment)&&void 0!==a&&a,isSandboxClaimed:"claimed"===(null==m?void 0:m.sandbox_status),hasLiveKeys:(null==m?void 0:m.live_keys_configured)||!1})})}),(0,se.jsx)(Og,{open:g,onOpenChange:f,children:(0,se.jsxs)(Hg,{children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"About Stripe Integration"}),(0,se.jsxs)(Yg,{children:["Stripe allows you to accept payments, send payouts, and manage your business online. This integration enables you to:",(0,se.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,se.jsx)("li",{children:"Accept credit cards and other payment methods"}),(0,se.jsx)("li",{children:"Create products and subscriptions"}),(0,se.jsx)("li",{children:"Manage customers and billing"})]})]})]}),(0,se.jsx)(Wg,{children:(0,se.jsx)(Bx,{onClick:()=>f(!1),children:"Close"})})]})})]}):null:null}function PD(){var e,t,a,n,l;const{app:r}=lp(),{user:i}=wd(),{toast:o}=ao(),c=uh(),d=Uj(i,"builder"),u=(0,Y.useMemo)(()=>({source:"Switch Account",userId:c.user_id||null,conversationId:c.conversation_id||null,messageId:null,prompt:null,isInitialMessage:null}),[c]),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)([]),[g,f]=(0,Y.useState)(!0),[v,b]=(0,Y.useState)(null),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(null),[_,k]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)(null),[S,E]=(0,Y.useState)(null),T=(0,Y.useRef)(null),I=(0,Y.useRef)(!1),P=(0,Y.useRef)(!1),L=gu.useId();(0,Y.useEffect)(()=>{R()},[null==r?void 0:r.id]);const M=!(null==r||null===(e=r.payment_integrations)||void 0===e||!e.stripe);(0,Y.useEffect)(()=>{if(i)if(d){if(!g&&!I.current){I.current=!0;const e=h.length>0||M;x(e?"my-integrations":"browse")}}else I.current||(I.current=!0,x("browse"))},[g,h.length,d,i,M]),(0,Y.useEffect)(()=>()=>{T.current&&T.current()},[]),(0,Y.useEffect)(()=>{var e;d||!i||P.current||(P.current=!0,e=c,Tu(aE,(0,ue.A)({},e)),Vu(e,{cta:vE,origin:yE,target_route:null}))},[d,i,c,null==r?void 0:r.id]);const R=async()=>{if(null!=r&&r.id){f(!0);try{const e=await QS.listIntegrations(r.id);p(e.integrations)}catch(e){o({title:"Error",description:"Failed to load app connections",variant:"destructive"})}finally{f(!1)}}};return null===m?(0,se.jsx)(lL,{title:"Integrations",children:(0,se.jsx)(yD,{})}):(0,se.jsxs)(lL,{title:"Integrations",children:[(0,se.jsxs)(Kj,{value:m,onValueChange:e=>d&&x(e),children:[(0,se.jsxs)($j,{className:"rounded-lg bg-slate-200 w-fit grid grid-cols-2",children:[(0,se.jsx)(Zj,{value:"my-integrations",className:"rounded-md data-[state=active]:shadow-sm px-6",disabled:!d,children:"My integrations"}),(0,se.jsx)(Zj,{value:"browse",className:"rounded-md data-[state=active]:shadow-sm px-6",children:"Browse"})]}),d&&(0,se.jsxs)(Jj,{value:"my-integrations",className:"mt-4 space-y-4",children:[!g&&h.length>0&&(0,se.jsx)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-amber-500 shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-black",children:"Connected accounts may expose sensitive data to anyone with access."})]})}),(0,se.jsx)(ID,{onRemove:()=>w({integration_type:"stripe",user_email:"",scopes:[]})}),g?(0,se.jsx)(yD,{}):h.length>0?(0,se.jsx)(kD,{integrations:h,connectingIntegration:C,onConnectSwitchAccount:async e=>{if(null==r||!r.id)return;A(e.integration_type);const t=TE(e.integration_type),s=await AE({appId:r.id,integrationType:e.integration_type,scopes:e.scopes,forceReconnect:!0,trackingContext:u,onSuccess:async()=>{o({title:"Success",description:"Successfully switched account to ".concat(null==t?void 0:t.name)}),A(null),await R()},onError:e=>{o({title:"Error",description:e.message,variant:"destructive"}),A(null)},onCancel:()=>{o({title:"Cancelled",description:"App connection was cancelled"}),A(null)}});s?T.current=s:A(null)},onDisconnectClick:e=>{b(e)},onRemoveClick:e=>{w(e)},onShowScopes:E}):null!=r&&null!==(t=r.payment_integrations)&&void 0!==t&&t.stripe?null:(0,se.jsx)(rD,{})]}),(0,se.jsx)(Jj,{value:"browse",className:"mt-4",children:d?(0,se.jsx)(AD,{onStripeSetupComplete:()=>x("my-integrations")}):(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("div",{className:"blur-sm pointer-events-none select-none",children:(0,se.jsx)(AD,{})}),(0,se.jsx)(lD,{title:"Unlock this feature",description:"This feature is only available on the Builder plan or higher. Upgrade to continue working without limits",position:"upper",trackingOrigin:"connectors_upgrade_overlay",userId:null==i?void 0:i.id,appId:null==r?void 0:r.id,conversationId:L})]})})]}),(0,se.jsx)(Og,{open:!!S,onOpenChange:e=>!e&&E(null),children:(0,se.jsxs)(Hg,{children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{children:S&&"".concat(null===(a=TE(S.integration_type))||void 0===a?void 0:a.name," Access")})}),S&&(0,se.jsx)("div",{className:"flex flex-col gap-1 max-h-[500px] overflow-y-auto",children:S.scopes.map((e,t)=>(0,se.jsx)("span",{className:"inline-block px-2 py-0.5 bg-slate-100 text-blue-600 rounded text-sm w-fit",children:e},t))}),(0,se.jsx)(Wg,{children:(0,se.jsx)(Bx,{onClick:()=>E(null),children:"Done"})})]})}),(0,se.jsx)(Og,{open:!!v,onOpenChange:e=>!e&&b(null),children:(0,se.jsxs)(Hg,{children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Disconnect Account?"}),(0,se.jsx)(Yg,{className:"text-foreground",children:v&&(0,se.jsxs)("p",{children:["Access for ",(0,se.jsx)("span",{className:"font-semibold",children:v.user_email})," on ",(0,se.jsx)("span",{className:"font-semibold",children:null===(n=TE(v.integration_type))||void 0===n?void 0:n.name})," will be revoked.",(0,se.jsx)("br",{}),"The integration record will be preserved for future reconnection."]})})]}),(0,se.jsxs)(Wg,{children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>b(null),disabled:j,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:async()=>{if(!v||null==r||!r.id)return;y(!0);const e=TE(v.integration_type);try{await QS.disconnectIntegration(r.id,v.integration_type),_E((null==i?void 0:i.id)||null,r.id,v.integration_type,"Success"),o({title:"Success",description:"".concat(null==e?void 0:e.name," has been disconnected")}),await R()}catch(t){_E((null==i?void 0:i.id)||null,r.id,v.integration_type,"Failed",(null==t?void 0:t.message)||"unknown"),o({title:"Error",description:"Failed to disconnect app connection",variant:"destructive"})}finally{y(!1),b(null)}},disabled:j,className:"bg-red-600 hover:bg-red-700 text-white",children:j?"Disconnecting...":"Disconnect"})]})]})}),(0,se.jsx)(Og,{open:!!N,onOpenChange:e=>!e&&w(null),children:(0,se.jsxs)(Hg,{children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Remove Integration?"}),(0,se.jsx)(Yg,{className:"text-foreground",children:N&&(0,se.jsxs)("p",{children:[(0,se.jsx)("span",{className:"font-semibold",children:"stripe"===N.integration_type?"Stripe":null===(l=TE(N.integration_type))||void 0===l?void 0:l.name})," will be permanently removed from this app.",(0,se.jsx)("br",{}),"To create a connection again, you will need to set it up from scratch."]})})]}),(0,se.jsxs)(Wg,{children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>w(null),disabled:_,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:async()=>{if(N&&null!=r&&r.id){k(!0);try{if("stripe"===N.integration_type)await Promise.resolve().then(s.bind(s,83153)).then(e=>e.default.removeIntegration(r.id)),o({title:"Success",description:"Stripe integration has been removed"}),window.location.reload();else{const e=TE(N.integration_type);await QS.removeIntegration(r.id,N.integration_type),wE((null==i?void 0:i.id)||null,r.id,N.integration_type,"Success"),o({title:"Success",description:"".concat(null==e?void 0:e.name," has been removed")}),await R()}}catch(e){"stripe"!==N.integration_type&&wE((null==i?void 0:i.id)||null,r.id,N.integration_type,"Failed",(null==e?void 0:e.message)||"unknown"),o({title:"Error",description:"Failed to remove integration",variant:"destructive"})}finally{k(!1),w(null)}}},disabled:_,className:"bg-red-600 hover:bg-red-700 text-white",children:_?"Removing...":"Remove"})]})]})})]})}const LD=["value","onChange","language","readOnly","height","className","style","isSaving"],MD=e=>{let{value:t,onChange:s,language:a="javascript",readOnly:n=!1,height:l,className:r,style:i,isSaving:o}=e,c=(0,Nt.A)(e,LD);const d={};return l&&(d.height=l),(0,se.jsxs)("div",{className:"relative h-full",children:[(0,se.jsx)(pb.KE,(0,ue.A)((0,ue.A)({defaultLanguage:a,value:t,onChange:e=>{s&&!n&&s(e)},options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,readOnly:n}},d),c)),o&&(0,se.jsx)("div",{className:"absolute top-2 right-2 bg-gray-700 text-white text-xs px-2 py-1 rounded opacity-70",children:"Saving..."})]})};const RD=function(){var e;const{user:t}=wd(),{app:s}=lp(),[a,n]=(0,Y.useState)(!1),[l,r]=(0,Y.useState)(Object.keys(s.entities)[0]||"EntityName"),[i,o]=(0,Y.useState)("javascript"),c=(null===(e=s.entities[l])||void 0===e?void 0:e.properties)||{},d=Object.keys(c).join(", "),u="// JavaScript Example: Reading Entities\n// Filterable fields: ".concat(d,"\nasync function fetch").concat(l,"Entities() {\n    const response = await fetch(`").concat((0,fe.Gt)(),"/apps/").concat(s.id,"/entities/").concat(l,"`, {\n        headers: {\n            'api_key': '").concat(t.api_key,"', // or use await User.me() to get the API key\n            'Content-Type': 'application/json'\n        }\n    });\n    const data = await response.json();\n    console.log(data);\n}\n\n// JavaScript Example: Updating an Entity\n// Filterable fields: ").concat(d,"\nasync function update").concat(l,"Entity(entityId, updateData) {\n    const response = await fetch(`").concat((0,fe.Gt)(),"/apps/").concat(s.id,"/entities/").concat(l,"/${entityId}`, {\n        method: 'PUT',\n        headers: {\n            'api_key': '").concat(t.api_key,"', // or use await User.me() to get the API key\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(updateData)\n    });\n    const data = await response.json();\n    console.log(data);\n}"),m="# Python Example: Reading Entities\n# Filterable fields: ".concat(d,"\nimport requests\n\ndef make_api_request(api_path, method='GET', data=None):\n    url = f'").concat((0,fe.Gt)(),"/{api_path}'\n    headers = {\n        'api_key': '").concat(t.api_key,"',\n        'Content-Type': 'application/json'\n    }\n    if method.upper() == 'GET':\n        response = requests.request(method, url, headers=headers, params=data)\n    else:\n        response = requests.request(method, url, headers=headers, json=data)\n    response.raise_for_status()\n    return response.json()\n\nentities = make_api_request(f'apps/").concat(s.id,"/entities/").concat(l,"')\nprint(entities)\n\n# Python Example: Updating an Entity\n# Filterable fields: ").concat(d,"\ndef update_entity(entity_id, update_data):\n    response = requests.put(\n        f'").concat((0,fe.Gt)(),"/apps/").concat(s.id,"/entities/").concat(l,"/{entity_id}',\n        headers={\n            'api_key': '").concat(t.api_key,"',\n            'Content-Type': 'application/json'\n        },\n        json=update_data\n    )\n    response.raise_for_status()\n    return response.json()");return(0,se.jsx)(lL,{title:"API Integration",subtitle:"Get copy-paste examples for API integration.",children:(0,se.jsx)(Bv,{children:(0,se.jsx)(Wv,{className:"p-6",children:(0,se.jsx)(lL,{className:"gap-4 p-0 text-lg",title:(0,se.jsx)("div",{className:"font-normal",children:"Example: API Operations"}),subtitle:"Select an entity to generate code examples for reading and updating:",filters:[Object.keys(s.entities||{}).length>0?(0,se.jsx)("div",{className:"min-w-[180px]",children:(0,se.jsxs)(Wf,{value:l,onValueChange:e=>r(e),children:[(0,se.jsx)(Yf,{children:(0,se.jsx)(qf,{placeholder:"Select main page"})}),(0,se.jsx)($f,{children:Object.keys(s.entities).map(e=>(0,se.jsx)(Zf,{value:e,children:e},e))})]})}):null,(0,se.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,se.jsx)(Bx,{variant:"javascript"===i?"secondary":"ghost",onClick:()=>o("javascript"),className:"".concat("javascript"===i?"font-bold":""),children:"JavaScript"}),(0,se.jsx)(Bx,{variant:"python"===i?"secondary":"ghost",onClick:()=>o("python"),className:"".concat("python"===i?"font-bold":""),children:"Python"})]})],children:(0,se.jsxs)("div",{className:"border rounded-md p-2 relative",children:[(0,se.jsx)(MD,{value:"javascript"===i?u:m,language:i,readOnly:!0,height:"600px"}),(0,se.jsx)("div",{className:"absolute top-0 right-0",children:(0,se.jsx)(Bx,{variant:"outline",className:"w-9 m-2 shadow-lg",size:"sm",onClick:()=>(e=>{navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)})("javascript"===i?u:m),children:a?(0,se.jsx)(Ds.A,{className:"h-4 w-4"}):(0,se.jsx)(ob.A,{className:"h-4 w-4"})})})]})})})})})};var DD=s(68935),FD=s(51654);const OD=["onClick","saveSize","className","aria-label"],UD=(0,ft.cva)("rounded-full relative z-10",{variants:{saveSize:{sm:"h-5 w-5",default:"h-6 w-6",lg:"h-8 w-8",xl:"h-10 w-10"}},defaultVariants:{saveSize:"default"}});function BD(e){let{onClick:t,saveSize:s="default",className:a,"aria-label":n="Save"}=e,l=(0,Nt.A)(e,OD);const r="sm"===s?"h-3 w-3":"lg"===s?"h-5 w-5":"xl"===s?"h-6 w-6":"h-4 w-4";return(0,se.jsx)(Bx,(0,ue.A)((0,ue.A)({},l),{},{"aria-label":n,onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),l.disabled||t()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),l.disabled||t())},className:de(UD({saveSize:s}),a),children:(0,se.jsx)(Ds.A,{className:r,"aria-hidden":"true"})}))}function zD(e){let{initialText:t,onChange:s,className:a="",minWidth:n=60,maxWidth:l=280,validate:r}=e;const[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(t),[u,m]=(0,Y.useState)(t),[x,h]=(0,Y.useState)(n),[p,g]=(0,Y.useState)(!1),f=(0,Y.useRef)(null),v=(0,Y.useRef)(null),b=(0,Y.useRef)(null),j=()=>{if(b.current){const e=b.current.scrollWidth||b.current.offsetWidth,t=Math.min(Math.max(e,n),l),s=l;h(i?s:t),f.current&&(f.current.style.width="".concat(s,"px"))}};(0,Y.useEffect)(()=>{i&&f.current&&(f.current.focus(),j())},[i]),(0,Y.useEffect)(()=>{j()},[c,i,n,l]),(0,Y.useEffect)(()=>{d(t)},[t]);const y=()=>{m(c),o(!0)},N=()=>{g(!0),s(c),o(!1),g(!1)},w=()=>{d(u),o(!1)},_=()=>!r||r(c);return(0,se.jsxs)("div",{className:"inline-flex items-center group relative",children:[(0,se.jsxs)("div",{className:"relative",style:{minWidth:"".concat(n,"px"),maxWidth:"".concat(l,"px")},children:[i?(0,se.jsx)("input",{ref:f,type:"text",value:c,onChange:e=>{d(e.target.value)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),_()&&N()):"Escape"===e.key&&w()},onBlur:()=>{p||w()},className:"bg-transparent border-none outline-none p-0 m-0 ".concat(a),style:{font:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit",letterSpacing:"inherit",color:"inherit"}}):(0,se.jsx)("span",{ref:v,onClick:y,className:"cursor-pointer whitespace-nowrap overflow-hidden text-ellipsis block ".concat(a),children:c}),(0,se.jsx)("span",{ref:b,className:"absolute opacity-0 pointer-events-none whitespace-nowrap ".concat(a),style:{font:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit",letterSpacing:"inherit",top:0,left:0,zIndex:-1},children:c}),(0,se.jsx)("div",{className:"absolute bottom-0 left-0 h-0.5 transition-all duration-200 pointer-events-none ".concat(i?"bg-slate-400":"border-b-2 border-dashed border-slate-400 opacity-0 group-hover:opacity-100"),style:{width:"".concat(x,"px"),zIndex:1}})]}),(0,se.jsx)("div",{className:"ml-2 w-7 h-7 flex items-center justify-center relative",children:i?(0,se.jsx)(BD,{onClick:N,disabled:!_(),saveSize:"lg",variant:"outline"}):(0,se.jsx)(Qv.A,{className:"h-5 w-5 text-slate-400 cursor-pointer",onClick:y})})]})}var HD=s(6285),VD=s(72916);const WD=e=>{let{app:t,handleNavigate:s,isOpen:a}=e;const{publishUrl:n}=vy.usePublishUrl(),l=e=>{const a=t?"I've built ".concat(t.name," with @base_44!"):"Check out what I built with @base_44!",l=n;"twitter"===e?s("https://x.com/intent/tweet?text=".concat(encodeURIComponent(a))):"linkedin"===e&&s("https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(l)))};return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-secondary/20 p-4 rounded-lg space-y-3 border border-border",children:[(0,se.jsx)("h3",{className:"font-medium text-sm",children:"Sharing Guidelines"}),(0,se.jsxs)("ul",{className:"space-y-2.5 text-sm text-muted-foreground",children:[(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Tag ",(0,se.jsx)("span",{className:"font-medium text-foreground",children:"@base_44"})]}),(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Write at least 200 characters about your experience building with Base44"]}),(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Account must have over 100 followers"]}),(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Add a screenshot or video of your project (optional)"]}),(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Add a link to your project (optional)"]}),(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-1.5 w-1.5 self-start translate-y-2 rounded-full bg-primary/70"}),(0,se.jsxs)("div",{className:"inline",children:["Open a ticket, at "," ",(0,se.jsx)("button",{type:"button",onClick:()=>{const e=null!=t&&t.id?"/support?appId=".concat(t.id):"/support";s(e,"_blank")},className:"underline text-primary hover:text-orange-500 transition-colors",children:"support system"}),", with the link to your post"]})]})]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)(zt,{variant:"outline",className:"w-full justify-start gap-2 font-normal",onClick:()=>l("linkedin"),children:[(0,se.jsx)(HD.A,{className:"h-4 w-4"}),"Share on LinkedIn"]}),(0,se.jsxs)(zt,{variant:"outline",className:"w-full justify-start gap-2 font-normal",onClick:()=>l("twitter"),children:[(0,se.jsx)(VD.A,{className:"h-4 w-4"}),"Share on X (Twitter)"]})]})]})},qD=e=>{let{app:t,isOpen:s,onClose:a}=e;return(0,se.jsx)(ma,{open:s,onOpenChange:a,children:(0,se.jsxs)(fa,{className:"sm:max-w-[625px]",children:[(0,se.jsxs)(va,{children:[(0,se.jsx)("div",{className:"flex justify-between items-center",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(DD.A,{className:"h-5 w-5 text-primary"}),(0,se.jsx)(ja,{className:"text-xl",children:t?"Share ".concat(t.name):"Share Project"})]})}),(0,se.jsx)(ya,{className:"text-sm text-muted-foreground",children:"Share your project and earn 20 free credits to keep building!"})]}),(0,se.jsx)(WD,{app:t,isOpen:s,handleNavigate:function(e){gd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank")}})]})})};function YD(e){let{onClosePublish:t}=e;const{app:s}=lp(),a=(0,J.Zp)(),{hasFlag:n}=ej(),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),c=(e=>{if(!e||!e.entities)return!1;const t=Object.values(e.entities),s=t.length>0&&t.some(e=>!e.rls),a="public_without_login"===e.public_settings||"public_with_login"===e.public_settings;return s&&a})(s),d="security-warning-dismissed-".concat(s.id),u=n("show-publish-security-warning");(0,Y.useEffect)(()=>{"true"===localStorage.getItem(d)&&r(!0)},[d]);const m=()=>{i||(o(!0),t&&t(),a("/apps/".concat(s.id,"/editor/workspace/security?autoStartScan=1")),o(!1))};return c&&!l&&u?(0,se.jsx)("div",{className:"pt-2",children:(0,se.jsx)(Dt,{variant:"destructive",className:"border-amber-300 bg-amber-100 text-gray-800 p-3",children:(0,se.jsx)("div",{className:"flex items-start justify-between w-full",children:(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("div",{className:"font-semibold text-gray-800 text-sm mb-1",children:(0,se.jsx)("span",{children:"Your app data is publicly accessible"})}),(0,se.jsxs)(Ot,{className:"text-gray-800 text-sm ",children:["Run a security scan and follow the recommendations to protect it.",(0,se.jsx)("div",{className:"mt-3",children:(0,se.jsx)(zt,{size:"sm",onClick:m,disabled:i,className:"bg-amber-300 hover:bg-amber-400 text-gray-800 font-medium h-6 px-4 py-4 rounded-md",children:i?"Starting scan\u2026":"Run Security Scan"})})]})]})})})}):null}var GD=s(61165);function KD(e){let{app:t}=e;const{workspaces:s}=qd(),{user:a}=wd(),{toast:n}=ao(),[l,r]=((0,J.Zp)(),(0,Y.useState)(!1)),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(!1),u=(null==t?void 0:t.organization_id)===(null==a?void 0:a.organization_id),m=(null==t?void 0:t.organization_id)===(null==a?void 0:a.personal_organization_id),x=null==s?void 0:s.find(e=>e.id===(null==t?void 0:t.organization_id)),h=!0===(null==x?void 0:x.is_personal),p=u||m||h,g=(null==s?void 0:s.filter(e=>!e.is_personal&&e.id!==(null==a?void 0:a.personal_organization_id)&&e.user_role))||[];return p?0===g.length?null:(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Es,{className:"mt-4",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-base font-semibold",children:"Move to Workspace"}),(0,se.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:"Move this app from your personal workspace to a shared workspace"})]}),(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>r(!0),className:"gap-1.5",children:[(0,se.jsx)(GD.A,{className:"w-3.5 h-3.5"}),"Move App"]})]})})}),(0,se.jsx)(ma,{open:l,onOpenChange:r,children:(0,se.jsxs)(fa,{className:"sm:max-w-md",children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:"Move App to Workspace"}),(0,se.jsx)(ya,{children:"Select a workspace to move this app to. This action cannot be undone."})]}),(0,se.jsxs)("div",{className:"py-4 space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Target Workspace"}),(0,se.jsxs)(br,{value:i,onValueChange:o,children:[(0,se.jsx)(Nr,{children:(0,se.jsx)(yr,{placeholder:"Select a workspace"})}),(0,se.jsx)(kr,{children:g.map(e=>(0,se.jsx)(Ar,{value:e.id,children:e.name},e.id))})]})]}),(0,se.jsxs)("div",{className:"text-sm text-gray-600 space-y-2",children:[(0,se.jsxs)("p",{children:["\u26a0\ufe0f ",(0,se.jsx)("strong",{children:"Important:"})]}),(0,se.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,se.jsx)("li",{children:"The app will be moved to the selected workspace"}),(0,se.jsx)("li",{children:"Future usage will count against the new workspace's credits"}),(0,se.jsx)("li",{children:"Workspace members with appropriate permissions will gain access"}),(0,se.jsx)("li",{children:"You will retain ownership as the app creator"})]})]})]}),(0,se.jsxs)(ba,{children:[(0,se.jsx)(zt,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),(0,se.jsx)(zt,{onClick:async()=>{if(i){d(!0);try{await zc.moveToWorkspace(t.id,i),n({title:"Success",description:"App moved to workspace successfully"}),window.location.reload()}catch(a){var e,s;n({title:"Error",description:(null===(e=a.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to move app to workspace",variant:"destructive"})}finally{d(!1),r(!1)}}else n({title:"Error",description:"Please select a target workspace",variant:"destructive"})},disabled:!i||c,children:c?"Moving...":"Move App"})]})]})})]}):null}function $D(){var e,t,s;const{app:a,pageNames:n,updateApp:l}=lp(),{isInSharedWorkspace:r}=pS(),{settings:i,userRole:o,isEnterpriseWorkspace:c}=wR(),d=(0,J.Zp)(),{toast:u}=ao(),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(""),{publishUrl:N}=vy.usePublishUrl(),{isNativeMobile:w,actions:_}=fd();(0,Y.useEffect)(()=>{a.user_description&&y(a.user_description)},[a.user_description]);return(0,se.jsxs)("div",{className:"h-full bg-gray-50 p-4 sm:p-6",children:[(0,se.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,se.jsxs)("div",{className:"space-y-6 mb-8",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center",children:[(0,se.jsxs)("div",{className:"relative cursor-pointer",onClick:()=>{dS.openModal("AppLogoModal")},children:[(0,se.jsx)("div",{className:"h-full w-full pointer-events-auto bg-[rgba(0,0,0,0.4)] flex opacity-0 hover:opacity-100 transition-opacity duration-300 absolute rounded-xl items-center justify-center",children:(0,se.jsx)(Qv.A,{color:"white",className:"h-5 w-5"})}),(0,se.jsx)("div",{className:"shrink-0 w-16 sm:w-20 h-16 sm:h-20 rounded-xl bg-white shadow p-0 flex items-center justify-center",children:a.logo_url?(0,se.jsx)("img",{src:a.logo_url,alt:"".concat(a.name," logo"),className:"w-full h-full object-contain rounded-xl"}):(0,se.jsx)("div",{className:"p-1 bg-gray-100 rounded-xl flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-xl font-bold text-gray-400",children:(null===(e=a.name)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())||"A"})})})]}),(0,se.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between flex-wrap",children:[(0,se.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:(0,se.jsx)(zD,{initialText:a.name||"untitled",onChange:async e=>{var t;"ready"===(null===(t=a.status)||void 0===t?void 0:t.state)?0!==e.length?l({name:e}):u({title:"Error",description:"App name cannot be empty",variant:"destructive"}):u({title:"Error",description:"App is still loading... name not updated",variant:"destructive"})},validate:e=>e.trim().length>0})}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>{l({is_starred:!a.is_starred}),u({title:a.is_starred?"Removed from favorites":"Added to favorites",description:a.is_starred?"App removed from your starred list":"App added to your starred list"})},className:"hover:bg-yellow-100 transition-colors ".concat(a.is_starred?"text-yellow-500":"text-gray-400"),children:(0,se.jsx)(fv.A,{className:"h-4 w-4 ".concat(a.is_starred?"fill-current":"")})})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:a.user_description}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>{y(a.user_description||""),b(!0)},className:"mt-1 p-1 pr-3 h-auto",children:(0,se.jsx)(Qv.A,{className:"h-3 w-3 text-gray-400"})})]}),(0,se.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Created ",He().utc(a.created_date).fromNow()]})]})]}),(0,se.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,se.jsxs)(zt,{variant:"outline",onClick:()=>{if(w)return void _.onItemClicked({id:"editor.openApp"});const e=Array.from(null!=n?n:[]);e.length>0&&d("/apps/".concat(a.id,"/editor/preview/").concat(e[0]))},className:"gap-1.5 w-36 h-10",children:[(0,se.jsx)(Rj.A,{className:"w-4 h-4"}),"Open App"]}),(0,se.jsxs)(zt,{variant:"outline",onClick:()=>p(!0),className:"gap-1.5 w-36 h-10",children:[(0,se.jsx)(DD.A,{className:"w-4 h-4 ml-[-8px]"}),(0,se.jsxs)("div",{className:"flex flex-col items-start",children:[(0,se.jsx)("span",{className:"mb-[-6px]",children:"Share App"}),(0,se.jsx)("span",{className:"text-[9px] mb-[-3px] text-gray-500",children:"win free credits!"})]})]})]})]}),(0,se.jsx)("div",{className:"relative flex w-full  mb-4",children:(0,se.jsx)(tS,{})}),(0,se.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,se.jsx)(Es,{children:(0,se.jsxs)(Ls,{className:"p-4",children:[(0,se.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-base font-semibold",children:"App Visibility"}),(0,se.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:"Control who can access your application"})]})}),(0,se.jsxs)("div",{children:[(0,se.jsx)(IR,{value:a.public_settings||"private_with_login",onValueChange:async e=>{x(!0);try{await l({public_settings:e})}finally{x(!1)}},disabled:m,showWorkspace:r,allowedOptions:_R(a.public_settings,i,o,c)}),(0,se.jsx)(YD,{})]})]})}),(0,se.jsx)(Es,{children:(0,se.jsxs)(Ls,{className:"p-4",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-base font-semibold mb-1",children:"Invite Users"}),(0,se.jsx)("p",{className:"text-gray-600 text-xs",children:"Grow your user base by inviting others"})]}),(0,se.jsx)(eb.A,{className:"w-4 h-4 text-gray-400"})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsxs)(zt,{variant:"outline",className:"w-full h-10 text-sm",onClick:()=>{return e=N,navigator.clipboard.writeText(e),f(!0),void setTimeout(()=>f(!1),2e3);var e},children:[(0,se.jsx)(ob.A,{className:"w-3 h-3 mr-1"}),g?"Copied!":"Copy Link"]}),(0,se.jsx)(zt,{className:"w-full h-10 text-sm bg-blue-600 hover:bg-blue-700",onClick:()=>dS.openModal("InviteUser"),children:"Send Invites"})]})]})})]}),(null===(s=a.payment_integrations)||void 0===s?void 0:s.stripe)&&(0,se.jsx)(Es,{className:"mt-4",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,se.jsx)(SE,{className:"h-5 w-5 shrink-0"}),(0,se.jsx)("h3",{className:"text-base font-semibold",children:"Payments via Stripe"}),"sandbox"===a.payment_integrations.stripe?(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(gs,{variant:"secondary",className:"bg-amber-100 text-amber-800 hover:bg-amber-100 border-amber-200 px-2 py-0.5 h-6 font-medium",children:"Pending Setup"}),(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-slate-400 cursor-help"})}),(0,se.jsx)(Ki,{children:(0,se.jsx)("p",{children:"Complete the setup guide to accept real payments"})})]})})]}):(0,se.jsx)(gs,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Live"})]}),(0,se.jsx)("p",{className:"text-gray-600 text-xs",children:"sandbox"===a.payment_integrations.stripe?"You're still in test mode. Finish setup to start receiving payments.":"Your app is ready to accept payments via Stripe."})]}),"sandbox"===a.payment_integrations.stripe&&(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>{d("/apps/".concat(a.id,"/editor/workspace/app-connections"))},children:"Continue Setup"})]})})}),(0,se.jsx)(KD,{app:a}),!0===a.is_remixable&&(0,se.jsx)(Es,{className:"mt-4",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-base font-semibold",children:"Platform Badge"}),(0,se.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:'The "Edit with Base44" badge is currently visible on your app.'})]}),(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>{d("/apps/".concat(a.id,"/editor/workspace/app-settings?selectedParam=platform-badge"))},className:"gap-1.5",children:[(0,se.jsx)(FD.A,{className:"w-3.5 h-3.5"}),"Hide Badge"]})]})})})]}),(0,se.jsx)(qD,{app:a,isOpen:h,onClose:()=>p(!1)}),(0,se.jsx)(ma,{open:v,onOpenChange:b,children:(0,se.jsxs)(fa,{className:"sm:max-w-md",children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:"Edit App Description"}),(0,se.jsx)(ya,{children:"Provide a brief description of your app's purpose and functionality."})]}),(0,se.jsx)("div",{className:"py-4",children:(0,se.jsx)(ki,{value:j,onChange:e=>y(e.target.value),placeholder:"Describe your app...",className:"min-h-[100px]"})}),(0,se.jsxs)(ba,{children:[(0,se.jsx)(zt,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),(0,se.jsx)(zt,{onClick:async()=>{try{await l({user_description:j}),b(!1),u({title:"Description updated",description:"Your app description has been updated successfully"})}catch(e){u({title:"Error",description:"Failed to update app description",variant:"destructive"})}},children:"Save"})]})]})})]})}const ZD=function(){const{app:e}=lp(),[t,s]=(0,Y.useState)(1),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)({userEmail:"",showFailuresOnly:!1,logType:"all"}),{data:i,isLoading:o,refetch:c}=Xd({query:async()=>{const{userEmail:s,showFailuresOnly:a,logType:n}=l;let r=(0,ue.A)((0,ue.A)((0,ue.A)({},s&&{user_email:s}),a&&{status:"error"}),"all"!==n&&{log_type:n});return Cc.fetchLogs(e.id,{sort:"-created_date",q:r,skip:50*(t-1),limit:50})},initialData:[],enabled:!(null==e||!e.id),logErrorMsg:"Error fetching logs"},[null==e?void 0:e.id,l,t,50]),d=e=>{switch(e){case"error":return(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("div",{children:(0,se.jsx)(ad.A,{className:"text-destructive",size:16})})}),(0,se.jsx)(Ki,{children:(0,se.jsx)("p",{children:"Error"})})]})});case"success":return(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("div",{children:(0,se.jsx)(sd.A,{className:"text-success",size:16})})}),(0,se.jsx)(Ki,{children:(0,se.jsx)("p",{children:"Success"})})]})});default:return(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("div",{children:(0,se.jsx)(Oy.A,{className:"text-primary",size:16})})}),(0,se.jsx)(Ki,{children:(0,se.jsx)("p",{children:"Info"})})]})})}},u=[...new Set(i.map(e=>e.log_type))];return(0,se.jsxs)(lL,{title:"Logs Explorer",subtitle:"Monitor system logs across your application.",actions:[(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{c()},children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-1"}),"Refresh"]}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",disabled:!0,children:"Export Logs"})],filters:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(na.A,{className:"h-4 w-4 text-muted-foreground"}),(0,se.jsx)(nl,{placeholder:"Filter by email...",className:"h-8 w-44",value:l.userEmail,onChange:e=>r(t=>(0,ue.A)((0,ue.A)({},t),{},{userEmail:e.target.value}))})]}),(0,se.jsxs)(br,{value:l.logType,onValueChange:e=>r(t=>(0,ue.A)((0,ue.A)({},t),{},{logType:e})),children:[(0,se.jsx)(Nr,{className:"h-8 w-36",children:(0,se.jsx)(yr,{placeholder:"Log type"})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"all",children:"All types"}),u.map(e=>(0,se.jsx)(Ar,{value:e,children:e},e))]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(Os,{id:"showFailures",checked:l.showFailuresOnly,onCheckedChange:e=>r(t=>(0,ue.A)((0,ue.A)({},t),{},{showFailuresOnly:!!e}))}),(0,se.jsx)("label",{htmlFor:"showFailures",className:"text-sm cursor-pointer",children:"Errors only"})]}),(0,se.jsxs)(Bx,{className:"w-min",variant:"ghost",size:"sm",onClick:()=>r({userEmail:"",showFailuresOnly:!1,logType:"all"}),children:[(0,se.jsx)(la.A,{className:"h-3.5 w-3.5 md:mr-1"}),"Clear"]})],children:[o?(0,se.jsx)("div",{className:"flex h-40 items-center justify-center",children:(0,se.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):(0,se.jsx)("div",{className:"rounded-md border bg-card",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{className:"w-12"}),(0,se.jsx)(hi,{children:"Type"}),(0,se.jsx)(hi,{children:"User"}),(0,se.jsx)(hi,{children:"Timestamp"}),(0,se.jsx)(hi,{className:"w-10"})]})}),(0,se.jsx)(ui,{children:0===i.length?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:5,className:"h-32 text-center text-muted-foreground",children:"No logs found"})}):i.map((e,t)=>{return(0,se.jsxs)(Y.Fragment,{children:[(0,se.jsxs)(xi,{className:(null==a?void 0:a.created_date)===e.created_date?"bg-muted/50":"",children:[(0,se.jsx)(pi,{className:"pr-0",children:d(e.status)}),(0,se.jsx)(pi,{className:"font-medium",children:e.object_name||e.log_type}),(0,se.jsx)(pi,{className:"text-sm text-muted-foreground",children:e.user_email}),(0,se.jsx)(pi,{className:"text-sm text-muted-foreground",children:(s=e.created_date,new Date(s).toLocaleString())}),(0,se.jsx)(pi,{className:"text-right",children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>n((null==a?void 0:a.created_date)===e.created_date?null:e),children:(null==a?void 0:a.created_date)===e.created_date?(0,se.jsx)(ur.A,{size:16}):(0,se.jsx)(_t.A,{size:16})})})]}),(null==a?void 0:a.created_date)===e.created_date&&(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:5,className:"p-0",children:(0,se.jsx)("div",{className:"bg-muted/30 px-6 py-3",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"mb-2 text-sm font-semibold",children:"Inputs"}),(0,se.jsx)("pre",{className:"max-h-60 overflow-auto rounded bg-card p-2 text-xs",children:JSON.stringify(e.inputs,null,2)})]}),e.outputs&&(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"mb-2 text-sm font-semibold",children:"Outputs"}),(0,se.jsx)("pre",{className:"max-h-60 overflow-auto rounded bg-card p-2 text-xs",children:JSON.stringify(e.outputs,null,2)})]}),e.error&&(0,se.jsxs)("div",{className:e.outputs?"col-span-2":"",children:[(0,se.jsx)("h4",{className:"mb-2 text-sm font-semibold text-destructive",children:"Error"}),(0,se.jsx)("pre",{className:"max-h-60 overflow-auto rounded bg-destructive/10 p-2 text-xs text-destructive-foreground",children:e.error})]})]})})})})]},t);var s})})]})}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",disabled:1===t,onClick:()=>s(e=>Math.max(1,e-1)),children:"Previous"}),(0,se.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",t]}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",disabled:i.length<50,onClick:()=>s(e=>e+1),children:"Next"})]})]})},JD=e=>{let{dashboards:t}=e;return(0,se.jsx)("div",{className:"flex h-full w-full",children:(0,se.jsx)("div",{className:de("sm:grid sm:grid-cols-6 sm:auto-rows-min flex flex-col w-full h-full gap-4 bg-transparent"),children:t.map((e,t)=>{let{span:s,Component:a,hidden:n,name:l}=e;return n?null:(0,se.jsx)("div",{className:de("flex sm:min-h-20 h-full w-full sm:col-span-".concat(s," bg-transparent"),"bg-white border border-gray-200 rounded-[14px] shadow-sm"),children:a},"dashboard-layout-item-".concat(l,"-").concat(t))})})})},QD=e=>{let{requiresUpgrade:t}=e;return(0,se.jsx)("div",{className:"flex flex-col items-center justify-center h-full w-full min-h-[200px] min-w-[200px] p-4",children:(0,se.jsx)("div",{className:"flex flex-col items-center justify-center h-full w-full min-h-[200px] min-w-[200px] border border-dashed border-gray-200 rounded-lg",children:(0,se.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center h-full w-full min-h-[200px] min-w-[200px] hover:bg-slate-50 hover:cursor-pointer",children:[t?(0,se.jsx)(my,{}):(0,se.jsx)(op.A,{className:"w-8 h-8"}),(0,se.jsx)("p",{className:"text-sm text-foreground",children:"Create custom event"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground px-16 text-center",children:"Measure specific actions users take in your app."})]})})})},XD=["className","classNames","showOutsideDays"];function eF(e){let{className:t,classNames:s,showOutsideDays:a=!0}=e,n=(0,Nt.A)(e,XD);return(0,se.jsx)(Ns,(0,ue.A)({className:t,classNames:s,showOutsideDays:a},n))}eF.displayName="Calendar";const tF=e=>{let{onRefreshClicked:t}=e;const s=OA.useTimeRange(),a=OA.useSelectedTimeFilter(),n=(0,Y.useMemo)(()=>a||(s.from&&s.to?"".concat((0,z_.GP)(s.from,"LLL dd, y")," - ").concat((0,z_.GP)(s.to,"LLL dd, y")):"Pick a date range"),[s,a]);return(0,se.jsxs)("div",{className:"flex flex-row w-auto h-auto gap-2 ",children:[(0,se.jsx)(Bx,{variant:"outline",size:"tiny",onClick:()=>{null==t||t(),OA.refreshTimeRange()},children:(0,se.jsx)(Fx.A,{className:"w-4 h-4"})}),(0,se.jsxs)(mS,{children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"outline",size:"tiny",children:[(0,se.jsx)(H_.A,{className:"mr-2 h-4 w-4"}),n]})}),(0,se.jsx)(hS,{align:"start",className:"flex w-full h-full p-0",children:(0,se.jsx)(sF,{})})]})]})},sF=()=>{const e=OA.useSelectedTimeFilter(),t=OA.useTimeRange(),[s,a]=Y.useState(t),n=cy();(0,Y.useEffect)(()=>{null!=t&&t.from&&null!=t&&t.to&&a({from:t.from,to:t.to})},[null==t?void 0:t.from,null==t?void 0:t.to]);const l=e=>{var t,s;const a=null===(t=e.from)||void 0===t?void 0:t.getTime(),n=null===(s=e.to)||void 0===s?void 0:s.getTime();if(a&&n&&a<n){const[e,t]=[a,n].sort((e,t)=>e-t);OA.setTimeRange({from:new Date(e),to:new Date(t)})}};return(0,se.jsxs)("div",{className:"flex flex-row w-full h-full",children:[(0,se.jsxs)("div",{className:"p-2 flex flex-col w-full bg-slate-50 text-base44  ",children:[OA.timeFilters.map(e=>(0,se.jsx)(aF,{filter:e},e)),(0,se.jsxs)(Bx,{variant:"ghost",className:de("justify-between  hover:bg-slate-200 rounded-[8px] px-2",{"font-bold":null===e}),onClick:()=>{if(n)return dy();OA.setTimeFilter(null),l(s)},children:["Custom Range",n?(0,se.jsx)(uy,{}):(0,se.jsx)(bs.A,{className:de("w-2 h-2")})]})]}),(0,se.jsx)("div",{className:de("p-0 border-l-[1px] border-slate-200 flex flex-col gap-4  bg-white text-base44 ",{"pointer-events-none opacity-50":n}),children:(0,se.jsx)(eF,{mode:"range",defaultMonth:t.from,selected:s,onSelect:e=>{var t,n;if(null!=e&&e.from&&null!=e&&e.to)if(s.from&&s.to){var r,i;const[t,n]=[s.from.getTime(),s.to.getTime()].sort((e,t)=>e-t),[l,o]=[null!==(r=null===(i=e.to)||void 0===i?void 0:i.getTime())&&void 0!==r?r:0,e.from.getTime()].sort((e,t)=>e-t);a({from:new Date(l===t||l===n?o:l),to:null})}else a(e),l(e);else a({from:null!==(t=null!==(n=null==e?void 0:e.from)&&void 0!==n?n:null==e?void 0:e.to)&&void 0!==t?t:s.from,to:null})}})})]})},aF=e=>{let{filter:t}=e;const{app:s}=lp(),a=OA.useSelectedTimeFilter(),n=cy()&&!OA.useIsEnabledForFreeUser(t);return(0,se.jsxs)(Bx,{variant:"ghost",className:de("justify-between  hover:bg-slate-200 rounded-[8px] px-2",{"font-bold":a===t}),onClick:()=>{if(n)return dy("analytics_date_filter");Tu("Analytics - Filter applied",{filter_type:"time",value:t,app_id:null==s?void 0:s.id}),OA.setTimeFilter(t)},children:[t,n&&(0,se.jsx)(uy,{})]},t)},nF=e=>{let{text:t}=e;return(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{delayDuration:100,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-slate-400 hover:text-slate-600 transition-colors"})}),(0,se.jsx)(pp,{alignOffset:-20,align:"start",side:"top",className:"max-w-[260px] bg-slate-900 text-white text-xs border-none shadow-lg px-3 py-2",children:(0,se.jsx)("p",{children:t})})]})})},lF=e=>{let{text:t,children:s,disabled:a}=e;return a?(0,se.jsx)(se.Fragment,{children:s}):(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{delayDuration:100,children:[(0,se.jsx)(hp,{asChild:!0,children:s}),(0,se.jsx)(pp,{side:"top",className:"max-w-[260px] bg-slate-900 text-white text-xs border-none shadow-lg px-3 py-2",children:(0,se.jsx)("p",{children:t})})]})})},rF=e=>{let{stats:t}=e;const[s,a]=Y.useState(0),n=Y.useMemo(()=>t[s],[t,s]);return(0,se.jsxs)("div",{className:"flex flex-col w-full h-full font-base44 rounded-lg gap-2",children:[(0,se.jsx)("div",{className:"flex flex-row w-full border-b border-slate-200 bg-slate-50",children:t.map((e,t)=>{let{tab:n}=e;return(0,se.jsx)("div",{className:de("cursor-pointer","flex bg-slate-50 justify-start self-start border-r border-slate-200 ",{"bg-white shadow-sm":s===t}),onClick:()=>a(t),children:n},"stats-group-layout-tab-".concat(t))})}),(0,se.jsx)("div",{className:"flex w-full h-full min-h-[200px] p-6",children:null==n?void 0:n.graph})]})};const iF=s.p+"static/media/analytics_trend_down.7d15f1427181f61122382ea7ab15be1a.svg";const oF=s.p+"static/media/analytics_trend_up.8a31fda7071b26280b4766ca739de578.svg";var cF=s(25391);const dF=e=>{let{label:t,count:s,change:a,postfix:n}=e;const l="number"==typeof s&&isNaN(s)?0:s,r=isNaN(a)||0===a?void 0:a;return(0,se.jsx)("div",{className:"flex p-4 font-base44 justify-center items-center w-full aspect-auto",children:(0,se.jsxs)("div",{className:"flex flex-col gap-2 items-start",children:[(0,se.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,se.jsx)("div",{className:"flex text-sm text-gray-500",children:t}),n]}),(0,se.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,se.jsx)("div",{className:"text-lg",children:l}),r&&(0,se.jsxs)("div",{className:"text-sm text-gray-500 flex flex-row gap-1",children:[r>0?(0,se.jsx)("img",{src:oF,alt:"trend up",className:"w-4 h-4"}):(0,se.jsx)("img",{src:iF,alt:"trend down",className:"w-4 h-4"}),(0,se.jsxs)("span",{className:de(r>0?"text-green-500":"text-red-500"),children:[r,"%"]})]})]})]})})},uF=e=>{let{label:t,count:s,change:a,postfix:n}=e;const l="number"==typeof s&&isNaN(s)?0:s,r=isNaN(a)||0===a?void 0:a;return(0,se.jsxs)("div",{className:"flex flex-row w-full items-center justify-between",children:[(0,se.jsx)("span",{className:"text-sm font-medium",children:t}),(0,se.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,se.jsx)("span",{className:"text-sm font-medium",children:l}),r&&(0,se.jsxs)("span",{className:de("flex flex-row gap-1 text-sm font-medium",r>0?"text-green-500":"text-red-500"),children:[r>0?(0,se.jsx)(Pf.A,{className:"w-4 h-4"}):(0,se.jsx)(cF.A,{className:"w-4 h-4"}),r,"%"]})]})]})},mF=e=>{let{data:t,metricConverter:s,range:a,color:n="#F97316",title:l}=e;return(0,se.jsxs)("div",{className:"flex flex-col gap-0 py-3",children:[(0,se.jsx)("div",{className:"flex flex-row px-5",children:l}),(0,se.jsx)("div",{className:"flex flex-col px-5 min-h-[200px]",children:(0,se.jsx)(nA,{data:t,metricConverter:s,range:a,color:n})})]})},xF=e=>{let{timeRange:t}=e;return qu()?(0,se.jsx)(pF,{timeRange:t}):(0,se.jsx)(gF,{timeRange:t})},hF=e=>{const t=OA.useBuiltInFiltersClickHouseQuery();return{dateTimeConverter:(0,Y.useMemo)(()=>{const t=(e=>(0,LC.c)(e.to,e.from))(e);return t>1?DC.date:DC.time},[e.from,e.to]),graphTimeRange:(0,Y.useMemo)(()=>[e.from.getTime(),e.to.getTime()],[e]),visits:GC(uA,e,{categoryName:"Date",valueName:"Visits",func:"count"},{query:t}),uniqueUsers:GC(uA,e,{categoryName:"Date",valueName:"UniqueUsers",func:"count_unique",field:"session_id"},{query:t}),visitDuration:GC("__session_duration_event__",e,{categoryName:"Date",valueName:"VisitDuration",func:"avg",field:"properties.sessionDuration"},{query:t})}},pF=e=>{var t,s,a;let{timeRange:n}=e;const{dateTimeConverter:l,graphTimeRange:r,visits:i,uniqueUsers:o,visitDuration:c}=hF(n);return(0,se.jsxs)(YC,{className:"min-h-[350px] flex flex-col",isLoading:i.isLoading||o.isLoading||c.isLoading,children:[(0,se.jsx)(mF,{data:i.data,metricConverter:{category:l,value:DC.count},range:r,color:"#F97316",title:(0,se.jsx)(uF,{label:"Total Visits",count:null!==(t=i.total)&&void 0!==t?t:0,change:i.changePct})}),(0,se.jsx)(ly,{className:"h-[10px] bg-slate-100"}),(0,se.jsx)(mF,{data:o.data,metricConverter:{category:l,value:DC.count},range:r,color:"#9D2A90",title:(0,se.jsx)(uF,{label:"Unique Visitors",count:null!==(s=o.total)&&void 0!==s?s:0,change:o.changePct})}),(0,se.jsx)(ly,{className:"h-[10px] bg-slate-100"}),(0,se.jsx)(mF,{data:c.data,metricConverter:{category:l,value:DC.duration},range:r,color:"#0EA5E9",title:(0,se.jsx)(uF,{label:"Visit Duration",count:DC.duration.formatter(null!==(a=c.total)&&void 0!==a?a:0),change:c.changePct})})]})},gF=e=>{var t,s,a;let{timeRange:n}=e;const{dateTimeConverter:l,graphTimeRange:r,visits:i,uniqueUsers:o,visitDuration:c}=hF(n);return(0,se.jsx)(YC,{className:"min-h-[350px]",isLoading:i.isLoading||o.isLoading||c.isLoading,children:(0,se.jsx)(rF,{stats:[{tab:(0,se.jsx)(dF,{label:"Total Visits",count:null!==(t=i.total)&&void 0!==t?t:0,change:i.changePct,postfix:(0,se.jsx)(nF,{text:"Total visits are all visits in the selected period, including repeat visits from the same visitor."})}),graph:(0,se.jsx)(nA,{data:i.data,range:r,metricConverter:{category:l,value:DC.count}})},{tab:(0,se.jsx)(dF,{label:"Unique Visitors",count:null!==(s=o.total)&&void 0!==s?s:0,change:o.changePct,postfix:(0,se.jsx)(nF,{text:"Unique visitors count each visitor once in the selected period, even if they visit multiple times."})}),graph:(0,se.jsx)(nA,{data:o.data,range:r,color:"#9D2A90",metricConverter:{category:l,value:DC.count}})},{tab:(0,se.jsx)(dF,{label:"Visit Duration",count:DC.duration.formatter(null!==(a=c.total)&&void 0!==a?a:0),change:c.changePct,postfix:(0,se.jsx)(nF,{text:"Visit duration is the average duration of all visits in the selected period."})}),graph:(0,se.jsx)(nA,{data:c.data,range:r,color:"#0EA5E9",metricConverter:{category:l,value:DC.duration}})}]})})},fF=e=>{const{app:t}=lp();return Y.useEffect(()=>{OA.builtinFiltersValues=e.filtersValues},[e.filtersValues]),(0,se.jsx)(ML,(0,ue.A)((0,ue.A)({},e),{},{size:"tiny",align:"start",onFilterSelected:e=>{Tu("Analytics - Filter applied",{filter_type:e,app_id:null==t?void 0:t.id})}}))},vF={referrer:{type:"string",enum:[]},country:{type:"string",enum:[]},operatingSystem:{type:"string",enum:[]},devices:{type:"string",enum:[]}},bF=()=>{const e=OA.useTimeRange(),t=cy(),s=HR(),{eventNames:a,reload:n,isLoading:l}=(()=>{var e,t;const{app:s}=lp(),a=Xd({initialData:{eventNames:[]},enabled:!(null==s||!s.id),logErrorMsg:"Failed to fetch analytics event names",query:async()=>Kd.fetchQuery((0,ue.A)((0,ue.A)({},Gd.DEFAULT),{},{queryKey:[MC,"event-names",null==s?void 0:s.id],queryFn:async()=>{const{event_names:e}=await kk.getEventNames(null==s?void 0:s.id);return{eventNames:e.map(e=>e.name)}}}))},[null==s?void 0:s.id]);return{eventNames:null!==(e=null===(t=a.data)||void 0===t?void 0:t.eventNames.filter(e=>!e.startsWith("__")))&&void 0!==e?e:[],isLoading:a.isLoading,reload:a.refetch}})(),r=t&&a.length>3,i=OA.useDashboardsLayoutData(),o=OA.useDashboardsCustomData(),c=OA.useDashboardsNames(),d=(e=>{const t=Y.useMemo(()=>Object.entries(vF).reduce((t,s)=>{var a,n;let[l,r]=s;return t[l]=(0,ue.A)((0,ue.A)({},r),{},{enum:null!==(a=null==e||null===(n=e[l])||void 0===n?void 0:n.values)&&void 0!==a?a:[]}),t},{}),[e]);return OL(t)})(OA.useBuiltinFiltersOptions()),{app:u}=lp();return Y.useEffect(()=>{OA.setDashboardsNames([...EA,...a])},[a]),Y.useEffect(()=>{const e=a.slice(3);a.forEach(t=>{OA.setDashboardCustomData(t,{requiresUpgrade:r&&e.includes(t)})})},[r,r,a.join(",")]),(0,se.jsxs)("div",{className:"flex flex-col w-full h-full gap-5 font-base44",children:[(0,se.jsxs)("div",{className:"sm:flex hidden flex-row h-[48px] w-full items-center border-b border-slate-200 ",children:[(0,se.jsx)("span",{className:"flex h-full border-b-2 border-primary px-4 cursor-pointer",children:"Traffic Overview"}),(0,se.jsx)(lF,{text:(0,se.jsx)(jF,{}),children:(0,se.jsx)("span",{className:"flex h-full text-slate-500 px-4 cursor-not-allowed",children:"Sales Overview"})})]}),(0,se.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,se.jsxs)("div",{className:"flex flex-row items-start justify-start gap-2 z-100",children:[(0,se.jsx)(tF,{onRefreshClicked:()=>{Kd.invalidateQueries({predicate:e=>{let{queryKey:t}=e;return t[0]===MC}}),n()}},"date-filter"),(0,se.jsx)(fF,(0,ue.A)({},d))]}),(0,se.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,se.jsx)(Bx,{variant:"outline",size:"tiny",onClick:()=>{dS.openModal("CustomizeDashboardsDrawer")},children:(0,se.jsx)(rA.A,{className:"w-4 h-4"})}),(0,se.jsx)(VR,{sourceCodeState:"managed",children:(0,se.jsx)(lF,{text:"Upgrade to add more custom events",disabled:!r,children:(0,se.jsxs)(Bx,{disabled:l,variant:"default",size:"tiny",onClick:()=>{r?dy("analytics_primary_dashboard_button"):(Tu("Analytics - Event Creation Initiated",{origin:"primary_dashboard_button",app_id:null==u?void 0:u.id}),dS.openModal("AddEventDrawer"))},children:[(0,se.jsx)(op.A,{className:"w-4 h-4"})," Add Event"]})})})]})]}),(0,se.jsx)(sM,(0,ue.A)({},d)),(0,se.jsx)("div",{className:"flex w-full h-full overflow-y-scroll",children:(0,se.jsx)(JD,{dashboards:[{name:"mainDashboard",span:6,Component:(0,se.jsx)(xF,{timeRange:e,dashboardName:"mainDashboard",customData:{},setCustomData:()=>{}})},...c.map(t=>{var s,a,n,l,r;return{name:t,span:null!==(s=null===(a=i[t])||void 0===a?void 0:a.span)&&void 0!==s?s:3,hidden:null!==(n=null===(l=i[t])||void 0===l?void 0:l.hidden)&&void 0!==n&&n,Component:(0,se.jsx)(IA,{dashboardName:t,timeRange:e,customData:null!==(r=o[t])&&void 0!==r?r:{},setCustomData:e=>OA.setDashboardCustomData(t,e)})}}),...s?[]:[{name:"Empty Slot",span:3,Component:(0,se.jsx)("div",{className:de("flex w-full h-full items-center justify-center"),onClick:()=>{r?dy("analytics_empty_slot_button"):(Tu("Analytics - Event Creation Initiated",{origin:"empty_slot_button",app_id:null==u?void 0:u.id}),dS.openModal("AddEventDrawer"))},children:(0,se.jsx)(QD,{requiresUpgrade:r})})}]]})})]})},jF=()=>(0,se.jsxs)("span",{className:" text-white",children:["Coming soon: Using Stripe Connector will display all your business data here. ",(0,se.jsx)("br",{}),(0,se.jsx)("a",{href:"https://docs.base44.com/documentation/setting-up-your-app/setting-up-payments#step-1-install-stripe",target:"_blank",className:"underline",children:"Learn more"})]}),yF=()=>{var e;const{app:t}=lp(),{data:s,isLoading:a}=(0,$h.I)({queryKey:[MC,"user-stats",null==t?void 0:t.id],queryFn:()=>kk.getUserStats(t.id),enabled:!(null==t||!t.id),refetchInterval:6e4,staleTime:15e3});if(a)return(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-5 w-8"}),(0,se.jsx)($r,{className:"h-4 w-20"})]});if(!s)return null;const n=null!==(e=s.live_users)&&void 0!==e?e:0;return(0,se.jsxs)("div",{className:"flex items-center gap-2 font-base44",children:[(0,se.jsx)("span",{className:"text-base font-medium leading-6 text-foreground",children:n.toLocaleString()}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsxs)("span",{className:"relative flex h-1.5 w-1.5",children:[(0,se.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),(0,se.jsx)("span",{className:"relative inline-flex rounded-full h-1.5 w-1.5 bg-green-500"})]}),(0,se.jsx)("span",{className:"text-sm font-medium leading-5 text-green-500",children:"Live visitors"})]})]})},NF=e=>{let{data:t,title:s="Bar Chart",barColor:a="#2A9D90;",maxWidth:n="800px",maxLabelWidth:l="150px",backgroundColor:r="white",textColor:i="#1f2937",className:o,renderLabel:c=e=>e.name,renderValue:d=e=>e.value}=e;const[u,m]=(0,Y.useState)(!1),x=Math.max(...t.map(e=>e.value)),h=t.length;(0,Y.useEffect)(()=>{m(!1);const e=setTimeout(()=>m(!0),100);return()=>clearTimeout(e)},[]);const p=h<=5?"40px":h<=10?"32px":h<=20?"24px":"16px",g=h<=5?"14px":h<=10?"12px":h<=20?"10px":"8px";return(0,se.jsxs)("div",{className:o,style:{width:"100%",maxWidth:n,backgroundColor:r,overflow:"hidden"},children:[s&&(0,se.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"24px",color:i,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s}),(0,se.jsxs)("div",{className:"text-[".concat(g,"] text-[").concat(i,"]"),style:{display:"grid",gridTemplateColumns:"max-content 1fr",gap:"10px",gridTemplateRows:"repeat(".concat(t.length,", ").concat(p,")")},children:[(0,se.jsx)("div",{className:"align-left max-w-[".concat(l,"]"),children:t.map((e,t)=>{let{name:s}=e;return(0,se.jsx)("div",{className:"align-middle h-[".concat(p,"] flex items-center"),children:s},t)})}),(0,se.jsx)("div",{children:t.map((e,t)=>{let{value:s}=e;return(0,se.jsxs)("div",{className:"p-1 flex row gap-1 align-middle h-[".concat(p,"]"),children:[(0,se.jsx)("div",{className:"bg-[".concat(a,"] w-[").concat((u?s:0)/x*100,"%] rounded-lg"),style:{transition:"width 0.5s ease-in-out"}},t),(0,se.jsx)("div",{className:"align-middle flex items-center ",children:s},t)]})})})]})]})};function wF(){const{state:e,updateState:t}=(()=>{var e,t;const{app:s}=lp(),a=s.id,[n,l]=(0,Y.useState)({appId:a,pageNames:Object.keys(s.pages),date:{from:void 0,to:void 0},selectedPage:"all",selectedUser:null,showAllUsers:!1}),r=e=>{l(t=>(0,ue.A)((0,ue.A)({},t),e))},{isLoading:i,data:o}=Xd({query:()=>{var e,t;return Cc.getStats(a,{date_from:null!==(e=n.date)&&void 0!==e&&e.from?(0,z_.GP)(n.date.from,"yyyy-MM-dd"):void 0,date_to:null!==(t=n.date)&&void 0!==t&&t.to?(0,z_.GP)(n.date.to,"yyyy-MM-dd"):void 0,page_name:"all"!==n.selectedPage?n.selectedPage:void 0,user_email:n.selectedUser?n.selectedUser:void 0})},initialData:null,logErrorMsg:"Failed to fetch stats",onLoading(e){r({isLoading:e})},onSuccess(e){r({stats:e})}},[a,null===(e=n.date)||void 0===e?void 0:e.from,null===(t=n.date)||void 0===t?void 0:t.to,n.selectedPage,n.selectedUser]);return{state:(0,ue.A)((0,ue.A)({},n),{},{isLoading:i,stats:o}),updateState:r}})(),{appId:s,selectedPage:a,showAllUsers:n,stats:l}=e;return l?(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsx)(_F,{updateState:t,state:e}),(0,se.jsx)(kF,{stats:l}),(0,se.jsx)(CF,{updateState:t,stats:l,showAllUsers:n}),(0,se.jsx)(AF,{stats:l,selectedPage:a,appId:s}),(0,se.jsx)(SF,{stats:l}),(0,se.jsx)(EF,{stats:l})]}):(0,se.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}const _F=e=>{let{state:t,updateState:s}=e;const{date:a,selectedPage:n,pageNames:l,selectedUser:r,isLoading:i}=t;return(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,se.jsxs)(mS,{children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"outline",className:de("w-full sm:w-[240px] justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[(0,se.jsx)(H_.A,{className:"mr-2 h-4 w-4"}),null!=a&&a.from?a.to?(0,se.jsxs)(se.Fragment,{children:[(0,z_.GP)(a.from,"LLL dd, y")," - ",(0,z_.GP)(a.to,"LLL dd, y")]}):(0,z_.GP)(a.from,"LLL dd, y"):(0,se.jsx)("span",{children:"Pick a date range"})]})}),(0,se.jsx)(hS,{className:"w-auto p-0",align:"start",children:(0,se.jsx)(eF,{initialFocus:!0,mode:"range",defaultMonth:null==a?void 0:a.from,selected:a,onSelect:e=>s({date:{to:null==e?void 0:e.to,from:null==e?void 0:e.from}}),numberOfMonths:1})})]}),(0,se.jsxs)(Wf,{value:n,onValueChange:e=>s({selectedPage:e}),children:[(0,se.jsx)(Yf,{className:"w-full sm:w-[240px]",children:(0,se.jsx)(qf,{placeholder:"Filter by page"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Pages"}),null==l?void 0:l.map(e=>(0,se.jsx)(Zf,{value:e,children:e},e))]})]}),r&&(0,se.jsxs)("div",{className:"flex items-center gap-2 bg-muted px-3 py-2 rounded-md",children:[(0,se.jsxs)("span",{className:"text-sm",children:["Filtered by user: ",r]}),(0,se.jsx)("button",{onClick:()=>s({selectedUser:null}),className:"text-muted-foreground hover:text-foreground",children:(0,se.jsx)(Uy.A,{className:"h-4 w-4"})})]}),i&&(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-muted-foreground"}),(0,se.jsx)("span",{className:"text-sm text-muted-foreground",children:"Updating..."})]})]})},kF=e=>{let{stats:t}=e;return(0,se.jsx)(Bv,{children:(0,se.jsxs)(zv,{className:"py-6",children:[(0,se.jsx)(Hv,{className:"text-lg",children:(null==t?void 0:t.unique_users_count)||0}),(0,se.jsx)(Vv,{children:"Total Unique Users"})]})})},CF=e=>{var t,s;let{stats:a,updateState:n,showAllUsers:l}=e;const r=null!=a&&a.top_users?l?a.top_users:null===(t=a.top_users)||void 0===t?void 0:t.slice(0,5):[],i=(null==a||null===(s=a.top_users)||void 0===s?void 0:s.length)>5;return 0===r.length?null:(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsx)(Hv,{children:"Top Users"})}),(0,se.jsx)(Wv,{children:(0,se.jsxs)("div",{className:"space-y-2",children:[null==r?void 0:r.map((e,t)=>(0,se.jsxs)("div",{className:"flex justify-between items-center text-sm cursor-pointer hover:bg-muted rounded-md",onClick:()=>n({selectedUser:e.email}),children:[(0,se.jsx)("span",{className:"truncate max-w-[180px]",children:e.email}),(0,se.jsxs)("span",{className:"font-semibold",children:[e.visits," visits"]})]},t)),i&&(0,se.jsx)(Bx,{variant:"ghost",className:"w-full mt-2 text-sm text-muted-foreground hover:text-foreground",onClick:()=>n({showAllUsers:!l}),children:l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ur.A,{className:"h-4 w-4 mr-2"})," Show Less"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(_t.A,{className:"h-4 w-4 mr-2"})," Show More Users"]})})]})})]})},AF=e=>{var t,s;let{stats:a,selectedPage:n,appId:l}=e;const r=(null!==(t="all"===n?null==a?void 0:a.top_pages:null===(s=a.top_pages)||void 0===s?void 0:s.filter(e=>e.url===n))&&void 0!==t?t:[]).map(e=>({name:e.page_name,value:e.visits}));return(0,se.jsxs)(Bv,{children:[(0,se.jsxs)(zv,{children:[(0,se.jsx)(Hv,{children:"Top Pages"}),(0,se.jsx)(Vv,{children:"Shows the most visited pages in your app and their total visit count"})]}),(0,se.jsx)(Wv,{children:(0,se.jsx)(NF,{data:r,title:"",maxWidth:"80%",backgroundColor:"transparent",renderLabel:e=>"all"===l?(0,se.jsx)(Z.Link,{to:"/apps/".concat(e.name),target:"_blank",className:"hover:underline",children:e.name}):e.name})})]})},SF=e=>{var t;let{stats:s}=e;return(0,se.jsxs)(Bv,{children:[(0,se.jsxs)(zv,{children:[(0,se.jsx)(Hv,{children:"Unique Users Over Time"}),(0,se.jsx)(Vv,{children:"Tracks the number of distinct users accessing your app each day"})]}),(0,se.jsx)(Wv,{children:(null==s||null===(t=s.users_per_date)||void 0===t?void 0:t.length)<=1?(0,se.jsx)("div",{className:"h-[200px] flex items-center justify-center text-muted-foreground",children:"Not enough data to show trends"}):(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(QC.Q,{data:s.users_per_date,margin:{top:10,right:10,left:0,bottom:0},children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"date"}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"unique_users",stroke:"#8884d8",fill:"#8884d8",name:"Unique Users"})]})})})})]})},EF=e=>{var t;let{stats:s}=e;return(0,se.jsxs)(Bv,{children:[(0,se.jsxs)(zv,{children:[(0,se.jsx)(Hv,{children:"Total Usage Over Time"}),(0,se.jsx)(Vv,{children:"Shows the total number of visits to your app, including repeat visits from the same users"})]}),(0,se.jsx)(Wv,{children:(null==s||null===(t=s.users_per_date)||void 0===t?void 0:t.length)<=1?(0,se.jsx)("div",{className:"h-[200px] flex items-center justify-center text-muted-foreground",children:"Not enough data to show trends"}):(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(QC.Q,{data:s.users_per_date,margin:{top:10,right:10,left:0,bottom:0},children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"date"}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"total_visits",stroke:"#82ca9d",fill:"#82ca9d",name:"Total Visits"})]})})})})]})};function TF(){return(0,se.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl flex items-center justify-center py-16",children:(0,se.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,se.jsx)("div",{className:"w-11 h-11 rounded-lg border border-gray-200 bg-gray-50 flex items-center justify-center mb-3",children:(0,se.jsx)(GP.A,{className:"w-5 h-5 text-gray-400",strokeWidth:1.5})}),(0,se.jsx)("p",{className:"text-sm text-gray-500",children:"Publish your app to start collecting data."})]})})}const IF=()=>{const{app:e}=lp(),{user:t}=wd(),s=!(null==e||!e.last_deployed_at)||yh(null==t?void 0:t.email),[a,n]=(0,Y.useState)("dashboards"),l="dashboards"===a;return(0,se.jsxs)(lL,{className:"sm:p-6 p-2",title:"Analytics",actions:[(0,se.jsx)(yF,{},"live-visitors"),(0,se.jsx)("div",{className:"flex flex-row gap-4 text-lg",children:(0,se.jsxs)(Bx,{className:de(""),variant:l?"ghost":"default",size:"lg",onClick:()=>n(l?"analytics":"dashboards"),children:[!l&&(0,se.jsx)(lA.A,{className:"w-6 h-6"}),l?"Switch to basic view":"Dashboards View"]})},"view-toggle")],children:["dashboards"===a&&(s?(0,se.jsx)(bF,{}):(0,se.jsx)(TF,{})),"analytics"===a&&(0,se.jsx)(wF,{})]})};function PF(){const[e]=Y.useState(()=>new Q.E);return(0,se.jsx)(X.Ht,{client:e,children:(0,se.jsx)(IF,{})})}var LF=s(30621);const MF=(0,Y.forwardRef)((e,t)=>{let{functionName:s,hasUnsavedChanges:a}=e;const{user:n}=wd(),{app:l,runtimeAuthToken:r}=lp(),[i,o]=(0,Y.useState)(null),c=null==s?void 0:s.replace(/\.[^/.]+$/,""),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)("{\n  \n}"),[v,b]=(0,Y.useState)(null),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(null),[_,k]=(0,Y.useState)(null),[C,A]=(0,Y.useState)(!1),[S,E]=(0,Y.useState)(!1),[T,I]=(0,Y.useState)(!1),[P,L]=(0,Y.useState)([]),[M,R]=(0,Y.useState)(!1),[D,F]=(0,Y.useState)(null),[O,U]=(0,Y.useState)(null),[B]=(0,Y.useState)(50),[z,H]=(0,Y.useState)(!0);(0,Y.useEffect)(()=>{o(ye(l,()=>{},{Authorization:"Bearer ".concat(r),"Base44-Functions-Version":"preview"}))},[null==l?void 0:l.id,null==l?void 0:l.functions]),(0,Y.useEffect)(()=>{w(null)},[s]);const V=async e=>{if(null!=l&&l.id&&s){w(null);try{await zc.redeployFunction(l.id,s,e)}catch(n){var t,a;const e=(null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||n.message||"An error occurred while redeploying the function";throw w(e),new Error(e)}}};(0,Y.useImperativeHandle)(t,()=>({handleRedeployFunction:V,clearDeploymentError:()=>w(null)}));const W=async(e,t)=>{try{await navigator.clipboard.writeText(e),"url"===t?(A(!0),setTimeout(()=>A(!1),2e3)):"headers"===t?(E(!0),setTimeout(()=>E(!1),2e3)):"curl"===t&&(I(!0),setTimeout(()=>I(!1),2e3))}catch(s){}},q=()=>null!=l&&l.slug&&null!=l&&l.id&&c?"".concat(Tc(l),"/api/apps/").concat(l.id,"/functions/").concat(c):"",G=()=>{const e={"Content-Type":"application/json"};return null!=n&&n.api_key&&(e.api_key=n.api_key),e},K=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=l&&l.id&&c){R(!0),F(null);try{const s={limit:B};e&&!t&&(s.until=e);const a=await BR.getBackendFunctionsLogs(l.id,c,s);let n=a;const r=e=>{const t="object"==typeof e.message?JSON.stringify(e.message):String(e.message);return"".concat(e.time,"|").concat(t)};if(t||!e?(L(n),t&&U(null)):L(e=>{const t=new Set(e.map(r)),s=n.filter(e=>!t.has(r(e)));return[...e,...s]}),n.length>0){const e=n[n.length-1];U(e.time)}H(a.length===B)}catch(n){var s,a;F((null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||n.message||"Failed to fetch logs")}finally{R(!1)}}},$=e=>{try{return new Date(e).toLocaleString()}catch(t){return e}},Z=e=>{switch(null==e?void 0:e.toLowerCase()){case"error":return"text-red-600 bg-red-50 border-red-200";case"warn":case"warning":return"text-amber-600 bg-amber-50 border-amber-200";case"info":return"text-blue-600 bg-blue-50 border-blue-200";case"debug":return"text-purple-600 bg-purple-50 border-purple-200";default:return"text-slate-600 bg-slate-50 border-slate-200"}};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"fixed bottom-6 right-6",children:!a&&(0,se.jsxs)("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-2xl shadow-2xl p-2 flex items-center gap-1",children:[(0,se.jsxs)(zt,{variant:"ghost",size:"sm",className:"rounded-xl text-slate-600 hover:text-slate-800 hover:bg-slate-100 transition-all duration-200",onClick:()=>u(!0),children:[(0,se.jsx)(yS.A,{className:"h-4 w-4 mr-2"}),"Test Function"]}),(0,se.jsx)("div",{className:"w-px h-6 bg-slate-300 mx-1"}),(0,se.jsxs)(zt,{variant:"ghost",size:"sm",className:"rounded-xl text-slate-600 hover:text-slate-800 hover:bg-slate-100 transition-all duration-200",onClick:()=>{p(!0),0===P.length&&K(null,!0)},children:[(0,se.jsx)(lA.A,{className:"h-4 w-4 mr-2"}),"Logs"]}),(0,se.jsx)("div",{className:"w-px h-6 bg-slate-300 mx-1"}),(0,se.jsxs)(zt,{variant:"ghost",size:"sm",className:"rounded-xl text-slate-600 hover:text-slate-800 hover:bg-slate-100 transition-all duration-200",onClick:()=>x(!0),children:[(0,se.jsx)(Jv.A,{className:"h-4 w-4 mr-2"}),"API"]})]})}),N&&(0,se.jsx)("div",{className:"fixed bottom-24 right-6 max-w-md z-50",children:(0,se.jsxs)(Dt,{variant:"destructive",className:"bg-white/95 backdrop-blur-sm border-red-200 shadow-xl",children:[(0,se.jsx)(Hy.A,{className:"h-4 w-4"}),(0,se.jsx)(Ft,{children:"Deployment Error"}),(0,se.jsx)(Ot,{className:"font-mono text-sm whitespace-pre-wrap break-all",children:N})]})}),(0,se.jsx)(Fr,{open:h&&!a,onOpenChange:p,children:(0,se.jsxs)(Vr,{className:"sm:max-w-3xl md:max-w-5xl w-[96vw]",children:[(0,se.jsx)(Wr,{className:"pb-3",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(lA.A,{className:"h-5 w-5 text-teal-600"}),(0,se.jsx)(Yr,{className:"text-slate-800 text-lg",children:"Logs"})]}),(0,se.jsx)("div",{className:"text-sm text-slate-500 font-mono bg-slate-100 px-2 py-1 rounded",children:s})]}),(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>{K(null,!0)},disabled:M,className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50 border-teal-200",children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-1 ".concat(M?"animate-spin":"")}),"Refresh"]})]})}),(0,se.jsxs)("div",{className:"space-y-3",children:[D&&(0,se.jsxs)(Dt,{variant:"destructive",className:"mb-4",children:[(0,se.jsx)(Hy.A,{className:"h-4 w-4"}),(0,se.jsx)(Ft,{children:"Error"}),(0,se.jsx)(Ot,{children:D})]}),0===P.length&&!M&&!D&&(0,se.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,se.jsx)(xb.A,{className:"h-8 w-8 mx-auto mb-3 text-slate-400"}),(0,se.jsx)("p",{className:"font-medium mb-1",children:"No logs found"}),(0,se.jsx)("p",{className:"text-xs text-slate-400",children:"This function hasn't generated any logs yet."})]}),P.length>0&&(0,se.jsx)("div",{className:"max-h-[70vh] overflow-y-auto border border-slate-200 rounded-lg",children:(0,se.jsx)("div",{className:"divide-y divide-slate-100",children:P.map((e,t)=>{return(0,se.jsxs)("div",{className:"px-3 py-2 hover:bg-slate-50/50 transition-colors ".concat(Z(e.level).includes("red")?"bg-red-50/30":Z(e.level).includes("amber")?"bg-amber-50/30":Z(e.level).includes("blue")?"bg-blue-50/30":Z(e.level).includes("purple")?"bg-purple-50/30":""),children:[(0,se.jsx)("div",{className:"flex items-start gap-3 mb-1",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.level&&(0,se.jsx)("span",{className:"text-xs font-medium uppercase px-1.5 py-0.5 rounded-sm ".concat("error"===e.level.toLowerCase()?"bg-red-100 text-red-700 border border-red-200":"warn"===e.level.toLowerCase()||"warning"===e.level.toLowerCase()?"bg-amber-100 text-amber-700 border border-amber-200":"info"===e.level.toLowerCase()?"bg-blue-100 text-blue-700 border border-blue-200":"debug"===e.level.toLowerCase()?"bg-purple-100 text-purple-700 border border-purple-200":"bg-slate-100 text-slate-700 border border-slate-200"),children:e.level}),(0,se.jsx)("span",{className:"text-xs text-slate-400 font-mono min-w-0",children:$(e.time)})]})}),(0,se.jsx)("div",{className:"font-mono text-xs leading-relaxed text-slate-700 whitespace-pre-wrap break-words pl-1",children:"string"==typeof e.message?(s=e.message.trim(),"string"!=typeof s?s:s.replace(/\u001b\[[0-9;]*m/g,"")):JSON.stringify(e.message,null,2)})]},"".concat(e.time,"-").concat(t));var s})})}),z&&P.length>0&&(0,se.jsx)("div",{className:"flex justify-center pt-2",children:(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>{!M&&z&&O&&K(O)},disabled:M,className:"text-slate-600 hover:text-slate-800 text-xs",children:M?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-1 h-3 w-3 animate-spin"}),"Loading..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(bs.A,{className:"mr-1 h-3 w-3"}),"Load More"]})})}),M&&0===P.length&&(0,se.jsx)("div",{className:"flex justify-center py-8",children:(0,se.jsxs)("div",{className:"flex items-center text-slate-500 text-sm",children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading logs..."]})})]})]})}),(0,se.jsx)(Fr,{open:m&&!a,onOpenChange:x,children:(0,se.jsxs)(Vr,{className:"sm:max-w-md md:max-w-lg w-[90vw] flex flex-col",children:[(0,se.jsxs)(Wr,{className:"pb-4 flex-shrink-0",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Jv.A,{className:"h-5 w-5 text-teal-600"}),(0,se.jsx)(Yr,{className:"text-slate-800 text-lg",children:"API Information"})]}),(0,se.jsx)("div",{className:"text-sm text-slate-500 font-mono bg-slate-100 px-2 py-1 rounded w-fit",children:s})]}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto mt-6 space-y-6 pr-2",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Function URL"}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>W(q(),"url"),className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:C?(0,se.jsx)(Ds.A,{className:"h-4 w-4"}):(0,se.jsx)(ob.A,{className:"h-4 w-4"})})]}),(0,se.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:(0,se.jsx)("code",{className:"text-sm font-mono text-slate-800 break-all",children:q()})}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Make POST requests to this endpoint with your function payload."})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Headers"}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>W(JSON.stringify(G(),null,2),"headers"),className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:S?(0,se.jsx)(Ds.A,{className:"h-4 w-4"}):(0,se.jsx)(ob.A,{className:"h-4 w-4"})})]}),(0,se.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:(0,se.jsx)("pre",{className:"text-sm font-mono text-slate-800 whitespace-pre-wrap",children:JSON.stringify(G(),null,2)})}),(0,se.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,se.jsxs)("p",{children:[(0,se.jsx)("strong",{children:"Content-Type:"})," Always required for JSON payloads."]}),null!=n&&n.api_key?(0,se.jsxs)("p",{children:[(0,se.jsx)("strong",{children:"api_key:"})," Your personal API key - only include this if your function requires authentication. Keep it secure and don't expose it publicly."]}):(0,se.jsxs)("p",{className:"text-amber-600",children:[(0,se.jsx)("strong",{children:"api_key:"})," Not found. Include your personal API key here only if your function requires authentication."]})]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Request Body"}),(0,se.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:(0,se.jsx)("pre",{className:"text-sm font-mono text-slate-800 whitespace-pre-wrap",children:'{\n  "param1": "value1",\n  "param2": "value2"\n}'})}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Send a JSON object in the request body with any parameters your function requires. The structure depends on what your function expects to receive."})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Usage Example (cURL)"}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>W('curl -X POST "'.concat(q(),'" \\\n  -H "Content-Type: application/json" ').concat(null!=n&&n.api_key?'\\\n  -H "api_key: '.concat(n.api_key,'" '):"",'\\\n  -d \'{"param1": "value1", "param2": "value2"}\''),"curl"),className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:T?(0,se.jsx)(Ds.A,{className:"h-4 w-4"}):(0,se.jsx)(ob.A,{className:"h-4 w-4"})})]}),(0,se.jsx)("div",{className:"bg-slate-900 rounded-lg p-4",children:(0,se.jsx)("pre",{className:"text-sm font-mono text-green-400 whitespace-pre-wrap break-all",children:'curl -X POST "'.concat(q(),'" \\\n  -H "Content-Type: application/json" ').concat(null!=n&&n.api_key?'\\\n  -H "api_key: '.concat(n.api_key,'" '):"",'\\\n  -d \'{"param1": "value1", "param2": "value2"}\'')})})]})]})]})}),(0,se.jsx)(Fr,{open:d&&!a,onOpenChange:u,children:(0,se.jsxs)(Vr,{className:"sm:max-w-md md:max-w-lg w-[90vw]",children:[(0,se.jsxs)(Wr,{className:"pb-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(yS.A,{className:"h-5 w-5 text-orange-600"}),(0,se.jsx)(Yr,{className:"text-slate-800 text-lg",children:"Test Function"})]}),(0,se.jsx)("div",{className:"text-sm text-slate-500 font-mono bg-slate-100 px-2 py-1 rounded w-fit",children:s})]}),(0,se.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Payload"}),(0,se.jsx)(ki,{value:g,onChange:e=>f(e.target.value),className:"font-mono h-40",placeholder:"Enter JSON payload"})]}),(0,se.jsx)(zt,{onClick:async()=>{if(i&&c){y(!0),k(null),b(null);try{const e=JSON.parse(g),t=await i[c](e);b(t)}catch(l){var e,t,s,a,n;k({message:(null===(e=l.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error)||(null===(s=l.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||l.message||"An error occurred while executing the function",details:(null===(n=l.response)||void 0===n?void 0:n.data)||null})}finally{y(!1)}}},disabled:j,className:"w-full",children:j?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Running..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(LF.A,{className:"mr-2 h-4 w-4"}),"Run Function"]})}),_&&(0,se.jsxs)(Dt,{variant:"destructive",children:[(0,se.jsx)(Hy.A,{className:"h-4 w-4"}),(0,se.jsx)(Ft,{children:"Function Execution Error"}),(0,se.jsxs)(Ot,{className:"font-mono text-sm whitespace-pre-wrap break-all",children:[null==_?void 0:_.message,(null==_?void 0:_.details)&&(0,se.jsxs)("div",{className:"mt-2 pt-2 border-t border-red-300 dark:border-red-700",children:[(0,se.jsx)("h4",{className:"text-xs font-semibold mb-1 uppercase tracking-wider text-red-700 dark:text-red-300",children:"Technical Details (JSON RESPONSE):"}),(0,se.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 p-2 rounded-md overflow-auto max-h-40",children:(0,se.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:"string"==typeof _.details?_.details:JSON.stringify(_.details,null,2)})})]})]})]}),v&&(0,se.jsxs)("div",{className:"mt-4",children:[(0,se.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Result"}),(0,se.jsxs)(ji,{defaultValue:"formatted",children:[(0,se.jsxs)(yi,{className:"mb-2",children:[(0,se.jsx)(Ni,{value:"formatted",children:"Formatted"}),(0,se.jsx)(Ni,{value:"raw",children:"Raw"})]}),(0,se.jsx)(wi,{value:"formatted",children:(0,se.jsx)("div",{className:"bg-gray-50 p-4 rounded-md overflow-auto max-h-60",children:(0,se.jsx)("pre",{className:"text-sm font-mono whitespace-pre-wrap",children:(e=>{try{return JSON.stringify(e,null,2)}catch(t){return String(e)}})(v)})})}),(0,se.jsx)(wi,{value:"raw",children:(0,se.jsx)("div",{className:"bg-gray-50 p-4 rounded-md overflow-auto max-h-60",children:(0,se.jsx)("pre",{className:"text-sm font-mono whitespace-pre-wrap",children:JSON.stringify(v)})})})]})]})]})]})})]})}),RF=MF,DF={overview:YP.A,data:oy.A,users:eb.A,analytics:GP.A,domains:KP.A,"app-connections":$P.A,security:Yc.A,code:jg.A,logs:xb.A,settings:vP.A,payments:su.A,secrets:xb.A,api:jg.A,agents:wP.A,automations:yS.A},FF=e=>{if(e.id&&e.id.startsWith("entity-"))return null;const t=DF[e.id];return!t&&e.icon?(0,se.jsx)("div",{className:"min-w-[16px] flex items-center justify-center",children:e.icon}):t?(0,se.jsx)(t,{className:"w-4 h-4"}):null},OF=e=>{let{badge:t,className:s}=e;return null==t?null:(0,se.jsx)("div",{className:s,children:"number"==typeof t?(0,se.jsx)("div",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full text-white text-xs font-semibold",style:{backgroundColor:"#FFB700"},children:t}):(0,se.jsx)(gs,{variant:"secondary",className:"px-1.5 py-0 text-xs",children:t})})},UF=new Set(["pages","components","entities","functions"]),BF=new Set(["src","public"]),zF=e=>{let{item:t,selected:s,onSelect:a,level:n=0,unchainedMode:l=!1}=e;const[r,i]=(0,Y.useState)(()=>function(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?BF:UF).has(null==e?void 0:e.toLowerCase())}(t.id,l)),o=s===t.id,c=t.subitems&&t.subitems.length>0,d=0===n?8:24*n+8;return c?(0,se.jsxs)("div",{className:"relative",children:[n>0&&(0,se.jsx)("div",{className:"absolute top-0 bottom-0 w-px bg-neutral-200",style:{left:"".concat(16+24*(n-1),"px")}}),(0,se.jsxs)("button",{onClick:()=>i(!r),className:de("w-full flex items-center gap-2 h-8 rounded-lg text-sm transition-colors","hover:bg-neutral-100 text-neutral-900"),style:{paddingLeft:d,paddingRight:8},children:[(0,se.jsx)(_t.A,{className:de("w-4 h-4 text-neutral-500 transition-transform shrink-0",!r&&"-rotate-90")}),(0,se.jsx)("span",{className:"truncate flex-1 text-left",children:t.label}),(0,se.jsx)(OF,{badge:t.badge})]}),r&&(0,se.jsx)("div",{className:"relative",children:t.subitems.map((e,t)=>(0,se.jsx)(zF,{item:e,selected:s,onSelect:a,level:n+1,unchainedMode:l},e.id||t))})]}):(0,se.jsxs)("div",{className:"relative",children:[n>0&&(0,se.jsx)("div",{className:"absolute top-0 bottom-0 w-px bg-neutral-200",style:{left:"".concat(16+24*(n-1),"px")}}),(0,se.jsxs)("button",{onClick:()=>a(t.id),className:de("w-full flex items-center gap-2 h-7 rounded-lg text-sm transition-colors",o?"bg-neutral-100 text-neutral-900":"hover:bg-neutral-50 text-neutral-900"),style:{paddingLeft:d,paddingRight:8},children:[(0,se.jsx)("div",{className:"w-4 h-4 flex items-center justify-center shrink-0 text-neutral-500",children:FF(t)}),(0,se.jsx)("span",{className:"truncate flex-1 text-left",children:t.label}),(0,se.jsx)(OF,{badge:t.badge})]})]})},HF=e=>{let{items:t,selected:s,onSelect:a,title:n="Code files",onSearchClick:l,showSearch:r=!0,headerActions:i=null}=e;const{hasFlag:o}=ej(),c=o(oj);return(0,se.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-3",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:n}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[i,r&&(0,se.jsx)("button",{onClick:l,className:"flex items-center justify-center w-7 h-7 rounded-lg border border-neutral-200 bg-white shadow-sm hover:bg-neutral-50 transition-colors",children:(0,se.jsx)(na.A,{className:"w-4 h-4 text-neutral-700"})})]})]}),(0,se.jsx)("nav",{className:"flex-1 overflow-y-auto px-3 pb-3",children:(0,se.jsx)("div",{className:"flex flex-col",children:t.map((e,t)=>(0,se.jsx)(zF,{item:e,selected:s,onSelect:a,level:0,unchainedMode:c},e.id||t))})})]})};var VF=s(29964),WF=s(74874);const qF=e=>{let{selectedFile:t,onFileSelect:s,onBack:a,app:n,sandboxFiles:l=null,isLoadingSandboxFiles:r=!1,width:i="100%",hasUnsavedChanges:o=!1,readOnly:c=!1,backButtonText:d="Back to Dashboard",title:u="Code files",showEmptyMessage:m=!1,emptyMessage:x=null,onCollapse:h=null}=e;const{isSplitScreenMode:p,isSelectElementMode:g}=dm.usePick("isSplitScreenMode","isSelectElementMode"),{hasFlag:f}=ej(),v=f(oj),[b,j]=(0,Y.useState)(""),[y,N]=(0,Y.useState)([]),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)(!1),[A,S]=(0,Y.useState)({}),E=()=>tp(l)||"layout",T=(0,Y.useMemo)(()=>{if(l){const e={},t={},s={},a={};let r=null;const i=new Set;return null!=n&&n.components&&Object.keys(n.components).forEach(e=>{e.startsWith("ui/")&&i.add(e)}),Object.keys(l).forEach(n=>{if(n.startsWith("pages/")){const t=n.replace("pages/","");e[t]=l[n]}else if(n.startsWith("components/")){const e=n.replace("components/","");if(e.startsWith("ui/")){const s=e.replace(/\.(jsx?|tsx?)$/,"");i.has(s)&&(t[e]=l[n])}else t[e]=l[n]}else if(n.startsWith("entities/")){const e=n.replace("entities/","");s[e]=l[n]}else if(n.startsWith("functions/")){const e=n.replace("functions/","");a[e]=l[n]}else Xh(n)&&(r=l[n])}),{pages:e,components:t,entities:s,functions:a,layout:r,hasBackendFunctions:Object.keys(a).length>0}}return{pages:(null==n?void 0:n.pages)||{},components:(null==n?void 0:n.components)||{},entities:(null==n?void 0:n.entities)||{},functions:(null==n?void 0:n.functions)||{},layout:null==n?void 0:n.layout,hasBackendFunctions:null==n?void 0:n.has_backend_functions_enabled}},[l,n]),I=(e,t)=>{const s={};return Object.keys(e||{}).forEach(e=>{const a=e.split("/");let n=s;for(let s=0;s<a.length;s++){const e=a[s],l=s===a.length-1,r=a.slice(0,s+1).join("/");n[e]||(n[e]=l?{isFile:!0,path:r,fileType:t}:{isFile:!1,children:{},path:r,fileType:t}),l||(!n[e].isFile&&n[e].children||(n[e].isFile=!1,n[e].children=n[e].children||{}),n=n[e].children)}}),s},P=(e,t,s)=>Object.entries(e).sort((e,t)=>{let[s,a]=e,[n,l]=t;return a.isFile===l.isFile?s.localeCompare(n):a.isFile?1:-1}).map(e=>{let[a,n]=e;const l=t?"".concat(t,"/").concat(a):"".concat(s,"/").concat(a);if(n.isFile){return{id:l,label:a,icon:"entities"===s?(0,se.jsx)(oy.A,{className:"w-4 h-4"}):(0,se.jsx)(VF.A,{className:"w-4 h-4"})}}return{id:l,label:a,subitems:P(n.children,l,s)}}),L=e=>{s(e)};(0,Y.useEffect)(()=>{if(b.length<2||!w)return void N([]);const e=[],{pages:t,components:s,entities:a,functions:n,layout:r}=T,i=(t,s)=>{s&&Object.entries(s).forEach(s=>{let[a,n]=s;const l=n.toString().split("\n").map((e,t)=>({line:e,idx:t+1})).filter(e=>{let{line:t}=e;return t.toLowerCase().includes(b.toLowerCase())});l.length>0&&e.push({type:t,key:a,matches:l.map(e=>{let{line:t,idx:s}=e;return{lineNumber:s,content:t,preview:t.trim()}})})})};if(v&&l)return i("raw",l),void N(e);if(i("pages",t),i("components",s),i("entities",a),i("functions",n),r){const t=r.toString().split("\n").map((e,t)=>({line:e,idx:t+1})).filter(e=>{let{line:t}=e;return t.toLowerCase().includes(b.toLowerCase())});t.length>0&&e.push({type:"layout",key:E(),matches:t.map(e=>{let{line:t,idx:s}=e;return{lineNumber:s,content:t,preview:t.trim()}})})}N(e)},[b,T,w,l,v]);const M=e=>{let{item:t,selected:s,onSelect:a}=e;const n=A[t.id]||!1,l=n?t.matches:t.matches.slice(0,3),r=t.matches.length>3;return(0,se.jsxs)("div",{className:"mb-2",children:[(0,se.jsxs)("button",{className:de("w-full flex items-center gap-2 px-2 py-1.5 rounded-lg text-sm transition-colors text-left",s===t.id?"bg-neutral-100 text-neutral-900":"hover:bg-neutral-50 text-neutral-900",o&&"opacity-60 cursor-not-allowed"),onClick:()=>{o||a(t.id)},disabled:o,title:o?"You have unsaved changes. Save or discard to jump to a line.":"",children:[(0,se.jsx)("span",{className:"text-neutral-500",children:t.icon}),(0,se.jsx)("span",{className:"truncate flex-1",children:t.label})]}),(0,se.jsxs)("div",{className:"pl-6 mt-1 space-y-1",children:[l.map((e,s)=>(0,se.jsxs)("button",{className:de("w-full text-left text-xs bg-neutral-50 hover:bg-neutral-100 rounded px-2 py-1 transition-colors",o&&"opacity-60 cursor-not-allowed"),onClick:()=>{return s=e.lineNumber,void(o||a(t.id,s));var s},disabled:o,title:o?"You have unsaved changes. Save or discard to jump to a line.":"",children:[(0,se.jsxs)("span",{className:"text-neutral-400 mr-1",children:[e.lineNumber,":"]}),(0,se.jsx)("span",{className:"text-neutral-600 truncate",children:e.preview})]},s)),r&&(0,se.jsxs)("button",{className:"text-xs text-neutral-500 hover:text-neutral-700 flex items-center gap-1 px-2 py-0.5",onClick:e=>{e.stopPropagation(),S(e=>(0,ue.A)((0,ue.A)({},e),{},{[t.id]:!n}))},children:[(0,se.jsx)("span",{className:"w-4 h-4 flex items-center justify-center bg-neutral-100 rounded-full text-[10px]",children:n?"\u2212":"+"}),n?"Collapse":"".concat(t.matches.length-3," more")]})]})]})},R=()=>(0,se.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-neutral-100",children:[(0,se.jsx)($r,{className:"h-4 w-20"}),(0,se.jsx)($r,{className:"h-6 w-6 rounded"})]}),(0,se.jsxs)("div",{className:"p-3 space-y-3",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-14"})]}),(0,se.jsxs)("div",{className:"pl-6 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-24"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-20"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-28"})]})]})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-24"})]}),(0,se.jsxs)("div",{className:"pl-6 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-20"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-16"})]})]})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-16"})]}),(0,se.jsx)("div",{className:"pl-6 space-y-2",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-14"})]})})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"h-4 w-4"}),(0,se.jsx)($r,{className:"h-4 w-16"})]})]})]});return(0,se.jsxs)("div",{className:"flex flex-col h-full bg-white border-r border-gray-200",style:{width:"100%"},children:[(0,se.jsx)("div",{className:"p-2 space-y-0.5",children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[p?(0,se.jsxs)(zt,{variant:"ghost",size:"sm",className:"flex-1 justify-start text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-50 h-8",onClick:()=>{g&&(dm.isSelectElementMode=!1,Wu.postMessageToPreview({type:"toggle-visual-edit-mode",data:{enabled:!1}})),dm.exitSplitScreenMode()},children:[(0,se.jsx)(vs.A,{className:"h-4 w-4 mr-2"}),"Go back"]}):(0,se.jsxs)(zt,{variant:"ghost",size:"sm",className:"flex-1 justify-start text-sm h-8 text-gray-600 hover:bg-gray-100",onClick:a,children:[(0,se.jsx)(vs.A,{className:"h-4 w-4 mr-2"}),d]}),h&&(0,se.jsx)(qi,{delayDuration:0,children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)(zt,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-500 hover:text-gray-700 hover:bg-gray-100",onClick:h,children:(0,se.jsx)(WF.A,{className:"h-4 w-4"})})}),(0,se.jsx)(Ki,{side:"bottom",sideOffset:4,className:"bg-[#171717] border-none text-[#FAFAFA] rounded-lg pointer-events-none",children:(0,se.jsx)("p",{children:"Collapse file tree"})})]})})]})}),(0,se.jsx)("div",{className:"flex-1 overflow-hidden",children:k?(0,se.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,se.jsx)("div",{className:"p-3 border-b border-neutral-200",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)("div",{className:"flex-1 relative",children:[(0,se.jsx)(na.A,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-neutral-400"}),(0,se.jsx)(nl,{type:"text",placeholder:"Search in files...",value:b,onChange:e=>{j(e.target.value),_(e.target.value.length>=2)},className:"pl-8 text-sm h-8 bg-neutral-50 border-neutral-200",autoFocus:!0})]}),(0,se.jsx)("button",{className:"flex items-center justify-center w-7 h-7 rounded-lg border border-neutral-200 bg-white shadow-sm hover:bg-neutral-50 transition-colors",onClick:()=>{C(!1),j(""),_(!1)},children:(0,se.jsx)(la.A,{className:"w-4 h-4 text-neutral-700"})})]})}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto p-3",children:y.length>0?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"text-xs text-neutral-500 mb-2",children:[y.length," file",1!==y.length?"s":""," with matches"]}),(0,se.jsx)("div",{className:"space-y-1",children:y.map(e=>({id:"layout"===e.type||"raw"===e.type?e.key:"".concat(e.type,"/").concat(e.key),label:e.key,icon:"entities"===e.type?(0,se.jsx)(oy.A,{className:"w-4 h-4"}):"layout"===e.type?(0,se.jsx)(zb.A,{className:"w-4 h-4"}):(0,se.jsx)(VF.A,{className:"w-4 h-4"}),matches:e.matches})).map((e,a)=>(0,se.jsx)(M,{item:e,selected:t,onSelect:s},a))})]}):b.length>=2?(0,se.jsx)("div",{className:"text-sm text-neutral-500 text-center py-4",children:"No results found"}):(0,se.jsx)("div",{className:"text-sm text-neutral-500 text-center py-4",children:"Type at least 2 characters to search"})})]}):(()=>{if(r)return(0,se.jsx)(R,{});const e=(()=>{const e=[],{pages:t,components:s,entities:a,functions:n,layout:r,hasBackendFunctions:i}=T;if(v&&l){const t=I(l,"raw");return Object.entries(t).sort((e,t)=>{let[s,a]=e,[n,l]=t;return a.isFile===l.isFile?s.localeCompare(n):a.isFile?1:-1}).forEach(t=>{let[s,a]=t;a.isFile?e.push({id:s,label:s,icon:(0,se.jsx)(VF.A,{className:"w-4 h-4"})}):e.push({id:s,label:s,subitems:P(a.children,s,s)})}),e}if(t&&Object.keys(t).length>0){const s=I(t,"pages");e.push({id:"pages",label:"Pages",subitems:P(s,null,"pages")})}if(s&&Object.keys(s).length>0){const t=I(s,"components");e.push({id:"components",label:"Components",subitems:P(t,null,"components")})}if(a&&Object.keys(a).length>0){const t=I(a,"entities");e.push({id:"entities",label:"Entities",subitems:P(t,null,"entities")})}if(r&&e.push({id:E(),label:"Layout.jsx",icon:(0,se.jsx)(zb.A,{className:"w-4 h-4"})}),i&&n&&Object.keys(n).length>0){const t=I(n,"functions");e.push({id:"functions",label:"Functions",subitems:P(t,null,"functions")})}return e})();return m&&0===e.length?(0,se.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,se.jsx)("div",{className:"flex items-center justify-between p-3",children:(0,se.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:u})}),(0,se.jsx)("div",{className:"p-4 text-sm text-neutral-500",children:x||(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"mb-2",children:"No files available"}),(0,se.jsx)("div",{className:"text-xs",children:"This view appears to be empty."})]})})]}):(0,se.jsx)(HF,{items:e,selected:t,onSelect:L,title:u,onSearchClick:()=>C(!0),showSearch:!0})})()})]})};var YF=s(8182),GF=s(93583);const KF=["className"],$F=["withHandle","className"],ZF=e=>{let{className:t}=e,s=(0,Nt.A)(e,KF);return(0,se.jsx)(IP.YZ,(0,ue.A)({className:de("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t)},s))},JF=IP.Zk,QF=e=>{let{withHandle:t,className:s}=e,a=(0,Nt.A)(e,$F);return(0,se.jsx)(IP.TW,(0,ue.A)((0,ue.A)({className:de("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",s)},a),{},{children:t&&(0,se.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:(0,se.jsx)(UA.A,{className:"h-2.5 w-2.5"})})}))},XF=new Q.E({defaultOptions:{queries:{staleTime:1/0,refetchOnWindowFocus:!1}}}),eO=e=>{let{selectedFile:t}=e;if(!t)return null;const s=t.split("/");return(0,se.jsx)("div",{className:"flex items-center gap-0.5 text-sm",children:s.map((e,t)=>(0,se.jsxs)(Y.Fragment,{children:[t>0&&(0,se.jsx)("span",{className:"text-gray-400 mx-0.5",children:"/"}),(0,se.jsx)("span",{className:t===s.length-1?"text-neutral-900":"text-gray-500",children:e})]},t))})},tO=()=>{const{isSplitScreenMode:e}=dm.usePick("isSplitScreenMode");return(0,se.jsxs)("button",{onClick:()=>{e?dm.exitSplitScreenMode():dm.enterSplitScreenMode()},className:"hidden md:flex items-center gap-1.5 px-2 py-1 bg-[#F5F5F5] border border-[#E5E5E5] rounded-[8px] shadow-sm text-sm font-medium text-neutral-900 hover:bg-gray-200 transition-colors",children:[(0,se.jsx)(YF.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:e?"Exit split":"Split screen"})]})},sO=e=>{let{onExpand:t}=e;return(0,se.jsx)("div",{className:"h-full flex flex-col items-center bg-white border-r border-gray-200 py-2",children:(0,se.jsx)(qi,{delayDuration:0,children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("button",{onClick:t,className:"p-1.5 hover:bg-gray-100 rounded-md transition-colors",children:(0,se.jsx)(GF.A,{className:"w-4 h-4 text-gray-600"})})}),(0,se.jsx)(Ki,{side:"right",sideOffset:8,className:"bg-[#171717] border-none text-[#FAFAFA] rounded-lg pointer-events-none",children:(0,se.jsx)("p",{children:"Expand file tree"})})]})})})},aO=()=>{const{app:e,pages:t,components:s,layout:a,refreshApp:n}=lp(),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!1),u=(0,Y.useRef)(null),m=(0,Y.useRef)(null),x=(0,J.Zp)(),h=(0,J.zy)(),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(!1),b=null==e?void 0:e.using_sandbox,{isSelectElementMode:j}=dm.usePick("isSelectElementMode"),{data:y,isLoading:N,updateCachedFile:w}=Jh(null==e?void 0:e.id,b);(0,Y.useEffect)(()=>{const e=e=>{var t;if("element-selected"===(null===(t=e.data)||void 0===t?void 0:t.type)&&j){const{dataSourceLocation:t}=e.data;if(t){const e=t.split(":"),s=e[0],a=e[1],n=new URLSearchParams(h.search);n.set("filePath",s),a&&n.set("line",a),x("?".concat(n.toString()),{replace:!0}),dm.isSelectElementMode=!1,Wu.postMessageToPreview({type:"toggle-visual-edit-mode",data:{enabled:!1}}),Wu.postMessageToPreview({type:"unselect-element"})}}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[j,x,h.search]),(0,Y.useEffect)(()=>{e&&!b&&n()},[b]);const _=n=>b&&y?n in y:"layout"===n?!!a:n.startsWith("pages/")?t&&t[n.replace("pages/","")]:n.startsWith("components/")?s&&s[n.replace("components/","")]:n.startsWith("functions/")?(null==e?void 0:e.functions)&&e.functions[n.replace("functions/","")]:!!n.startsWith("entities/")&&((null==e?void 0:e.entities)&&e.entities[n.replace("entities/","")]),k=e=>ep(y,e),C=()=>{if(b){if(!y)return null;const e=tp(y);if(e)return e;const t=k("pages/");if(t)return t;const s=k("components/");if(s)return s;const a=k("functions/");if(a)return a;const n=k("entities/");if(n)return n;const l=Object.keys(y)[0];if(l)return l}else if(e){if(a)return"layout";if(t&&Object.keys(t).length>0)return"pages/".concat(Object.keys(t)[0]);if(s&&Object.keys(s).length>0)return"components/".concat(Object.keys(s)[0]);if(e.functions&&Object.keys(e.functions).length>0)return"functions/".concat(Object.keys(e.functions)[0]);if(e.entities&&Object.keys(e.entities).length>0)return"entities/".concat(Object.keys(e.entities)[0])}return null};(0,Y.useEffect)(()=>{const t=new URLSearchParams(h.search),s=t.get("filePath"),a=t.get("line");if(o(a?parseInt(a,10):null),s&&e)if(b&&y){if(s in y)return void r(s);const e=s.replace(/\.(jsx|js|ts|tsx)$/,"");if(e!==s&&e in y)return void r(e)}else{const e=s.replace(/\.(jsx|js|ts|tsx)$/,"");if(_(e))return void r(e)}if(!l&&(y||e)){const e=C();if(e){r(e);const t=new URLSearchParams(h.search);t.set("filePath",e),x("?".concat(t.toString()),{replace:!0})}}},[e,h.search,y]);const A=l||null,S=l?Qh(l):null,E=null==S?void 0:S.startsWith("functions/"),T=E?S.replace("functions/",""):null;return(0,se.jsx)("div",{className:"h-full w-ful rounded-lg overflow-hidden bg-white",children:(0,se.jsxs)(ZF,{direction:"horizontal",children:[(0,se.jsx)(JF,{ref:m,defaultSize:25,minSize:15,maxSize:40,collapsible:!0,collapsedSize:4,onCollapse:()=>v(!0),onExpand:()=>v(!1),className:"h-full overflow-hidden",children:f?(0,se.jsx)(sO,{onExpand:()=>{var e;null===(e=m.current)||void 0===e||e.expand()}}):(0,se.jsx)(qF,{selectedFile:l,onFileSelect:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!_(e))return;r(e),o(t);const s=new URLSearchParams;s.set("filePath",e),t&&s.set("line",t),x("?".concat(s.toString()),{replace:!0})},onBack:()=>{x("/apps/".concat(e.id,"/editor/workspace/overview"))},app:e,sandboxFiles:b?y:null,isLoadingSandboxFiles:N,onCollapse:()=>{var e;null===(e=m.current)||void 0===e||e.collapse()}})}),(0,se.jsx)(QF,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,se.jsx)(JF,{defaultSize:75,className:"flex-1 overflow-x-auto flex flex-col",children:A?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex items-center justify-between px-3 py-1.5 bg-white border-b border-slate-100",children:[(0,se.jsx)(eO,{selectedFile:l}),(0,se.jsx)(tO,{})]}),(0,se.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,se.jsx)(Xy,{filepath:A,selectedLine:i,onEdit:()=>{if(d(!0),null!==i){o(null);const e=new URLSearchParams(h.search);e.delete("line"),x("?".concat(e.toString()),{replace:!0})}},onSaveOrDiscard:()=>{d(!1)},isFunction:E,onRedeployFunction:async e=>{if(u.current)try{await u.current.handleRedeployFunction(e),g(!1)}catch(t){throw t}},functionHelperRef:u,isSaving:p,cachedAppFiles:y,isLoadingAppFiles:N,shouldFetchFilesFromSandbox:b,onUpdateCachedFile:w})}),E&&(0,se.jsx)(RF,{ref:u,functionName:T,hasUnsavedChanges:c})]}):(0,se.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500",children:"Select a file to view code"})})]})})},nO=()=>(0,se.jsx)(X.Ht,{client:XF,children:(0,se.jsx)(aO,{})});function lO(e){let{appId:t,appName:s,disabled:a=!1,disabledReason:n="",onError:l=()=>{}}=e;const[r,i]=(0,Y.useState)(!1),{entriLoaded:o}=ON();return(0,se.jsx)(zt,{size:"sm",onClick:async()=>{if(a)l("Cannot purchase domain",n||"Domain purchase is currently disabled");else if(o){i(!0);try{const e=await gy.getEntriToken({appId:t,appName:s}),a=(0,ue.A)({},e.config);await window.entri.purchaseDomain(a),Tu("Domain - Buy",{})}catch(c){var e,r;const t=(null===(e=c.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.detail)||c.message||"Failed to get purchase config",s=t.includes("Maximum of")&&t.includes("domains allowed");l(s?"Domain limit reached":"Error purchasing domain",t)}i(!1)}else l("Error","Entri is not ready yet. Please try again in a moment.")},disabled:r||!o||a,className:"h-8 px-4 rounded-md text-sm ".concat(a?"bg-red-100 hover:bg-red-100 text-red-700 border border-red-200 cursor-not-allowed":"bg-black text-white hover:bg-gray-800"),children:r?"Buy Domain":o?a?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(vR.A,{className:"h-3 w-3 mr-2"}),"Domain Limit Reached"]}):"Buy Domain":(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-3 w-3 mr-2 animate-spin"}),"Loading Entri..."]})})}const rO={clock:jS.A,check:hb.A,alert:ad.A,x:Uy.A,info:Oy.A},iO={badgeColor:"bg-red-100 text-red-700",badgeLabel:"Connection failed",badgeIcon:"info",badgeIconPosition:"right",actionButton:{label:"Retry",loadingLabel:"Retrying...",action:"retry",variant:"outline",icon:"retry"},secondaryActionButton:{label:"Cancel",loadingLabel:"Cancelling...",action:"cancel",variant:"outline"},showSettings:!1,showDelete:!1},oO=(0,ue.A)((0,ue.A)({},iO),{},{tooltip:"Couldn't complete DNS setup. Please try again."}),cO={badgeColor:"bg-[#FFE2A5] text-slate-800",badgeLabel:"Pending verification",badgeIcon:"info",badgeIconPosition:"right",tooltip:"Your email address is being verified.",actionButton:{label:"Cancel",loadingLabel:"Cancelling...",action:"cancel",variant:"outline"},showSettings:!1,showDelete:!1},dO={not_configured:{badgeColor:"bg-gray-100 text-gray-700",badgeLabel:"Not Configured",showSettings:!1},pending_dns_configuration:cO,pending_user_dns_configuration:{badgeColor:"bg-[#FFE2A5] text-slate-800",badgeLabel:"Pending verification",badgeIcon:"info",badgeIconPosition:"right",tooltip:"Make sure DNS records added correctly to your domain provider.",actionButton:{label:"Verify",loadingLabel:"Verifying...",action:"verify",variant:"outline"},secondaryActionButton:{label:"Cancel",loadingLabel:"Cancelling...",action:"cancel",variant:"outline"},showSettings:!1,showDelete:!1},pending_domain_verification:cO,active:{badgeColor:"bg-green-100 text-green-700",badgeLabel:"Active",actionButton:{label:"Edit Sender Details",loadingLabel:"Saving...",action:"edit",variant:"outline"},showSettings:!1,showDelete:!0},failed_provider_creation:(0,ue.A)((0,ue.A)({},iO),{},{tooltip:"Couldn't connect the domain to the email provider. Please try again."}),failed_dns_configuration:oO,failed_verification:(0,ue.A)((0,ue.A)({},iO),{},{tooltip:"Couldn't connect the domain to the email provider. Please try again."}),suspended:{badgeColor:"bg-orange-100 text-orange-700",badgeLabel:"Suspended",showSettings:!1},disabled:{badgeColor:"bg-gray-100 text-gray-700",badgeLabel:"Disabled",showSettings:!1}},uO={active:{color:"bg-green-100 text-green-700",label:"Active"},blocked:{color:"bg-red-100 text-red-700",label:"Blocked"},propagation_blocked:{color:"bg-orange-100 text-orange-700",label:"Propagation Blocked"},pending:{color:"bg-yellow-100 text-yellow-700",label:"Pending"},unlinked:{color:"bg-gray-100 text-gray-700",label:"Unlinked"}},mO=e=>{let{status:t,className:s,activeFromEmail:a,external:n,tooltipLink:l}=e;if(t in uO){const e=uO[t];return(0,se.jsx)("span",{className:de("px-2 py-0.5 text-xs rounded-full",e.color,s),children:e.label})}const r=dO[t]||dO.not_configured,i=r.badgeIcon?rO[r.badgeIcon]:null,o="right"===r.badgeIconPosition,c="pending_user_dns_configuration"===t&&!1===n,d="pending_dns_configuration"===t||"pending_domain_verification"===t,u=c?"Pending connection":r.badgeLabel;let m=r.tooltip;c?m=(0,se.jsxs)(se.Fragment,{children:["Complete setup to start sending emails from your domain. Emails are currently sent from ",(0,se.jsx)("strong",{children:"no-reply@base44-apps.com"}),"."]}):a&&d&&(m=(0,se.jsxs)(se.Fragment,{children:["Your email address is being verified. Emails are currently sent from ",(0,se.jsx)("strong",{children:a}),"."]})),l&&"pending_user_dns_configuration"===t?m="DNS records haven't been verified yet. Make sure they're set correctly, then click 'Verify'.":l&&"failed_verification"===t&&(m="Couldn't connect the domain to the email provider. Make sure DNS records added correctly to your domain provider and try again."),l&&(m=(0,se.jsxs)(se.Fragment,{children:[m," ",(0,se.jsx)("button",{onClick:l.onClick,className:"underline hover:text-gray-200",children:l.label})]}));const x=(0,se.jsxs)("span",{className:de("inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full",r.badgeColor,s),children:[i&&!o&&(0,se.jsx)(i,{className:"h-3 w-3"}),u,i&&o&&(0,se.jsx)(i,{className:"h-3 w-3"})]});return m?(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:x}),(0,se.jsx)(pp,{className:"w-[200px] px-3 py-1.5 text-left text-xs leading-normal rounded-lg bg-[#171717] text-[#FAFAFA] border-0 font-base44",children:m})]})}):x},xO=e=>{let{className:t}=e;return(0,se.jsxs)("span",{className:de("flex items-center justify-center gap-1 px-2 py-0.5 text-xs text-gray-500 bg-white border border-gray-200 rounded-md",t),children:[(0,se.jsx)(Dc,{width:12,height:12}),"Base44 Domain"]})},hO=e=>{let{isActive:t,isBlocked:s,isPropagationBlocked:a,isBase44Domain:n,className:l}=e,r=null;return s?r=(0,se.jsx)(mO,{status:"blocked"}):a?r=(0,se.jsx)(mO,{status:"propagation_blocked"}):t&&(r=(0,se.jsx)(mO,{status:"active"})),r||n?(0,se.jsxs)("div",{className:de("flex items-center gap-2",l),children:[r,n&&(0,se.jsx)(xO,{})]}):null},pO="no-reply@base44-apps.com",gO=()=>(0,se.jsxs)("div",{className:"flex items-center gap-1.5 mb-4",children:[(0,se.jsx)("h3",{className:"text-base font-medium text-black",children:"Email domain"}),(0,se.jsx)(mp,{delayDuration:0,children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,se.jsx)(pp,{className:"w-[240px] px-3 py-1.5 text-left text-xs leading-normal rounded-lg bg-[#171717] text-[#FAFAFA] border-0 font-base44",onPointerDownOutside:e=>e.preventDefault(),children:(0,se.jsxs)("p",{children:["Sending from the default domain costs 1 integration credit per email. Using a custom domain costs 2 integration credits."," ",(0,se.jsx)("a",{href:"https://docs.base44.com/Setting-up-your-app/Setting-up-your-custom-domain#sending-emails-from-a-custom-domain",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-gray-200",children:"Learn more"})]})})]})})]}),fO={retry:Yb.A,trash:zy.A,arrowUpRight:au.A},vO=e=>{let{icon:t,position:s="left"}=e;if(!t)return null;const a=fO[t],n="right"===s?"h-4 w-4 ml-2":"h-4 w-4 mr-2";return a?(0,se.jsx)(a,{className:n}):null},bO=e=>{let{status:t,activeFromEmail:s,external:a,tooltipLink:n}=e;return(0,se.jsx)(mO,{status:t,activeFromEmail:s,external:a,tooltipLink:n})},jO={success:{Icon:hb.A,className:"text-green-500"},pending:{Icon:jS.A,className:"text-[#FFB700]"},error:{Icon:Uy.A,className:"text-red-500"}},yO={active:jO.success,pending_dns_configuration:jO.pending,pending_user_dns_configuration:jO.pending,pending_domain_verification:jO.pending,failed_provider_creation:jO.error,failed_dns_configuration:jO.error,failed_verification:jO.error},NO=e=>{let{appName:t,appId:s,eligibleDomains:a,onBuyDomain:n,onUpdate:l}=e;const r=a.length>0,i=(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>dS.openModal("CustomSenderDetailsModal",{appId:s,appName:t,eligibleDomains:a,onComplete:l}),disabled:!r,children:"Use Your Custom Domain"});return(0,se.jsx)(Bv,{className:"border border-gray-200 rounded-xl bg-slate-50 shadow-sm",children:(0,se.jsx)(Wv,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Hc.A,{className:"h-5 w-5 text-gray-400 shrink-0"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"font-medium",children:"no-reply@base44-apps.com"}),(0,se.jsxs)("p",{className:"text-sm text-gray-500",children:["Sender Name: ",t," App"]})]})]}),(0,se.jsx)("div",{className:"shrink-0",children:r?i:(0,se.jsx)(mp,{delayDuration:0,children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("span",{tabIndex:0,children:i})}),(0,se.jsx)(pp,{className:"w-[200px] px-3 py-1.5 text-left text-xs leading-normal rounded-lg bg-[#171717] text-[#FAFAFA] border-0 font-base44",onPointerDownOutside:e=>e.preventDefault(),children:(0,se.jsxs)("p",{children:["Connect a domain to use a custom sender address."," ",n&&(0,se.jsx)("button",{onClick:n,className:"underline text-white hover:text-gray-200 cursor-pointer",children:"Buy a domain"})]})})]})})})]})})})},wO=e=>{var t;let{emailDomain:s,activeFromEmail:a,appId:n,appName:l,eligibleDomains:r,onUpdate:i}=e;const{toast:o}=Cb(),{entriLoaded:c}=ON(),[d,u]=(0,Y.useState)(!1),m="pending_user_dns_configuration"===s.configuration_status&&!s.external,x=async()=>{if(c&&window.entri){u(!0);try{const e=await DN.getConnectConfig({appId:n,domain:s.domain});await window.entri.showEntri(e.config)}catch(e){o({title:"DNS configuration failed",description:"Please try again later."})}finally{u(!1)}}else o({title:"DNS configuration",description:"Please wait a moment and try again."})},{mutate:h,isLoading:p}=eu({mutate:async()=>{if(!s)throw new Error("Email domain not found");const e=await DN.configure({appId:n,domain:s.domain});s.external&&"failed_verification"===e.configuration_status&&o({title:"Verification failed",description:"DNS records not yet verified. Please check your DNS configuration and try again.",icon:(0,se.jsx)(Uy.A,{className:"h-5 w-5 text-red-500"})}),i()},toastError:{title:"Domain verification failed",description:"We couldn't verify your DNS records. Please check them and try again."}}),{mutate:g,isLoading:f}=eu({mutate:async()=>{if(!s)throw new Error("Email domain not found");await DN.deleteEmailDomain({appId:n,domain:s.domain}),i()}}),v=(b=s.configuration_status,dO[b]||dO.not_configured);var b;const j=m?(0,ue.A)((0,ue.A)({},v),{},{actionButton:{label:"Complete Setup",loadingLabel:"Opening...",action:"connect_domain",variant:"outline",className:void 0,icon:"arrowUpRight",iconPosition:"right"},secondaryActionButton:{label:"Cancel",loadingLabel:"Cancelling...",action:"cancel",variant:"outline",className:void 0,icon:void 0}}):v,y={cancel:{onClick:()=>g({}),isLoading:f},retry:{onClick:()=>h({}),isLoading:p},"re-enable":{onClick:()=>h({}),isLoading:p},verify:{onClick:()=>h({}),isLoading:p},connect_domain:{onClick:x,isLoading:d},edit:{onClick:()=>dS.openModal("CustomSenderDetailsModal",{appId:n,appName:l,eligibleDomains:r,onComplete:i,mode:"edit",initialSenderName:s.sender_name,initialFromEmail:s.from_email}),isLoading:!1},view_dns:{onClick:m?x:()=>dS.openModal("DnsInstructionsModal",{dnsRecords:s.dns_records,domain:s.domain,flowType:"email_domain"}),isLoading:!1}},N=j.actionButton,w=N?y[N.action]:null,_=null!==(t=null==N?void 0:N.iconPosition)&&void 0!==t?t:"left",k=j.secondaryActionButton,C=k?y[k.action]:null,A=j.tertiaryActionButton,S=A?y[A.action]:null,E=(e=>{const t=yO[e],{Icon:s,className:a}=t;return(0,se.jsx)(s,{className:"h-5 w-5 shrink-0 ".concat(a)})})(s.configuration_status),T=s.external&&("pending_user_dns_configuration"===s.configuration_status||"failed_verification"===s.configuration_status)?{label:"View DNS records",onClick:()=>dS.openModal("DnsInstructionsModal",{dnsRecords:s.dns_records,domain:s.domain,flowType:"email_domain"})}:void 0;return(0,se.jsx)(se.Fragment,{children:(0,se.jsx)("div",{className:"space-y-3",children:(0,se.jsx)(Bv,{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:(0,se.jsx)(Wv,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[E,(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("p",{className:"font-medium",children:s.from_email}),(0,se.jsx)(bO,{status:s.configuration_status,activeFromEmail:a,external:s.external,tooltipLink:T})]}),(0,se.jsxs)("p",{className:"text-sm text-gray-500",children:["Sender Name: ",s.sender_name]})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[j.showDelete&&(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>g({}),disabled:f,className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:f?(0,se.jsx)(Fx.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(zy.A,{className:"h-4 w-4"})}),A&&S&&(0,se.jsx)(Bx,{variant:A.variant,size:"sm",onClick:S.onClick,disabled:S.isLoading,className:A.className,children:S.isLoading?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 animate-spin"}),A.loadingLabel]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(vO,{icon:A.icon}),A.label]})}),k&&C&&(0,se.jsx)(Bx,{variant:k.variant,size:"sm",onClick:C.onClick,disabled:C.isLoading,className:k.className,children:C.isLoading?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 animate-spin"}),k.loadingLabel]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(vO,{icon:k.icon}),k.label]})}),N&&w&&(0,se.jsx)(Bx,{variant:N.variant,size:"sm",onClick:w.onClick,disabled:w.isLoading,className:N.className,children:w.isLoading?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 animate-spin"}),N.loadingLabel]}):(0,se.jsxs)(se.Fragment,{children:["left"===_&&(0,se.jsx)(vO,{icon:N.icon}),N.label,"right"===_&&(0,se.jsx)(vO,{icon:N.icon,position:"right"})]})})]})]})})})})})},_O=e=>{let{appId:t,appName:s,domains:a,onRefresh:n,onBuyDomain:l}=e;const r=a.filter(zN),i=r.map(e=>e.domain).sort().join(","),{data:o,isLoading:c,refetch:d}=Xd({query:async()=>(await DN.listEmailDomains({appId:t})).email_domains,initialData:[]},[t,i]),{displayDomain:u,activeFromEmail:m}=(0,Y.useMemo)(()=>{if(!o||0===o.length)return{displayDomain:null,activeFromEmail:null};if(1===o.length){const e=o[0];return{displayDomain:e,activeFromEmail:BN(e.configuration_status)?pO:null}}const e=o.find(e=>"active"===e.configuration_status),t=o.find(e=>BN(e.configuration_status));return{displayDomain:t||e||o[0],activeFromEmail:t?(null==e?void 0:e.from_email)||pO:null}},[o]),x=()=>{d(),n()},h=!!u,p=r.map(e=>({domain:e.domain}));return c?(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)(gO,{}),(0,se.jsx)(Bv,{className:"border border-gray-200 rounded-xl bg-white shadow-sm",children:(0,se.jsx)(Wv,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"h-5 w-5 rounded-full animate-pulse bg-muted"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("div",{className:"h-4 w-48 rounded-md animate-pulse bg-muted"}),(0,se.jsx)("div",{className:"h-3 w-32 rounded-md animate-pulse bg-muted"})]})]}),(0,se.jsx)("div",{className:"h-8 w-36 rounded-md animate-pulse bg-muted"})]})})})]}):(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)(gO,{}),(0,se.jsx)("div",{className:"space-y-4",children:h?(0,se.jsx)(wO,{emailDomain:u,activeFromEmail:m,appId:t,appName:s,eligibleDomains:p,onUpdate:x},u.id):(0,se.jsx)(NO,{appName:s,appId:t,eligibleDomains:p,onBuyDomain:l,onUpdate:x})})]})},kO=["isLoading","loadingText","children"],CO=150,AO=e=>{let{isLoading:t,loadingText:s,children:a}=e,n=(0,Nt.A)(e,kO);return(0,se.jsx)(zt,(0,ue.A)((0,ue.A)({},n),{},{children:t?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 animate-spin"}),s]}):a}))},SO=e=>{let{open:t,onOpenChange:s,title:a,description:n,isLoading:l,loadingText:r,confirmText:i,onConfirm:o,variant:c="destructive"}=e;return(0,se.jsx)(ma,{open:t,onOpenChange:s,children:(0,se.jsxs)(fa,{children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:a}),(0,se.jsx)(ya,{children:n})]}),(0,se.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,se.jsx)(zt,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,se.jsx)(AO,{variant:c,onClick:o,disabled:l,isLoading:l,loadingText:r,children:i})]})]})})},EO=e=>{var t,s,a,n;let{domain:l}=e;const r=!(null===(t=l.purchase_info)||void 0===t||!t.purchase_time),i=!0===(null===(s=l.purchase_info)||void 0===s?void 0:s.blocked),o=(null===(a=l.purchase_info)||void 0===a?void 0:a.purchase_time)&&(null===(n=l.purchase_info)||void 0===n?void 0:n.propagation_status);return(0,se.jsx)(hO,{isActive:o,isBlocked:!1,isPropagationBlocked:i,isBase44Domain:r})},TO=e=>{let{status:t,lastChecked:s,lastPollingTime:a,isBoughtDomain:n,isActive:l,isUnlinked:r,purchaseTime:i}=e;if(r)return(0,se.jsx)("p",{className:"text-sm text-gray-500",children:t});if(n&&l&&i){const e=He()(i).add(365,"days").diff(He()(),"days");return e<0?(0,se.jsxs)("p",{className:"text-sm text-red-500",children:["Expired ",Math.abs(e)," days ago"]}):(0,se.jsxs)("p",{className:"text-sm ".concat(e<=30?"text-orange-500":"text-gray-500"),children:["Expires in ",e," days"]})}return(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"text-sm text-gray-500",children:t}),!n&&s&&(0,se.jsx)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:(0,se.jsxs)("span",{children:["Last checked: ",He().utc(s).fromNow()]})}),n&&!l&&a&&(0,se.jsx)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:(0,se.jsxs)("span",{children:["Last checked: ",He()(a).format("HH:mm:ss")]})})]})},IO=e=>{var t,s,a,n;let{domain:l,isChecking:r,isVerifying:i,isUnlinking:o,onCheck:c,onVerify:d,onUnlink:u}=e;const[m,x]=(0,Y.useState)(!1),{toast:h}=ao(),p=void 0!==(null===(t=l.purchase_info)||void 0===t?void 0:t.purchase_time),g=!0===(null===(s=l.purchase_info)||void 0===s?void 0:s.unlinked),f=(null===(a=l.purchase_info)||void 0===a?void 0:a.purchase_time)&&(null===(n=l.purchase_info)||void 0===n?void 0:n.propagation_status),v=async()=>{x(!0);try{await gy.link({appId:l.app_id,domainId:l.id}),h({title:"Domain linked",description:"Domain has been linked to your project",duration:3e3}),c()}catch(s){var e,t;h({variant:"destructive",title:"Error linking domain",description:(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Something went wrong",duration:3e3})}x(!1)};return g?(0,se.jsx)("div",{className:"flex items-center gap-2 justify-end",children:(0,se.jsx)(AO,{variant:"outline",size:"sm",onClick:v,disabled:m,isLoading:m,loadingText:"Linking...",children:"Link Domain"})}):(0,se.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[!f&&(0,se.jsxs)(AO,{variant:"ghost",size:"sm",onClick:c,className:"text-gray-500",disabled:r,isLoading:r,loadingText:"Checking...",children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2"}),"Check Status"]}),!p&&(0,se.jsx)(AO,{variant:"outline",size:"sm",onClick:d,disabled:i,isLoading:i,loadingText:"Verifying...",children:"Verify Domain"}),p&&!g&&(0,se.jsx)(AO,{variant:"outline",size:"sm",onClick:u,disabled:o,isLoading:o,loadingText:"Unlinking...",children:"Unlink Domain"})]})},PO=e=>{var t,s,a,n,l;let{domain:r,onUpdate:i,lastPollingTime:o}=e;const{toast:c}=ao(),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(!1),N=void 0!==(null===(t=r.purchase_info)||void 0===t?void 0:t.purchase_time),w=!0===(null===(s=r.purchase_info)||void 0===s?void 0:s.unlinked),_=null!==(k=r.purchase_info)&&void 0!==k&&k.unlinked?"Unlinked":null!==(C=r.purchase_info)&&void 0!==C&&C.purchase_time&&null!==(A=r.purchase_info)&&void 0!==A&&A.propagation_status?"Domain Active":null===(S=r.purchase_info)||void 0===S||!S.purchase_time||null!==(E=r.purchase_info)&&void 0!==E&&E.blocked?"verified"===(null===(T=r.last_status_payload)||void 0===T?void 0:T.verificationStatus)?"Verified":"error"===(null===(I=r.last_status_payload)||void 0===I?void 0:I.verificationStatus)?"Error":"Pending":"Waiting for DNS Propagation";var k,C,A,S,E,T,I;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(SO,{open:v,onOpenChange:b,title:"Delete Domain",description:"Are you sure you want to delete?",isLoading:m,loadingText:"Deleting...",confirmText:"Delete Domain",onConfirm:async()=>{x(!0);try{await gy.delete({appId:r.app_id,domainId:r.id}),c({title:"Domain deleted",duration:3e3}),i()}catch(s){var e,t;c({variant:"destructive",title:"Error deleting domain",description:(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Something went wrong",duration:3e3})}x(!1),b(!1)}}),(0,se.jsx)(SO,{open:j,onOpenChange:y,variant:"default",title:"Unlink Domain",description:"This domain was purchased through Base44.\n\nIt will remain listed under your domains but will no longer be connected to your project.",isLoading:g,loadingText:"Unlinking...",confirmText:"Unlink Domain",onConfirm:async()=>{f(!0);try{await gy.unlink({appId:r.app_id,domainId:r.id}),c({title:"Domain unlinked",description:"Domain has been unlinked from your project",duration:3e3}),i()}catch(s){var e,t;c({variant:"destructive",title:"Error unlinking domain",description:(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Something went wrong",duration:3e3})}f(!1),y(!1)}}),(0,se.jsx)(Es,{className:"border border-gray-200 rounded-[14px] bg-white shadow-sm hover:bg-gray-50 transition-colors ".concat(w?"opacity-60":""),children:(0,se.jsx)(Ls,{className:"p-4 w-full",children:(0,se.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:["Domain Active"===_||"Verified"===_?(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-500"}):(0,se.jsx)(ad.A,{className:"h-5 w-5 text-yellow-500"}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("a",{href:"https://".concat(r.domain),target:"_blank",children:(0,se.jsx)("p",{className:"font-medium",children:r.domain})}),(0,se.jsx)(EO,{domain:r})]}),(0,se.jsx)(TO,{status:_,lastChecked:r.last_status_check,lastPollingTime:o,isUnlinked:w,isBoughtDomain:N,isActive:(null===(a=r.purchase_info)||void 0===a?void 0:a.purchase_time)&&(null===(n=r.purchase_info)||void 0===n?void 0:n.propagation_status),purchaseTime:null===(l=r.purchase_info)||void 0===l?void 0:l.purchase_time})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>b(!0),className:"text-red-500 hover:text-red-600 hover:bg-red-50",disabled:m||N&&!w,children:(0,se.jsx)(zy.A,{className:"h-4 w-4 ".concat(m?"animate-spin":"")})}),(0,se.jsx)(IO,{domain:r,isChecking:h,isVerifying:d,isUnlinking:g,onCheck:async()=>{p(!0);try{var e;const t=void 0!==(null===(e=r.purchase_info)||void 0===e?void 0:e.purchase_time);t||await gy.refreshStatus({appId:r.app_id,domainId:r.id}),i(),t&&await new Promise(e=>setTimeout(e,1e3))}catch(a){var t,s;c({variant:"destructive",title:"Error checking status",description:(null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"Something went wrong",duration:3e3})}p(!1)},onVerify:async()=>{u(!0);try{await gy.verify({appId:r.app_id,domainId:r.id}),c({title:"Verification initiated",description:"Please check back in a few minutes",duration:3e3}),i()}catch(s){var e,t;c({variant:"destructive",title:"Error verifying domain",description:(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Something went wrong",duration:3e3})}u(!1)},onUnlink:()=>y(!0)})]})]})})})]})},LO=e=>{let{onUpgrade:t}=e;return(0,se.jsx)("div",{className:"w-full",children:(0,se.jsxs)("div",{className:"w-full rounded-lg p-12 text-center",style:{borderWidth:"2px",borderStyle:"dashed",borderColor:"#e5e7eb",borderRadius:"12px"},children:[(0,se.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Want to use your domain?"}),(0,se.jsxs)("p",{className:"text-gray-600 mb-6",children:["Custom domains are available on our Builder plan and above.",(0,se.jsx)("br",{}),"Upgrade to connect your domain to this app."]}),(0,se.jsx)(zt,{onClick:t,className:"bg-black text-white hover:bg-gray-800",children:"View Plans"})]})})},MO=e=>{let{domain:t,appId:s,appName:a,onDismiss:n,hasReachedDomainLimit:l,onError:r}=e;const[i,o]=(0,Y.useState)(!1),{entriLoaded:c}=ON();return(0,se.jsx)(Es,{className:"border border-slate-200 bg-slate-50/50 hover:bg-slate-50 hover:border-slate-300 transition-all",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsx)("div",{className:"flex items-center justify-between gap-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,se.jsx)(KP.A,{className:"h-4 w-4 text-slate-400 shrink-0"}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsxs)("p",{className:"text-sm text-slate-700",children:[(0,se.jsx)("span",{className:"font-medium text-slate-900",children:t})," is available"]})}),(0,se.jsx)(zt,{onClick:async()=>{if(l)r("Cannot purchase domain","Maximum of ".concat(CO," domains reached for this app"));else if(c){o(!0);try{const e=await gy.getEntriToken({appId:s,appName:a,domain:t}),n=(0,ue.A)({},e.config);await window.entri.purchaseDomain(n),Tu("Domain - Buy from Suggestion",{domain:t})}catch(i){var e,n;const t=(null===(e=i.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||i.message||"Failed to get purchase config",s=t.includes("Maximum of")&&t.includes("domains allowed");r(s?"Domain limit reached":"Error purchasing domain",t)}o(!1)}else r("Error","Entri is not ready yet. Please try again in a moment.")},variant:"outline",size:"sm",disabled:i||!c||l,className:"shrink-0",children:i?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-3.5 w-3.5 mr-2 animate-spin"}),"Processing..."]}):c?"Purchase":(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-3.5 w-3.5 mr-2 animate-spin"}),"Loading..."]})}),(0,se.jsx)("button",{onClick:n,className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded transition-colors shrink-0","aria-label":"Dismiss suggestion",children:(0,se.jsx)(la.A,{size:14})})]})})})})},RO=e=>{let{currentCount:t,maxCount:s}=e;return(0,se.jsx)(Es,{className:"border-orange-200 bg-orange-50",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-orange-500 shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,se.jsx)("p",{className:"font-medium text-orange-800",children:"Domain Limit Reached"}),(0,se.jsxs)("p",{className:"text-orange-700",children:["You have reached the maximum of ",s," domains for this app (",t,"/",s,"). Please remove some domains before adding new ones."]})]})]})})})},DO=e=>{let{onBuyDomain:t}=e;return(0,se.jsxs)("div",{className:"w-full flex flex-col items-center rounded-[14px] border border-gray-200 bg-slate-50 px-10 py-6 gap-4 shadow-sm font-base44",children:[(0,se.jsxs)("div",{className:"flex flex-col items-center gap-1 text-center",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"You haven't connected a custom domain yet"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Connect your Base44 app to your own domain to put your brand front and center, and make your\xa0app easy to find and share."})]}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:t,children:"Buy Domain"})]})},FO=e=>{let{app:t,onUpdate:s,isPaidTier:a=!0}=e;const[n,l]=(0,Y.useState)(!1),{toast:r}=ao(),i=Tc(t).replace(/^https?:\/\//,"");return t?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(OO,{app:t,onUpdate:s,open:n,onOpenChange:l,isPaidTier:a}),(0,se.jsx)(Es,{className:"border rounded-lg",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("div",{className:"text-[16px] font-medium mb-1",children:i}),(0,se.jsx)("div",{className:"text-sm text-gray-500",children:"Never Expires"})]}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>l(!0),className:"ml-4",children:"Edit URL"})]})})})]}):null},OO=e=>{let{app:t,onUpdate:s,open:a,onOpenChange:n,isPaidTier:l=!0}=e;const[r,i]=(0,Y.useState)((null==t?void 0:t.slug)||""),[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)(""),{toast:m}=ao(),x=(0,J.Zp)();(0,Y.useEffect)(()=>{i((null==t?void 0:t.slug)||""),u("")},[null==t?void 0:t.slug]);if(!t)return null;return(0,se.jsx)(ma,{open:a,onOpenChange:n,children:(0,se.jsxs)(fa,{className:"w-[634px] max-w-[634px] p-6",children:[(0,se.jsx)(va,{className:"text-left mb-3",children:(0,se.jsx)(ja,{className:"text-lg font-semibold",children:"Edit URL"})}),(0,se.jsx)("div",{className:"space-y-6",children:(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,se.jsx)("p",{className:"text-sm font-normal text-gray-500",children:"Base44 Built-in domain"}),r&&(0,se.jsx)("button",{onClick:async()=>{c(!0);try{await s({slug:null});const e=Tc(t).replace(/^https?:\/\//,"");m({title:"Slug reset to default",description:"Your app is now available at ".concat(e),duration:3e3}),Tu("Custom URL - Reset to Default",{}),n(!1),i("")}catch(d){var e,a;m({variant:"destructive",title:"Error resetting slug",description:(null===(e=d.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to reset to default slug",duration:3e3})}c(!1)},disabled:o,className:"text-sm text-black hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reset to default"})]}),l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"relative flex items-center h-10 rounded-md border border-gray-300 bg-white hover:bg-gray-50 focus-within:ring-2 focus-within:ring-black focus-within:border-black",children:[(0,se.jsx)("span",{className:"text-sm text-gray-500 pl-3 select-none",children:"https://"}),(0,se.jsx)("input",{value:r,onChange:e=>{i(e.target.value.toLowerCase()),u("")},className:"flex-1 text-base bg-transparent outline-none"}),(0,se.jsxs)("span",{className:"text-sm text-gray-400 pr-3 select-none",children:[".","base44.app"]})]}),d&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-red-600 mt-2",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:d})]}),(0,se.jsx)("div",{className:"flex justify-end items-center mt-6",children:(0,se.jsx)(AO,{onClick:async()=>{c(!0);try{if(!r){await s({slug:null});const e=Tc(t).replace(/^https?:\/\//,"");return m({title:"URL updated",description:"Custom url removed. Your app is now available at ".concat(e),duration:3e3}),n(!1),i(""),void c(!1)}await s({slug:r});const e=Tc((0,ue.A)((0,ue.A)({},t),{},{slug:r})).replace(/^https?:\/\//,"");m({title:"URL updated",description:"Your app is now available at ".concat(e),duration:3e3}),Tu("Custom URL - Updated",{}),n(!1),i(r)}catch(d){var e,a;const s=(null===(e=d.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||d.message||"Something went wrong";s.toLowerCase().includes("is already in use")?u("URL change failed, this URL is already taken. Please try a different one."):s.toLowerCase().includes("this subdomain is reserved")?u("This URL is reserved. Please try a different one."):u("This URL is invalid. Please try a different one.")}c(!1)},disabled:o||r===(null==t?void 0:t.slug),isLoading:o,loadingText:"Changing...",className:"bg-black text-white hover:bg-gray-800 ml-auto",children:"Change"})})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"relative flex items-center h-10 rounded-md border border-gray-300 bg-gray-100",children:[(0,se.jsx)("span",{className:"text-sm text-gray-500 pl-3 select-none",children:"https://"}),(0,se.jsx)("input",{value:null==t?void 0:t.slug,disabled:!0,className:"flex-1 text-base bg-transparent outline-none"}),(0,se.jsxs)("span",{className:"text-sm text-gray-400 pr-3 select-none",children:[".","base44.app"]})]}),(0,se.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-blue-500 mt-0.5 shrink-0"}),(0,se.jsxs)("p",{className:"text-sm text-blue-800",children:["URL editing requires a starter plan."," ",(0,se.jsx)("button",{onClick:()=>{n(!1),x("/billing")},className:"underline font-medium hover:text-blue-900",children:"Upgrade to Premium"})]})]})})]})]})})]})})};function UO(e){var t;let{appId:s,appName:a}=e;const{user:n}=wd(),{app:l,updateSlug:r,suggestions:i,dismissDomainSuggestion:o}=lp(),[c,d]=(0,Y.useState)([]),[u,m]=(0,Y.useState)(!0),{toast:x}=ao(),h=(0,J.Zp)(),p=(0,Y.useRef)(null),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(null),[j,y]=(0,Y.useState)(null),N=Uj(n,"builder"),w=c.length>=CO,_=async()=>{try{const t=await gy.list({appId:s});if(d(t),y(Date.now()),v){const s=t.find(e=>e.domain===v);var e;if(s)b(null),null!==(e=s.purchase_info)&&void 0!==e&&e.propagation_status||g?C():k()}const a=t.some(e=>{var t,s,a;return(null===(t=e.purchase_info)||void 0===t?void 0:t.purchase_time)&&!(null!==(s=e.purchase_info)&&void 0!==s&&s.propagation_status)&&!(null!==(a=e.purchase_info)&&void 0!==a&&a.blocked)&&!e.disabled});a&&!g?k():!a&&g&&C()}catch(n){var t,a;x({variant:"destructive",title:"Error fetching domains",description:(null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Something went wrong",duration:3e3})}finally{m(!1)}},k=()=>{f(!0),p.current&&clearInterval(p.current),p.current=setInterval(_,1e4)},C=()=>{f(!1),p.current&&(clearInterval(p.current),p.current=null)};(0,Y.useEffect)(()=>(N&&_(),()=>{C()}),[s,N]),(0,Y.useEffect)(()=>{const e=new URLSearchParams(window.location.search),t=e.get("result"),s=e.get("domain");if(t||s||Tu("Domain - Manage",{}),t&&s){"success"===t?(x({title:"Domain Purchased!",description:"Your domain ".concat(s," was purchased successfully. Waiting for it to appear in your domains...")}),b(s),k(),Tu("Domain - Purchased Successfully",{domain:s})):x({variant:"destructive",title:"Domain Purchase Failed",description:"Purchase failed for ".concat(s,".")});const e=new URL(window.location);e.searchParams.delete("result"),e.searchParams.delete("domain"),window.history.replaceState({},document.title,e.pathname)}},[]);const A=async e=>{if(!e)return!1;if(w)return x({variant:"destructive",title:"Domain limit reached",description:"You can only have up to ".concat(CO," domains per app. Please remove some domains first."),duration:5e3}),!1;m(!0);try{return await gy.create({appId:s,domain:e}),await _(),x({title:"Domain added successfully.",description:"Please verify your domain to complete setup.",duration:3e3,icon:(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-500"})}),m(!1),!0}catch(n){var t,a;return x({variant:"destructive",title:"Failed to connect your domain",description:(null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Something went wrong",duration:3e3}),m(!1),!1}},S=(e,t)=>{const s=e.includes("Domain limit reached")||t.includes("Maximum of");x({variant:"destructive",title:e,description:t,duration:s?5e3:3e3})},E=async()=>{if(window.entri)try{const e=await gy.getEntriToken({appId:s,appName:a});await window.entri.purchaseDomain(e.config)}catch(n){var e,t;const s=(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||n.message||"Failed to get purchase config";S("Error purchasing domain",s)}else S("Error","Please try again in a moment.")};return(0,se.jsxs)(lL,{title:"Domains",subtitle:(0,se.jsxs)("p",{children:["Buy, connect and manage your domains. ",(0,se.jsx)("a",{href:"https://docs.base44.com/Guides/Setting-up-your-custom-domain#custom-domain-setup-and-troubleshooting-guide",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Learn more"})]}),actions:N&&!w&&(0,se.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",className:"h-8 px-4 rounded-md text-sm",onClick:()=>dS.openModal("ConnectDomainModal",{onAdd:A,loading:u,onOpenDnsInstructions:()=>dS.openModal("DnsInstructionsModal")}),children:"Connect Your Domain"}),(0,se.jsx)(lO,{appId:s,appName:a,disabled:w,disabledReason:w?"Maximum of ".concat(CO," domains reached for this app"):"",onError:S})]}),children:[(0,se.jsx)(lo,{}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("h3",{className:"text-base font-medium text-black mb-4",children:"Built-in domain"}),(0,se.jsx)(FO,{app:l,onUpdate:r,isPaidTier:!0})]}),(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("h3",{className:"text-base font-medium text-black mb-4",children:"Custom domains"}),N&&(null==i?void 0:i.domain_suggestion)&&!i.domain_suggestion.dismissed&&(null===(t=i.domain_suggestion.api_response)||void 0===t?void 0:t.domain)&&(0,se.jsx)("div",{className:"mb-4",children:(0,se.jsx)(MO,{domain:i.domain_suggestion.api_response.domain,appId:s,appName:a,onDismiss:o,hasReachedDomainLimit:w,onError:S})}),N?u?(0,se.jsx)(Es,{className:"border rounded-lg",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"h-5 w-5 rounded-full animate-pulse bg-muted"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("div",{className:"h-4 w-48 rounded-md animate-pulse bg-muted"}),(0,se.jsx)("div",{className:"h-3 w-32 rounded-md animate-pulse bg-muted"})]})]}),(0,se.jsx)("div",{className:"h-8 w-24 rounded-md animate-pulse bg-muted"})]})})}):(0,se.jsxs)(se.Fragment,{children:[w&&(0,se.jsx)(RO,{currentCount:c.length,maxCount:CO}),c.length>0?(0,se.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,se.jsx)(PO,{domain:e,onUpdate:_,lastPollingTime:j},e.id))}):(0,se.jsx)(DO,{onBuyDomain:E})]}):(0,se.jsx)(LO,{onUpgrade:()=>h("/billing")})]}),N&&(0,se.jsx)(_O,{appId:s,appName:a,domains:c,onRefresh:_,onBuyDomain:E})]})]})}var BO=s(35097),zO=s(54699),HO=s(81946);function VO(e){let{rule:t}=e;if(!t)return(0,se.jsx)("span",{className:"text-muted-foreground",children:"No restrictions"});if("{{user.email}}"===t.created_by)return(0,se.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(ay.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}})," Creator only"]});if(t.user_condition&&"admin"===t.user_condition.role)return(0,se.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(HO.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}})," Admin only"]});if(t.$or)return(0,se.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,se.jsx)("span",{className:"bg-secondary text-secondary-foreground text-xs rounded-md px-1.5 py-0.5",children:"OR"}),(0,se.jsxs)("span",{children:[t.$or.length," conditions"]})]});if(t.$and)return(0,se.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,se.jsx)("span",{className:"bg-secondary text-secondary-foreground text-xs rounded-md px-1.5 py-0.5",children:"AND"}),(0,se.jsxs)("span",{children:[t.$and.length," conditions"]})]});const s=Object.keys(t).filter(e=>!e.startsWith("$"));if(s.length){const e=s[0],a=t[e];if("string"==typeof a&&a.startsWith("{{user."))return(0,se.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(xb.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}}),(0,se.jsxs)("span",{className:"text-xs font-medium",children:[e.replace("data.","")," = user field"]})]})}if(t.field_condition){const e=Object.entries(t.field_condition).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(JSON.stringify(s))}).join(", ");return(0,se.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(xb.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}}),(0,se.jsxs)("span",{className:"text-xs font-medium",children:["Field(s): ",e]})]})}return(0,se.jsxs)("span",{className:"text-xs font-medium flex items-center gap-1.5",children:[(0,se.jsx)(Yc.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}}),"Custom rule"]})}function WO(e){let{rec:t,onApply:s,onDismiss:a,forceOpen:n,onOpen:l}=e;const[r,i]=(0,Y.useState)(!!n),[o,c]=(0,Y.useState)(!1),d=(e,t,s)=>(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-1 text-black font-medium text-sm",children:[t,s]}),o?(0,se.jsx)("textarea",{className:"w-full font-mono text-xs border border-slate-200 rounded p-2 resize-none text-black",style:{background:"#F3F6F9"},rows:3,value:e,readOnly:!0}):(0,se.jsx)("div",{className:"w-full text-xs min-h-[32px] flex flex-col gap-1",children:(()=>{try{const t="string"==typeof e?JSON.parse(e):e;if(t&&(t.$or||t.$and)){return(t.$or||t.$and).map((e,t)=>(0,se.jsx)(VO,{rule:e},t))}return(0,se.jsx)(VO,{rule:t})}catch(t){return(0,se.jsx)("span",{children:e})}})()})]});return t?r?(0,se.jsxs)("div",{className:"mt-6 border border-slate-200 rounded-xl p-6 flex flex-col gap-4 shadow-sm animate-in fade-in relative",style:{background:"#fff"},children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)("button",{className:"rec-collapsible-trigger mr-2 p-0.5 flex items-center justify-center",style:{width:24,height:24,background:"none",border:"none",boxShadow:"none"},onClick:e=>{e.stopPropagation(),i(!1),a&&a()},"aria-label":"Collapse recommendations",children:(0,se.jsx)(ur.A,{className:"h-4 w-4 text-slate-500"})}),(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-black",strokeWidth:2,fill:"none"}),(0,se.jsx)("span",{className:"font-semibold text-[1.08rem] text-black",children:"RLS Recommendation"})]}),(0,se.jsx)("div",{className:"text-muted-foreground text-sm mb-2",children:t.description}),(0,se.jsxs)("div",{className:"flex items-center gap-1 mb-2",children:[(0,se.jsx)("span",{className:"text-xs text-slate-700",children:"JSON"}),(0,se.jsx)(ei,{checked:o,onCheckedChange:c,onClick:e=>e.stopPropagation(),onFocus:e=>e.stopPropagation(),className:"scale-75"})]}),(0,se.jsxs)("div",{className:o?"flex flex-col gap-3":"grid grid-cols-2 gap-3",children:[t.create_rule&&"{}"!==t.create_rule&&d(t.create_rule,(0,se.jsx)(BO.A,{className:"h-4 w-4 text-green-600 opacity-60"}),"Create"),t.read_rule&&"{}"!==t.read_rule&&d(t.read_rule,(0,se.jsx)(lA.A,{className:"h-4 w-4 text-blue-600 opacity-60"}),"Read"),t.update_rule&&"{}"!==t.update_rule&&d(t.update_rule,(0,se.jsx)(zO.A,{className:"h-4 w-4 text-amber-600 opacity-60"}),"Update"),t.delete_rule&&"{}"!==t.delete_rule&&d(t.delete_rule,(0,se.jsx)(zy.A,{className:"h-4 w-4 text-red-600 opacity-60"}),"Delete")]}),(0,se.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,se.jsx)(zt,{variant:"ghost",className:"text-black border border-transparent hover:border-slate-300 px-4 py-2 rounded rec-save-btn",onClick:e=>{e.stopPropagation(),i(!1),a&&a()},children:"Dismiss"}),(0,se.jsx)(zt,{className:"bg-black hover:bg-slate-800 text-white font-semibold px-4 rounded-md shadow rec-save-btn text-xs flex items-center justify-center",style:{minWidth:102,height:28},onClick:e=>{e.stopPropagation(),s&&s()},children:"Apply Fixes"})]})]}):(0,se.jsxs)("div",{className:"mt-6 w-full bg-white border border-slate-200 rounded-lg px-4 py-2 pb-3 cursor-pointer text-xs flex flex-wrap md:flex-nowrap items-center justify-between gap-2",style:{marginBottom:0,paddingBottom:0},onClick:e=>{e.stopPropagation(),n||(i(!0),l&&l())},children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap flex-1 min-w-0",children:[(0,se.jsx)("button",{className:"rec-collapsible-trigger mr-2 p-0.5 flex items-center justify-center",style:{width:24,height:24,background:"none",border:"none",boxShadow:"none"},onClick:e=>{e.stopPropagation(),n||(i(!0),l&&l())},"aria-label":"Expand recommendations",children:(0,se.jsx)(_t.A,{className:"h-4 w-4 text-slate-500"})}),(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-black",strokeWidth:2,fill:"none"}),(0,se.jsx)("span",{className:"font-semibold text-black text-xs truncate",children:"RLS Recommendation"})]}),(0,se.jsx)("div",{className:"flex-shrink-0 w-full md:w-auto flex justify-end",children:(0,se.jsx)(zt,{className:"bg-black hover:bg-slate-800 text-white font-semibold px-4 rounded-md shadow rec-save-btn text-xs flex items-center justify-center mt-1 mb-2 md:mt-0 mr-2 md:mr-4",style:{minWidth:102,height:28},onClick:e=>{e.stopPropagation(),s&&s()},children:"Apply Fixes"})})]}):null}function qO(e){let{entity:t,scanResult:s,rlsRecs:a,onSaveRecommendation:n,onClick:l,clickable:r,forceOpenRLS:i,onRLSOpen:o}=e;const c=t.rls&&Object.keys(t.rls).length>0,d=c&&t.rls.read&&Object.keys(t.rls.read).length>0,u=c&&t.rls.write&&Object.keys(t.rls.write).length>0,m=c&&t.rls.create&&Object.keys(t.rls.create).length>0,x=c&&t.rls.update&&Object.keys(t.rls.update).length>0,h=c&&t.rls.delete&&Object.keys(t.rls.delete).length>0;let p=[];s&&a&&a.length>0&&(p=a.map((e,t)=>(0,ue.A)((0,ue.A)({},e),{},{_idx:t})).filter(e=>e.entity_name===t.name));return(0,se.jsxs)("div",{className:"w-full h-full rounded-xl border bg-white shadow-sm p-6 transition-all cursor-pointer hover:shadow-md flex flex-col ".concat(r?"hover:bg-muted/30":""),onClick:e=>{e.target.closest(".rec-collapsible-trigger")||e.target.closest(".rec-save-btn")||r&&l&&l()},tabIndex:r?0:void 0,role:r?"button":void 0,children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-base font-semibold",children:t.title||t.name}),(0,se.jsxs)(gs,{variant:c?"default":"outline",className:"ml-2 ".concat(c?"bg-blue-100 text-blue-800 hover:bg-blue-200":""),children:[c?(0,se.jsx)(Vc.A,{className:"h-3 w-3 mr-1"}):(0,se.jsx)(lA.A,{className:"h-3 w-3 mr-1"}),c?"Restricted":"Public"]})]}),(0,se.jsx)("div",{className:"space-y-3 text-sm mt-2",children:c?(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full",children:[(0,se.jsxs)("div",{className:"flex flex-col items-start",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-1 min-h-[24px]",children:[(0,se.jsx)(BO.A,{className:"h-4 w-4 text-green-600 opacity-60"}),(0,se.jsx)("span",{className:"text-muted-foreground font-medium",children:"Create:"})]}),(0,se.jsx)("div",{className:"flex flex-col gap-0.5 w-full",children:m?Array.isArray(t.rls.create.$or)?t.rls.create.$or.map((e,t)=>(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:e})},t)):(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:t.rls.create})}):(0,se.jsx)("span",{className:"text-muted-foreground",children:"No restrictions"})})]}),(0,se.jsxs)("div",{className:"flex flex-col items-start",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-1 min-h-[24px]",children:[(0,se.jsx)(lA.A,{className:"h-4 w-4 text-blue-600 opacity-60"}),(0,se.jsx)("span",{className:"text-muted-foreground font-medium",children:"Read:"})]}),(0,se.jsx)("div",{className:"flex flex-col gap-0.5 w-full",children:d?Array.isArray(t.rls.read.$or)?t.rls.read.$or.map((e,t)=>(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:e})},t)):(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:t.rls.read})}):(0,se.jsx)("span",{className:"text-muted-foreground",children:"No restrictions"})})]}),(0,se.jsxs)("div",{className:"flex flex-col items-start",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-1 min-h-[24px]",children:[(0,se.jsx)(zO.A,{className:"h-4 w-4 text-amber-600 opacity-60"}),(0,se.jsx)("span",{className:"text-muted-foreground font-medium",children:"Update:"})]}),(0,se.jsx)("div",{className:"flex flex-col gap-0.5 w-full",children:x?Array.isArray(t.rls.update.$or)?t.rls.update.$or.map((e,t)=>(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:e})},t)):(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:t.rls.update})}):u?Array.isArray(t.rls.write.$or)?t.rls.write.$or.map((e,t)=>(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:e})},t)):(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:t.rls.write})}):(0,se.jsx)("span",{className:"text-muted-foreground",children:"No restrictions"})})]}),(0,se.jsxs)("div",{className:"flex flex-col items-start",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-1 min-h-[24px]",children:[(0,se.jsx)(zy.A,{className:"h-4 w-4 text-red-600 opacity-60"}),(0,se.jsx)("span",{className:"text-muted-foreground font-medium",children:"Delete:"})]}),(0,se.jsx)("div",{className:"flex flex-col gap-0.5 w-full",children:h?Array.isArray(t.rls.delete.$or)?t.rls.delete.$or.map((e,t)=>(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:e})},t)):(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:t.rls.delete})}):u?Array.isArray(t.rls.write.$or)?t.rls.write.$or.map((e,t)=>(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:e})},t)):(0,se.jsx)("div",{className:"flex items-center py-0.5",children:(0,se.jsx)(VO,{rule:t.rls.write})}):(0,se.jsx)("span",{className:"text-muted-foreground",children:"No restrictions"})})]})]})}):(0,se.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-2 text-red-500"}),(0,se.jsx)("span",{children:"All users have full access"})]})}),p.length>0&&(0,se.jsx)(WO,{rec:p[0],onApply:()=>n(p[0]._idx),forceOpenRLS:i,onOpen:o})]})}function YO(e){var t;let{rule:s,onChange:a,onDelete:n,canRemove:l,index:r}=e;const{app:i}=lp(),[o,c]=(0,Y.useState)(()=>s&&0!==Object.keys(s).length?"{{user.email}}"===s.created_by?"creatorOnly":s.user_condition?"userProperty":"fieldComparison":"none"),[d,u]=(0,Y.useState)(""),[m,x]=(0,Y.useState)(""),[h,p]=(0,Y.useState)("role"),[g,f]=(0,Y.useState)(""),v=(null==i||null===(t=i.user_entity)||void 0===t?void 0:t.properties)||{},b=Object.keys(v).filter(e=>!["role","email","full_name"].includes(e));(0,Y.useEffect)(()=>{if(s&&Object.keys(s).length>0)if(s.user_condition){c("userProperty");const e=Object.keys(s.user_condition)[0];p(e),f(s.user_condition[e])}else if("{{user.email}}"===s.created_by)c("creatorOnly");else{const e=Object.keys(s).filter(e=>!e.startsWith("$"));if(e.length){const t=e[0],a=s[t];"string"==typeof a&&a.startsWith("{{user.")&&(c("fieldComparison"),u(t.replace("data.","")),x(a.substring(7,a.length-2)))}}else c("none"),u(""),x(""),p("role"),f("")},[s]);(0,Y.useEffect)(()=>{if("fieldComparison"===o&&d&&m){let e=d;["id","created_by","updated_date","created_date"].includes(d)||(e="data.".concat(d)),a({[e]:"{{user.".concat(m,"}}")})}},[d,m,o,a]),(0,Y.useEffect)(()=>{"userProperty"===o&&h&&g&&a({user_condition:{[h]:g}})},[h,g,o,a]);return(0,se.jsxs)("div",{className:"p-5 border rounded-lg relative mb-5 bg-white shadow-sm",children:[l&&(0,se.jsx)(zt,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 h-7 w-7 text-destructive hover:bg-red-50",onClick:n,title:"Remove rule",children:(0,se.jsx)(zy.A,{className:"h-4 w-4"})}),(0,se.jsxs)(lr,{value:o,onValueChange:e=>{c(e),"none"===e?a(null):"creatorOnly"===e?a({created_by:"{{user.email}}"}):"fieldComparison"===e?(u(""),x("")):"userProperty"===e&&(p("role"),f(""))},className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,se.jsx)(rr,{value:"none",id:"none-".concat(r),className:"mt-1"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)(On,{htmlFor:"none-".concat(r),className:"font-medium flex items-center gap-2",children:[(0,se.jsx)(lA.A,{className:"h-4 w-4 text-green-500"}),"No Restrictions"]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"All users can access records"})]})]}),(0,se.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,se.jsx)(rr,{value:"creatorOnly",id:"creatorOnly-".concat(r),className:"mt-1"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)(On,{htmlFor:"creatorOnly-".concat(r),className:"font-medium flex items-center gap-2",children:[(0,se.jsx)(ay.A,{className:"h-4 w-4 text-indigo-500"}),"Creator Only"]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Users can only access records they created"})]})]}),(0,se.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,se.jsx)(rr,{value:"fieldComparison",id:"fieldComparison-".concat(r),className:"mt-1"}),(0,se.jsxs)("div",{className:"space-y-1 w-full",children:[(0,se.jsxs)(On,{htmlFor:"fieldComparison-".concat(r),className:"font-medium flex items-center gap-2",children:[(0,se.jsx)(xb.A,{className:"h-4 w-4 text-emerald-500"}),"Entity-User Field Comparison"]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Compare a field in this entity with a user property"}),"fieldComparison"===o&&(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-3 bg-muted/20 rounded-lg",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(On,{className:"flex items-center gap-1.5",children:[(0,se.jsx)(oy.A,{className:"h-3.5 w-3.5 text-primary/70"}),"Entity Field"]}),(0,se.jsx)(nl,{placeholder:"e.g. department",value:d,onChange:e=>u(e.target.value),className:"border-muted-foreground/30 focus:border-primary"}),(0,se.jsx)("p",{className:"text-xs text-muted-foreground",children:"Field in the entity to compare"})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(On,{className:"flex items-center gap-1.5",children:[(0,se.jsx)(ay.A,{className:"h-3.5 w-3.5 text-primary/70"}),"User Field"]}),(0,se.jsxs)(br,{value:m,onValueChange:x,children:[(0,se.jsx)(Nr,{className:"border-muted-foreground/30 focus:border-primary",children:(0,se.jsx)(yr,{placeholder:"Select user field"})}),(0,se.jsx)(kr,{children:(()=>{const e=b.map(e=>({value:"data.".concat(e),label:e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ")}));return[{value:"email",label:"Email"},{value:"role",label:"Role"},{value:"id",label:"User ID"},{value:"full_name",label:"Full Name"},...e]})().map(e=>(0,se.jsx)(Ar,{value:e.value,children:e.label},e.value))})]}),(0,se.jsx)("p",{className:"text-xs text-muted-foreground",children:"Field from the user to compare"})]})]})]})]}),(0,se.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,se.jsx)(rr,{value:"userProperty",id:"userProperty-".concat(r),className:"mt-1"}),(0,se.jsxs)("div",{className:"space-y-1 w-full",children:[(0,se.jsxs)(On,{htmlFor:"userProperty-".concat(r),className:"font-medium flex items-center gap-2",children:[(0,se.jsx)(HO.A,{className:"h-4 w-4 text-amber-500"}),"User Property Check"]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Check if a user property matches a specific value"}),"userProperty"===o&&(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-3 bg-muted/20 rounded-lg",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(On,{className:"flex items-center gap-1.5",children:[(0,se.jsx)(ay.A,{className:"h-3.5 w-3.5 text-primary/70"}),"User Property"]}),(0,se.jsxs)(br,{value:h,onValueChange:p,children:[(0,se.jsx)(Nr,{className:"border-muted-foreground/30 focus:border-primary",children:(0,se.jsx)(yr,{placeholder:"Select user property"})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"role",children:"User Role"}),(0,se.jsx)(Ar,{value:"email",children:"User Email"}),(0,se.jsx)(Ar,{value:"full_name",children:"Full Name"}),b.map(e=>(0,se.jsx)(Ar,{value:"data.".concat(e),children:e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ")},"data.".concat(e)))]})]})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(On,{className:"flex items-center gap-1.5",children:[(0,se.jsx)(sd.A,{className:"h-3.5 w-3.5 text-primary/70"}),"Required Value"]}),"role"===h?(0,se.jsxs)(br,{value:g,onValueChange:f,children:[(0,se.jsx)(Nr,{className:"border-muted-foreground/30 focus:border-primary",children:(0,se.jsx)(yr,{placeholder:"Select role"})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"admin",children:"Admin"}),(0,se.jsx)(Ar,{value:"user",children:"User"})]})]}):(0,se.jsx)(nl,{placeholder:"email"===h?"e.g. admin@example.com":"e.g. required value",value:g,onChange:e=>f(e.target.value),className:"border-muted-foreground/30 focus:border-primary"}),(0,se.jsx)("p",{className:"text-xs text-muted-foreground",children:"role"===h?"Select the required user role":"Value that the user property must match"})]})]})]})]})]})]})}function GO(e){let{entity:t,onSave:s,onBack:a}=e;const[n,l]=(0,Y.useState)(KO(t.rls)),[r,i]=(0,Y.useState)("create"),[o,c]=(0,Y.useState)(t.rls&&Object.keys(t.rls).length>0?"restricted":"public"),[d,u]=(0,Y.useState)(!1),m=e=>{switch(e){case"create":return"Create Access";case"read":return"Read Access";case"update":return"Update Access";case"delete":return"Delete Access";default:return"Access"}},x=e=>{const t=n[e];return t?t.$or?t.$or:[t]:[{}]},h=(e,t)=>{const s=t.filter(e=>null!=e);let a;a=0===s.length?void 0:1===s.length?s[0]:{$or:s},l(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:a}))};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Zt,{open:d,onOpenChange:u,children:(0,se.jsxs)(es,{children:[(0,se.jsxs)(ts,{children:[(0,se.jsxs)(as,{className:"flex items-center gap-2",children:[(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-amber-500"}),"Remove All Security Rules"]}),(0,se.jsx)(ns,{children:"This will remove all security rules for this entity, allowing all users to access all records. Are you sure you want to continue?"})]}),(0,se.jsxs)(ss,{children:[(0,se.jsx)(rs,{children:"Cancel"}),(0,se.jsx)(ls,{onClick:()=>{c("public"),l({}),u(!1)},className:"bg-red-600 hover:bg-red-700 text-white",children:"Remove All Rules"})]})]})}),(0,se.jsxs)("div",{className:"flex items-center justify-between mb-6 space-x-4 border-b pb-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:a,className:"hover:bg-muted/50",children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4 mr-2"})," Back"]}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[(0,se.jsx)(Yc.A,{className:"h-5 w-5 text-primary"}),"Security Rules: ",t.title||t.name]}),"restricted"===o&&(0,se.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Create rules to control who can read and write records. Multiple rules are combined with OR logic."})]})]}),"restricted"===o&&(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>u(!0),className:"border-red-300 text-red-600 hover:bg-red-50 hover:text-red-700",children:"Remove All Rules"})]}),(0,se.jsxs)(Es,{className:"w-full border-muted-foreground/20 shadow-sm",children:[(0,se.jsx)(Ls,{className:"space-y-6 pt-6",children:"public"===o?(0,se.jsx)("div",{className:"p-6 border rounded-lg bg-muted/5 space-y-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-4",children:[(0,se.jsx)("div",{className:"bg-green-50 p-2 rounded-full",children:(0,se.jsx)(bP.A,{className:"h-5 w-5 text-green-600"})}),(0,se.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,se.jsx)("h3",{className:"text-lg font-medium",children:"Public Access"}),(0,se.jsx)("p",{className:"text-muted-foreground",children:"Currently all users can access all records in this entity. There are no access restrictions."})]}),(0,se.jsxs)(zt,{onClick:()=>{c("restricted")},className:"gap-2 whitespace-nowrap",children:[(0,se.jsx)(Vc.A,{className:"h-4 w-4"}),"Create Access Rules"]})]})}):(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)(ji,{value:r,onValueChange:i,className:"w-full",children:[(0,se.jsxs)(yi,{className:"grid grid-cols-4 w-full mb-4",children:[(0,se.jsxs)(Ni,{value:"create",className:"flex items-center gap-2",children:[(0,se.jsx)(BO.A,{className:"h-4 w-4"})," Create"]}),(0,se.jsxs)(Ni,{value:"read",className:"flex items-center gap-2",children:[(0,se.jsx)(lA.A,{className:"h-4 w-4"})," Read"]}),(0,se.jsxs)(Ni,{value:"update",className:"flex items-center gap-2",children:[(0,se.jsx)(zO.A,{className:"h-4 w-4"})," Update"]}),(0,se.jsxs)(Ni,{value:"delete",className:"flex items-center gap-2",children:[(0,se.jsx)(zy.A,{className:"h-4 w-4"})," Delete"]})]}),(0,se.jsxs)(wi,{value:r,className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,se.jsxs)(On,{className:"text-base font-medium flex items-center gap-2",children:[(e=>{switch(e){case"create":return(0,se.jsx)(BO.A,{className:"h-4 w-4 text-green-500"});case"read":return(0,se.jsx)(lA.A,{className:"h-4 w-4 text-blue-500"});case"update":return(0,se.jsx)(zO.A,{className:"h-4 w-4 text-amber-500"});case"delete":return(0,se.jsx)(zy.A,{className:"h-4 w-4 text-red-500"});default:return(0,se.jsx)(HO.A,{className:"h-4 w-4"})}})(r),m(r)," Rules"]}),(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>{const e=x(r);h(r,[...e,{}])},className:"flex items-center gap-1.5 border-primary/30 hover:bg-primary/5",children:[(0,se.jsx)(op.A,{className:"h-3.5 w-3.5"})," Add Rule"]})]}),x(r).map((e,t)=>(0,se.jsx)(YO,{rule:e,onChange:e=>((e,t,s)=>{const a=[...x(e)];a[t]=s,h(e,a)})(r,t,e),onDelete:()=>((e,t)=>{const s=x(e);if(s.length>1){const a=s.filter((e,s)=>s!==t);h(e,a)}})(r,t),canRemove:x(r).length>1,index:t},"".concat(r,"-").concat(t))),(0,se.jsxs)("div",{className:"space-y-2 bg-muted/10 p-4 rounded-lg border",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsxs)(On,{className:"font-medium flex items-center gap-2",children:[(0,se.jsx)(xb.A,{className:"h-4 w-4 text-primary/70"}),"Generated ",m(r)," Rules (JSON)"]}),(0,se.jsx)(gs,{variant:"outline",className:"bg-primary/5 border-primary/20",children:x(r).filter(e=>null!==e).length})]}),(0,se.jsx)(ki,{rows:4,value:n[r]?JSON.stringify(n[r],null,2):"",readOnly:!0,className:"font-mono text-sm bg-muted/30 border-muted-foreground/20"})]})]})]})})}),(0,se.jsx)(Ms,{className:"flex justify-end pt-4 border-t bg-muted/5",children:(0,se.jsxs)(zt,{onClick:()=>{if("public"===o){const e=(0,ue.A)((0,ue.A)({},t),{},{rls:void 0});return void s(e)}const e=(0,ue.A)({},n);e.update&&e.delete&&JSON.stringify(e.update)===JSON.stringify(e.delete)?e.write=e.update:delete e.write;const a=(0,ue.A)((0,ue.A)({},t),{},{rls:e});s(a)},size:"lg",className:"gap-2",children:[(0,se.jsx)(Yc.A,{className:"h-4 w-4"}),"Save Security Rules"]})})]})]})}const KO=e=>{if(!e)return{};const t=(0,ue.A)({},e);return t.write&&(t.update||(t.update=t.write),t.delete||(t.delete=t.write)),t};class $O extends te.H{getBaseURL(){return"/apps"}runSecurityScan(e){return this.axios.post("/".concat(e,"/security/generate-suggestions")).then(e=>e.result||e)}}const ZO=new $O;function JO(e){let{title:t,count:s,subtitle:a,noIssuesSubtitle:n,rightElement:l}=e;const r=s>0,i=r?(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-2 text-red-600",strokeWidth:2}):(0,se.jsx)(sd.A,{className:"h-4 w-4 text-green-500 mr-2",strokeWidth:2});return(0,se.jsxs)("div",{className:"flex flex-col items-start w-full",children:[(0,se.jsxs)("div",{className:"flex items-center w-full",children:[(0,se.jsxs)("span",{className:"flex items-center font-semibold text-sm text-black flex-1",children:[i,t]}),l&&(0,se.jsx)("span",{children:l})]}),(0,se.jsx)("span",{className:"text-sm leading-5 font-normal mt-1 text-black ml-6",children:r?a:n})]})}function QO(e){let{title:t,issues:s=[],subtitle:a,noIssuesSubtitle:n}=e;const[l,r]=(0,Y.useState)(!1),i=s.length>0,o=i?l?(0,se.jsx)(ur.A,{className:"h-5 w-5 text-slate-500"}):(0,se.jsx)(_t.A,{className:"h-5 w-5 text-slate-500"}):null;return(0,se.jsxs)("div",{className:"w-full rounded-lg border border-[#E4E4E7] bg-white shadow-sm",children:[(0,se.jsx)("button",{className:"flex items-center justify-between w-full px-4 py-5 focus:outline-none rounded-lg",onClick:()=>i&&r(e=>!e),"aria-expanded":l,style:{border:"none",background:"transparent",boxShadow:"none"},children:(0,se.jsx)(JO,{title:t,count:s.length,subtitle:a,noIssuesSubtitle:n,rightElement:o})}),l&&i&&(0,se.jsx)("div",{className:"flex flex-col gap-4 mb-[12px] px-4 pb-4",children:s.map((e,t)=>(0,se.jsxs)("div",{className:"flex flex-row items-start w-full rounded-lg border border-[#E4E4E7] bg-white py-3 px-4 gap-x-3 shadow-sm",children:[(0,se.jsx)("div",{className:"flex items-start",children:(0,se.jsx)(ad.A,{className:"h-4 w-4 text-red-700 mt-0.5",strokeWidth:2})}),(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,se.jsx)("div",{className:"text-red-600 text-sm font-medium leading-5 flex items-start gap-2",children:e.description}),(0,se.jsxs)("div",{className:"text-[#71717A] text-sm font-normal leading-5",children:["File: ",e.filePath]})]})]},t))})]})}function XO(){const{app:e,refreshApp:t}=lp(),s=(0,J.zy)(),a=(0,J.Zp)(),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)("list"),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(!1),{toast:m}=ao(),[x,h]=(0,Y.useState)(null),p=e.entities||{},g=Object.keys(p);(0,Y.useEffect)(()=>{t()},[]),(0,Y.useEffect)(()=>{o&&o.rls_recommendations&&h([...o.rls_recommendations])},[o]);const f=(0,Y.useCallback)(async()=>{Tu("Security Scan Started",{app_id:e.id,app_name:e.name}),u(!0),c(null);try{const t=await ZO.runSecurityScan(e.id);c(t.result||t),m({title:"Security scan complete",description:"Review the findings below."})}catch(t){m({title:"Security scan failed",description:t.message,variant:"destructive"})}finally{u(!1)}},[e.id,e.name,m]);(0,Y.useEffect)(()=>{const e=new URLSearchParams(s.search);if("1"===e.get("autoStartScan")&&!d&&!o){f(),e.delete("autoStartScan");const t=e.toString(),n="".concat(s.pathname).concat(t?"?".concat(t):"");a(n,{replace:!0})}},[s.search,f,d,o,a,s.pathname]);const v=()=>{const e=document.getElementById("data-entities-section");e&&e.scrollIntoView({behavior:"smooth",block:"start"})};return"list"===r?(0,se.jsxs)(lL,{title:"App Security",subtitle:"Configure row-level security policies to control who can access your app's data",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between bg-white border border-slate-200 rounded-lg px-6 py-3 mb-6 w-full shadow-sm",children:[(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{className:"font-semibold text-base text-black",children:"Scan issues"}),(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"Scan typically takes few minutes to complete"})]}),(0,se.jsx)(zt,{onClick:f,disabled:d,className:"bg-black hover:bg-slate-800 text-white font-semibold rounded-lg px-4 text-sm flex items-center justify-center",style:{width:175,height:34,minWidth:0},children:d?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"animate-spin h-4 w-4"}),(0,se.jsx)("span",{className:"ml-2",children:"Scanning"})]}):(0,se.jsx)("span",{children:"Start Security Check"})})]}),o?(0,se.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg p-6 mb-8 shadow-sm animate-in fade-in",children:[(0,se.jsx)("div",{className:"font-bold text-2xl text-black mb-6",children:"Scan Results"}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg p-6 shadow-sm",children:(0,se.jsx)(JO,{title:"RLS Recommendations",count:(null==x?void 0:x.length)||0,subtitle:x&&x.length>0?(0,se.jsxs)(se.Fragment,{children:["".concat(x.length," RLS recommendation").concat(x.length>1?"s":""," found, "),(0,se.jsx)("button",{onClick:v,className:"inline text-black font-medium underline ml-1 hover:text-slate-800 transition p-0 bg-transparent border-0 outline-none",style:{fontSize:"inherit",lineHeight:"inherit"},type:"button",children:"View recommendations"})]}):null,noIssuesSubtitle:"No RLS recommendations found",rightElement:null})}),(0,se.jsx)(QO,{title:"Secrets",subtitle:"".concat(o.hardcoded_secrets.length," Exposed secrets found"),noIssuesSubtitle:"No exposed secrets found",issues:(o.hardcoded_secrets||[]).map(e=>({description:e.description,filePath:e.file_path}))}),(0,se.jsx)(QO,{title:"Backend Functions",subtitle:"".concat(o.backend_functions.length," Unauthenticated backend functions found"),noIssuesSubtitle:"No unauthenticated backend functions found",issues:(o.backend_functions||[]).map(e=>({description:e.description,filePath:e.file_path}))})]})]}):null,(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("h2",{id:"data-entities-section",className:"text-xl font-medium flex items-center gap-2",children:[(0,se.jsx)(oy.A,{className:"h-5 w-5 text-primary/70"}),"Data Entities"]}),(0,se.jsxs)(gs,{variant:"outline",className:"bg-primary/5 border-primary/20 px-3 py-1",children:[(0,se.jsx)(eb.A,{className:"h-3.5 w-3.5 mr-1.5"}),g.length," entities"]})]}),(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 w-full mx-auto items-stretch",children:g.map(t=>(0,se.jsx)("div",{className:"h-full flex flex-col",children:(0,se.jsx)(qO,{entity:p[t],scanResult:o,rlsRecs:x,app:e,onSaveRecommendation:s=>(async(t,s)=>{const a=x.filter((e,a)=>e.entity_name===t&&a===s);if(0===a.length)return;const n=a[0];try{const t={create:n.create_rule?JSON.parse(n.create_rule):void 0,read:n.read_rule?JSON.parse(n.read_rule):void 0,update:n.update_rule?JSON.parse(n.update_rule):void 0,delete:n.delete_rule?JSON.parse(n.delete_rule):void 0};await lu.write(e.id,"entities/".concat(n.entity_name),JSON.stringify((0,ue.A)((0,ue.A)({},p[n.entity_name]),{},{rls:t}),null,2)),h(e=>e.filter((e,t)=>t!==s)),m({title:"Rule saved for ".concat(n.entity_name),description:"The recommended rule has been saved.",variant:"success"})}catch(l){m({title:"Failed to save rule",description:l.message,variant:"destructive"})}})(t,s),onClick:()=>(e=>{l(e),i("edit")})(t),clickable:!0},t)}))})]}):(0,se.jsx)("div",{className:"max-w-full py-6 p-4",children:(0,se.jsx)(GO,{entity:p[n],onSave:t=>{lu.write(e.id,"entities/".concat(t.name),JSON.stringify(t,null,2)),i("list")},onBack:()=>{i("list"),l(null)}})})}var eU=s(81872);const tU=e=>{let{secretName:t,appId:s,onUpdate:a}=e;const{toast:n}=Cb(),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),{updateSecrets:p}=lp();return(0,se.jsx)(Es,{children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-500"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"font-medium",children:t}),i?(0,se.jsx)("div",{className:"mt-2 space-y-2",children:(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(nl,{type:x?"text":"password",placeholder:"New secret value",value:c,onChange:e=>d(e.target.value),className:"h-8 w-48 pr-10"}),(0,se.jsx)(zt,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-2 py-1 hover:bg-transparent",onClick:()=>{h(e=>!e)},children:x?(0,se.jsx)(FD.A,{className:"h-3 w-3"}):(0,se.jsx)(lA.A,{className:"h-3 w-3"})})]}),(0,se.jsx)(zt,{size:"sm",onClick:async()=>{if(c){m(!0);try{await p({[t]:c}),n({title:"Secret updated",duration:3e3}),a(),o(!1),d(""),h(!1)}catch(l){var e,s;n({variant:"destructive",title:"Error updating secret",description:(null===(e=l.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Something went wrong",duration:3e3})}m(!1)}},disabled:u||!c,className:"h-8",children:u?(0,se.jsx)(Fx.A,{className:"h-4 w-4 animate-spin"}):"Save"}),(0,se.jsx)(zt,{size:"sm",variant:"outline",onClick:()=>{o(!1),d(""),h(!1)},className:"h-8",children:"Cancel"})]})}):(0,se.jsx)("p",{className:"text-sm text-gray-500",children:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[!i&&(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>{o(!0)},className:"text-blue-500 hover:text-blue-600 hover:bg-blue-50",children:(0,se.jsx)(eU.A,{className:"h-4 w-4"})}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:async()=>{r(!0);try{await iu.deleteSecret(s,t),n({title:"Secret deleted",duration:3e3}),a()}catch(i){var e,l;n({variant:"destructive",title:"Error deleting secret",description:(null===(e=i.response)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.detail)||"Something went wrong",duration:3e3})}r(!1)},className:"text-red-500 hover:text-red-600 hover:bg-red-50",disabled:l,children:(0,se.jsx)(zy.A,{className:"h-4 w-4 ".concat(l?"animate-spin":"")})})]})]})})})},sU=e=>{let{onAdd:t,loading:s}=e;const[a,n]=(0,Y.useState)(""),[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),u=a.includes(" "),m=u;return(0,se.jsxs)(ma,{open:i,onOpenChange:o,children:[(0,se.jsx)(xa,{asChild:!0,children:(0,se.jsxs)(zt,{children:[(0,se.jsx)(op.A,{className:"h-4 w-4 mr-2"}),"Add Secret"]})}),(0,se.jsxs)(fa,{children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:"Add New Secret"}),(0,se.jsx)(ya,{children:"Enter your secret name and value below. Secrets are encrypted and securely stored."})]}),(0,se.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium",children:"Secret Name"}),(0,se.jsx)(nl,{placeholder:"Enter secret name (e.g. API_KEY)",value:a,onChange:e=>n(e.target.value),className:u?"border-red-500":""}),u&&(0,se.jsx)("p",{className:"text-sm text-red-500",children:"Secret name cannot contain spaces. Use underscores instead (e.g. API_KEY)."})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium",children:"Secret Value"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(nl,{type:c?"text":"password",placeholder:"Enter secret value",value:l,onChange:e=>r(e.target.value),className:"pr-10"}),(0,se.jsx)(zt,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>{d(e=>!e)},children:c?(0,se.jsx)(FD.A,{className:"h-4 w-4"}):(0,se.jsx)(lA.A,{className:"h-4 w-4"})})]})]}),(0,se.jsx)("div",{className:"flex justify-end",children:(0,se.jsx)(zt,{onClick:async()=>{m||(await t(a,l),n(""),r(""),d(!1),o(!1))},disabled:s||!a||!l||m,children:s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):"Add Secret"})})]})]})]})},aU=e=>{let{app:t}=e;return(0,se.jsx)(Es,{children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(HO.A,{className:"h-5 w-5 text-blue-500 shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,se.jsx)("p",{className:"font-medium",children:(0,se.jsx)("b",{children:"About Secrets Management"})}),(0,se.jsx)("p",{className:"text-gray-600",children:"Secrets are environment variables that contain sensitive information like API keys, tokens, and passwords. They are encrypted at rest and securely injected into your application at runtime."}),(0,se.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[(0,se.jsx)("li",{children:"Secrets are used by your backend functions to access external services"}),(0,se.jsx)("li",{children:"All secrets are encrypted and stored securely"}),(0,se.jsx)("li",{children:"You can add, update, or delete secrets as needed for your application"})]}),(0,se.jsxs)("p",{className:"text-xs text-gray-500",children:["Need help? Create a ticket at ",(0,se.jsx)("button",{type:"button",onClick:()=>{const e=null!=t&&t.id?"/support?appId=".concat(t.id):"/support";window.open(e,"_blank")},className:"underline text-primary hover:text-orange-500 transition-colors",children:"support system"})]})]})]})})})};function nU(){const{app:e,updateSecrets:t,existingSecretNames:s}=lp(),a=null==e?void 0:e.id,[n,l]=(0,Y.useState)({}),[r,i]=(0,Y.useState)(!1),{toast:o}=Cb(),c=((0,J.Zp)(),async()=>{try{const e=await iu.getSecrets(a);l(e)}catch(s){var e,t;o({variant:"destructive",title:"Error fetching secrets",description:(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Something went wrong",duration:3e3})}});(0,Y.useEffect)(()=>{c()},[a]);return(0,se.jsx)("div",{className:"space-y-6 p-6",children:(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold",children:"Application Secrets"}),(0,se.jsx)(sU,{onAdd:async(e,s)=>{if(e&&s){i(!0);try{await t({[e]:s}),await c(),o({title:"Secret added successfully",duration:3e3})}catch(l){var a,n;o({variant:"destructive",title:"Error creating secret",description:(null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail)||"Something went wrong",duration:3e3})}i(!1)}},loading:r})]}),(0,se.jsxs)("div",{className:"grid gap-6",children:[Object.keys(n).length>0?(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("h3",{className:"text-lg font-semibold text-green-600 flex items-center",children:[(0,se.jsx)(Ab.A,{className:"h-5 w-5 mr-2"}),"Configured Secrets"]}),Object.keys(n).map(e=>(0,se.jsx)(tU,{secretName:e,appId:a,onUpdate:c},e))]}):(0,se.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,se.jsx)("p",{children:"No secrets configured yet. Add your first secret to get started."})}),(0,se.jsx)(aU,{app:e})]})]})})}var lU=s(21449);function rU(e){var t,s,a,n,l,r;let{agent:i,color:o,onEdit:c,onStartChat:d,isSelected:u=!1,agentsSDK:m,onSaveWhatsAppGreeting:x,onToggleWhatsApp:h}=e;const p=(null===(t=i.tool_configs)||void 0===t||null===(s=t.filter(e=>e.entity_name))||void 0===s?void 0:s.length)||0,g=(null===(a=i.tool_configs)||void 0===a||null===(n=a.filter(e=>e.function_name))||void 0===n?void 0:n.length)||0;return(0,se.jsx)("div",{className:de("group relative bg-white transition-all p-4 font-base44","rounded-[12px] border border-gray-100"),children:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:de("h-10 w-10 flex items-center justify-center flex-shrink-0",(null==o?void 0:o.light)||"bg-slate-100"),children:(0,se.jsx)(wP.A,{className:de("h-5 w-5",(null==o?void 0:o.text)||"text-slate-500")})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-900 text-base font-base44",children:i.name}),p>0&&(0,se.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mt-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-slate-600 font-base44",children:[(0,se.jsx)(oy.A,{className:"h-3 w-3"}),(0,se.jsx)("span",{children:"Entities:"})]}),(0,se.jsxs)("div",{className:"flex flex-wrap gap-1",children:[null===(l=i.tool_configs)||void 0===l?void 0:l.filter(e=>e.entity_name).slice(0,3).map((e,t)=>(0,se.jsx)(gs,{variant:"secondary",className:"text-xs px-2 py-0 bg-slate-100 text-slate-600 border-0 font-base44",children:e.entity_name},t)),(null===(r=i.tool_configs)||void 0===r?void 0:r.filter(e=>e.entity_name).length)>3&&(0,se.jsxs)(gs,{variant:"secondary",className:"text-xs px-2 py-0 bg-slate-100 text-slate-600 border-0 font-base44",children:["+",i.tool_configs.filter(e=>e.entity_name).length-3," more"]})]})]})]})]}),(0,se.jsxs)("div",{className:"flex gap-2 ml-3",children:[(0,se.jsx)(zt,{size:"sm",variant:"outline",onClick:e=>{e.stopPropagation(),c(i)},className:"h-8 text-xs font-base44 rounded-[12px] hidden sm:flex",children:"Edit Agent"}),(0,se.jsx)(zt,{size:"sm",variant:"outline",onClick:e=>{e.stopPropagation(),c(i)},className:"h-8 w-8 font-base44 rounded-[12px] sm:hidden flex items-center justify-center",children:"Edit"}),(0,se.jsx)(zt,{size:"sm",onClick:e=>{e.stopPropagation(),d(i)},className:"h-8 text-xs bg-slate-800 hover:bg-slate-900 text-white font-base44 rounded-[8px] hidden sm:flex",children:"Start Chat"}),(0,se.jsx)(zt,{size:"sm",onClick:e=>{e.stopPropagation(),d(i)},className:"h-8 w-8 bg-slate-800 hover:bg-slate-900 text-white font-base44 rounded-[8px] sm:hidden flex items-center justify-center",children:"Chat"})]})]}),g>0&&(0,se.jsxs)("div",{className:"pl-[52px] sm:pl-[52px] pl-0 flex items-center gap-1.5 text-xs text-slate-600 font-base44",children:[(0,se.jsx)(Jv.A,{className:"h-3 w-3"}),(0,se.jsxs)("span",{children:[g," ",1===g?"function":"functions"]})]}),(0,se.jsx)("div",{className:"pl-[52px] sm:pl-[52px] pl-0",children:(0,se.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2 font-base44",children:i.description||"No description provided"})})]})})}function iU(e){try{const t=new Date(e);if(isNaN(t.getTime()))return"Recently";const s=new Date,a=Math.abs(s-t),n=Math.ceil(a/864e5);return 0===n?"Today":1===n?"Yesterday":n<7?"".concat(n," days ago"):n<30?"".concat(Math.floor(n/7)," weeks ago"):n<365?"".concat(Math.floor(n/30)," months ago"):"".concat(Math.floor(n/365)," years ago")}catch(t){return"Recently"}}function oU(e){var t,s,a,n,l;let{conversation:r,agentColor:i,onSelect:o,isSelected:c}=e;const d=null===(t=r.messages)||void 0===t?void 0:t.slice(-1)[0],u=(null===(s=r.messages)||void 0===s?void 0:s.length)||0;return(0,se.jsx)("div",{className:de("group font-base44 relative bg-white rounded-[12px] border transition-all cursor-pointer hover:shadow-sm p-3",c?"border-slate-400 shadow-sm":"border-gray-100 hover:border-slate-300"),onClick:()=>o(r),children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:de("h-8 w-8 rounded-lg flex items-center justify-center flex-shrink-0",(null==i?void 0:i.light)||"bg-slate-100"),children:(0,se.jsx)(wP.A,{className:de("h-4 w-4",(null==i?void 0:i.text)||"text-slate-500")})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-800",children:r.agent_name}),"whatsapp"===(null===(a=r.metadata)||void 0===a?void 0:a.channel)&&(0,se.jsxs)("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-green-50 rounded",children:[(0,se.jsx)(Xx.A,{className:"h-3 w-3 text-green-600"}),(0,se.jsx)("span",{className:"text-xs text-green-700 font-medium",children:"WhatsApp"})]}),(0,se.jsx)(gs,{variant:"outline",className:"text-xs px-1.5 py-0 border-slate-300",children:u})]}),d&&(0,se.jsxs)("p",{className:"text-xs text-slate-500 line-clamp-1",children:[null===(n=d.content)||void 0===n?void 0:n.substring(0,150),"..."]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-400 mt-1",children:[(0,se.jsx)("span",{children:iU(r.created_at)}),(null===(l=r.metadata)||void 0===l?void 0:l.phone_number)&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{children:"\u2022"}),(0,se.jsx)("span",{children:r.metadata.phone_number})]})]})]}),(0,se.jsx)(bs.A,{className:"h-4 w-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})})}const cU=["inline","className","children"],dU=["children"];function uU(e){var t;let{message:s}=e;const a="user"===s.role;return(0,se.jsxs)("div",{className:de("flex gap-3",a?"justify-end":"justify-start"),children:[!a&&(0,se.jsx)("div",{className:"h-7 w-7 rounded-lg bg-slate-100 flex items-center justify-center mt-0.5",children:(0,se.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"})}),(0,se.jsxs)("div",{className:de("max-w-[85%]",a&&"flex flex-col items-end"),children:[s.content&&(0,se.jsx)("div",{className:de("rounded-2xl px-4 py-2.5",a?"bg-slate-800 text-white":"bg-white border border-slate-200"),children:a?(0,se.jsx)("p",{className:"text-sm leading-relaxed",children:s.content}):(0,se.jsx)(db.oz,{className:"text-sm prose prose-sm prose-slate max-w-none [&>*:first-child]:mt-0 [&>*:last-child]:mb-0",components:{code:e=>{let{inline:t,className:s,children:a}=e,n=(0,Nt.A)(e,cU);const l=/language-(\w+)/.exec(s||"");return!t&&l?(0,se.jsxs)("div",{className:"relative group/code",children:[(0,se.jsx)("pre",{className:"bg-slate-900 text-slate-100 rounded-lg p-3 overflow-x-auto my-2",children:(0,se.jsx)("code",(0,ue.A)((0,ue.A)({className:s},n),{},{children:a}))}),(0,se.jsx)(zt,{size:"icon",variant:"ghost",className:"absolute top-2 right-2 h-6 w-6 opacity-0 group-hover/code:opacity-100 bg-slate-800 hover:bg-slate-700",onClick:()=>{navigator.clipboard.writeText(String(a).replace(/\n$/,"")),et.toast.success("Code copied")},children:(0,se.jsx)(ob.A,{className:"h-3 w-3 text-slate-400"})})]}):(0,se.jsx)("code",{className:"px-1 py-0.5 rounded bg-slate-100 text-slate-700 text-xs",children:a})},a:e=>{let{children:t}=e,s=(0,Nt.A)(e,dU);return(0,se.jsx)("a",(0,ue.A)((0,ue.A)({},s),{},{target:"_blank",rel:"noopener noreferrer",children:t}))},p:e=>{let{children:t}=e;return(0,se.jsx)("p",{className:"my-1 leading-relaxed",children:t})},ul:e=>{let{children:t}=e;return(0,se.jsx)("ul",{className:"my-1 ml-4 list-disc",children:t})},ol:e=>{let{children:t}=e;return(0,se.jsx)("ol",{className:"my-1 ml-4 list-decimal",children:t})},li:e=>{let{children:t}=e;return(0,se.jsx)("li",{className:"my-0.5",children:t})},h1:e=>{let{children:t}=e;return(0,se.jsx)("h1",{className:"text-lg font-semibold my-2",children:t})},h2:e=>{let{children:t}=e;return(0,se.jsx)("h2",{className:"text-base font-semibold my-2",children:t})},h3:e=>{let{children:t}=e;return(0,se.jsx)("h3",{className:"text-sm font-semibold my-2",children:t})},blockquote:e=>{let{children:t}=e;return(0,se.jsx)("blockquote",{className:"border-l-2 border-slate-300 pl-3 my-2 text-slate-600",children:t})}},children:s.content})}),(null===(t=s.tool_calls)||void 0===t?void 0:t.length)>0&&(0,se.jsx)("div",{className:"space-y-1",children:s.tool_calls.map((e,t)=>(0,se.jsx)(ET,{toolCall:e},t))})]})]})}function mU(e){let{conversation:t,agentColor:s,agentsSDK:a,onBack:n}=e;const[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),c=(0,Y.useRef)(null),d=(0,Y.useRef)(null),{createChatKeyDownHandler:u}=Up(),m=t.messages||[];(0,Y.useEffect)(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[m]);const x=async()=>{if(!l.trim()||i)return;const e={id:Date.now().toString(),role:"user",content:l.trim()};r(""),o(!0);try{await a.addMessage(t,e)}catch(s){et.toast.error("Failed to send message")}finally{o(!1)}};return(0,se.jsxs)("div",{className:"flex flex-col h-full w-full bg-white font-base44",children:[(0,se.jsx)("div",{className:"border-b bg-white px-6 py-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(zt,{variant:"ghost",size:"icon",onClick:n,className:"h-7 w-7",children:(0,se.jsx)(vs.A,{className:"h-4 w-4"})}),(0,se.jsx)("div",{className:de("h-8 w-8 rounded-lg flex items-center justify-center",(null==s?void 0:s.light)||"bg-slate-100"),children:(0,se.jsx)(wP.A,{className:de("h-4 w-4",(null==s?void 0:s.text)||"text-slate-500")})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"font-semibold text-sm text-slate-900",children:t.agent_name}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Active conversation"})]})]})}),(0,se.jsx)(cr,{className:"flex-1 px-6 py-4",ref:c,children:(0,se.jsxs)("div",{className:"space-y-4",children:[0===m.length?(0,se.jsxs)("div",{className:"text-center py-8",children:[(0,se.jsx)("div",{className:"h-12 w-12 rounded-xl bg-slate-100 flex items-center justify-center mx-auto mb-3",children:(0,se.jsx)(Xx.A,{className:"h-6 w-6 text-slate-400"})}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Start your conversation"}),(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Type a message below to begin"})]}):m.map(e=>e?(0,se.jsx)(uU,{message:e},e.id):null),i&&(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,se.jsx)($r,{className:"h-7 w-7 rounded-lg"})}),(0,se.jsx)("div",{className:"bg-white border border-slate-200 rounded-2xl px-4 py-2.5",children:(0,se.jsx)($r,{className:"h-4 w-32"})})]}),(0,se.jsx)("div",{ref:d})]})}),(0,se.jsx)("div",{className:"border-t bg-white px-6 py-4",children:(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(nl,{value:l,onChange:e=>r(e.target.value),onKeyDown:u({onSend:x,value:l,onValueChange:r}),placeholder:"Type your message...",disabled:i,className:"flex-1 text-sm border-slate-200 focus:border-slate-400"}),(0,se.jsx)(zt,{onClick:x,disabled:i||!l.trim(),size:"sm",className:"bg-slate-800 hover:bg-slate-900 text-white",children:i?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(iy.A,{className:"h-4 w-4"})})]})})]})}const xU=e=>{let{className:t}=e;return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 360 362",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,se.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M307.546 52.5655C273.709 18.685 228.706 0.0171895 180.756 0C81.951 0 1.53846 80.404 1.50408 179.235C1.48689 210.829 9.74646 241.667 25.4319 268.844L0 361.736L95.0236 336.811C121.203 351.096 150.683 358.616 180.679 358.625H180.756C279.544 358.625 359.966 278.212 360 179.381C360.017 131.483 341.392 86.4547 307.546 52.5741V52.5655ZM180.756 328.354H180.696C153.966 328.346 127.744 321.16 104.865 307.589L99.4242 304.358L43.034 319.149L58.0834 264.168L54.5423 258.53C39.6304 234.809 31.749 207.391 31.7662 179.244C31.8006 97.1036 98.6334 30.2707 180.817 30.2707C220.61 30.2879 258.015 45.8015 286.145 73.9665C314.276 102.123 329.755 139.562 329.738 179.364C329.703 261.513 262.871 328.346 180.756 328.346V328.354ZM262.475 216.777C257.997 214.534 235.978 203.704 231.869 202.209C227.761 200.713 224.779 199.966 221.796 204.452C218.814 208.939 210.228 219.029 207.615 222.011C205.002 225.002 202.389 225.372 197.911 223.128C193.434 220.885 179.003 216.158 161.891 200.902C148.578 189.024 139.587 174.362 136.975 169.875C134.362 165.389 136.7 162.965 138.934 160.739C140.945 158.728 143.412 155.505 145.655 152.892C147.899 150.279 148.638 148.406 150.133 145.423C151.629 142.432 150.881 139.82 149.764 137.576C148.646 135.333 139.691 113.287 135.952 104.323C132.316 95.5909 128.621 96.777 125.879 96.6309C123.266 96.5019 120.284 96.4762 117.293 96.4762C114.302 96.4762 109.454 97.5935 105.346 102.08C101.238 106.566 89.6691 117.404 89.6691 139.441C89.6691 161.478 105.716 182.785 107.959 185.776C110.202 188.767 139.544 234.001 184.469 253.408C195.153 258.023 203.498 260.782 210.004 262.845C220.731 266.257 230.494 265.776 238.212 264.624C246.816 263.335 264.71 253.786 268.44 243.326C272.17 232.866 272.17 223.893 271.053 222.028C269.936 220.163 266.945 219.037 262.467 216.794L262.475 216.777Z",fill:"currentColor"})})};function hU(e){let{agent:t,agentColor:s,appId:a,onClose:n,onSave:l,agentsSDK:r}=e;const{app:i,refreshApp:o}=lp(),[c,d]=(0,Y.useState)(t.description||""),[u,m]=(0,Y.useState)(t.instructions||""),[x,h]=(0,Y.useState)(t.tool_configs||[]),[p,g]=(0,Y.useState)(t.whatsapp_greeting||""),[f,v]=(0,Y.useState)(!1),[b,j]=(0,Y.useState)([]),[y,N]=(0,Y.useState)([]),[w,_]=(0,Y.useState)("guidelines");(0,Y.useEffect)(()=>{const e=Object.keys((null==i?void 0:i.entities)||{});j(e);const t=Object.keys((null==i?void 0:i.functions)||{});N(t)},[i]);const k=()=>{const e=x.filter(e=>e.entity_name).map(e=>e.entity_name);return b.filter(t=>!e.includes(t))},C=()=>{const e=x.filter(e=>e.function_name).map(e=>e.function_name);return y.filter(t=>!e.includes(t))},A=()=>x.filter(e=>"entity_name"in e).length<b.length,S=()=>x.filter(e=>"function_name"in e).length<y.length,E=e=>{h(x.filter((t,s)=>s!==e))},T=(e,t)=>{const s=[...x];s[e]=(0,ue.A)((0,ue.A)({},s[e]),t),h(s)},I=["create","read","update","delete"],P=e=>"entity_name"in e;return(0,se.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 md:p-8",children:(0,se.jsxs)("div",{className:"w-full max-w-6xl h-[90vh] md:h-[85vh] bg-white rounded-lg shadow-xl flex flex-col md:flex-row overflow-hidden",children:[(0,se.jsxs)("div",{className:"md:w-64 bg-slate-50 border-b md:border-b-0 md:border-r border-slate-200 p-4 md:p-6",children:[(0,se.jsx)("div",{className:"mb-4 md:mb-8",children:(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,se.jsx)("div",{className:de("h-8 w-8 md:h-10 md:w-10 rounded-lg flex items-center justify-center",(null==s?void 0:s.light)||"bg-slate-100"),children:(0,se.jsx)(wP.A,{className:de("h-4 w-4 md:h-5 md:w-5",(null==s?void 0:s.text)||"text-slate-500")})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-base md:text-lg font-base44 font-semibold text-slate-900 truncate max-w-[150px]",children:t.name}),(0,se.jsx)("p",{className:"text-xs font-base44 text-slate-500",children:"Agent Configuration"})]})]})}),(0,se.jsxs)("nav",{className:"flex md:flex-col space-x-1 md:space-x-0 md:space-y-1",children:[(0,se.jsxs)("button",{onClick:()=>_("guidelines"),className:de("flex-1 md:w-full text-center md:text-left px-3 py-2 rounded-md text-sm font-medium transition-colors","guidelines"===w?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-slate-100"),children:[(0,se.jsx)(xb.A,{className:"inline-block w-4 h-4 mr-0 md:mr-2"}),(0,se.jsx)("span",{className:"block md:inline mt-1 md:mt-0 text-xs md:text-sm",children:"Guidelines"})]}),(0,se.jsxs)("button",{onClick:()=>_("tools"),className:de("flex-1 md:w-full text-center md:text-left px-3 py-2 rounded-md text-sm font-medium transition-colors","tools"===w?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-slate-100"),children:[(0,se.jsx)(rA.A,{className:"inline-block w-4 h-4 mr-0 md:mr-2"}),(0,se.jsx)("span",{className:"block md:inline mt-1 md:mt-0 text-xs md:text-sm",children:"Tools"})]}),(0,se.jsxs)("button",{onClick:()=>_("whatsapp"),className:de("flex-1 md:w-full text-center md:text-left px-3 py-2 rounded-md text-sm font-medium transition-colors","whatsapp"===w?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-slate-100"),children:[(0,se.jsx)(xU,{className:"inline-block w-4 h-4 mr-0 md:mr-2"}),(0,se.jsx)("span",{className:"block md:inline mt-1 md:mt-0 text-xs md:text-sm",children:"WhatsApp"})]})]})]}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,se.jsxs)("div",{className:"px-4 md:px-8 py-4 border-b border-slate-200 flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"text-base md:text-lg font-semibold text-slate-900 truncate",children:"guidelines"===w?"Guidelines":"Tools and Capabilities"}),(0,se.jsx)(zt,{variant:"ghost",size:"icon",onClick:n,className:"h-8 w-8 flex-shrink-0",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})})]}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto px-4 md:px-8 py-4 md:py-6",children:"guidelines"===w?(0,se.jsxs)("div",{className:"space-y-6 max-w-4xl",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"description",className:"text-sm font-base44 font-medium text-slate-700",children:"Description"}),(0,se.jsx)("p",{className:"text-xs font-base44 text-slate-500",children:"This is the system prompt that defines the agent's behavior"}),(0,se.jsx)(ki,{id:"description",value:c,onChange:e=>d(e.target.value),placeholder:"Brief description of what this agent does...",className:"min-h-[120px] resize-none font-mono text-sm"})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"instructions",className:"text-sm font-base44 font-medium text-slate-700",children:"Instructions"}),(0,se.jsx)("p",{className:"text-xs font-base44 text-slate-500",children:"Specific guidelines and rules the agent should follow"}),(0,se.jsx)(ki,{id:"instructions",value:u,onChange:e=>m(e.target.value),placeholder:"Detailed instructions for the agent...",className:"min-h-[200px] resize-none font-mono text-sm"})]})]}):"tools"===w?(0,se.jsx)("div",{className:"space-y-6 max-w-4xl",children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-base44 font-medium text-slate-700",children:"Available Tools"}),(0,se.jsx)("p",{className:"text-xs font-base44 text-slate-500 mt-1",children:"Configure what tools and data this agent can access"})]}),(0,se.jsxs)(yn,{children:[(0,se.jsx)(Nn,{asChild:!0,children:(0,se.jsxs)(zt,{size:"sm",variant:"outline",className:"text-xs w-full sm:w-auto",disabled:!A()&&!S(),children:[(0,se.jsx)(op.A,{className:"h-3.5 w-3.5 mr-1 sm:hidden"}),"Add",(0,se.jsx)(_t.A,{className:"h-3.5 w-3.5 ml-1"})]})}),(0,se.jsxs)(En,{align:"end",className:"w-72",children:[(0,se.jsxs)(Tn,{onClick:()=>{h([...x,{entity_name:"",allowed_operations:[]}])},disabled:!A(),className:"cursor-pointer",children:[(0,se.jsx)(oy.A,{className:"h-4 w-4 mr-2"}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{className:"text-sm font-medium",children:A()?"Add Entity Tool":"All Entity Slots Used"}),(0,se.jsx)("span",{className:"text-xs text-slate-500",children:"Database operations and CRUD access"})]})]}),(0,se.jsxs)(Tn,{onClick:()=>{h([...x,{function_name:"",description:""}])},disabled:!S(),className:"cursor-pointer",children:[(0,se.jsx)(Jv.A,{className:"h-4 w-4 mr-2"}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{className:"text-sm font-medium",children:S()?"Add Backend Function":"All Function Slots Used"}),(0,se.jsx)("span",{className:"text-xs text-slate-500",children:"Custom backend logic and integrations"})]})]})]})]})]}),(0,se.jsx)("div",{className:"space-y-3",children:0===x.length?(0,se.jsxs)("div",{className:"text-center py-12 bg-slate-50 rounded-lg border border-slate-200 border-dashed",children:[(0,se.jsx)(oy.A,{className:"h-8 w-8 text-slate-400 mx-auto mb-3"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"No tools configured"}),(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Add entity tools or backend functions to give the agent capabilities"})]}):x.map((e,t)=>{var s,a,n;return(0,se.jsx)("div",{className:"border rounded-lg p-4 bg-white border-slate-200",children:P(e)?(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(oy.A,{className:"h-4 w-4 text-teal-600"}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Entity Tool"})]}),(0,se.jsx)(zt,{size:"icon",variant:"ghost",onClick:()=>E(t),className:"h-6 w-6 hover:bg-red-50",children:(0,se.jsx)(zy.A,{className:"h-3.5 w-3.5 text-red-500 hover:text-red-600"})})]}),(0,se.jsxs)(br,{value:e.entity_name||"",onValueChange:e=>T(t,{entity_name:e}),children:[(0,se.jsx)(Nr,{className:"w-full",children:(0,se.jsx)(yr,{placeholder:"Select entity"})}),(0,se.jsx)(kr,{children:k().concat(e.entity_name?[e.entity_name]:[]).map(e=>(0,se.jsx)(Ar,{value:e,children:e},e))})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,se.jsx)("p",{className:"text-sm font-base44 font-thin text-black ",children:"Allowed operations"}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:I.map(s=>{var a,n;const l=(null===(a=e.allowed_operations)||void 0===a?void 0:a.includes("read"))||!1,r=("update"===s||"delete"===s)&&!l;return(0,se.jsxs)("label",{className:de("flex items-center gap-1.5 px-2 py-1 rounded-md",r?"cursor-not-allowed opacity-50":"cursor-pointer hover:bg-slate-50"),children:[(0,se.jsx)(Os,{checked:(null===(n=e.allowed_operations)||void 0===n?void 0:n.includes(s))||!1,onCheckedChange:()=>!r&&((e,t)=>{const s=x[e];if(!s.entity_name)return;const a=s.allowed_operations||[];let n;a.includes(t)?(n=a.filter(e=>e!==t),"read"===t&&(n=n.filter(e=>"update"!==e&&"delete"!==e))):n=[...a,t],T(e,{allowed_operations:n})})(t,s),disabled:r,className:"h-3.5 w-3.5"}),(0,se.jsx)("span",{className:de("text-xs font-base44 capitalize",r?"text-slate-400":"text-slate-600"),children:s})]},s)})})]}),(null===(s=e.allowed_operations)||void 0===s?void 0:s.includes("delete"))&&(0,se.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-2",children:[(0,se.jsx)(Ap.A,{className:"h-3.5 w-3.5 text-amber-500 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-xs font-base44 text-slate-600",children:"Careful, deleted data by the agent can't be restored"})]})]})]}):(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Jv.A,{className:"h-4 w-4 text-orange-600"}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Backend Function"})]}),(0,se.jsx)(zt,{size:"icon",variant:"ghost",onClick:()=>E(t),className:"h-6 w-6 hover:bg-red-50",children:(0,se.jsx)(zy.A,{className:"h-3.5 w-3.5 text-red-500 hover:text-red-600"})})]}),(0,se.jsxs)(br,{value:e.function_name||"",onValueChange:s=>{var a;const n=null==i||null===(a=i.functions)||void 0===a?void 0:a[s];T(t,{function_name:s,description:(null==n?void 0:n.description)||e.description||""})},children:[(0,se.jsx)(Nr,{className:"w-full",children:(0,se.jsx)(yr,{placeholder:"Select backend function"})}),(0,se.jsx)(kr,{children:C().concat(e.function_name?[e.function_name]:[]).map(e=>(0,se.jsx)(Ar,{value:e,children:e},e))})]}),e.function_name&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"func-desc-".concat(t),className:"text-xs font-medium text-slate-600",children:"Function Description"}),(0,se.jsx)(ki,{id:"func-desc-".concat(t),value:e.description||"",onChange:e=>T(t,{description:e.target.value}),placeholder:"Describe when and how this function should be used...",className:"min-h-[60px] resize-none text-xs"}),(null==i||null===(a=i.functions)||void 0===a||null===(n=a[e.function_name])||void 0===n?void 0:n.description)&&(0,se.jsxs)("p",{className:"text-xs text-slate-400 italic mt-1",children:["Default: ",i.functions[e.function_name].description]})]})]})},t)})})]})}):(0,se.jsxs)("div",{className:"space-y-6 max-w-4xl",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between pb-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"p-2 bg-green-50 rounded-lg",children:(0,se.jsx)(xU,{className:"w-6 h-6 text-green-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"WhatsApp Integration"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Connect your agent to WhatsApp for seamless communication"})]})]}),(0,se.jsx)(zt,{asChild:!0,className:"flex items-center gap-2.5 bg-green-500 hover:bg-green-600 text-white px-6 py-2.5 rounded-lg font-medium text-sm transition-all hover:shadow-md",children:(0,se.jsxs)("a",{href:r.getWhatsAppConnectURL(t.name),target:"_blank",rel:"noopener noreferrer",children:[(0,se.jsx)(xU,{className:"w-5 h-5"}),(0,se.jsx)("span",{children:"Test Chat"})]})})]}),(0,se.jsx)(Es,{className:"border-slate-200 bg-white",children:(0,se.jsx)(Ls,{className:"p-5",children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-semibold text-slate-900",children:"Add WhatsApp to Your App"}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Enable WhatsApp access for your users with a single command"})]}),(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:"flex-1 flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 group hover:border-slate-300 transition-colors",children:[(0,se.jsxs)("code",{className:"text-sm text-slate-700 font-mono flex-1",children:["Add a WhatsApp button for the ",t.name||"agent"]}),(0,se.jsxs)(zt,{onClick:()=>{const e="Add a WhatsApp button for the ".concat(t.name||"agent");sessionStorage.setItem("pendingChatMessage",e),window.dispatchEvent(new CustomEvent("pendingChatMessage",{detail:{message:e}})),n(),et.toast.success("Command added to chat. Press Enter to send.")},className:"h-auto px-4 py-1.5 rounded-md bg-slate-100 hover:bg-slate-200 text-slate-700 text-xs font-medium transition-all hover:shadow-sm flex items-center gap-2",children:["Send to Chat",(0,se.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]})})]})})}),(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,se.jsx)(Es,{className:"border-slate-200 hover:border-slate-300 transition-colors",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"p-1.5 bg-orange-50 rounded-lg flex-shrink-0",children:(0,se.jsx)("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-900",children:"Full Chat Capabilities"}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"All web chat features work seamlessly in WhatsApp, including tools and data access"})]})]})})}),(0,se.jsx)(Es,{className:"border-slate-200 hover:border-slate-300 transition-colors",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"p-1.5 bg-teal-50 rounded-lg flex-shrink-0",children:(0,se.jsx)("svg",{className:"w-5 h-5 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-900",children:"Voice & Media Support"}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Users can send voice notes and images for natural interaction"})]})]})})}),(0,se.jsx)(Es,{className:"border-slate-200 hover:border-slate-300 transition-colors",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"p-1.5 bg-orange-50 rounded-lg flex-shrink-0",children:(0,se.jsx)("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("h4",{className:"text-sm font-medium text-slate-900",children:["Custom Numbers ",(0,se.jsx)(gs,{variant:"outline",className:"ml-2 text-xs",children:"Coming Soon"})]}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Connect your own WhatsApp Business numbers"})]})]})})}),(0,se.jsx)(Es,{className:"border-slate-200 hover:border-slate-300 transition-colors",children:(0,se.jsx)(Ls,{className:"p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"p-1.5 bg-teal-50 rounded-lg flex-shrink-0",children:(0,se.jsx)("svg",{className:"w-5 h-5 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-900",children:"Easy UI Integration"}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Add WhatsApp button to your app with a simple chat command"})]})]})})})]}),(0,se.jsxs)(Es,{className:"border-slate-200",children:[(0,se.jsx)(Ts,{className:"pb-4",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})}),(0,se.jsx)(Is,{className:"text-base",children:"Welcome Message"})]})}),(0,se.jsxs)(Ls,{className:"space-y-3",children:[(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Craft a warm greeting that introduces your agent and sets expectations"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(ki,{id:"whatsapp-greeting",value:p,onChange:e=>g(e.target.value),placeholder:"Hello! Welcome to ".concat((null==i?void 0:i.name)||"our app"," \u{1f44b}\n\nI'm your AI assistant, here to help you with any questions or tasks.\n\nHow can I assist you today?"),className:"min-h-[120px] resize-none text-sm font-normal pr-12"}),(0,se.jsxs)("div",{className:"absolute top-2 right-2 text-xs text-slate-400",children:[p.length,"/500"]})]})]})]})]})}),(0,se.jsxs)("div",{className:"px-4 md:px-8 py-4 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 bg-slate-50",children:[(0,se.jsx)(zt,{variant:"outline",onClick:n,className:"px-6 order-2 sm:order-1",children:"Cancel"}),(0,se.jsx)(zt,{onClick:async()=>{v(!0);try{const e=x.filter(e=>e.entity_name||e.function_name).map(e=>e.entity_name?{entity_name:e.entity_name,allowed_operations:e.allowed_operations||[]}:{function_name:e.function_name,description:e.description||""});l&&await l((0,ue.A)((0,ue.A)({},t),{},{description:c,instructions:u,tool_configs:e,whatsapp_greeting:p})),n()}catch(e){et.toast.error("Failed to save agent configuration")}finally{v(!1)}},disabled:f,className:"px-6 bg-slate-900 hover:bg-slate-800 text-white order-1 sm:order-2",children:f?"Saving...":"Save"})]})]})]})})}const pU=[{bg:"bg-rose-500",text:"text-rose-500",light:"bg-rose-100"},{bg:"bg-blue-500",text:"text-blue-500",light:"bg-blue-100"},{bg:"bg-emerald-500",text:"text-emerald-500",light:"bg-emerald-100"},{bg:"bg-amber-500",text:"text-amber-500",light:"bg-amber-100"},{bg:"bg-purple-500",text:"text-purple-500",light:"bg-purple-100"},{bg:"bg-teal-500",text:"text-teal-500",light:"bg-teal-100"},{bg:"bg-orange-500",text:"text-orange-500",light:"bg-orange-100"},{bg:"bg-indigo-500",text:"text-indigo-500",light:"bg-indigo-100"},{bg:"bg-pink-500",text:"text-pink-500",light:"bg-pink-100"},{bg:"bg-cyan-500",text:"text-cyan-500",light:"bg-cyan-100"},{bg:"bg-lime-500",text:"text-lime-500",light:"bg-lime-100"},{bg:"bg-violet-500",text:"text-violet-500",light:"bg-violet-100"},{bg:"bg-fuchsia-500",text:"text-fuchsia-500",light:"bg-fuchsia-100"},{bg:"bg-sky-500",text:"text-sky-500",light:"bg-sky-100"},{bg:"bg-yellow-500",text:"text-yellow-500",light:"bg-yellow-100"},{bg:"bg-red-500",text:"text-red-500",light:"bg-red-100"},{bg:"bg-green-500",text:"text-green-500",light:"bg-green-100"},{bg:"bg-slate-500",text:"text-slate-500",light:"bg-slate-100"},{bg:"bg-zinc-500",text:"text-zinc-500",light:"bg-zinc-100"},{bg:"bg-stone-500",text:"text-stone-500",light:"bg-stone-100"}];function gU(e){if(!e)return pU[0];let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;const s=Math.abs(t)%pU.length;return pU[s]}function fU(){const{app:e,runtimeAuthToken:t,writeCodeToFile:s,updateApp:a}=lp(),n=(0,J.Zp)(),l=(0,J.zy)(),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)([]),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)("agents"),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(null),j=Ae(e.id,t,e=>{et.toast.error(e||"An error occurred")}),y=Object.entries(e.agents||{}).map(e=>{let[t,s]=e;return(0,ue.A)((0,ue.A)({},s),{},{key:t,name:t})});(0,Y.useEffect)(()=>{const e=new URLSearchParams(l.search),t=e.get("agent"),s=e.get("conversation"),a=e.get("tab");s?(w(s),p("conversations")):t?(b(t),p("agents")):a&&p(a)},[l.search]),(0,Y.useEffect)(()=>{N()},[]);const N=async()=>{x(!0);try{const e=await j.getConversations();c(e||[])}catch(e){et.toast.error("Failed to load conversations")}finally{x(!1)}},w=async e=>{try{const t=await j.getConversation(e);u(t),p("conversations")}catch(t){et.toast.error("Failed to load conversation")}},_=e=>{const t=new URLSearchParams(l.search);t.delete("agent"),t.delete("conversation"),t.delete("tab"),Object.entries(e).forEach(e=>{let[s,a]=e;a&&t.set(s,a)});const s=t.toString(),a=l.pathname+(s?"?".concat(s):"");n(a,{replace:!0})},k=async e=>{f(!0);try{const t=await j.createConversation({agent_name:e.name});c(e=>[t,...e]),u(t),p("conversations"),_({conversation:t.id,tab:"conversations"}),et.toast.success("Conversation started")}catch(t){et.toast.error("Failed to start conversation")}finally{f(!1)}},C=async e=>{try{const t=await j.getConversation(e.id);u(t),_({conversation:e.id,tab:"conversations"})}catch(t){et.toast.error("Failed to load conversation")}},A=e=>{i(e.name),_({agent:e.name,tab:"agents"})};(0,Y.useEffect)(()=>{let e=null;if(d)return e=j.subscribeToConversation(d.id,e=>{u(t=>(0,ue.A)((0,ue.A)({},t),{},{messages:e.messages}))}),()=>{e&&e()}},[null==d?void 0:d.id]);const S=async()=>{try{await a({agents_enabled:!0}),et.toast.success("AI agents enabled successfully")}catch(e){et.toast.error("Failed to enable AI agents")}};return e.agents_enabled&&0!==y.length?d?(0,se.jsx)("div",{className:"h-full p-4 bg-slate-50",children:(0,se.jsx)(mU,{conversation:d,agentColor:gU(d.agent_name),agentsSDK:j,onBack:()=>{u(null),N(),_({tab:"conversations"})}})}):(0,se.jsxs)(lL,{title:"AI Agents",subtitle:"Manage agents and conversations",children:[(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===y.length?(0,se.jsx)("div",{className:"h-full flex items-center pt-16",children:(0,se.jsx)(Es,{className:"max-w-md w-full border-dashed mx-auto",children:(0,se.jsxs)(Ls,{className:"flex flex-col items-center justify-center py-8",children:[(0,se.jsx)("div",{className:"h-16 w-16 rounded-2xl bg-gradient-to-br from-teal-100 to-slate-100 flex items-center justify-center mb-4",children:(0,se.jsx)(wP.A,{className:"h-8 w-8 text-teal-600"})}),(0,se.jsx)("h3",{className:"text-base font-semibold text-slate-700 mb-2",children:"No Agents Yet"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 text-center",children:"Prompt the chat to create your first AI agent"})]})})}):(0,se.jsxs)(ji,{value:h,onValueChange:e=>{p(e),_({tab:e})},className:"h-full flex flex-col",children:[(0,se.jsxs)(yi,{className:"flex w-fit items-center justify-center gap-0.5 px-1 py-0 rounded-lg bg-gradient-to-r from-slate-200 to-slate-200 shadow-inner",children:[(0,se.jsx)(Ni,{value:"agents",className:"text-sm font-base44 px-3 py-1 rounded-md transition-all duration-200 hover:bg-white/50 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-slate-900",children:"Agents"}),(0,se.jsxs)(Ni,{value:"conversations",className:"text-sm font-base44 px-4 py-1 rounded-md transition-all duration-200 hover:bg-white/50 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-slate-900 flex items-center",children:["Conversations",o.filter(e=>e.messages&&e.messages.length>0).length>0&&(0,se.jsx)(gs,{variant:"secondary",className:"ml-1.5 px-1.5 py-0.5 text-xs bg-white border-0",children:o.filter(e=>e.messages&&e.messages.length>0).length})]})]}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,se.jsx)(wi,{value:"agents",className:"mt-4 h-full",children:g?(0,se.jsx)("div",{className:"grid grid-cols-1 gap-3 max-w-4xl",children:[...Array(3)].map((e,t)=>(0,se.jsxs)("div",{className:"bg-white border border-gray-100 rounded-[12px] p-4",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,se.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,se.jsx)($r,{className:"h-10 w-10 rounded-lg"}),(0,se.jsx)($r,{className:"h-6 w-32"})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)($r,{className:"h-8 w-16"}),(0,se.jsx)($r,{className:"h-8 w-16"})]})]}),(0,se.jsxs)("div",{className:"pl-[52px]",children:[(0,se.jsx)($r,{className:"h-4 w-24 mb-2"}),(0,se.jsxs)("div",{className:"flex gap-1 mb-2",children:[(0,se.jsx)($r,{className:"h-5 w-16"}),(0,se.jsx)($r,{className:"h-5 w-20"})]}),(0,se.jsx)($r,{className:"h-4 w-full"}),(0,se.jsx)($r,{className:"h-4 w-3/4 mt-1"})]})]},t))}):(0,se.jsx)("div",{className:"grid grid-cols-1 gap-3 max-w-4xl",children:y.map((t,a)=>(0,se.jsx)("div",{onClick:()=>(e=>{b(e.name),_({agent:e.name,tab:"agents"})})(t),className:"cursor-pointer",children:(0,se.jsx)(rU,{agent:t,color:gU(t.name),onEdit:A,onStartChat:k,isSelected:v===t.name,agentsSDK:j,onSaveWhatsAppGreeting:a=>(async(t,a)=>{const n=e.agents[t];if(!n)return;const l=(0,ue.A)((0,ue.A)({},n),{},{whatsapp_greeting:a});await s("agents/"+t,JSON.stringify(l,null,2))})(t.name,a),onToggleWhatsApp:(a,n)=>async function(t,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const l=e.agents[t];if(!l)return;const r=(0,ue.A)((0,ue.A)({},l),{},{whatsapp_enabled:a});a&&n&&(r.whatsapp_greeting=n),await s("agents/"+t,JSON.stringify(r,null,2))}(t.name,a,n)})},t.key))})}),(0,se.jsx)(wi,{value:"conversations",className:"mt-4 h-full",children:m?(0,se.jsx)("div",{className:"grid grid-cols-1 gap-2 max-w-4xl",children:[...Array(4)].map((e,t)=>(0,se.jsx)("div",{className:"bg-white border border-gray-100 rounded-lg p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)($r,{className:"h-8 w-8 rounded-lg"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)($r,{className:"h-5 w-32 mb-1"}),(0,se.jsx)($r,{className:"h-4 w-48 mb-2"}),(0,se.jsx)($r,{className:"h-3 w-20"})]})]})},t))}):0===o.length?(0,se.jsx)(Es,{className:"border-dashed max-w-4xl",children:(0,se.jsxs)(Ls,{className:"py-8 text-center",children:[(0,se.jsx)(lU.A,{className:"h-10 w-10 text-slate-300 mx-auto mb-3"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"No conversations yet"}),(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Go to the Agents tab to start a conversation"})]})}):(0,se.jsx)("div",{className:"grid grid-cols-1 gap-2 max-w-4xl",children:o.filter(e=>e.messages&&e.messages.length>0).map(e=>(0,se.jsx)(oU,{conversation:e,agentColor:gU(e.agent_name),onSelect:C,isSelected:(null==d?void 0:d.id)===e.id},e.id))})})]})]})}),r&&(0,se.jsx)(hU,{agent:e.agents[r],agentColor:gU(r),appId:e.id,onClose:()=>{i(null),_({tab:"agents"})},onSave:async e=>{const t={description:e.description,instructions:e.instructions,tool_configs:e.tool_configs,whatsapp_greeting:e.whatsapp_greeting};await s("agents/"+r,JSON.stringify(t,null,2)),i(null),_({agent:r,tab:"agents"})},agentsSDK:j})]}):(0,se.jsx)("div",{className:"h-full bg-slate-50 flex flex-col items-center p-8",children:(0,se.jsxs)("div",{className:"flex-1 flex flex-col items-center pt-16 overflow-y-auto",children:[(0,se.jsx)("div",{className:"text-center mb-8",children:(0,se.jsx)("h1",{className:"text-3xl font-base44 text-slate-700",children:"Set up Agents"})}),(0,se.jsx)("div",{className:"w-full max-w-3xl",children:(0,se.jsx)("div",{className:"relative flex items-center justify-center",children:(0,se.jsx)("div",{className:"w-full max-w-2xl",children:(0,se.jsxs)("div",{className:"space-y-16",children:[(0,se.jsx)("div",{className:"relative ".concat(e.agents_enabled?"opacity-60":""),children:(0,se.jsxs)("div",{className:"flex items-start gap-6",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-200 text-black rounded-full flex items-center justify-center text-sm font-base44 relative z-10",children:e.agents_enabled?"\u2713":"1"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"text-xl font-base44 mb-1 ".concat(e.agents_enabled?"text-slate-600":"text-slate-900"),children:"Enable Agents"}),(0,se.jsx)("p",{className:"text-base font-base44 mb-6 ".concat(e.agents_enabled?"text-slate-500":"text-slate-600"),children:"Turn on the toggle to allow agent creation"}),(0,se.jsx)("div",{className:"bg-white rounded-[16px] p-6 border border-slate-200 font-base44",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-sm font-base44 text-slate-900",children:"AI Agents"}),(0,se.jsx)(gs,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700 border-0 font-base44 font-thin",children:"Beta"})]}),(0,se.jsx)("p",{className:"text-xs font-base44 text-slate-600 mt-1",children:"Build AI agents into your app using Base44's AI agents infrastructure"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-xs font-base44 text-slate-500",children:"Enabled"}),(0,se.jsx)("button",{onClick:e.agents_enabled?void 0:S,disabled:e.agents_enabled,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ".concat(e.agents_enabled?"bg-teal-600 focus:ring-teal-500 cursor-default":"bg-slate-300 focus:ring-slate-400 cursor-pointer hover:bg-slate-400"),children:(0,se.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(e.agents_enabled?"translate-x-6":"translate-x-1")})})]})]})})]})]})}),(0,se.jsx)("div",{className:"relative ".concat(e.agents_enabled?"":"opacity-50"),children:(0,se.jsxs)("div",{className:"flex items-start gap-6",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-base44 relative z-10 ".concat(e.agents_enabled?"bg-slate-600 text-white":"bg-slate-300 text-slate-500"),children:"2"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"text-xl font-base44 mb-1 ".concat(e.agents_enabled?"text-slate-900":"text-slate-500"),children:"Add your first Agent"}),(0,se.jsx)(VR,{sourceCodeState:"managed",children:(0,se.jsx)("p",{className:"text-base font-base44 ".concat(e.agents_enabled?"text-gray-500":"text-slate-500"),children:"Ask the chat to create an agent for you. Describe what role the agent should have and what tasks it should perform."})}),(0,se.jsxs)(VR,{sourceCodeState:"unmanaged",children:[(0,se.jsx)("p",{className:"text-base font-base44 ".concat(e.agents_enabled?"text-gray-500":"text-slate-500"),children:"Define your agents in local configuration files and sync them with your app using the Base44 CLI."}),(0,se.jsxs)("a",{href:"https://docs.base44.com/developers/references/cli/agents-config",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 text-sm text-teal-600 hover:text-teal-700 mt-2",children:["View documentation",(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5"})]})]})]})]})})]})})})})]})})}const vU=()=>{const[e,t]=(0,Y.useState)({open:!1,data:null}),s=(0,Y.useCallback)(e=>{t({open:!0,data:e})},[]),a=(0,Y.useCallback)(()=>{t({open:!1,data:null})},[]);return{isOpen:e.open,data:e.data,open:s,close:a}},bU=(0,Y.memo)(e=>{let{item:t,propertyKeys:s,isSelected:a,onToggleSelection:n,onRestore:l,onDelete:r,formatDate:i}=e;return(0,se.jsxs)(vD,{className:"hover:bg-muted/50",children:[(0,se.jsx)(jD,{onClick:e=>e.stopPropagation(),children:(0,se.jsx)(E_,{checked:a,onCheckedChange:()=>n(t.id)})}),s.map(e=>{var s;return(0,se.jsx)(jD,{className:"text-xs whitespace-nowrap overflow-hidden text-ellipsis",style:{maxWidth:"200px"},children:"object"==typeof t[e]?JSON.stringify(t[e]):String(null!==(s=t[e])&&void 0!==s?s:"")},e)}),(0,se.jsx)(jD,{className:"text-xs whitespace-nowrap",children:i(t.deleted_date)}),(0,se.jsx)(jD,{className:"whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex gap-1",children:[(0,se.jsx)(Bx,{size:"tiny",variant:"ghost",onClick:e=>{e.stopPropagation(),l(t)},className:"text-slate-700 hover:text-slate-900 hover:bg-slate-100",children:(0,se.jsx)(Yb.A,{className:"h-3 w-3"})}),(0,se.jsx)(Bx,{size:"tiny",variant:"ghost",onClick:e=>{e.stopPropagation(),r(t)},className:"text-red-500 hover:text-red-600",children:(0,se.jsx)(zy.A,{className:"h-3 w-3"})})]})})]})});bU.displayName="TrashTableRow";const jU=e=>{let{entity:t,entities:s,propertyKeys:a,selectedItems:n,isLoading:l,error:r,onToggleSelection:i,onToggleAllSelection:o,onRestore:c,onDelete:d,formatDate:u,onRetry:m}=e;return(0,se.jsx)("div",{className:"border rounded-md",children:(0,se.jsx)("div",{className:"h-[600px] w-full overflow-auto",children:(0,se.jsxs)(pD,{className:"min-w-full",children:[(0,se.jsx)(gD,{className:"sticky top-0 bg-background z-10",children:(0,se.jsxs)(vD,{children:[(0,se.jsx)(bD,{className:"w-12",children:(0,se.jsx)(E_,{checked:s.length>0&&n.size===s.length,onCheckedChange:o})}),a.map(e=>{var s;return(0,se.jsx)(bD,{className:"text-xs whitespace-nowrap",children:(null===(s=t.properties[e])||void 0===s?void 0:s.title)||e},e)}),(0,se.jsx)(bD,{className:"text-xs whitespace-nowrap",children:"Deleted Date"}),(0,se.jsx)(bD,{className:"text-xs",children:"Actions"})]})}),(0,se.jsx)(fD,{children:r?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:a.length+3,className:"text-center py-8",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,se.jsx)("p",{className:"text-sm text-red-600",children:"Failed to load deleted records"}),m&&(0,se.jsx)("button",{onClick:m,className:"text-sm text-orange-600 hover:text-orange-700 underline",children:"Try Again"})]})})}):l?(0,se.jsx)(vD,{children:(0,se.jsxs)(jD,{colSpan:a.length+3,className:"text-center py-4",children:[(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin mx-auto"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Loading deleted records..."})]})}):0===s.length?(0,se.jsx)(vD,{children:(0,se.jsxs)(jD,{colSpan:a.length+3,className:"text-center py-8",children:[(0,se.jsx)(zy.A,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"No deleted records found"})]})}):s.map(e=>(0,se.jsx)(bU,{item:e,propertyKeys:a,isSelected:n.has(e.id),onToggleSelection:i,onRestore:c,onDelete:d,formatDate:u},e.id))})]})})})},yU=e=>{let{currentPage:t,hasMore:s,isLoading:a,selectedCount:n,onPageChange:l}=e;return(0,se.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[(0,se.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",t,n>0&&" \u2022 ".concat(n," selected")]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsxs)(Bx,{size:"sm",variant:"outline",onClick:()=>l(t-1),disabled:1===t||a,children:[(0,se.jsx)(vs.A,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,se.jsxs)(Bx,{size:"sm",variant:"outline",onClick:()=>l(t+1),disabled:!s||a,children:["Next",(0,se.jsx)(bs.A,{className:"h-4 w-4 ml-1"})]})]})]})},NU=e=>{let{selectedCount:t,totalCount:s,isRestoring:a,onBulkRestore:n,onRestoreAll:l}=e;return t>0?(0,se.jsx)(Bx,{size:"sm",onClick:n,disabled:a,className:"bg-orange-600 hover:bg-orange-700 text-white",children:a?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Restoring..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Yb.A,{className:"h-4 w-4 mr-2"}),"Restore ",t," Selected"]})}):s>0?(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:l,disabled:a,children:a?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Restoring..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Yb.A,{className:"h-4 w-4 mr-2"}),"Restore All"]})}):null},wU=e=>{var t;let{entity:s}=e;const{getEntitiesSDK:a,app:n,dataEnv:l}=lp(),{toast:r}=ao(),i=(0,J.Zp)(),o=a(),{entities:c,hasMore:d,isLoading:u,error:m,loadEntities:x,selectedItems:h,setSelectedItems:p,currentPage:g,setCurrentPage:f,propertyKeys:v}=(e=>{const{getEntitiesSDK:t,dataEnv:s}=lp(),[a,n]=(0,Y.useState)(new Set),[l,r]=(0,Y.useState)(1),i=t(),{data:{entities:o=[],hasMore:c=!1}={},isLoading:d,error:u,refetch:m}=Xd({query:async()=>{const t=50*(l-1),s=await i[e.name].listDeleted({},51,t);return{entities:s.slice(0,50),hasMore:s.length>50}},toastError:"Failed to load deleted records"},[e.name,l,s]);(0,Y.useEffect)(()=>{r(1),n(new Set)},[e]);const x=(0,Y.useMemo)(()=>Object.keys(e.properties||{}),[e.properties]);return{entities:o,hasMore:c,isLoading:d,error:u,loadEntities:m,selectedItems:a,setSelectedItems:n,currentPage:l,setCurrentPage:r,propertyKeys:x}})(s),b=vU(),j=vU(),y=vU(),N=(e=>{let{entity:t,loadEntities:s,setSelectedItems:a}=e;const{getEntitiesSDK:n}=lp(),{toast:l}=ao(),[r,i]=(0,Y.useState)(!1),o=n();return{handleRestoreItem:(0,Y.useCallback)(async e=>{try{await o[t.name].restore(e.id),a(t=>{const s=new Set(t);return s.delete(e.id),s}),await s(),l({title:"Success",description:"Record restored successfully"})}catch(m){var n,r;l({title:"Error",description:(null===(n=m.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||m.message,variant:"destructive"})}},[o,t.name,s,a,l]),handleBulkRestore:(0,Y.useCallback)(async e=>{if(0!==e.length){i(!0);try{await o[t.name].restoreMany({id:{$in:e}}),l({title:"Success",description:"".concat(e.length," record(s) restored")}),a(new Set),await s()}catch(m){var n,r;l({title:"Error",description:(null===(n=m.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||m.message,variant:"destructive"})}finally{i(!1)}}},[o,t.name,s,a,l]),handleRestoreAll:(0,Y.useCallback)(async()=>{i(!0);try{await o[t.name].restoreMany({}),l({title:"Success",description:"All records restored successfully"}),a(new Set),await s()}catch(m){var e,n;l({title:"Error",description:(null===(e=m.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||m.message,variant:"destructive"})}finally{i(!1)}},[o,t.name,s,a,l]),toggleItemSelection:(0,Y.useCallback)((e,t)=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s},[]),toggleAllSelection:(0,Y.useCallback)((e,t)=>t.size===e.length?new Set:new Set(e.map(e=>e.id)),[]),formatDate:(0,Y.useCallback)(e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString()}catch(t){return e}},[]),isRestoring:r}})({entity:s,loadEntities:x,setSelectedItems:p}),w=(0,Y.useCallback)(e=>{b.open(e)},[b]),_=(0,Y.useCallback)(async()=>{if(b.data)try{await o[s.name].deletePermanently(b.data.id),r({title:"Success",description:"Record permanently deleted"}),b.close(),await x()}catch(m){var e,t;r({title:"Error",description:(null===(e=m.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||m.message,variant:"destructive"})}},[b,o,s.name,x,r]),k=(0,Y.useCallback)(()=>{h.size>0&&j.open(Array.from(h))},[h,j]),C=(0,Y.useCallback)(async()=>{j.data&&(await N.handleBulkRestore(j.data),j.close())},[j,N]),A=(0,Y.useCallback)(()=>{y.open()},[y]),S=(0,Y.useCallback)(async()=>{await N.handleRestoreAll(),EC("".concat(s.name,"-").concat(l)),y.close()},[N,y,s.name,l]),E=(0,Y.useCallback)(e=>{p(t=>N.toggleItemSelection(e,t))},[N,p]),T=(0,Y.useCallback)(()=>{p(e=>N.toggleAllSelection(c,e))},[N,c,p]),I=(0,Y.useCallback)(()=>{i("/apps/".concat(n.id,"/editor/workspace/entity-").concat(s.name))},[i,n.id,s.name]);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(lL,{prefix:(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:I,className:"hover:bg-muted/50",children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4 mr-2"})," Back"]}),title:(0,se.jsxs)("span",{className:"flex items-center gap-2",children:[s.title||s.name,": Trash",(null==n?void 0:n.dev_environment_enabled)&&(0,se.jsxs)("span",{className:"dev"===l?"text-xs text-slate-500":"text-sm font-medium text-slate-500",children:["(","dev"===l?"Test":"Production",")"]})]}),subtitle:(0,se.jsxs)(se.Fragment,{children:["View, restore or permanently delete items.",(0,se.jsx)("br",{}),"Items are permanently deleted after 30 days."]}),primaryAction:(0,se.jsx)(NU,{selectedCount:h.size,totalCount:c.length,isRestoring:N.isRestoring,onBulkRestore:k,onRestoreAll:A}),children:[(0,se.jsx)(jU,{entity:s,entities:c,propertyKeys:v,selectedItems:h,isLoading:u,error:m,onToggleSelection:E,onToggleAllSelection:T,onRestore:N.handleRestoreItem,onDelete:w,formatDate:N.formatDate,onRetry:x}),(0,se.jsx)(yU,{currentPage:g,hasMore:d,isLoading:u,selectedCount:h.size,onPageChange:f})]}),(0,se.jsx)(fk,{open:b.isOpen,onOpenChange:e=>!e&&b.close(),title:"Permanently Delete Record",description:"Are you sure you want to permanently delete this record? This action cannot be undone.",confirmText:"Delete Permanently",variant:"destructive",onConfirm:_}),(0,se.jsx)(fk,{open:j.isOpen,onOpenChange:e=>!e&&j.close(),title:"Restore Selected Records",description:"Are you sure you want to restore ".concat((null===(t=j.data)||void 0===t?void 0:t.length)||0," selected record(s)?"),confirmText:"Restore",onConfirm:C}),(0,se.jsx)(fk,{open:y.isOpen,onOpenChange:e=>!e&&y.close(),title:"Restore All Records",description:"Are you sure you want to restore all records in the trash?",confirmText:"Restore All",onConfirm:S})]})};class _U extends te.H{getBaseURL(){return"/apps"}getAutomationPath(e){return"/".concat(e,"/automations/").concat(this.automationType)}listAutomations(e){return this.axios.get(this.getAutomationPath(e))}getAutomation(e,t){return this.axios.get("".concat(this.getAutomationPath(e),"/").concat(t))}createAutomation(e,t){return this.axios.post(this.getAutomationPath(e),t)}updateAutomation(e,t,s){return this.axios.put("".concat(this.getAutomationPath(e),"/").concat(t),s)}deleteAutomation(e,t){return this.axios.delete("".concat(this.getAutomationPath(e),"/").concat(t))}toggleAutomation(e,t){return this.axios.post("".concat(this.getAutomationPath(e),"/").concat(t,"/toggle"))}archiveAutomation(e,t){return this.axios.post("".concat(this.getAutomationPath(e),"/").concat(t,"/archive"))}getAutomationLogs(e,t,s){return this.axios.get("".concat(this.getAutomationPath(e),"/").concat(t,"/logs"),{params:s})}getResolveWithAIContext(e,t){return this.axios.get("".concat(this.getAutomationPath(e),"/").concat(t,"/resolve-with-ai-context"))}}const kU=new class extends _U{get automationType(){return"scheduled"}runAutomationNow(e,t){return this.axios.post("".concat(this.getAutomationPath(e),"/").concat(t,"/run"))}};const CU=new class extends _U{get automationType(){return"entity"}runAutomationNow(e,t,s){return this.axios.post("".concat(this.getAutomationPath(e),"/").concat(t,"/run"),s)}};class AU extends te.H{getBaseURL(){return"/apps"}async listAllAutomations(e){const t=await this.axios.get("/".concat(e,"/automations"));return t.sort((e,t)=>new Date(t.created_date).getTime()-new Date(e.created_date).getTime()),t}}const SU=new AU;async function EU(e){return SU.listAllAutomations(e)}function TU(e){return"scheduled"===e.automation_type}function IU(e){return"entity"===e.automation_type}function PU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{name:e.name+t,description:e.description||"",function_name:e.function_name,function_args:e.function_args,is_active:!!s||e.is_active}}function LU(e){const t=[],s=dc().escape(e.name),a=dc().escape(e.function_name),n="scheduled"===e.automation_type?"scheduled automation":"data automation";if(t.push("The ".concat(n,' "').concat(s,'" has been failing.')),e.description){const s=dc().escape(e.description);t.push("Automation description: ".concat(s))}return e.entity_name&&e.event_type&&t.push("Entity: ".concat(dc().escape(e.entity_name)," (on ").concat(e.event_type,")")),t.push("Function: ".concat(a)),t.push(""),e.failed_executions.length>0&&(t.push("Recent failed executions:"),e.failed_executions.forEach((e,s)=>{const a=e.timestamp?new Date(e.timestamp).toLocaleString():"Unknown time",n=(l=e.execution_logs)&&0!==l.length?l.map(e=>{var t;const s=(null===(t=e.level)||void 0===t?void 0:t.toUpperCase())||"LOG",a=e.time||e.timestamp;let n="";if(a)try{const e=new Date(a);isNaN(e.getTime())||(n=e.toISOString().slice(11,19)+"Z")}catch(i){}const l="string"==typeof e.message?e.message:JSON.stringify(e.message||e),r=n?"".concat(n," "):"";return"[".concat(r).concat(s,"] ").concat(l)}).join("\n"):"";var l;const r=dc().escape("Execution ".concat(s+1," failed at ").concat(a)),i=n?"".concat(e.error_message,"\n\nFunction logs:\n").concat(n):e.error_message;t.push('<error title="'.concat(r,'">').concat(i,"</error>"))}),t.push("")),t.push('Please read the backend function "'.concat(a,'" and help me fix these errors in the ').concat(n,".")),t.join("\n")}const MU=[{value:0,label:"S",fullLabel:"Sunday"},{value:1,label:"M",fullLabel:"Monday"},{value:2,label:"T",fullLabel:"Tuesday"},{value:3,label:"W",fullLabel:"Wednesday"},{value:4,label:"T",fullLabel:"Thursday"},{value:5,label:"F",fullLabel:"Friday"},{value:6,label:"S",fullLabel:"Saturday"}],RU=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function DU(e){return/Z$|[+-]\d{2}:\d{2}$/.test(e)?e:e+"Z"}function FU(e,t){return 1===e?"Every ".concat(t):"Every ".concat(e," ").concat(t,"s")}function OU(e){const[t,s]=e.split(":");let a=parseInt(t,10)||0;const n=s||"00",l=a>=12?"PM":"AM";return a%=12,a=a||12,"".concat(a,":").concat(n," ").concat(l)}function UU(e){const t=new Date(DU(e)),s=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),n=t.getFullYear();let l=t.getHours();const r=String(t.getMinutes()).padStart(2,"0"),i=l>=12?"PM":"AM";l%=12,l=l||12;const o=String(l).padStart(2,"0");return"".concat(s,"/").concat(a,"/").concat(n," ").concat(o,":").concat(r," ").concat(i)}function BU(e){if(e<1e3)return"".concat(e,"ms");if(e<6e4){const t=e/1e3;return"".concat(t%1==0?t:t.toFixed(1),"s")}const t=Math.floor(e/6e4),s=Math.round(e%6e4/1e3);return"".concat(t,"m ").concat(s,"s")}function zU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"00:00";if(!e)return"";const[s,a,n]=e.split("-").map(Number),[l,r]=t.split(":").map(Number);return new Date(s,a-1,n,l||0,r||0,0).toISOString()}function HU(e){return e?/^\d{4}-\d{2}-\d{2}$/.test(e)?e:function(e){if(!e)return"";const t=new Date(DU(e));if(isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(n)}(e):""}function VU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"09:00";return e&&(e.includes("T")||e.includes(" "))?function(e){if(!e)return"";const t=new Date(DU(e));if(isNaN(t.getTime()))return"";const s=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0");return"".concat(s,":").concat(a)}(e):t}function WU(e){if(!e)return"";const[t,s]=e.split(":").map(Number),a=new Date,n=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),t,s,0)),l=String(n.getHours()).padStart(2,"0"),r=String(n.getMinutes()).padStart(2,"0");return"".concat(l,":").concat(r)}function qU(e){return e>1?-1:e<-1?1:e}function YU(e,t,s){if(!e||0===e.length||!t)return e;const[a,n]=t.split(":").map(Number),l=new Date,r="toUtc"===s?new Date(l.getFullYear(),l.getMonth(),l.getDate(),a,n,0):new Date(Date.UTC(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate(),a,n,0)),i=r.getDay(),o=r.getUTCDay(),c=qU("toUtc"===s?o-i:i-o);return 0===c?e:e.map(e=>{return((e+c)%(t=7)+t)%t;var t}).sort((e,t)=>e-t)}function GU(e,t){return YU(e,t,"fromUtc")}function KU(e,t){if(!e)return 0;const[s,a]=e.split(":").map(Number),n=new Date,l="toUtc"===t?new Date(n.getFullYear(),n.getMonth(),n.getDate(),s,a,0):new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),s,a,0)),r=l.getDate(),i=l.getUTCDate();return qU("toUtc"===t?i-r:r-i)}function $U(e,t,s){if(!e||!t)return"toUtc"===s?e||1:e;const a=KU(t,s);if(0===a)return e;const n=e+a;return n<1?"toUtc"===s?28:31:n>31?1:n}function ZU(e,t){return $U(e,t,"fromUtc")}function JU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=PU(e,t,t.length>0),a=HU(e.one_time_date),n=VU(e.one_time_date,"09:00"),l=HU(e.ends_on_date),r="recurring"===e.schedule_mode&&e.start_time?WU(e.start_time):"one-time"===e.schedule_mode?n:"09:00",i=e.repeat_on_days&&e.start_time?GU(e.repeat_on_days,e.start_time):e.repeat_on_days||[],o=e.repeat_on_day_of_month&&e.start_time?ZU(e.repeat_on_day_of_month,e.start_time):e.repeat_on_day_of_month||1;return(0,ue.A)((0,ue.A)({},s),{},{schedule_mode:e.schedule_mode||"recurring",one_time_date:a,schedule_type:e.schedule_type,repeat_interval:e.repeat_interval||1,repeat_unit:e.repeat_unit||"weeks",start_time:r,repeat_on_days:i,repeat_on_day_of_month:o,cron_expression:e.cron_expression||"",ends_type:e.ends_type||"never",ends_on_date:l,ends_after_count:e.ends_after_count||13})}function QU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=PU(e,t,t.length>0);return(0,ue.A)((0,ue.A)({},s),{},{entity_name:e.entity_name,event_types:e.event_types})}const XU=hu({isPanelOpen:!1,selectedAutomation:null,panelDefaultTab:"details",panelMode:"type-selector",initialFormData:null,activeTab:"active",deleteAutomation:null}).use(pu({openPanel:function(e,t){let{store:s}=e,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"details",n=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;s.setState(e=>{e.selectedAutomation=null!=t?t:null,e.panelDefaultTab=a,e.initialFormData=null!=n?n:null,e.isPanelOpen=!0,t?e.panelMode="edit":l&&(e.panelMode=l)})},closePanel:e=>{let{store:t}=e;t.setState(e=>{e.isPanelOpen=!1,e.selectedAutomation=null,e.initialFormData=null})},setActiveTab:(e,t)=>{let{store:s}=e;s.activeTab=t},setDeleteAutomation:(e,t)=>{let{store:s}=e;s.setState(e=>{e.deleteAutomation=t})},openTypeSelector:e=>{let{store:t}=e;t.setState(e=>{e.isPanelOpen=!0,e.panelMode="type-selector",e.selectedAutomation=null,e.initialFormData=null})},backToTypeSelector:e=>{let{store:t}=e;t.setState(e=>{e.panelMode="type-selector",e.initialFormData=null})},selectAutomationType:(e,t)=>{let{store:s}=e;s.setState(e=>{e.panelMode="scheduled"===t?"create-scheduled":"create-entity",e.panelDefaultTab="details"})},openCreatePanel:(e,t)=>{let{store:s}=e;s.setState(e=>{e.selectedAutomation=null,e.panelDefaultTab="details",e.initialFormData=null,e.panelMode="scheduled"===t?"create-scheduled":"create-entity",e.isPanelOpen=!0})}})),eB=()=>{const{app:e}=lp(),{data:t=[],isLoading:s,refetch:a}=Xd({query:async()=>null!=e&&e.id?EU(e.id):[],enabled:!(null==e||!e.id),initialData:[],toastError:"Failed to load automations",logErrorMsg:"Failed to load automations:"},[null==e?void 0:e.id]),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)([]),[m,x]=(0,Y.useState)([]),[h,p]=(0,Y.useState)([]),[g,f]=(0,Y.useState)(!1),v=(0,Y.useCallback)(()=>{const t=((null==e?void 0:e.function_names)||Object.keys((null==e?void 0:e.functions)||{})).filter(e=>e&&""!==e.trim());u(t)},[null==e?void 0:e.function_names,null==e?void 0:e.functions]),b=(0,Y.useCallback)(()=>{const t=null!=e&&e.entities?Object.keys(e.entities):[];x(t)},[null==e?void 0:e.entities]),j=(0,Y.useCallback)(async(t,s)=>{var a;if(null==e||!e.id)return;const n=null!==(a=null==s?void 0:s.silent)&&void 0!==a&&a;n||(p([]),f(!0));try{if(TU(t)){const s=await kU.getAutomationLogs(e.id,t.id);p(s)}else{const s=await CU.getAutomationLogs(e.id,t.id);p(s)}}catch(l){n||et.toast.error("Failed to load execution logs")}finally{n||f(!1)}},[null==e?void 0:e.id]),y=(0,Y.useRef)(a),N=(0,Y.useRef)(j);y.current=a,N.current=j;const w=(0,Y.useMemo)(()=>(0,cc.throttle)(()=>{y.current();const e=XU.getState().selectedAutomation;e&&N.current(e,{silent:!0})},2e3,{leading:!0,trailing:!0}),[]);(0,Y.useEffect)(()=>{null!=e&&e.id&&(v(),b())},[null==e?void 0:e.id,v,b]),(0,Y.useEffect)(()=>{if(null==e||!e.id)return;const t=function(e,t){const s="apps/".concat(e,"/automations");return Fd.A.addNotificationListener(s,t)}(e.id,()=>{w()});return()=>{null==t||t(),w.cancel()}},[null==e?void 0:e.id,w]);const _=(0,Y.useCallback)(async(t,s)=>{if(null!=e&&e.id){l(!0);try{var a,n,r;const l="one-time"===t.schedule_mode&&t.one_time_date?zU(t.one_time_date,t.start_time||"00:00"):void 0,i="on"===t.ends_type&&t.ends_on_date?zU(t.ends_on_date,"23:59"):void 0,o=t.start_time||"00:00",c="recurring"===t.schedule_mode?function(e){if(!e)return"";const[t,s]=e.split(":").map(Number),a=new Date,n=new Date(a.getFullYear(),a.getMonth(),a.getDate(),t,s,0),l=String(n.getUTCHours()).padStart(2,"0"),r=String(n.getUTCMinutes()).padStart(2,"0");return"".concat(l,":").concat(r)}(o):void 0,d="recurring"===t.schedule_mode&&"weeks"===t.repeat_unit&&(null===(a=t.repeat_on_days)||void 0===a?void 0:a.length)>0?YU(t.repeat_on_days,o,"toUtc"):(null===(n=t.repeat_on_days)||void 0===n?void 0:n.length)>0?t.repeat_on_days:void 0,u="recurring"===t.schedule_mode&&"months"===t.repeat_unit&&t.repeat_on_day_of_month?function(e,t){return $U(e,t,"toUtc")}(t.repeat_on_day_of_month,o):void 0,m={name:t.name,function_name:t.function_name,function_args:null!==(r=t.function_args)&&void 0!==r?r:null,schedule_mode:t.schedule_mode,schedule_type:t.schedule_type,is_active:t.is_active,ends_type:t.ends_type,description:t.description||void 0,one_time_date:l,start_time:c,repeat_interval:"recurring"===t.schedule_mode&&t.repeat_interval?t.repeat_interval:void 0,repeat_unit:"recurring"===t.schedule_mode&&t.repeat_unit?t.repeat_unit:void 0,cron_expression:"recurring"===t.schedule_mode&&t.cron_expression?t.cron_expression:void 0,repeat_on_days:"recurring"===t.schedule_mode&&"weeks"===t.repeat_unit?d:void 0,repeat_on_day_of_month:"recurring"===t.schedule_mode&&"months"===t.repeat_unit?u:void 0,ends_on_date:i,ends_after_count:"after"===t.ends_type&&t.ends_after_count?t.ends_after_count:void 0};if(s){const t=m;await kU.updateAutomation(e.id,s.id,t),et.toast.success("Automation updated successfully")}else{const t=m;await kU.createAutomation(e.id,t),et.toast.success("Automation created successfully")}XU.closePanel(),XU.setActiveTab("active")}catch(c){var i,o;et.toast.error((null==c||null===(i=c.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.detail)||"Failed to save automation")}finally{l(!1)}}},[null==e?void 0:e.id]),k=(0,Y.useCallback)(async(t,s)=>{if(null!=e&&e.id){l(!0);try{var a;const n={name:t.name,description:t.description||void 0,entity_name:t.entity_name,event_types:t.event_types,function_name:t.function_name,function_args:null!==(a=t.function_args)&&void 0!==a?a:null,is_active:t.is_active};if(s){const t=n;await CU.updateAutomation(e.id,s.id,t),et.toast.success("Automation updated successfully")}else{const t=n;await CU.createAutomation(e.id,t),et.toast.success("Automation created successfully")}XU.closePanel(),XU.setActiveTab("active")}catch(i){var n,r;et.toast.error((null==i||null===(n=i.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.detail)||"Failed to save automation")}finally{l(!1)}}},[null==e?void 0:e.id]),C=(0,Y.useCallback)(async(t,s)=>{if(s&&s.stopPropagation(),null!=e&&e.id)try{const s=await async function(e,t,s){if("scheduled"===s){const s=await kU.toggleAutomation(e,t);return(0,ue.A)((0,ue.A)({},s),{},{automation_type:"scheduled"})}{const s=await CU.toggleAutomation(e,t);return(0,ue.A)((0,ue.A)({},s),{},{automation_type:"entity"})}}(e.id,t.id,t.automation_type);et.toast.success(s.is_active?"Automation activated":"Automation paused")}catch(a){et.toast.error("Failed to update automation status")}},[null==e?void 0:e.id]),A=(0,Y.useCallback)(async t=>{if(null!=e&&e.id){i(!0);try{await async function(e,t,s){return"scheduled"===s?kU.deleteAutomation(e,t):CU.deleteAutomation(e,t)}(e.id,t.id,t.automation_type),et.toast.success("Automation deleted"),XU.setDeleteAutomation(null)}catch(s){et.toast.error("Failed to delete automation")}finally{i(!1)}}},[null==e?void 0:e.id]),S=(0,Y.useCallback)(async t=>{if(null!=e&&e.id)try{await async function(e,t,s){if("scheduled"===s){const s=await kU.archiveAutomation(e,t);return(0,ue.A)((0,ue.A)({},s),{},{automation_type:"scheduled"})}{const s=await CU.archiveAutomation(e,t);return(0,ue.A)((0,ue.A)({},s),{},{automation_type:"entity"})}}(e.id,t.id,t.automation_type),et.toast.success("Automation archived")}catch(s){et.toast.error("Failed to archive automation")}},[null==e?void 0:e.id]),E=(0,Y.useCallback)(async(t,s)=>{if(s&&s.stopPropagation(),null!=e&&e.id&&TU(t)){c(t.id);try{const s=await async function(e,t){return kU.runAutomationNow(e,t)}(e.id,t.id);et.toast.success(s.message),await a()}catch(r){var n,l;et.toast.error((null==r||null===(n=r.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.detail)||"Failed to run automation")}finally{c(null)}}},[null==e?void 0:e.id,a]),T=(0,Y.useCallback)(async(t,s,n)=>{if(null!=e&&e.id&&IU(t)){c(t.id);try{const l=await CU.runAutomationNow(e.id,t.id,{entity_id:s,entity_data:n});et.toast.success(l.message||"Automation executed successfully"),await a()}catch(i){var l,r;et.toast.error((null==i||null===(l=i.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail)||"Failed to run automation")}finally{c(null)}}},[null==e?void 0:e.id,a]),I=(0,Y.useCallback)(e=>{if(TU(e)){const t=JU(e," (Copy)");XU.openPanel(null,"details",t,"create-scheduled")}else{const t=QU(e," (Copy)");XU.openPanel(null,"details",t,"create-entity")}},[]),P=(0,Y.useCallback)(async t=>{if(null==e||!e.id)return null;try{return TU(t)?await kU.getResolveWithAIContext(e.id,t.id):await CU.getResolveWithAIContext(e.id,t.id)}catch(s){return et.toast.error("Failed to get error context"),null}},[null==e?void 0:e.id]),L=(0,Y.useMemo)(()=>t.filter(e=>!e.is_archived),[t]),M=(0,Y.useMemo)(()=>t.filter(e=>e.is_archived),[t]);return{store:XU,automations:t,activeAutomations:L,archivedAutomations:M,backendFunctions:d,entityNames:m,logs:h,isLoading:s,isSaving:n,isDeleting:r,isLoadingLogs:g,runningTaskId:o,loadAutomations:a,loadLogs:j,saveScheduledTask:_,saveEntityAutomation:k,toggleAutomation:C,deleteAutomation:A,archiveAutomation:S,runScheduledAutomation:E,runEntityAutomation:T,duplicateAutomation:I,getResolveWithAIContext:P}};var tB=s(32369);const sB=["className"],aB=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,sB);return(0,se.jsx)(ut.Root,(0,ue.A)((0,ue.A)({className:de("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s)},a),{},{ref:t,children:(0,se.jsx)(ut.Thumb,{className:de("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});aB.displayName=ut.Root.displayName;const nB={name:"",description:"",function_name:"",is_active:!0,entity_name:"",event_types:["create"],function_args:void 0},lB=["create","update","delete"],rB={create:"Created",update:"Updated",delete:"Deleted"};function iB(e){const t=new Date(e),s=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),n=t.getFullYear(),l=t.getHours(),r=String(t.getMinutes()).padStart(2,"0"),i=l>=12?"PM":"AM",o=l%12||12;return"".concat(s,"/").concat(a,"/").concat(n," ").concat(o,":").concat(r," ").concat(i)}const oB=e=>{let{isArchiveTab:t,runningTaskId:s,hasFailedAutomation:a,onToggleAutomation:n,onEditAutomation:l,onViewLogs:r,onRunNow:i,onArchiveAutomation:o,onDuplicateAutomation:c,onDeleteAutomation:d,onResolveWithAI:u,resolvingAutomationId:m}=e;return Y.useMemo(()=>{const e=[];t||e.push({id:"switch",title:"",width:72,render:e=>(0,se.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,se.jsx)(aB,{checked:e.is_active,onCheckedChange:()=>n(e),className:"data-[state=checked]:bg-slate-900"})})}),e.push({id:"name",title:"Name and description",width:320,render:e=>{const t="failed"===e.last_run_status;return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-slate-900",children:e.name}),t&&(0,se.jsx)(ad.A,{className:"h-4 w-4 min-w-4 min-h-4 text-red-600"})]}),e.description&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("p",{className:"font-base44 text-sm font-normal text-slate-500 mt-0.5 line-clamp-2 cursor-default",children:e.description})}),(0,se.jsx)(pp,{side:"top",className:"max-w-[250px] rounded-md bg-[#171717] px-3 py-1.5 font-base44 text-white font-normal",children:(0,se.jsx)("p",{children:e.description})})]})})]})}}),e.push({id:"type",title:"Type",width:220,render:e=>{if(TU(e)){const t=function(e){if("one-time"===e.schedule_mode){if(e.one_time_date){const t=new Date(DU(e.one_time_date)),s=t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),a=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return"Once on ".concat(s," at ").concat(a)}return"One-time (not scheduled)"}if("cron"===e.schedule_type&&e.cron_expression)return"Cron: ".concat(e.cron_expression);if(!e.repeat_unit)return"Not configured";const t=e.repeat_interval||1,s=e.repeat_unit,a=e.start_time||"00:00",n=WU(a)||a,l=e.repeat_on_days&&e.start_time?GU(e.repeat_on_days,e.start_time):e.repeat_on_days||[];switch(s){case"minutes":return FU(t,"minute");case"hours":{const s=FU(t,"hour");if(e.start_time&&e.created_date){const t=n.split(":")[1]||"00",a="00"===t,[l,r]=e.start_time.split(":").map(Number),i=new Date(DU(e.created_date)),o=new Date(Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),l,r,0));if(o<=new Date)return a?s:"".concat(s," at :").concat(t);const c=o.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return"".concat(s," starting ").concat(c," at ").concat(OU(n))}return s}case"days":return"".concat(FU(t,"day")," at ").concat(OU(n));case"weeks":{if(0===l.length)return"".concat(FU(t,"week")," at ").concat(OU(n));const e=l.map(e=>RU[e]).join(", ");return 1===t?"Every ".concat(e," at ").concat(OU(n)):"".concat(FU(t,"week")," on ").concat(e," at ").concat(OU(n))}case"months":if(e.repeat_on_day_of_month){const s=e.start_time?ZU(e.repeat_on_day_of_month,e.start_time):e.repeat_on_day_of_month,a=function(e){const t=["th","st","nd","rd"],s=e%100;return t[(s-20)%10]||t[s]||t[0]}(s);return 1===t?"Monthly on the ".concat(s).concat(a," at ").concat(OU(n)):"Every ".concat(t," months on the ").concat(s).concat(a," at ").concat(OU(n))}return 1===t?"Monthly at ".concat(OU(n)):"Every ".concat(t," months at ").concat(OU(n));default:return"Unknown schedule"}}(e);return(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)("div",{className:"flex items-center gap-2 min-w-0 cursor-default",children:[(0,se.jsx)(jS.A,{className:"h-4 w-4 shrink-0 text-slate-400"}),(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-slate-700 truncate",children:t})]})}),(0,se.jsx)(pp,{side:"top",className:"max-w-[300px] rounded-md bg-[#171717] px-3 py-1.5 font-base44 text-white font-normal",children:(0,se.jsx)("p",{children:t})})]})})}{const t=e.event_types.map(e=>rB[e]).join(", "),s="".concat(e.entity_name," \u2192 ").concat(t);return(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsxs)("div",{className:"flex items-center gap-2 min-w-0 cursor-default",children:[(0,se.jsx)(hT.A,{className:"h-4 w-4 shrink-0 text-slate-400"}),(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-slate-700 truncate",children:s})]})}),(0,se.jsx)(pp,{side:"top",className:"max-w-[300px] rounded-md bg-[#171717] px-3 py-1.5 font-base44 text-white font-normal",children:(0,se.jsx)("p",{children:s})})]})})}}});const x=a?320:200;return e.push({id:"lastRun",title:"Last run",width:x,render:e=>{const s="failed"===e.last_run_status;return(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-slate-900 whitespace-nowrap",children:e.last_run_at?iB(e.last_run_at):"\u2014"}),s&&e.last_run_at&&(0,se.jsx)(gk,{className:"bg-red-600 text-white hover:bg-red-600 font-base44 text-sm font-medium px-1.5 py-0 h-5 rounded-md",children:"Failed"}),s&&!t&&u&&(0,se.jsx)(Bx,{variant:"outline",size:"sm",className:"h-6 px-2 py-1 font-base44 text-xs font-normal leading-[20px]",onClick:t=>{t.stopPropagation(),u(e)},disabled:m===e.id,children:m===e.id?"Loading...":"Fix with AI"})]})}}),e.push({id:"actions",title:"",width:56,align:"end",stickyActionCell:!0,render:e=>{TU(e);return(0,se.jsx)(kC,{primaryAction:(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{size:"icon",variant:"outline",className:"h-8 w-8 rounded-md border border-[#E5E5E5] bg-white shadow-xs",onClick:e=>e.stopPropagation(),children:(0,se.jsx)(Nv.A,{className:"h-4 w-4"})})}),(0,se.jsxs)(Aj,{align:"end",className:"w-48 rounded-lg",children:[!t&&(0,se.jsxs)(Sj,{onClick:t=>{t.stopPropagation(),l(e)},className:"gap-2 cursor-pointer",children:[(0,se.jsx)(Zw.A,{className:"h-4 w-4 text-slate-500"}),"Edit automation"]}),(0,se.jsxs)(Sj,{onClick:t=>{t.stopPropagation(),r(e)},className:"gap-2 cursor-pointer",children:[(0,se.jsx)(eh.A,{className:"h-4 w-4 text-slate-500"}),"Logs"]}),!t&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Sj,{onClick:t=>{t.stopPropagation(),i(e,t)},disabled:s===e.id,className:"gap-2 cursor-pointer",children:[(0,se.jsx)(LF.A,{className:"h-4 w-4 text-slate-500"}),"Run now"]}),(0,se.jsxs)(Sj,{onClick:t=>{t.stopPropagation(),o(e)},className:"gap-2 cursor-pointer",children:[(0,se.jsx)(tB.A,{className:"h-4 w-4 text-slate-500"}),"Archive"]})]}),(0,se.jsxs)(Sj,{onClick:t=>{t.stopPropagation(),c(e)},className:"gap-2 cursor-pointer",children:[(0,se.jsx)(ob.A,{className:"h-4 w-4 text-slate-500"}),"Duplicate"]}),(0,se.jsxs)(Sj,{onClick:t=>{t.stopPropagation(),d(e)},className:"gap-2 cursor-pointer text-slate-700",children:[(0,se.jsx)(zy.A,{className:"h-4 w-4 text-slate-500"}),"Delete"]})]})]})})}}),e},[t,s,a,n,l,r,i,o,c,d,u,m])},cB=e=>{let{type:t,isMobile:s,onCreateTask:a,discountPercent:n=0}=e;const l=(0,J.Zp)(),{app:r}=lp(),{user:i}=wd(),o=()=>{l("/apps/".concat(null==r?void 0:r.id,"/editor/workspace/app-settings?selectedParam=backend-functions"))};return(0,se.jsx)("div",{className:"border bg-white shadow-sm ".concat(s?"rounded-lg":"rounded-b-lg"),children:(()=>{switch(t){case"not-builder-plus":return(0,se.jsxs)("div",{className:"flex flex-col items-center text-center py-16 px-6",children:[(0,se.jsx)("h3",{className:"font-base44 text-base font-semibold text-slate-900",children:"Unlock automations"}),(0,se.jsx)("p",{className:"font-base44 text-base font-normal text-slate-500 mt-2 max-w-md",children:"To run automations in your app, you need backend functions enabled. Upgrade to enable backend functions and start using automations."}),(0,se.jsx)(mj,{showDiamond:!0,trackingOrigin:"automations_empty_state",userId:null==i?void 0:i.id,appId:null==r?void 0:r.id,className:"mt-6 h-9 px-4 text-sm font-base44 font-normal",discountPercent:n})]});case"backend-not-enabled":return(0,se.jsxs)("div",{className:"flex flex-col items-center text-center py-16 px-6",children:[(0,se.jsx)("h3",{className:"font-base44 text-base font-semibold text-slate-900",children:"Enable backend functions to get started"}),(0,se.jsx)("p",{className:"font-base44 text-base font-normal text-slate-500 mt-2 max-w-md",children:"Automations run backend functions on a schedule or when data changes. Turn on backend functions in Settings to use automations."}),(0,se.jsx)(Bx,{onClick:o,variant:"outline",className:"mt-6 h-9 px-4 font-base44 font-normal",children:"Open Settings"})]});case"no-backend-functions":return(0,se.jsxs)("div",{className:"flex flex-col items-center text-center py-16 px-6",children:[(0,se.jsx)("h3",{className:"font-base44 text-base font-semibold text-slate-900",children:"Create a backend function to add automations"}),(0,se.jsx)("p",{className:"font-base44 text-base font-normal text-slate-500 mt-2 max-w-md",children:"To create an automation, you first need a backend function in your code. Write a backend function in your code or ask the chat for help."})]});case"no-tasks":return(0,se.jsxs)("div",{className:"flex flex-col items-center text-center py-16 px-6",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-xl border border-slate-200 flex items-center justify-center mb-4",children:(0,se.jsx)(jS.A,{className:"w-6 h-6 text-slate-600"})}),(0,se.jsx)("h3",{className:"font-base44 text-base font-semibold text-slate-900",children:"No automations yet"}),(0,se.jsx)("p",{className:"font-base44 text-base font-normal text-slate-500 mt-2",children:"Create an automation to run tasks automatically in your app."}),(0,se.jsxs)(Bx,{onClick:a,variant:"default",className:"gap-2 mt-6 h-9 px-4 font-base44 font-normal",children:[(0,se.jsx)(op.A,{className:"h-4 w-4"}),"New Automation"]})]});case"no-archived":return(0,se.jsxs)("div",{className:"flex flex-col items-center text-center py-16 px-6",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-xl border border-slate-200 flex items-center justify-center mb-4",children:(0,se.jsx)(tB.A,{className:"w-6 h-6 text-slate-600"})}),(0,se.jsx)("h3",{className:"font-base44 text-base font-semibold text-slate-900",children:"No archived automations"}),(0,se.jsx)("p",{className:"font-base44 text-base font-normal text-slate-500 mt-2",children:"Automations you archive or that reach their end date will appear here."})]});default:return null}})()})},dB=e=>{let{isMobile:t}=e;return(0,se.jsxs)("div",{className:"bg-white border border-slate-200 overflow-hidden ".concat(t?"rounded-lg":"rounded-b-lg"),children:[(0,se.jsx)("div",{className:"bg-slate-100 px-6 py-3 border-b border-slate-200",children:(0,se.jsxs)("div",{className:"flex items-center gap-7",children:[(0,se.jsx)("div",{className:"w-[36px]"}),(0,se.jsx)($r,{className:"h-4 w-40"}),(0,se.jsx)($r,{className:"h-4 w-16"}),(0,se.jsx)($r,{className:"h-4 w-16"})]})}),Array.from({length:3}).map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center gap-7 px-6 py-4 ".concat(t<2?"border-b border-slate-200":""),children:[(0,se.jsx)($r,{className:"h-5 w-9 rounded-full"}),(0,se.jsxs)("div",{className:"w-[300px] space-y-2",children:[(0,se.jsx)($r,{className:"h-4 w-32"}),(0,se.jsx)($r,{className:"h-3 w-48"})]}),(0,se.jsx)($r,{className:"h-4 w-32"}),(0,se.jsx)($r,{className:"h-4 w-36"})]},t))]})},uB=e=>{let{store:t,activeAutomations:s,archivedAutomations:a,isLoading:n,runningTaskId:l,emptyStateType:r,onToggleAutomation:i,onRunNow:o,onArchiveAutomation:c,onDuplicateAutomation:d,onResolveWithAI:u,resolvingAutomationId:m}=e;const x=qu(),h=t.useActiveTab(),p="archive"===h,g=p?a:s,f=(0,Y.useCallback)(()=>{t.openTypeSelector()},[t]),v=(0,Y.useCallback)(e=>{t.openPanel(e,"details",null)},[t]),b=(0,Y.useCallback)(e=>{t.openPanel(e,"logs",null)},[t]),j=(0,Y.useCallback)(e=>{t.openPanel(e,"details",null)},[t]),y=(0,Y.useCallback)(e=>{t.setDeleteAutomation(e)},[t]),N=g.some(e=>"failed"===e.last_run_status),w=oB({isArchiveTab:p,runningTaskId:l,hasFailedAutomation:N,onToggleAutomation:i,onEditAutomation:v,onViewLogs:b,onRunNow:o,onArchiveAutomation:c,onDuplicateAutomation:d,onDeleteAutomation:y,onResolveWithAI:u,resolvingAutomationId:m});return r&&["not-builder-plus","backend-not-enabled","no-backend-functions"].includes(r)?(0,se.jsxs)("div",{className:"w-full h-full flex flex-col min-h-0",children:[(0,se.jsx)("div",{className:"sticky top-0 z-30 flex-shrink-0",children:(0,se.jsx)("div",{className:"flex items-center justify-between gap-4 px-6 h-16 min-h-[40px] border border-b-0 bg-white rounded-t-lg shadow-sm",children:(0,se.jsx)("span",{className:"font-base44 text-base font-semibold text-slate-900",children:"Automations"})})}),(0,se.jsx)(cB,{type:r,isMobile:x,onCreateTask:f})]}):(0,se.jsxs)(Kj,{value:h,onValueChange:e=>t.setActiveTab(e),className:"w-full h-full flex flex-col min-h-0 overflow-hidden",children:[(0,se.jsxs)($j,{className:"mb-4 flex-shrink-0 justify-start h-[36px] bg-slate-200 p-[3px] rounded-lg w-full md:w-[350px]",children:[(0,se.jsx)(Zj,{value:"active",className:"flex-1 h-full font-base44 font-normal data-[state=active]:bg-white data-[state=active]:shadow-[0px_1px_3px_0px_rgba(0,0,0,0.1),0px_1px_2px_-1px_rgba(0,0,0,0.1)] data-[state=active]:border data-[state=active]:border-slate-200 data-[state=active]:!border-t-white data-[state=inactive]:bg-transparent data-[state=inactive]:shadow-none data-[state=inactive]:border-0 flex items-center gap-2",style:{borderRadius:"8px"},children:"Active"}),(0,se.jsx)(Zj,{value:"archive",className:"flex-1 h-full font-base44 font-normal data-[state=active]:bg-white data-[state=active]:shadow-[0px_1px_3px_0px_rgba(0,0,0,0.1),0px_1px_2px_-1px_rgba(0,0,0,0.1)] data-[state=active]:border data-[state=active]:border-slate-200 data-[state=active]:!border-t-white data-[state=inactive]:bg-transparent data-[state=inactive]:shadow-none data-[state=inactive]:border-0 flex items-center gap-2",style:{borderRadius:"8px"},children:"Archived"})]}),(0,se.jsx)("div",{className:"sticky top-0 z-30 flex-shrink-0",children:(0,se.jsxs)("div",{className:"flex items-center justify-between gap-4 px-6 h-16 min-h-[40px] border border-b-0 bg-white rounded-t-lg shadow-sm",children:[(0,se.jsx)("span",{className:"font-base44 text-base font-semibold text-slate-900",children:p?"Archived automations":"Automations"}),!p&&!x&&s.length>0&&(0,se.jsxs)(Bx,{onClick:f,className:"bg-slate-900 hover:bg-slate-800 h-9 px-4 gap-2 font-base44 font-normal",children:[(0,se.jsx)(op.A,{className:"h-4 w-4"}),"New Automation"]})]})}),(0,se.jsx)(Jj,{value:h,className:"mt-0 flex flex-col min-h-0 flex-1",children:n&&0===g.length?(0,se.jsx)(dB,{isMobile:x}):0===g.length?(0,se.jsx)(cB,{type:p?"no-archived":"no-tasks",isMobile:x,onCreateTask:f}):(0,se.jsx)(wC,{data:g,columns:w,onRowClick:j,className:"!h-auto !flex-initial [&_thead]:bg-slate-100 [&_thead]:border-slate-300 [&_thead_th]:bg-slate-100 [&_thead_th_span]:!text-[#44485F] ".concat(x?"":"!rounded-t-none"),rowVerticalPadding:"small",children:(0,se.jsx)(wC.Content,{})})})]})};function mB(e){var t;let{open:s,onOpenChange:a,automation:n,backendFunctions:l,onSave:r,isSaving:i,logs:o,isLoadingLogs:c,onLoadLogs:d,defaultTab:u="details",initialFormData:m,onResolveWithAI:x,isResolvingWithAI:h=!1,onBack:p,automationType:g,config:f,renderForm:v,renderLogItem:b,contentOnly:j=!1}=e;const y=qu(),[N,w]=(0,Y.useState)(f.defaultFormData),[_,k]=(0,Y.useState)(u),[C,A]=(0,Y.useState)(null),S=!!n,E=null!==(t=null==n?void 0:n.is_archived)&&void 0!==t&&t,T=o.filter(e=>"failed"===e.status).length,I=(0,Y.useRef)(d);I.current=d;const P=(0,Y.useRef)(f);P.current=f,(0,Y.useEffect)(()=>{n?(w(P.current.toFormData(n)),I.current&&I.current(n),k(u)):m?(w(m),k("details")):(w(P.current.defaultFormData),k("details")),A(null)},[n,s,u,m]);const L=(0,Y.useCallback)((e,t)=>{A(null),P.current.onFormChange?P.current.onFormChange(e,t,N,w):w(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))},[N]),M=async e=>{if(e.preventDefault(),P.current.validateForm){const e=P.current.validateForm(N);if(e)return void A(e)}await r(N)},R=(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(My,{className:"px-6 pt-6 pb-4 items-start",closeButton:(0,se.jsx)(la.A,{className:"w-4 h-4 text-black"}),children:[(0,se.jsx)(Ry,{className:"font-base44 text-lg font-bold leading-none text-black",children:S?N.name||(null==n?void 0:n.name)||"Edit":"New Automation"}),(()=>{const e=g;return e?(0,se.jsx)("div",{className:"flex items-center gap-2 text-sm font-base44 font-regular text-neutral-500 !mt-3",children:"scheduled"===e?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(jS.A,{className:"h-5 w-5"}),(0,se.jsx)("span",{children:"Scheduled"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(hT.A,{className:"h-5 w-5"}),(0,se.jsx)("span",{children:"Data event"})]})}):null})()]}),S?(0,se.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:["failed"===(null==n?void 0:n.last_run_status)&&!E&&x&&(0,se.jsx)("div",{className:"px-6 mb-3",children:(0,se.jsxs)("div",{className:"flex items-center gap-[4px] px-[16px] py-[12px] bg-white border border-neutral-200 rounded-[10px]",children:[(0,se.jsxs)("div",{className:"flex-1 flex items-start gap-[12px]",children:[(0,se.jsx)("div",{className:"pt-[2px] shrink-0",children:(0,se.jsx)(ad.A,{className:"h-4 w-4 text-red-600"})}),(0,se.jsxs)("div",{className:"flex flex-col gap-[4px] font-base44 text-sm leading-[20px] text-neutral-900",children:[(0,se.jsx)("span",{className:"font-medium",children:"Some runs failed"}),(0,se.jsx)("span",{className:"font-normal",children:"Review the logs or let AI fix the errors."})]})]}),(0,se.jsx)(Bx,{variant:"outline",onClick:()=>x(n),disabled:h,className:"shrink-0 h-[24px] px-[12px] py-0 font-base44 text-sm font-normal rounded-[8px]",children:h?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin mr-1"}),"Fixing..."]}):"Fix with AI"})]})}),(0,se.jsxs)(Kj,{value:_,onValueChange:e=>k(e),className:"flex-1 flex flex-col overflow-hidden",children:[(0,se.jsx)("div",{className:"px-6",children:(0,se.jsxs)($j,{className:"bg-slate-200 p-[3px] h-9 w-full rounded-lg",children:[(0,se.jsx)(Zj,{value:"details",className:"flex-1 rounded-md font-base44 text-sm font-normal data-[state=active]:bg-white data-[state=active]:shadow-sm",children:f.detailsTabLabel}),(0,se.jsxs)(Zj,{value:"logs",className:"flex-1 rounded-md font-base44 text-sm font-normal data-[state=active]:bg-white data-[state=active]:shadow-sm gap-1.5",children:["Logs",T>0&&(0,se.jsx)(gk,{className:"bg-red-600 text-white text-xs px-1.5 py-0 h-5 rounded-full ml-1",children:T})]})]})}),(0,se.jsx)(Jj,{value:"details",className:"flex-1 overflow-y-auto px-6 pt-3 pb-4 m-0",children:v({formData:N,backendFunctions:l,isArchived:E,validationError:C,onFormDataChange:L,onValidationErrorChange:A,onSubmit:M})}),(0,se.jsx)(Jj,{value:"logs",className:"flex-1 overflow-y-auto px-6 py-4 m-0",children:c?(0,se.jsx)("div",{className:"space-y-3",children:Array.from({length:5}).map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,se.jsx)($r,{className:"h-4 w-4 rounded-full"}),(0,se.jsx)("div",{className:"flex-1 space-y-2",children:(0,se.jsx)($r,{className:"h-4 w-36"})}),(0,se.jsx)($r,{className:"h-4 w-8"})]},t))}):0===o.length?(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-6 py-12 px-12 text-center",children:[(0,se.jsx)("div",{className:"w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center",children:(0,se.jsx)(eh.A,{className:"h-6 w-6 text-slate-900"})}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 w-full font-base44",children:[(0,se.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:"No logs yet"}),(0,se.jsx)("p",{className:"text-base font-normal text-slate-500",children:f.noLogsMessage})]})]}):(0,se.jsx)("div",{className:"space-y-3.5",children:o.map(e=>(0,se.jsx)(Y.Fragment,{children:b(e)},e.id))})})]})]}):(0,se.jsx)("div",{className:"flex-1 overflow-y-auto px-6 pb-4",children:v({formData:N,backendFunctions:l,isArchived:!1,validationError:C,onFormDataChange:L,onValidationErrorChange:A,onSubmit:M})}),(0,se.jsx)("div",{className:"px-6 py-4 border-t border-slate-100 mt-auto",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[!S&&p?(0,se.jsxs)("button",{type:"button",onClick:p,disabled:i,className:"flex items-center gap-1 font-base44 text-sm font-normal text-slate-600 hover:text-slate-900 transition-colors",children:[(0,se.jsx)(vs.A,{className:"h-4 w-4"}),"Back"]}):(0,se.jsx)("div",{}),(0,se.jsx)("div",{className:"flex gap-2",children:E?(0,se.jsx)(Bx,{type:"button",variant:"outline",onClick:()=>a(!1),className:"rounded-lg h-10 px-5 font-base44 font-normal",children:"Close"}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Bx,{type:"button",variant:"outline",onClick:()=>a(!1),disabled:i,className:"rounded-lg h-10 px-5 font-base44 font-normal",children:"Cancel"}),(0,se.jsx)(Bx,{type:"submit",form:f.formId,disabled:i||!f.isFormSubmittable(N),className:"rounded-lg h-10 px-5 bg-slate-900 hover:bg-slate-800 font-base44 font-normal",children:i?"Saving...":"Save"})]})})]})})]});return j?(0,se.jsx)("div",{className:"flex flex-col h-full",children:R}):(0,se.jsx)(Sy,{open:s,onOpenChange:a,children:(0,se.jsx)(Ly,{side:y?"bottom":"right",className:y?"rounded-t-2xl h-[85vh] p-0 flex flex-col":"w-[384px] sm:max-w-[384px] h-full p-0 flex flex-col overflow-y-auto",children:R})})}function xB(e){var t;let{log:s,renderContext:a}=e;const[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!1),o="success"===s.status,c="failed"===s.status,d=null===(t=s.function_output)||void 0===t?void 0:t.result,u=o&&void 0!==d;return(0,se.jsxs)("div",{className:"flex flex-col gap-2 p-3 rounded-md ".concat(c?"bg-red-50":"bg-slate-50"),children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 ".concat(u?"cursor-pointer":""),onClick:()=>u&&l(!n),children:[(0,se.jsx)("div",{className:"shrink-0",children:o?(0,se.jsx)(hb.A,{className:"h-4 w-4 text-emerald-500"}):c?(0,se.jsx)(ad.A,{className:"h-4 w-4 text-red-500"}):(0,se.jsx)("div",{className:"h-4 w-4 rounded-full border-2 border-blue-500 border-t-transparent animate-spin"})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("div",{className:"text-sm text-slate-900",children:UU(s.started_at)}),a&&(0,se.jsx)("div",{className:"text-xs text-slate-500",children:a(s)})]}),s.duration_ms&&(0,se.jsx)("div",{className:"text-sm text-slate-900",children:BU(s.duration_ms)}),u&&(0,se.jsx)("div",{className:"shrink-0",children:n?(0,se.jsx)(ur.A,{className:"h-4 w-4 text-slate-500"}):(0,se.jsx)(_t.A,{className:"h-4 w-4 text-slate-500"})})]}),c&&s.error_message&&(0,se.jsx)("div",{className:"pl-[28px]",children:(0,se.jsx)("p",{className:"text-sm font-medium text-red-600 leading-5",children:s.error_message})}),n&&u&&(0,se.jsxs)("div",{className:"relative group pl-[28px]",children:[(0,se.jsx)("pre",{className:"text-sm text-slate-500 leading-5 overflow-auto max-h-[200px] whitespace-pre-wrap pr-8 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-slate-300 [&::-webkit-scrollbar-thumb]:rounded-full",children:JSON.stringify(d,null,2)}),(0,se.jsx)("button",{onClick:async e=>{e.stopPropagation(),void 0!==d&&(await navigator.clipboard.writeText(JSON.stringify(d,null,2)),i(!0),setTimeout(()=>i(!1),2e3))},className:"absolute bottom-0 right-3 p-1.5 rounded-md hover:bg-slate-200 transition-all ".concat(r?"opacity-100":"opacity-0 group-hover:opacity-100"),title:"Copy output",children:r?(0,se.jsx)(Ds.A,{className:"h-4 w-4 text-emerald-500"}):(0,se.jsx)(ob.A,{className:"h-4 w-4 text-slate-400"})})]})]})}const hB={name:"",description:"",function_name:"",function_args:void 0,is_active:!0,schedule_mode:"recurring",one_time_date:"",schedule_type:"simple",repeat_interval:1,repeat_unit:"weeks",start_time:"09:00",repeat_on_days:[],repeat_on_day_of_month:1,cron_expression:"",ends_type:"never",ends_on_date:"",ends_after_count:13};function pB(e){let{value:t,onChange:s,placeholder:a="Select date",disabled:n=!1,minDate:l,maxDate:r,className:i,id:o}=e;const[c,d]=Y.useState(!1);return(0,se.jsxs)(mS,{open:c,onOpenChange:d,children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"outline",id:o,disabled:n,className:de("w-full justify-between font-normal",!t&&"text-muted-foreground",i),children:[t?t.toLocaleDateString():a,(0,se.jsx)(_t.A,{className:"h-4 w-4 opacity-50"})]})}),(0,se.jsx)(hS,{className:"w-auto overflow-hidden p-0",align:"start",children:(0,se.jsx)(eF,{mode:"single",selected:t,captionLayout:"dropdown",onSelect:e=>{null==s||s(e),d(!1)},disabled:e=>!!(l&&e<l)||!!(r&&e>r)})})]})}function gB(e){const[t,s]=e.split(":");let a=parseInt(t,10);const n=s||"00";if(isNaN(a))return{hour12:9,minute:"00",period:"AM"};const l=a>=12?"PM":"AM";return 0===a?a=12:a>12&&(a-=12),{hour12:a,minute:n,period:l}}function fB(e,t,s){let a=e;return"AM"===s?12===a&&(a=0):12!==a&&(a+=12),"".concat(a.toString().padStart(2,"0"),":").concat(t.padStart(2,"0"))}const vB=Y.forwardRef((e,t)=>{let{value:s="09:00",onChange:a,onError:n,disabled:l=!1,className:r,id:i}=e;const{hour12:o,minute:c,period:d}=gB(s),[u,m]=Y.useState("".concat(o.toString().padStart(2,"0"),":").concat(c)),[x,h]=Y.useState(!1);Y.useEffect(()=>{if(!x){const{hour12:e,minute:t}=gB(s);m("".concat(e.toString().padStart(2,"0"),":").concat(t))}},[s,x]);return(0,se.jsxs)("div",{className:de("flex flex-col gap-1",r),children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Df,{ref:t,type:"text",id:i,value:u,onChange:e=>{const t=e.target.value;m(t),x&&(h(!1),null==n||n(null))},onBlur:()=>{const e=bB(u);if(e){const t=fB(e.hour,e.minute,d);null==a||a(t),null==n||n(null),h(!1),m("".concat(e.hour.toString().padStart(2,"0"),":").concat(e.minute))}else null==n||n("Time must be in HH:MM format (e.g., '09:00')."),h(!0)},onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.blur()},disabled:l,placeholder:"HH:MM",className:de("w-[80px] h-10 rounded-lg bg-background text-center tabular-nums",x?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-200")}),(0,se.jsxs)(Wf,{value:d,onValueChange:e=>(e=>{const t=bB(u);t?(null==a||a(fB(t.hour,t.minute,e)),null==n||n(null),h(!1),m("".concat(t.hour.toString().padStart(2,"0"),":").concat(t.minute))):(null==n||n("Time must be in HH:MM format (e.g., '09:00')."),h(!0))})(e),disabled:l,children:[(0,se.jsx)(Yf,{className:"w-[72px] h-10 rounded-lg border-slate-200",children:(0,se.jsx)(qf,{})}),(0,se.jsxs)($f,{className:"rounded-lg min-w-[72px]",children:[(0,se.jsx)(Zf,{value:"AM",children:"AM"}),(0,se.jsx)(Zf,{value:"PM",children:"PM"})]})]})]}),x&&(0,se.jsxs)("span",{className:"text-xs text-red-500",children:[(0,se.jsx)("span",{className:"font-bold",children:"*"})," Invalid time format (use HH:MM with 1-12 hours format (e.g., '9:00').)"]})]})});function bB(e){const t=e.trim(),s=t.match(/^(\d{1,2}):(\d{2})$/);if(s){const e=parseInt(s[1],10),t=s[2];if(e>=1&&e<=12&&parseInt(t,10)>=0&&parseInt(t,10)<=59)return{hour:e,minute:t}}const a=t.match(/^(\d{1,2})(\d{2})$/);if(a){const e=parseInt(a[1],10),t=a[2];if(e>=1&&e<=12&&parseInt(t,10)>=0&&parseInt(t,10)<=59)return{hour:e,minute:t}}const n=t.match(/^(\d{1,2})$/);if(n){const e=parseInt(n[1],10);if(e>=1&&e<=12)return{hour:e,minute:"00"}}return null}function jB(e){let{name:t,value:s,checked:a,onChange:n,label:l,disabled:r}=e;return(0,se.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)("div",{className:"w-4 h-4 rounded-full border-2 flex items-center justify-center ".concat(a?"border-slate-900":"border-slate-300"),children:a&&(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-900"})}),(0,se.jsx)("input",{type:"radio",name:t,checked:a,onChange:n,className:"sr-only",disabled:r}),(0,se.jsx)("span",{className:"font-base44 text-sm font-medium text-slate-700",children:l})]})}function yB(e){var t;let{formData:s,backendFunctions:a,isArchived:n=!1,validationError:l,onFormDataChange:r,onValidationErrorChange:i,onSubmit:o}=e;const c=(0,Y.useMemo)(()=>{const e=new Date;return e.setHours(0,0,0,0),e},[]),d=e=>{if(!e)return;const t=new Date(e+"T00:00:00");return isNaN(t.getTime())?void 0:t},u=e=>{if(!e)return"";const t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a)};return(0,se.jsxs)("form",{id:"scheduled-automation-form",onSubmit:o,className:"space-y-5",children:[l&&(0,se.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-red-600 flex-shrink-0"}),(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-red-600 flex-1",children:l}),(0,se.jsx)("button",{type:"button",onClick:()=>i(null),className:"text-red-600 hover:text-red-800 flex-shrink-0",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"name",className:"font-base44 text-sm font-medium text-slate-700",children:"Name"}),(0,se.jsx)(Df,{id:"name",value:s.name,onChange:e=>r("name",e.target.value),placeholder:"Automation name",className:"h-10 rounded-lg border-slate-200",required:!0,disabled:n})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"description",className:"font-base44 text-sm font-medium text-slate-700",children:"Description"}),(0,se.jsx)(tN,{id:"description",value:s.description,onChange:e=>r("description",e.target.value),placeholder:"Describe what this automation does.",rows:3,className:"rounded-lg border-slate-200 resize-none",disabled:n})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(aN,{htmlFor:"function",className:"font-base44 text-sm font-medium text-slate-700",children:"Function to run"}),(0,se.jsx)(mp,{delayDuration:50,children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-slate-400 cursor-help"})}),(0,se.jsx)(pp,{side:"top",className:"max-w-[220px] rounded-md bg-[#171717] px-3 py-1.5 font-base44 text-white text-xs font-normal leading-[16px]",children:"Select a backend function from your code. To add or edit a function, update it in your code or ask the chat for help."})]})})]}),0===a.length?(0,se.jsx)(Df,{disabled:!0,value:"No backend functions available",className:"h-10 rounded-lg text-slate-500"}):(0,se.jsxs)(Wf,{value:s.function_name&&""!==s.function_name.trim()?s.function_name:void 0,onValueChange:e=>r("function_name",e),disabled:n,children:[(0,se.jsx)(Yf,{className:"h-10 rounded-lg border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Select a function"})}),(0,se.jsx)($f,{className:"rounded-lg",children:a.filter(e=>e&&""!==e.trim()).map(e=>(0,se.jsx)(Zf,{value:e,children:e},e))})]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"Type"}),(0,se.jsxs)("div",{className:"flex items-center gap-6 ".concat(n?"opacity-60 pointer-events-none":""),children:[(0,se.jsx)(jB,{name:"scheduleMode",value:"recurring",checked:"recurring"===s.schedule_mode,onChange:()=>r("schedule_mode","recurring"),label:"Recurring",disabled:n}),(0,se.jsx)(jB,{name:"scheduleMode",value:"one-time",checked:"one-time"===s.schedule_mode,onChange:()=>r("schedule_mode","one-time"),label:"One Time",disabled:n})]})]}),"recurring"===s.schedule_mode&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"Repeats every"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:["weeks"!==s.repeat_unit&&"months"!==s.repeat_unit&&(0,se.jsxs)(Wf,{value:s.repeat_interval.toString(),onValueChange:e=>r("repeat_interval",parseInt(e)),disabled:n,children:[(0,se.jsx)(Yf,{className:"w-20 h-10 rounded-lg border-slate-200",children:(0,se.jsx)(qf,{})}),(0,se.jsx)($f,{className:"rounded-lg",children:"minutes"===s.repeat_unit?Array.from({length:26},(e,t)=>(0,se.jsx)(Zf,{value:(t+5).toString(),children:t+5},t+5)):Array.from({length:30},(e,t)=>(0,se.jsx)(Zf,{value:(t+1).toString(),children:t+1},t+1))})]}),(0,se.jsxs)(Wf,{value:s.repeat_unit||"days",onValueChange:e=>r("repeat_unit",e),disabled:n,children:[(0,se.jsx)(Yf,{className:"".concat("weeks"===s.repeat_unit||"months"===s.repeat_unit?"w-full":"flex-1"," h-10 rounded-lg border-slate-200"),children:(0,se.jsx)(qf,{})}),(0,se.jsxs)($f,{className:"rounded-lg",children:[(0,se.jsx)(Zf,{value:"minutes",children:"Minute"}),(0,se.jsx)(Zf,{value:"hours",children:"Hour"}),(0,se.jsx)(Zf,{value:"days",children:"Day"}),(0,se.jsx)(Zf,{value:"weeks",children:"Week"}),(0,se.jsx)(Zf,{value:"months",children:"Month"})]})]})]})]}),"minutes"!==s.repeat_unit&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"hours"===s.repeat_unit?"Start at":"At"}),(0,se.jsx)(vB,{value:s.start_time,onChange:e=>r("start_time",e),onError:i,disabled:n})]}),"weeks"===s.repeat_unit&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"Repeats on"}),(0,se.jsx)("div",{className:"flex gap-1.5 ".concat(n?"opacity-60 pointer-events-none":""),children:MU.map(e=>{const t=s.repeat_on_days.includes(e.value);return(0,se.jsx)("button",{type:"button",onClick:()=>(e=>{const t=s.repeat_on_days.includes(e)?s.repeat_on_days.filter(t=>t!==e):[...s.repeat_on_days,e].sort();r("repeat_on_days",t)})(e.value),disabled:n,className:"w-9 h-9 rounded-lg font-base44 text-sm font-normal transition-colors ".concat(t?"bg-slate-900 text-white":"bg-white border border-slate-200 text-slate-600 hover:bg-slate-50"),children:e.label},e.value)})})]}),"months"===s.repeat_unit&&(0,se.jsxs)("div",{className:"space-y-3 ".concat(n?"opacity-60 pointer-events-none":""),children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"Repeats on day"}),(0,se.jsxs)(Wf,{value:(s.repeat_on_day_of_month||1).toString(),onValueChange:e=>r("repeat_on_day_of_month",parseInt(e)),disabled:n,children:[(0,se.jsx)(Yf,{className:"w-20 h-9 rounded-lg border-slate-200 disabled:opacity-50",children:(0,se.jsx)(qf,{})}),(0,se.jsx)($f,{className:"rounded-lg max-h-48",children:Array.from({length:31},(e,t)=>(0,se.jsx)(Zf,{value:(t+1).toString(),children:t+1},t+1))})]})]}),(0,se.jsxs)("div",{className:"space-y-3 ".concat(n?"opacity-60 pointer-events-none":""),children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"Ends"}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(jB,{name:"endsType",value:"never",checked:"never"===s.ends_type,onChange:()=>r("ends_type","never"),label:"Never",disabled:n}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-[72px]",children:(0,se.jsx)(jB,{name:"endsType",value:"on",checked:"on"===s.ends_type,onChange:()=>r("ends_type","on"),label:"On",disabled:n})}),(0,se.jsx)(pB,{value:d(s.ends_on_date),onChange:e=>r("ends_on_date",u(e)),disabled:"on"!==s.ends_type||n,minDate:c,placeholder:"Select date"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-[72px]",children:(0,se.jsx)(jB,{name:"endsType",value:"after",checked:"after"===s.ends_type,onChange:()=>r("ends_type","after"),label:"After",disabled:n})}),(0,se.jsx)(Df,{type:"number",min:1,value:s.ends_after_count,onChange:e=>r("ends_after_count",parseInt(e.target.value)||1),disabled:"after"!==s.ends_type||n,className:"w-16 h-9 rounded-lg border-slate-200 text-sm text-center disabled:opacity-50"}),(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-slate-600",children:"occurrences"})]})]})]})]}),"one-time"===s.schedule_mode&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"Run on"}),(0,se.jsx)(pB,{value:d(null===(t=s.one_time_date)||void 0===t?void 0:t.split("T")[0]),onChange:e=>r("one_time_date",u(e)),minDate:c,disabled:n,placeholder:"Select date"})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-700",children:"At time"}),(0,se.jsx)(vB,{value:s.start_time,onChange:e=>r("start_time",e),onError:i,disabled:n})]})]})]})}function NB(e){const{schedule_mode:t,one_time_date:s,start_time:a,repeat_unit:n,repeat_on_days:l,repeat_on_day_of_month:r,ends_type:i,ends_on_date:o,ends_after_count:c,repeat_interval:d}=e;if("one-time"===t){if(!s)return"One-time schedules require a date to be specified.";if(!a)return"One-time schedules require a time to be specified.";if(new Date("".concat(s,"T").concat(a,":00"))<=new Date)return"One-time schedule date and time cannot be in the past."}if("recurring"===t){if(d<1)return"Repeat interval must be at least 1.";if("minutes"===n&&d<5)return"Minimum interval for minute-based schedules is ".concat(5," minutes.");if("weeks"===n&&(!l||0===l.length))return"Please select at least one day for weekly schedule.";if("months"===n&&!r)return"Monthly schedules require a day of month to be selected."}if("on"===i){if(!o)return"End date is required when 'Ends' is set to 'On'.";const e=new Date;if(e.setHours(0,0,0,0),new Date(o)<e)return"End date cannot be in the past."}return"after"===i&&(!c||c<1)?"Occurrence count must be at least 1.":null}function wB(e){let{open:t,onOpenChange:s,automation:a,backendFunctions:n,onSave:l,isSaving:r,logs:i,isLoadingLogs:o,onLoadLogs:c,defaultTab:d="details",initialFormData:u,onResolveWithAI:m,isResolvingWithAI:x=!1,onBack:h,contentOnly:p=!1}=e;const g=(0,Y.useMemo)(()=>({newTitle:"New scheduled automation",detailsTabLabel:"Details",noLogsMessage:"Logs will appear here after this automation runs.",formId:"scheduled-automation-form",defaultFormData:hB,toFormData:JU,isFormSubmittable:e=>!!e.name&&!!e.function_name,validateForm:NB,onFormChange:(e,t,s,a)=>{a(s=>{const a=(0,ue.A)((0,ue.A)({},s),{},{[e]:t});if("repeat_unit"===e&&"minutes"===t&&s.repeat_interval<5&&(a.repeat_interval=5),"repeat_unit"!==e||"weeks"!==t&&"months"!==t||(a.repeat_interval=1),"cron_expression"===e){t&&t.trim()?a.schedule_type="cron":a.schedule_type="simple"}return a})}}),[]),f=(0,Y.useMemo)(()=>e=>(0,se.jsx)(yB,{formData:e.formData,backendFunctions:e.backendFunctions,isArchived:e.isArchived,validationError:e.validationError,onFormDataChange:e.onFormDataChange,onValidationErrorChange:e.onValidationErrorChange,onSubmit:e.onSubmit}),[]),v=(0,Y.useMemo)(()=>e=>(0,se.jsx)(xB,{log:e}),[]);return(0,se.jsx)(mB,{open:t,onOpenChange:s,automation:a,backendFunctions:n,onSave:l,isSaving:r,logs:i,isLoadingLogs:o,onLoadLogs:c,defaultTab:d,initialFormData:u,onResolveWithAI:m,isResolvingWithAI:x,onBack:h,automationType:"scheduled",config:g,renderForm:f,renderLogItem:v,contentOnly:p})}function _B(e){let{formData:t,entityNames:s,backendFunctions:a,isArchived:n=!1,validationError:l,onFormDataChange:r,onValidationErrorChange:i,onSubmit:o}=e;return(0,se.jsxs)("form",{id:"entity-automation-form",onSubmit:o,className:"space-y-5",children:[l&&(0,se.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-red-600 flex-shrink-0"}),(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-red-600 flex-1",children:l}),(0,se.jsx)("button",{type:"button",onClick:()=>i(null),className:"text-red-600 hover:text-red-800 flex-shrink-0",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"name",className:"font-base44 text-sm font-medium text-slate-900",children:"Name"}),(0,se.jsx)(Df,{id:"name",value:t.name,onChange:e=>r("name",e.target.value),placeholder:"Automation name",className:"h-10 rounded-lg border-slate-200",required:!0,disabled:n})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"description",className:"font-base44 text-sm font-medium text-slate-900",children:"Description"}),(0,se.jsx)(tN,{id:"description",value:t.description,onChange:e=>r("description",e.target.value),placeholder:"Describe what this automation does.",rows:3,className:"rounded-lg border-slate-200 resize-none",disabled:n})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(aN,{htmlFor:"function",className:"font-base44 text-sm font-medium text-slate-900",children:"Function to run"}),(0,se.jsx)(mp,{delayDuration:50,children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-slate-400 cursor-help"})}),(0,se.jsx)(pp,{side:"top",className:"max-w-[220px] rounded-md bg-[#171717] px-3 py-1.5 font-base44 text-white text-xs font-normal leading-[16px]",children:"Select a backend function from your code. The function will receive the entity data when the automation fires."})]})})]}),0===a.length?(0,se.jsx)(Df,{disabled:!0,value:"No backend functions available",className:"h-10 rounded-lg text-slate-500"}):(0,se.jsxs)(Wf,{value:t.function_name&&""!==t.function_name.trim()?t.function_name:void 0,onValueChange:e=>r("function_name",e),disabled:n,children:[(0,se.jsx)(Yf,{className:"h-10 rounded-lg border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Select a function"})}),(0,se.jsx)($f,{className:"rounded-lg",children:a.filter(e=>e&&""!==e.trim()).map(e=>(0,se.jsx)(Zf,{value:e,children:e},e))})]})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{className:"font-base44 text-sm font-medium text-slate-900",children:"Runs when"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"flex-1 min-w-0",children:0===s.length?(0,se.jsx)(Wf,{disabled:!0,children:(0,se.jsx)(Yf,{className:"h-10 rounded-lg border-slate-200",children:(0,se.jsx)(qf,{placeholder:"No items"})})}):(0,se.jsxs)(Wf,{value:t.entity_name&&""!==t.entity_name.trim()?t.entity_name:void 0,onValueChange:e=>r("entity_name",e),disabled:n,children:[(0,se.jsx)(Yf,{className:"h-10 rounded-lg border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Select item"})}),(0,se.jsx)($f,{className:"rounded-lg",children:s.filter(e=>e&&""!==e.trim()).map(e=>(0,se.jsx)(Zf,{value:e,children:e},e))})]})}),(0,se.jsx)("span",{className:"font-base44 text-sm font-normal text-slate-500 px-1 shrink-0",children:"Is"}),(0,se.jsx)("div",{className:"flex-1 min-w-0",children:(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,disabled:n,children:(0,se.jsxs)(Bx,{variant:"outline",className:"h-10 w-full justify-between rounded-lg border-slate-200 font-normal min-w-0 ".concat(n?"opacity-50 cursor-not-allowed":""),children:[(0,se.jsx)("span",{className:"truncate",children:t.event_types.length>0?t.event_types.map(e=>rB[e]).join(", "):"Select event"}),(0,se.jsx)(_t.A,{className:"h-4 w-4 shrink-0 opacity-50"})]})}),(0,se.jsx)(Aj,{align:"start",className:"w-[200px]",children:lB.map(e=>{const s=t.event_types.includes(e);return(0,se.jsxs)(Sj,{className:"flex items-center justify-between cursor-pointer",onClick:a=>{a.preventDefault();const n=s?t.event_types.filter(t=>t!==e):[...t.event_types,e];n.length>0&&r("event_types",n)},children:[(0,se.jsx)("span",{children:rB[e]}),s&&(0,se.jsx)(Ds.A,{className:"h-4 w-4"})]},e)})})]})})]})]})]})}function kB(e){return e.name.trim()?e.entity_name?e.event_types&&0!==e.event_types.length?e.function_name?null:"Please select a function to run.":"Please select at least one event type.":"Please select an entity.":"Automation name is required."}function CB(e){let{open:t,onOpenChange:s,automation:a,entityNames:n,backendFunctions:l,onSave:r,isSaving:i,logs:o,isLoadingLogs:c,onLoadLogs:d,defaultTab:u="details",initialFormData:m,onResolveWithAI:x,isResolvingWithAI:h=!1,onBack:p,contentOnly:g=!1}=e;const f=(0,Y.useMemo)(()=>({newTitle:"New data automation",detailsTabLabel:"Details",noLogsMessage:"Logs will appear here after this automation fires.",formId:"entity-automation-form",defaultFormData:nB,toFormData:QU,isFormSubmittable:e=>!!e.name&&!!e.entity_name&&!!e.function_name,validateForm:kB}),[]),v=(0,Y.useMemo)(()=>e=>(0,se.jsx)(_B,{formData:e.formData,entityNames:n,backendFunctions:e.backendFunctions,isArchived:e.isArchived,validationError:e.validationError,onFormDataChange:e.onFormDataChange,onValidationErrorChange:e.onValidationErrorChange,onSubmit:e.onSubmit}),[n]),b=(0,Y.useMemo)(()=>e=>(0,se.jsx)(xB,{log:e,renderContext:e=>(0,se.jsxs)(se.Fragment,{children:[e.entity_name," #",e.entity_id.slice(0,8),"..."]})}),[]);return(0,se.jsx)(mB,{open:t,onOpenChange:s,automation:a,backendFunctions:l,onSave:r,isSaving:i,logs:o,isLoadingLogs:c,onLoadLogs:d,defaultTab:u,initialFormData:m,onResolveWithAI:x,isResolvingWithAI:h,onBack:p,automationType:"entity",config:f,renderForm:v,renderLogItem:b,contentOnly:g})}vB.displayName="TimePicker";const AB=e=>{let{automation:t,isDeleting:s,onClose:a,onConfirm:n}=e;return(0,se.jsx)(NN,{open:!!t,onOpenChange:()=>a(),children:(0,se.jsxs)(kN,{children:[(0,se.jsxs)(CN,{children:[(0,se.jsx)(SN,{className:"font-base44 font-semibold",children:"Delete automation?"}),(0,se.jsxs)(EN,{className:"font-base44 font-normal",children:['This will permanently delete "',null==t?void 0:t.name,'" and all its execution history. This action cannot be undone.']})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{disabled:s,className:"font-base44 font-normal",children:"Cancel"}),(0,se.jsx)(TN,{onClick:n,disabled:s,className:"bg-red-600 hover:bg-red-700 font-base44 font-normal",children:s?"Deleting...":"Delete"})]})]})})},SB=e=>{let{open:t,onOpenChange:s,automation:a,onConfirm:n,isRunning:l}=e;const{getEntitiesSDK:r,onAppError:i}=lp(),[o,c]=(0,Y.useState)([]),[d,u]=(0,Y.useState)(""),[m,x]=(0,Y.useState)(""),[h,p]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{t&&null!=a&&a.entity_name&&(async()=>{if(null!=a&&a.entity_name){p(!0);try{const e=r(i),t=await e[a.entity_name].list(null,200);c(t||[])}catch(e){c([])}finally{p(!1)}}})()},[t,null==a?void 0:a.entity_name,r,i]),(0,Y.useEffect)(()=>{t||(u(""),x(""),c([]))},[t]);const g=(0,Y.useMemo)(()=>{if(!m.trim())return o;const e=m.toLowerCase();return o.filter(t=>Object.values(t).some(t=>"string"==typeof t&&t.toLowerCase().includes(e)))},[o,m]);return(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsxs)(Hg,{className:"sm:max-w-lg",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{className:"font-base44 font-semibold",children:"Run Automation"}),(0,se.jsxs)(Yg,{className:"font-base44 font-normal",children:["Select a ",(0,se.jsx)("span",{className:"font-normal",children:null==a?void 0:a.entity_name})," record to run the automation with."]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,se.jsx)(Df,{placeholder:"Search ".concat(null==a?void 0:a.entity_name," records..."),value:m,onChange:e=>x(e.target.value),className:"pl-9",disabled:h})]}),(0,se.jsx)("div",{className:"border rounded-lg overflow-hidden",children:h?(0,se.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin text-slate-400"})}):0===g.length?(0,se.jsx)("div",{className:"text-center py-12 px-4",children:(0,se.jsx)("p",{className:"font-base44 text-sm font-normal text-slate-500",children:0===o.length?"No ".concat(null==a?void 0:a.entity_name," records found."):'No records match "'.concat(m,'"')})}):(0,se.jsx)("div",{className:"max-h-[300px] overflow-y-auto",children:g.map(e=>{const{primary:t,secondary:s}=(e=>{let t="";t=e.name&&"string"==typeof e.name?e.name:e.title&&"string"==typeof e.title?e.title:e.email&&"string"==typeof e.email?e.email:"ID: ".concat(e.id.slice(0,8),"...");let s=null;return e.email&&"string"==typeof e.email&&e.name?s=e.email:e.description&&"string"==typeof e.description?s=e.description.length>50?e.description.slice(0,50)+"...":e.description:e.created_date&&(s="Created: ".concat(new Date(e.created_date).toLocaleDateString())),{primary:t,secondary:s}})(e),a=d===e.id;return(0,se.jsxs)("button",{type:"button",onClick:()=>u(e.id),className:de("w-full px-4 py-3 flex items-center gap-3 text-left border-b last:border-b-0 transition-colors",a?"bg-slate-100":"hover:bg-slate-50"),children:[(0,se.jsx)("div",{className:de("w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0",a?"border-slate-900 bg-slate-900":"border-slate-300"),children:a&&(0,se.jsx)(Ds.A,{className:"h-3 w-3 text-white"})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("p",{className:"font-base44 text-sm font-medium text-slate-900 truncate",children:t}),s&&(0,se.jsx)("p",{className:"font-base44 text-xs font-normal text-slate-500 truncate",children:s})]})]},e.id)})})}),!h&&o.length>0&&(0,se.jsx)("p",{className:"font-base44 text-xs font-normal text-slate-400 text-right",children:g.length===o.length?"".concat(o.length," records"):"".concat(g.length," of ").concat(o.length," records")})]}),(0,se.jsxs)(Wg,{className:"mt-2",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>s(!1),disabled:l,className:"font-base44 font-normal",children:"Cancel"}),(0,se.jsx)(Bx,{onClick:()=>{const e=o.find(e=>e.id===d);e&&n(d,e)},disabled:!d||l,className:"bg-slate-900 hover:bg-slate-800 font-base44 font-normal",children:l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Running..."]}):"Run Automation"})]})]})})},EB=e=>{let{icon:t,title:s,description:a,onClick:n}=e;return(0,se.jsxs)("button",{type:"button",onClick:n,className:"flex items-center gap-3 px-4 py-3 rounded-[10px] border border-[#e5e5e5] bg-white hover:bg-[#f5f5f5] transition-colors cursor-pointer text-left w-full",children:[(0,se.jsx)("div",{className:"shrink-0 size-6 flex items-center justify-center",children:t}),(0,se.jsxs)("div",{className:"flex flex-col gap-0.5 min-w-0 flex-1 pt-px",children:[(0,se.jsx)("span",{className:"font-base44 font-medium text-sm leading-none text-[#0a0a0a]",children:s}),(0,se.jsx)("span",{className:"font-base44 font-normal text-sm leading-5 text-[#737373]",children:a})]})]})},TB=e=>{let{onSelect:t,onClose:s}=e;return(0,se.jsxs)("div",{className:"flex flex-col p-6",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsxs)("div",{className:"flex items-start gap-6 w-full",children:[(0,se.jsx)("div",{className:"flex-1 min-w-0",children:(0,se.jsx)("h2",{className:"font-base44 text-lg font-bold leading-none text-black",children:"New Automation"})}),(0,se.jsx)("button",{onClick:s,className:"shrink-0 size-4 flex items-center justify-center opacity-70 hover:opacity-100 transition-opacity rounded-sm",children:(0,se.jsx)(la.A,{className:"size-4 text-[#0a0a0a]",strokeWidth:2})})]}),(0,se.jsx)("div",{})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4 mt-4",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,se.jsx)("span",{className:"font-base44 font-medium text-sm leading-none text-[#0a0a0a]",children:"Choose an automation"}),(0,se.jsx)("span",{className:"font-base44 font-normal text-sm leading-5 text-[#737373]",children:"Select how this automation will start."})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsx)(EB,{icon:(0,se.jsx)(jS.A,{className:"size-6 text-[#737373]",strokeWidth:1.5}),title:"Scheduled",description:"Run this automation on a recurring schedule or at a specific time.",onClick:()=>t("scheduled")}),(0,se.jsx)(EB,{icon:(0,se.jsx)(hT.A,{className:"size-6 text-[#737373]",strokeWidth:1.5}),title:"Data event",description:"Run this automation when a record is created, updated, or deleted.",onClick:()=>t("entity")})]})]})]})},IB=()=>{var e;const{app:t}=lp(),{user:s}=wd(),a=qu(),[n,l]=(0,Z.useSearchParams)(),r=(0,Y.useRef)(!1),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),{store:u,activeAutomations:m,archivedAutomations:x,backendFunctions:h,entityNames:p,logs:g,isLoading:f,isSaving:v,isDeleting:b,isLoadingLogs:j,runningTaskId:y,loadLogs:N,saveScheduledTask:w,saveEntityAutomation:_,toggleAutomation:k,deleteAutomation:C,archiveAutomation:A,runScheduledAutomation:S,runEntityAutomation:E,duplicateAutomation:T,getResolveWithAIContext:I}=eB(),P=u.useIsPanelOpen(),L=u.useSelectedAutomation(),M=u.usePanelDefaultTab(),R=u.usePanelMode(),D=u.useInitialFormData(),F=u.useDeleteAutomation();(0,Y.useEffect)(()=>{if(r.current||f||0===m.length&&0===x.length)return;const e=n.get("taskId"),t=n.get("panelTab");if(e){const s=m.find(t=>t.id===e),a=x.find(t=>t.id===e),i=s||a;if(i){a&&u.setActiveTab("archive");const e="logs"===t?"logs":"details";u.openPanel(i,e,null)}n.delete("taskId"),n.delete("panelTab"),l(n,{replace:!0}),r.current=!0}},[f,m,x,n,l,u]);const O=(0,Y.useCallback)(e=>{u.selectAutomationType(e)},[u]),U=(0,Y.useCallback)(()=>{u.backToTypeSelector()},[u]),B=(0,Y.useCallback)(async e=>{const t=L&&TU(L)?L:null;await w(e,t)},[L,w]),z=(0,Y.useCallback)(async e=>{const t=L&&IU(L)?L:null;await _(e,t)},[L,_]),H=(0,Y.useCallback)(async()=>{F&&await C(F)},[F,C]),V=(0,Y.useCallback)((e,t)=>{t&&t.stopPropagation(),TU(e)?S(e,t):IU(e)&&d(e)},[S]),W=(0,Y.useCallback)(async(e,t)=>{c&&(await E((0,ue.A)((0,ue.A)({},c),{},{automation_type:"entity"}),e,t),d(null))},[c,E]),q=(0,Y.useCallback)(async e=>{const t=e.id;o(t);try{const t=await I(e);if(!t)return;const s=LU(t);sessionStorage.setItem("pendingChatMessage",s),window.dispatchEvent(new CustomEvent("pendingChatMessage",{detail:{message:s,autoSend:!0}})),u.closePanel()}finally{o(e=>e===t?null:e)}},[I,u]),G=Bj(s),K=null!==(e=null==t?void 0:t.has_backend_functions_enabled)&&void 0!==e&&e,$=(0,Y.useMemo)(()=>G?K?0===h.length?"no-backend-functions":null:"backend-not-enabled":"not-builder-plus",[G,K,h]),J=()=>(0,se.jsxs)("span",{className:"inline-flex items-center gap-1 px-1.5 py-0 text-sm font-medium rounded-[6px] border border-white overflow-hidden",style:{background:"linear-gradient(85deg, rgba(255, 102, 0, 0.26) -70.38%, rgba(255, 222, 162, 0.18) 98.95%), #FFF",border:"1px solid #FFCBB4"},children:[(0,se.jsx)(ry.A,{className:"w-3 h-3 text-[#FF631F] shrink-0"}),(0,se.jsx)("span",{className:"text-[#FF631F] whitespace-nowrap",children:"Builder+"})]}),Q=G?"Automations":(0,se.jsxs)("span",{className:"inline-flex items-center gap-1.5",children:["Automations",(0,se.jsx)(J,{})]}),X="type-selector"===R,ee="create-scheduled"===R||"edit"===R&&L&&TU(L),te="create-entity"===R||"edit"===R&&L&&IU(L),ae=L&&TU(L)?L:null,ne=L&&IU(L)?L:null;return(0,se.jsxs)(lL,{title:Q,subtitle:"Build and manage automations in your app.",primaryAction:a&&!$?(0,se.jsx)(Bx,{size:"icon",variant:"default",onClick:()=>u.openTypeSelector(),className:"h-8 w-8",children:(0,se.jsx)(op.A,{className:"h-4 w-4"})}):void 0,className:"overflow-hidden",children:[(0,se.jsx)(uB,{store:u,activeAutomations:m,archivedAutomations:x,isLoading:f,runningTaskId:y,emptyStateType:$,onToggleAutomation:k,onRunNow:V,onArchiveAutomation:A,onDuplicateAutomation:T,onResolveWithAI:q,resolvingAutomationId:i}),(0,se.jsx)(Sy,{open:P,onOpenChange:e=>!e&&u.closePanel(),children:(0,se.jsx)(Ly,{side:a?"bottom":"right",className:a?"rounded-t-2xl h-[85vh] p-0 flex flex-col overflow-hidden":"w-[384px] sm:max-w-[384px] h-full p-0 flex flex-col overflow-hidden",children:(0,se.jsxs)(Mx.N,{mode:"wait",initial:!1,children:[X&&(0,se.jsx)(Rx.P.div,{initial:{x:-30,opacity:0},animate:{x:0,opacity:1},exit:{x:-30,opacity:0},transition:{duration:.12,ease:"easeOut"},className:"flex flex-col h-full",children:(0,se.jsx)(TB,{onSelect:O,onClose:()=>u.closePanel()})},"type-selector"),ee&&(0,se.jsx)(Rx.P.div,{initial:{x:30,opacity:0},animate:{x:0,opacity:1},exit:{x:30,opacity:0},transition:{duration:.12,ease:"easeOut"},className:"flex flex-col h-full",children:(0,se.jsx)(wB,{open:!0,onOpenChange:e=>!e&&u.closePanel(),automation:ae,backendFunctions:h,onSave:B,isSaving:v,logs:g,isLoadingLogs:j,onLoadLogs:e=>N((0,ue.A)((0,ue.A)({},e),{},{automation_type:"scheduled"})),defaultTab:M,initialFormData:D,onResolveWithAI:e=>q((0,ue.A)((0,ue.A)({},e),{},{automation_type:"scheduled"})),isResolvingWithAI:!!ae&&i===ae.id,onBack:ae?void 0:U,contentOnly:!0})},"scheduled-form"),te&&(0,se.jsx)(Rx.P.div,{initial:{x:30,opacity:0},animate:{x:0,opacity:1},exit:{x:30,opacity:0},transition:{duration:.12,ease:"easeOut"},className:"flex flex-col h-full",children:(0,se.jsx)(CB,{open:!0,onOpenChange:e=>!e&&u.closePanel(),automation:ne,entityNames:p,backendFunctions:h,onSave:z,isSaving:v,logs:g,isLoadingLogs:j,onLoadLogs:e=>N((0,ue.A)((0,ue.A)({},e),{},{automation_type:"entity"})),defaultTab:M,initialFormData:D,onResolveWithAI:e=>q((0,ue.A)((0,ue.A)({},e),{},{automation_type:"entity"})),isResolvingWithAI:!!ne&&i===ne.id,onBack:ne?void 0:U,contentOnly:!0})},"entity-form")]})})}),(0,se.jsx)(AB,{automation:F,isDeleting:b,onClose:()=>u.setDeleteAutomation(null),onConfirm:H}),(0,se.jsx)(SB,{open:!!c,onOpenChange:e=>{e||d(null)},automation:c,onConfirm:W,isRunning:y===(null==c?void 0:c.id)})]})};function PB(){return(0,se.jsx)(IB,{})}const LB=["domains","security","code","api","app-listing"],MB=e=>LB.includes(e),RB=e=>{let{featureName:t,onBack:s}=e;return(0,se.jsx)("div",{className:"flex flex-col items-center justify-center h-full w-full px-6",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-6 max-w-[320px] text-center",children:[(0,se.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,se.jsxs)("h1",{className:"text-2xl font-medium text-black leading-tight",children:["Managing ",t," isn't available on mobile"]}),(0,se.jsx)("p",{className:"text-sm text-black/80",children:"Please log in from a desktop browser"})]}),(0,se.jsx)(Bx,{onClick:s,size:"default",className:"bg-[#171717] hover:bg-[#2a2a2a] text-white shadow-sm",children:"Okay"})]})})},DB={domains:"domains",security:"security",code:"code",api:"API","app-listing":"templates"};function FB(){const{app:e}=lp(),{workspaceView:t}=(0,J.g)(),s=(0,J.Zp)(),a=qu(),n=HR(),{hasFlag:l}=ej(),r=l(aj),{isNativeMobile:i}=fd(),{pendingCount:o,refresh:c}=(()=>{const{app:e}=lp(),[t,s]=(0,Y.useState)(0),[a,n]=(0,Y.useState)(!1),l=(0,Y.useCallback)(async()=>{if(null!=e&&e.id){n(!0);try{const t=(await uM.listAccessRequests(e.id)).filter(e=>"pending"===e.status);s(t.length)}catch(t){s(0)}finally{n(!1)}}},[null==e?void 0:e.id]);return(0,Y.useEffect)(()=>{null!=e&&e.id&&l()},[null==e?void 0:e.id,l]),{pendingCount:t,isLoading:a,refresh:l}})();(0,Y.useEffect)(()=>{"users"===t&&c()},[t,c]);const[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{e&&e.id&&x(!0)},[e]);const h=t||"overview",p="code"===h,g=()=>{s("/apps/".concat(e.id,"/editor/workspace/overview")),u(!0)},f=()=>{if(!m)return(0,se.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 rounded-full border-t-transparent mx-auto mb-4"}),(0,se.jsx)("p",{className:"text-gray-500",children:"Loading app data..."})]})});if(a&&MB(h))return(0,se.jsx)(RB,{featureName:(t=h,DB[t]||t),onBack:g});var t;if(p)return(0,se.jsx)(nO,{});let s;if("overview"===h)s=(0,se.jsx)($D,{appId:e.id});else if("analytics"===h)s=(0,se.jsx)(PF,{appId:e.id});else if("domains"===h)s=(0,se.jsx)(UO,{appId:e.id,appName:e.name});else if("secrets"===h)s=(0,se.jsx)(nU,{appId:e.id});else if("security"===h)s=(0,se.jsx)(XO,{appId:e.id});else if(h.startsWith("trash-entity-")){const t=h.replace("trash-entity-",""),a=e.entities[t]||("User"===t?e.user_entity:null);s=a?(0,se.jsx)(wU,{entity:a}):null}else if(h.startsWith("entity-")){const t=h.split("entity-")[1],a=e.entities[t];s=a?(0,se.jsx)(lM,{entity:a}):null}else if("users"===h)s=(0,se.jsx)(LM,{appId:e.id});else if("app-settings"===h||"app-listing"===h)s=(0,se.jsx)(GR,{});else if("api"===h)s=(0,se.jsx)(RD,{appId:e.id});else if("logs"===h)s=(0,se.jsx)(ZD,{appId:e.id});else if("authentication"===h)s=(0,se.jsx)(sD,{});else if("app-connections"===h)s=(0,se.jsx)(PD,{});else if("agents"===h)s=(0,se.jsx)(fU,{});else{if("automations"!==h||!r)return(0,se.jsx)("div",{className:"p-6",children:"Unknown view"});s=(0,se.jsx)(PB,{})}return(0,se.jsx)("div",{className:"h-full w-full overflow-auto",children:s})},v=t=>{s("/apps/".concat(e.id,"/editor/workspace/").concat(t))};let b=[{id:"overview",label:"Overview",icon:"\u{1f4cb}"},{id:"users",label:"Users",icon:"\u{1f465}",badge:o>0?o:void 0},{id:"data",label:"Data",icon:"\u{1f5c4}\ufe0f",subitems:[...e&&e.entities?Object.keys(e.entities).map(e=>({id:"entity-".concat(e),label:e,icon:"\u{1f4c4}"})):[]]},{id:"analytics",label:"Analytics",icon:"\u{1f4c8}",badge:"Beta"},{id:"domains",label:"Domains",icon:"\u{1f310}"},{id:"app-connections",label:"Integrations",icon:"\u{1f50c}"},{id:"security",label:"Security",icon:"\u{1f512}"},{id:"code",label:"Code",icon:"\u{1f4bb}"},{id:"agents",label:"Agents",icon:"\u{1f916}"},{id:"automations",label:"Automations",icon:"\u26a1"},{id:"logs",label:"Logs",icon:"\u{1f50d}"},{id:"api",label:"API",icon:"\u{1f511}"},{id:"settings",label:"Settings",icon:"\u2699\ufe0f",subitems:[{id:"app-settings",label:"App Settings"},{id:"authentication",label:"Authentication"},{id:"app-listing",label:"App Template"}]}];e&&e.has_backend_functions_enabled&&b.push({id:"secrets",label:"Secrets",icon:"\u{1f511}"});let j=r?b:b.filter(e=>"automations"!==e.id);n&&(j=(e=>{const t=["code","security","app-connections"],s={settings:["app-listing"]};return e.filter(e=>!t.includes(e.id)).map(e=>{if(!e.subitems)return e;const t=s[e.id];return t?(0,ue.A)((0,ue.A)({},e),{},{subitems:e.subitems.filter(e=>!t.includes(e.id))}):e})})(j));const y=()=>{for(const e of j){if(e.id===h)return e.label;if(e.subitems){const t=e.subitems.find(e=>e.id===h);if(t)return t.label}}return h.startsWith("entity-")?h.replace("entity-",""):h.startsWith("trash-entity-")?"Trash: ".concat(h.replace("trash-entity-","")):"App Editor"};return p?(0,se.jsx)("div",{className:"h-full w-full relative",children:f()}):a?(0,se.jsxs)("div",{className:"h-full w-full flex flex-col",children:[(0,se.jsx)("div",{className:"w-full border-b",style:i?{background:wf}:void 0,children:(0,se.jsxs)("div",{className:de("mb-4 px-4 py-3 mx-[20px]",i?"mt-1":"mt-4","rounded-xl flex outline outline-1 outline-offset-[-1px] outline-[#D2D6D8]","items-center justify-between",i&&"bg-white"),onClick:()=>u(!0),children:[(0,se.jsx)("div",{className:"font-medium",children:y()}),(0,se.jsx)("button",{className:"rounded-md hover:bg-gray-100 transition-colors",children:(0,se.jsx)(_t.A,{size:20})})]})}),(0,se.jsx)(tL,{items:j,selected:h,onSelect:e=>{v(e),u(!1)},isOpen:d,onClose:()=>u(!1),title:"App Editor",showSearch:!1,variant:"sheet"}),(0,se.jsx)("div",{className:"flex-1 overflow-auto pb-20",children:f()})]}):(0,se.jsx)("div",{className:"h-full w-full relative",children:(0,se.jsxs)(ZF,{direction:"horizontal",children:[(0,se.jsx)(JF,{defaultSize:25,minSize:15,maxSize:30,className:"h-full overflow-hidden",children:(0,se.jsx)(tL,{items:j,selected:h,onSelect:e=>{v(e),u(!1)},isOpen:d,onClose:()=>u(!1),title:"App Editor",showSearch:!1,variant:"drawer"})}),(0,se.jsx)(QF,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,se.jsx)(JF,{defaultSize:75,className:"flex-1 overflow-auto",children:f()})]})})}const OB=["onBack","checkpointId","useSandbox"],UB=e=>{var t;let{onBack:s,checkpointId:a,useSandbox:n}=e,l=(0,Nt.A)(e,OB);const[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(""),{loading:d,error:u,fetchedFileTree:m}=(e=>{let{checkpointId:t,useSandbox:s,enabled:a}=e;const{app:n}=lp(),[l,r]=(0,Y.useState)(a),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null);return(0,Y.useEffect)(()=>{a&&s&&(async()=>{try{r(!0),o(null);const e=await Gu.getAppFiles(n.id);d({files:e,file_errors:{}}),r(!1)}catch(e){o("Failed to load checkpoint code"),r(!1)}})()},[s,t,n.id]),(0,Y.useEffect)(()=>{a&&!s&&t&&(async()=>{try{r(!0),o(null);const e=await Zu.getCheckpointFileTree(n.id,t);d(e),r(!1)}catch(e){o("Failed to load checkpoint code"),r(!1)}})()},[s,t,n.id]),{loading:l,error:i,fetchedFileTree:c}})({checkpointId:a,useSandbox:n,enabled:!l.fileTree}),[x,h,p,g]=l.fileTree?[l.selectedFile,l.setSelectedFile,l.fileContent,l.setFileContent]:[r,i,o,c],f=null!==(t=l.fileTree)&&void 0!==t?t:m,v=e=>"object"==typeof e?JSON.stringify(e,null,2):e||"";(0,Y.useEffect)(()=>{f&&x&&x in f.files&&g(v(f.files[x]))},[f,x]);const b=Qy(x||"");if(d)return(0,se.jsx)("div",{className:"h-full flex items-center justify-center bg-white","data-testid":"loading-state",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}),(0,se.jsx)("div",{className:"text-slate-500",children:"Loading checkpoint code..."})]})});if(u)return(0,se.jsxs)("div",{className:"h-full flex flex-col items-center justify-center bg-white","data-testid":"error-state",children:[(0,se.jsx)("div",{className:"text-red-500 mb-4",children:u}),(0,se.jsx)("button",{onClick:s,className:"px-4 py-2 border border-slate-200 rounded-md hover:bg-slate-50",children:"Back to Preview"})]});const j=(()=>{if(!f||!f.files)return{pages:{},components:{},entities:{},functions:{},agents:{},layout:null,globals_css:null,has_backend_functions_enabled:!1};const e={pages:{},components:{},entities:{},functions:{},agents:{},layout:null,globals_css:null,has_backend_functions_enabled:!1};return Object.entries(f.files).forEach(t=>{let[s,a]=t;const n=Qh(s);if(n.startsWith("pages/"))e.pages[n.substring(6)]=a;else if(n.startsWith("components/"))e.components[n.substring(11)]=a;else if(n.startsWith("entities/")){const t="object"==typeof a?JSON.stringify(a,null,2):a;e.entities[n.substring(9)]=t}else if(n.startsWith("functions/"))e.functions[n.substring(10)]=a,e.has_backend_functions_enabled=!0;else if(n.startsWith("agents/")){const t="object"==typeof a?JSON.stringify(a,null,2):a;e.agents[n.substring(7)]=t}else Xh(s)?e.layout=a:"globals.css"===n.toLowerCase()&&(e.globals_css=a)}),e})();(null==f?void 0:f.files)&&Object.keys(f.files).length;return(0,se.jsx)("div",{className:"h-full w-full bg-white","data-testid":"checkpoint-code-view",children:(0,se.jsxs)(MP,{direction:"horizontal",className:"",children:[(0,se.jsx)(RP,{defaultSize:25,minSize:20,maxSize:40,className:"h-full overflow-hidden",children:(0,se.jsx)(qF,{selectedFile:x,onFileSelect:(e,t)=>{null!=f&&f.files&&e in f.files&&(h(e),g(v(f.files[e])))},onBack:s,app:j,sandboxFiles:null==f?void 0:f.files,readOnly:!0,backButtonText:"Back to Preview",title:"Checkpoint Files",showEmptyMessage:!0,emptyMessage:(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"mb-2",children:"This checkpoint appears to be empty."}),(0,se.jsx)("div",{className:"text-xs",children:"No code files found."})]})})}),(0,se.jsx)(DP,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,se.jsx)(RP,{defaultSize:75,className:"flex-1 overflow-x-auto",children:x?(0,se.jsxs)("div",{className:"h-full relative","data-testid":"code-editor-container",children:[(0,se.jsxs)("div",{className:"absolute top-0 left-0 right-0 bg-slate-50 border-b border-slate-200 px-4 py-2 z-10",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-700","data-testid":"selected-file-name",children:x}),(0,se.jsx)("div",{className:"text-xs text-slate-500 mt-0.5",children:"Read-only view"})]}),(0,se.jsx)("div",{className:"h-full pt-14",children:(0,se.jsx)(pb.KE,{language:b,value:p,options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,lineNumbers:"on",renderLineHighlight:"none",occurrencesHighlight:"off",selectionHighlight:!1,wordWrap:"on"},theme:"vs-light"})})]}):(0,se.jsx)("div",{className:"h-full flex items-center justify-center text-slate-500","data-testid":"no-file-selected",children:"Select a file to view code"})})]})})},BB=e=>{let{onBack:t}=e;const{filesTreeState:s}=Tx(),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)("");return s.filesTreeIsLoading?(0,se.jsx)("div",{className:"h-full flex items-center justify-center bg-white","data-testid":"loading-state",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}),(0,se.jsx)("div",{className:"text-slate-500",children:"Loading checkpoint code..."})]})}):s.filesTreeError?(0,se.jsxs)("div",{className:"h-full flex flex-col items-center justify-center bg-white","data-testid":"error-state",children:[(0,se.jsx)("div",{className:"text-red-500 mb-4",children:"Error fetching files"}),(0,se.jsx)("button",{onClick:t,className:"px-4 py-2 border border-slate-200 rounded-md hover:bg-slate-50",children:"Back to Preview"})]}):(0,se.jsx)(UB,{onBack:t,fileTree:s.filesTree,selectedFile:a,setSelectedFile:n,fileContent:l,setFileContent:r})},zB={"#130":"Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: %s. This often happens due to incorrect import/export statements. Check default vs named exports.","#310":"Rendered more hooks than during the previous render. Never call hooks inside conditionals/loops/early returns. Hooks must be called in the same order every render.","#31":"Objects are not valid as a React child. If you meant to render a collection of children, use an array instead.","#185":"Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.","#300":"Cannot update a component while rendering a different component. To locate the bad setState() call, follow the stack trace.","#301":"Rendered fewer hooks than expected. This may be caused by an accidental early return statement.","#181":"Invalid hook call. Hooks can only be called inside of the body of a function component. Check for: 1) Mismatching versions of React and React DOM, 2) Breaking the Rules of Hooks, 3) Multiple copies of React.","#321":"Invalid argument passed as callback. Expected a function. Instead received: %s.","#60":"ReactDOM.render(): Invalid component element. Instead of passing a string like 'div', pass React.createElement('div').","#62":"The root container is not a DOM element."},HB=e=>{const t=(e=>{if(e.title&&e.title.includes("Minified React error"))for(const[t,s]of Object.entries(zB))if(e.title.includes("Minified React error ".concat(t)))return(0,ue.A)((0,ue.A)({},e),{},{details:s});return e})(e),s=dc().escape(t.title),a=dc().escape(t.details||"no details"),n=dc().escape(t.stack||"");let l='\n\n<error title="'.concat(s,'" details="').concat(a,'"');return n&&(l+=' stack="'.concat(n,'"')),l+="></error>",l+"\n\n"},VB=()=>{var e,t,s,a;const{app:n,appErrors:l,setAppErrors:r,addChatMessage:i}=lp(),o=Ix("ready"===(null===(e=n.status)||void 0===e?void 0:e.state),1e3)&&"ready"===(null===(t=n.status)||void 0===t?void 0:t.state),c=uh(),{user:d}=wd(),u=qu(),[m,x]=(0,Y.useState)(!1),h=Tx(e=>e.selectedCheckpoint),p=(0,Y.useRef)(!1);if((0,Y.useEffect)(()=>{l.length>0&&"ready"===n.app_stage&&!p.current?(Tu("Resolve with AI Displayed",(0,ue.A)((0,ue.A)({},c),{},{app_name:n.name})),p.current=!0):0===l.length&&(p.current=!1)},[l.length,n.app_stage,n.id,n.name,c]),0===l.length||"ready"!==n.app_stage)return null;const g=null!=h||!o,f=async()=>{x(!0);const e=l.map(e=>HB(e)).join("\n\n"),t="the following errors happened in the app:\n".concat(e,"\n---\nplease help me fix these errors");(async e=>{try{Tu("User clicked resolve with AI",(0,ue.A)((0,ue.A)({},c),{},{app_name:n.name,error_message:e})),Vu((0,ue.A)({},c),{cta:"resolve with ai",origin:"editor",target_route:"same_page",error_message:e})}catch(t){}})(t),await i({role:"user",content:t,additional_message_params:{resolve_with_ai_errors:l.length}}),r([]),x(!1)};return(0,se.jsx)("div",{className:de("fixed bottom-4 right-4 z-50 max-w-md bg-white rounded-lg shadow-xl p-4 border border-gray-100",{"bottom-2 right-2 left-2 z-50 max-w-full":u}),children:(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("div",{className:"font-medium text-gray-800",children:"Issues Found"}),(0,se.jsx)("button",{onClick:()=>r([]),className:"p-1 hover:bg-gray-100 rounded-md",children:(0,se.jsx)(la.A,{size:16})})]}),l.map(e=>(0,se.jsxs)("div",{className:"text-sm text-gray-600",children:[e.componentName&&(0,se.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["In ",e.componentName," component:"]}),e.title]},e.title)),!g&&(0,se.jsx)("button",{onClick:()=>f(),disabled:"processing"===(null===(s=n.status)||void 0===s?void 0:s.state)||m,className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white text-sm rounded-md transition-colors mt-2 flex items-center justify-center gap-2 ".concat("processing"===(null===(a=n.status)||void 0===a?void 0:a.state)||m?"opacity-50 cursor-not-allowed":""),children:m?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{size:16,className:"animate-spin"}),"Resolving..."]}):"Resolve with AI"}),!g&&"free"!==d.subscription_tier&&(0,se.jsx)("div",{className:"text-xs text-gray-500 mt-1 italic",children:"This action won't deduct credits from your account."})]})})},WB=e=>{var t;let{className:s}=e;const[a,n]=(0,Y.useState)(""),l=null===(t=Ix((null==a?void 0:a.length)>2?a:"",700))||void 0===t?void 0:t.toLowerCase(),[r,i]=(0,Y.useState)(!1),o=kh.useIsLoading(),c=kh.useViewAsUser(),d=kh.useCanViewAsGuest(),u=kh.isViewingAsGuest(),m=kh.isViewingAsDefault(),x=kh.useUsersCount(),{user:h}=wd(),{dataEnv:p}=lp();kh.useViewingAsUser();return(0,se.jsxs)(GL,{className:de("pointer-events-auto flex flex-col sm:flex-row items-center w-full bg-[#2563EB] pl-3 pr-1.5 py-1.5 gap-6 ",s),children:[(0,se.jsxs)(GL.Left,{className:"flex flex-1 items-center overflow-visible",children:[(0,se.jsxs)(GL.Item,{className:"flex items-center gap-2",children:[(0,se.jsx)(ay.A,{size:16,className:" text-[#F5F5F5]"}),(0,se.jsx)("span",{className:"text-sm font-medium text-white whitespace-nowrap",children:c?"You're acting as":"Act as"})]}),(0,se.jsx)(GL.Item,{children:(0,se.jsxs)(Nj,{open:r,onOpenChange:i,children:[(0,se.jsx)(wj,{asChild:!0,className:"flex-1 gap-2 bg-transparent hover:bg-white/40 border-white px-3 max-w-[250px] justify-start ",children:(0,se.jsxs)(Bx,{variant:"ghost",className:"gap-2 bg-white/30 hover:bg-white/40 border-0 rounded-lg px-3 py-1 h-8 max-w-[250px] justify-start",children:[(0,se.jsx)("span",{className:"text-sm font-medium truncate flex-1 text-left text-white",children:(e=>{var t,s,a;const n=null!==(t=null!==(s=null!==(a=null==e?void 0:e.email)&&void 0!==a?a:null==e?void 0:e.full_name)&&void 0!==s?s:null==e?void 0:e.name)&&void 0!==t?t:"View as",l=n===(null==h?void 0:h.email)?"you":null==e?void 0:e.role;return"".concat(n," ").concat(l?"(".concat(l,")"):"")})(c)}),(0,se.jsx)(_t.A,{className:"h-4 w-4 flex-shrink-0 text-white"})]})}),(0,se.jsxs)(Aj,{align:"start",className:"min-w-64 view-as-dropdown p-2 pb-1 gap-2 flex flex-col rounded-lg border border-gray-200 font-base44 max-w-[250px] ",onMouseLeave:()=>{i(!1)},children:[x>0&&(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,se.jsx)(Df,{type:"text",placeholder:"Search for a specific user",value:a,onChange:e=>n(e.target.value),className:"pl-9 pr-3 text-sm h-9 w-full rounded-lg border border-gray-200",onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation()})]})}),(0,se.jsxs)("div",{className:"flex flex-1 flex-col  scrollbar-hide min-h-0 gap-2 px-1",children:[(0,se.jsxs)("div",{className:"flex flex-row gap-2",children:[d&&(0,se.jsxs)(Bx,{variant:"outline",size:"tiny",disabled:o,className:de("h-7 font-normal",{"bg-muted":u}),onClick:()=>{kh.viewAsGuest(),i(!1)},children:[(0,se.jsx)("span",{className:"text-sm text-gray-900 col-max-auto truncate",children:"Anonymous Guest"}),u&&(0,se.jsx)(Ds.A,{className:"col-min-auto"})]}),(null==h?void 0:h.email)&&(0,se.jsxs)(Bx,{variant:"outline",size:"tiny",disabled:o,className:de("h-7 font-normal",{"bg-muted":m}),onClick:()=>{kh.viewAsDefault(),i(!1)},children:[(0,se.jsx)("span",{className:"text-sm text-gray-900 col-max-auto truncate",children:"You"}),m&&(0,se.jsx)(Ds.A,{className:"col-min-auto"})]})]}),(0,se.jsx)(Tj,{className:"my-0"}),(0,se.jsx)(qB,{searchTerm:l,onInviteClick:()=>{dS.openModal("InviteUser"),i(!1)},onSelectUser:()=>{i(!1)}}),(0,se.jsx)(Tj,{className:"my-0"})]}),(0,se.jsx)("div",{className:"flex-shrink-0 max-w-[250px]",children:(0,se.jsxs)("div",{className:"flex items-start gap-2 bg-amber-100 rounded-lg px-3 py-2",children:[(0,se.jsx)("div",{className:"pt-0.5 flex-shrink-0",children:(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-gray-900"})}),(0,se.jsx)("p",{className:"text-sm leading-5 text-gray-900 font-medium ",children:"Any change you make will reflect in user data."})]})})]})]})}),(0,se.jsx)(GL.Item,{hidden:!c||u||m||"dev"===p,children:(0,se.jsx)("span",{className:"text-sm font-medium text-white  overflow-x-hidden truncate",children:"- be careful, changes here affect this user"})})]}),(0,se.jsx)(GL.Right,{children:(0,se.jsx)(GL.Item,{children:(0,se.jsxs)(Bx,{variant:"outline",size:"tiny",className:"gap-2 bg-transparent hover:bg-white/40 border-white px-3 max-w-[400px] justify-start",onClick:()=>{kh.exitViewAsMode()},children:[(0,se.jsx)("span",{className:"text-sm font-normal text-white",children:"Exit mode"}),(0,se.jsx)(la.A,{className:"h-4 w-4 text-white"})]})})})]})},qB=e=>{let{searchTerm:t,onSelectUser:s,onInviteClick:a}=e;const{app:n}=lp(),l=kh.useViewAsUser(),r=kh.useUsersCount(),i=kh.useUsers(t),o=i.length;switch(!0){case 0===r:return(0,se.jsxs)("div",{className:"flex flex-col w-full items-center text-center justify-center font-base44 my-6",children:[(0,se.jsx)("span",{className:"text-sm font-medium",children:"You don't have any users yet"}),(0,se.jsx)("span",{className:"text-sm text-gray-500 mb-4",children:"Add or invite users to see how your app works for them"}),(0,se.jsx)(Bx,{variant:"outline",size:"tiny",onClick:a,children:"Invite"})]});case o>0:return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"text-sm font-medium text-gray-900 ",children:["Users (",i.length,")"]}),(0,se.jsx)("div",{className:"flex flex-col gap-1 max-h-[264px] overflow-y-auto max-w-[250px] overflow-x-hidden ",children:i.map(e=>{var a;return(0,se.jsx)(YB,{usr:e,searchTerm:t,suffix:"admin"===(null===(a=e.role)||void 0===a?void 0:a.toLowerCase())?"admin":void 0,isSelected:l.email===e.email,onSelect:()=>{kh.selectUserToView(n.id,e.email),null==s||s(e)}})})})]});default:return(0,se.jsxs)("div",{className:"flex flex-col w-full items-center justify-center font-base44 my-6",children:[(0,se.jsx)("span",{className:"text-sm font-medium",children:"No matching users found"}),(0,se.jsx)("span",{className:"text-sm text-gray-500",children:"Try searching by name or role"})]})}},YB=e=>{var t;let{onSelect:s,usr:a,isSelected:n,suffix:l,searchTerm:r}=e;const i=kh.useIsLoading(),{email:o}=a,c=kh.findInUser(a,r),d=null!=c&&null!==(t=c.field)&&void 0!==t&&t.length&&"email"!==c.field?c.field.replace("_"," "):null,{onUserSelected:u}=kh.useBiEvents();return(0,se.jsxs)(Bx,{variant:"ghost",disabled:i,onClick:()=>{s(),u({email:o,matchValue:null==c?void 0:c.value,matchField:null==c?void 0:c.field})},className:"flex flex-col items-start gap-0 px-2",children:[(0,se.jsxs)("div",{className:"grid gap-2 font-normal w-full",style:{gridTemplateColumns:"auto 1fr auto"},children:[(0,se.jsx)("span",{className:"text-sm text-gray-900 col-max-auto truncate",children:GB(o,r)}),l&&(0,se.jsxs)("span",{className:"col-min-auto justify-self-start text-sm text-gray-500",children:["(",l,")"]}),n&&(0,se.jsx)(Ds.A,{className:"col-min-auto justify-self-end"})]}),(null==d?void 0:d.length)&&(0,se.jsxs)("div",{className:"text-xs font-thin text-gray-500",children:[d,": ",GB(c.value,r)]})]},"default-user")};function GB(e,t,s){if(null==t||!t.length)return e;const a=null!=s?s:e=>(0,se.jsx)("span",(0,ue.A)({className:"font-bold text-black"},e)),n=new RegExp("(".concat(t,")"),"gi");return e.split(n).map((e,t)=>n.test(e)?(0,se.jsx)(a,{children:e},t):e)}var KB=s(40591);const $B=e=>{let{}=e;const{app:t,pageNames:s}=lp(),{pageName:a}=(0,J.g)(),n=(0,J.Zp)(),l=Array.from(null!=s?s:[]),r=l.find(e=>e.toLowerCase()===(null==a?void 0:a.toLowerCase()))||l.find(e=>{var s;return e.toLowerCase()===(null===(s=t.main_page)||void 0===s?void 0:s.toLowerCase())})||l[0];return(0,se.jsx)("div",{className:"flex items-center",children:(0,se.jsxs)(Wf,{value:r,onValueChange:e=>{dm.isVisualEditMode=!1,n("/apps/".concat(t.id,"/editor/preview/").concat(e)),Wu.navigatePreview(e)},children:[(0,se.jsx)(Yf,{advancedDropdown:1===l.length,className:"h-full px-0 w-[160px] text-xs border-0 focus:ring-0 focus:ring-offset-0 ml-[2px]",children:(0,se.jsx)("div",{className:"flex  gap-2 text-[14px] overflow-hidden ml-1",children:(0,se.jsx)(qf,{placeholder:"Select page",className:"truncate"})})}),(0,se.jsx)($f,{className:"max-h-[360px] overflow-y-auto group","data-theme":"white",children:l.map(e=>(0,se.jsx)(Zf,{value:e,className:"text-[14px] [&>span:first-child]:hidden",children:(0,se.jsx)("div",{className:"flex items-center gap-2 font-base44 font-light text-[14px] cursor-pointer overflow-hidden ",children:(0,se.jsx)("span",{className:"truncate",children:e})})},e))})]})})},ZB=()=>(0,se.jsx)(Bx,{variant:"ghost",size:"xTiny",onClick:Wu.refreshPreview,"aria-label":"Refresh preview",children:(0,se.jsx)(Fx.A,{size:16,"aria-hidden":"true"})});var JB=s(14664),QB=s(24425);const XB=()=>{const{isPhoneMode:e}=dm.usePick("isPhoneMode");return(0,se.jsx)(Bx,{variant:"ghost",size:"xTiny",onClick:dm.togglePhoneMode,"aria-label":e?"Switch to desktop view":"Switch to mobile view",children:e?(0,se.jsx)(JB.A,{size:16,"aria-hidden":"true"}):(0,se.jsx)(QB.A,{size:16,"aria-hidden":"true"})})},ez=()=>{const{isPhoneMode:e,isSelectElementMode:t}=dm.usePick("isPhoneMode","isSelectElementMode");return(0,se.jsx)("div",{className:"flex items-center justify-between px-3 py-1.5 bg-white border-b border-slate-200 shrink-0",children:(0,se.jsx)(GL,{className:"overflow-hidden h-[32px] rounded-lg py-0 px-1 border border-slate-200 shadow-xs",theme:"white",children:(0,se.jsxs)(GL.Left,{children:[(0,se.jsx)(GL.Item,{children:(0,se.jsx)($B,{})}),(0,se.jsx)(GL.Separator,{}),(0,se.jsx)(GL.Item,{tooltip:e?"Switch to desktop view":"Switch to mobile view",children:(0,se.jsx)(XB,{})}),(0,se.jsx)(GL.Item,{tooltip:"Refresh",children:(0,se.jsx)(ZB,{})}),(0,se.jsx)(GL.Separator,{}),(0,se.jsx)(GL.Item,{tooltip:t?"Cancel Selection":"Select Element",children:(0,se.jsx)("button",{onClick:()=>{const e=!t;dm.isSelectElementMode=e;document.getElementById("preview-iframe"),Wu.postMessageToPreview({type:"toggle-visual-edit-mode",data:{enabled:e}},{log:!0});e||Wu.postMessageToPreview({type:"unselect-element"})},className:de("flex items-center justify-center w-6 h-6 rounded-md transition-colors",t?"bg-blue-50 text-blue-600 hover:bg-gray-100":"text-black hover:bg-slate-100"),children:(0,se.jsx)(KB.A,{className:"w-4 h-4"})})})]})})})};function tz(){const{selectedCheckpoint:e,canUseSandboxPreview:t,isLoading:s}=Tx(),{app:a,isLoading:n}=lp(),l=(0,J.Zp)(),r=Ku(),i=dm.useCodeViewVisible(),o=dm.useIsPhoneMode(),c=dm.useIsSplitScreenMode(),d=dm.useView(),u=jh.useIsGeneratingInitialPrompt(),m=kh.useShowViewAsToolbar()&&"preview"===d,x=(()=>{const{app:e}=lp(),t=dm.useIsVisualEditMode(),s=dm.useIsSplitScreenMode(),{selectedCheckpoint:a}=Tx(),n=(0,Y.useRef)(!0),l=(0,Y.useRef)(null==e?void 0:e.last_git_commit_hash),r=null!=(null==e?void 0:e.last_git_commit_hash)&&e.last_git_commit_hash!==l.current,i=Boolean(null==a?void 0:a.id)||n.current&&!r&&!t&&!s;return n.current=i,i})(),h=dS.useIsOpen("AddEventDrawer"),{initialSyncState:p,initialSyncError:g}=kx.usePick("initialSyncState","initialSyncError"),f=Boolean(null==a?void 0:a.connected_to_github)&&"complete"!==p,v=n||!a;(()=>{const{app:e,onAppError:t}=lp(),s=Ku(),a=(0,J.Zp)(),n=uo(),l=(0,Y.useCallback)(l=>{var r,i;if("app_error"===(null===(r=l.data)||void 0===r?void 0:r.type)&&l.data.error&&t(l.data.error.title,l.data.error.details,l.data.error.componentName,l.data.error.stack),"app_changed_url"===(null===(i=l.data)||void 0===i?void 0:i.type)&&l.data.url&&window.location.href.includes("/preview")){const t=new URL(l.data.url),r=t.pathname,i=new URLSearchParams(t.search);i.delete("access_token"),i.delete("hide_badge"),i.delete("server_url"),i.delete("base44_data_env"),i.delete("analytics-enable");let c=r;if(s){if(r.startsWith("/apps")){const t=r.split("/");if(t.length>3){const s=t[3];c="/apps/".concat(e.id,"/editor/preview/").concat(null!=s?s:"")}else c="/apps/".concat(e.id,"/editor/preview")}else if("/"===r||""===r)c="/apps/".concat(e.id,"/editor/preview");else{const t=r.startsWith("/")?r.slice(1):r;c="/apps/".concat(e.id,"/editor/preview/").concat(null!=t?t:"")}i.toString()&&(c+="?"+i.toString()),window.history.replaceState(null,"",c)}else{if(r.startsWith("/apps"))return c="/"+r.split("/").pop(),c.includes("".concat(e.slug))?void 0:void a("/apps/".concat(e.id,"/editor/preview").concat(c));var o;"/"===r||r==="/".concat(e.slug)?c="/apps/".concat(e.id,"/editor/preview/").concat(null!==(o=e.main_page)&&void 0!==o?o:""):r.startsWith("/apps")||r.includes("".concat(e.slug))||(c="/apps/".concat(e.id,"/editor/preview").concat(null!=r?r:""));const t=i.toString();t&&(c+="?".concat(t)),n||a(c)}}},[t,a,n,e.slug,e.id,e.main_page,s]);(0,Y.useEffect)(()=>(window.addEventListener("message",l),()=>window.removeEventListener("message",l)),[l])})(),(0,Y.useEffect)(()=>{e&&"workspace"===d.toLowerCase()&&!s&&l("/apps/".concat(a.id,"/editor/preview"))},[e,s]);const b="workspace"===d&&!u,j="preview"===d&&!u&&e&&i,y=!("preview"!==d||u||r&&t||j||f),N="preview"===d&&x&&!y&&!i,w=j||b||u||y||f||N;return(0,Y.useEffect)(()=>{switch(!0){case N:Wu.activePreviewName=Dh;break;case y||!r:Wu.activePreviewName=Oh;break;case r:Wu.activePreviewName=Th;break;default:Wu.activePreviewName=Dh}},[y,N,r]),(0,se.jsxs)("div",{className:de("flex flex-col h-full",{"border-x-8 border-b-8 border-[#2563EB] bg-[#2563EB]":m}),children:[m&&(0,se.jsx)(WB,{}),(0,se.jsxs)("div",{className:de("flex-grow h-full overflow-y-auto relative",{"rounded-[10px]":m}),children:[m&&(0,se.jsx)("div",{className:"absolute flex w-full h-full bg-slate-100"}),!v&&(u||f)&&!b&&(0,se.jsx)(bh,{loadingState:u?"building":"preparing"}),!v&&!u&&!b&&!y&&!j&&!c&&(0,se.jsx)(vh,{}),!v&&!f&&r&&(0,se.jsx)("div",{className:de("absolute inset-0",c&&"p-2",{hidden:w&&!c}),children:(0,se.jsxs)(MP,{direction:"horizontal",className:"h-full",children:[c&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(RP,{id:"ide-panel",order:1,defaultSize:50,minSize:25,children:(0,se.jsx)("div",{className:"h-full mr-1 rounded-xl shadow-sm bg-white overflow-hidden border border-slate-200",children:(0,se.jsx)(nO,{})})}),(0,se.jsx)(DP,{withHandle:!0,className:"bg-transparent"})]}),(0,se.jsx)(RP,{id:"preview-panel",order:2,defaultSize:c?50:100,minSize:c?22:100,children:(0,se.jsxs)("div",{className:de("h-full flex flex-col overflow-hidden",c&&"ml-1 rounded-xl border border-slate-200 bg-white shadow-sm"),children:[c&&(0,se.jsx)(ez,{}),(0,se.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,se.jsx)(Ih,{isPhoneMode:o})})]})})]})}),(0,se.jsx)(Fh,{isPhoneMode:o,className:de({hidden:!N})}),y&&!c&&(0,se.jsx)("div",{className:"w-full h-full flex justify-center ".concat(o?"items-start pt-4":""),children:(0,se.jsx)(Uh,{isPhoneMode:o,view:d})}),b&&!c&&(0,se.jsxs)("div",{className:de("flex flex-1 w-full h-full",{"blur-[1px] pointer-events-none relative":h}),children:[h&&(0,se.jsx)("div",{className:"absolute inset-0 bg-black/20  z-10"}),(0,se.jsx)(FB,{})]}),j&&!c&&(0,se.jsx)(BB,{onBack:()=>dm.codeViewVisible=!1}),(0,se.jsx)(VB,{})]})]})}const sz=e=>{let{}=e;const{app:t}=lp(),{codeViewVisible:s,isCheckpointCodeViewAvailable:a,isCheckpointPreviewBuilding:n}=dm.usePick("codeViewVisible","isCheckpointCodeViewAvailable","isCheckpointPreviewBuilding"),{selectedCheckpoint:l,isSyncingSandboxCheckpoint:r,setSelectedCheckpoint:i,isRestoring:o,isLoading:c}=Tx("selectedCheckpoint","isSyncingSandboxCheckpoint","setSelectedCheckpoint","isLoading","isRestoring"),d=vy.useIsPublishing();if(!l)return null;const u=r||c||d;return(0,se.jsxs)(GL,{children:[(0,se.jsx)(GL.Left,{children:(0,se.jsx)(GL.Item,{children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-2 h-2 bg-orange-400 rounded-full"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-800",children:"Viewing Version History"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:l.name})]})]})})}),(0,se.jsxs)(GL.Right,{children:[(0,se.jsx)(GL.Item,{tooltip:a?void 0:n?"Build in progress...":"Retry build to enable this view",children:(0,se.jsxs)(Bx,{variant:"outline",size:"sm",className:"h-8 text-xs",onClick:()=>dm.codeViewVisible=!dm.codeViewVisible,disabled:!a,children:[(0,se.jsx)(Jv.A,{className:"w-3 h-3 mr-2"}),s?"View App":"View Code"]})}),(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Bx,{variant:"outline",size:"sm",className:"h-8 text-xs",onClick:()=>dS.openModal("RestoreVersionModal",{checkpoint:l}),disabled:u,children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(UP.A,{className:"mr-2 h-3 w-3 animate-spin"}),"Restoring..."]}):"Restore This Version"})}),(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Bx,{variant:"default",size:"sm",className:"h-8 text-xs bg-gray-900 hover:bg-gray-800 text-white",onClick:()=>{dS.openModal("PublishVersionModal",{checkpoint:l})},disabled:u,children:d?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-3 w-3 animate-spin"}),"Publishing..."]}):"Publish This Version"})}),(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-8 text-xs text-slate-600",onClick:()=>{i(void 0),dm.codeViewVisible=!1},disabled:u,children:"Exit"})})]})]})};var az=s(53980);const nz=()=>{const{isLeftPanelHidden:e}=dm.usePick("isLeftPanelHidden");return(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",onClick:dm.toggleLeftPanel,"aria-label":e?"Show chat panel":"Hide chat panel",children:e?(0,se.jsx)(az.A,{size:16,"aria-hidden":"true"}):(0,se.jsx)(WF.A,{size:16,"aria-hidden":"true"})})},lz=()=>{const{view:e,isSplitScreenMode:t}=dm.usePick("view","isSplitScreenMode"),{handleViewChange:s}=(()=>{const e=(0,J.Zp)(),t=(0,J.zy)(),{app:s}=lp(),a=dm.useLastWorkspaceLocation();return(0,Y.useEffect)(()=>{if(t.pathname.includes("/workspace/")){const e=t.pathname.split("/workspace/");if(e.length>1){const s=e[1];dm.lastWorkspaceLocation=t.search?"".concat(s).concat(t.search):s}}},[t.pathname,t.search]),{handleViewChange:t=>{"workspace"===t.toLowerCase()?e("/apps/".concat(s.id,"/editor/workspace/").concat(a)):e("/apps/".concat(s.id,"/editor/preview"))},lastWorkspaceLocation:a}})();return(0,se.jsx)(Kj,{value:"preview"===e?"preview":"workspace",onValueChange:e=>{"preview"===e&&t||s(e)},children:(0,se.jsxs)($j,{className:"h-[32px] rounded-[8px] px-[2px]",children:[(0,se.jsx)(Zj,{value:"workspace",className:"h-7 rounded-[8px] cursor-pointer",children:"Dashboard"}),(0,se.jsx)("div",{className:"h-6 w-[2px] bg-gray-100"}),t?(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("span",{className:"inline-flex",children:(0,se.jsx)(Zj,{value:"preview",className:"h-7 rounded-[8px] cursor-not-allowed opacity-50 pointer-events-none",children:"Preview"})})}),(0,se.jsx)(pp,{className:"bg-[#171717] border-none text-[#FAFAFA] rounded-lg pointer-events-none",children:"Exit split screen mode to preview"})]})}):(0,se.jsx)(Zj,{value:"preview",className:"h-7 rounded-[8px] cursor-pointer",children:"Preview"})]})})},rz=()=>(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",onClick:()=>{dS.openModal("InviteUser")},"aria-label":"Share and invite users",children:(0,se.jsx)(DD.A,{size:16,"aria-hidden":"true"})}),iz={COPY_LINK:"Copy link",COPIED:"Copied"},oz={TITLE:"Available Domains",MANAGE_BUTTON:"Manage"},cz={NO_CUSTOM_DOMAINS:"No custom domains configured",MORE_DOMAINS:"more domains"},dz=e=>{let{url:t,displayUrl:s,copiedUrl:a,onCopy:n}=e;const[l,r]=(0,Y.useState)(!1),i=(0,Y.useRef)(null),o=a===t;(0,Y.useEffect)(()=>()=>{i.current&&clearTimeout(i.current)},[]),(0,Y.useEffect)(()=>{o?(r(!0),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{r(!1)},2e3)):r(!1)},[o]);return(0,se.jsxs)("div",{className:"group flex items-center justify-between text-sm bg-slate-100 hover:bg-transparent rounded-md",onMouseOut:()=>{r(!1)},children:[(0,se.jsxs)("div",{className:"flex items-center flex-1 overflow-hidden group-hover:bg-slate-200 group-hover:rounded-md py-2 pl-3",children:[(0,se.jsx)(KP.A,{className:"h-4 w-4 mr-2 flex-shrink-0 text-gray-400","data-testid":"globe-icon"}),(0,se.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate",children:s})]}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(mp,{delayDuration:500,children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("button",{onClick:e=>{n(t)},className:"ml-2 p-1 text-gray-500 hover:text-gray-700 rounded-md transition-colors opacity-0 group-hover:opacity-100",children:o?(0,se.jsx)(Ds.A,{className:"h-4 w-4","data-testid":"check-icon"}):(0,se.jsx)(ob.A,{className:"h-4 w-4","data-testid":"copy-icon"})})}),(0,se.jsx)(pp,{side:"top",sideOffset:4,children:(0,se.jsx)("p",{children:iz.COPY_LINK})})]})}),l&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{open:!0,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("div",{className:"absolute inset-0 pointer-events-none"})}),(0,se.jsx)(pp,{side:"top",sideOffset:4,children:(0,se.jsx)("p",{children:iz.COPIED})})]})})]})]})},uz=e=>{let{publishLink:t,domains:s,appId:a,onManageDomainsClick:n}=e;const{isNativeMobile:l}=fd(),r=(0,J.Zp)(),[i,o]=(0,Y.useState)("");(0,Y.useEffect)(()=>{if(i){const e=setTimeout(()=>{o("")},2e3);return()=>clearTimeout(e)}},[i]);const c=e=>{navigator.clipboard.writeText(e).then(()=>{o(e)}).catch(e=>{})},d=(0,Y.useCallback)(()=>{null==n||n(),r("/apps/".concat(a,"/editor/workspace/domains"))},[n,r,a]);return(0,se.jsxs)("div",{className:"py-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,se.jsx)("h4",{className:"font-medium text-sm leading-5 text-gray-700",children:oz.TITLE}),!l&&(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-5 px-0 py-0 texwt-xs text-black hover:bg-transparent hover:text-gray-600",onClick:d,children:oz.MANAGE_BUTTON})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)(dz,{url:t,displayUrl:t.replace(/(https?:\/\/)/,""),copiedUrl:i,onCopy:c},t),s&&s.length>0?s.slice(0,4).map(e=>(0,se.jsx)(dz,{url:"https://".concat(e.domain),displayUrl:e.domain,copiedUrl:i,onCopy:c},e.domain)):(0,se.jsx)("p",{className:"text-xs text-gray-500",children:cz.NO_CUSTOM_DOMAINS}),s&&s.length>4&&(0,se.jsxs)("p",{className:"text-xs text-gray-500 pl-1",children:["+",s.length-4," ",cz.MORE_DOMAINS]})]})]})};const mz=e=>{let{value:t,showWorkspace:s=!0,onNavigation:a}=e;const n=(0,J.Zp)(),{app:l}=lp(),r=function(e){switch(e){case"private_with_login":default:return"Private access (login required)";case"workspace_with_login":return"Workspace access (login required)";case"public_with_login":return"Public access (login required)";case"public_without_login":return"Public access (no login required)"}}(t),i=function(e){switch(e){case"private_with_login":default:return Vc.A;case"workspace_with_login":return eb.A;case"public_with_login":case"public_without_login":return KP.A}}(t);return(0,se.jsx)("div",{className:"pt-4 pb-1 border-t border-slate-200",children:(0,se.jsxs)("button",{onClick:()=>{null!=l&&l.id&&(null==a||a(),n("/apps/".concat(l.id,"/editor/workspace/overview")))},className:"group w-full flex items-center gap-3 text-left text-sm text-slate-600 hover:text-slate-900 transition-colors",children:[(0,se.jsx)("div",{className:"flex-shrink-0 bg-gray-100 rounded-md p-[5px]",children:(0,se.jsx)(i,{size:16})}),(0,se.jsxs)("div",{className:"flex-1 flex items-center gap-1",children:[(0,se.jsx)("span",{children:r}),(0,se.jsx)(Zw.A,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})]})})},xz=e=>{var t,s,a;let{appId:n,conversationId:l,source:r,onNavigate:i}=e;const{user:o}=wd(),{suggestions:c,dismissDomainSuggestion:d}=lp();if(null==c||null===(t=c.domain_suggestion)||void 0===t||!t.api_response||c.domain_suggestion.dismissed||!c.domain_suggestion.api_response.available)return null;const u=(null===(s=c.domain_suggestion)||void 0===s||null===(a=s.api_response)||void 0===a?void 0:a.domain)||"",m=u.length>21?u.substring(0,21)+"...":u;return(0,se.jsx)("div",{className:"pb-3 px-1 w-full",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 px-2.5 py-1.5 rounded-md group transition-colors w-full",style:{borderRadius:"6px",border:"1px solid #D8AD41",background:"linear-gradient(78deg, #FFF 36.7%, #FFF5DF 78.12%)"},children:[(0,se.jsxs)(Z.Link,{to:"/apps/".concat(n,"/editor/workspace/domains"),className:"flex items-center justify-between gap-1.5 text-xs text-slate-600 hover:text-slate-900 transition-colors flex-1",onClick:()=>{var e,t,s,a;Tu("Domain Suggestion - Clicked",{source:r,domain:null===(e=c.domain_suggestion)||void 0===e||null===(t=e.api_response)||void 0===t?void 0:t.domain,app_id:n}),Vu({user_id:(null==o?void 0:o.id)||null,app_id:n||null,conversation_id:l||null},{cta:"domain_suggestion",origin:r,target_route:"domains_page",domain:null===(s=c.domain_suggestion)||void 0===s||null===(a=s.api_response)||void 0===a?void 0:a.domain}),null==i||i()},children:[(0,se.jsx)("span",{className:"font-medium",style:{color:"#724202",fontSize:"12px"},children:m}),(0,se.jsx)("span",{className:"font-medium text-sm",style:{background:"linear-gradient(90deg, #A05200 0%, #C3871E 50%, #A05200 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Get Domain"})]}),(0,se.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),d()},className:"p-0.5 text-slate-400 hover:text-slate-600 rounded transition-colors flex-shrink-0","aria-label":"Dismiss suggestion",children:(0,se.jsx)(la.A,{size:12})})]})})},hz=e=>{let{app:t,onClose:s,showLastPublishedFooter:a=!0,className:n="",contentClassName:l="",footerClassName:r="",onPublishSuccess:i}=e;const{user:o}=wd(),{isNativeMobile:c}=fd(),d=ZA(),{isInSharedWorkspace:u}=pS(),{isLoading:m}=Tx("isLoading"),x=vy.useIsPublishing(),{publishUrl:h,domains:p}=vy.usePublishUrl(),{isDisabled:g,restrictionReason:f}=vy.useIsDisabled(),{publishApp:v,publishError:b}=vy.usePublishApp({onPublishSuccess:i}),j=x||m,y=gu.useId();Y.useEffect(()=>{d.reportPublishPopoverOpen()},[]);const N=()=>{null==s||s()};return t?(0,se.jsxs)("div",{className:"flex flex-col ".concat(n),children:[(0,se.jsxs)("div",{className:"flex-1 ".concat(l),children:[(0,se.jsx)("h3",{className:"flex items-center font-semibold text-gray-900",children:"Publish Your App"}),!t.last_deployed_at&&(0,se.jsx)("div",{className:"py-3 text-sm text-gray-600 border-b border-slate-100",children:(0,se.jsx)("p",{children:"This will be the first public version of your app. Publishing will make your app accessible to users at the public link."})}),(null==b?void 0:b.message)&&(0,se.jsx)("div",{className:"py-2 text-sm text-red-600 bg-red-50 border-t border-b border-red-100",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-2"}),(0,se.jsx)("p",{children:b.message})]})}),(0,se.jsx)(uz,{publishLink:h,domains:p.map(e=>({domain:e})),appId:t.id,onManageDomainsClick:N}),(0,se.jsx)(xz,{appId:t.id,conversationId:y,source:"publish_dialog",onNavigate:N}),(0,se.jsx)(mz,{value:t.public_settings||"private_with_login",showWorkspace:u,onNavigation:N}),!c&&(0,se.jsx)(YD,{onClosePublish:N}),(0,se.jsxs)("div",{className:"pt-3",children:[(0,se.jsx)(Bx,{className:"w-full h-8 text-sm rounded-md transition-colors py-2 ".concat(g?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"),onClick:async()=>{null!=t&&t.id&&(d.reportPublishButtonClick({origin:"publish_modal",target_route:"publish",userId:(null==o?void 0:o.id)||null,appId:(null==t?void 0:t.id)||null}),await v({}),null==s||s())},disabled:g,"data-testid":"publish-button",children:j?(0,se.jsxs)("span",{className:"flex items-center justify-center",children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Publishing..."]}):"Publish App"}),g&&f&&(0,se.jsx)("div",{className:"text-sm text-red-600 text-center mt-2",children:f})]})]}),a&&t.last_deployed_at&&(0,se.jsx)("div",{className:"text-center ".concat(r),children:(0,se.jsxs)("p",{className:"text-xs bg-slate-100 py-[6px] font-normal leading-4 text-center text-[var(--text-muted,#71717A)]",children:["Last published ",He().utc(t.last_deployed_at).fromNow()]})})]}):(0,se.jsx)("div",{className:"flex items-center justify-center py-8 ".concat(n),children:(0,se.jsx)(Ac.A,{className:"w-6 h-6 text-slate-400 animate-spin"})})};const pz=new class{getClient(e){return(0,me.Ay)("/apps/".concat(e,"/mobile-builds"))}async getConfig(e){return this.getClient(e).get("/config")}async saveConfig(e,t){return this.getClient(e).put("/config",t)}async triggerBuild(e,t){return this.getClient(e).post("/trigger",t)}async getBuildHistory(e,t){const s={limit:arguments.length>2&&void 0!==arguments[2]?arguments[2]:20};return t&&(s.platform=t),this.getClient(e).get("/history",{params:s})}async getLatestBuilds(e){return this.getClient(e).get("/latest")}async scanApp(e,t){return this.getClient(e).post("/scan",{platform:t})}async getDownloadUrl(e){const{appId:t,platform:s,fileType:a}=e,n={};return a&&(n.file_type=a),this.getClient(t).get("/".concat(s,"/download-url"),{params:n})}},gz=e=>{let{open:t,onClose:s,appId:a,appName:n,currentLogoUrl:l,onSuccess:r,existingIssuerIdHint:i,existingKeyIdHint:o,existingTeamId:c,existingApiKeyConfigured:d}=e;const{toast:u}=ao(),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)("credentials"),g=(0,Y.useRef)(null),[f,v]=(0,Y.useState)(i||""),[b,j]=(0,Y.useState)(""),[y,N]=(0,Y.useState)(o||""),[w,_]=(0,Y.useState)(c||""),[k,C]=(0,Y.useState)(null),[A,S]=(0,Y.useState)(!d),[E,T]=(0,Y.useState)(l||null),[I,P]=(0,Y.useState)(null),[L,M]=(0,Y.useState)("A modern, minimalist logo for a business app"),[R,D]=(0,Y.useState)(!1),F=(0,Y.useCallback)(e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){C(s);const e=new FileReader;e.onload=e=>{var t;const s=null===(t=e.target)||void 0===t?void 0:t.result;j(s)},e.readAsText(s)}},[]),O=(0,Y.useCallback)(async e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){P(s);const e=new FileReader;e.onload=e=>{var t;T(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(s);try{const e=await ip.uploadAppFile(s,a);T(e.url)}catch(n){u({title:"Upload failed",description:n.message||"Failed to upload logo",variant:"destructive"})}}},[a,u]),U=(0,Y.useCallback)(async e=>{var t;e.preventDefault();const s=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];if(s&&s.type.startsWith("image/")){P(s);const e=new FileReader;e.onload=e=>{var t;T(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(s);try{const e=await ip.uploadAppFile(s,a);T(e.url)}catch(n){u({title:"Upload failed",description:n.message||"Failed to upload logo",variant:"destructive"})}}},[a,u]),B=(0,Y.useCallback)(e=>{e.preventDefault()},[]),z=(0,Y.useCallback)(async()=>{if(L.trim()){D(!0);try{const e=await zc.generateLogoFromPrompt(a,{prompt:L});T(e.logo_url),u({title:"Logo generated",description:"Your logo has been generated successfully"})}catch(e){u({title:"Generation failed",description:e.message||"Failed to generate logo",variant:"destructive"})}finally{D(!1)}}else u({title:"Missing prompt",description:"Please enter a prompt for logo generation",variant:"destructive"})},[a,L,u]),H=e=>{const t=e.replace(/[^a-zA-Z0-9]/g,"");return"com.base".concat(t,".app")},V=e=>{let{num:t}=e;return(0,se.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-neutral-100 flex items-center justify-center text-sm font-medium text-neutral-600",children:t})},W=e=>{let{content:t}=e;return(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Pj.A,{className:"w-4 h-4 text-neutral-400 cursor-help"})}),(0,se.jsx)(pp,{side:"top",className:"max-w-xs",children:(0,se.jsx)("p",{className:"text-sm",children:t})})]})},q=()=>{p("credentials"),v(i||""),j(""),N(o||""),_(c||""),C(null),S(!d),T(l||null),P(null),s()},G=f&&(d&&!A||k)&&y&&w;return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&q(),children:(0,se.jsxs)(Hg,{className:"sm:max-w-[520px] p-6 gap-0",children:[(0,se.jsxs)(Vg,{className:"space-y-1.5 text-left pb-4",children:[(0,se.jsx)(qg,{className:"text-lg font-semibold text-neutral-900",children:"Generate App Store files"}),(0,se.jsx)("p",{className:"text-sm text-neutral-500",children:"Enter your Apple Developer credentials to generate the IPA bundle."})]}),"credentials"===h?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex flex-col gap-5 py-2",children:[(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(V,{num:1}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("p",{className:"text-sm text-neutral-700",children:["Go to ",(0,se.jsx)("span",{className:"font-medium",children:"Users and Access"})," inside of"," ",(0,se.jsx)("span",{className:"font-medium",children:"Integrations"})]}),(0,se.jsxs)("a",{href:"https://appstoreconnect.apple.com/access/integrations/api",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700 mt-1",children:["Apple dashboard",(0,se.jsx)(Rj.A,{className:"w-3.5 h-3.5"})]})]})]}),(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(V,{num:2}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(aN,{className:"text-sm text-neutral-700",children:"Add the Issuer ID code"}),(0,se.jsx)(W,{content:"Found at the top of the Keys page in App Store Connect. It's the same for all keys in your account."})]}),(0,se.jsx)(Df,{placeholder:"ex: f4cab5b0-7b6c-47da-b64e-99d49abd9c6a",value:f,onChange:e=>v(e.target.value),className:"h-10"})]})]}),(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(V,{num:3}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(aN,{className:"text-sm text-neutral-700",children:"Add the Key ID code"}),(0,se.jsx)(W,{content:"The unique identifier for your API key, shown in the Keys list in App Store Connect."})]}),(0,se.jsx)(Df,{placeholder:"ex: H123IJ5689",value:y,onChange:e=>N(e.target.value),className:"h-10"})]})]}),(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(V,{num:4}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(aN,{className:"text-sm text-neutral-700",children:"Add your Team ID"}),(0,se.jsx)(W,{content:"Your 10-character Apple Team ID. Find it in App Store Connect under Membership or in your Apple Developer account."})]}),(0,se.jsx)(Df,{placeholder:"ex: 7A23BC9900",value:w,onChange:e=>_(e.target.value),className:"h-10"})]})]}),(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(V,{num:5}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(aN,{className:"text-sm text-neutral-700",children:"Upload the API Key file (.p8)"}),(0,se.jsx)(W,{content:"Upload the .p8 file you downloaded from App Store Connect. This file contains your private API key."})]}),d&&!A?(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-2 text-sm text-green-700 bg-green-50 border border-green-200 rounded-md",children:[(0,se.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"API Key file uploaded"]}),(0,se.jsx)("button",{type:"button",onClick:()=>S(!0),className:"text-sm text-blue-600 hover:text-blue-700 underline",children:"Replace"})]}):(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)("label",{className:"cursor-pointer",children:[(0,se.jsx)("input",{type:"file",accept:".p8",onChange:F,className:"hidden"}),(0,se.jsx)("div",{className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-md hover:bg-neutral-50 transition-colors",children:"Choose file"})]}),(0,se.jsx)("span",{className:"text-sm text-neutral-500",children:k?k.name:"No file chosen"}),d&&A&&(0,se.jsx)("button",{type:"button",onClick:()=>{S(!1),C(null),j("")},className:"text-sm text-neutral-500 hover:text-neutral-700 underline",children:"Cancel"})]})]})]})]}),(0,se.jsx)("div",{className:"flex justify-end pt-4 mt-2 border-t border-neutral-100",children:(0,se.jsx)(Bx,{onClick:()=>{f&&(d&&!A||b)&&y&&w?p("logo"):u({title:"Missing fields",description:"Please fill in all required fields",variant:"destructive"})},disabled:!G,className:"h-9 px-6 ".concat(G?"bg-neutral-900 hover:bg-neutral-800":"bg-neutral-400"," text-white"),children:"Continue"})})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex flex-col gap-4 py-2",children:[(0,se.jsx)(aN,{className:"text-sm text-neutral-700",children:"App logo"}),(0,se.jsx)("div",{className:"flex justify-center",children:(0,se.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-neutral-900 flex items-center justify-center overflow-hidden",children:E?(0,se.jsx)("img",{src:E,alt:"App logo",className:"w-full h-full object-cover"}):(0,se.jsx)("svg",{className:"w-10 h-10 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:(0,se.jsx)("path",{d:"M17.5 2.5L16 4H4v16h16V7l1.5-1.5-1-1L19 6V4h-2V2.5l1-1zM18 8v10H6V6h8l2-2H4v16h16V6l-2 2z"})})})}),(0,se.jsxs)("div",{onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},onDrop:U,onDragOver:B,className:"border border-dashed border-neutral-300 rounded-lg p-4 text-center cursor-pointer hover:border-neutral-400 transition-colors",children:[(0,se.jsx)("input",{ref:g,type:"file",accept:"image/*",onChange:O,className:"hidden"}),(0,se.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-neutral-600",children:[(0,se.jsx)(W_.A,{className:"w-4 h-4"}),"Click or drag to upload"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"flex-1 border-t border-neutral-200"}),(0,se.jsx)("span",{className:"text-sm text-neutral-400",children:"or generate with ai"}),(0,se.jsx)("div",{className:"flex-1 border-t border-neutral-200"})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Df,{value:L,onChange:e=>M(e.target.value),placeholder:"A modern, minimalist logo for a business app",className:"flex-1"}),(0,se.jsx)(Bx,{variant:"outline",onClick:z,disabled:R,children:R?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}):"Generate"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 bg-amber-50 border border-amber-200 rounded-lg p-3",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-amber-600 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-amber-800",children:"Changing the logo here will also update the logo you currently have."})]})]}),(0,se.jsxs)("div",{className:"flex justify-between pt-4 mt-2 border-t border-neutral-100",children:[(0,se.jsxs)(Bx,{variant:"outline",onClick:()=>p("credentials"),className:"gap-1",children:[(0,se.jsx)(vs.A,{className:"w-4 h-4"}),"Back"]}),(0,se.jsx)(Bx,{onClick:async()=>{x(!0);try{const e={app_display_name:n,logo_url:E,ios_bundle_id:H(a),ios_issuer_id:f,ios_key_id:y,ios_team_id:w};!A&&d||(e.ios_api_key=b),await pz.saveConfig(a,e),await pz.triggerBuild(a,{platform:"ios",version:"1.0.0"}),u({title:"Build started",description:"Your iOS app bundle is being generated. This may take 2-3 minutes."}),r(),q()}catch(s){var e,t;const a=(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||s.message||"Failed to start build";u({title:"Error",description:a,variant:"destructive"})}finally{x(!1)}},disabled:m,className:"h-9 px-6 bg-neutral-900 hover:bg-neutral-800 text-white",children:m?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Starting..."]}):"Generate Files"})]})]})]})})},fz=e=>{let{open:t,onClose:s,appId:a,appName:n,currentLogoUrl:l,onSuccess:r}=e;const{toast:i}=ao(),o=(0,Y.useRef)(null),[c,d]=(0,Y.useState)(l||null),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)("A modern, minimalist logo for a business app"),[p,g]=(0,Y.useState)(!1),f=(0,Y.useCallback)(async e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){m(s);const e=new FileReader;e.onload=e=>{var t;d(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(s);try{const e=await ip.uploadAppFile(s,a);d(e.url)}catch(n){i({title:"Upload failed",description:n.message||"Failed to upload logo",variant:"destructive"})}}},[a,i]),v=(0,Y.useCallback)(async e=>{var t;e.preventDefault();const s=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];if(s&&s.type.startsWith("image/")){m(s);const e=new FileReader;e.onload=e=>{var t;d(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(s);try{const e=await ip.uploadAppFile(s,a);d(e.url)}catch(n){i({title:"Upload failed",description:n.message||"Failed to upload logo",variant:"destructive"})}}},[a,i]),b=(0,Y.useCallback)(e=>{e.preventDefault()},[]),j=(0,Y.useCallback)(async()=>{if(x.trim()){g(!0);try{const e=await zc.generateLogoFromPrompt(a,{prompt:x});d(e.logo_url),i({title:"Logo generated",description:"Your logo has been generated successfully"})}catch(e){i({title:"Generation failed",description:e.message||"Failed to generate logo",variant:"destructive"})}finally{g(!1)}}else i({title:"Missing prompt",description:"Please enter a prompt for logo generation",variant:"destructive"})},[a,x,i]),y=e=>{const t=e.replace(/[^a-zA-Z0-9]/g,"");return"com.base".concat(t,".app")},{mutate:N,isLoading:w}=eu({logErrorMsg:"Failed to start Android build",toastError:"Failed to start build",toastSuccess:"Build started - Your Android app bundle is being generated. This may take 2-3 minutes.",mutate:async()=>{const e={app_display_name:n,logo_url:c,android_package_name:y(a)};await pz.saveConfig(a,e),await pz.triggerBuild(a,{platform:"android",version:"1.0.0"})},onSuccess:()=>{r(),_()}}),_=()=>{d(l||null),m(null),s()};return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&_(),children:(0,se.jsxs)(Hg,{className:"sm:max-w-[520px] p-6 gap-0",children:[(0,se.jsxs)(Vg,{className:"space-y-1.5 text-left pb-4",children:[(0,se.jsx)(qg,{className:"text-lg font-semibold text-neutral-900",children:"Generate Google Play files"}),(0,se.jsx)("p",{className:"text-sm text-neutral-500",children:"Configure your app logo to generate the AAB bundle."})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4 py-2",children:[(0,se.jsx)(aN,{className:"text-sm text-neutral-700",children:"App logo"}),(0,se.jsx)("div",{className:"flex justify-center",children:(0,se.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-neutral-900 flex items-center justify-center overflow-hidden",children:c?(0,se.jsx)("img",{src:c,alt:"App logo",className:"w-full h-full object-cover"}):(0,se.jsx)("svg",{className:"w-10 h-10 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:(0,se.jsx)("path",{d:"M17.5 2.5L16 4H4v16h16V7l1.5-1.5-1-1L19 6V4h-2V2.5l1-1zM18 8v10H6V6h8l2-2H4v16h16V6l-2 2z"})})})}),(0,se.jsxs)("div",{onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.click()},onDrop:v,onDragOver:b,className:"border border-dashed border-neutral-300 rounded-lg p-4 text-center cursor-pointer hover:border-neutral-400 transition-colors",children:[(0,se.jsx)("input",{ref:o,type:"file",accept:"image/*",onChange:f,className:"hidden"}),(0,se.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-neutral-600",children:[(0,se.jsx)(W_.A,{className:"w-4 h-4"}),"Click or drag to upload"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"flex-1 border-t border-neutral-200"}),(0,se.jsx)("span",{className:"text-sm text-neutral-400",children:"or generate with ai"}),(0,se.jsx)("div",{className:"flex-1 border-t border-neutral-200"})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Df,{value:x,onChange:e=>h(e.target.value),placeholder:"A modern, minimalist logo for a business app",className:"flex-1"}),(0,se.jsx)(Bx,{variant:"outline",onClick:j,disabled:p,children:p?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}):"Generate"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 bg-amber-50 border border-amber-200 rounded-lg p-3",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-amber-600 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-amber-800",children:"Changing the logo here will also update the logo you currently have."})]})]}),(0,se.jsx)("div",{className:"flex justify-end pt-4 mt-2 border-t border-neutral-100",children:(0,se.jsx)(Bx,{onClick:()=>{N({})},disabled:w,className:"h-9 px-6 bg-neutral-900 hover:bg-neutral-800 text-white",children:w?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Starting..."]}):"Generate Files"})})]})})};var vz=s(44535);const bz=e=>{let{open:t,onClose:s,scanResult:a,onApplyFix:n}=e;const{toast:l}=ao();if(!a)return null;const r=e=>{switch(e){case"PASS":return(0,se.jsx)(hb.A,{className:"w-4 h-4 text-green-500"});case"PARTIAL":return(0,se.jsx)(Ap.A,{className:"w-4 h-4 text-amber-500"});case"FAIL":return(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500"})}},i=e=>{switch(e){case"PASS":return"text-green-700 bg-green-50";case"PARTIAL":return"text-amber-700 bg-amber-50";case"FAIL":return"text-red-700 bg-red-50"}},o=a.guidelines.filter(e=>"PASS"===e.status).length,c=a.guidelines.filter(e=>"PARTIAL"===e.status).length,d=a.guidelines.filter(e=>"FAIL"===e.status).length;return(0,se.jsx)(Og,{open:t,onOpenChange:e=>!e&&s(),children:(0,se.jsxs)(Hg,{className:"sm:max-w-[600px] max-h-[80vh] overflow-hidden flex flex-col",children:[(0,se.jsx)(Vg,{className:"space-y-1.5 text-left pb-4 border-b border-neutral-100",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:["ios"===a.platform?(0,se.jsx)(vz.A,{className:"w-5 h-5"}):(0,se.jsx)(JB.A,{className:"w-5 h-5"}),(0,se.jsxs)(qg,{className:"text-lg font-semibold text-neutral-900",children:["ios"===a.platform?"App Store":"Google Play"," Scan Results"]})]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto py-4 space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-4 bg-neutral-50 rounded-lg",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-neutral-600",children:"Readiness Score"}),(0,se.jsxs)("p",{className:"text-3xl font-bold ".concat(a.overall_score>=80?"text-green-600":a.overall_score>=50?"text-amber-600":"text-red-600"),children:[a.overall_score,"/100"]})]}),(0,se.jsx)("div",{className:"px-3 py-1.5 rounded-full text-sm font-medium ".concat(a.store_ready?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"),children:a.store_ready?"Store Ready":"Needs Work"})]}),(0,se.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(hb.A,{className:"w-4 h-4 text-green-500"}),(0,se.jsxs)("span",{children:[o," passed"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(Ap.A,{className:"w-4 h-4 text-amber-500"}),(0,se.jsxs)("span",{children:[c," partial"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500"}),(0,se.jsxs)("span",{children:[d," failed"]})]})]}),(0,se.jsx)("div",{className:"p-3 bg-neutral-50 rounded-lg",children:(0,se.jsx)("p",{className:"text-sm text-neutral-700",children:a.summary})}),a.critical_issues.length>0&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-neutral-900",children:"Critical Issues"}),(0,se.jsx)("div",{className:"space-y-2",children:a.critical_issues.map((e,t)=>(0,se.jsx)("div",{className:"p-3 bg-red-50 border border-red-100 rounded-lg",children:(0,se.jsxs)("div",{className:"flex items-start gap-2",children:[(0,se.jsx)("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-red-100 text-red-700 text-xs font-medium flex items-center justify-center",children:e.priority}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-red-800",children:e.guideline}),(0,se.jsx)("p",{className:"text-sm text-red-700 mt-0.5",children:e.issue}),(0,se.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:["Fix: ",e.fix]})]})]})},t))})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-neutral-900",children:"All Guidelines"}),(0,se.jsx)("div",{className:"space-y-1",children:a.guidelines.map(e=>(0,se.jsxs)("details",{className:"group",children:[(0,se.jsxs)("summary",{className:"flex items-center gap-2 p-2 rounded-lg cursor-pointer hover:bg-neutral-50 ".concat("PASS"!==e.status?"bg-neutral-25":""),children:[r(e.status),(0,se.jsx)("span",{className:"text-sm flex-1",children:e.name}),(0,se.jsx)("span",{className:"text-xs px-2 py-0.5 rounded ".concat(i(e.status)),children:e.status})]}),(0,se.jsxs)("div",{className:"ml-6 mt-1 p-2 text-xs text-neutral-600 bg-neutral-50 rounded",children:[(0,se.jsxs)("p",{children:[(0,se.jsx)("strong",{children:"Evidence:"})," ",e.evidence]}),e.recommendation&&(0,se.jsxs)("p",{className:"mt-1",children:[(0,se.jsx)("strong",{children:"Recommendation:"})," ",e.recommendation]})]})]},e.id))})]})]}),a.suggested_prompt&&!a.store_ready&&(0,se.jsxs)("div",{className:"pt-4 border-t border-neutral-100 space-y-3",children:[(0,se.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-100 rounded-lg",children:(0,se.jsxs)("div",{className:"flex items-start gap-2",children:[(0,se.jsx)(_P.A,{className:"w-4 h-4 text-blue-600 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-blue-800",children:"AI Fix Available"}),(0,se.jsx)("p",{className:"text-xs text-blue-700 mt-0.5",children:"A customized prompt has been generated to fix all issues while preserving web functionality."})]})]})}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsxs)(Bx,{variant:"outline",className:"flex-1 gap-2",onClick:async()=>{a.suggested_prompt&&(await navigator.clipboard.writeText(a.suggested_prompt),l({title:"Prompt copied",description:"Paste it in the chat to apply mobile fixes"}))},children:[(0,se.jsx)(ob.A,{className:"w-4 h-4"}),"Copy Fix Prompt"]}),n&&(0,se.jsxs)(Bx,{className:"flex-1 gap-2 bg-blue-600 hover:bg-blue-700",onClick:()=>{a.suggested_prompt&&n&&(n(a.suggested_prompt),s())},children:[(0,se.jsx)(_P.A,{className:"w-4 h-4"}),"Apply with AI"]})]})]})]})})},jz=e=>{let{className:t}=e;return(0,se.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:(0,se.jsx)("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"})})},yz=e=>{let{className:t}=e;return(0,se.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"currentColor",children:(0,se.jsx)("path",{d:"M6 18c0 .55.45 1 1 1h1v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h2v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h1c.55 0 1-.45 1-1V8H6v10zM3.5 8C2.67 8 2 8.67 2 9.5v7c0 .83.67 1.5 1.5 1.5S5 17.33 5 16.5v-7C5 8.67 4.33 8 3.5 8zm17 0c-.83 0-1.5.67-1.5 1.5v7c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-7c0-.83-.67-1.5-1.5-1.5zm-4.97-5.84l1.3-1.3c.2-.2.2-.51 0-.71-.2-.2-.51-.2-.71 0l-1.48 1.48C13.85 1.23 12.95 1 12 1c-.96 0-1.86.23-2.66.63L7.85.15c-.2-.2-.51-.2-.71 0-.2.2-.2.51 0 .71l1.31 1.31C6.97 3.26 6 5.01 6 7h12c0-1.99-.97-3.75-2.47-4.84zM10 5H9V4h1v1zm5 0h-1V4h1v1z"})})},Nz=()=>(0,se.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium bg-gradient-to-r from-orange-50 to-orange-100 text-orange-600 border border-orange-200",children:[(0,se.jsx)(ry.A,{className:"w-3 h-3"}),"Builder+"]}),wz=e=>{var t,s;let{appId:a}=e;const{app:n}=lp(),{user:l}=wd(),{toast:r}=ao(),i=Hj(l),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!0),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(null),[_,k]=(0,Y.useState)(null),[C,A]=(0,Y.useState)(!1),[S,E]=(0,Y.useState)(null),T=(0,Y.useCallback)(async()=>{if(a)try{x(!0);const[e,t]=await Promise.all([pz.getLatestBuilds(a),pz.getConfig(a).catch(()=>null)]);c(e),u(t),null!=e&&e.ios&&["building","pending","ready"].includes(e.ios.status)&&b(!0),null!=e&&e.android&&["building","pending","ready"].includes(e.android.status)&&y(!0)}catch(e){}finally{x(!1)}else x(!1)},[a]);(0,Y.useEffect)(()=>{T()},[T]),(0,Y.useEffect)(()=>{const e="/apps/".concat(a),t=Fd.A.addListener(e,()=>{},{onMobileBuildUpdate:e=>{const t=e.p,s=e.s,a=e.u,n="ios"===t?"iOS":"Android";c(e=>e?"ios"===t?(0,ue.A)((0,ue.A)({},e),{},{ios:e.ios?(0,ue.A)((0,ue.A)({},e.ios),{},{status:s,build_link:a||e.ios.build_link}):e.ios}):"android"===t?(0,ue.A)((0,ue.A)({},e),{},{android:e.android?(0,ue.A)((0,ue.A)({},e.android),{},{status:s,build_link:a||e.android.build_link}):e.android}):e:e),"ready"===s?(r({title:"".concat(n," build ready"),description:"Your app bundle is ready to download"}),"ios"===t&&b(!0)):"failed"===s&&r({title:"".concat(n," build failed"),description:"Check your credentials and try again",variant:"destructive"})}});return()=>t()},[a]),(0,Y.useEffect)(()=>{const e=null==o?void 0:o.ios,t=null==o?void 0:o.android;if(e&&["building","pending"].includes(e.status)||t&&["building","pending"].includes(t.status)){const e=setInterval(T,3e4);return()=>clearInterval(e)}},[null==o||null===(t=o.ios)||void 0===t?void 0:t.status,null==o||null===(s=o.android)||void 0===s?void 0:s.status,T]);const I=(0,Y.useCallback)(()=>{p(!0)},[]),P=(0,Y.useCallback)(()=>{f(!0)},[]),L=(0,Y.useCallback)(()=>{T()},[T]),M=(0,Y.useCallback)(async e=>{w(e);try{const t=await pz.scanApp(a,e);k(t),A(!0)}catch(n){var t,s;const e=(null===(t=n.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||n.message||"Failed to scan app";r({title:"Scan failed",description:e,variant:"destructive"})}finally{w(null)}},[a,r]),R=(0,Y.useCallback)(e=>{window.dispatchEvent(new CustomEvent("pendingChatMessage",{detail:{message:e}})),r({title:"Fix prompt added to chat",description:"Review and send to apply mobile compatibility fixes"})},[r]),D=(0,Y.useCallback)(async(e,t)=>{E(e);try{const s=await pz.getDownloadUrl({appId:a,platform:e,fileType:t});s.download_url?window.open(s.download_url,"_blank"):r({title:"Download unavailable",description:"The build file is not available. Please try rebuilding.",variant:"destructive"})}catch(l){var s,n;const e=(null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.detail)||l.message||"Failed to get download URL";r({title:"Download failed",description:e,variant:"destructive"})}finally{E(null)}},[a,r]),F=(0,Y.useCallback)(async e=>{const t=a.replace(/[^a-zA-Z0-9]/g,""),s="com.base".concat(t,".app");try{await navigator.clipboard.writeText(s),r({title:"Copied to clipboard",description:"Bundle ID: ".concat(s)})}catch(n){r({title:"Failed to copy",description:"Could not copy bundle ID to clipboard",variant:"destructive"})}},[a,r]),O=e=>{if(!e)return"";const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/6e4);if(a<1)return"Generated just now";if(a<60)return"Generated ".concat(a," min ago");const n=Math.floor(a/60);if(n<24)return"Generated ".concat(n,"h ago");const l=Math.floor(n/24);return"Generated ".concat(l,"d ago")};if(m)return(0,se.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,se.jsx)(Ac.A,{className:"w-6 h-6 animate-spin text-neutral-400"})});const U=null==o?void 0:o.ios,B=U&&["building","pending"].includes(U.status),z="ready"===(null==U?void 0:U.status),H="failed"===(null==U?void 0:U.status),V=null==o?void 0:o.android,W=V&&["building","pending"].includes(V.status),q="ready"===(null==V?void 0:V.status),G="failed"===(null==V?void 0:V.status);return(0,se.jsxs)("div",{className:"flex flex-col gap-3 pt-4",children:[" ",(0,se.jsx)("div",{className:"px-4",children:(0,se.jsx)("p",{className:"text-sm font-medium text-[#0a0a0a]",children:"Prepare for Store Submission"})}),(0,se.jsx)("div",{className:"px-4",children:(0,se.jsxs)("div",{className:"flex flex-col gap-2 bg-[#eff6ff] rounded-md px-4 py-3",children:[(0,se.jsx)("p",{className:"text-sm font-normal text-[#111827] leading-5",children:"Scan your app against the latest App Store & Google Play guidelines."}),(0,se.jsxs)(Nj,{modal:!1,children:[(0,se.jsx)(wj,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,se.jsx)(Bx,{variant:"outline",size:"sm",className:"w-fit gap-1.5 bg-white border-[#e5e5e5] text-[#0a0a0a] rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]",disabled:null!==N,children:N?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}),"Scanning..."]}):(0,se.jsxs)(se.Fragment,{children:["Run App Scan",(0,se.jsx)(_t.A,{className:"w-4 h-4"})]})})}),(0,se.jsxs)(Aj,{align:"start",onCloseAutoFocus:e=>e.preventDefault(),children:[(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),M("ios")},disabled:null!==N,children:[(0,se.jsx)(jz,{className:"w-4 h-4 mr-2"}),"App Store guidelines"]}),(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),M("android")},disabled:null!==N,children:[(0,se.jsx)(yz,{className:"w-4 h-4 mr-2"}),"Google Play guidelines"]})]})]})]})}),(0,se.jsx)("div",{className:"px-4",children:(()=>{if(B){const e="pending"===(null==U?void 0:U.status),t="building"===(null==U?void 0:U.status);return(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 py-2",children:[(0,se.jsx)(jz,{className:"w-5 h-5"}),(0,se.jsx)("span",{className:"text-sm",children:"Building your app bundle..."})]}),(0,se.jsxs)("div",{className:"ml-8 flex flex-col gap-1 text-sm",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[e?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin text-neutral-400"}):(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-green-500"}),(0,se.jsx)("span",{className:e?"text-neutral-600":"text-green-600",children:"Verifying credentials"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[t?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin text-neutral-400"}):e?(0,se.jsx)(Ba.A,{className:"w-4 h-4 text-neutral-300"}):(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-green-500"}),(0,se.jsx)("span",{className:t?"text-neutral-600":"text-neutral-400",children:"Compiling native code"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-neutral-400",children:[(0,se.jsx)(Ba.A,{className:"w-4 h-4 text-neutral-300"}),(0,se.jsx)("span",{children:"Signing bundle"})]})]}),(0,se.jsx)("p",{className:"ml-8 text-xs text-neutral-400 mt-2",children:"This process usually takes 2-3 minutes."})]})}return z?(0,se.jsxs)("div",{className:"flex flex-col gap-1.5 pb-2 pt-0.5",children:[(0,se.jsxs)("button",{onClick:()=>b(!v),className:"flex items-center justify-between w-full",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(jz,{className:"w-6 h-6"}),(0,se.jsx)("span",{className:"text-sm font-normal text-[#0a0a0a]",children:"App Store files"})]}),(0,se.jsx)(ur.A,{className:"w-4 h-4 transition-transform ".concat(v?"":"rotate-180")})]}),v&&(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,se.jsx)("p",{className:"text-sm font-normal text-[#737373] leading-5",children:"Your app bundle (IPA) is ready to download and submit to the App Store."}),(0,se.jsxs)("div",{className:"flex items-center gap-2 pt-1.5",children:[(0,se.jsxs)(Bx,{size:"sm",className:"gap-1.5 bg-[#171717] hover:bg-[#171717]/90 text-[#fafafa] rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]",disabled:"ios"===S,onClick:()=>D("ios","IPA"),children:["ios"===S?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}):(0,se.jsx)(aL.A,{className:"w-4 h-4"}),"Download"]}),(0,se.jsxs)(Nj,{modal:!1,children:[(0,se.jsx)(wj,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,se.jsx)(Bx,{variant:"outline",size:"sm",className:"w-9 h-9 p-0 rounded-lg border-[#e5e5e5] shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]",children:(0,se.jsx)(Nv.A,{className:"w-5 h-5"})})}),(0,se.jsxs)(Aj,{align:"start",onCloseAutoFocus:e=>e.preventDefault(),children:[(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),F("ios")},children:[(0,se.jsx)(ob.A,{className:"w-4 h-4 mr-2"}),"Copy App Bundle ID to Clipboard"]}),(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),I()},children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2"}),"Create New Files"]})]})]})]}),(0,se.jsx)("p",{className:"text-xs font-normal text-[#737373]",children:O((null==U?void 0:U.completed_at)||null)})]})]}):H?(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 py-2",children:[(0,se.jsx)(jz,{className:"w-5 h-5"}),(0,se.jsx)("span",{className:"text-sm text-red-600",children:"Build failed"})]}),(0,se.jsxs)("div",{className:"ml-8 flex flex-col gap-2",children:[(0,se.jsx)("p",{className:"text-sm text-neutral-600",children:(null==U||null===(e=U.build_error)||void 0===e?void 0:e.message)||"Something went wrong during the build process."}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:I,className:"w-fit",children:"Try again"})]})]}):i?(0,se.jsxs)("button",{onClick:I,className:"flex items-center justify-between w-full py-2 hover:bg-neutral-50 rounded-md",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(jz,{className:"w-6 h-6"}),(0,se.jsx)("span",{className:"text-sm font-normal text-[#0a0a0a]",children:"Create App Store files"})]}),(0,se.jsx)(bs.A,{className:"w-4 h-4 text-neutral-400"})]}):(0,se.jsxs)("div",{className:"flex items-center justify-between w-full py-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(jz,{className:"w-6 h-6 text-neutral-400"}),(0,se.jsx)("span",{className:"text-sm font-normal text-neutral-500",children:"Create App Store files"})]}),(0,se.jsx)(Nz,{})]});var e})()}),(0,se.jsx)(ly,{className:"mx-4"}),(0,se.jsx)("div",{className:"px-4",children:(()=>{if(W){const e="pending"===(null==V?void 0:V.status),t="building"===(null==V?void 0:V.status);return(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 py-2",children:[(0,se.jsx)(yz,{className:"w-5 h-5"}),(0,se.jsx)("span",{className:"text-sm",children:"Building your app bundle..."})]}),(0,se.jsxs)("div",{className:"ml-8 flex flex-col gap-1 text-sm",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[e?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin text-neutral-400"}):(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-green-500"}),(0,se.jsx)("span",{className:e?"text-neutral-600":"text-green-600",children:"Verifying configuration"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[t?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin text-neutral-400"}):e?(0,se.jsx)(Ba.A,{className:"w-4 h-4 text-neutral-300"}):(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-green-500"}),(0,se.jsx)("span",{className:t?"text-neutral-600":"text-neutral-400",children:"Compiling native code"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-neutral-400",children:[(0,se.jsx)(Ba.A,{className:"w-4 h-4 text-neutral-300"}),(0,se.jsx)("span",{children:"Generating bundle"})]})]}),(0,se.jsx)("p",{className:"ml-8 text-xs text-neutral-400 mt-2",children:"This process usually takes 2-3 minutes."})]})}return q?(0,se.jsxs)("div",{className:"flex flex-col gap-1.5 pb-2 pt-0.5",children:[(0,se.jsxs)("button",{onClick:()=>y(!j),className:"flex items-center justify-between w-full",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(yz,{className:"w-6 h-6"}),(0,se.jsx)("span",{className:"text-sm font-normal text-[#0a0a0a]",children:"Google Play files"})]}),(0,se.jsx)(ur.A,{className:"w-4 h-4 transition-transform ".concat(j?"":"rotate-180")})]}),j&&(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",onClick:e=>e.stopPropagation(),children:[(0,se.jsx)("p",{className:"text-sm font-normal text-[#737373] leading-5",children:"Your app bundle (AAB) is ready to download and submit to Google Play."}),(0,se.jsxs)("div",{className:"flex items-center gap-2 pt-1.5",children:[(0,se.jsxs)(Nj,{modal:!1,children:[(0,se.jsx)(wj,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,se.jsxs)(Bx,{size:"sm",className:"gap-1.5 bg-[#171717] hover:bg-[#171717]/90 text-[#fafafa] rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]",disabled:"android"===S,children:["android"===S?(0,se.jsx)(Ac.A,{className:"w-4 h-4 animate-spin"}):(0,se.jsx)(aL.A,{className:"w-4 h-4"}),"Download",(0,se.jsx)(_t.A,{className:"w-3 h-3"})]})}),(0,se.jsxs)(Aj,{align:"start",onCloseAutoFocus:e=>e.preventDefault(),children:[(0,se.jsx)(Sj,{onClick:e=>{e.stopPropagation(),D("android","AAB")},disabled:"android"===S,children:"AAB (Google Play)"}),(0,se.jsx)(Sj,{onClick:e=>{e.stopPropagation(),D("android","APK")},disabled:"android"===S,children:"APK (Direct Install)"})]})]}),(0,se.jsxs)(Nj,{modal:!1,children:[(0,se.jsx)(wj,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,se.jsx)(Bx,{variant:"outline",size:"sm",className:"w-9 h-9 p-0 rounded-lg border-[#e5e5e5] shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)]",children:(0,se.jsx)(Nv.A,{className:"w-5 h-5"})})}),(0,se.jsxs)(Aj,{align:"start",onCloseAutoFocus:e=>e.preventDefault(),children:[(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),F("android")},children:[(0,se.jsx)(ob.A,{className:"w-4 h-4 mr-2"}),"Copy App Bundle ID to Clipboard"]}),(0,se.jsxs)(Sj,{onClick:e=>{e.stopPropagation(),P()},children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2"}),"Create New Files"]})]})]})]}),(0,se.jsx)("p",{className:"text-xs font-normal text-[#737373]",children:O((null==V?void 0:V.completed_at)||null)})]})]}):G?(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 py-2",children:[(0,se.jsx)(yz,{className:"w-5 h-5"}),(0,se.jsx)("span",{className:"text-sm text-red-600",children:"Build failed"})]}),(0,se.jsxs)("div",{className:"ml-8 flex flex-col gap-2",children:[(0,se.jsx)("p",{className:"text-sm text-neutral-600",children:(null==V||null===(e=V.build_error)||void 0===e?void 0:e.message)||"Something went wrong during the build process."}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:P,className:"w-fit",children:"Try again"})]})]}):i?(0,se.jsxs)("button",{onClick:P,className:"flex items-center justify-between w-full py-2 hover:bg-neutral-50 rounded-md",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(yz,{className:"w-6 h-6"}),(0,se.jsx)("span",{className:"text-sm font-normal text-[#0a0a0a]",children:"Create Google Play files"})]}),(0,se.jsx)(bs.A,{className:"w-4 h-4 text-neutral-400"})]}):(0,se.jsxs)("div",{className:"flex items-center justify-between w-full py-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(yz,{className:"w-6 h-6 text-neutral-400"}),(0,se.jsx)("span",{className:"text-sm font-normal text-neutral-500",children:"Create Google Play files"})]}),(0,se.jsx)(Nz,{})]});var e})()}),!i&&(0,se.jsx)("div",{className:"px-4",children:(0,se.jsxs)("p",{className:"text-sm text-[#737373] pt-1",children:["Creating App Store or Google Play files is available on our Builder plan and above."," ",(0,se.jsx)("a",{href:"/billing",className:"text-blue-500 hover:text-blue-600 underline",children:"Upgrade your plan"})]})}),(0,se.jsxs)("div",{className:"flex items-center justify-center gap-1 bg-[#f1f5f9] border-t border-[#e2e8f0] py-2 mt-auto rounded-b-xl",children:[(0,se.jsx)("span",{className:"text-sm font-normal text-[#4b5563]",children:"Learn how to"}),(0,se.jsxs)("a",{href:"https://docs.base44.com/documentation/building-your-app/uploading-to-app-stores#step-5-%7C-submit-your-app",target:"_blank",rel:"noopener noreferrer",className:"text-sm font-normal text-[#3b82f6] hover:text-blue-600 inline-flex items-center gap-1",children:["publish your mobile app",(0,se.jsx)(Rj.A,{className:"w-4 h-4"})]})]}),(0,se.jsx)(gz,{open:h,onClose:()=>p(!1),appId:a,appName:(null==n?void 0:n.name)||"",currentLogoUrl:null==n?void 0:n.logo_url,onSuccess:L,existingIssuerIdHint:null==d?void 0:d.ios_issuer_id_hint,existingKeyIdHint:null==d?void 0:d.ios_key_id_hint,existingTeamId:null==d?void 0:d.ios_team_id,existingApiKeyConfigured:null==d?void 0:d.ios_api_key_configured}),(0,se.jsx)(fz,{open:g,onClose:()=>f(!1),appId:a,appName:(null==n?void 0:n.name)||"",currentLogoUrl:null==n?void 0:n.logo_url,onSuccess:L}),(0,se.jsx)(bz,{open:C,onClose:()=>A(!1),scanResult:_,onApplyFix:R})]})};function _z(e){let{isMobile:t=!1,app:s}=e;const{isLoading:a}=Tx("isLoading"),{hasFlag:n}=ej(),l=n(nj),r=$y.useIsLegacyAppBlocked(),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)("web"),{isDisabled:x,restrictionReason:h}=vy.useIsDisabled(),p=vy.useIsPublishing(),g=x||a||!(null!=s&&s.id)||r,f=()=>{o(!1),d(!1)};return t?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Bx,{size:"tiny",onClick:()=>d(!0),disabled:g,"data-testid":"publish-button",className:"sm:px-4","aria-label":"Publish app",children:(0,se.jsx)(OP.A,{className:"w-4 h-4","aria-hidden":"true"})}),(0,se.jsx)(Og,{open:c,onOpenChange:d,children:(0,se.jsxs)(Hg,{className:"sm:max-w-md",children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{className:"sr-only",children:"Publish Your App"})}),(0,se.jsx)(hz,{app:s,onClose:f,showLastPublishedFooter:!0})]})})]}):(0,se.jsxs)(Nj,{open:i&&!g,onOpenChange:o,children:[(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{open:!(!g||p)&&void 0,children:[(0,se.jsx)(hp,{children:(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{size:"tiny",className:"px-4",disabled:g,"aria-label":"Publish app",children:p?(0,se.jsxs)("span",{className:"flex items-center",children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-3.5 w-3.5 animate-spin"}),"Publishing..."]}):(0,se.jsx)("span",{children:"Publish"})})})}),(0,se.jsx)(pp,{className:"bg-gray-900 text-white text-sm max-w-[200px]",children:r?"Publishing is disabled until you complete the infrastructure update.":h||"Publishing is currently disabled"})]})}),(0,se.jsx)(Aj,{align:"end",className:"w-80 p-0 rounded-xl","data-hook":"publish-dropdown-menu-content",onMouseLeave:e=>{const t=e.relatedTarget;null!=t&&t.closest("[data-radix-dropdown-menu-content]")||o(!1)},onInteractOutside:e=>{e.target.closest("[data-radix-dropdown-menu-content]")&&e.preventDefault()},children:(0,se.jsxs)(Kj,{value:u,onValueChange:e=>m(e),children:[l&&(0,se.jsxs)($j,{className:"w-full justify-start border-b border-neutral-200 rounded-none bg-transparent h-auto p-0",children:[(0,se.jsx)(Zj,{value:"web",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-neutral-900 data-[state=active]:bg-transparent data-[state=active]:shadow-none px-4 py-3 text-sm font-medium text-neutral-600 data-[state=active]:text-neutral-900",children:"Web"}),(0,se.jsx)(Zj,{value:"mobile",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-neutral-900 data-[state=active]:bg-transparent data-[state=active]:shadow-none px-4 py-3 text-sm font-medium text-neutral-600 data-[state=active]:text-neutral-900",children:"Mobile app"})]}),(0,se.jsx)(Jj,{value:"web",className:"m-0",children:(0,se.jsx)(hz,{app:s,onClose:f,contentClassName:"p-4",showLastPublishedFooter:!0})}),l&&(0,se.jsx)(Jj,{value:"mobile",className:"m-0",children:(0,se.jsx)(wz,{appId:(null==s?void 0:s.id)||""})})]})})]})}var kz=s(57543),Cz=s(58406),Az=s(7852);function Sz(e,t){if(!e||!t)return[];const s=Object.keys(e);if(0===s.length)return[];const a=new Set;const n=function t(n){let l=[];const r=n.split("\n");for(const i of r)if(i.includes("/components/")){const n=i.split("/components/")[1];if(n){const r=n.match(/^([a-zA-Z0-9_/-]+)/);if(r&&r[1]){const n=r[1].trim();if(s.includes(n)&&!a.has(n)){l.push(n),a.add(n);const s=t(e[n]);l=[...l,...s]}else{const r=n.split("/").pop();if(r&&s.includes(r)&&!a.has(r)){l.push(r),a.add(r);const s=t(e[r]);l=[...l,...s]}}}}}return l}(t);return Array.from(new Set(n))}const Ez=e=>{const t=e.split("/");return{file:e,filename:t[t.length-1],dirPath:t.slice(0,-1).join("/")}},Tz=e=>{let{onSelectFile:t}=e;const{currentPage:s,components:a,layout:n}=lp(),l=(0,Y.useMemo)(()=>{if(!s)return[];const e=[],{name:t,code:l}=s;e.push("pages/"+t);const r=Sz(a,l);e.push(...r.map(e=>"components/"+e));const i=Array.from(new Set(e)).map(e=>Ez(e));if(n){i.push({file:"layout",filename:"layout",dirPath:"Application Layout"});const e=Sz(a,n);i.push(...e.map(e=>Ez("components/"+e)))}return i},[a,n,s]);return l.map((e,s)=>(0,se.jsx)(Sj,{className:" cursor-pointer flex flex-col items-start px-3 py-1 text-xs text-gray-600 hover:bg-gray-100 rounded-md mx-1 transition-colors",onClick:()=>t(e.file),children:(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("span",{className:"font-medium",children:[e.filename,".jsx"]}),e.dirPath&&(0,se.jsx)("span",{className:"text-gray-400 text-[10px] mt-0.5",children:e.dirPath})]})},s))},Iz=e=>{const t=kh.useIsLoading(),s=jh.useIsGeneratingInitialPrompt();return(0,se.jsx)(Sj,(0,ue.A)((0,ue.A)({},e),{},{disabled:t||s,onClick:()=>{kh.showViewAsToolbar=!0},className:"cursor-pointer",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 ",children:[(0,se.jsx)(ay.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Act as a user"})]})}))},Pz=()=>(0,se.jsxs)("div",{className:"flex flex-col gap-2 font-base44",children:[(0,se.jsx)("p",{className:"text-sm text-gray-500 font-thin",children:"Your app is currently using Base44's new infrastructure"}),(0,se.jsx)(Bx,{size:"tiny",variant:"secondary",className:"w-[80%] self-start",onClick:()=>{dS.openModal("RevertToOldInfraModal")},children:"Revert infrastructure"}),(0,se.jsxs)("p",{className:"text-xs text-muted-foreground",children:["For more info, ",(0,se.jsx)("a",{className:"text-blue-500",href:Ky,target:"_blank",children:"visit our Docs"})]})]}),Lz=e=>{var t;let{onMenuOpen:s,hide:a}=e;const{app:n}=lp(),l=(0,J.Zp)(),{activeRequests:r}=lb(),i=(null==n?void 0:n.using_sandbox)&&((null==n||null===(t=n.sandbox_migration_info)||void 0===t?void 0:t.migrated_to_sandbox)||(null==n?void 0:n.migrated_to_sandbox)),o=uh();return(0,se.jsxs)(Nj,{onOpenChange:s,children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{size:"tiny",variant:"ghost","aria-label":"More options",children:(0,se.jsx)(Nv.A,{size:16,"aria-hidden":"true"})})}),(0,se.jsxs)(Aj,{align:"end",className:"w-[240px] p-1 shadow-lg border border-slate-200 rounded-lg",children:[(0,se.jsx)(Iz,{hidden:null==a?void 0:a.includes("actAsUser")}),(0,se.jsxs)(_j,{children:[(0,se.jsx)(kj,{hidden:null==a?void 0:a.includes("files"),children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(kz.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Files used in this page"})]})}),(0,se.jsxs)(Cj,{children:[Tz({onSelectFile:e=>dS.openModal("CodeEditorSidePanel",{selectedFileEditorPath:e})}),(0,se.jsx)(Tj,{}),(0,se.jsx)(Sj,{onClick:()=>{l("/apps/".concat(n.id,"/editor/workspace/code"))},children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"cursor-pointer px-2 text-sm text-gray-600",children:"See all files"}),(0,se.jsx)(bs.A,{className:"h-4 w-4"})]})})]})]}),(0,se.jsx)(Sj,{hidden:null==a?void 0:a.includes("activityMonitor"),asChild:!0,onClick:()=>dS.openModal("NetworkSidePanel"),children:(0,se.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)("div",{className:"relative",children:(0,se.jsx)(Cz.A,{size:16})}),(0,se.jsx)("span",{children:"Activity monitor"})]}),r>0&&(0,se.jsx)("span",{className:"flex items-center justify-center w-4 h-4 text-[10px] font-medium bg-primary/15 text-primary  rounded-full animate-[pulse_1.5s_ease-in-out_infinite]",children:r})]})}),(0,se.jsxs)(Sj,{hidden:null==a?void 0:a.includes("exportToZip"),onClick:()=>{dS.openModal("ExportToZipModal")},children:[(0,se.jsx)(Az.A,{size:16,className:"mr-2"}),"Export project as ZIP"]}),!(null!=a&&a.length)&&(0,se.jsx)(Tj,{}),(0,se.jsx)(Sj,{asChild:!0,onClick:()=>{Fu.track("help_center_clicked",(0,ue.A)({},o),{},{useBeacon:!0}).catch();const e=null!=n&&n.id?"/support?appId=".concat(n.id):"/support";window.open(e,"_blank")},children:(0,se.jsx)("div",{className:"flex flex-row justify-between",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)("div",{className:"relative",children:(0,se.jsx)(Pj.A,{size:16})}),(0,se.jsx)("span",{children:"Help Center"})]})})}),i&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Tj,{}),(0,se.jsx)(Sj,{className:"focus:bg-transparent",children:(0,se.jsx)(Pz,{})})]})]})]})},Mz=()=>{const e=$y.useIsMigrating(),t=$y.useIsReverting(),s=e||t;return(0,se.jsx)(Bx,{id:"migrate-to-new-infra-btn",variant:"outline",size:"tiny",disabled:s,className:"border-[#345DFF] bg-transparent text-[#345DFF] hover:text-[#3050FB]",onClick:()=>{dS.openModal("MigrateToNewInfraModal")},children:s?(0,se.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,se.jsx)(Ac.A,{className:"h-3.5 w-3.5 animate-spin"}),(0,se.jsx)("span",{children:e?"Updating Infrastructure":"Reverting Infrastructure"})]}):"Update Infrastructure"})},Rz=()=>{const e=uh();return{reportPageView:(t,s)=>{var a;Tu(null!==(a=null==s?void 0:s.mixPanelEventName)&&void 0!==a?a:"Page View - ".concat(t.pageName," view"),(0,ue.A)((0,ue.A)({},e),{},{page_name:t.pageName})),Fu.track("page_view",e,{page_name:t.pageName}).catch(()=>{})},reportUserClicked:(t,s)=>{var a;Tu(null!==(a=null==s?void 0:s.mixPanelEventName)&&void 0!==a?a:"User Clicked - ".concat(t.cta),(0,ue.A)((0,ue.A)({},e),{},{cta:t.cta,origin:t.origin,target_route:t.targetRoute})),Fu.track("user_clicked",e,{cta:t.cta,origin:t.origin,target_route:t.targetRoute}).catch(()=>{})}}};function Dz(){const[e,t]=(0,Y.useState)(null),[s,a]=(0,Y.useState)(!0),[n,l]=(0,Y.useState)(null);return(0,Y.useEffect)(()=>{let e=!0;return(async()=>{try{const s=await Yd.default.getStats();e&&(t(s),a(!1))}catch(s){e&&(l(s instanceof Error?s:new Error("Failed to fetch stats")),a(!1))}})(),()=>{e=!1}},[]),{stats:e,isLoading:s,error:n}}const Fz=()=>{const e=uo(),t=Rz(),{stats:s}=Dz(),a=hv(s),n=a?Math.round(100*uv.discountPercent):0,l=n>0?"".concat(n,"% off"):"Upgrade",[r,i]=(0,Y.useState)({hours:0,minutes:0,seconds:0}),o=(0,Y.useMemo)(()=>xv(s),[s]);(0,Y.useEffect)(()=>{if(!a)return;const e=()=>{const e=new Date,t=o.getTime()-e.getTime();if(t>0){const e=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4),a=Math.floor(t%6e4/1e3);i({hours:e,minutes:s,seconds:a})}else i({hours:0,minutes:0,seconds:0})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[a,o]);const c=e=>String(e).padStart(2,"0"),d=(0,se.jsxs)(Bx,{size:"tiny",variant:"outline",className:"sm:px-4 sm:w-auto w-8 border-[#FFCBB4]  bg-[linear-gradient(85deg,rgba(255,102,0,0.26)_-70.38%,rgba(255,222,162,0.18)_98.95%)]  text-[#FF631F] color-[#FF631F] hover:text-[#FF631F] hover:color-[#FF631F]",onClick:()=>{dS.openModal("UpgradeModal",{onOpenChange:e=>{e&&t.reportPageView({pageName:"upgrade_modal"},{mixPanelEventName:"Topbar Upgrade - modal opened"})}}),t.reportUserClicked({cta:l,origin:"editor",targetRoute:"/editor"},{mixPanelEventName:"Topbar Upgrade - click"})},"aria-label":"Upgrade plan",children:[(0,se.jsx)(ry.A,{className:"w-4 h-4","aria-hidden":"true"}),!e&&(0,se.jsx)("span",{children:l})]});return a&&!e?(0,se.jsx)(mp,{delayDuration:100,children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:d}),(0,se.jsxs)(pp,{side:"bottom",className:"p-1.5 bg-[#171717] border-none rounded-lg w-[220px] overflow-visible",sideOffset:8,children:[(0,se.jsx)(gp,{className:"fill-[#171717]",width:12,height:6}),(0,se.jsx)("div",{className:"rounded-lg h-[59px] flex items-center justify-center overflow-hidden",style:{background:"linear-gradient(180deg, #FF5500 0%, #FFC494 83.79%, #EDEAE4 112.87%)"},children:(0,se.jsxs)("div",{className:"flex items-center text-[#ffdec7]",children:[(0,se.jsx)("span",{className:"text-[41px] font-medium leading-none w-[50px] text-center",children:c(r.hours)}),(0,se.jsx)("span",{className:"text-[41px] font-normal leading-none",children:":"}),(0,se.jsx)("span",{className:"text-[41px] font-medium leading-none w-[50px] text-center",children:c(r.minutes)}),(0,se.jsx)("span",{className:"text-[41px] font-normal leading-none",children:":"}),(0,se.jsx)("span",{className:"text-[41px] font-medium leading-none w-[50px] text-center",children:c(r.seconds)})]})}),(0,se.jsxs)("div",{className:"flex flex-col items-center text-center mt-1 gap-0",children:[(0,se.jsx)("p",{className:"text-sm font-normal text-white leading-5",children:"Limited time welcome offer"}),(0,se.jsxs)("p",{className:"text-sm font-medium text-white leading-5",children:["Get ",mv(uv)," off select yearly plans"]})]})]})]})}):d},Oz=()=>{const{hasFlag:e}=ej();return{upgradeButtonInTopbarEnabled:e("upgrade-button-in-topbar")}},Uz=()=>{const{app:e,dataEnv:t,setDataEnv:s}=lp();if(null==e||!e.dev_environment_enabled)return null;const a="dev"===t;return(0,se.jsx)(Bx,{variant:"ghost",size:"xTiny",onClick:()=>s(a?"prod":"dev"),"aria-label":a?"Turn off test data":"Turn on test data",className:de(a&&"text-green-600 bg-green-50 hover:bg-green-100 hover:text-green-600"),children:(0,se.jsx)(oy.A,{size:16,"aria-hidden":"true"})})};var Bz=s(86009),zz=s(15332);const Hz=e=>{let{app:t,currentUsage:s,onShareModalOpen:a,onLogout:n,user:l}=e;const r=(0,J.Zp)(),{activeWorkspace:i}=qd(),o=uh(),{stats:c}=Dz(),d=hv(c)?Math.round(100*uv.discountPercent):0,u="Upgrade Plan",m=e=>{Tu("User clicked upgrade",(0,ue.A)((0,ue.A)({},o),{},{cta:e,origin:"editor account menu",target_route:"/billing"})),Vu((0,ue.A)({},o),{cta:e,origin:"editor account menu",target_route:"/billing"})};return(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)("button",{type:"button",className:"flex items-center cursor-pointer flex-1 p-1 rounded-md hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2","aria-label":"Account menu",children:(0,se.jsx)(hg,{className:"h-6 w-6 rounded-xl",children:(0,se.jsx)(pg,{src:Wx,alt:"Base44"})})})}),(0,se.jsxs)(Aj,{align:"start",className:"w-[240px] p-2 shadow-lg border border-slate-200 rounded-lg",children:[(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{to:"/",className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(vs.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Back to Workspace"})]})}),(0,se.jsx)(Tj,{}),(0,se.jsx)(Ej,{asChild:!0,children:(0,se.jsx)("div",{className:"px-2 py-1.5 text-gray-500",children:null==l?void 0:l.email})}),s&&(0,se.jsxs)("div",{className:"border border-slate-200 rounded-[10px] p-2 my-2",children:[(0,se.jsx)(Ej,{children:(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{children:"Credits"}),(0,se.jsx)("span",{className:"text-xs bg-slate-100 px-2 py-0.5 rounded",children:Oj(s.tier,!1)})]})}),(0,se.jsxs)("div",{className:"px-2 py-1.5",children:[(0,se.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,se.jsx)("span",{children:"Monthly Credits"}),(0,se.jsxs)("span",{children:[(x=s.monthly_usage,x%1==0?x:x.toFixed(1)),"/",s.monthly_limit,s.extra_credits>0&&" (+".concat(s.extra_credits,")")]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,se.jsx)("div",{className:"h-1.5 rounded-full ".concat(s.is_over_limit?"bg-red-500":"bg-primary"),style:{width:"".concat(Math.min(s.monthly_usage/s.monthly_limit*100,100),"%")}})})]}),s.daily_limit&&(0,se.jsx)("div",{className:"px-2 py-1.5",children:(0,se.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,se.jsx)("span",{children:"Daily Credits"}),(0,se.jsxs)("span",{children:[s.daily_usage,"/",s.daily_limit]})]})}),(0,se.jsxs)("div",{className:"px-2 pb-1 text-xs text-muted-foreground",children:["Credits renew on: ",s.next_period_start_date?new Date(s.next_period_start_date).toLocaleDateString():""]})]}),(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{target:"_blank",to:"/billing",className:"flex items-center justify-between cursor-pointer",onClick:()=>m(u),children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M12.0287 0.0164795C12.1965 0.042961 12.3596 0.100934 12.5095 0.188599C12.7069 0.304114 12.8762 0.468088 13.005 0.666504L14.7355 3.75L14.738 3.75366C14.899 3.99942 14.9897 4.28987 15 4.58862L14.9991 4.71771C14.9843 5.06147 14.8634 5.39025 14.6562 5.65155L14.6545 5.6543L14.6536 5.65338L8.5794 14.4424L8.57768 14.4406C8.4508 14.6113 8.29197 14.7507 8.10978 14.8471C7.92041 14.9474 7.712 15 7.50143 15C7.29086 15 7.08245 14.9474 6.89308 14.8471C6.71098 14.7507 6.55114 14.6121 6.42433 14.4415L0.345341 5.65338L0.343618 5.65155C0.13648 5.39026 0.0163288 5.06138 0.00152918 4.71771C-0.0131882 4.37397 0.0786621 4.0346 0.262619 3.75366L0.264343 3.75L1.99786 0.666504C2.1268 0.4679 2.29663 0.304156 2.49419 0.188599C2.69408 0.0717083 2.91669 0.00678431 3.1439 0H11.8598L12.0287 0.0164795ZM8.37087 13.2788L13.5248 5.63873H11.1017L8.37087 13.2788ZM6.6027 13.2431L4.21086 5.63873H1.47501L6.6027 13.2431ZM7.48937 13.0389L10.0962 5.63873H5.18973L7.48937 13.0389ZM3.09909 0.9375C3.03124 0.948211 2.96586 0.972569 2.90521 1.008C2.82421 1.05537 2.75351 1.12204 2.70099 1.20392L2.69668 1.21124L0.964892 4.29108L0.965754 4.29199C0.892875 4.40351 0.856552 4.53824 0.862352 4.67468C0.862739 4.68362 0.865053 4.69236 0.865798 4.70123H4.13847L5.03874 0.931091H3.16716L3.09909 0.9375ZM11.1845 4.70123H14.1349C14.1356 4.69236 14.1379 4.68361 14.1383 4.67468C14.1441 4.53821 14.1076 4.40334 14.0349 4.29199L12.3062 1.21124L12.301 1.20392C12.2486 1.12227 12.1793 1.05528 12.0985 1.008C12.0378 0.972495 11.9717 0.948222 11.9038 0.9375L11.8348 0.931091H10.2873L11.1845 4.70123ZM5.15785 4.70123H10.1651L9.26788 0.931091H6.05811L5.15785 4.70123Z",fill:"black"})}),(0,se.jsx)("span",{children:u})]}),d>0&&(0,se.jsxs)("span",{className:"px-1.5 py-px rounded-sm text-sm font-medium text-black",style:{background:"linear-gradient(118deg, rgba(255, 154, 110, 1) 5.32%, rgba(255, 99, 31, 1) 100%)"},children:[d,"% off"]})]})}),(0,se.jsx)(Tj,{}),(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{to:"https://docs.base44.com",className:"flex items-center gap-2 cursor-pointer",target:"_blank",children:[(0,se.jsx)(Lj.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Documentation"})]})}),(0,se.jsxs)(Sj,{onClick:()=>{null!=i&&i.id&&r("/workspace/".concat(i.id,"/settings/basic-information"))},disabled:!(null!=i&&i.id),className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(vP.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Settings"})]}),(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{target:"_blank",onClick:()=>m("Billing"),to:"/billing",className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(su.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Billing"})]})}),(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{target:"_blank",to:"/support?appId=".concat(null==t?void 0:t.id),className:"flex items-center gap-2 cursor-pointer",onClick:()=>{Fu.track("help_center_clicked",(0,ue.A)({},o),{},{useBeacon:!0}).catch()},children:[(0,se.jsx)(Oy.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Help Center"})]})}),s&&a&&(0,se.jsx)(Sj,{asChild:!0,onClick:a,children:(0,se.jsxs)("span",{children:[(0,se.jsx)(Bz.A,{className:"h-4 w-4 mr-2"}),(0,se.jsx)("span",{children:"Win Free Credits"})]})}),(0,se.jsx)(Tj,{}),(0,se.jsxs)(Sj,{onClick:n,className:"flex items-center gap-2 cursor-pointer text-gray-800 hover:bg-gray-100",children:[(0,se.jsx)(zz.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Sign Out"})]})]})]})});var x},Vz=e=>{let{app:t,currentUsage:s,user:a,onShareModalOpen:n,onLogout:l}=e;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Hz,{app:t,currentUsage:s,user:a,onShareModalOpen:n,onLogout:l})}),(0,se.jsx)(GL.Item,{className:"relative flex overflow-visible",children:(0,se.jsx)(GL.Separator,{className:"absolute left-[-2px] flex w-full h-[90%]  border-l border-grey-100 rotate-[25deg]"})})]})};var Wz=s(43558);const qz=e=>{var t;let{app:s,workspaceName:a=null}=e;return(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer flex-1 p-1 rounded-md hover:bg-gray-200 transition-colors overflow-hidden",children:[(0,se.jsxs)(hg,{className:"h-6 w-6 rounded-md ",children:[(0,se.jsx)(pg,{src:null==s?void 0:s.logo_url,alt:(null==s?void 0:s.name)||"App",className:"rounded-md"}),(0,se.jsx)(gg,{className:"rounded-md",children:(null==s||null===(t=s.name)||void 0===t?void 0:t[0])||"A"})]}),(0,se.jsx)("div",{className:"relative flex items-center w-full",children:(0,se.jsxs)("div",{className:"absolute top-1/2 -translate-y-1/2 flex flex-col leading-none text-left w-max max-w-full",children:[(0,se.jsx)("h3",{className:"text-sm font-medium truncate",children:(null==s?void 0:s.name)||"My App"}),(0,se.jsx)("span",{className:"text-xs text-gray-500 truncate translate-y-[-2px]",children:a})]})})]})}),(0,se.jsxs)(Aj,{align:"start",className:"w-[240px] p-1 shadow-lg border border-slate-200 rounded-lg",children:[(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{to:"/apps/".concat(null==s?void 0:s.id,"/editor/workspace/overview"),className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(YP.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"App Overview"})]})}),(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{to:"/apps/".concat(null==s?void 0:s.id,"/editor/workspace/users"),className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(Wz.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Users"})]})}),(0,se.jsx)(VR,{sourceCodeState:"managed",children:(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{to:"/apps/".concat(null==s?void 0:s.id,"/editor/workspace/security"),className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(Yc.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Security"})]})})}),(0,se.jsx)(Sj,{asChild:!0,children:(0,se.jsxs)(Z.Link,{to:"/apps/".concat(null==s?void 0:s.id,"/editor/workspace/app-settings"),className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)(iM.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"App Settings"})]})})]})]})},Yz=e=>{let{app:t,workspaceName:s}=e;return(0,se.jsx)(GL.Item,{className:"max-w-[250px] w-[90%]",children:(0,se.jsx)(qz,{app:t,workspaceName:s})})},Gz=e=>{if(null==e||!e.name)return"";if(null!=e&&e.is_personal)return"Personal Workspace";const t=e.name;return"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)," Workspace")},Kz=()=>{var e;const{app:t,dataEnv:s,currentUsage:a}=lp(),n=HR(),{logout:l,user:r}=wd(),{activeWorkspace:i}=qd(),o=(0,J.Zp)(),{isPhoneMode:c,isLeftPanelHidden:d}=dm.usePick("isPhoneMode","isLeftPanelHidden"),u=dm.useView(),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),{shouldMigrate:g}=$y.useMigrationNotifications(),f=$y.useIsLegacyAppBlocked(),{upgradeButtonInTopbarEnabled:v}=Oz(),b=g&&!f;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(GL,{children:[(0,se.jsxs)(GL.Left,{className:n?"gap-3 overflow-visible":void 0,children:[(0,se.jsx)(VR,{sourceCodeState:"unmanaged",children:(0,se.jsx)(Vz,{app:t,currentUsage:a,user:r,onShareModalOpen:()=>p(!0),onLogout:()=>{l(),o("/login")}})}),(0,se.jsxs)(VR,{sourceCodeState:"managed",children:[(0,se.jsx)(GL.Item,{tooltip:d?"Show chat panel":"Hide chat panel",children:(0,se.jsx)(nz,{})}),(0,se.jsx)(GL.Separator,{}),(0,se.jsx)(GL.Item,{children:(0,se.jsx)(lz,{})})]}),(0,se.jsx)(GL.Item,{hidden:"preview"!==u||n,children:(0,se.jsx)(GL,{className:" overflow-hidden h-[32px] rounded-[10px] py-0 px-2",theme:"white",children:(0,se.jsxs)(GL.Left,{children:[(0,se.jsx)(GL.Item,{children:(0,se.jsx)($B,{})}),(0,se.jsx)(GL.Separator,{}),(0,se.jsx)(GL.Item,{tooltip:c?"Switch to desktop view":"Switch to mobile view",children:(0,se.jsx)(XB,{})}),(0,se.jsx)(GL.Item,{tooltip:"Refresh",children:(0,se.jsx)(ZB,{})}),(0,se.jsx)(GL.Item,{hidden:!(null!=t&&t.dev_environment_enabled),tooltip:"dev"===s?"Turn off test data":"Turn on test data",children:(0,se.jsx)(Uz,{})})]})})})]}),n&&(0,se.jsx)(GL.Middle,{children:(0,se.jsx)(Yz,{app:t,workspaceName:Gz(i)})}),(0,se.jsxs)(GL.Right,{children:[(0,se.jsx)(GL.Item,{tooltip:"More Actions",tooltipOpen:!m&&void 0,children:(0,se.jsx)(Lz,{onMenuOpen:x,hide:n?["files","exportToZip","actAsUser"]:void 0})}),(0,se.jsx)(GL.Item,{hidden:n,children:(0,se.jsx)(gS,{appId:null==t?void 0:t.id,appName:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"app"})}),(0,se.jsx)(GL.Item,{tooltip:"Share app",children:(0,se.jsx)(rz,{})}),(0,se.jsx)(GL.Item,{hidden:!v,children:(0,se.jsx)(Fz,{})}),(0,se.jsx)(GL.Item,{hidden:!b,tooltip:(0,se.jsxs)("p",{children:["Your app is ready for a quick upgrade",(0,se.jsx)("br",{})," to the new infrastructure."]}),children:(0,se.jsx)(Mz,{})}),(0,se.jsx)(GL.Item,{hidden:n,children:(0,se.jsx)(_z,{app:t})})]})]}),(0,se.jsx)(VR,{sourceCodeState:"unmanaged",children:(0,se.jsx)(qD,{app:t,isOpen:h,onClose:()=>p(!1)})})]})},$z=()=>(0,se.jsx)(Bx,{variant:"ghost",size:"tiny",onClick:()=>dm.showCheckpoints=!dm.showCheckpoints,"aria-label":"Version history",children:(0,se.jsx)(eh.A,{size:16,"aria-hidden":"true"})}),Zz=()=>{const{app:e,currentUsage:t}=lp(),{activeWorkspace:s}=qd(),{logout:a,user:n}=wd(),l=(0,J.Zp)(),[r,i]=(0,Y.useState)(!1);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(GL,{className:"bg-slate-50 z-10 shadow-[0_10px_23px_rgba(248,250,252,252.15)]",children:[(0,se.jsxs)(GL.Left,{className:"gap-3 overflow-visible",children:[(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Hz,{app:e,currentUsage:t,user:n,onShareModalOpen:()=>i(!0),onLogout:()=>{a(),l("/login")}})}),(0,se.jsx)(GL.Item,{className:"relative flex overflow-visible",children:(0,se.jsx)(GL.Separator,{className:"absolute left-[-2px] flex w-full h-[90%]  border-l border-grey-100 rotate-[25deg]"})})]}),(0,se.jsx)(GL.Middle,{children:(0,se.jsx)(GL.Item,{className:"max-w-[250px] w-[90%]",children:(0,se.jsx)(qz,{app:e,workspaceName:Gz(s)})})}),(0,se.jsx)(GL.Right,{children:(0,se.jsx)(GL.Item,{tooltip:"Version history",children:(0,se.jsx)($z,{})})})]}),(0,se.jsx)(qD,{app:e,isOpen:r,onClose:()=>i(!1)})]})},Jz=()=>{var e;const t=HR(),s=Rz(),{setSelectedCheckpoint:a}=Tx("setSelectedCheckpoint"),n=Tx(e=>e.selectedCheckpoint),{isLeftPanelHidden:l,showCheckpoints:r}=dm.usePick("isLeftPanelHidden","showCheckpoints"),i=jh.useIsGeneratingInitialPrompt(),o=(0,Y.useRef)(null),{isSplitScreenMode:c}=dm.usePick("isSplitScreenMode");(0,Y.useEffect)(()=>{s.reportPageView({pageName:"editor"})},[]),(0,Y.useEffect)(()=>{var e;dm.chatWidth&&!l&&(null===(e=o.current)||void 0===e||e.resize(dm.chatWidth))},[l]),qP();const{user:d}=wd();$p(null==d?void 0:d.platform_role);return(0,Y.useEffect)(()=>{r||(a(void 0),dm.codeViewVisible=!1)},[r]),(0,se.jsx)("div",{className:"flex flex-row h-full bg-slate-50",children:(0,se.jsxs)(MP,{direction:"horizontal",children:[(0,se.jsxs)(VR,{sourceCodeState:"managed",children:[(0,se.jsx)(RP,{ref:o,onResize:e=>{e>10&&(dm.chatWidth=e)},defaultSize:l?0:null!==(e=dm.chatWidth)&&void 0!==e?e:24,maxSize:l?0:40,className:"h-full overflow-hidden relative  ".concat(l?"hidden":""),style:{minWidth:l?"0px":"300px"},children:(0,se.jsxs)("div",{className:"flex flex-col h-full px-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsx)(Zz,{})}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:r?(0,se.jsxs)("div",{className:"flex flex-col h-full py-4",children:[(0,se.jsxs)("div",{className:"flex items-center mb-4",children:[(0,se.jsx)(Bx,{variant:"ghost",size:"icon",onClick:()=>{dm.showCheckpoints=!1,a(void 0),dm.codeViewVisible=!1},children:(0,se.jsx)(Vs.A,{className:"h-4 w-4"})}),(0,se.jsx)("h2",{className:"text-lg font-semibold ml-2",children:"Version History"})]}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,se.jsx)(VP,{})})]}):(0,se.jsx)(TP,{})})]})}),(0,se.jsx)(DP,{withHandle:!0,className:"group transition-opacity ".concat(l?"hidden":"opacity-0 hover:opacity-100 focus:opacity-100")})]}),(0,se.jsx)(RP,{defaultSize:l||t?100:67,className:"flex-1 overflow-x-auto ".concat(l||t?"pl-4":""),children:(0,se.jsx)("div",{className:de("flex-grow h-full overflow-y-auto gap-2",{"pb-2":!c}),children:(0,se.jsxs)("div",{className:de("flex flex-col h-full overflow-hidden",{"pr-3":!c}),children:[n&&!i?(0,se.jsx)(sz,{}):(0,se.jsx)(Kz,{}),(0,se.jsx)("div",{className:de("flex-1 flex-col overflow-auto",{"border border-slate-200 rounded-[10px]":!c}),children:(0,se.jsx)(tz,{})})]})})})]})})};var Qz=s(31628),Xz=s.n(Qz);const eH=e=>(e.preventDefault(),e.stopPropagation(),!1),tH=e=>{let{children:t,boundsId:s,onDragging:a,disabled:n}=e;const[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)();return(0,Y.useEffect)(()=>{null==a||a(l)},[l,a]),(0,Y.useEffect)(()=>()=>{window.removeEventListener("scroll",eH),window.removeEventListener("touchmove",eH)},[]),(0,Y.useEffect)(()=>{if(!l&&i){const e=document.documentElement.getBoundingClientRect(),t=Math.abs(i.x);t>1&&t<e.width/8&&setTimeout(()=>o(e=>({x:.9*e.x,y:e.y})),5)}},[l,i]),(0,Y.useEffect)(()=>{n&&i&&Math.max(Math.abs(i.x),Math.abs(i.y))>1&&setTimeout(()=>o(e=>({x:.9*e.x,y:.9*e.y})),5)},[n,i]),(0,se.jsx)(Xz(),{allowAnyClick:!0,allowMobileScroll:!0,bounds:s,defaultClassName:"z-20",disabled:n,onDrag:(e,t)=>{o({x:t.x,y:t.y}),l||setTimeout(()=>r(!0),100)},position:i,onStop:()=>{window.removeEventListener("scroll",eH),window.removeEventListener("touchmove",eH),setTimeout(()=>r(!1),0)},onStart:()=>{window.addEventListener("scroll",eH,{passive:!1}),window.addEventListener("touchmove",eH,{passive:!1})},children:"function"==typeof t?t({isDragging:l,btnPos:i}):t})};var sH=s(3888);const aH=()=>{const e=$y.useIsMigrating(),t=$y.useIsReverting(),s=e||t;return(0,se.jsx)(GL,{className:"bg-blue-600 text-white w-full ",children:(0,se.jsx)(GL.Middle,{className:"justify-center",children:(0,se.jsx)(GL.Item,{className:"h-8",disabled:s,onClick:()=>{dS.openModal("MigrateToNewInfraModal")},children:s?(0,se.jsxs)("div",{className:"flex flex-row items-center gap-2 ",children:[(0,se.jsx)(Ac.A,{className:"h-3.5 w-3.5 animate-spin"}),(0,se.jsx)("span",{children:e?"Updating Infrastructure":"Reverting Infrastructure"})]}):(0,se.jsxs)("span",{className:"flex flex-row items-center align-middle gap-2",children:[(0,se.jsx)("span",{children:"Update your app to the new infrastructure"}),(0,se.jsx)(sH.A,{className:"h-5 w-5 mt-1"})]})})})})},nH=()=>{const{app:e,currentUsage:t}=lp(),{logout:s,user:a}=wd(),n=(0,J.Zp)(),l=HR(),{shouldMigrate:r}=$y.useMigrationNotifications(),{upgradeButtonInTopbarEnabled:i}=Oz();return(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)(GL,{className:"px-4 py-3",children:[(0,se.jsxs)(GL.Left,{children:[(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Hz,{app:e,currentUsage:t,onShareModalOpen:null,onLogout:()=>{s(),n("/login")},user:a})}),(0,se.jsx)(GL.Item,{hidden:l,children:(0,se.jsx)(lz,{})})]}),(0,se.jsxs)(GL.Right,{children:[(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Lz,{hide:["files","exportToZip","actAsUser","activityMonitor"]})}),(0,se.jsx)(GL.Item,{hidden:!i,children:(0,se.jsx)(Fz,{})}),(0,se.jsx)(GL.Item,{hidden:l,children:(0,se.jsx)(_z,{app:e,isMobile:!0})})]})]}),r&&(0,se.jsx)(aH,{})]})},lH=e=>{var t;let{onBack:s}=e;const{setSelectedCheckpoint:a,selectedCheckpoint:n,isLoading:l,isSyncingSandboxCheckpoint:r,allCheckpoints:i,isRestoring:o}=Tx(),c=vy.useIsPublishingCheckpoint(),[d,u]=(0,Y.useState)(null!==(t=i.findIndex(e=>e.id===(null==n?void 0:n.id)))&&void 0!==t?t:0),m=Ix(d,500),x=d>0,h=d<i.length-1;(0,Y.useEffect)(()=>{a(i[m])},[m]);const p=(0,Y.useMemo)(()=>{var e;return null===(e=i[d])||void 0===e?void 0:e.name},[d]);(0,Y.useEffect)(()=>{var e;u(null!==(e=i.findIndex(e=>e.id===(null==n?void 0:n.id)))&&void 0!==e?e:0)},[null==n?void 0:n.id]);const g=o||c||l||r;return(0,se.jsxs)("div",{className:"flex flex-col w-full",children:[(0,se.jsxs)(GL,{className:"px-5 py-3",children:[(0,se.jsx)(GL.Left,{children:(0,se.jsxs)(GL.Item,{className:"flex flex-1 flex-row gap-2 items-center cursor-pointer",onClick:()=>{a(null),null==s||s()},children:[(0,se.jsx)(Vs.A,{width:24,height:16}),(0,se.jsx)("p",{children:"Back"})]})}),(0,se.jsx)(GL.Right,{children:(0,se.jsxs)(GL.Item,{className:"flex justify-end items-center gap-2",children:[(0,se.jsx)(Bx,{size:"tiny",className:"bg-orange-600 hover:bg-orange-700",disabled:!n||g,onClick:()=>{dS.openModal("PublishVersionModal",{checkpoint:n})},children:c?"Publishing...":"Publish"}),(0,se.jsx)(Bx,{size:"tiny",variant:"outline",disabled:o||!n||g,onClick:()=>{dS.openModal("RestoreVersionModal",{checkpoint:n})},children:o?"Restoring...":"Restore"})]})})]}),(0,se.jsx)(Tr,{}),(0,se.jsx)(GL,{className:"px-5 py-3",children:(0,se.jsxs)(GL.Middle,{children:[(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Bx,{disabled:!x||g,size:"icon",variant:"outline",onClick:()=>{u(d-1)},children:(0,se.jsx)(vs.A,{})})}),(0,se.jsx)(GL.Item,{children:(0,se.jsx)("div",{className:"flex flex-1 justify-center text-sm text-center ",children:(0,se.jsx)("p",{children:null!=p?p:"Latest"})})}),(0,se.jsx)(GL.Item,{children:(0,se.jsx)(Bx,{disabled:!h||g,size:"icon",variant:"outline",onClick:()=>{u(d+1)},children:(0,se.jsx)(bs.A,{})})})]})})]})},rH=()=>{var e,t,s;const{app:a}=lp(),n=Rz(),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)("chat"),[u,m]=(0,Y.useState)(!1),{selectedCheckpoint:x,hasCheckpoints:h}=Tx("selectedCheckpoint","setSelectedCheckpoint","hasCheckpoints"),p=gu.useMessages();qP();const{isNativeMobile:g}=fd();return(0,Y.useEffect)(()=>{dm.isPhoneMode=!1,n.reportPageView({pageName:"editor"})},[]),(0,Y.useEffect)(()=>{var e,t,s;const n="processing"===(null==a||null===(e=a.status)||void 0===e?void 0:e.state),i=(null==p?void 0:p.length)<=3;n&&i&&(d("chat"),m(!0)),"processing"===l&&"processing"!==(null==a||null===(t=a.status)||void 0===t?void 0:t.state)&&i&&m(!1),r(null==a||null===(s=a.status)||void 0===s?void 0:s.state)},[null==a||null===(e=a.status)||void 0===e?void 0:e.state,null==p?void 0:p.length,l]),(0,Y.useEffect)(()=>{null==x?d("chat"):(d("versions"),m(!1))},[x]),(0,se.jsxs)("div",{className:"relative w-full h-full bg-slate-50 rounded-tr-lg rounded-br-lg",children:[(0,se.jsx)("div",{id:"user-app-editor-main-bounds",className:"w-full h-full p-6 pt-14 absolute pointer-events-none"}),(0,se.jsx)("div",{className:"absolute w-full h-full ".concat(i?"opacity-50 pointer-events-none":""," transition-opacity duration-200 ease-in-out"),children:(0,se.jsx)("div",{className:"flex flex-col h-full overflow-hidden",children:(0,se.jsx)("div",{className:"flex-grow h-full overflow-y-auto",children:(0,se.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[!g&&(x?(0,se.jsx)(lH,{onBack:()=>{m(!0)}}):(0,se.jsx)(nH,{})),(0,se.jsx)(tz,{})]})})})}),(0,se.jsxs)(VR,{sourceCodeState:"managed",children:[(0,se.jsx)(tH,{onDragging:o,boundsId:"#user-app-editor-main-bounds",children:(0,se.jsx)(Bx,{id:"user-app-editor-main-btn",className:de("fixed bottom-6 right-6 z-50","px-7 py-3 bg-black hover:bg-gray-900 rounded-xl","shadow-[0px_4px_6px_0px_rgba(0,0,0,0.24),0px_-1px_4px_0px_rgba(0,0,0,0.16)]","border border-white","inline-flex justify-center items-center gap-2",{"shadow-[0px_6px_6px_3px_rgba(0,0,0,0.4)]":i},{hidden:"versions"===c}),onClick:()=>{!i&&m(!0)},children:"processing"===(null==a||null===(t=a.status)||void 0===t?void 0:t.state)?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"h-5 w-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,se.jsx)("span",{className:"text-white text-sm font-medium leading-[14px]",children:"Processing..."})]}):(0,se.jsx)("span",{className:"text-white text-sm font-medium leading-[14px]",children:null!=x?"Version History":"Chat to Edit"})})}),(0,se.jsx)(Sy,{open:u,onOpenChange:e=>{m(e),e||d("chat")},children:(0,se.jsx)(Ly,{side:"bottom",className:de("fixed bottom-0 w-full flex flex-col transition-all duration-300 ease-in-out p-0 gap-0 rounded-t-xl z-[51]",{"h-[95%]":"chat"===c||"versions"===c&&null==x,"h-[80%]":"versions"===c&&null!=x,"h-auto":"miniChat"===c},"miniChat"===c&&"shadow-[0_0_6px_5px_rgba(0,0,0,0.1)] border-grey border-2"),noOverlay:"miniChat"===c,showDragHandle:!1,onOpenAutoFocus:"miniChat"===c?e=>e.preventDefault():void 0,header:(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fy,{className:"pt-3 pb-1",onToggle:"versions"!==c?()=>d(e=>"miniChat"===e?"chat":"miniChat"):void 0,onClose:"versions"===c?()=>m(!1):void 0}),"versions"===c?(0,se.jsx)(iH,{children:"Version History"}):(0,se.jsx)(iH,{onVersionsClicked:()=>d("versions"),hasCheckpoints:h})]}),children:"versions"===c?(0,se.jsx)("div",{className:"flex h-[90%] pb-4 px-1",children:(0,se.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-auto-hide",children:(0,se.jsx)(VP,{})})}):"miniChat"===c?(0,se.jsx)("div",{className:de("px-4 pb-4",{"h-5":"processing"===(null==a||null===(s=a.status)||void 0===s?void 0:s.state)}),children:(0,se.jsx)(TP,{minimizedChat:!0})}):(0,se.jsx)("div",{className:"h-[90%]",children:(0,se.jsx)(TP,{})})})})]})]})},iH=e=>{var t,s;let{children:a,onVersionsClicked:n,hasCheckpoints:l,className:r}=e;const{app:i}=lp(),o="processing"===(null==i||null===(t=i.status)||void 0===t?void 0:t.state)?"Building your app...":null!==(s=null==i?void 0:i.name)&&void 0!==s?s:"AI App Editor",c=[];return l&&n&&c.push((0,se.jsx)(eh.A,{className:"h-6 w-6 p-1 mx-auto",onClick:n},"history")),(0,se.jsx)(My,{className:de("p-4 pt-0",r),actions:c,children:(0,se.jsx)("div",{className:"flex justify-between items-center",children:(0,se.jsx)("div",{className:"flex items-center justify-start gap-3",children:(0,se.jsx)(Ry,{className:"m-0 text-md text-start",children:null!=a?a:o})})})})};function oH(e){let{children:t}=e;const{app:s,setApp:a}=lp(),{user:n}=wd(),{hasFlag:l}=ej(),r=l(tj),i=Boolean(null==s?void 0:s.connected_to_github),o=(0,Y.useCallback)(async()=>{if(null==s||!s.id)return;const e=await zc.get(s.id);a(e)},[null==s?void 0:s.id,a]);return(0,Y.useEffect)(()=>{if(null!=s&&s.id)return wx.init(s.id,r,i,o,null==n?void 0:n.id),()=>{wx.cleanup()}},[null==s?void 0:s.id,r,i,o,null==n?void 0:n.id]),(0,se.jsx)(se.Fragment,{children:t})}function cH(e){var t,s;return{id:e.id,color:e.color,text:e.text,linkStatusPage:e.link_status_page,statusPageUrl:e.status_page_url,statusPageLinkText:e.status_page_link_text,icon:e.icon,textColor:null!==(t=e.text_color)&&void 0!==t?t:void 0,onlyOnHomepage:e.only_on_homepage,dismissable:e.dismissable,updatedDate:null!==(s=e.updated_date)&&void 0!==s?s:void 0}}class dH extends te.H{getBaseURL(){return"/admin/status-banners"}create(e){return this.axios.post("",e)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all";return this.axios.get("",{params:{page:e,page_size:t,status:s}})}get(e){return this.axios.get("/".concat(e))}update(e,t){return this.axios.put("/".concat(e),t)}activate(e){return this.axios.post("/".concat(e,"/activate"))}createAndActivate(e){return this.axios.post("/create-and-activate",e)}deactivate(e){return this.axios.post("/".concat(e,"/deactivate"))}polishText(e){return this.axios.post("/polish",{text:e})}}async function uH(){const e=await vd.A.get("".concat((0,fe.Gt)(),"/status-banners/active")),{banner:t}=e.data;return{banner:t?cH(t):null}}const mH=new dH;function xH(){const[e,t]=(0,Y.useState)(null),s=(0,Y.useRef)(!1),{data:a,isLoading:n,error:l,refetch:r}=Xd({query:uH,logErrorMsg:"Failed to fetch status banner"});(0,Y.useEffect)(()=>{a&&!s.current?(s.current=!0,t(a.banner)):a&&t(a.banner)},[a]);const i=(0,Y.useCallback)(e=>{if(e.banner){const s=cH(e.banner);t(s)}else t(null)},[]);return(0,Y.useEffect)(()=>{const e=Fd.A.addStatusBannerListener(i);return()=>{e()}},[i]),{banner:e,isLoading:n,error:l,refetch:r}}const hH={red:{bg:"bg-red-600",text:"text-white",iconColor:"text-white"},amber:{bg:"bg-amber-500",text:"text-slate-900",iconColor:"text-slate-900"},transparent:{bg:"bg-slate-100/80 backdrop-blur border-b border-slate-200",text:"text-slate-700",iconColor:"text-slate-600"}};function pH(e,t){const s={size:16,className:de("shrink-0",t)};switch(e){case"info":return(0,se.jsx)(Oy.A,(0,ue.A)({},s));case"warning":return(0,se.jsx)(Ap.A,(0,ue.A)({},s));case"none":return null;default:return(0,se.jsx)(ad.A,(0,ue.A)({},s))}}function gH(e){var t,s,a,n,l,r;let{config:i}=e;const[o,c]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{c(!1)},[i.id,i.updatedDate]);const d=i.color.startsWith("#");const u=d?null:hH[i.color],m=null!==(t=null==u?void 0:u.bg)&&void 0!==t?t:"",x=i.textColor?"":null!==(s=null==u?void 0:u.text)&&void 0!==s?s:"text-white",h=i.textColor?"":null!==(a=null==u?void 0:u.iconColor)&&void 0!==a?a:"text-white",p=d?{backgroundColor:i.color,color:null!==(n=i.textColor)&&void 0!==n?n:"#FFFFFF"}:i.textColor?{color:i.textColor}:{},g=null!==(l=i.statusPageUrl)&&void 0!==l?l:"https://status.base44.com",f=null!==(r=i.statusPageLinkText)&&void 0!==r?r:"Status Page";return o?null:(0,se.jsxs)("div",{className:de("w-full px-4 py-3 relative","animate-in slide-in-from-top-2 duration-300 ease-out",m,x),style:p,role:"alert",children:[(0,se.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[pH(i.icon,h),(0,se.jsxs)("p",{className:"text-sm font-medium leading-5 min-[320px]:text-[14px]",children:[(0,se.jsx)("span",{children:i.text}),i.linkStatusPage&&(0,se.jsxs)(se.Fragment,{children:[" ",(0,se.jsx)("span",{children:"For updates, check our "}),(0,se.jsx)("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:de("underline underline-offset-2 hover:opacity-80 transition-opacity","font-medium"),children:f}),(0,se.jsx)("span",{children:"."})]})]})]}),i.dismissable&&(0,se.jsx)("button",{onClick:()=>c(!0),className:de("absolute right-3 top-1/2 -translate-y-1/2","p-1 rounded-full hover:bg-black/10 transition-colors","focus:outline-none focus:ring-2 focus:ring-white/50"),"aria-label":"Dismiss banner",children:(0,se.jsx)(la.A,{size:16,className:h||"text-current"})})]})}const fH=e=>{let{view:t}=e;const s=uo(),a=HR();(()=>{var e,t,s,a;const{app:n,appErrors:l,setAppErrors:r,pageNames:i}=lp(),{initialSyncState:o}=kx.usePick("initialSyncState"),c=(0,Y.useRef)(!1),d=(0,Y.useRef)(!1),u=(0,Y.useRef)(!1),m=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{"pending"===(null==n?void 0:n.app_stage)&&(c.current=!0,d.current=!0,jh.isFirstPrompt=!0)},[null==n?void 0:n.app_stage,null==n||null===(e=n.status)||void 0===e?void 0:e.state]),(0,Y.useEffect)(()=>{var e;"processing"===(null==n||null===(e=n.status)||void 0===e?void 0:e.state)&&(c.current=!0)},[null==n?void 0:n.app_stage,null==n||null===(t=n.status)||void 0===t?void 0:t.state]),(0,Y.useEffect)(()=>{l.length&&c.current&&(r([]),u.current=!0,d.current&&(jh.hadErrorsDuringFirstPrompt=!0))},[l,r]);const x=(0,Y.useMemo)(()=>{var e,t;const s=(null!==(e=null==i?void 0:i.size)&&void 0!==e?e:0)>0,a="ready"===(null==n?void 0:n.app_stage)&&"ready"===(null==n||null===(t=n.status)||void 0===t?void 0:t.state)&&s,l=Boolean(null==n?void 0:n.connected_to_github),r=a&&(!l||"complete"===o);return jh.isAppFullyReady=r,r},[null==n?void 0:n.app_stage,null==n||null===(s=n.status)||void 0===s?void 0:s.state,i,null==n?void 0:n.connected_to_github,o]);(0,Y.useEffect)(()=>{var e,t;const s=0===(null!==(e=null==i?void 0:i.size)&&void 0!==e?e:0)&&"ready"===(null==n||null===(t=n.status)||void 0===t?void 0:t.state);jh.isAppInEmptyState=s},[i,null==n||null===(a=n.status)||void 0===a?void 0:a.state]),(0,Y.useEffect)(()=>{if(c.current){if(x){const e=u.current||d.current;m.current=setTimeout(()=>{c.current=!1,m.current=null,d.current=!1,u.current=!1,jh.isFirstPrompt=!1,jh.hadErrorsDuringFirstPrompt=!1,e&&(Wu.refreshPreview(),Sv())},2e3)}return()=>{clearTimeout(m.current),m.current=null}}},[x])})(),(()=>{const{selectedCheckpoint:e}=Tx("selectedCheckpoint");(0,Y.useEffect)(()=>{const{isPreviewReady:t,isPreviewBuilding:s}=Rh(e);dm.isCheckpointCodeViewAvailable=t,dm.isCheckpointPreviewBuilding=s},[null==e?void 0:e.git_commit_hash,null==e?void 0:e.preview_status])})(),(0,Y.useEffect)(()=>{const e=a?"workspace":t;dm.view=e},[t,a]),(0,Y.useEffect)(()=>()=>{kh.exitViewAsMode()},[]),$y.useMigrationNotifications();const{banner:n}=xH(),l=n&&!1===n.onlyOnHomepage,r=s?(0,se.jsx)(rH,{}):(0,se.jsx)(Jz,{});return(0,se.jsxs)("div",{className:"h-screen flex flex-col overflow-hidden",children:[l&&(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsx)(gH,{config:n})}),(0,se.jsx)("div",{className:"flex-1 min-h-0",children:r})]})},vH=e=>{let{view:t}=e;return(0,se.jsx)(np,{children:(0,se.jsx)(rb,{children:(0,se.jsx)(nb,{children:(0,se.jsx)(oH,{children:(0,se.jsxs)(Ex,{children:[(0,se.jsx)(fH,{view:t}),(0,se.jsx)(oS,{})]})})})})})};function bH(){const e=(0,J.Zp)(),t=(0,J.zy)(),s=new URLSearchParams(t.search),a=s.get("prompt"),[n,l]=(0,Y.useState)(null);return(0,Y.useEffect)(()=>{!async function(){if(a)try{const t=s.get("app_platform_version"),n={status:{state:"processing",details:"Starting conversation..."}};t&&(n.platform_version=parseInt(t,10));const l=await zc.create(n);e("/apps/".concat(l.id,"/editor/preview"),{state:{initialPrompt:a}})}catch(t){l(t.message||"Error creating app")}else l("No prompt provided")}()},[a,e,s]),n?(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,se.jsx)("span",{children:n})})}):(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsx)("div",{"data-testid":"loading-spinner",className:"animate-spin rounded-full h-12 w-12 border-4 border-gray-300 border-t-blue-600"})})}var jH=s(85113),yH=s(58799),NH=s(73581),wH=s(2847),_H=s(56473);function kH(e){let{stats:t}=e;const[s,a]=(0,Y.useState)("30days"),[n,l]=(0,Y.useState)(!1);return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,se.jsx)(Es,{children:(0,se.jsxs)(Ls,{className:"flex items-center p-6",children:[(0,se.jsx)(eb.A,{className:"w-8 h-8 text-blue-500 mr-4"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-gray-600",children:"Total Users"}),(0,se.jsx)("p",{className:"text-2xl font-bold",children:t.total_users})]})]})}),(0,se.jsx)(Es,{children:(0,se.jsxs)(Ls,{className:"flex items-center p-6",children:[(0,se.jsx)(BO.A,{className:"w-8 h-8 text-green-500 mr-4"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-gray-600",children:"New Today"}),(0,se.jsx)("p",{className:"text-2xl font-bold",children:t.new_users_today})]})]})}),(0,se.jsx)(Es,{children:(0,se.jsxs)(Ls,{className:"flex items-center p-6",children:[(0,se.jsx)(NH.A,{className:"w-8 h-8 text-yellow-500 mr-4"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-gray-600",children:"Premium Users"}),(0,se.jsx)("p",{className:"text-2xl font-bold",children:t.paying_users})]})]})})]}),(0,se.jsx)(Es,{className:"mb-8",children:(0,se.jsxs)(Ls,{className:"p-6",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold",children:"User Growth"}),(0,se.jsxs)("div",{className:"flex space-x-2",children:[(0,se.jsx)(zt,{variant:"7days"===s?"default":"outline",size:"sm",onClick:()=>a("7days"),children:"7 Days"}),(0,se.jsx)(zt,{variant:"30days"===s?"default":"outline",size:"sm",onClick:()=>a("30days"),children:"30 Days"}),(0,se.jsx)(zt,{variant:"90days"===s?"default":"outline",size:"sm",onClick:()=>a("90days"),children:"90 Days"}),(0,se.jsx)(zt,{variant:"year"===s?"default":"outline",size:"sm",onClick:()=>a("year"),children:"1 Year"}),(0,se.jsx)(zt,{variant:"all"===s?"default":"outline",size:"sm",onClick:()=>a("all"),children:"All Time"}),(0,se.jsx)(zt,{variant:n?"default":"outline",size:"sm",onClick:()=>l(!n),children:n?"Show Today":"Hide Today"})]})]}),(0,se.jsx)("div",{className:"h-[200px] w-full",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(wH.b,{data:(()=>{if(!t.new_users_by_day)return[];He()();let e;switch(s){case"7days":e=He()().subtract(7,"days");break;case"30days":default:e=He()().subtract(30,"days");break;case"90days":e=He()().subtract(90,"days");break;case"year":e=He()().subtract(1,"year");break;case"all":return n?t.new_users_by_day.filter(e=>!He()(e.date).isSame(He()(),"day")):t.new_users_by_day}let a=t.new_users_by_day.filter(t=>He()(t.date).isAfter(e));return n&&(a=a.filter(e=>!He()(e.date).isSame(He()(),"day"))),a})(),children:[(0,se.jsx)(eA.W,{dataKey:"date",tickFormatter:e=>He()(e).format("MMM DD")}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{labelFormatter:e=>He()(e).format("MMMM DD, YYYY"),formatter:e=>["".concat(e," new users")]}),(0,se.jsx)(_H.N,{type:"monotone",dataKey:"count",stroke:"#2563eb",strokeWidth:2})]})})})]})})]})}var CH=s(70237);class AH extends te.y{getBaseURL(){return"/admin/analytics"}getAdminStats(){return this.axios.get("/overall")}getTopUsers(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return this.axios.get("/top-users",{params:{start_date:e,end_date:t,limit:s}})}getUserAnalytics(){return this.axios.get("/user-analytics")}getOrganizationsWithPlans(){return this.axios.get("/organizations-with-plans")}searchOrganizations(e){return this.axios.get("/search-organizations",{params:{search:e}})}getOrganizationUsage(e){return this.axios.get("/organization/".concat(e,"/usage"))}getUserLatestCountry(e){return this.axios.get("/user-latest-country",{params:{email:e}})}}const SH=new AH;class EH extends te.H{getBaseURL(){return"/admin/billing"}getStripeSyncPreview(e){return this.axios.get("/stripe-sync-preview/".concat(e))}}const TH=new EH,IH={stripe_subscription_id:"Subscription ID",stripe_subscription_status:"Subscription Status",subscription_tier:"Subscription Tier",subscription_period_start:"Period Start",subscription_period_end:"Period End"},PH=[{value:"active",label:"active"},{value:"trialing",label:"trialing"},{value:"past_due",label:"past_due"},{value:"unpaid",label:"unpaid"},{value:"canceled",label:"canceled"},{value:"incomplete_expired",label:"incomplete_expired"}],LH=(e,t)=>{if(null==e)return"\u2014";if(t.includes("period_")&&e)try{return new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"UTC",hour12:!1})+" UTC"}catch(s){return e}return e},MH=(e,t)=>{var s,a;const n=e;return(null==n||null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail)||(null==n?void 0:n.message)||t};function RH(e){var t;let{isOpen:s,onClose:a,userId:n,userEmail:l,stripeCustomerId:r,onSyncComplete:i,onUpdateUser:o}=e;const[c,d]=(0,Y.useState)(new Set),[u,m]=(0,Y.useState)(void 0),{data:x,isLoading:h,error:p,refetch:g,resetData:f}=Xd({query:()=>TH.getStripeSyncPreview(n),enabled:!1,logErrorMsg:"Failed to fetch Stripe sync preview"},[n]),{mutate:v,isLoading:b,error:j}=eu({mutate:e=>o(e||{}),onSuccess:()=>{null==i||i(),a()},logErrorMsg:"Failed to apply Stripe sync"});(0,Y.useEffect)(()=>{s&&n&&r&&g(),s||(f(),d(new Set),m(void 0))},[s,n,r]),(0,Y.useEffect)(()=>{x&&d(new Set)},[x]);const y=null!==(t=null==x?void 0:x.comparisons.filter(e=>e.is_different).length)&&void 0!==t?t:0,N=null==x?void 0:x.comparisons.find(e=>"stripe_subscription_status"===e.field_name),w=void 0!==u&&u!==(null==N?void 0:N.current_value),_=(null==x?void 0:x.has_differences)||w,k=(0,Y.useMemo)(()=>!r&&s?"This user does not have a Stripe customer ID":p?MH(p,"Failed to fetch Stripe data"):j?MH(j,"Failed to apply sync"):null,[r,s,p,j]);return(0,se.jsx)(Og,{open:s,onOpenChange:e=>!e&&a(),children:(0,se.jsxs)(Hg,{className:"sm:max-w-2xl",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsxs)(qg,{className:"flex items-center gap-2",children:[(0,se.jsx)(Fx.A,{className:"h-5 w-5 text-orange-500"}),"Sync from Stripe"]}),(0,se.jsxs)(Yg,{children:["Compare and sync subscription data from Stripe for"," ",(0,se.jsx)("span",{className:"font-medium text-slate-700",children:l})]})]}),(0,se.jsxs)("div",{className:"py-4",children:[h&&(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-slate-500",children:[(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin mb-3"}),(0,se.jsx)("p",{children:"Fetching data from Stripe..."})]}),k&&!h&&(0,se.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,se.jsx)("p",{className:"text-sm text-red-700 mt-1",children:k})]})]}),x&&!h&&!k&&(0,se.jsxs)("div",{className:"space-y-4",children:[_?(0,se.jsx)("div",{className:"text-sm text-slate-600",children:w&&!x.has_differences?(0,se.jsx)(se.Fragment,{children:"You have selected a different status value. Select the checkbox and click update to apply."}):(0,se.jsxs)(se.Fragment,{children:["Found ",(0,se.jsx)("span",{className:"font-semibold text-orange-600",children:y})," field(s) with differences. Select which fields to update:"]})}):(0,se.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-green-800",children:"All synced!"}),(0,se.jsx)("p",{className:"text-sm text-green-700",children:"Local data matches Stripe. No updates needed."})]})]}),(0,se.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,se.jsxs)("table",{className:"w-full text-sm",children:[(0,se.jsx)("thead",{className:"bg-slate-50 border-b",children:(0,se.jsxs)("tr",{children:[(0,se.jsx)("th",{className:"w-10 px-3 py-2.5"}),(0,se.jsx)("th",{className:"text-left px-3 py-2.5 font-medium text-slate-600",children:"Field"}),(0,se.jsx)("th",{className:"text-left px-3 py-2.5 font-medium text-slate-600",children:"Current Value"}),(0,se.jsx)("th",{className:"w-8 px-2"}),(0,se.jsx)("th",{className:"text-left px-3 py-2.5 font-medium text-slate-600",children:"Stripe Value"})]})}),(0,se.jsx)("tbody",{children:x.comparisons.map(e=>{var t;const s="stripe_subscription_status"===e.field_name,a=s&&void 0!==u&&u!==e.current_value,n=e.is_different||a;return(0,se.jsxs)("tr",{className:"border-b last:border-b-0 ".concat(n?"bg-orange-50/50":"bg-white"),children:[(0,se.jsx)("td",{className:"px-3 py-3",children:n&&(0,se.jsx)(E_,{checked:c.has(e.field_name),onCheckedChange:t=>((e,t)=>{const s=new Set(c);t?s.add(e):s.delete(e),d(s)})(e.field_name,!!t)})}),(0,se.jsx)("td",{className:"px-3 py-3 font-medium text-slate-700",children:IH[e.field_name]||e.field_name}),(0,se.jsx)("td",{className:"px-3 py-3 font-mono text-xs ".concat(n?"text-slate-500":"text-slate-600"),children:LH(e.current_value,e.field_name)}),(0,se.jsx)("td",{className:"px-2 py-3",children:n&&(0,se.jsx)(Ws.A,{className:"h-4 w-4 text-orange-400"})}),(0,se.jsx)("td",{className:"px-3 py-3 ".concat(n?"text-orange-700 font-semibold":"text-slate-600"),children:s?(0,se.jsxs)(Wf,{value:void 0===u?null!==(t=e.stripe_value)&&void 0!==t?t:"null":null!=u?u:"null",onValueChange:t=>{const s="null"===t?null:t;m(s),s!==e.current_value?d(t=>new Set([...Array.from(t),e.field_name])):d(t=>{const s=new Set(t);return s.delete(e.field_name),s})},children:[(0,se.jsx)(Yf,{className:"h-8 text-xs font-mono w-[160px]",children:(0,se.jsx)(qf,{})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"null",children:"\u2014 (No status)"}),PH.map(e=>(0,se.jsx)(Zf,{value:e.value,children:e.label},e.value))]})]}):(0,se.jsx)("span",{className:"font-mono text-xs",children:LH(e.stripe_value,e.field_name)})})]},e.field_name)})})]})})]})]}),(0,se.jsxs)(Wg,{className:"gap-2 sm:gap-0",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:a,disabled:b,children:"Cancel"}),_&&(0,se.jsx)(Bx,{onClick:()=>{if(0===c.size||!x)return;const e={};for(const t of Array.from(c))if("stripe_subscription_status"===t&&void 0!==u)e[t]=u;else{const s=x.comparisons.find(e=>e.field_name===t);s&&(e[t]=s.stripe_value)}v(e)},disabled:0===c.size||b,className:"bg-orange-500 hover:bg-orange-600",children:b?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}),"Updating..."]}):(0,se.jsxs)(se.Fragment,{children:["Update ",c.size," field",1!==c.size?"s":""]})})]})]})})}function DH(e){let{details:t,selectedUser:s,onUpdateUser:a,loading:n}=e;const[l,r]=(0,Y.useState)(!1),i=()=>{window.location.reload()};return t.is_personal?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Subscription Tier"}),(0,se.jsxs)(br,{value:s.subscription_tier,onValueChange:e=>a(s.id,{subscription_tier:e}),disabled:n,children:[(0,se.jsx)(Nr,{children:(0,se.jsx)(yr,{})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"free",children:"Free"}),(0,se.jsx)(Ar,{value:"starter",children:"Starter (Monthly USD)"}),(0,se.jsx)(Ar,{value:"starter_yearly",children:"Starter (Yearly USD)"}),(0,se.jsx)(Ar,{value:"starter_ils",children:"Starter (Monthly ILS)"}),(0,se.jsx)(Ar,{value:"starter_yearly_ils",children:"Starter (Yearly ILS)"}),(0,se.jsx)(Ar,{value:"builder",children:"Builder (Monthly USD)"}),(0,se.jsx)(Ar,{value:"builder_yearly",children:"Builder (Yearly USD)"}),(0,se.jsx)(Ar,{value:"builder_ils",children:"Builder (Monthly ILS)"}),(0,se.jsx)(Ar,{value:"builder_yearly_ils",children:"Builder (Yearly ILS)"}),(0,se.jsx)(Ar,{value:"pro",children:"Pro (Monthly USD)"}),(0,se.jsx)(Ar,{value:"pro_yearly",children:"Pro (Yearly USD)"}),(0,se.jsx)(Ar,{value:"pro_ils",children:"Pro (Monthly ILS)"}),(0,se.jsx)(Ar,{value:"pro_yearly_ils",children:"Pro (Yearly ILS)"}),(0,se.jsx)(Ar,{value:"elite",children:"Elite (Monthly USD)"}),(0,se.jsx)(Ar,{value:"elite_yearly",children:"Elite (Yearly USD)"}),(0,se.jsx)(Ar,{value:"elite_ils",children:"Elite (Monthly ILS)"}),(0,se.jsx)(Ar,{value:"elite_yearly_ils",children:"Elite (Yearly ILS)"}),(0,se.jsx)(Ar,{value:"elite_2",children:"Elite 2 (Monthly USD)"}),(0,se.jsx)(Ar,{value:"elite_2_yearly",children:"Elite 2 (Yearly USD)"}),(0,se.jsx)(Ar,{value:"elite_2_ils",children:"Elite 2 (Monthly ILS)"}),(0,se.jsx)(Ar,{value:"elite_2_yearly_ils",children:"Elite 2 (Yearly ILS)"}),(0,se.jsx)(Ar,{value:"elite_3",children:"Elite 3 (Monthly USD)"}),(0,se.jsx)(Ar,{value:"elite_3_yearly",children:"Elite 3 (Yearly USD)"}),(0,se.jsx)(Ar,{value:"elite_3_ils",children:"Elite 3 (Monthly ILS)"}),(0,se.jsx)(Ar,{value:"elite_3_yearly_ils",children:"Elite 3 (Yearly ILS)"}),(0,se.jsx)(Ar,{value:"elite_4",children:"Elite 4 (Monthly USD)"}),(0,se.jsx)(Ar,{value:"elite_4_yearly",children:"Elite 4 (Yearly USD)"}),(0,se.jsx)(Ar,{value:"elite_4_ils",children:"Elite 4 (Monthly ILS)"}),(0,se.jsx)(Ar,{value:"elite_4_yearly_ils",children:"Elite 4 (Yearly ILS)"}),(0,se.jsx)(Ar,{value:"enterprise",children:"Enterprise"})]})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"font-medium text-slate-700",children:"Stripe Data"}),t.stripe_customer_id&&(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>r(!0),className:"text-orange-600 border-orange-200 hover:bg-orange-50 hover:text-orange-700",children:[(0,se.jsx)(Fx.A,{className:"h-3.5 w-3.5 mr-1.5"}),"Sync from Stripe"]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-1 text-sm font-medium text-slate-600",children:"Customer ID"}),t.stripe_customer_id?(0,se.jsxs)("a",{href:(c=t.stripe_customer_id,"https://dashboard.stripe.com/customers/".concat(c)),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-orange-600 hover:text-orange-700 font-mono inline-flex items-center gap-1 hover:underline",children:[t.stripe_customer_id,(0,se.jsx)(Rj.A,{className:"h-3 w-3"})]}):(0,se.jsx)("p",{className:"text-sm text-slate-500 font-mono",children:"-"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-1 text-sm font-medium text-slate-600",children:"Subscription ID"}),t.stripe_subscription_id?(0,se.jsxs)("a",{href:(o=t.stripe_subscription_id,"https://dashboard.stripe.com/subscriptions/".concat(o)),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-orange-600 hover:text-orange-700 font-mono inline-flex items-center gap-1 hover:underline",children:[t.stripe_subscription_id,(0,se.jsx)(Rj.A,{className:"h-3 w-3"})]}):(0,se.jsx)("p",{className:"text-sm text-slate-500 font-mono",children:"-"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-1 text-sm font-medium text-slate-600",children:"Subscription Status"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:t.stripe_subscription_status||"-"})]})]}),(0,se.jsx)(RH,{isOpen:l,onClose:()=>r(!1),userId:s.id,userEmail:s.email,stripeCustomerId:t.stripe_customer_id,onSyncComplete:i,onUpdateUser:e=>a(s.id,e)})]}):(0,se.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Workspace Role"}),(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("owner"===t.user_role?"bg-purple-100 text-purple-800":"admin"===t.user_role?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:t.user_role})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Seat Status"}),(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("assigned"===t.seat_status?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"),children:"assigned"===t.seat_status?"Assigned":"Viewer"})]}),"assigned"===t.seat_status&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Seat Plan"}),(0,se.jsx)("p",{className:"text-sm text-gray-600",children:t.seat_type_name})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Seat Number"}),(0,se.jsxs)("p",{className:"text-sm text-gray-600",children:["#",t.seat_id]})]})]})]});var o,c}const FH=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"Not available";const s=He().utc(e).local();return t?"".concat(s.format("MMM DD, YYYY [at] HH:mm")," (").concat(s.fromNow(),")"):"".concat(s.format("MMM DD, YYYY")," (").concat(s.fromNow(),")")};function OH(e){let{selectedUser:t,workspaceDetails:s,onUpdateUser:a,loading:n,loadingStates:l,latestCountry:r}=e;const{user:i}=wd(),o="platform_owner"===(null==i?void 0:i.platform_role);return t?(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Full Name"}),(0,se.jsx)(nl,{type:"text",value:t.full_name||"",onChange:e=>a(t.id,{full_name:e.target.value}),disabled:n})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Username"}),(0,se.jsx)("p",{className:"text-gray-600",children:t.username||"-"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Account Created"}),(0,se.jsx)("p",{className:"text-gray-600",children:FH(t.created_date,!0)})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Latest Country"}),l.latestCountry?(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):(0,se.jsx)("p",{className:"text-gray-600",children:r||"-"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Phone Number"}),(0,se.jsx)(nl,{type:"text",value:t.phone_number||"",onChange:e=>a(t.id,{phone_number:e.target.value}),disabled:n})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Platform Role"}),!o&&(0,se.jsxs)("div",{className:"mb-2 flex items-start gap-2 p-3 bg-orange-50 border border-orange-200 rounded-md",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-orange-600 mt-0.5 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-slate-700",children:"Only Platform Owners can change user roles"})]}),(0,se.jsxs)(br,{value:t.platform_role,onValueChange:async e=>{window.confirm("Are you sure you want to change ".concat(t.email,"'s platform role?"))&&(await a(t.id,{platform_role:e}),alert("Platform role successfully updated to: ".concat(e)))},disabled:n||!o,children:[(0,se.jsx)(Nr,{children:(0,se.jsx)(yr,{})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"user",children:"User"}),(0,se.jsx)(Ar,{value:"support_personnel",children:"Support Personnel"}),(0,se.jsx)(Ar,{value:"platform_admin",children:"Platform Admin"}),(0,se.jsx)(Ar,{value:"platform_owner",children:"Platform Owner"})]})]})]}),l.workspaces?(0,se.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}),"Loading workspace details..."]})}):s?(0,se.jsx)(DH,{details:s,selectedUser:t,onUpdateUser:a,loading:n}):null,(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"API Key"}),(0,se.jsx)("p",{className:"text-sm text-gray-600 font-mono break-all",children:t.api_key||"-"})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(Os,{id:"beta-tester",checked:t.is_beta_tester||!1,onCheckedChange:e=>a(t.id,{is_beta_tester:e}),disabled:n}),(0,se.jsx)("label",{htmlFor:"beta-tester",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Beta Tester"})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(Os,{id:"user-disabled",checked:t.disabled||!1,onCheckedChange:e=>a(t.id,{disabled:e}),disabled:n}),(0,se.jsx)("label",{htmlFor:"user-disabled",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Disable User Account"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"mb-2 font-medium",children:"Account Status"}),(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(t.disabled?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:t.disabled?"Disabled":"Active"})]})]}):null}function UH(e){let{usageByDate:t,height:s}=e;const a=e=>{try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(t){return e}},n=(e=>{if(!e||!Array.isArray(e))return[];return[...e].sort((e,t)=>new Date(e._id)-new Date(t._id)).slice(-10).map(e=>(0,ue.A)((0,ue.A)({},e),{},{date:a(e._id),total_messages:e.total_messages||0}))})(t),l=e=>{let{active:t,payload:s,label:a}=e;return t&&s&&s.length?(0,se.jsxs)("div",{className:"bg-white p-3 border border-gray-200 shadow-lg rounded-md text-xs",children:[(0,se.jsx)("p",{className:"font-medium text-gray-900",children:s[0].payload.date}),(0,se.jsxs)("p",{className:"text-slate-700 mt-1",children:[(0,se.jsx)("span",{className:"font-medium",children:s[0].value})," messages"]})]}):null};return n.length?(0,se.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium leading-tight",children:"Daily Usage (Messages)"}),(0,se.jsx)("div",{className:"".concat(s||"h-40"),children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(xA.E,{data:n,margin:{top:0,right:0,left:0,bottom:0},padding:{top:0,right:0,left:0,bottom:0},children:[(0,se.jsx)(XC.d,{stroke:"#F3F4F6",vertical:!1,strokeWidth:1}),(0,se.jsx)(eA.W,{dataKey:"date",textAnchor:"middle",height:26,fontSize:12,stroke:"#6b7280",tickMargin:10,axisLine:!1,tickLine:!1}),(0,se.jsx)(tA.h,{fontSize:12,stroke:"#6b7280",axisLine:!1,tickLine:!1,tickCount:5,tickFormatter:e=>0===e?"0":e,width:38}),(0,se.jsx)(aA.m,{content:(0,se.jsx)(l,{}),cursor:{fill:"rgba(71, 85, 105, 0.1)"}}),(0,se.jsx)(hA.y,{dataKey:"total_messages",name:"Messages",fill:"#f1f5f9",stroke:"#d1d5db",strokeWidth:1,radius:[4,4,0,0],maxBarSize:50,animationDuration:2e3})]})})})]}):(0,se.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium leading-tight",children:"Daily Usage (Messages)"}),(0,se.jsx)("div",{className:"h-40 flex items-center justify-center",children:(0,se.jsx)("div",{className:"text-gray-500 text-sm",children:"No usage data available"})})]})}function BH(e){let{userUsageStats:t,dateRange:s,onDateRangeChange:a,selectedWorkspace:n,onSwitchToCreditsTab:l,isLoading:r}=e;const[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{if(!n)return void h(null);let e=!1;return(async()=>{g(!0);try{const t=await Yd.default.getOrganizationRuntimeStatus(n);e||h(t)}catch(t){e||h(null)}finally{e||g(!1)}})(),()=>{e=!0}},[n]);const b=(e,t)=>{d({startDate:e,endDate:t})};if(r||!t)return(0,se.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-gray-400"}),(0,se.jsx)("p",{className:"text-gray-500",children:"Loading usage statistics..."})]})});const j=t.integration_credits_limit>0?Math.round(t.integration_credits_usage/t.integration_credits_limit*100):0,y=t.integration_credits_usage>=t.integration_credits_limit;return(0,se.jsxs)("div",{className:"space-y-8",children:[(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Message Credits"}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,se.jsxs)("span",{className:"text-sm font-medium",children:["Monthly Usage: ",t.monthly_usage," / ",t.monthly_limit]}),(0,se.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(t.monthly_usage/t.monthly_limit*100),"%"]})]}),(0,se.jsx)(tr,{value:t.monthly_usage/t.monthly_limit*100,className:"h-2",indicatorClassName:t.is_over_limit?"bg-red-500":void 0})]}),t.daily_limit&&(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,se.jsxs)("span",{className:"text-sm font-medium",children:["Daily Usage: ",t.daily_usage," / ",t.daily_limit]}),(0,se.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(t.daily_usage/t.daily_limit*100),"%"]})]}),(0,se.jsx)(tr,{value:t.daily_usage/t.daily_limit*100,className:"h-2",indicatorClassName:t.is_over_limit?"bg-red-500":void 0})]})]})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Integration Credits"}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,se.jsxs)("span",{className:"text-sm font-medium",children:["Usage: ",t.integration_credits_usage," / ",t.integration_credits_limit]}),(0,se.jsxs)("span",{className:"text-sm text-gray-500",children:[j,"%"]})]}),(0,se.jsx)(tr,{value:j,className:"h-2",indicatorClassName:y?"bg-red-500":void 0})]}),t.integration_credits_breakdown&&Object.keys(t.integration_credits_breakdown).length>0&&t.integration_credits_usage>0&&(0,se.jsxs)("div",{className:"mt-4",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Breakdown"}),(0,se.jsx)("div",{className:"space-y-1.5",children:Object.entries(t.integration_credits_breakdown).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).map(e=>{let[s,a]=e;const n=a/t.integration_credits_usage*100,l=n<.01?"< 0.01":n<.1?n.toFixed(2):n.toFixed(1);return(0,se.jsxs)("div",{className:"flex items-center text-sm",children:[(0,se.jsxs)("span",{className:"w-14 text-gray-400 text-xs tabular-nums text-right pr-2",children:[l,"%"]}),(0,se.jsx)("span",{className:"flex-1 text-gray-600 truncate",children:s}),(0,se.jsx)("span",{className:"font-medium text-gray-900 tabular-nums",children:a.toLocaleString()})]},s)})})]}),(0,se.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Runtime View Status"}),p?(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin"}),(0,se.jsx)("span",{children:"Loading..."})]}):x?(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("div",{className:"flex items-center gap-2",children:x.is_blocked?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-red-500"}),(0,se.jsx)("span",{className:"text-sm text-red-600 font-medium",children:"Blocked"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(sd.A,{className:"h-4 w-4 text-green-500"}),(0,se.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Active"})]})}),x.is_blocked&&(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:async()=>{if(!n)return;const e=n;v(!0);try{if(await Yd.default.clearOrganizationRuntimeBlock(n),e===n){const t=await Yd.default.getOrganizationRuntimeStatus(n);e===n&&h(t)}}catch(t){}finally{e===n&&v(!1)}},disabled:f,className:"h-7 px-2 text-xs",children:[f?(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin"}):(0,se.jsx)(Fx.A,{className:"h-3 w-3"}),(0,se.jsx)("span",{className:"ml-1",children:"Clear Block"})]})]}),x.is_blocked&&x.blocked_at&&(0,se.jsxs)("div",{className:"text-xs text-gray-500",children:["Blocked at: ",He()(x.blocked_at).format("MMM D, YYYY h:mm A")]})]}):(0,se.jsx)("div",{className:"text-sm text-gray-500",children:"Unable to load status"})]})]})]}),t.usage_by_date&&(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold",children:"Usage History"}),(0,se.jsxs)(Zl,{open:i,onOpenChange:o,children:[(0,se.jsx)(Jl,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"outline",className:"flex items-center gap-2",disabled:u,children:[(0,se.jsx)(H_.A,{className:"h-4 w-4"}),s.startDate&&s.endDate?"".concat(He()(s.startDate).format("MMM D, YYYY")," - ").concat(He()(s.endDate).format("MMM D, YYYY")):"Select Date Range"]})}),(0,se.jsx)(Ql,{className:"w-auto p-0",align:"end",children:(0,se.jsxs)("div",{className:"p-3 border-b",children:[(0,se.jsx)("h4",{className:"font-medium mb-2",children:"Select Date Range"}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date"}),(0,se.jsx)(Ns,{mode:"single",selected:(null==c?void 0:c.startDate)||s.startDate,onSelect:e=>b(e,(null==c?void 0:c.endDate)||s.endDate),className:"rounded-md border"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"text-sm text-gray-600",children:"End Date"}),(0,se.jsx)(Ns,{mode:"single",selected:(null==c?void 0:c.endDate)||s.endDate,onSelect:e=>b((null==c?void 0:c.startDate)||s.startDate,e),className:"rounded-md border"})]})]}),(0,se.jsxs)("div",{className:"flex justify-end gap-2 mt-3",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>{if(t){const e=new Date(t.current_credit_period_start_date),s=new Date(t.current_credit_period_end_date);m(!0),a(e,s,n,()=>{m(!1)})}d(null)},children:"Reset"}),(0,se.jsx)(zt,{size:"sm",onClick:()=>{c&&(m(!0),a(c.startDate,c.endDate,n,()=>{m(!1)})),o(!1)},children:"Apply"})]})]})})]})]}),(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(UH,{usageByDate:t.usage_by_date,height:"h-[260px]"})})]}),(0,se.jsx)(Es,{children:(0,se.jsxs)(Ls,{className:"pt-6 space-y-6",children:[(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Subscription Tier"}),(0,se.jsx)("p",{className:"text-lg font-semibold capitalize",children:t.tier})]}),(0,se.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Bonus Credits"}),(0,se.jsx)("p",{className:"text-lg font-semibold",children:t.extra_credits})]})]}),(0,se.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Billing Period"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"font-medium",children:"Start:"}),(0,se.jsx)("span",{children:He()(t.current_credit_period_start_date).format("MMM DD, YYYY")})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"font-medium",children:"End:"}),(0,se.jsx)("span",{children:He()(t.current_credit_period_end_date).format("MMM DD, YYYY")})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"font-medium",children:"Next Start:"}),(0,se.jsx)("span",{children:He()(t.next_period_start_date).format("MMM DD, YYYY")})]})]})]})]})}),t.is_over_limit&&(0,se.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:[(0,se.jsx)("p",{className:"font-medium",children:"User is over their message credits limit"}),(0,se.jsx)("p",{className:"text-sm",children:"Consider adding bonus credits or upgrading their subscription tier."})]}),y&&(0,se.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:[(0,se.jsx)("p",{className:"font-medium",children:"User is over their integration credits limit"}),(0,se.jsx)("p",{className:"text-sm",children:"Consider upgrading their subscription tier for more integration credits."})]}),(0,se.jsxs)(zt,{onClick:l,className:"w-full mt-8",children:[(0,se.jsx)(Bz.A,{className:"h-4 w-4 mr-2"}),"Add Bonus Credits"]})]})}function zH(e){let{userBonusCredits:t,onAddBonusCredits:s,onDeleteBonusCredit:a,loading:n}=e;const[l,r]=(0,Y.useState)({numMessages:0,reason:""});return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold",children:"Bonus Credits"}),t.length>0?(0,se.jsx)("div",{className:"space-y-3 mb-4",children:t.map((e,t)=>(0,se.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsxs)("span",{className:"font-medium",children:[e.num_messages," messages"]}),(0,se.jsx)("span",{className:"text-sm text-gray-600",children:He()(e.created_date).format("MMM DD, YYYY")})]}),(0,se.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:e.reason}),(0,se.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,se.jsxs)("p",{className:"text-xs text-gray-500",children:["Expires: ",He()(e.expires_date).format("MMM DD, YYYY")]}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>a(e.id),disabled:n,children:(0,se.jsx)(zy.A,{className:"h-4 w-4"})})]})]},t))}):(0,se.jsx)("p",{className:"text-gray-500 mb-4",children:"No bonus credits found for this user."}),(0,se.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,se.jsx)("h4",{className:"font-medium mb-3",children:"Add Bonus Credits"}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"text-sm text-gray-600",children:"Number of Messages"}),(0,se.jsx)(nl,{type:"number",min:"1",value:l.numMessages,onChange:e=>r((0,ue.A)((0,ue.A)({},l),{},{numMessages:e.target.value})),disabled:n})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"text-sm text-gray-600",children:"Reason"}),(0,se.jsx)(nl,{type:"text",value:l.reason,onChange:e=>r((0,ue.A)((0,ue.A)({},l),{},{reason:e.target.value})),placeholder:"e.g., Promotional offer, Customer support",disabled:n})]}),(0,se.jsxs)(zt,{onClick:()=>{l.numMessages&&l.reason&&(s(parseInt(l.numMessages),l.reason),r({numMessages:0,reason:""}))},disabled:n||!l.numMessages||!l.reason,className:"w-full",children:[(0,se.jsx)(op.A,{className:"h-4 w-4 mr-2"}),"Add Credits"]})]})]})]})}class HH extends te.H{getBaseURL(){return"/gdpr"}submitDeleteRequest(e,t){return this.axios.post("/delete",{user_id:e,email:t})}processRequest(e){return this.axios.post("/process/".concat(e))}retryRequest(e){return this.axios.post("/retry/".concat(e))}getRequest(e){return this.axios.get("/request/".concat(e))}cancelRequest(e){return this.axios.delete("/request/".concat(e))}getRequestsByUserId(e){return this.axios.get("/requests/user/".concat(e))}getRequestsByEmail(e){return this.axios.get("/requests/email/".concat(e))}getTasksByRequestId(e){return this.axios.get("/tasks/".concat(e))}submitOwnDeleteRequest(){return this.axios.post("/me/delete")}getOwnRequests(){return this.axios.get("/me/requests")}cancelOwnRequest(e){return this.axios.delete("/me/request/".concat(e))}}const VH=new HH;function WH(e){const t=He().utc(e).clone().add(7,"days"),s=He().utc(),a=s.isAfter(t),n=Math.max(0,t.diff(s,"days")),l=Math.max(0,t.diff(s,"hours")%24);return{gracePeriodEnd:t,isGracePeriodOver:a,daysRemaining:n,hoursRemaining:l,formattedEnd:t.local().format("MMM DD, YYYY HH:mm")}}function qH(e,t){return e>0?"".concat(e," day").concat(1!==e?"s":""," and ").concat(t," hour").concat(1!==t?"s":""," remaining"):"".concat(t," hour").concat(1!==t?"s":""," remaining")}const YH={pending:{icon:jS.A,color:"text-amber-600",bg:"bg-amber-50",label:"Pending"},in_progress:{icon:Ac.A,color:"text-blue-600",bg:"bg-blue-50",label:"In Progress",spin:!0},done:{icon:sd.A,color:"text-green-600",bg:"bg-green-50",label:"Completed"},failed:{icon:Uy.A,color:"text-red-600",bg:"bg-red-50",label:"Failed"},cancelled:{icon:la.A,color:"text-slate-500",bg:"bg-slate-50",label:"Cancelled"}},GH={init:{color:"text-slate-500",bg:"bg-slate-100"},in_progress:{color:"text-blue-600",bg:"bg-blue-100"},done:{color:"text-green-600",bg:"bg-green-100"},failed:{color:"text-red-600",bg:"bg-red-100"}};function KH(e){let{status:t}=e;const s=YH[t]||YH.pending,a=s.icon;return(0,se.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ".concat(s.bg," ").concat(s.color),children:[(0,se.jsx)(a,{className:"h-3.5 w-3.5 ".concat(s.spin?"animate-spin":"")}),s.label]})}function $H(e){let{status:t}=e;const s=GH[t]||GH.init;return(0,se.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(s.bg," ").concat(s.color),children:t})}function ZH(e){let{createdDate:t}=e;const{isGracePeriodOver:s,daysRemaining:a,hoursRemaining:n,formattedEnd:l}=WH(t);return s?(0,se.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 text-green-700",children:[(0,se.jsx)(sd.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"text-sm font-medium",children:"Grace period ended"})]}),(0,se.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["This request can now be processed. The 7-day grace period ended on ",l,"."]})]}):(0,se.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 text-blue-700",children:[(0,se.jsx)(H_.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"text-sm font-medium",children:"7-Day Grace Period Active"})]}),(0,se.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:[qH(a,n)," until ",l,". User can cancel during this time."]})]})}function JH(e){let{selectedUser:t}=e;const[s,a]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)({}),m=(0,Y.useCallback)(async()=>{if(null!=t&&t.id){l(!0);try{const e=await VH.getRequestsByUserId(t.id);a(e||[])}catch(e){a([])}finally{l(!1)}}},[null==t?void 0:t.id]);(0,Y.useEffect)(()=>{m()},[m]);const x=async e=>{try{const t=await VH.getTasksByRequestId(e);u(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t||[]}))}catch(t){}},h=s.some(e=>"pending"===e.status||"in_progress"===e.status);return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold",children:"GDPR Data Deletion"}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:m,disabled:n,children:(0,se.jsx)(Fx.A,{className:"h-4 w-4 ".concat(n?"animate-spin":"")})})]}),(0,se.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"text-sm text-amber-800",children:[(0,se.jsx)("p",{className:"font-medium",children:"Permanent Action"}),(0,se.jsx)("p",{className:"mt-1",children:"GDPR deletion permanently removes all user data from our systems and third-party services. This cannot be undone."})]})]})}),!h&&(0,se.jsxs)(Zt,{children:[(0,se.jsx)(Jt,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"destructive",className:"w-full",disabled:"create"===r,children:["create"===r?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(Ap.A,{className:"h-4 w-4 mr-2"}),"Create GDPR Deletion Request"]})}),(0,se.jsxs)(es,{children:[(0,se.jsxs)(ts,{children:[(0,se.jsx)(as,{children:"Create GDPR Deletion Request?"}),(0,se.jsxs)(ns,{children:["This will create a deletion request for ",(0,se.jsx)("strong",{children:null==t?void 0:t.email}),". The request will be in pending status until you manually process it."]})]}),(0,se.jsxs)(ss,{children:[(0,se.jsx)(rs,{children:"Cancel"}),(0,se.jsx)(ls,{onClick:async()=>{if(t){i("create");try{await VH.submitDeleteRequest(t.id,t.email),await m()}catch(e){}finally{i(null)}}},children:"Create Request"})]})]})]}),n?(0,se.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin text-slate-400"})}):0===s.length?(0,se.jsx)("p",{className:"text-slate-500 text-center py-4",children:"No GDPR requests found for this user."}):(0,se.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,se.jsxs)("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[(0,se.jsx)("div",{className:"p-4 bg-white cursor-pointer hover:bg-slate-50 transition-colors",onClick:()=>{return t=e.id,void(o===t?c(null):(c(t),d[t]||x(t)));var t},children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(KH,{status:e.status}),(0,se.jsxs)("span",{className:"text-xs text-slate-500 font-mono",children:[e.id.slice(0,8),"..."]}),"pending"===e.status&&(()=>{const{isGracePeriodOver:t,daysRemaining:s,hoursRemaining:a}=WH(e.created_date);return t?(0,se.jsx)("span",{className:"text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded",children:"Ready to process"}):(0,se.jsxs)("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded",children:[s>0?"".concat(s,"d"):"".concat(a,"h")," grace period"]})})()]}),(0,se.jsx)("span",{className:"text-sm text-slate-500",children:He().utc(e.created_date).local().format("MMM DD, YYYY HH:mm")})]})}),o===e.id&&(0,se.jsxs)("div",{className:"border-t border-slate-200 bg-slate-50 p-4 space-y-4",children:["pending"===e.status&&(0,se.jsx)(ZH,{createdDate:e.created_date}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Request ID:"}),(0,se.jsx)("p",{className:"font-mono text-xs mt-1",children:e.id})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Type:"}),(0,se.jsx)("p",{className:"mt-1",children:e.request_type})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Email:"}),(0,se.jsx)("p",{className:"mt-1",children:e.email})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Updated:"}),(0,se.jsx)("p",{className:"mt-1",children:He().utc(e.updated_date).local().format("MMM DD, YYYY HH:mm")})]})]}),d[e.id]&&d[e.id].length>0&&(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-2",children:"Tasks"}),(0,se.jsx)("div",{className:"space-y-2",children:d[e.id].map(e=>(0,se.jsxs)("div",{className:"flex items-center justify-between bg-white p-2 rounded border border-slate-200",children:[(0,se.jsx)("span",{className:"text-sm",children:e.data_source_name}),(0,se.jsx)($H,{status:e.status})]},e.id))})]}),"pending"===e.status&&(()=>{const{isGracePeriodOver:t,daysRemaining:s}=WH(e.created_date);return(0,se.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,se.jsxs)(Zt,{children:[(0,se.jsx)(Jt,{asChild:!0,children:(0,se.jsxs)(zt,{size:"sm",variant:t?"default":"outline",disabled:r===e.id,children:[r===e.id?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-1 animate-spin"}):(0,se.jsx)(LF.A,{className:"h-4 w-4 mr-1"}),t?"Process Now":"Process Early"]})}),(0,se.jsxs)(es,{children:[(0,se.jsxs)(ts,{children:[(0,se.jsx)(as,{children:t?"Process GDPR Deletion?":"Process Before Grace Period Ends?"}),(0,se.jsxs)(ns,{className:"space-y-2",children:[!t&&(0,se.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded p-2 text-amber-800 text-sm",children:[(0,se.jsx)("strong",{children:"Warning:"})," The 7-day grace period has not ended.",s>0?" There are still ".concat(s," day(s) remaining."):" There are still a few hours remaining."]}),(0,se.jsxs)("p",{children:["This will permanently delete all data for ",(0,se.jsx)("strong",{children:e.email})," from all systems. This action cannot be undone."]})]})]}),(0,se.jsxs)(ss,{children:[(0,se.jsx)(rs,{children:"Cancel"}),(0,se.jsx)(ls,{onClick:()=>(async e=>{i(e);try{await VH.processRequest(e),await m(),o===e&&await x(e)}catch(t){}finally{i(null)}})(e.id),className:"bg-red-600 hover:bg-red-700",children:"Delete All Data"})]})]})]}),(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>(async e=>{i(e);try{await VH.cancelRequest(e),await m()}catch(t){}finally{i(null)}})(e.id),disabled:r===e.id,children:[(0,se.jsx)(la.A,{className:"h-4 w-4 mr-1"}),"Cancel Request"]})]})})(),"failed"===e.status&&(0,se.jsx)("div",{className:"flex gap-2 pt-2",children:(0,se.jsxs)(Zt,{children:[(0,se.jsx)(Jt,{asChild:!0,children:(0,se.jsxs)(zt,{size:"sm",variant:"default",disabled:r===e.id,children:[r===e.id?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-1 animate-spin"}):(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-1"}),"Retry Failed Tasks"]})}),(0,se.jsxs)(es,{children:[(0,se.jsxs)(ts,{children:[(0,se.jsx)(as,{children:"Retry Failed Tasks?"}),(0,se.jsxs)(ns,{children:[(0,se.jsx)("p",{children:"This will retry only the failed tasks for this GDPR request. Tasks that already succeeded will not be re-run."}),d[e.id]&&(0,se.jsxs)("div",{className:"mt-3 space-y-1",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Failed tasks:"}),(0,se.jsx)("ul",{className:"text-sm text-red-600 list-disc list-inside",children:d[e.id].filter(e=>"failed"===e.status).map(e=>(0,se.jsx)("li",{children:e.data_source_name},e.id))})]})]})]}),(0,se.jsxs)(ss,{children:[(0,se.jsx)(rs,{children:"Cancel"}),(0,se.jsx)(ls,{onClick:()=>(async e=>{i(e);try{await VH.retryRequest(e),await m(),o===e&&await x(e)}catch(t){}finally{i(null)}})(e.id),children:"Retry Now"})]})]})]})})]})]},e.id))})]})}function QH(e){let{selectedUser:t}=e;const[s,a]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(null);if((0,Y.useEffect)(()=>{if(!t)return;(async()=>{l(!0),i(null);try{const e=await jd.getUserFeatureFlags(t.id);a(e.flags||[])}catch(e){i("Failed to load feature flags")}finally{l(!1)}})()},[t]),!t)return null;if(n)return(0,se.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,se.jsx)(Ac.A,{className:"h-5 w-5 animate-spin text-gray-400"}),(0,se.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"Loading feature flags..."})]});if(r)return(0,se.jsx)("div",{className:"py-4 text-sm text-red-600",children:r});const o=s.filter(e=>e.enabled),c=s.filter(e=>!e.enabled);return(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsxs)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:["Enabled (",o.length,")"]}),0===o.length?(0,se.jsx)("p",{className:"text-sm text-gray-400",children:"No flags enabled"}):(0,se.jsx)("div",{className:"space-y-1",children:o.map(e=>(0,se.jsxs)("div",{className:"flex items-center gap-2 py-1 px-2 bg-green-50 rounded text-sm",children:[(0,se.jsx)(Ds.A,{className:"h-3.5 w-3.5 text-green-600 flex-shrink-0"}),(0,se.jsx)("span",{className:"text-gray-700 font-mono text-xs",children:e.name})]},e.name))})]}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:["Disabled (",c.length,")"]}),(0,se.jsx)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:c.map(e=>(0,se.jsxs)("div",{className:"flex items-center gap-2 py-1 px-2 bg-gray-50 rounded text-sm",children:[(0,se.jsx)(la.A,{className:"h-3.5 w-3.5 text-gray-400 flex-shrink-0"}),(0,se.jsx)("span",{className:"text-gray-500 font-mono text-xs",children:e.name})]},e.name))})]})]})}function XH(e){let{workspaces:t,selectedWorkspace:s,onWorkspaceChange:a,loading:n,disabled:l=!1}=e;return(0,se.jsxs)("div",{className:"w-full relative",children:[(0,se.jsxs)(br,{value:s||"",onValueChange:a,disabled:n||l,children:[(0,se.jsx)(Nr,{className:"text-sm",children:(0,se.jsx)(yr,{placeholder:"Select workspace..."})}),(0,se.jsx)(kr,{children:t.map(e=>(0,se.jsx)(Ar,{value:e.id,children:(0,se.jsx)("span",{children:e.is_personal?"Personal":e.name})},e.id))})]}),n&&(0,se.jsx)("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-gray-400"})})]})}const eV={workspaces:!1,usageStats:!1,latestCountry:!1};function tV(e){let{selectedUser:t,onClose:s,onUpdateUser:a,userBonusCredits:n,onAddBonusCredits:l,onDeleteBonusCredit:r,loading:i,userUsageStats:o,onDateRangeChange:c,dateRange:d}=e;const[u,m]=(0,Y.useState)("details"),[x,h]=(0,Y.useState)(d),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)(null),[b,j]=(0,Y.useState)(null),[y,N]=(0,Y.useState)(eV),[w,_]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{h(d)},[d]),(0,Y.useEffect)(()=>{if(o&&(null==d||!d.startDate)&&(null==x||!x.startDate)){const e=new Date(o.current_credit_period_start_date),t=new Date(o.current_credit_period_end_date);h({startDate:e,endDate:t})}},[o,d,x]),(0,Y.useEffect)(()=>{if(!t)return g([]),v(null),j(null),void _(null);(async()=>{N(e=>(0,ue.A)((0,ue.A)({},e),{},{workspaces:!0}));try{var e;const s=await Yd.default.getUserWorkspacesWithDetails(t.id);g(s.workspaces||[]);const a=null===(e=s.workspaces)||void 0===e?void 0:e.find(e=>e.is_personal);a&&(v(a.id),j(a))}catch(s){g([])}finally{N(e=>(0,ue.A)((0,ue.A)({},e),{},{workspaces:!1}))}})(),(async()=>{N(e=>(0,ue.A)((0,ue.A)({},e),{},{latestCountry:!0}));try{const e=await SH.getUserLatestCountry(t.email);_(e.latest_country)}catch(e){_(null)}finally{N(e=>(0,ue.A)((0,ue.A)({},e),{},{latestCountry:!1}))}})()},[t]);return(0,se.jsx)(Fr,{open:!!t,onOpenChange:s,className:"bg-white",children:(0,se.jsxs)(Vr,{className:"sm:max-w-xl overflow-y-auto",children:[(0,se.jsx)(Wr,{children:(0,se.jsx)(Yr,{children:"User Details"})}),t&&(0,se.jsxs)("div",{className:"py-6",children:[(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold",children:t.full_name||t.email}),p&&p.length>1&&(0,se.jsx)("div",{className:"w-48",children:(0,se.jsx)(XH,{workspaces:p,selectedWorkspace:f,onWorkspaceChange:e=>{v(e);const t=p.find(t=>t.id===e);j(t),x.startDate&&x.endDate&&(N(e=>(0,ue.A)((0,ue.A)({},e),{},{usageStats:!0})),c(x.startDate,x.endDate,e,()=>{N(e=>(0,ue.A)((0,ue.A)({},e),{},{usageStats:!1}))}))},loading:y.workspaces})})]}),(0,se.jsx)("p",{className:"text-gray-600",children:t.email}),b&&!b.is_personal&&(0,se.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[b.name," (".concat(b.user_role,")")]})]}),(0,se.jsxs)(ji,{defaultValue:"details",className:"w-full",onValueChange:m,value:u,children:[(0,se.jsxs)(yi,{className:"grid grid-cols-5 mb-6",children:[(0,se.jsxs)(Ni,{value:"details",className:"flex items-center gap-2",children:[(0,se.jsx)(ay.A,{className:"h-4 w-4"}),"Details"]}),(0,se.jsxs)(Ni,{value:"usage",className:"flex items-center gap-2",children:[(0,se.jsx)(Xv.A,{className:"h-4 w-4"}),"Usage"]}),(0,se.jsxs)(Ni,{value:"credits",className:"flex items-center gap-2",children:[(0,se.jsx)(Bz.A,{className:"h-4 w-4"}),"Credits"]}),(0,se.jsxs)(Ni,{value:"gdpr",className:"flex items-center gap-2",children:[(0,se.jsx)(HO.A,{className:"h-4 w-4"}),"GDPR"]}),(0,se.jsxs)(Ni,{value:"flags",className:"flex items-center gap-2",children:[(0,se.jsx)(CH.A,{className:"h-4 w-4"}),"Flags"]})]}),(0,se.jsx)(wi,{value:"details",children:(0,se.jsx)(OH,{selectedUser:t,workspaceDetails:b,onUpdateUser:a,loading:i,loadingStates:y,latestCountry:w})}),(0,se.jsx)(wi,{value:"usage",children:(0,se.jsx)(BH,{userUsageStats:o,dateRange:x,onDateRangeChange:c,selectedWorkspace:f,onSwitchToCreditsTab:()=>m("credits"),isLoading:y.usageStats})}),(0,se.jsx)(wi,{value:"credits",children:(0,se.jsx)(zH,{userBonusCredits:n,onAddBonusCredits:(e,s)=>{l(t.id,e,s)},onDeleteBonusCredit:e=>{r(e)},loading:i})}),(0,se.jsx)(wi,{value:"gdpr",children:(0,se.jsx)(JH,{selectedUser:t})}),(0,se.jsx)(wi,{value:"flags",children:(0,se.jsx)(QH,{selectedUser:t})})]})]})]})})}function sV(){const[e,t]=(0,Y.useState)(!1),[s,a]=(0,Y.useState)([]),[n,l]=(0,Y.useState)({startDate:He()().subtract(7,"days").format("YYYY-MM-DD"),endDate:He()().format("YYYY-MM-DD")}),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{d()},[n.startDate,n.endDate]);const d=async()=>{t(!0);try{const e=await SH.getTopUsers(n.startDate,n.endDate);a(e)}catch(e){}finally{t(!1)}},u=e=>{l("ever"===e?{startDate:"2020-01-01",endDate:He()().format("YYYY-MM-DD")}:{startDate:He()().subtract(e,"days").format("YYYY-MM-DD"),endDate:He()().format("YYYY-MM-DD")})};return(0,se.jsxs)(Es,{className:"mb-8",children:[(0,se.jsx)(Ts,{children:(0,se.jsxs)(Is,{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{children:"Top Users by Message Count"}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>u(1),className:n.startDate===He()().subtract(1,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"1 Day"}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>u(7),className:n.startDate===He()().subtract(7,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"7 Days"}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>u(15),className:n.startDate===He()().subtract(15,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"15 Days"}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>u(30),className:n.startDate===He()().subtract(30,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"30 Days"}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>u("ever"),className:"2020-01-01"===n.startDate?"bg-blue-50":"",children:"All Time"}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,se.jsxs)(Zl,{open:r,onOpenChange:i,children:[(0,se.jsx)(Jl,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[(0,se.jsx)(H_.A,{className:"h-3.5 w-3.5"}),(0,se.jsx)("span",{children:n.startDate})]})}),(0,se.jsx)(Ql,{className:"w-auto p-0",children:(0,se.jsx)(Ns,{mode:"single",selected:new Date(n.startDate),onSelect:e=>{const t=He()(e).format("YYYY-MM-DD");l(e=>(0,ue.A)((0,ue.A)({},e),{},{startDate:t})),i(!1)},initialFocus:!0,disabled:e=>e>new Date(n.endDate)||e>new Date})})]}),(0,se.jsx)("span",{children:"to"}),(0,se.jsxs)(Zl,{open:o,onOpenChange:c,children:[(0,se.jsx)(Jl,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[(0,se.jsx)(H_.A,{className:"h-3.5 w-3.5"}),(0,se.jsx)("span",{children:n.endDate})]})}),(0,se.jsx)(Ql,{className:"w-auto p-0",children:(0,se.jsx)(Ns,{mode:"single",selected:new Date(n.endDate),onSelect:e=>{const t=He()(e).format("YYYY-MM-DD");l(e=>(0,ue.A)((0,ue.A)({},e),{},{endDate:t})),c(!1)},initialFocus:!0,disabled:e=>e<new Date(n.startDate)||e>new Date})})]})]})]})]})}),(0,se.jsx)(Ls,{children:e?(0,se.jsx)("div",{className:"text-center py-8",children:"Loading top users data..."}):0===s.length?(0,se.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No data available for the selected date range"}):(0,se.jsx)("div",{className:"overflow-x-auto",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{children:"Email"}),(0,se.jsx)(hi,{children:"Full Name"}),(0,se.jsx)(hi,{children:"Subscription"}),(0,se.jsx)(hi,{children:"Role"}),(0,se.jsx)(hi,{className:"text-right",children:(0,se.jsxs)("div",{className:"flex items-center justify-end",children:[(0,se.jsx)(Xx.A,{className:"h-4 w-4 mr-2"}),"Messages"]})})]})}),(0,se.jsx)(ui,{children:s.map((e,t)=>{var s,a,n,l,r;return(0,se.jsxs)(xi,{children:[(0,se.jsx)(pi,{className:"font-medium",children:e.email}),(0,se.jsx)(pi,{children:e.full_name||"-"}),(0,se.jsx)(pi,{children:(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(null!==(s=e.subscription_tier)&&void 0!==s&&s.toLowerCase().includes("enterprise")?"bg-yellow-100 text-yellow-800":null!==(a=e.subscription_tier)&&void 0!==a&&a.toLowerCase().includes("elite")?"bg-purple-100 text-purple-800":null!==(n=e.subscription_tier)&&void 0!==n&&n.toLowerCase().includes("pro")?"bg-blue-100 text-blue-800":null!==(l=e.subscription_tier)&&void 0!==l&&l.toLowerCase().includes("builder")?"bg-indigo-100 text-indigo-800":null!==(r=e.subscription_tier)&&void 0!==r&&r.toLowerCase().includes("starter")?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.subscription_tier||"Free"})}),(0,se.jsx)(pi,{children:(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat($p(e.platform_role)?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.platform_role})}),(0,se.jsx)(pi,{className:"text-right font-semibold",children:e.message_count.toLocaleString()})]},t)})})]})})})]})}class aV extends te.y{getBaseURL(){return"/workspace"}updateWorkspace(e,t){const s={workspaceId:e};return this.axios.put("/admin/update",t,{params:s})}}const nV=new aV;var lV=s(71742);const rV=[{value:"stripe",label:"Stripe Billing"},{value:"no_billing",label:"No Billing (Free)"}];function iV(e){let{workspace:t,isOpen:s,onClose:a,onSave:n}=e;const[l,r]=(0,Y.useState)({billing_type:"stripe",is_enterprise:!1,plans:[],rl_multiplier:null,rl_multiplier_enabled:!1}),[i,o]=(0,Y.useState)({billing_type:"stripe",is_enterprise:!1,plans:[],rl_multiplier:null,rl_multiplier_enabled:!1}),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(""),[x,h]=(0,Y.useState)([]),[p,g]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{s&&f()},[s]),(0,Y.useEffect)(()=>{if(t){const e=void 0!==t.rl_multiplier&&null!==t.rl_multiplier,s={billing_type:t.billing_type||"stripe",is_enterprise:t.is_enterprise||!1,plans:t.plans?t.plans.map(e=>({name:e.name.toLowerCase(),price_id:e.price_id,total_seats:e.total_seats||0})):[],rl_multiplier:e?t.rl_multiplier:2,rl_multiplier_enabled:e};r(s),o(JSON.parse(JSON.stringify(s))),m("")}},[t]);const f=async()=>{g(!0);try{var e;const s=(null==t||null===(e=t.plans)||void 0===e?void 0:e.map(e=>e.price_id))||null,a=await Hd.getAvailablePlans(s);if(null==a||!a.plans)throw new Error("Failed to load available plans");{const e=a.plans.map(e=>({name:e.name.toLowerCase(),price_id:e.price_id,displayName:e.name.charAt(0).toUpperCase()+e.name.slice(1)}));h(e)}}catch(s){m("Failed to load available plans")}finally{g(!1)}},v=e=>{const t=l.plans.find(t=>t.name===e);return t?t.total_seats:0},b=()=>{if(l.billing_type!==i.billing_type)return!0;if(l.is_enterprise!==i.is_enterprise)return!0;if(l.is_enterprise){if(l.rl_multiplier_enabled!==i.rl_multiplier_enabled)return!0;if(l.rl_multiplier_enabled&&l.rl_multiplier!==i.rl_multiplier)return!0}const e=[...l.plans].sort((e,t)=>e.name.localeCompare(t.name)),t=[...i.plans].sort((e,t)=>e.name.localeCompare(t.name));if(e.length!==t.length)return!0;for(let s=0;s<e.length;s++){const a=e[s],n=t[s];if(a.name!==n.name||a.price_id!==n.price_id||a.total_seats!==n.total_seats)return!0}return!1},j=()=>{m(""),a()};return t?(0,se.jsx)(ma,{open:s,onOpenChange:j,children:(0,se.jsxs)(fa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,se.jsx)(va,{children:(0,se.jsx)(ja,{className:"flex items-center gap-2",children:(0,se.jsxs)("span",{children:["Edit Workspace: ",t.name||t.domain||"Unknown"]})})}),(0,se.jsxs)("div",{className:"space-y-6",children:[u&&(0,se.jsxs)(Dt,{variant:"destructive",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),(0,se.jsx)(Ot,{children:u})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsx)(Is,{className:"text-lg",children:"Billing Configuration"})}),(0,se.jsx)(Ls,{children:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"billing-type",children:"Billing Type"}),(0,se.jsxs)(br,{value:l.billing_type,onValueChange:e=>{r(t=>(0,ue.A)((0,ue.A)({},t),{},{billing_type:e}))},children:[(0,se.jsx)(Nr,{children:(0,se.jsx)(yr,{placeholder:"Select billing type"})}),(0,se.jsx)(kr,{children:rV.map(e=>(0,se.jsx)(Ar,{value:e.value,children:e.label},e.value))})]})]})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsxs)(Is,{className:"text-lg flex items-center gap-2",children:[(0,se.jsx)(Zg.A,{className:"h-5 w-5"}),"Enterprise Features"]})}),(0,se.jsxs)(Ls,{children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)(On,{htmlFor:"is-enterprise",className:"text-base",children:"Enable Enterprise Features"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Enables SSO, advanced security features, and enterprise-level support"})]}),(0,se.jsx)(ei,{id:"is-enterprise",checked:l.is_enterprise,onCheckedChange:e=>r(t=>(0,ue.A)((0,ue.A)({},t),{},{is_enterprise:e},e?{}:{rl_multiplier_enabled:!1,rl_multiplier:2}))})]}),l.is_enterprise&&(0,se.jsx)("div",{className:"mt-6 pt-6 border-t border-slate-200",children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Os,{id:"rl-multiplier-enabled",checked:l.rl_multiplier_enabled,onCheckedChange:e=>r(t=>(0,ue.A)((0,ue.A)({},t),{},{rl_multiplier_enabled:e,rl_multiplier:e&&t.rl_multiplier||2}))}),(0,se.jsx)(On,{htmlFor:"rl-multiplier-enabled",className:"text-base cursor-pointer",children:"Custom Rate Limit Multiplier"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-4 ml-7",children:[(0,se.jsx)(nl,{id:"rl-multiplier",type:"number",min:"1",max:"10",value:l.rl_multiplier||2,onChange:e=>{const t=Math.min(10,Math.max(1,parseInt(e.target.value)||1));r(e=>(0,ue.A)((0,ue.A)({},e),{},{rl_multiplier:t}))},disabled:!l.rl_multiplier_enabled,className:"w-20 text-center"}),(0,se.jsx)("span",{className:"text-sm text-slate-500",children:l.rl_multiplier_enabled?"Multiplier: ".concat(l.rl_multiplier,"x"):"Default: ".concat(2,"x")})]}),(0,se.jsx)("p",{className:"text-sm text-slate-500 ml-7",children:"Multiplies the default rate limits for this workspace. Range: 1-10."})]})})]})]}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{className:"text-lg",children:"Seat Plans"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Set the total seat count for each plan. Set to 0 to remove a plan."})]}),(0,se.jsx)(Ls,{children:p?(0,se.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin text-slate-600"}),(0,se.jsx)("span",{className:"ml-2 text-slate-600",children:"Loading plans..."})]}):(0,se.jsx)("div",{className:"space-y-4",children:x.map(e=>(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("div",{className:"font-medium text-slate-900",children:e.displayName}),(0,se.jsxs)("div",{className:"text-sm text-slate-500",children:["Price ID: ",e.price_id]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 min-w-[120px]",children:[(0,se.jsx)(On,{htmlFor:"".concat(e.name,"-seats"),className:"text-sm whitespace-nowrap",children:"Total Seats:"}),(0,se.jsx)(nl,{id:"".concat(e.name,"-seats"),type:"number",min:"0",value:v(e.name),onChange:t=>((e,t)=>{const s=parseInt(t)||0,a=x.find(t=>t.name===e);r(t=>{const n=[...t.plans],l=n.findIndex(t=>t.name===e);if(s>0){const t={name:e,price_id:a.price_id,total_seats:s};l>=0?n[l]=t:n.push(t)}else l>=0&&n.splice(l,1);return(0,ue.A)((0,ue.A)({},t),{},{plans:n})})})(e.name,t.target.value),className:"w-20 text-center",placeholder:"0"})]})]},e.name))})})]}),(0,se.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,se.jsxs)(zt,{variant:"outline",onClick:j,disabled:c,children:[(0,se.jsx)(la.A,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,se.jsxs)(zt,{onClick:async()=>{if(t)if(b()){d(!0),m("");try{const e={billing_type:l.billing_type,is_enterprise:l.is_enterprise,plans:l.plans,rl_multiplier:l.is_enterprise&&l.rl_multiplier_enabled?l.rl_multiplier:null};await n(t.id||t.organization_id,e),a()}catch(e){m(e.message||"Failed to update workspace")}finally{d(!1)}}else a()},disabled:c||!b(),className:"bg-orange-600 hover:bg-orange-700 disabled:bg-slate-300 disabled:text-slate-500",children:[(0,se.jsx)(lV.A,{className:"h-4 w-4 mr-2"}),c?"Saving...":b()?"Save Changes":"No Changes"]})]})]})]})}):null}function oV(){const[e,t]=(0,Y.useState)(null),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!0),[h,p]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{g()},[]);const g=async()=>{try{const e=await SH.getOrganizationsWithPlans();null!=e&&e.success&&a(e.data)}catch(e){}};(0,Y.useEffect)(()=>{m?v():r.length>=3?f(r):t({organizations:[],all_plans:[],total_organizations_with_plans:0})},[m]);const f=(0,Y.useCallback)((0,cc.debounce)(async e=>{if(!m&&e.length>=3){p(!0);try{const s=await SH.searchOrganizations(e);if(null!=s&&s.success){const e=s.data,a=e.organizations||[],n=e.all_plans||[],l=a.filter(e=>e.plans&&e.plans.length>0).length;let r=0,i=0;a.forEach(e=>{e.plans&&e.plans.forEach(e=>{r+=e.total_seats||0,i+=e.used_seats||0})});const o=r>0?Math.round(i/r*100*100)/100:0,c={};a.forEach(e=>{e.plans&&e.plans.forEach(e=>{if(e.created_date){const t=new Date(e.created_date).toISOString().split("T")[0];c[t]=(c[t]||0)+(e.total_seats||0)}})}),a.forEach(e=>{if(e.plans){const t=e.plans.reduce((e,t)=>e+(t.total_seats||0),0),s=e.plans.reduce((e,t)=>e+(t.used_seats||0),0),a=t>0?Math.round(s/t*100*100)/100:0;e.plan_summary={total_seats:t,used_seats:s,utilization_rate:a}}else e.plan_summary={total_seats:0,used_seats:0,utilization_rate:0}});t({organizations:a,all_plans:n,total_organizations_with_plans:l,total_seats_purchased:r,total_seats_used:i,overall_utilization_rate:o,seats_by_day:c})}}catch(s){}finally{p(!1)}}},500),[m]);(0,Y.useEffect)(()=>{m||(r.length>=3?f(r):t({organizations:[],all_plans:[],total_organizations_with_plans:0}))},[r,m,f]);const v=async()=>{try{const e=await SH.getOrganizationsWithPlans();if(null==e||!e.success)return void t(null);const s=e.data,n=s.organizations||[],l=s.all_plans||[],r=n.filter(e=>e.plans&&e.plans.length>0).length;let i=0,o=0;n.forEach(e=>{e.plans&&e.plans.forEach(e=>{i+=e.total_seats||0,o+=e.used_seats||0})});const c=i>0?Math.round(o/i*100*100)/100:0,d={};n.forEach(e=>{e.plans&&e.plans.forEach(e=>{if(e.created_date){const t=new Date(e.created_date).toISOString().split("T")[0];d[t]=(d[t]||0)+(e.total_seats||0)}})}),n.forEach(e=>{if(e.plans){const t=e.plans.reduce((e,t)=>e+(t.total_seats||0),0),s=e.plans.reduce((e,t)=>e+(t.used_seats||0),0),a=t>0?Math.round(s/t*100*100)/100:0;e.plan_summary={total_seats:t,used_seats:s,utilization_rate:a}}else e.plan_summary={total_seats:0,used_seats:0,utilization_rate:0}});const u={organizations:n,all_plans:l,total_organizations_with_plans:r,total_seats_purchased:i,total_seats_used:o,overall_utilization_rate:c,seats_by_day:d};t(u),m&&a(u)}catch(e){t(null)}finally{l(!1)}};if(n)return(0,se.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600 mx-auto mb-4"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Loading organizations..."})]})});if(!e)return(0,se.jsxs)("div",{className:"text-center py-8",children:[(0,se.jsx)("p",{className:"text-slate-600",children:"Failed to load organizations data"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:"Check console for debugging information"})]});const b=e.organizations||[],j=(null==s?void 0:s.organizations)||[],y=(null==s?void 0:s.seats_by_day)||{},N=j.reduce((e,t)=>{var s;return e+((null===(s=t.plan_summary)||void 0===s?void 0:s.total_seats)||0)},0),w=j.reduce((e,t)=>{var s;return e+((null===(s=t.plan_summary)||void 0===s?void 0:s.used_seats)||0)},0),_=N>0?Math.round(w/N*100*100)/100:0,k=j.reduce((e,t)=>{var s;const a=null===(s=t.plans)||void 0===s?void 0:s.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("starter")});return e+((null==a?void 0:a.total_seats)||0)},0),C=j.reduce((e,t)=>{var s;const a=null===(s=t.plans)||void 0===s?void 0:s.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("builder")});return e+((null==a?void 0:a.total_seats)||0)},0),A=j.reduce((e,t)=>{var s;const a=null===(s=t.plans)||void 0===s?void 0:s.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("pro")});return e+((null==a?void 0:a.total_seats)||0)},0),S=j.reduce((e,t)=>{var s;return e+((null===(s=t.plans)||void 0===s?void 0:s.filter(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("elite")}))||[]).reduce((e,t)=>e+(t.total_seats||0),0)},0),E=m?b.filter(e=>{var t,s;return!r.trim()||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase()))||(null===(s=e.domain)||void 0===s?void 0:s.toLowerCase().includes(r.toLowerCase()))}).sort((e,t)=>{var s,a;const n=(null===(s=e.plan_summary)||void 0===s?void 0:s.total_seats)||0;return((null===(a=t.plan_summary)||void 0===a?void 0:a.total_seats)||0)-n}):b.sort((e,t)=>{var s,a;const n=(null===(s=e.plan_summary)||void 0===s?void 0:s.total_seats)||0;return((null===(a=t.plan_summary)||void 0===a?void 0:a.total_seats)||0)-n});return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(Zg.A,{className:"h-8 w-8 text-slate-600"}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Orgs with Plans"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:(null==s?void 0:s.total_organizations_with_plans)||0})]})]})}),(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(tu.A,{className:"h-8 w-8 text-slate-600"}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Seats Purchased"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:N})]})]})}),(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(eb.A,{className:"h-8 w-8 text-slate-600"}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Seats Used"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:w})]})]})}),(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(Pf.A,{className:"h-8 w-8 text-slate-600"}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Utilization Rate"}),(0,se.jsxs)("p",{className:"text-2xl font-bold text-slate-900",children:[_,"%"]})]})]})})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("div",{className:"h-8 w-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-green-600 font-bold text-sm",children:"S"})}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Starter Seats"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:k})]})]})}),(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("div",{className:"h-8 w-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-blue-600 font-bold text-sm",children:"B"})}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Builder Seats"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:C})]})]})}),(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-purple-500",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("div",{className:"h-8 w-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-purple-600 font-bold text-sm",children:"P"})}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Pro Seats"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:A})]})]})}),(0,se.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-orange-500",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("div",{className:"h-8 w-8 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-orange-600 font-bold text-sm",children:"E"})}),(0,se.jsxs)("div",{className:"ml-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Elite Seats"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:S})]})]})})]}),Object.keys(y).length>0&&(0,se.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,se.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center",children:[(0,se.jsx)(H_.A,{className:"h-5 w-5 mr-2"}),"Seats Purchased by Day"]}),(0,se.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:Object.entries(y).sort((e,t)=>{let[s]=e,[a]=t;return new Date(s)-new Date(a)}).map(e=>{let[t,s]=e;return(0,se.jsxs)("div",{className:"text-center p-3 bg-slate-50 rounded-lg",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-600",children:He()(t).format("MMM DD")}),(0,se.jsx)("div",{className:"text-lg font-bold text-slate-900",children:s}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"seats"})]},t)})})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsxs)("div",{className:"relative w-72",children:[(0,se.jsx)(na.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-500"}),(0,se.jsx)(nl,{placeholder:m?"Search organizations...":"Search (min 3 chars)...",className:"pl-8",value:r,onChange:e=>i(e.target.value)})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(Os,{id:"with-plans",checked:m,onCheckedChange:e=>{x(e)}}),(0,se.jsx)("label",{htmlFor:"with-plans",className:"text-sm font-medium text-slate-700 cursor-pointer select-none",children:"With Plans"})]})]}),(0,se.jsx)("div",{className:"text-sm text-slate-600",children:h?(0,se.jsx)("span",{children:"Searching..."}):(0,se.jsx)(se.Fragment,{children:m?(0,se.jsxs)(se.Fragment,{children:[E.length," of ",b.length," organizations"]}):(0,se.jsx)(se.Fragment,{children:r.length<3?"Enter at least 3 characters to search":(0,se.jsxs)(se.Fragment,{children:[b.length," organizations found"]})})})})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,se.jsx)("div",{className:"p-6 border-b",children:(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Organizations"})}),(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{children:"Organization Name"}),(0,se.jsx)(hi,{children:"Enterprise"}),(0,se.jsx)(hi,{children:"Total Seats"}),(0,se.jsx)(hi,{children:"Used Seats"}),(0,se.jsx)(hi,{children:"Starter"}),(0,se.jsx)(hi,{children:"Builder"}),(0,se.jsx)(hi,{children:"Pro"}),(0,se.jsx)(hi,{children:"Elite"}),(0,se.jsx)(hi,{children:"Utilization Rate"}),(0,se.jsx)(hi,{children:"Created Date"}),(0,se.jsx)(hi,{children:"Actions"})]})}),(0,se.jsx)(ui,{children:0===E.length?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:11,className:"text-center py-8",children:!m&&r.length<3?"Enter at least 3 characters to search organizations":r?"No organizations found matching your search":"No organizations found"})}):E.map(e=>{var t,s,a,n,l,r,i;const o=(null===(t=e.plans)||void 0===t?void 0:t.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("starter")}))||{total_seats:0,used_seats:0},d=(null===(s=e.plans)||void 0===s?void 0:s.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("builder")}))||{total_seats:0,used_seats:0},m=(null===(a=e.plans)||void 0===a?void 0:a.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("pro")}))||{total_seats:0,used_seats:0},x=(null===(n=e.plans)||void 0===n?void 0:n.filter(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("elite")}))||[],h=x.reduce((e,t)=>e+(t.total_seats||0),0),p=x.reduce((e,t)=>e+(t.used_seats||0),0);return(0,se.jsxs)(xi,{className:"hover:bg-slate-50 transition-colors",children:[(0,se.jsx)(pi,{className:"font-medium",children:e.name||e.domain||"No name"}),(0,se.jsx)(pi,{children:e.is_enterprise?(0,se.jsx)("div",{className:"flex items-center justify-center",children:(0,se.jsx)(HO.A,{className:"h-5 w-5 text-yellow-600",title:"Enterprise Enabled"})}):(0,se.jsx)("div",{className:"flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-slate-400",children:"-"})})}),(0,se.jsx)(pi,{children:(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs bg-slate-100 text-slate-800",children:(null===(l=e.plan_summary)||void 0===l?void 0:l.total_seats)||0})}),(0,se.jsx)(pi,{children:(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs bg-orange-100 text-orange-800",children:(null===(r=e.plan_summary)||void 0===r?void 0:r.used_seats)||0})}),(0,se.jsx)(pi,{children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:o.total_seats}),(0,se.jsxs)("div",{className:"text-xs text-slate-500",children:[o.used_seats," used"]})]})}),(0,se.jsx)(pi,{children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:d.total_seats}),(0,se.jsxs)("div",{className:"text-xs text-slate-500",children:[d.used_seats," used"]})]})}),(0,se.jsx)(pi,{children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:m.total_seats}),(0,se.jsxs)("div",{className:"text-xs text-slate-500",children:[m.used_seats," used"]})]})}),(0,se.jsx)(pi,{children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:h}),(0,se.jsxs)("div",{className:"text-xs text-slate-500",children:[p," used"]})]})}),(0,se.jsx)(pi,{children:(0,se.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[(null===(i=e.plan_summary)||void 0===i?void 0:i.utilization_rate)||0,"%"]})}),(0,se.jsx)(pi,{children:(0,se.jsx)("span",{className:"text-sm text-slate-600",children:e.created_date?He().utc(e.created_date).format("YYYY-MM-DD"):"-"})}),(0,se.jsx)(pi,{children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(e.id||e.organization_id)&&(0,se.jsxs)("a",{href:"/workspace/".concat(e.id||e.organization_id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-md transition-colors",title:"Manage workspace",children:[(0,se.jsx)(Rj.A,{className:"h-3 w-3"}),"Manage"]}),(0,se.jsxs)("button",{onClick:()=>(u(e),void c(!0)),className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-md transition-colors",title:"Edit workspace configuration",children:[(0,se.jsx)(Qv.A,{className:"h-3 w-3"}),"Edit"]})]})})]},e.id||e.organization_id)})})]})]}),(0,se.jsx)(iV,{workspace:d,isOpen:o,onClose:()=>{c(!1),u(null)},onSave:async(e,t)=>{try{await nV.updateWorkspace(e,t),await v()}catch(s){throw s}}})]})}class cV extends te.H{getBaseURL(){return"/credits"}addBonusCredits(e,t,s){return this.axios.post("/add-bonus-credits",{user_id:e,num_messages:t,reason:s})}createCouponCode(e,t,s,a){return this.axios.post("/create-coupon-code",{code:e,num_messages:t,max_number_of_people:s,domain:a})}getCouponCodes(){return this.axios.get("/coupon-codes")}getBonusCredits(e){return this.axios.get("/".concat(e,"/bonus-credits"))}addCouponCode(e){return this.axios.post("/add-coupon-code/".concat(e))}deleteBonusCredits(e,t){return this.axios.delete("/".concat(e,"/bonus-credits/").concat(t))}}const dV=new cV,uV=()=>{const[e,t]=(0,Y.useState)([]),[s,a]=(0,Y.useState)(!0),{register:n,handleSubmit:l,reset:r,formState:{errors:i}}=(0,yt.useForm)({defaultValues:{code:"",numMessages:"",maxNumberOfPeople:"",domain:""}}),o=async()=>{try{a(!0);const e=await dV.getCouponCodes();t(e||[])}catch(e){kb({title:"Error",description:"Failed to fetch coupon codes",variant:"destructive"})}finally{a(!1)}};(0,Y.useEffect)(()=>{o()},[]);return(0,se.jsxs)("div",{className:"container mx-auto py-8 space-y-6",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold",children:"Coupon Code Management"}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Create Coupon Code"}),(0,se.jsx)(Ps,{children:"Create a new coupon code for users to redeem"})]}),(0,se.jsx)(Ls,{children:(0,se.jsxs)("form",{onSubmit:l(async e=>{try{a(!0),await dV.createCouponCode(e.code,parseInt(e.numMessages),parseInt(e.maxNumberOfPeople),e.domain||null),kb({title:"Success",description:"Coupon code created successfully"}),r(),o()}catch(t){kb({title:"Error",description:"Failed to create coupon code",variant:"destructive"})}finally{a(!1)}}),className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"code",children:"Code"}),(0,se.jsx)(nl,(0,ue.A)({id:"code",placeholder:"SUMMER2023"},n("code",{required:"Code is required"}))),i.code&&(0,se.jsx)("span",{className:"text-sm text-red-500",children:i.code.message})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"numMessages",children:"Number of Messages"}),(0,se.jsx)(nl,(0,ue.A)({id:"numMessages",type:"number",placeholder:"100"},n("numMessages",{required:"Number of messages is required",min:{value:1,message:"Must be at least 1"}}))),i.numMessages&&(0,se.jsx)("span",{className:"text-sm text-red-500",children:i.numMessages.message})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"maxNumberOfPeople",children:"Max Number of People"}),(0,se.jsx)(nl,(0,ue.A)({id:"maxNumberOfPeople",type:"number",placeholder:"50"},n("maxNumberOfPeople",{required:"Max number of people is required",min:{value:1,message:"Must be at least 1"}}))),i.maxNumberOfPeople&&(0,se.jsx)("span",{className:"text-sm text-red-500",children:i.maxNumberOfPeople.message})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"domain",children:"Domain (Optional)"}),(0,se.jsx)(nl,(0,ue.A)({id:"domain",placeholder:"example.com"},n("domain"))),(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"Limit code to specific email domain"})]})]}),(0,se.jsx)(zt,{type:"submit",disabled:s,children:"Create Coupon Code"})]})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Existing Coupon Codes"}),(0,se.jsx)(Ps,{children:"View and manage all available coupon codes"})]}),(0,se.jsx)(Ls,{children:s?(0,se.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):0===e.length?(0,se.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No coupon codes found"}):(0,se.jsx)("div",{className:"rounded-md border",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{children:"Code"}),(0,se.jsx)(hi,{children:"Messages"}),(0,se.jsx)(hi,{children:"Max Users"}),(0,se.jsx)(hi,{children:"Domain"}),(0,se.jsx)(hi,{children:"Usage"})]})}),(0,se.jsx)(ui,{children:e.map((e,t)=>(0,se.jsxs)(xi,{children:[(0,se.jsx)(pi,{className:"font-medium",children:e.code}),(0,se.jsx)(pi,{children:e.num_messages}),(0,se.jsx)(pi,{children:e.max_number_of_people}),(0,se.jsx)(pi,{children:e.domain||"Any"}),(0,se.jsxs)(pi,{children:[e.used_credits||0," / ",e.max_number_of_people]})]},t))})]})})})]})]})};class mV extends te.H{getBaseURL(){return"/notifications"}async getChangelog(){return await this.axios.get("/changelog")}async markChangelogAsSeen(){return await this.axios.put("/changelog/mark-as-seen")}async getUserNotifications(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return await this.axios.get("/user",{params:{limit:e,offset:t}})}async markNotificationAsRead(e){return await this.axios.put("/user/".concat(e,"/read"))}async markAllNotificationsAsRead(){return await this.axios.put("/user/mark-all-read")}async createChangelogItem(e){return await this.axios.post("/changelog",e)}async updateChangelogItem(e,t){return await this.axios.put("/changelog/".concat(e),t)}async deleteChangelogItem(e){return await this.axios.delete("/changelog/".concat(e))}async getAllChangelogItems(){return await this.axios.get("/changelog")}subscribeToNotifications(e,t){const s="user/".concat(e);return Fd.A.addNotificationListener(s,e=>{t(e)})}}const xV=new mV,hV=["is_seen"];function pV(){const[e,t]=(0,Y.useState)([]),[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)({title:"",content:"",image_url:"",link_url:""}),m=(0,Y.useRef)(null);(0,Y.useRef)(null);(0,Y.useEffect)(()=>{x()},[]),(0,Y.useEffect)(()=>{if(n)return document.addEventListener("paste",f),()=>{document.removeEventListener("paste",f)}},[n]);const x=async()=>{a(!0);try{const e=(await xV.getAllChangelogItems()).map(e=>{let{is_seen:t}=e;return(0,Nt.A)(e,hV)}).sort((e,t)=>new Date(t.created_date)-new Date(e.created_date));t(e)}catch(e){$.toast.error("Failed to load changelog items")}finally{a(!1)}},h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(i(e),u({title:e.title,content:e.content,image_url:e.image_url,link_url:e.link_url})):(i(null),u({title:"",content:"",image_url:"",link_url:""})),l(!0)},p=()=>{l(!1),i(null),u({title:"",content:"",image_url:"",link_url:""})},g=async e=>{if(e)if(e.type.startsWith("image/"))if(e.size>5242880)$.toast.error("Image must be less than 5MB");else{c(!0);try{const t=(await ip.uploadFile(e)).url;if(!t)throw new Error("No URL returned from upload");u(e=>(0,ue.A)((0,ue.A)({},e),{},{image_url:t})),$.toast.success("Image uploaded successfully")}catch(t){$.toast.error("Failed to upload image")}finally{c(!1)}}else $.toast.error("Please upload an image file")},f=async e=>{var t;const s=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(s)for(const a of s)if(a.type.startsWith("image/")){e.preventDefault();const t=a.getAsFile();t&&await g(t);break}};return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold",children:"What's New Management"}),(0,se.jsxs)(zt,{onClick:()=>h(),className:"flex items-center gap-2",children:[(0,se.jsx)(op.A,{className:"h-4 w-4"}),"Add New Item"]})]}),(0,se.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{className:"w-[50px]",children:"Image"}),(0,se.jsx)(hi,{children:"Title"}),(0,se.jsx)(hi,{children:"Content"}),(0,se.jsx)(hi,{children:"Created Date"}),(0,se.jsx)(hi,{className:"text-right",children:"Actions"})]})}),(0,se.jsx)(ui,{children:s?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:5,className:"text-center py-8",children:"Loading changelog items..."})}):0===e.length?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:5,className:"text-center py-8",children:"No changelog items found"})}):e.map(e=>(0,se.jsxs)(xi,{children:[(0,se.jsx)(pi,{children:e.image_url&&(0,se.jsx)("img",{src:e.image_url,alt:"",className:"w-12 h-12 rounded object-cover"})}),(0,se.jsx)(pi,{className:"font-medium",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[e.title,e.link_url&&(0,se.jsx)("a",{href:e.link_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",children:(0,se.jsx)(Rj.A,{className:"h-3 w-3"})})]})}),(0,se.jsx)(pi,{children:(0,se.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 max-w-md",children:e.content})}),(0,se.jsx)(pi,{children:(0,se.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[(0,se.jsx)(H_.A,{className:"h-3 w-3"}),He()(e.created_date).format("MMM DD, YYYY")]})}),(0,se.jsx)(pi,{className:"text-right",children:(0,se.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>h(e),children:(0,se.jsx)(eU.A,{className:"h-4 w-4"})}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this changelog item?"))try{a(!0),await xV.deleteChangelogItem(e),$.toast.success("Changelog item deleted successfully"),x()}catch(t){$.toast.error("Failed to delete item")}finally{a(!1)}})(e.id),className:"text-red-600 hover:bg-red-50",children:(0,se.jsx)(zy.A,{className:"h-4 w-4"})})]})})]},e.id))})]})}),(0,se.jsx)(ma,{open:n,onOpenChange:l,children:(0,se.jsxs)(fa,{className:"sm:max-w-[525px]",children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:r?"Edit Changelog Item":"Create New Changelog Item"}),(0,se.jsx)(ya,{children:r?"Update the details of the changelog item below.":"Fill in the details for the new changelog item."})]}),(0,se.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,se.jsxs)("div",{className:"grid gap-2",children:[(0,se.jsx)(On,{htmlFor:"title",children:"Title"}),(0,se.jsx)(nl,{id:"title",value:d.title,onChange:e=>u((0,ue.A)((0,ue.A)({},d),{},{title:e.target.value})),placeholder:"New Feature: Enhanced User Experience"})]}),(0,se.jsxs)("div",{className:"grid gap-2",children:[(0,se.jsx)(On,{htmlFor:"content",children:"Content"}),(0,se.jsx)(ki,{id:"content",value:d.content,onChange:e=>u((0,ue.A)((0,ue.A)({},d),{},{content:e.target.value})),placeholder:"Describe what's new or what has changed...",rows:4})]}),(0,se.jsxs)("div",{className:"grid gap-2",children:[(0,se.jsx)(On,{htmlFor:"image_url",children:"Image"}),(0,se.jsxs)("div",{className:"space-y-2",children:[d.image_url&&(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("img",{src:d.image_url,alt:"Preview",className:"w-full h-48 object-cover rounded-lg border"}),(0,se.jsx)(zt,{variant:"outline",size:"sm",className:"absolute top-2 right-2",onClick:()=>u((0,ue.A)((0,ue.A)({},d),{},{image_url:""})),children:"Remove"})]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(nl,{id:"image_url",value:d.image_url,onChange:e=>u((0,ue.A)((0,ue.A)({},d),{},{image_url:e.target.value})),placeholder:"https://example.com/image.jpg",className:"flex-1"}),(0,se.jsx)("input",{ref:m,type:"file",accept:"image/*",onChange:async e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&await g(s)},className:"hidden"}),(0,se.jsx)(zt,{type:"button",variant:"outline",onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.click()},disabled:o,children:o?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(W_.A,{className:"h-4 w-4"})})]}),(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"Upload an image or paste from clipboard (Ctrl/Cmd + V)"})]})]}),(0,se.jsxs)("div",{className:"grid gap-2",children:[(0,se.jsx)(On,{htmlFor:"link_url",children:"Link URL (Optional)"}),(0,se.jsx)(nl,{id:"link_url",value:d.link_url,onChange:e=>u((0,ue.A)((0,ue.A)({},d),{},{link_url:e.target.value})),placeholder:"https://docs.example.com/changelog"})]})]}),(0,se.jsxs)(ba,{children:[(0,se.jsx)(zt,{variant:"outline",onClick:p,children:"Cancel"}),(0,se.jsx)(zt,{onClick:async()=>{try{a(!0),r?(await xV.updateChangelogItem(r.id,d),$.toast.success("Changelog item updated successfully")):(await xV.createChangelogItem(d),$.toast.success("Changelog item created successfully")),p(),x()}catch(e){$.toast.error(r?"Failed to update item":"Failed to create item")}finally{a(!1)}},disabled:s||!d.title||!d.content||!d.image_url,children:r?"Update":"Create"})]})]})})]})}function gV(){const{user:e}=wd(),[t,s]=(0,Z.useSearchParams)(),[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)({key:"created_date",direction:"desc"}),[x,h]=(0,Y.useState)({totalUsers:0,newUsersToday:0,premiumUsers:0}),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)(null),[b,j]=(0,Y.useState)(null),[y,N]=(0,Y.useState)({startDate:null,endDate:null}),w=(0,Y.useRef)(0);(0,Y.useEffect)(()=>{C()},[]),(0,Y.useEffect)(()=>(f&&clearTimeout(f),v(setTimeout(()=>{c.trim()?k(c):_()},500)),()=>{f&&clearTimeout(f)}),[c]),(0,Y.useEffect)(()=>{l?(A(l.id),S(l.id),y.startDate||N({startDate:null,endDate:null})):(j(null),N({startDate:null,endDate:null}))},[l]),(0,Y.useEffect)(()=>{const e=t.get("userId");if(e&&a.length>0){const t=a.find(t=>t.id===e);t?r(t):E(e)}},[a,t]);const _=async()=>{o(!0);try{const e=await jd.listUsers({limit:100});n(e)}catch(e){}finally{o(!1)}},k=async e=>{o(!0);try{const t=await jd.listUsers({limit:100,q:JSON.stringify({$or:[{email:{$regex:e,$options:"i"}},{full_name:{$regex:e,$options:"i"}}]})});n(t)}catch(t){}finally{o(!1)}},C=async()=>{const e=await SH.getUserAnalytics();h(e)},A=async e=>{try{const t=await dV.getBonusCredits(e);g(t)}catch(t){g([])}},S=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const l=Date.now();w.current=l,null!==a&&j(null);try{const n=await Yd.default.getUserStats(e,t,s,a);l>=w.current&&j(n)}catch(r){l>=w.current&&j(null)}finally{n&&n()}},E=async e=>{o(!0);try{const t=await jd.get(e);r(t)}catch(a){const e=new URLSearchParams(t);e.delete("userId"),s(e)}finally{o(!1)}},T=e=>{m({key:e,direction:u.key===e&&"asc"===u.direction?"desc":"asc"})},I=a.sort((e,t)=>"created_date"===u.key?"asc"===u.direction?new Date(e[u.key])-new Date(t[u.key]):new Date(t[u.key])-new Date(e[u.key]):"asc"===u.direction?e[u.key]>t[u.key]?1:-1:t[u.key]>e[u.key]?1:-1);return Zp(null==e?void 0:e.platform_role)?(0,se.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Admin Portal"}),(0,se.jsxs)(ji,{defaultValue:"users",className:"mb-8",children:[(0,se.jsxs)(yi,{className:"grid grid-cols-5 w-[700px] mb-4",children:[(0,se.jsx)(Ni,{value:"users",children:"User Management"}),(0,se.jsx)(Ni,{value:"organizations",children:"Organizations"}),(0,se.jsx)(Ni,{value:"statistics",children:"Statistics"}),(0,se.jsx)(Ni,{value:"coupons",children:"Coupon Codes"}),(0,se.jsx)(Ni,{value:"changelog",children:"What's New"})]}),(0,se.jsxs)(wi,{value:"users",children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"User Management"}),(0,se.jsx)(kH,{stats:x}),(0,se.jsxs)("div",{className:"flex justify-between items-center mb-6 mt-6",children:[(0,se.jsxs)("div",{className:"relative w-72",children:[(0,se.jsx)(na.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),(0,se.jsx)(nl,{placeholder:"Search users...",className:"pl-8",value:c,onChange:e=>d(e.target.value)})]}),(0,se.jsxs)(zt,{onClick:()=>{const e=I.map(e=>[e.email,e.full_name||"",e.platform_role,He().utc(e.created_date).format("YYYY-MM-DD HH:mm:ss"),e.subscription_tier||"Free",e.stripe_customer_id||"",e.api_key||""]),t=[["Email","Full Name","Platform Role","Created Date","Subscription Tier","Stripe Customer ID","API Key"].join(","),...e.map(e=>e.map(e=>'"'.concat(e,'"')).join(","))].join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),n=URL.createObjectURL(s);a.setAttribute("href",n),a.setAttribute("download","users_".concat(He()().format("YYYY-MM-DD"),".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"flex items-center gap-2",children:[(0,se.jsx)(aL.A,{className:"h-4 w-4"}),"Download CSV"]})]})]}),(0,se.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>T("email"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Email",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>T("full_name"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Full Name",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>T("platform_role"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Platform Role",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>T("created_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Created Date",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>T("subscription_tier"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Subscription Plan",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{children:"Actions"})]})}),(0,se.jsx)(ui,{children:i?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:6,className:"text-center py-8",children:"Loading users..."})}):0===I.length?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:6,className:"text-center py-8",children:"No users found"})}):I.map(e=>{var a,n,l,i,o;return(0,se.jsxs)(xi,{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>{r(e);const a=new URLSearchParams(t);a.set("userId",e.id),s(a)},children:[(0,se.jsx)(pi,{className:"font-medium",children:e.email}),(0,se.jsx)(pi,{children:e.full_name||"-"}),(0,se.jsx)(pi,{children:(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("platform_owner"===e.platform_role?"bg-red-100 text-red-800":"platform_admin"===e.platform_role?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.platform_role})}),(0,se.jsx)(pi,{children:He().utc(e.created_date).fromNow()}),(0,se.jsx)(pi,{children:(0,se.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(null!==(a=e.subscription_tier)&&void 0!==a&&a.toLowerCase().includes("enterprise")?"bg-yellow-100 text-yellow-800":null!==(n=e.subscription_tier)&&void 0!==n&&n.toLowerCase().includes("elite")?"bg-purple-100 text-purple-800":null!==(l=e.subscription_tier)&&void 0!==l&&l.toLowerCase().includes("pro")?"bg-blue-100 text-blue-800":null!==(i=e.subscription_tier)&&void 0!==i&&i.toLowerCase().includes("builder")?"bg-indigo-100 text-indigo-800":null!==(o=e.subscription_tier)&&void 0!==o&&o.toLowerCase().includes("starter")?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.subscription_tier||"Free"})}),(0,se.jsx)(pi,{children:(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:a=>{a.stopPropagation(),r(e);const n=new URLSearchParams(t);n.set("userId",e.id),s(n)},children:"Edit"})})]},e.id)})})]})})]}),(0,se.jsx)(wi,{value:"organizations",children:(0,se.jsx)(oV,{})}),(0,se.jsx)(wi,{value:"statistics",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"User Statistics"}),(0,se.jsx)(sV,{})]})}),(0,se.jsx)(wi,{value:"coupons",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Coupon Code Management"}),(0,se.jsx)(uV,{})]})}),(0,se.jsx)(wi,{value:"changelog",children:(0,se.jsx)(pV,{})})]}),(0,se.jsx)(tV,{selectedUser:l,onClose:()=>{r(null);const e=new URLSearchParams(t);e.delete("userId"),s(e)},onUpdateUser:async(e,t)=>{o(!0);try{const s=await jd.updateUser(e,t);n(a.map(t=>t.id===e?s:t)),r(s)}catch(s){}finally{o(!1)}},userBonusCredits:p,onAddBonusCredits:async(e,t,s)=>{o(!0);try{await dV.addBonusCredits(e,t,s),await A(e)}catch(a){}finally{o(!1)}},onDeleteBonusCredit:async e=>{if(l&&e){o(!0);try{await ow.deleteBonusCredits(l.id,e),await A(l.id)}catch(t){}finally{o(!1)}}},loading:i,userUsageStats:b,onDateRangeChange:(e,t,s,a)=>{N({startDate:e,endDate:t}),l?S(l.id,e,t,s,a):a&&a()},dateRange:y})]}):(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(jH.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,se.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}const fV=e=>{let{data:t,title:s="Bar Chart",barColor:a="#14b8a6",maxWidth:n="800px",maxLabelWidth:l="40%",backgroundColor:r="white",textColor:i="#1f2937",renderLabel:o=e=>e.name,renderValue:c=e=>e.value}=e;const d=Math.max(...t.map(e=>e.value)),u=t.length,m=u<=5?"40px":u<=10?"32px":u<=20?"24px":"16px",x=u<=5?"14px":u<=10?"12px":u<=20?"10px":"8px";return(0,se.jsxs)("div",{style:{width:"100%",maxWidth:n,margin:"0 auto",padding:"24px",backgroundColor:r,borderRadius:"8px",overflow:"hidden"},children:[s&&(0,se.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"24px",color:i,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s}),(0,se.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.map((e,t)=>{const s=e.value/d*100;return(0,se.jsxs)("div",{style:{position:"relative",height:m,marginBottom:"8px",overflow:"hidden"},children:[(0,se.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"".concat(s,"%"),backgroundColor:a,borderRadius:"4px",transition:"width 0.5s ease-in-out"}}),(0,se.jsx)("div",{style:{position:"absolute",left:"8px",top:"50%",transform:"translateY(-50%)",fontSize:x,fontWeight:"500",color:i,zIndex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:l},children:o(e)}),(0,se.jsx)("div",{style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",fontSize:x,fontWeight:"500",color:i,overflow:"hidden",textOverflow:"ellipsis"},children:c(e)})]},t)})})]})};function vV(e){var t;let{appId:s,pageNames:a}=e;const[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)({from:void 0,to:void 0}),[o,c]=(0,Y.useState)("all"),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!0),[h,p]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{(async()=>{x(!0);try{const e={};null!=r&&r.from&&(e.date_from=(0,z_.GP)(r.from,"yyyy-MM-dd")),null!=r&&r.to&&(e.date_to=(0,z_.GP)(r.to,"yyyy-MM-dd")),"all"!==o&&(e.page_name=o),d&&(e.user_email=d);const t=await Cc.getStats(s,e);l(t)}catch(e){}finally{x(!1)}})()},[s,r,o,d]);const g=(n?"all"===o?n.top_pages:n.top_pages.filter(e=>e.url===o):[]).map(e=>({name:e.page_name,value:e.visits})),f=null!=n&&n.top_users?h?n.top_users:n.top_users.slice(0,5):[],v=(null==n||null===(t=n.top_users)||void 0===t?void 0:t.length)>5;return m&&!n?(0,se.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,se.jsxs)("div",{className:"space-y-4 p-4",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,se.jsxs)(Zl,{children:[(0,se.jsx)(Jl,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"outline",className:de("w-full sm:w-[240px] justify-start text-left font-normal",!r&&"text-muted-foreground"),children:[(0,se.jsx)(H_.A,{className:"mr-2 h-4 w-4"}),null!=r&&r.from?r.to?(0,se.jsxs)(se.Fragment,{children:[(0,z_.GP)(r.from,"LLL dd, y")," - ",(0,z_.GP)(r.to,"LLL dd, y")]}):(0,z_.GP)(r.from,"LLL dd, y"):(0,se.jsx)("span",{children:"Pick a date range"})]})}),(0,se.jsx)(Ql,{className:"w-auto p-0",align:"start",children:(0,se.jsx)(Ns,{initialFocus:!0,mode:"range",defaultMonth:null==r?void 0:r.from,selected:r,onSelect:i,numberOfMonths:1})})]}),(0,se.jsxs)(br,{value:o,onValueChange:c,children:[(0,se.jsx)(Nr,{className:"w-full sm:w-[240px]",children:(0,se.jsx)(yr,{placeholder:"Filter by page"})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"all",children:"All Pages"}),null==a?void 0:a.map(e=>(0,se.jsx)(Ar,{value:e,children:e},e))]})]}),d&&(0,se.jsxs)("div",{className:"flex items-center gap-2 bg-muted px-3 py-2 rounded-md",children:[(0,se.jsxs)("span",{className:"text-sm",children:["Filtered by user: ",d]}),(0,se.jsx)("button",{onClick:()=>u(null),className:"text-muted-foreground hover:text-foreground",children:(0,se.jsx)(Uy.A,{className:"h-4 w-4"})})]}),m&&(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-muted-foreground"}),(0,se.jsx)("span",{className:"text-sm text-muted-foreground",children:"Updating..."})]})]}),(0,se.jsxs)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2",children:[(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{className:"pb-2",children:(0,se.jsx)(Is,{className:"text-lg",children:"Total Unique Users"})}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"text-3xl font-bold",children:(null==n?void 0:n.unique_users_count)||0})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{className:"pb-2",children:(0,se.jsx)(Is,{className:"text-lg",children:"Top Users"})}),(0,se.jsx)(Ls,{children:(0,se.jsxs)("div",{className:"space-y-2",children:[f.map((e,t)=>(0,se.jsxs)("div",{className:"flex justify-between items-center text-sm cursor-pointer hover:bg-muted p-2 rounded-md",onClick:()=>u(e.email),children:[(0,se.jsx)("span",{className:"truncate max-w-[180px]",children:e.email}),(0,se.jsxs)("span",{className:"font-semibold",children:[e.visits," visits"]})]},t)),v&&(0,se.jsx)(zt,{variant:"ghost",className:"w-full mt-2 text-sm text-muted-foreground hover:text-foreground",onClick:()=>p(!h),children:h?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ur.A,{className:"h-4 w-4 mr-2"})," Show Less"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(_t.A,{className:"h-4 w-4 mr-2"})," Show More Users"]})})]})})]})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsx)(Is,{className:"text-lg",children:"Top Pages"})}),(0,se.jsxs)(Ls,{children:[(0,se.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Shows the most visited pages in your app and their total visit count"}),(0,se.jsx)(fV,{data:g,title:"",maxWidth:"100%",maxLabelWidth:"60%",backgroundColor:"transparent",renderLabel:e=>"all"===s?(0,se.jsx)(Z.Link,{to:"/apps/".concat(e.name),target:"_blank",className:"hover:underline",children:e.name}):e.name})]})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsx)(Is,{className:"text-lg",children:"Unique Users Over Time"})}),(0,se.jsxs)(Ls,{children:[(0,se.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Tracks the number of distinct users accessing your app each day"}),(null==n?void 0:n.users_per_date.length)<=1?(0,se.jsx)("div",{className:"h-[200px] flex items-center justify-center text-muted-foreground",children:"Not enough data to show trends"}):(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(QC.Q,{data:n.users_per_date,margin:{top:10,right:10,left:0,bottom:0},children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"date"}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"unique_users",stroke:"#8884d8",fill:"#8884d8",name:"Unique Users"})]})})})]})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsx)(Is,{className:"text-lg",children:"Total Usage Over Time"})}),(0,se.jsxs)(Ls,{children:[(0,se.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Shows the total number of visits to your app, including repeat visits from the same users"}),(null==n?void 0:n.users_per_date.length)<=1?(0,se.jsx)("div",{className:"h-[200px] flex items-center justify-center text-muted-foreground",children:"Not enough data to show trends"}):(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(QC.Q,{data:n.users_per_date,margin:{top:10,right:10,left:0,bottom:0},children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"date"}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"total_visits",stroke:"#82ca9d",fill:"#82ca9d",name:"Total Visits"})]})})})]})]})]})}const bV=function(){var e,t;const[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)([]),[r,i]=(0,Y.useState)(!0);if((0,Y.useEffect)(()=>{(async()=>{try{const[e,t]=await Promise.all([SH.getAdminStats(),Cc.getTrendingApps()]);a(e),l(t.trending_apps)}catch(e){}finally{i(!1)}})()},[]),r)return(0,se.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})});const o=(null==s||null===(e=s.usage_by_date)||void 0===e?void 0:e.map(e=>({date:e._id,messages:e.total_messages})))||[],c=(null==s||null===(t=s.tokens_by_user_7d)||void 0===t?void 0:t.map(e=>({user:e._id,tokens:e.total_tokens})))||[],d=n.map(e=>({name:e.name,visits:e.total_visits,users:e.unique_users}));return(0,se.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,se.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Platform Analytics"}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsx)(Is,{children:"Messages Per Day"})}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"h-[400px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(QC.Q,{data:o,children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"date"}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"messages",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3})]})})})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsx)(Is,{children:"Top Users by Token Usage (Last 7 Days)"})}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"h-[400px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(xA.E,{data:c,children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"user",angle:-45,textAnchor:"end",height:100}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(hA.y,{dataKey:"tokens",fill:"#82ca9d"})]})})})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsx)(Is,{children:"Trending Apps (Last 7 Days)"})}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"h-[400px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(xA.E,{data:d,children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(hA.y,{dataKey:"visits",fill:"#8884d8",name:"Total Visits"}),(0,se.jsx)(hA.y,{dataKey:"users",fill:"#82ca9d",name:"Unique Users"})]})})})})]}),(0,se.jsx)(vV,{appId:"all"})]})};function jV(){const[e,t]=(0,Y.useState)([]),[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(10),[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)(null),m=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{o&&x()},[r]),(0,Y.useEffect)(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&u(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const x=async()=>{try{a(!0),l(null),c(!0);const e=localStorage.getItem("token"),s=await fetch("".concat((0,fe.wE)(),"/api/admin/user-apps/by-complexity?limit=").concat(r),{headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok)throw new Error("Failed to fetch complex apps");const n=await s.json();t(n.apps||[])}catch(e){l(e.message)}finally{a(!1)}},h=(e,t,s)=>{s.stopPropagation(),window.open("/remix-app/".concat(e,"?clone_history=").concat(t),"_blank"),u(null)},p=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return s?(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"}),(0,se.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading complex apps..."})]})}):n?(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-slate-200 max-w-md",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Error"}),(0,se.jsx)("p",{className:"text-slate-600",children:n}),(0,se.jsx)("button",{onClick:x,className:"mt-4 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:"Try Again"})]})}):(0,se.jsx)("div",{className:"min-h-screen bg-slate-50 py-8 px-4 sm:px-6 lg:px-8",children:(0,se.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6",children:(0,se.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:"Complex Apps Dashboard"}),(0,se.jsx)("p",{className:"text-slate-600 mt-1",children:"Non-sandbox apps updated in the last 5 days, sorted by document size"})]}),(0,se.jsxs)("div",{className:"flex gap-3",children:[o&&(0,se.jsx)("button",{onClick:()=>{x()},className:"px-6 py-2 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg transition-colors",children:"Refresh"}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-slate-700 mb-1",children:"Limit"}),(0,se.jsxs)("select",{value:r,onChange:e=>i(Number(e.target.value)),className:"px-4 py-2 border border-slate-300 rounded-lg bg-white text-slate-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[(0,se.jsx)("option",{value:"10",children:"10"}),(0,se.jsx)("option",{value:"25",children:"25"}),(0,se.jsx)("option",{value:"50",children:"50"}),(0,se.jsx)("option",{value:"100",children:"100"})]})]})]})]})}),!o&&(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-12 text-center",children:[(0,se.jsx)(oy.A,{className:"h-16 w-16 text-slate-300 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-2",children:"Load Complex Apps"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:"Click the button below to fetch and analyze the most complex apps in the platform"}),(0,se.jsx)("button",{onClick:x,className:"px-8 py-3 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-lg transition-colors shadow-sm",children:"Load Apps"})]}),o&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Apps"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:e.length})]}),(0,se.jsx)(oy.A,{className:"h-8 w-8 text-orange-500"})]})}),(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Avg Code Lines"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:e.length>0?(g=e.reduce((e,t)=>e+t.code_lines,0)/e.length,g>=1e3?(g/1e3).toFixed(1)+"K":g.toFixed(0)):"0"})]}),(0,se.jsx)(Jv.A,{className:"h-8 w-8 text-teal-600"})]})}),(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Avg Pages"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:e.length>0?Math.round(e.reduce((e,t)=>e+t.pages_count,0)/e.length):"0"})]}),(0,se.jsx)(kz.A,{className:"h-8 w-8 text-teal-600"})]})}),(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Avg Components"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:e.length>0?Math.round(e.reduce((e,t)=>e+t.components_count,0)/e.length):"0"})]}),(0,se.jsx)(Zv.A,{className:"h-8 w-8 text-teal-600"})]})}),(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Avg Functions"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:e.length>0?Math.round(e.reduce((e,t)=>e+t.deployed_functions_count,0)/e.length):"0"})]}),(0,se.jsx)(yS.A,{className:"h-8 w-8 text-orange-500"})]})})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[(0,se.jsx)("div",{className:"overflow-x-auto",children:(0,se.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,se.jsx)("thead",{className:"bg-slate-50",children:(0,se.jsxs)("tr",{children:[(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"App Name"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Creator"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Doc Size (KB)"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Code Lines"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Pages"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Components"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Functions"}),(0,se.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Updated"})]})}),(0,se.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:e.map((e,t)=>(0,se.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>window.open("/apps/".concat(e.app_id),"_blank"),children:[(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"relative",ref:d===e.app_id?m:null,children:[(0,se.jsxs)("button",{onClick:t=>((e,t)=>{t.stopPropagation(),u(d===e?null:e)})(e.app_id,t),className:"inline-flex items-center px-3 py-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg transition-colors",children:[(0,se.jsx)(ob.A,{className:"h-4 w-4 mr-2"}),"Clone",(0,se.jsx)(_t.A,{className:"h-4 w-4 ml-1"})]}),d===e.app_id&&(0,se.jsxs)("div",{className:"absolute left-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-slate-200 z-50 overflow-hidden",children:[(0,se.jsxs)("button",{onClick:t=>h(e.app_id,!0,t),className:"w-full px-4 py-3 text-left hover:bg-slate-50 transition-colors border-b border-slate-100 flex items-start",children:[(0,se.jsx)(oy.A,{className:"h-5 w-5 text-orange-500 mr-3 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"With Full History"}),(0,se.jsx)("div",{className:"text-xs text-slate-500 mt-0.5",children:"Clone with all chat messages"})]})]}),(0,se.jsxs)("button",{onClick:t=>h(e.app_id,!1,t),className:"w-full px-4 py-3 text-left hover:bg-slate-50 transition-colors flex items-start",children:[(0,se.jsx)(yS.A,{className:"h-5 w-5 text-teal-600 mr-3 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Start Fresh"}),(0,se.jsx)("div",{className:"text-xs text-slate-500 mt-0.5",children:"Clone only the app code"})]})]})]})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("div",{className:"flex-shrink-0 h-10 w-10 bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg flex items-center justify-center text-white font-bold",children:t+1}),(0,se.jsxs)("div",{className:"ml-4",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900",children:e.name}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:e.app_id})]})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(ay.A,{className:"h-4 w-4 text-slate-400 mr-2"}),(0,se.jsx)("div",{className:"text-sm text-slate-900",children:e.created_by})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(oy.A,{className:"h-4 w-4 text-orange-500 mr-2"}),(0,se.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.document_size_kb.toLocaleString()})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(Jv.A,{className:"h-4 w-4 text-teal-600 mr-2"}),(0,se.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.code_lines.toLocaleString()})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(kz.A,{className:"h-4 w-4 text-teal-600 mr-2"}),(0,se.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.pages_count})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(Zv.A,{className:"h-4 w-4 text-teal-600 mr-2"}),(0,se.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.components_count})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(yS.A,{className:"h-4 w-4 text-orange-500 mr-2"}),(0,se.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:e.deployed_functions_count})]})}),(0,se.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(H_.A,{className:"h-4 w-4 text-slate-400 mr-2"}),(0,se.jsx)("span",{className:"text-sm text-slate-600",children:p(e.updated_date)})]})})]},e.app_id))})]})}),0===e.length&&(0,se.jsx)("div",{className:"text-center py-12",children:(0,se.jsx)("p",{className:"text-slate-500",children:"No complex apps found"})})]})]})]})});var g}var yV=s(11464);const NV="s3";class wV extends te.H{getBaseURL(){return"/admin/sandbox"}getSandboxStatus(e){return this.axios.get("/".concat(e,"/status"))}startSandbox(e){return this.axios.post("/".concat(e))}stopSandbox(e){return this.axios.delete("/".concat(e))}restartSandbox(e){return this.axios.post("/".concat(e,"/restart"))}launchVSCode(e){return this.axios.post("/".concat(e,"/vscode"))}stopVSCode(e){return this.axios.delete("/".concat(e,"/vscode"))}unmigrateApp(e){return this.axios.post("/".concat(e,"/unmigrate"))}migrateApp(e){return this.axios.post("/".concat(e,"/migrate"))}restoreFromArchive(e){let{appId:t,source:s,commitHash:a}=e;return this.axios.post("/".concat(t,"/restore-from-archive"),{source:s,commit_hash:a})}listCheckpoints(e){let{appId:t,limit:s=30}=e;return this.axios.get("/".concat(t,"/checkpoints?limit=").concat(s))}restoreFromCheckpoint(e){let{appId:t,checkpointId:s}=e;return this.axios.post("/".concat(t,"/checkpoints/").concat(s,"/restore"))}}const _V=new wV;function kV(e){let{hash:t,className:s=""}=e;const[a,n]=(0,Y.useState)(!1),l=(0,Y.useCallback)(async()=>{if(t)try{await navigator.clipboard.writeText(t),n(!0),setTimeout(()=>n(!1),1500)}catch(e){}},[t]);return t?(0,se.jsx)("button",{onClick:l,className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded transition-colors ".concat(s),title:a?"Copied!":"Copy full hash: ".concat(t),children:a?(0,se.jsx)(sd.A,{className:"h-3.5 w-3.5 text-green-500"}):(0,se.jsx)(ob.A,{className:"h-3.5 w-3.5"})}):null}function CV(e){const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/1e3),n=Math.floor(a/60),l=Math.floor(n/60),r=Math.floor(l/24);return r>0?"".concat(r,"d ago"):l>0?"".concat(l,"h ago"):n>0?"".concat(n,"m ago"):"just now"}var AV=function(e){return e.Latest="latest",e.Specific="specific",e}(AV||{});function SV(){const[e,t]=(0,Y.useState)(""),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(AV.Latest),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)([]),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(null),v=e=>/^[a-fA-F0-9]{40}$/.test(e),b=o&&!v(o)?"Commit hash must be exactly 40 hexadecimal characters":null,j=r===AV.Latest||r===AV.Specific&&v(o),y=(0,Y.useCallback)(async e=>{x(!0),p(null);try{const t=[...(await _V.listCheckpoints({appId:e,limit:30})).checkpoints].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());u(t)}catch(a){var t,s;const e=a;p((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Failed to fetch checkpoints"),u([])}finally{x(!1)}},[]);(0,Y.useEffect)(()=>{r===AV.Specific&&null!=s&&s.appId&&y(s.appId)},[r,null==s?void 0:s.appId,y]);const{mutate:N,isLoading:w}=eu({mutate:async e=>{l(null),i(AV.Latest),c(""),u([]),p(null),f(null);const t=await _V.getSandboxStatus(e);return a({appId:t.app_id,appName:t.app_name,ownerEmail:t.owner_email,sandboxExists:t.sandbox_exists,vscodeRunning:t.vscode_running,gitRepositoryExists:t.git_repository_exists,usingSandbox:t.using_sandbox,accessUrl:t.access_url}),t},onError:e=>{var t,s;l((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Failed to fetch sandbox status"),a(null)}}),{mutate:_,isLoading:k}=eu({mutate:async e=>{const t=await _V.launchVSCode(e);return t.success&&t.access_url&&a(e=>e?(0,ue.A)((0,ue.A)({},e),{},{vscodeRunning:!0,sandboxExists:!0,accessUrl:t.access_url}):null),t},onError:e=>{}}),{mutate:C,isLoading:A}=eu({mutate:async e=>{const t=await _V.stopVSCode(e);return t.success&&a(e=>e?(0,ue.A)((0,ue.A)({},e),{},{vscodeRunning:!1,accessUrl:void 0}):null),t},onError:e=>{}}),{mutate:S,isLoading:E}=eu({mutate:async e=>{if(!window.confirm("Are you sure you want to stop the sandbox for app ".concat(e,"? This will terminate the entire sandbox.")))throw new Error("User cancelled");const t=await _V.stopSandbox(e);return t.success&&a(e=>e?(0,ue.A)((0,ue.A)({},e),{},{sandboxExists:!1,vscodeRunning:!1,accessUrl:void 0}):null),t},onError:e=>{e.message}}),{mutate:T,isLoading:I}=eu({mutate:async e=>{const t=await _V.startSandbox(e);return t.success&&a(e=>e?(0,ue.A)((0,ue.A)({},e),{},{sandboxExists:!0}):null),t},onError:e=>{}}),{mutate:P,isLoading:L}=eu({mutate:async e=>{const t=await _V.restartSandbox(e);return t.success&&a(e=>e?(0,ue.A)((0,ue.A)({},e),{},{sandboxExists:!0,vscodeRunning:!1,accessUrl:void 0}):null),t},onError:e=>{}}),M=()=>{const t=e.trim();t&&N(t)},{mutate:R,isLoading:D}=eu({mutate:async e=>{if(!window.confirm("Are you sure you want to revert app ".concat(e," to the old infrastructure? This will disable sandbox mode.")))throw new Error("User cancelled");const t=await _V.unmigrateApp(e);return t.success&&a(e=>e?(0,ue.A)((0,ue.A)({},e),{},{usingSandbox:!1,sandboxExists:!1,vscodeRunning:!1}):null),t},onError:e=>{var t,s;"User cancelled"!==e.message&&alert("Failed to unmigrate app: ".concat((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Unknown error"))}}),{mutate:F,isLoading:O}=eu({mutate:async e=>{if(!window.confirm("Are you sure you want to migrate app ".concat(e," to the new sandbox infrastructure?")))throw new Error("User cancelled");const t=await _V.migrateApp(e);return t.success&&a(e=>e?(0,ue.A)((0,ue.A)({},e),{},{usingSandbox:!0,sandboxExists:!0,gitRepositoryExists:!0}):null),t},onError:e=>{var t,s;"User cancelled"!==e.message&&alert("Failed to migrate app: ".concat((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Unknown error"))}}),{mutate:U,isLoading:B}=eu({mutate:async e=>{let{appId:t,commitHash:s}=e;const a=s?"commit ".concat(s.slice(0,7)):"latest commit";if(!window.confirm("Are you sure you want to restore sandbox from archive for app ".concat(t,"? This will stop the current sandbox and create a fresh one with files from the S3 archive (").concat(a,").")))throw new Error("User cancelled");const n=await _V.restoreFromArchive({appId:t,source:NV,commitHash:s});return n.success?(alert("Successfully restored sandbox from archive. Commit: ".concat(n.git_commit_hash||"N/A")),c(""),i(AV.Latest)):alert("Restore failed: ".concat(n.error||"Unknown error")),n},onError:e=>{var t,s;"User cancelled"!==e.message&&alert("Failed to restore from archive: ".concat((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Unknown error"))}}),{mutate:z,isLoading:H}=eu({mutate:async e=>{let{appId:t,checkpointId:s,checkpointName:a}=e;if(!window.confirm('Restore from checkpoint "'.concat(a,"\"?\n\nThis will:\n\u2022 Clear the checkpoint's git commit hash\n\u2022 Reload the checkpoint with a new git commit\n\u2022 Clear the Redis cache for static preview")))throw new Error("User cancelled");const n=await _V.restoreFromCheckpoint({appId:t,checkpointId:s});return n.success?(alert("Checkpoint restored successfully!\n\nNew commit hash: ".concat(n.new_git_commit_hash||"N/A")),y(t),f(null)):alert("Restore failed: ".concat(n.error||"Unknown error")),n},onError:e=>{var t,s;"User cancelled"!==e.message&&alert("Failed to restore from checkpoint: ".concat((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Unknown error"))}}),V=k||A||E||L||I||D||O||B||H;return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsxs)("div",{className:"flex items-center mb-4",children:[(0,se.jsx)(Hy.A,{className:"h-7 w-7 text-blue-600 mr-3"}),(0,se.jsx)("h2",{className:"text-2xl font-bold",children:"Sandbox Management"})]}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:"Search for an app to manage its sandbox"})]}),(0,se.jsx)("div",{className:"mb-6",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-slate-500"}),(0,se.jsx)(Df,{placeholder:"Enter App ID...",className:"pl-9",value:e,onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"===e.key&&M()}})]}),(0,se.jsx)("button",{onClick:M,disabled:w||!e.trim(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:w?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(na.A,{className:"h-4 w-4 mr-2"}),"Search"]})})]})}),n&&(0,se.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-red-500 mr-3 mt-0.5 flex-shrink-0"}),(0,se.jsx)("div",{className:"text-sm text-red-700",children:n})]}),s&&(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(yV.A,{className:"h-5 w-5 text-slate-600"}),(0,se.jsx)("span",{className:"font-semibold text-slate-900",children:"Sandbox Details"})]}),(0,se.jsx)("button",{onClick:()=>{null!=s&&s.appId&&N(s.appId)},disabled:w,className:"p-2 text-slate-600 hover:bg-slate-200 rounded-lg transition-colors disabled:opacity-50",title:"Refresh Status",children:(0,se.jsx)(Fx.A,{className:"h-4 w-4 ".concat(w?"animate-spin":"")})})]}),(0,se.jsxs)("div",{className:"p-6",children:[(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[{label:"App ID",value:s.appId,mono:!0},{label:"App Name",value:s.appName||"-"},{label:"Owner",value:s.ownerEmail||"-"},{label:"Active Sandbox",render:()=>s.sandboxExists?(0,se.jsxs)("span",{className:"inline-flex items-center px-3 py-2 rounded bg-green-100 text-green-800 text-sm font-medium",children:[(0,se.jsx)(sd.A,{className:"h-4 w-4 mr-2"}),"Running"]}):(0,se.jsxs)("span",{className:"inline-flex items-center px-3 py-2 rounded bg-slate-100 text-slate-600 text-sm font-medium",children:[(0,se.jsx)(Uy.A,{className:"h-4 w-4 mr-2"}),"Not Running"]})},{label:"Git Repository",render:()=>s.gitRepositoryExists?(0,se.jsxs)("span",{className:"inline-flex items-center px-3 py-2 rounded bg-green-100 text-green-800 text-sm font-medium",children:[(0,se.jsx)(sd.A,{className:"h-4 w-4 mr-2"}),"Exists"]}):(0,se.jsxs)("span",{className:"inline-flex items-center px-3 py-2 rounded bg-slate-100 text-slate-600 text-sm font-medium",children:[(0,se.jsx)(Uy.A,{className:"h-4 w-4 mr-2"}),"Not Found"]})}].map(e=>(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:e.label}),(0,se.jsx)("div",{className:"mt-1",children:e.render?e.render():(0,se.jsx)("p",{className:"text-sm text-slate-900 bg-slate-100 px-3 py-2 rounded ".concat(e.mono?"font-mono":""),children:e.value})})]},e.label))}),(0,se.jsx)("div",{className:"flex flex-wrap gap-3 pt-4 border-t border-slate-200",children:s.sandboxExists?(0,se.jsxs)(se.Fragment,{children:[s.vscodeRunning?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("button",{onClick:()=>s.accessUrl&&window.open(s.accessUrl,"_blank"),className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg transition-colors flex items-center",title:"Open VS Code",children:[(0,se.jsx)(Rj.A,{className:"h-4 w-4 mr-2"}),"Open VS Code"]}),(0,se.jsxs)("button",{onClick:()=>C(s.appId),disabled:V,className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",title:"Stop VS Code",children:[A?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(_p.A,{className:"h-4 w-4 mr-2"}),"Stop VS Code"]})]}):(0,se.jsxs)("button",{onClick:()=>_(s.appId),disabled:V,className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",title:"Launch VS Code",children:[k?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(LF.A,{className:"h-4 w-4 mr-2"}),"Launch VS Code"]}),(0,se.jsxs)("button",{onClick:()=>P(s.appId),disabled:V,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",title:"Restart Sandbox",children:[L?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2"}),"Restart Sandbox"]}),(0,se.jsxs)("button",{onClick:()=>S(s.appId),disabled:V,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",title:"Stop Sandbox",children:[E?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(_p.A,{className:"h-4 w-4 mr-2"}),"Stop Sandbox"]})]}):s.usingSandbox&&(0,se.jsxs)("button",{onClick:()=>T(s.appId),disabled:V,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",title:"Start Sandbox",children:[I?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(LF.A,{className:"h-4 w-4 mr-2"}),"Start Sandbox"]})}),(0,se.jsx)("div",{className:"flex flex-wrap gap-3 pt-3 mt-3 border-t border-slate-200",children:s.usingSandbox?(0,se.jsxs)("button",{onClick:()=>R(s.appId),disabled:V,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",title:"Revert to Old Infrastructure",children:[D?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2"}),"Revert to Old Infrastructure"]}):(0,se.jsxs)("button",{onClick:()=>F(s.appId),disabled:V,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",title:"Migrate to New Infrastructure",children:[O?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2"}),"Migrate to New Infrastructure"]})}),s.usingSandbox&&(0,se.jsxs)("div",{className:"pt-3 mt-3 border-t border-slate-200",children:[(0,se.jsx)("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide mb-3 block",children:"Restore from Archive"}),(0,se.jsxs)("div",{className:"grid gap-6 ".concat(r===AV.Specific?"grid-cols-2":"grid-cols-1"),children:[(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)("input",{type:"radio",name:"commitHashMode",value:"latest",checked:r===AV.Latest,onChange:()=>i(AV.Latest),className:"w-4 h-4 text-cyan-600 border-slate-300 focus:ring-cyan-500"}),(0,se.jsx)("span",{className:"text-sm text-slate-700",children:"Latest commit hash"})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,se.jsx)("input",{type:"radio",name:"commitHashMode",value:"specific",checked:r===AV.Specific,onChange:()=>i(AV.Specific),className:"w-4 h-4 text-cyan-600 border-slate-300 focus:ring-cyan-500"}),(0,se.jsx)("span",{className:"text-sm text-slate-700",children:"Specific commit hash"})]}),r===AV.Specific&&(0,se.jsxs)("div",{className:"ml-6",children:[(0,se.jsx)(Df,{placeholder:"Enter full 40-character commit hash...",value:o,onChange:e=>c(e.target.value.trim()),className:"font-mono text-sm ".concat(b?"border-red-300 focus:ring-red-500":""),maxLength:40}),b&&(0,se.jsx)("p",{className:"mt-1 text-xs text-red-600",children:b})]})]}),(0,se.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,se.jsxs)("button",{onClick:()=>U({appId:s.appId,commitHash:r===AV.Specific?o:void 0}),disabled:V||!j,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",title:"Restore Sandbox from Archive",children:[B?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(tB.A,{className:"h-4 w-4 mr-2"}),"Restore from Archive"]}),(0,se.jsxs)("button",{onClick:()=>g&&z({appId:s.appId,checkpointId:g.id,checkpointName:g.name}),disabled:V||!g,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",title:g?'Restore from checkpoint "'.concat(g.name,'"'):"Select a checkpoint first",children:[H?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(Yb.A,{className:"h-4 w-4 mr-2"}),"Restore from Checkpoint"]})]})]}),r===AV.Specific&&(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,se.jsx)("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Available Checkpoints"}),(0,se.jsx)("button",{onClick:()=>(null==s?void 0:s.appId)&&y(s.appId),disabled:m,className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded transition-colors disabled:opacity-50",title:"Refresh checkpoints",children:(0,se.jsx)(Fx.A,{className:"h-3.5 w-3.5 ".concat(m?"animate-spin":"")})})]}),h&&(0,se.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700 flex items-center",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-2 flex-shrink-0"}),h]}),m?(0,se.jsxs)("div",{className:"flex items-center justify-center py-6 text-slate-400 text-sm",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}),"Loading checkpoints..."]}):h?null:0===d.length?(0,se.jsx)("div",{className:"text-center py-6 text-slate-400 text-sm",children:"No checkpoints found"}):(0,se.jsx)("div",{className:"border border-slate-200 rounded-lg overflow-hidden h-72 overflow-y-auto",children:(0,se.jsxs)("table",{className:"w-full text-sm",children:[(0,se.jsx)("thead",{className:"bg-slate-50 sticky top-0",children:(0,se.jsxs)("tr",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wide",children:[(0,se.jsx)("th",{className:"px-3 py-2",children:"Date"}),(0,se.jsx)("th",{className:"px-3 py-2",children:"Checkpoint Name"}),(0,se.jsx)("th",{className:"px-3 py-2",children:"Commit Hash"}),(0,se.jsx)("th",{className:"px-3 py-2 w-10"})]})}),(0,se.jsx)("tbody",{className:"divide-y divide-slate-100",children:d.map(e=>{return(0,se.jsxs)("tr",{onClick:()=>(e=>{e.git_commit_hash&&c(e.git_commit_hash),f({id:e.id,name:e.name})})(e),className:"hover:bg-slate-50 cursor-pointer transition-colors ".concat((null==g?void 0:g.id)===e.id?"bg-cyan-50 hover:bg-cyan-100":""),children:[(0,se.jsx)("td",{className:"px-3 py-2 text-slate-600 whitespace-nowrap",children:(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{className:"text-xs",children:(t=e.created_at,new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}))}),(0,se.jsx)("span",{className:"text-[10px] text-slate-400",children:CV(e.created_at)})]})}),(0,se.jsx)("td",{className:"px-3 py-2 text-slate-700 truncate max-w-[200px]",title:e.name,children:e.name}),(0,se.jsx)("td",{className:"px-3 py-2",children:e.git_commit_hash?(0,se.jsx)("code",{className:"font-mono text-xs text-slate-600 bg-slate-100 px-1.5 py-0.5 rounded",children:e.git_commit_hash.substring(0,7)}):(0,se.jsx)("span",{className:"text-slate-400 text-xs",children:"No hash"})}),(0,se.jsx)("td",{className:"px-3 py-2",onClick:e=>e.stopPropagation(),children:(0,se.jsx)(kV,{hash:e.git_commit_hash})})]},e.id);var t})})]})}),(0,se.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:"Note: Not every checkpoint may have an archive available."})]})]})]})]})]}),!s&&!n&&(0,se.jsxs)("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-12 text-center",children:[(0,se.jsx)(na.A,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Search for an App"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Enter an App ID above to view and manage its sandbox"})]}),(0,se.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Quick Guide:"}),(0,se.jsxs)("div",{className:"text-sm text-blue-700 space-y-1",children:[(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)(LF.A,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("strong",{children:"Launch VS Code"})," - Start VS Code Server on the sandbox for debugging"]})]}),(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)(_p.A,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("strong",{children:"Stop VS Code"})," - Stop VS Code Server but keep the sandbox running"]})]}),(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("strong",{children:"Restart Sandbox"})," - Stop and relaunch a fresh sandbox"]})]}),(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)(_p.A,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0 text-red-600"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("strong",{children:"Stop Sandbox"})," - Terminate the sandbox (use with caution)"]})]}),(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)(tB.A,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0 text-cyan-600"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("strong",{children:"Restore from Archive"})," - Stop sandbox and restore files from S3 archive"]})]})]})]})]})}var EV=s(61714);function TV(){const{user:e}=wd(),[t,s]=(0,Y.useState)([]),[a,n]=(0,Y.useState)(!1),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(""),[p,g]=(0,Y.useState)(""),[f,v]=(0,Y.useState)(!1),[b,j]=(0,Y.useState)(null),[y,N]=(0,Y.useState)(null),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)(""),[A,S]=(0,Y.useState)(null),[E,T]=(0,Y.useState)(!1),[I,P]=(0,Y.useState)(null),[L,M]=(0,Y.useState)(!1),R=x.trim()?t.find(e=>e.app_id===x.trim()):null;if(!Kp(null==e?void 0:e.platform_role,"platform_admin"))return(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(jH.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Access Denied"}),(0,se.jsx)("p",{className:"text-slate-600",children:"You must be a platform admin to access this page"})]})});const D=async()=>{try{n(!0),r(null),o(!0);const e=localStorage.getItem("token"),t=await fetch("".concat((0,fe.wE)(),"/api/admin/blocked-apps"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||"Failed to fetch blocked apps")}const a=await t.json();s(a.apps||[])}catch(e){r(e.message)}finally{n(!1)}},F=e=>{m(e),h(e.app_id),g(e.reason||""),j(null),d(!0)},O=()=>{d(!1),m(null),h(""),g(""),j(null)},U=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})};return a?(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"}),(0,se.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading blocked apps..."})]})}):l&&!i?(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-slate-200 max-w-md",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Error"}),(0,se.jsx)("p",{className:"text-slate-600",children:l}),(0,se.jsx)("button",{onClick:D,className:"mt-4 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:"Try Again"})]})}):(0,se.jsxs)("div",{className:"min-h-screen bg-slate-50 py-8 px-4 sm:px-6 lg:px-8",children:[(0,se.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6",children:(0,se.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsxs)("h1",{className:"text-3xl font-bold text-slate-800 flex items-center gap-3",children:[(0,se.jsx)(EV.A,{className:"h-8 w-8 text-red-500"}),"Blocked Apps Management"]}),(0,se.jsx)("p",{className:"text-slate-600 mt-1",children:"View and manage blocked applications in the render cache"})]}),(0,se.jsxs)("div",{className:"flex gap-3",children:[i&&(0,se.jsx)("button",{onClick:D,className:"px-6 py-2 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg transition-colors",children:"Refresh"}),(0,se.jsxs)("button",{onClick:()=>d(!0),className:"px-6 py-2 bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[(0,se.jsx)(op.A,{className:"h-4 w-4"}),"Block App"]})]})]})}),(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-6",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-800 mb-3",children:"Lookup App by ID"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Quickly check if a specific app is blocked and unblock it without loading the full list."}),(0,se.jsxs)("form",{onSubmit:async e=>{null==e||e.preventDefault();const t=k.trim();if(t)try{T(!0),P(null),S(null);const e=localStorage.getItem("token"),s=await fetch("".concat((0,fe.wE)(),"/api/admin/blocked-apps/").concat(t),{headers:{Authorization:"Bearer ".concat(e)}});if(404===s.status)return void P("App is not blocked (or does not exist)");if(!s.ok){const e=await s.json().catch(()=>({}));throw new Error(e.detail||"Failed to lookup app")}const a=await s.json();S(a)}catch(s){P(s.message)}finally{T(!1)}else P("Please enter an App ID")},className:"flex gap-3",children:[(0,se.jsx)("input",{type:"text",value:k,onChange:e=>C(e.target.value),placeholder:"Enter App ID (e.g., 67abc123def456...)",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"}),(0,se.jsx)("button",{type:"submit",disabled:E,className:"px-6 py-2 bg-orange-500 hover:bg-orange-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50",children:E?"Looking up...":"Lookup"})]}),I&&(0,se.jsxs)("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-2",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-amber-600 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-amber-800 text-sm",children:I})]}),A&&(0,se.jsx)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,se.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)(EV.A,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),(0,se.jsx)("span",{className:"font-semibold text-slate-800",children:A.name||"Unnamed App"}),(0,se.jsxs)("span",{className:"text-sm text-slate-500",children:["(",A.slug,")"]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"App ID:"})," ",(0,se.jsx)("span",{className:"text-slate-700 font-mono text-xs",children:A.app_id})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Blocked by:"})," ",(0,se.jsx)("span",{className:"text-slate-700",children:A.blocked_by})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Blocked at:"})," ",(0,se.jsx)("span",{className:"text-slate-700",children:U(A.blocked_at)})]}),A.domains&&A.domains.length>0&&(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Domains:"})," ",(0,se.jsx)("span",{className:"text-slate-700",children:A.domains.join(", ")})]})]}),A.reason&&(0,se.jsxs)("div",{className:"mt-2 text-sm",children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Reason:"})," ",(0,se.jsx)("span",{className:"text-slate-700",children:A.reason})]})]}),(0,se.jsxs)("button",{onClick:async()=>{if(A)try{M(!0);const e=localStorage.getItem("token"),t=await fetch("".concat((0,fe.wE)(),"/api/admin/blocked-apps/unblock/").concat(A.app_id),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||"Failed to unblock app")}S(null),C(""),P(null),i&&D()}catch(e){P(e.message)}finally{M(!1)}},disabled:L,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2 flex-shrink-0",children:[(0,se.jsx)(Yc.A,{className:"h-4 w-4"}),L?"Unblocking...":"Unblock"]})]})})]}),l&&i&&(0,se.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center gap-3",children:[(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-red-700",children:l}),(0,se.jsx)("button",{onClick:()=>r(null),className:"ml-auto text-red-500 hover:text-red-700",children:(0,se.jsx)(la.A,{className:"h-4 w-4"})})]}),!i&&(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-12 text-center",children:[(0,se.jsx)(EV.A,{className:"h-16 w-16 text-slate-300 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-2",children:"Load Blocked Apps"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:"Click the button below to view all blocked applications"}),(0,se.jsx)("button",{onClick:D,className:"px-8 py-3 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-lg transition-colors shadow-sm",children:"Load Apps"})]}),i&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"mb-6",children:(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4 inline-block",children:(0,se.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Blocked"}),(0,se.jsx)("p",{className:"text-2xl font-bold text-slate-800 mt-1",children:t.length})]}),(0,se.jsx)(EV.A,{className:"h-8 w-8 text-red-500"})]})})}),(0,se.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[(0,se.jsx)("div",{children:(0,se.jsxs)("table",{className:"w-full divide-y divide-slate-200 table-fixed",children:[(0,se.jsx)("thead",{className:"bg-slate-50",children:(0,se.jsxs)("tr",{children:[(0,se.jsx)("th",{className:"w-52 px-3 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"App"}),(0,se.jsx)("th",{className:"w-36 px-3 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Blocked By"}),(0,se.jsx)("th",{className:"w-40 px-3 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Blocked At"}),(0,se.jsx)("th",{className:"w-72 px-3 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Reason"}),(0,se.jsx)("th",{className:"w-40 px-3 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Domains"}),(0,se.jsx)("th",{className:"w-24 px-3 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),(0,se.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:t.map(e=>(0,se.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors",children:[(0,se.jsx)("td",{className:"px-3 py-3",children:(0,se.jsxs)("div",{className:"flex items-center min-w-0",children:[(0,se.jsx)("div",{className:"flex-shrink-0 h-8 w-8 bg-gradient-to-br from-red-400 to-red-600 rounded-lg flex items-center justify-center text-white",children:(0,se.jsx)(EV.A,{className:"h-4 w-4"})}),(0,se.jsxs)("div",{className:"ml-2 min-w-0",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-900 truncate",title:"".concat(e.name||"Unnamed App"," (").concat(e.slug||"no slug",")\nID: ").concat(e.app_id),children:e.name||"Unnamed App"}),(0,se.jsxs)("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,se.jsx)("span",{className:"truncate",title:e.slug,children:e.slug}),(0,se.jsx)("a",{href:"/apps/".concat(e.app_id),target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 hover:text-orange-600 flex-shrink-0",onClick:e=>e.stopPropagation(),children:(0,se.jsx)(Rj.A,{className:"h-3 w-3"})})]})]})]})}),(0,se.jsx)("td",{className:"px-3 py-3",children:(0,se.jsx)("div",{className:"text-sm text-slate-900 truncate",title:e.blocked_by,children:e.blocked_by})}),(0,se.jsx)("td",{className:"px-3 py-3",children:(0,se.jsx)("div",{className:"text-sm text-slate-600 truncate",title:U(e.blocked_at),children:U(e.blocked_at)})}),(0,se.jsx)("td",{className:"px-3 py-3",children:(0,se.jsx)("div",{className:"text-sm text-slate-700 line-clamp-3",title:e.reason||void 0,children:e.reason||(0,se.jsx)("span",{className:"text-slate-400 italic",children:"No reason"})})}),(0,se.jsx)("td",{className:"px-3 py-3",children:e.domains&&e.domains.length>0?(0,se.jsxs)("div",{className:"flex flex-wrap gap-1",title:e.domains.join("\n"),children:[e.domains.slice(0,2).map(e=>(0,se.jsxs)("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 text-xs bg-teal-50 text-teal-700 rounded",title:e,children:[(0,se.jsx)(KP.A,{className:"h-3 w-3"}),(0,se.jsx)("span",{className:"truncate max-w-20",children:e})]},e)),e.domains.length>2&&(0,se.jsxs)("span",{className:"text-xs text-slate-500",title:e.domains.slice(2).join("\n"),children:["+",e.domains.length-2]})]}):(0,se.jsx)("span",{className:"text-sm text-slate-400",children:"None"})}),(0,se.jsx)("td",{className:"px-3 py-3",children:y===e.app_id?(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,se.jsx)("button",{onClick:()=>(async e=>{try{_(!0);const t=localStorage.getItem("token"),s=await fetch("".concat((0,fe.wE)(),"/api/admin/blocked-apps/unblock/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok){const e=await s.json().catch(()=>({}));throw new Error(e.detail||"Failed to unblock app")}N(null),D()}catch(t){r(t.message)}finally{_(!1)}})(e.app_id),disabled:w,className:"px-2 py-1 bg-green-500 hover:bg-green-600 text-white text-xs font-medium rounded transition-colors disabled:opacity-50",children:w?"...":"Confirm"}),(0,se.jsx)("button",{onClick:()=>N(null),className:"px-2 py-1 bg-slate-200 hover:bg-slate-300 text-slate-700 text-xs font-medium rounded transition-colors",children:"Cancel"})]}):(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,se.jsxs)("button",{onClick:()=>F(e),className:"inline-flex items-center px-2 py-1.5 bg-slate-100 hover:bg-slate-200 text-slate-700 text-xs font-medium rounded transition-colors",children:[(0,se.jsx)(Zw.A,{className:"h-3 w-3 mr-1"}),"Edit"]}),(0,se.jsxs)("button",{onClick:()=>N(e.app_id),className:"inline-flex items-center px-2 py-1.5 bg-green-500 hover:bg-green-600 text-white text-xs font-medium rounded transition-colors",children:[(0,se.jsx)(Yc.A,{className:"h-3 w-3 mr-1"}),"Unblock"]})]})})]},e.app_id))})]})}),0===t.length&&(0,se.jsxs)("div",{className:"text-center py-12",children:[(0,se.jsx)(Yc.A,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,se.jsx)("p",{className:"text-slate-600 font-medium",children:"No blocked apps"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm mt-1",children:"All apps are currently accessible"})]})]})]})]}),c&&(0,se.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,se.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:(0,se.jsxs)("div",{className:"p-6",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-800 flex items-center gap-2",children:u?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Zw.A,{className:"h-5 w-5 text-slate-600"}),"Edit Block Reason"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(EV.A,{className:"h-5 w-5 text-red-500"}),"Block App"]})}),(0,se.jsx)("button",{onClick:O,className:"text-slate-400 hover:text-slate-600",children:(0,se.jsx)(la.A,{className:"h-5 w-5"})})]}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),x.trim())if(u||!R)try{v(!0),j(null);const e=localStorage.getItem("token"),t=await fetch("".concat((0,fe.wE)(),"/api/admin/blocked-apps/block"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({app_id:x.trim(),reason:p.trim()||null})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.detail||"Failed to block app")}O(),D()}catch(t){j(t.message)}finally{v(!1)}else j("This app is already blocked. Use Edit to update the reason.");else j("App ID is required")},children:[b&&(0,se.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:(0,se.jsxs)("div",{className:"flex items-start gap-2",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{children:[b,R&&!u&&(0,se.jsx)("button",{type:"button",onClick:()=>F(R),className:"ml-2 text-red-800 underline hover:no-underline",children:"Edit instead"})]})]})}),(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["App ID ",(0,se.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,se.jsx)("input",{type:"text",value:x,onChange:e=>h(e.target.value),placeholder:"Enter app ID...",disabled:!!u,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent ".concat(u?"bg-slate-100 text-slate-500":"")})]}),(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reason (optional)"}),(0,se.jsx)("textarea",{value:p,onChange:e=>g(e.target.value),placeholder:"Why is this app being blocked?",rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"})]}),(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsx)("button",{type:"button",onClick:O,className:"flex-1 px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 font-medium rounded-lg transition-colors",children:"Cancel"}),(0,se.jsx)("button",{type:"submit",disabled:f,className:"flex-1 px-4 py-2 font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center justify-center gap-2 ".concat(u?"bg-slate-700 hover:bg-slate-800 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:f?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),u?"Saving...":"Blocking..."]}):(0,se.jsx)(se.Fragment,{children:u?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Zw.A,{className:"h-4 w-4"}),"Save Changes"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(EV.A,{className:"h-4 w-4"}),"Block App"]})})})]})]})]})})})]})}var IV=s(93682),PV=s(79012),LV=s(72082);class MV extends te.H{getBaseURL(){return"/admin/apps"}async exportApp(e){return await this.axios.get("/".concat(e,"/export"),{responseType:"blob"})}async importApp(e,t){const s=new FormData;s.append("file",e),t&&s.append("secret_values",JSON.stringify(t));return await this.axios.post("/import",s,{headers:{"Content-Type":"multipart/form-data"}})}}const RV=new MV;function DV(){const[e,t]=(0,Y.useState)(""),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),{mutate:r,isLoading:i}=eu({mutate:async e=>{l(null);try{const t=await RV.exportApp(e),s=window.URL.createObjectURL(t),n=document.createElement("a");return n.href=s,n.download="app_export_".concat(e,"_").concat((new Date).toISOString().split("T")[0],".zip"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s),a({appId:e}),t}catch(t){throw t}},onError:e=>{var t,s;l((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Failed to export app")}}),o=()=>{const t=e.trim();t&&r(t)};return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"text-center pb-4 border-b border-slate-200",children:[(0,se.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-teal-50 mb-3",children:(0,se.jsx)(IV.A,{className:"h-6 w-6 text-teal-600"})}),(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Export App"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm mt-1",children:"Export an app as a ZIP file for backup or transfer to another environment"})]}),s?(0,se.jsxs)("div",{className:"text-center py-6",children:[(0,se.jsx)(sd.A,{className:"h-14 w-14 text-green-500 mx-auto mb-4"}),(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Export Complete"}),(0,se.jsx)("p",{className:"text-slate-600 mb-1",children:"App exported successfully"}),(0,se.jsx)("code",{className:"bg-slate-100 px-3 py-1 rounded text-sm font-mono text-slate-700",children:s.appId}),(0,se.jsx)("div",{className:"mt-6",children:(0,se.jsx)("button",{onClick:()=>{t(""),a(null),l(null)},className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium rounded-lg transition-colors",children:"Export Another App"})})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"App ID"}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)("div",{className:"relative flex-1",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-slate-400"}),(0,se.jsx)(Df,{placeholder:"Enter the App ID to export...",className:"pl-9",value:e,onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"===e.key&&o()}})]}),(0,se.jsxs)("button",{onClick:o,disabled:i||!e.trim(),className:"px-5 py-2 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:[i?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(aL.A,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),n&&(0,se.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:n}),(0,se.jsxs)("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-lg",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-2",children:"Export includes:"}),(0,se.jsxs)("ul",{className:"text-sm text-slate-600 space-y-1",children:[(0,se.jsxs)("li",{className:"flex items-center",children:[(0,se.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-slate-400 mr-2"}),"App metadata and configuration"]}),(0,se.jsxs)("li",{className:"flex items-center",children:[(0,se.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-slate-400 mr-2"}),"Conversation history"]}),(0,se.jsxs)("li",{className:"flex items-center",children:[(0,se.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-slate-400 mr-2"}),"Git repository files (for sandbox apps)"]}),(0,se.jsxs)("li",{className:"flex items-center",children:[(0,se.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-slate-400 mr-2"}),"Secrets metadata (values not included)"]})]})]})]})]})}function FV(){const[e,t]=(0,Y.useState)(null),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)({}),o=(0,Y.useRef)(null),{mutate:c,isLoading:d}=eu({mutate:async()=>{if(!e)throw new Error("No file selected");const t=await RV.importApp(e,Object.keys(r).length>0?r:void 0);return t.success&&(a(t),l(null)),t},onError:e=>{var t,s,a;if(422===(null===(t=e.response)||void 0===t?void 0:t.status)){var n;const t=null===(n=e.response.data)||void 0===n?void 0:n.detail;if(t&&"object"==typeof t&&"requires_secrets"in t){const e=t;return void l({secrets:e.secrets_metadata,appName:e.app_name})}}let r="Unknown error";const i=null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail;if(null!=i)if(Array.isArray(i))r=i.map(e=>"object"==typeof e&&null!==e?e.msg||e.message||JSON.stringify(e):String(e)).join("; ");else if("object"==typeof i&&null!==i){const e=i;r=e.msg||e.message||JSON.stringify(i)}else r=String(i);else e.message&&(r=e.message);alert("Failed to import app: ".concat(r))}}),u=()=>{t(null),a(null),l(null),i({}),o.current&&(o.current.value="")};return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"text-center pb-4 border-b border-slate-200",children:[(0,se.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-orange-50 mb-3",children:(0,se.jsx)(PV.A,{className:"h-6 w-6 text-orange-600"})}),(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Import App"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm mt-1",children:"Import an app from an exported ZIP file"})]}),!s&&!n&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"border-2 border-dashed border-slate-300 rounded-lg p-8 text-center hover:border-slate-400 transition-colors",children:[(0,se.jsx)("input",{ref:o,type:"file",accept:".zip",onChange:e=>{var s;const n=null===(s=e.target.files)||void 0===s?void 0:s[0];n&&(t(n),a(null),l(null),i({}))},className:"hidden",id:"import-file"}),(0,se.jsxs)("label",{htmlFor:"import-file",className:"cursor-pointer",children:[(0,se.jsx)(LV.A,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),(0,se.jsx)("h4",{className:"text-base font-medium text-slate-900 mb-2",children:"Upload Export File"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Choose a .zip file exported from another environment"}),e?(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsx)("span",{className:"text-green-600 font-medium",children:e.name}),(0,se.jsxs)("span",{className:"text-slate-500 ml-2",children:["(",(e.size/1024).toFixed(1)," KB)"]})]}):(0,se.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.click()},className:"px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-lg transition-colors inline-flex items-center",children:[(0,se.jsx)(W_.A,{className:"h-4 w-4 mr-2"}),"Select File"]})]})]}),e&&(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsxs)("button",{onClick:()=>c(),disabled:d,className:"px-5 py-2 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",children:[d?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(W_.A,{className:"h-4 w-4 mr-2"}),"Import App"]}),(0,se.jsx)("button",{onClick:u,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium rounded-lg transition-colors",children:"Cancel"})]})]}),n&&(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"text-center pb-4 border-b border-slate-200",children:[(0,se.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:["Configure Secrets for ",n.appName]}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"This app requires the following secrets to be configured before import"})]}),(0,se.jsx)(Qp,{secretNames:n.secrets.map(e=>({name:e.name,description:e.description})),value:r,onChange:e=>{i(e)}}),(0,se.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[(0,se.jsxs)("button",{onClick:()=>c(),disabled:d,className:"px-5 py-2 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center",children:[d?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(W_.A,{className:"h-4 w-4 mr-2"}),"Import App"]}),(0,se.jsx)("button",{onClick:u,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium rounded-lg transition-colors",children:"Cancel"})]})]}),s&&(0,se.jsxs)("div",{className:"text-center py-6",children:[(0,se.jsx)(sd.A,{className:"h-14 w-14 text-green-500 mx-auto mb-4"}),(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"App Imported Successfully!"}),(0,se.jsx)("p",{className:"text-slate-600 mb-1",children:s.app_name}),(0,se.jsx)("code",{className:"bg-slate-100 px-3 py-1 rounded text-sm font-mono text-slate-700",children:s.app_id}),(0,se.jsxs)("div",{className:"mt-6 flex gap-3 justify-center",children:[(0,se.jsx)("a",{href:"/apps/".concat(s.app_id,"/editor/preview"),className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors",children:"Open App"}),(0,se.jsx)("button",{onClick:u,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium rounded-lg transition-colors",children:"Import Another App"})]})]})]})}function OV(){return(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsx)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(LV.A,{className:"h-5 w-5 text-slate-600"}),(0,se.jsx)("span",{className:"font-semibold text-slate-900",children:"Import / Export Apps"})]})}),(0,se.jsx)("div",{className:"p-6",children:(0,se.jsxs)(Kj,{defaultValue:"export",className:"w-full",children:[(0,se.jsxs)($j,{className:"grid w-full grid-cols-2 mb-6",children:[(0,se.jsxs)(Zj,{value:"export",className:"flex items-center gap-2",children:[(0,se.jsx)(IV.A,{className:"h-4 w-4"}),"Export"]}),(0,se.jsxs)(Zj,{value:"import",className:"flex items-center gap-2",children:[(0,se.jsx)(PV.A,{className:"h-4 w-4"}),"Import"]})]}),(0,se.jsx)(Jj,{value:"export",children:(0,se.jsx)(DV,{})}),(0,se.jsx)(Jj,{value:"import",children:(0,se.jsx)(FV,{})})]})})]})}var UV=s(15939),BV=s(92420),zV=s(95490);class HV extends te.H{getBaseURL(){return"/admin/github"}getRepoConnection(e){return this.axios.get("/app/".concat(e,"/connection"))}getOAuthStatus(e){return this.axios.get("/user/".concat(e,"/status"))}disconnectRepository(e){return this.axios.delete("/app/".concat(e,"/disconnect"))}retryWebhook(e){return this.axios.post("/app/".concat(e,"/retry-webhook"))}getCommitHistory(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,s=arguments.length>3?arguments[3]:void 0;const a=new URLSearchParams({skip:String(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),limit:String(t)});return s&&a.append("direction",s),this.axios.get("/app/".concat(e,"/commits?").concat(a.toString()))}retrySync(e,t){return this.axios.post("/app/".concat(e,"/sync/retry?direction=").concat(t))}getCheckpointComparison(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return this.axios.get("/app/".concat(e,"/checkpoint-comparison?limit=").concat(t))}}const VV=new HV;function WV(e){let{status:t,connected:s}=e;if(!s)return(0,se.jsxs)("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full bg-slate-100 text-slate-600 text-sm font-medium",children:[(0,se.jsx)(Uy.A,{className:"h-4 w-4 mr-1.5"}),"Not Connected"]});const a={active:{bg:"bg-green-100",text:"text-green-800",icon:(0,se.jsx)(sd.A,{className:"h-4 w-4 mr-1.5"})},disconnected:{bg:"bg-slate-100",text:"text-slate-600",icon:(0,se.jsx)(Uy.A,{className:"h-4 w-4 mr-1.5"})},revoked:{bg:"bg-orange-100",text:"text-orange-800",icon:(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-1.5"})},error:{bg:"bg-red-100",text:"text-red-800",icon:(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-1.5"})}},n=a[t||"active"]||a.active;return(0,se.jsxs)("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full ".concat(n.bg," ").concat(n.text," text-sm font-medium uppercase"),children:[n.icon,t||"Unknown"]})}function qV(e){let{label:t,value:s,mono:a=!1,link:n,children:l}=e;return(0,se.jsxs)("div",{className:"flex items-start justify-between py-2",children:[(0,se.jsx)("span",{className:"text-sm text-slate-500",children:t}),l||(n&&s?(0,se.jsxs)("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[s,(0,se.jsx)(Rj.A,{className:"h-3 w-3"})]}):(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900 ".concat(a?"font-mono":""),children:s||"-"}))]})}function YV(e){let{hash:t,className:s=""}=e;const[a,n]=(0,Y.useState)(!1),l=(0,Y.useCallback)(async()=>{if(t)try{await navigator.clipboard.writeText(t),n(!0),setTimeout(()=>n(!1),1500)}catch(e){}},[t]);return t?(0,se.jsx)("button",{onClick:l,className:"p-0.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded transition-colors ".concat(s),title:a?"Copied!":"Copy full hash: ".concat(t),children:a?(0,se.jsx)(sd.A,{className:"h-3 w-3 text-green-500"}):(0,se.jsx)(ob.A,{className:"h-3 w-3"})}):null}function GV(e){let{status:t}=e;const s={added:{icon:op.A,color:"text-green-600",bg:"bg-green-100"},modified:{icon:Zw.A,color:"text-blue-600",bg:"bg-blue-100"},deleted:{icon:GI.A,color:"text-red-600",bg:"bg-red-100"},renamed:{icon:Ws.A,color:"text-amber-600",bg:"bg-amber-100"}}[t]||{icon:Zw.A,color:"text-slate-600",bg:"bg-slate-100"},a=s.icon;return(0,se.jsx)("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded ".concat(s.bg),children:(0,se.jsx)(a,{className:"h-2.5 w-2.5 ".concat(s.color)})})}function KV(e){let{node:t,depth:s=0,expandedFolders:a,onToggleFolder:n}=e;const l=(0,Y.useMemo)(()=>Array.from(t.children.values()).sort((e,t)=>e.isFolder!==t.isFolder?e.isFolder?-1:1:e.name.localeCompare(t.name)),[t.children]);return(0,se.jsx)(se.Fragment,{children:l.map(e=>{const t=a.has(e.path);return(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"flex items-center gap-1.5 py-0.5 text-xs hover:bg-slate-50 rounded px-1 -mx-1 ".concat(e.isFolder?"cursor-pointer":""),style:{paddingLeft:"".concat(12*s,"px")},onClick:()=>e.isFolder&&n(e.path),children:e.isFolder?(0,se.jsxs)(se.Fragment,{children:[t?(0,se.jsx)(_t.A,{className:"h-3 w-3 text-slate-400"}):(0,se.jsx)(bs.A,{className:"h-3 w-3 text-slate-400"}),(0,se.jsx)(UV.A,{className:"h-3.5 w-3.5 text-slate-400"}),(0,se.jsx)("span",{className:"text-slate-600",children:e.name})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"w-3"}),(0,se.jsx)(GV,{status:e.status}),(0,se.jsx)("span",{className:"text-slate-700 font-mono",children:e.name}),e.previousPath&&(0,se.jsxs)("span",{className:"text-slate-400 text-[10px]",children:["\u2190 ",e.previousPath.split("/").pop()]})]})}),e.isFolder&&t&&(0,se.jsx)(KV,{node:e,depth:s+1,expandedFolders:a,onToggleFolder:n})]},e.path)})})}function $V(e){let{files:t}=e;const[s,a]=(0,Y.useState)(()=>{const e=new Set;return t.forEach(t=>{const s=t.path.split("/")[0];t.path.includes("/")&&e.add(s)}),e}),n=(0,Y.useMemo)(()=>function(e){const t={name:"",path:"",isFolder:!0,children:new Map};for(const s of e){const e=s.path.split("/");let a=t;for(let t=0;t<e.length;t++){const n=e[t],l=t===e.length-1,r=e.slice(0,t+1).join("/");a.children.has(n)||a.children.set(n,{name:n,path:r,isFolder:!l,status:l?s.status:void 0,previousPath:l?s.previous_path:void 0,children:new Map}),a=a.children.get(n)}}return t}(t),[t]),l=(0,Y.useCallback)(e=>{a(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),r=(0,Y.useMemo)(()=>{const e={added:0,modified:0,deleted:0,renamed:0};return t.forEach(t=>{t.status in e&&e[t.status]++}),e},[t]);return(0,se.jsxs)("div",{className:"mt-2 pl-4 border-l-2 border-slate-100",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-2 text-[10px]",children:[r.added>0&&(0,se.jsxs)("span",{className:"text-green-600",children:["+",r.added," added"]}),r.modified>0&&(0,se.jsxs)("span",{className:"text-blue-600",children:["~",r.modified," modified"]}),r.deleted>0&&(0,se.jsxs)("span",{className:"text-red-600",children:["-",r.deleted," deleted"]}),r.renamed>0&&(0,se.jsxs)("span",{className:"text-amber-600",children:["\u2192",r.renamed," renamed"]})]}),(0,se.jsx)("div",{className:"max-h-48 overflow-y-auto",children:(0,se.jsx)(KV,{node:n,expandedFolders:s,onToggleFolder:l})})]})}function ZV(e){let{lastSyncedCommit:t,appLastGitCommitHash:s,onRefresh:a,isLoading:n}=e;const l=t===s,r=e=>e?e.substring(0,7):"-";return(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,se.jsx)("div",{className:"rounded-lg border p-3 ".concat(l?"bg-green-50 border-green-200":"bg-amber-50 border-amber-200"),children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-5",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-0.5",children:"github_repository_connections"}),(0,se.jsx)("div",{className:"text-xs text-slate-500 mb-0.5",children:"last_synced_commit"}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)("code",{className:"text-sm font-mono font-medium text-slate-700",children:r(t)}),(0,se.jsx)(YV,{hash:t})]})]}),(0,se.jsx)("div",{className:"text-lg ".concat(l?"text-green-600":"text-amber-600"),children:l?"=":"\u2260"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-0.5",children:"user_generated_apps_v2"}),(0,se.jsx)("div",{className:"text-xs text-slate-500 mb-0.5",children:"last_git_commit_hash"}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)("code",{className:"text-sm font-mono font-medium text-slate-700",children:r(s)}),(0,se.jsx)(YV,{hash:s})]})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"text-sm font-medium ".concat(l?"text-green-700":"text-amber-700"),children:l?(0,se.jsxs)("span",{className:"flex items-center gap-1",children:[(0,se.jsx)(sd.A,{className:"h-4 w-4"}),"Synced"]}):(0,se.jsxs)("span",{className:"flex items-center gap-1",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),"Out of Sync"]})}),a&&(0,se.jsx)("button",{onClick:a,disabled:n,className:"p-1 rounded transition-colors ".concat(l?"text-green-600 hover:bg-green-100":"text-amber-600 hover:bg-amber-100"," disabled:opacity-50"),title:"Refresh sync status",children:(0,se.jsx)(Fx.A,{className:"h-4 w-4 ".concat(n?"animate-spin":"")})})]})]})}),(0,se.jsx)("div",{})]})}function JV(e){let{appId:t,repoConnected:s}=e;const[a,n]=(0,Y.useState)(null),l=(0,Y.useRef)(null),r=(0,Y.useRef)(null),i=(0,Y.useRef)(!1),{isLoading:o,refetch:c}=Xd({query:async()=>{const e=await VV.getCheckpointComparison(t,100);return n(e),e},enabled:s},[t,s]),d=(0,Y.useCallback)(()=>{i.current||(i.current=!0,l.current&&r.current&&(r.current.scrollTop=l.current.scrollTop),requestAnimationFrame(()=>{i.current=!1}))},[]),u=(0,Y.useCallback)(()=>{i.current||(i.current=!0,l.current&&r.current&&(l.current.scrollTop=r.current.scrollTop),requestAnimationFrame(()=>{i.current=!1}))},[]);if(!s)return null;const m=(null==a?void 0:a.rows)||[];return(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"px-4 py-3 border-b border-slate-200 bg-slate-50 flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"font-semibold text-slate-900 text-sm",children:"Sync History"}),(0,se.jsx)("span",{className:"text-xs text-slate-400 font-mono",children:"github_sync_logs"}),(0,se.jsxs)("span",{className:"text-xs text-slate-400",children:["\xb7 ",(null==a?void 0:a.total_sync_logs)||0," entries"]})]}),(0,se.jsx)("button",{onClick:()=>c(),disabled:o,className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded transition-colors disabled:opacity-50",children:(0,se.jsx)(Fx.A,{className:"h-3.5 w-3.5 ".concat(o?"animate-spin":"")})})]}),(0,se.jsx)("div",{ref:l,onScroll:d,className:"divide-y divide-slate-100 max-h-[960px] overflow-y-auto",children:o?(0,se.jsxs)("div",{className:"flex items-center justify-center py-8 text-slate-400 text-xs",children:[(0,se.jsx)(Ac.A,{className:"h-3.5 w-3.5 animate-spin mr-2"}),"Loading..."]}):0===m.length?(0,se.jsx)("div",{className:"text-center py-8 text-slate-400 text-xs",children:"No data"}):m.map(e=>(0,se.jsx)(QV,{syncLog:e.sync_log,shortHash:e.short_hash,fullHash:e.commit_hash},e.commit_hash))})]}),(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"px-4 py-3 border-b border-slate-200 bg-slate-50 flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"font-semibold text-slate-900 text-sm",children:"Checkpoint History"}),(0,se.jsx)("span",{className:"text-xs text-slate-400 font-mono",children:"user_app_checkpoints"}),(0,se.jsxs)("span",{className:"text-xs text-slate-400",children:["\xb7 ",(null==a?void 0:a.total_checkpoints)||0," checkpoints"]})]}),(0,se.jsx)("button",{onClick:()=>c(),disabled:o,className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded transition-colors disabled:opacity-50",children:(0,se.jsx)(Fx.A,{className:"h-3.5 w-3.5 ".concat(o?"animate-spin":"")})})]}),(0,se.jsx)("div",{ref:r,onScroll:u,className:"divide-y divide-slate-100 max-h-[960px] overflow-y-auto",children:o?(0,se.jsxs)("div",{className:"flex items-center justify-center py-8 text-slate-400 text-xs",children:[(0,se.jsx)(Ac.A,{className:"h-3.5 w-3.5 animate-spin mr-2"}),"Loading..."]}):0===m.length?(0,se.jsx)("div",{className:"text-center py-8 text-slate-400 text-xs",children:"No data"}):m.map(e=>(0,se.jsx)(XV,{checkpoint:e.checkpoint,shortHash:e.short_hash,fullHash:e.commit_hash},e.commit_hash))})]})]})}function QV(e){let{syncLog:t,shortHash:s,fullHash:a}=e;const[n,l]=(0,Y.useState)(!1),r="failed"===(null==t?void 0:t.sync_status),i="base44_to_github"===(null==t?void 0:t.sync_direction),o=(null==t?void 0:t.changed_files)&&t.changed_files.length>0;return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"h-[44px] px-4 flex items-center gap-2 hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>o&&l(!n),children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-4",children:o?n?(0,se.jsx)(_t.A,{className:"h-3.5 w-3.5 text-slate-400"}):(0,se.jsx)(bs.A,{className:"h-3.5 w-3.5 text-slate-400"}):null}),(0,se.jsxs)("div",{className:"flex items-center gap-0.5 flex-shrink-0",onClick:e=>e.stopPropagation(),children:[(0,se.jsx)("code",{className:"font-mono text-xs ".concat(t?"text-slate-600":"text-slate-300"),children:(null==t?void 0:t.short_hash)||s}),(0,se.jsx)(YV,{hash:(null==t?void 0:t.commit_hash)||a,className:t?"":"opacity-50"})]}),t?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded flex-shrink-0 w-9 text-center ".concat(i?"bg-orange-100 text-orange-700":"bg-teal-100 text-teal-700"),children:i?"Push":"Pull"}),r?(0,se.jsx)(Uy.A,{className:"h-3 w-3 text-red-500 flex-shrink-0"}):(0,se.jsx)(sd.A,{className:"h-3 w-3 text-green-500 flex-shrink-0"}),(0,se.jsx)("span",{className:"text-xs text-slate-700 truncate flex-1 min-w-0",title:t.commit_message,children:t.commit_message||"\u2014"}),(0,se.jsx)("span",{className:"text-[10px] text-slate-400 tabular-nums flex-shrink-0 w-12",children:o?"".concat(t.changed_files.length," file").concat(1!==t.changed_files.length?"s":""):""}),(0,se.jsx)("span",{className:"text-[10px] text-slate-400 flex-shrink-0 w-20",children:t.relative_time}),(0,se.jsx)("div",{className:"flex items-center gap-1 flex-shrink-0 text-[10px] text-slate-400 w-24",children:t.commit_author&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ay.A,{className:"h-2.5 w-2.5"}),(0,se.jsx)("span",{className:"truncate",title:t.commit_author,children:t.commit_author.split("@")[0]})]})})]}):(0,se.jsx)("span",{className:"text-slate-300 text-sm",children:"\u2014"})]}),n&&o&&(0,se.jsx)("div",{className:"px-4 pb-3",onClick:e=>e.stopPropagation(),children:(0,se.jsx)($V,{files:t.changed_files})})]})}function XV(e){let{checkpoint:t,shortHash:s,fullHash:a}=e;return(0,se.jsx)("div",{children:(0,se.jsxs)("div",{className:"h-[44px] px-4 flex items-center gap-2 hover:bg-slate-50 transition-colors",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-4"}),(0,se.jsxs)("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[(0,se.jsx)("code",{className:"font-mono text-xs ".concat(t?"text-slate-600":"text-slate-300"),children:(null==t?void 0:t.short_hash)||s}),(0,se.jsx)(YV,{hash:(null==t?void 0:t.git_commit_hash)||a,className:t?"":"opacity-50"})]}),t?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"text-xs text-slate-800 truncate flex-1 min-w-0",title:t.name,children:t.name}),(0,se.jsx)("span",{className:"text-[10px] text-slate-400 flex-shrink-0",children:t.relative_time})]}):(0,se.jsx)("span",{className:"text-slate-300 text-sm",children:"\u2014"})]})})}function eW(){const[e,t]=(0,Y.useState)(""),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(null),{mutate:m,isLoading:x}=eu({mutate:async e=>{c(null),l(null),u(null);const t=await VV.getRepoConnection(e);return a(t),t.connected_by_user_id&&await h(t.connected_by_user_id),t},onError:e=>{var t,s;c((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Failed to fetch GitHub connection"),a(null),l(null)}}),{mutate:h,isLoading:p}=eu({mutate:async e=>{u(null);const t=await VV.getOAuthStatus(e);return l(t),t},onError:e=>{var t,s;u((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Failed to fetch OAuth status")}}),{mutate:g,isLoading:f}=eu({mutate:async e=>{if(!window.confirm("Are you sure you want to disconnect the GitHub repository for app ".concat(e,"? This action cannot be undone.")))throw new Error("User cancelled");const t=await VV.disconnectRepository(e);return await m(e),t.success?alert("Repository disconnected successfully"):alert("Failed to disconnect: ".concat(t.message||"Unknown error")),t},onError:e=>{var t,s;"User cancelled"!==e.message&&alert("Failed to disconnect: ".concat((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message))}}),{mutate:v,isLoading:b}=eu({mutate:async e=>{const t=await VV.retryWebhook(e);return await m(e),t.success?alert("Webhook registered successfully"):alert("Webhook registration failed: ".concat(t.message)),t},onError:e=>{var t,s;alert("Failed to retry webhook: ".concat((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message))}}),j=()=>{const t=e.trim();t&&m(t)},y=()=>{null!=s&&s.app_id&&m(s.app_id)},N=x||p;return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsxs)("div",{className:"flex items-center mb-4",children:[(0,se.jsx)(dh.A,{className:"h-7 w-7 text-slate-800 mr-3"}),(0,se.jsx)("h2",{className:"text-2xl font-bold",children:"GitHub Integration"})]}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:"Search for an app to view and manage its GitHub connection"})]}),(0,se.jsx)("div",{className:"mb-6",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-slate-500"}),(0,se.jsx)(Df,{placeholder:"Enter App ID...",className:"pl-9",value:e,onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"===e.key&&j()}})]}),(0,se.jsx)(Bx,{onClick:j,disabled:N||!e.trim(),className:"bg-slate-900 hover:bg-slate-800 text-white",children:x?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(na.A,{className:"h-4 w-4 mr-2"}),"Search"]})})]})}),o&&(0,se.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-red-500 mr-3 mt-0.5 flex-shrink-0"}),(0,se.jsx)("div",{className:"text-sm text-red-700",children:o})]}),s&&(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(yV.A,{className:"h-5 w-5 text-slate-600"}),(0,se.jsx)("span",{className:"font-semibold text-slate-900",children:"App Details"})]}),(0,se.jsx)("button",{onClick:y,disabled:N,className:"p-2 text-slate-600 hover:bg-slate-200 rounded-lg transition-colors disabled:opacity-50",title:"Refresh Status",children:(0,se.jsx)(Fx.A,{className:"h-4 w-4 ".concat(N?"animate-spin":"")})})]}),(0,se.jsx)("div",{className:"p-6",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[(0,se.jsx)(qV,{label:"App ID",value:s.app_id,mono:!0}),(0,se.jsx)(qV,{label:"App Name",value:s.app_name}),(0,se.jsx)(qV,{label:"Owner ID",value:s.owner_id,mono:!0}),(0,se.jsx)(qV,{label:"Owner Email",value:s.owner_email})]})})]}),(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex items-center gap-3",children:[(0,se.jsx)(BV.A,{className:"h-5 w-5 text-slate-600"}),(0,se.jsx)("span",{className:"font-semibold text-slate-900",children:"Repository Connection"})]}),(0,se.jsxs)("div",{className:"p-6",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[(0,se.jsx)(qV,{label:"Connection Status",children:(0,se.jsx)(WV,{status:s.repo_status,connected:s.repo_connected})}),(0,se.jsx)(qV,{label:"Repository",value:s.repo_full_name,link:s.repo_url}),(0,se.jsx)(qV,{label:"Organization",value:s.repo_org_name}),(0,se.jsx)(qV,{label:"Installation ID",value:s.repo_installation_id,mono:!0}),(0,se.jsx)(qV,{label:"Connected By User ID",value:s.connected_by_user_id,mono:!0}),(0,se.jsx)(qV,{label:"Webhook Active",children:s.webhook_active?(0,se.jsxs)("span",{className:"inline-flex items-center text-sm text-green-700",children:[(0,se.jsx)(sd.A,{className:"h-4 w-4 mr-1"}),"Active"]}):(0,se.jsxs)("span",{className:"inline-flex items-center text-sm text-slate-500",children:[(0,se.jsx)(Uy.A,{className:"h-4 w-4 mr-1"}),"Inactive"]})}),(0,se.jsx)(qV,{label:"Last Synced Commit",children:s.last_synced_commit?(0,se.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900 font-mono",children:(w=s.last_synced_commit,w?w.substring(0,7):"-")}),(0,se.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(s.last_synced_commit||""),i(!0),setTimeout(()=>i(!1),2e3)},className:"p-1 rounded transition-colors ".concat(r?"text-green-600":"text-slate-400 hover:text-slate-600 hover:bg-slate-100"),title:"Copy full commit hash",children:r?(0,se.jsx)(sd.A,{className:"h-3.5 w-3.5"}):(0,se.jsx)(ob.A,{className:"h-3.5 w-3.5"})})]}):(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"-"})}),(0,se.jsx)(qV,{label:"Last Synced At",value:(e=>{if(!e)return"-";try{return new Date(e).toLocaleString()}catch(t){return e}})(s.last_sync_at)})]}),s.repo_connected&&(0,se.jsxs)("div",{className:"mt-6 pt-4 border-t border-slate-200 flex justify-between items-center",children:[(0,se.jsx)("div",{children:!s.webhook_active&&(0,se.jsxs)(Bx,{onClick:()=>v(s.app_id),disabled:b||f,variant:"outline",className:"border-orange-300 text-orange-700 hover:bg-orange-50",children:[b?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(zV.A,{className:"h-4 w-4 mr-2"}),"Retry Webhook"]})}),(0,se.jsxs)(Bx,{onClick:()=>g(s.app_id),disabled:f||b,variant:"destructive",className:"bg-red-600 hover:bg-red-700",children:[f?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(Mj.A,{className:"h-4 w-4 mr-2"}),"Disconnect Repository"]})]})]})]}),(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex items-center gap-3",children:[(0,se.jsx)(ay.A,{className:"h-5 w-5 text-slate-600"}),(0,se.jsx)("span",{className:"font-semibold text-slate-900",children:"User OAuth Status"}),p&&(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-slate-400"})]}),(0,se.jsx)("div",{className:"p-6",children:n?(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[(0,se.jsx)(qV,{label:"OAuth Status",children:(0,se.jsx)(WV,{status:n.oauth_status,connected:n.oauth_connected})}),(0,se.jsx)(qV,{label:"GitHub Username",children:n.github_username?(0,se.jsxs)("span",{className:"inline-flex items-center text-sm font-medium text-slate-900",children:[(0,se.jsx)(dh.A,{className:"h-4 w-4 mr-1.5 text-slate-500"}),n.github_username]}):(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"-"})})]}):p?(0,se.jsxs)("div",{className:"flex items-center text-sm text-slate-500",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading OAuth status..."]}):d?(0,se.jsxs)("div",{className:"flex items-start text-sm text-red-600",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("span",{children:["Failed to load OAuth status: ",d]})]}):(0,se.jsx)("div",{className:"text-sm text-slate-500",children:s.connected_by_user_id?"No OAuth data found":"No connected user information available"})}),(0,se.jsx)("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200",children:(0,se.jsxs)("p",{className:"text-xs text-slate-500 leading-relaxed",children:[(0,se.jsx)("span",{className:"font-medium text-slate-600",children:"Important note"})," \u2014 This section displays the OAuth status of the user who connected the repository, which may differ from the app owner."]})})]}),s.repo_connected&&(0,se.jsx)(ZV,{lastSyncedCommit:s.last_synced_commit,appLastGitCommitHash:s.app_last_git_commit_hash,onRefresh:y,isLoading:N}),(0,se.jsx)(JV,{appId:s.app_id,repoConnected:s.repo_connected})]}),!s&&!o&&(0,se.jsxs)("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-12 text-center",children:[(0,se.jsx)(na.A,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Search for an App"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Enter an App ID above to view and manage its GitHub connection"})]})]});var w}var tW=s(52431);let sW=function(e){return e.SUCCESS="success",e.FAILED="failed",e.INVALID_URL="invalid_url",e}({});class aW extends te.H{getBaseURL(){return"/admin/files"}batchDeleteSupabaseFiles(e){return this.axios.post("/supabase/delete",{urls:e})}deleteSingleSupabaseFile(e){return this.axios.delete("/supabase/file",{params:{url:e}})}}const nW=new aW;function lW(){const[e,t]=(0,Y.useState)(""),[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)({total:0,processed:0,successful:0,failed:0,results:[],isComplete:!1}),d=(0,Y.useRef)(null),u=(0,Y.useCallback)(e=>e.split(/[\n,]/).map(e=>e.trim()).filter(e=>e.length>0),[])(e),m=u.length>0,x=()=>{l(!1),o.isComplete&&(t(""),c({total:0,processed:0,successful:0,failed:0,results:[],isComplete:!1}))},h=o.total>0?Math.round(o.processed/o.total*100):0;return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Supabase URLs or File URIs"}),(0,se.jsx)(tN,{placeholder:"Paste file URLs here (one per line or comma-separated)...\n\nSupported formats:\n\u2022 https://base44.app/api/apps/{app_id}/files/{file_uri}\n\u2022 https://....supabase.co/storage/v1/object/public/bucket/...\n\u2022 public/{app_id}/{file_uri}",className:"min-h-[160px] font-mono text-sm",value:e,onChange:e=>t(e.target.value)}),(0,se.jsxs)("div",{className:"mt-2 flex items-center justify-between text-sm text-slate-500",children:[(0,se.jsx)("span",{children:u.length>0?(0,se.jsxs)("span",{className:"flex items-center gap-1",children:[(0,se.jsx)(xb.A,{className:"h-4 w-4"}),u.length," file",1!==u.length?"s":""," to delete"]}):"No files entered"}),u.length>1e3&&(0,se.jsxs)("span",{className:"text-red-500 flex items-center gap-1",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4"}),"Maximum 1000 files per batch"]})]})]}),(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsxs)(Bx,{onClick:()=>{m&&a(!0)},disabled:!m||u.length>1e3,variant:"destructive",className:"flex items-center gap-2",children:[(0,se.jsx)(zy.A,{className:"h-4 w-4"}),"Delete ",u.length>0?"".concat(u.length," Files"):"Files"]}),e&&(0,se.jsx)(Bx,{onClick:()=>t(""),variant:"outline",children:"Clear"})]}),(0,se.jsxs)("div",{className:"mt-4 p-3 bg-emerald-50 border border-emerald-200 rounded-lg",children:[(0,se.jsx)("h4",{className:"text-xs font-semibold text-emerald-800 mb-1",children:"Supported formats:"}),(0,se.jsxs)("div",{className:"text-xs text-emerald-700 space-y-0.5",children:[(0,se.jsxs)("div",{children:["\u2022 Base44 URLs: ",(0,se.jsxs)("code",{className:"bg-emerald-100 px-1 rounded",children:["https://base44.app/api/apps/","{app_id}","/files/","{file}"]})]}),(0,se.jsxs)("div",{children:["\u2022 Direct Supabase URLs: ",(0,se.jsx)("code",{className:"bg-emerald-100 px-1 rounded",children:"https://....supabase.co/storage/v1/object/public/..."})]}),(0,se.jsxs)("div",{children:["\u2022 File URIs: ",(0,se.jsx)("code",{className:"bg-emerald-100 px-1 rounded",children:"public/app_id/file.jpg"})]})]})]}),(0,se.jsx)(NN,{open:s,onOpenChange:a,children:(0,se.jsxs)(kN,{children:[(0,se.jsxs)(CN,{children:[(0,se.jsxs)(SN,{className:"flex items-center gap-2 text-red-600",children:[(0,se.jsx)(Ap.A,{className:"h-5 w-5"}),"Confirm File Deletion"]}),(0,se.jsxs)(EN,{className:"text-slate-600",children:["You are about to permanently delete ",(0,se.jsxs)("span",{className:"font-semibold text-slate-900",children:[u.length," file",1!==u.length?"s":""]})," from Supabase storage.",(0,se.jsx)("br",{}),(0,se.jsx)("br",{}),(0,se.jsx)("span",{className:"text-red-600 font-medium",children:"This action cannot be undone."})]})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{children:"Cancel"}),(0,se.jsx)(TN,{onClick:async()=>{a(!1),l(!0),i(!0),c({total:u.length,processed:0,successful:0,failed:0,results:[],isComplete:!1}),d.current=new AbortController;try{const s=50,a=[];for(let e=0;e<u.length;e+=s)a.push(u.slice(e,e+s));const n=u.length;for(const l of a){var e;if(null!==(e=d.current)&&void 0!==e&&e.signal.aborted)break;try{const e=await nW.batchDeleteSupabaseFiles(l);c(t=>({total:n,processed:t.processed+e.results.length,successful:t.successful+e.successful,failed:t.failed+e.failed,results:[...t.results,...e.results],isComplete:!1}))}catch(t){const e=l.map(e=>({url:e,file_uri:"",status:sW.FAILED,error:t instanceof Error?t.message:"Batch request failed"}));c(t=>({total:n,processed:t.processed+e.length,successful:t.successful,failed:t.failed+l.length,results:[...t.results,...e],isComplete:!1}))}}c(e=>(0,ue.A)((0,ue.A)({},e),{},{isComplete:!0}))}catch(t){}finally{i(!1)}},className:"bg-red-600 hover:bg-red-700",children:"Delete Files"})]})]})}),(0,se.jsx)(Og,{open:n,onOpenChange:e=>{e||r||x()},children:(0,se.jsxs)(Hg,{className:"sm:max-w-[600px] max-w-[95vw] overflow-hidden",showClose:!r,children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{className:"flex items-center gap-2",children:r?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-5 w-5 animate-spin text-emerald-600"}),"Deleting Files..."]}):o.isComplete?o.failed>0?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Uy.A,{className:"h-5 w-5 text-red-600"}),"Deletion Complete with Errors"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(hb.A,{className:"h-5 w-5 text-green-600"}),"Deletion Complete"]}):"File Deletion"}),(0,se.jsx)(Yg,{children:r?"Please wait while files are being deleted from Supabase...":"Processed ".concat(o.total," files")})]}),(0,se.jsxs)("div",{className:"py-4 overflow-hidden",children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsxs)("div",{className:"flex justify-between text-sm text-slate-600 mb-2",children:[(0,se.jsx)("span",{children:"Progress"}),(0,se.jsxs)("span",{children:[o.processed," / ",o.total]})]}),(0,se.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-200",children:(0,se.jsx)("div",{className:"h-full bg-emerald-500 transition-all duration-300",style:{width:"".concat(h,"%")}})})]}),(0,se.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3 text-center",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:o.total}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"Total"})]}),(0,se.jsxs)("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-green-600",children:o.successful}),(0,se.jsx)("div",{className:"text-xs text-green-600",children:"Successful"})]}),(0,se.jsxs)("div",{className:"bg-red-50 rounded-lg p-3 text-center",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-red-600",children:o.failed}),(0,se.jsx)("div",{className:"text-xs text-red-600",children:"Failed"})]})]}),o.results.length>0&&(0,se.jsxs)("div",{className:"border rounded-lg max-h-[300px] overflow-y-auto overflow-x-hidden",children:[(0,se.jsx)("div",{className:"divide-y divide-slate-100",children:o.results.slice(-50).reverse().map((e,t)=>(0,se.jsxs)("div",{className:"p-2 text-sm flex items-start gap-2 overflow-hidden ".concat(e.status===sW.SUCCESS?"bg-green-50/50":"bg-red-50/50"),children:[e.status===sW.SUCCESS?(0,se.jsx)(hb.A,{className:"h-4 w-4 text-green-600 flex-shrink-0 mt-0.5"}):(0,se.jsx)(Uy.A,{className:"h-4 w-4 text-red-600 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"min-w-0 flex-1 overflow-hidden",children:[(0,se.jsx)("div",{className:"font-mono text-xs text-slate-700 truncate",title:e.url,children:e.url}),e.error&&(0,se.jsx)("div",{className:"text-xs text-red-600 mt-0.5 break-words",children:e.error})]})]},t))}),o.results.length>50&&(0,se.jsx)("div",{className:"p-2 text-xs text-center text-slate-500 bg-slate-50 border-t",children:"Showing last 50 results. Export for full report."})]})]}),o.isComplete&&(0,se.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,se.jsxs)(Bx,{onClick:()=>{const e=e=>e.includes(",")||e.includes('"')||e.includes("\n")?'"'.concat(e.replace(/"/g,'""'),'"'):e,t=["Status,URL,File URI,Error"];for(const r of o.results){const s=r.status===sW.SUCCESS?"success":"failed",a=r.error||"";t.push([e(s),e(r.url),e(r.file_uri),e(a)].join(","))}const s=t.join("\n"),a=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(a),l=document.createElement("a");l.href=n,l.download="supabase-deletion-report-".concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n)},variant:"outline",className:"flex items-center gap-2",children:[(0,se.jsx)(aL.A,{className:"h-4 w-4"}),"Export Report"]}),(0,se.jsx)(Bx,{onClick:x,children:"Done"})]})]})})]})}function rW(e){let{title:t,description:s,icon:a,children:n,defaultExpanded:l=!1}=e;const[r,i]=(0,Y.useState)(l);return(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("button",{onClick:()=>i(!r),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("div",{className:"p-2 bg-slate-100 rounded-lg",children:a}),(0,se.jsxs)("div",{className:"text-left",children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-900",children:t}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:s})]})]}),r?(0,se.jsx)(_t.A,{className:"h-5 w-5 text-slate-400"}):(0,se.jsx)(bs.A,{className:"h-5 w-5 text-slate-400"})]}),r&&(0,se.jsx)("div",{className:"px-6 pb-6 border-t border-slate-100",children:(0,se.jsx)("div",{className:"pt-4",children:n})})]})}function iW(){return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsxs)("div",{className:"flex items-center mb-4",children:[(0,se.jsx)(tW.A,{className:"h-7 w-7 text-orange-600 mr-3"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Asset Management"})]}),(0,se.jsx)("p",{className:"text-slate-600",children:"Manage assets across different storage providers. Use these tools to batch delete files for support operations."})]}),(0,se.jsx)("div",{className:"space-y-4",children:(0,se.jsx)(rW,{title:"Supabase Storage",description:"Delete files from Supabase storage buckets",icon:(0,se.jsx)(oy.A,{className:"h-5 w-5 text-emerald-600"}),defaultExpanded:!0,children:(0,se.jsx)(lW,{})})}),(0,se.jsxs)("div",{className:"mt-6 p-4 bg-slate-50 border border-slate-200 rounded-lg",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-700 mb-2",children:"General Guidelines:"}),(0,se.jsxs)("div",{className:"text-sm text-slate-600 space-y-1",children:[(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,se.jsx)("span",{children:"Always verify the files before deletion - this action cannot be undone"})]}),(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,se.jsx)("span",{children:"Export deletion reports for audit purposes"})]}),(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,se.jsx)("span",{children:"Contact engineering if you need to delete more than 1000 files at once"})]})]})]})]})}class oW extends te.H{getBaseURL(){return"/admin/restore-app"}async listCheckpoints(e){return await this.axios.get("/".concat(e,"/checkpoints"))}async previewRestore(e,t){return await this.axios.post("/".concat(e,"/preview"),t||{})}async restoreApp(e,t){return await this.axios.post("/".concat(e,"/restore"),t||{})}}const cW=new oW;function dW(){const[e,t]=(0,Y.useState)("input"),[s,a]=(0,Y.useState)(""),[n,l]=(0,Y.useState)([]),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!0),[h,p]=(0,Y.useState)(!0),g=e=>{var t,s;const a=null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail;return a?"string"==typeof a?a:JSON.stringify(a):e.message||"Unknown error"},{mutate:f,isLoading:v}=eu({mutate:async()=>{const e=await cW.listCheckpoints(s.trim());l(e.checkpoints),e.checkpoints.length>0?(i(e.checkpoints[0]),t("checkpoints")):alert("No checkpoints found for this app.")},onError:e=>{alert("Failed to fetch checkpoints: ".concat(g(e)))}}),{mutate:b,isLoading:j}=eu({mutate:async()=>{const e=await cW.previewRestore(s.trim(),{checkpoint_id:null==r?void 0:r.id,restore_conversation:m,undelete_entities:h});c(e),t("preview")},onError:e=>{alert("Failed to preview restore: ".concat(g(e)))}}),{mutate:y,isLoading:N}=eu({mutate:async()=>{const e=await cW.restoreApp(s.trim(),{checkpoint_id:null==r?void 0:r.id,restore_conversation:m,undelete_entities:h});u(e),e.success?t("success"):alert("Restore failed: ".concat(e.error))},onError:e=>{alert("Failed to restore app: ".concat(g(e)))}}),w=()=>{t("input"),a(""),l([]),i(null),c(null),u(null),x(!0),p(!0)},_=e=>e?new Date(e).toLocaleString():"N/A";return(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",children:[(0,se.jsx)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Yb.A,{className:"h-5 w-5 text-slate-600"}),(0,se.jsx)("span",{className:"font-semibold text-slate-900",children:"Restore Deleted App"})]})}),(0,se.jsxs)("div",{className:"p-6",children:["input"===e&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("p",{className:"text-slate-600",children:"Enter the App ID of a deleted app to restore it from a checkpoint."}),(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsx)("input",{type:"text",value:s,onChange:e=>a(e.target.value),placeholder:"Enter App ID (e.g., 6789abc123def456...)",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,se.jsxs)("button",{onClick:()=>f(),disabled:!s.trim()||v,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[v?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(na.A,{className:"h-4 w-4"}),"Find Checkpoints"]})]})]}),"checkpoints"===e&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900",children:"Select a Checkpoint"}),(0,se.jsx)("button",{onClick:()=>t("input"),className:"text-sm text-slate-500 hover:text-slate-700",children:"Change App ID"})]}),(0,se.jsxs)("p",{className:"text-slate-600 text-sm",children:["Found ",n.length," checkpoint(s) for app ",(0,se.jsx)("code",{className:"bg-slate-100 px-1 rounded",children:s})]}),(0,se.jsx)("div",{className:"border border-slate-200 rounded-lg overflow-hidden max-h-64 overflow-y-auto",children:n.map((e,t)=>(0,se.jsxs)("div",{onClick:()=>i(e),className:"flex items-center gap-4 p-3 cursor-pointer border-b border-slate-100 last:border-b-0 ".concat((null==r?void 0:r.id)===e.id?"bg-blue-50 border-l-4 border-l-blue-500":"hover:bg-slate-50"),children:[(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"font-medium text-slate-900",children:e.name||"Untitled"}),0===t&&(0,se.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Latest"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-4 text-sm text-slate-500 mt-1",children:[(0,se.jsxs)("span",{className:"flex items-center gap-1",children:[(0,se.jsx)(jS.A,{className:"h-3 w-3"}),_(e.created_date)]}),e.git_commit_hash&&(0,se.jsx)("span",{className:"font-mono text-xs",children:e.git_commit_hash.substring(0,8)})]})]}),(null==r?void 0:r.id)===e.id&&(0,se.jsx)(sd.A,{className:"h-5 w-5 text-blue-500"})]},e.id))}),(0,se.jsxs)("div",{className:"space-y-3 pt-4 border-t border-slate-200",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900",children:"Restore Options"}),(0,se.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,se.jsx)("input",{type:"checkbox",checked:m,onChange:e=>x(e.target.checked),className:"w-4 h-4 text-blue-600 rounded border-slate-300 focus:ring-blue-500"}),(0,se.jsx)("span",{className:"text-slate-700",children:"Restore conversation history link"})]}),(0,se.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,se.jsx)("input",{type:"checkbox",checked:h,onChange:e=>p(e.target.checked),className:"w-4 h-4 text-blue-600 rounded border-slate-300 focus:ring-blue-500"}),(0,se.jsx)("span",{className:"text-slate-700",children:"Undelete entities (deleted with the app)"})]})]}),(0,se.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,se.jsxs)("button",{onClick:()=>b(),disabled:!r||j,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[j?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(Ws.A,{className:"h-4 w-4"}),"Preview Restore"]}),(0,se.jsx)("button",{onClick:w,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium rounded-lg transition-colors",children:"Cancel"})]})]}),"preview"===e&&o&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900",children:"Restore Preview"}),(0,se.jsx)("button",{onClick:()=>t("checkpoints"),className:"text-sm text-slate-500 hover:text-slate-700",children:"Back to checkpoints"})]}),o.can_restore?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start gap-3",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-amber-500 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-amber-800",children:"Confirm Restoration"}),(0,se.jsx)("p",{className:"text-amber-700 text-sm",children:"This will insert a new app document into the database with the original ID. Make sure you have verified this is the correct app to restore."})]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsxs)("h4",{className:"font-medium text-slate-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)(jS.A,{className:"h-4 w-4"}),"Checkpoint"]}),(0,se.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Name"}),(0,se.jsx)("dd",{className:"text-slate-900",children:o.checkpoint_name||"Untitled"})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Date"}),(0,se.jsx)("dd",{className:"text-slate-900",children:_(o.checkpoint_date)})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"ID"}),(0,se.jsx)("dd",{className:"text-slate-900 font-mono text-xs",children:o.checkpoint_id})]})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsxs)("h4",{className:"font-medium text-slate-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)(xb.A,{className:"h-4 w-4"}),"App Content"]}),(0,se.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Name"}),(0,se.jsx)("dd",{className:"text-slate-900",children:o.app_name||"Unknown"})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Pages"}),(0,se.jsx)("dd",{className:"text-slate-900",children:o.pages_count})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Components"}),(0,se.jsx)("dd",{className:"text-slate-900",children:o.components_count})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Entities"}),(0,se.jsx)("dd",{className:"text-slate-900",children:o.entities_count})]})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsxs)("h4",{className:"font-medium text-slate-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)(oy.A,{className:"h-4 w-4"}),"Metadata"]}),(0,se.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Created by"}),(0,se.jsx)("dd",{className:"text-slate-900",children:o.created_by||"Unknown"})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Organization"}),(0,se.jsx)("dd",{className:"text-slate-900 font-mono text-xs",children:o.organization_id||"Unknown"})]})]})]}),m&&(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsxs)("h4",{className:"font-medium text-slate-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)(Xx.A,{className:"h-4 w-4"}),"Conversation"]}),(0,se.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Messages"}),(0,se.jsx)("dd",{className:"text-slate-900",children:o.conversation_messages_count})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"ID"}),(0,se.jsx)("dd",{className:"text-slate-900 font-mono text-xs",children:o.conversation_id||"None found"})]})]})]})]}),h&&o.entities_to_undelete.length>0&&(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsxs)("h4",{className:"font-medium text-slate-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)(zy.A,{className:"h-4 w-4"}),"Entities to Undelete (",o.entities_to_undelete.length,")"]}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(o.entities_to_undelete.reduce((e,t)=>(e[t.entity_type]=(e[t.entity_type]||0)+1,e),{})).map(e=>{let[t,s]=e;return(0,se.jsxs)("span",{className:"bg-slate-200 text-slate-700 px-2 py-1 rounded text-sm",children:[t,": ",s]},t)})})]})]}):(0,se.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-red-500 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-red-800",children:"Cannot Restore"}),(0,se.jsx)("p",{className:"text-red-700 text-sm",children:o.error})]})]}),(0,se.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[o.can_restore&&(0,se.jsxs)("button",{onClick:()=>y(),disabled:N,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[N?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(Yb.A,{className:"h-4 w-4"}),"Restore App"]}),(0,se.jsx)("button",{onClick:w,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium rounded-lg transition-colors",children:"Cancel"})]})]}),"success"===e&&d&&(0,se.jsxs)("div",{className:"text-center py-8",children:[(0,se.jsx)(sd.A,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,se.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"App Restored Successfully!"}),(0,se.jsx)("p",{className:"text-slate-600 mb-4",children:"The app has been restored from checkpoint:"}),(0,se.jsx)("div",{className:"bg-slate-100 rounded-lg p-4 mb-4 inline-block text-left",children:(0,se.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex gap-4",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"App ID:"}),(0,se.jsx)("dd",{className:"font-mono",children:d.app_id})]}),(0,se.jsxs)("div",{className:"flex gap-4",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Checkpoint:"}),(0,se.jsx)("dd",{children:d.checkpoint_name})]}),d.entities_undeleted>0&&(0,se.jsxs)("div",{className:"flex gap-4",children:[(0,se.jsx)("dt",{className:"text-slate-500",children:"Entities Undeleted:"}),(0,se.jsx)("dd",{children:d.entities_undeleted})]})]})}),(0,se.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,se.jsx)("a",{href:"/apps/".concat(d.app_id,"/editor/preview"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Open App"}),(0,se.jsx)("button",{onClick:w,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-medium rounded-lg transition-colors",children:"Restore Another App"})]})]})]})]})}function uW(){var e;const{user:t}=wd(),s=[{value:"sandboxes",label:"Sandboxes",component:(0,se.jsx)(SV,{}),minimumRole:"support_personnel"},{value:"complex-apps",label:"Complex Apps",component:(0,se.jsx)(jV,{}),minimumRole:"platform_admin"},{value:"blocked-apps",label:"Blocked Apps",component:(0,se.jsx)(TV,{}),minimumRole:"platform_admin"},{value:"import-export",label:"Import / Export",component:(0,se.jsx)(OV,{}),minimumRole:"platform_admin"},{value:"github",label:"GitHub",component:(0,se.jsx)(eW,{}),minimumRole:"support_personnel"},{value:"assets",label:"Assets",component:(0,se.jsx)(iW,{}),minimumRole:"support_personnel"},{value:"restore-app",label:"Restore App",component:(0,se.jsx)(dW,{}),minimumRole:"support_personnel"}].filter(e=>Kp(t.platform_role,e.minimumRole));return Zp(t.platform_role)?(0,se.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Admin Portal"}),Kp(t.platform_role,"platform_admin")&&(0,se.jsx)("div",{className:"mb-8 flex gap-3 flex-wrap",children:(0,se.jsxs)(Z.Link,{to:"/admin/status-banner-controls",className:"inline-flex items-center gap-2 px-4 py-2 bg-orange-50 hover:bg-orange-100 border border-orange-200 rounded-lg text-orange-700 font-medium transition-colors",children:[(0,se.jsx)(Ap.A,{className:"w-4 h-4"}),"Status Banner Controls",(0,se.jsx)(Rj.A,{className:"w-3 h-3 opacity-50"})]})}),(0,se.jsxs)(Kj,{defaultValue:null===(e=s[0])||void 0===e?void 0:e.value,className:"mb-8",children:[(0,se.jsx)($j,{className:"grid mb-4",style:{gridTemplateColumns:"repeat(".concat(s.length,", 1fr)"),width:"".concat(Math.min(200*s.length,800),"px")},children:s.map(e=>(0,se.jsx)(Zj,{value:e.value,children:e.label},e.value))}),s.map(e=>(0,se.jsx)(Jj,{value:e.value,children:e.component},e.value))]})]}):(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(jH.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,se.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}const mW=["className","variant","size","asChild"],xW=(0,ft.cva)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-950 disabled:pointer-events-none disabled:opacity-50 dark:focus-visible:ring-slate-300",{variants:{variant:{default:"bg-slate-900 text-slate-50 shadow hover:bg-slate-900/90",destructive:"bg-red-500 text-slate-50 shadow-sm hover:bg-red-500/90",outline:"border border-slate-200 bg-white shadow-sm hover:bg-slate-100 hover:text-slate-900",secondary:"bg-slate-100 text-slate-900 shadow-sm hover:bg-slate-100/80",ghost:"hover:bg-slate-100 hover:text-slate-900",link:"text-slate-900 underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),hW=Y.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:l=!1}=e,r=(0,Nt.A)(e,mW);const i=l?nt.Slot:"button";return(0,se.jsx)(i,(0,ue.A)({className:de(xW({variant:a,size:n,className:s})),ref:t},r))});hW.displayName="Button";const pW=["className","type"],gW=Y.forwardRef((e,t)=>{let{className:s,type:a}=e,n=(0,Nt.A)(e,pW);return(0,se.jsx)("input",(0,ue.A)({type:a,className:de("flex h-9 w-full rounded-md border border-slate-200 bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300",s),ref:t},n))});gW.displayName="Input";const fW=e=>{let{buttonText:t={default:"Continue with Google",loading:"Please wait..."},showLastUsed:s=!1,className:a,svgClassName:n="h-4 w-4",redirectUrl:l}=e;const r=(0,J.zy)(),i=new URLSearchParams(r.search),[o,c]=(0,Y.useState)(!1);return(0,se.jsxs)("div",{className:"relative w-full",children:[(0,se.jsxs)(hW,{variant:"outline",className:a||"w-full h-10 bg-white hover:bg-gray-100 py-2 px-4 gap-2.5 rounded-md shadow-xs ".concat(s?"border border-[#FF983B]":"border border-[#E4E4E7]"),type:"button",onClick:async()=>{c(!0);try{sessionStorage.setItem("pendingAuthMethod","google"),localStorage.setItem("lastUsedAuthMethod","google");const e=Xc(l||i.get("from_url"),"/"),t=i.get("ref"),s=i.get("mcp_oauth_context");let a="".concat((0,fe.Zk)(),"/auth/login?from_url=").concat(encodeURIComponent(e),"&auth_method=google");t&&(a+="&ref=".concat(encodeURIComponent(t))),s&&(a+="&mcp_oauth_context=".concat(encodeURIComponent(s))),be(a)}catch(e){c(!1)}},disabled:o,children:[(0,se.jsxs)("svg",{className:n,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,se.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,se.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,se.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),o?t.loading:t.default]}),s&&!o&&(0,se.jsx)("div",{className:"absolute",style:{top:"-25px",right:"20px"},children:(0,se.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-[#FF983B] text-white",style:{borderRadius:"8px 8px 0 0"},children:"Last Used"})})]})},vW=e=>{let{className:t=""}=e;return(0,se.jsx)("div",{className:"hidden lg:block relative min-h-screen p-4 ".concat(t),children:(0,se.jsx)("div",{className:"h-full w-full bg-white rounded-2xl p-4",children:(0,se.jsxs)("div",{className:"relative h-full w-full",children:[(0,se.jsx)("img",{src:"/assets/auth/auth-page-image.jpg",alt:"Creative workspace",className:"absolute inset-0 h-full w-full object-cover rounded-2xl"}),(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center py-6 px-12 xl:px-16 2xl:px-20",children:(0,se.jsx)("div",{className:"w-full max-w-3xl",children:(0,se.jsx)("div",{className:"bg-gradient-to-br from-white/80 to-white/30 backdrop-blur-md rounded-[12px] xl:rounded-[16px] 2xl:rounded-[20px] p-3 border border-white/30",children:(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[(0,se.jsx)("span",{className:"text-slate-400 text-[22px] xl:text-[30px] 2xl:text-[40px] pl-2 font-normal bg-gradient-to-r from-[#BCD2EB] via-[#A7BDD5] to-[#A7BDD5] bg-clip-text text-transparent",children:"Turn your ideas into apps"}),(0,se.jsx)("div",{className:"w-0.5 h-[30px] xl:h-[40px] 2xl:h-[54px] bg-gradient-to-b from-slate-300 to-slate-400"})]}),(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsx)("div",{className:"w-[30px] h-[30px] xl:w-[40px] xl:h-[40px] 2xl:w-[54px] 2xl:h-[54px] rounded-md xl:rounded-[8px] 2xl:rounded-[12px] bg-gradient-to-br from-slate-400/80 to-slate-300/80 flex items-center justify-center",children:(0,se.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",className:"text-white",children:(0,se.jsx)("path",{d:"M12 4L12 20M12 4L18 10M12 4L6 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})})]})})})})]})})})},bW=e=>{let{className:t=""}=e;return(0,se.jsx)("div",{className:"lg:hidden absolute inset-0 ".concat(t),children:(0,se.jsx)("img",{src:"/assets/auth/auth-page-image.jpg",alt:"Creative workspace",className:"absolute inset-0 h-full w-full object-cover"})})},jW=e=>{let{title:t,subtitle:s,showImageColumn:a=!0,backLink:n,footerContent:l,children:r,className:i=""}=e;return(0,se.jsx)("div",{className:"min-h-screen bg-white",children:(0,se.jsxs)("div",{className:"".concat(a?"grid grid-cols-1 lg:grid-cols-2":""," min-h-screen"),children:[(0,se.jsxs)("div",{className:"relative min-h-screen",children:[(0,se.jsx)(bW,{}),(0,se.jsx)("div",{className:"absolute top-6 lg:top-8 z-10 ml-4",children:(0,se.jsx)(Z.Link,{to:"/",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",width:"114",height:"28"})})}),(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen p-6 lg:p-8 relative z-10",children:(0,se.jsxs)("div",{className:"w-full max-w-md bg-white rounded-2xl p-6 lg:p-8 lg:bg-transparent lg:rounded-none space-y-6 shadow-lg lg:shadow-none ".concat(i),children:[n&&(0,se.jsx)("div",{className:"mb-6",children:(0,se.jsxs)(Z.Link,{to:n.href,className:"inline-flex items-center text-sm text-[#71717A] hover:text-[#09090B] font-medium",children:[(0,se.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),n.text]})}),(0,se.jsxs)("div",{className:"space-y-2 text-center",children:[(0,se.jsx)("h1",{className:"text-[20px] lg:text-[48px] font-semibold text-[#09090B] leading-[61px] tracking-[0%] text-center",children:t}),s&&(0,se.jsx)("p",{className:"text-[#71717A] text-base leading-6",children:s})]}),r]})}),l&&(0,se.jsx)("div",{className:"absolute bottom-6 left-6 right-6 lg:bottom-8 lg:left-8 lg:right-8 z-20",children:l})]}),a&&(0,se.jsx)(vW,{})]})})},yW="185178814199-6a35e9aqcmlm15ig0upncg07c91av8do.apps.googleusercontent.com",NW=e=>{let{apiUrl:t,redirectTo:s,setAuthToken:a,flow:n,referralCode:l}=e;const r="Google One Tap ".concat(n);window.google.accounts.id.initialize({client_id:yW,ux_mode:"popup",callback:async e=>{Tu("".concat(r,": Redirect"),{redirect_to:s});try{let i;try{i=await fetch("".concat(t,"/auth/mobile/google/token-exchange"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id_token:e.credential,referral_code:l})})}catch(n){throw Tu("".concat(r,": Token Exchange Failed"),{error:n.message}),n}if(!i.ok){await i.json();return}const o=await i.json();a(o.access_token),localStorage.setItem("lastUsedAuthMethod","google");const c=new URL(s,window.location.origin);c.searchParams.set("access_token",o.access_token),o.is_new_user&&c.searchParams.set("is_new_user","true"),window.location.href=c.toString()}catch(n){}}}),window.google.accounts.id.prompt(e=>{e.isNotDisplayed(),e.isSkippedMoment(),e.isDisplayed()&&Tu("".concat(r,": Displayed"),{redirect_to:s})})},wW=e=>{let{setAuthToken:t,flow:s,referralCode:a}=e;Y.useEffect(()=>{var e,n;const l=Xc(new URLSearchParams(window.location.search).get("from_url"),"/");if(null!==(e=window.google)&&void 0!==e&&null!==(n=e.accounts)&&void 0!==n&&n.id)return _W(),void NW({apiUrl:(0,fe.Gt)(),redirectTo:l,setAuthToken:t,flow:s,referralCode:"register"===s?a:null});let r=20;const i=setInterval(()=>{var e,n;r--,null!==(e=window.google)&&void 0!==e&&null!==(n=e.accounts)&&void 0!==n&&n.id?(clearInterval(i),NW({apiUrl:(0,fe.Gt)(),redirectTo:l,setAuthToken:t,flow:s,referralCode:"register"===s?a:null})):r<=0&&clearInterval(i)},150);return()=>{var e,t,s;clearInterval(i),null===(e=window.google)||void 0===e||null===(t=e.accounts)||void 0===t||null===(s=t.id)||void 0===s||s.cancel()}},[a])},_W=()=>{var e,t,s;null===(e=window.google)||void 0===e||null===(t=e.accounts)||void 0===t||null===(s=t.id)||void 0===s||s.cancel()},kW=()=>{const[e,t]=(0,Y.useState)(!1),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)({email:"",password:""}),j=(0,J.Zp)(),y=(0,J.zy)(),{isAuthenticated:N}=wd();wW({setAuthToken:ee.O5,flow:"login"}),(0,Y.useEffect)(()=>{if(N){const e=Xc(new URLSearchParams(y.search).get("from_url"),"/");j(e)}},[N,j,y.search]),(0,Y.useEffect)(()=>{const e=y.state;null!=e&&e.message&&(l(e.message),e.email&&b(t=>(0,ue.A)((0,ue.A)({},t),{},{email:e.email})));const t=new URLSearchParams(window.location.search),s=t.get("auth_method"),a=sessionStorage.getItem("pendingAuthMethod");"google"===s||"google"===a?(localStorage.setItem("lastUsedAuthMethod","google"),sessionStorage.removeItem("pendingAuthMethod")):"apple"!==s&&"apple"!==a||(localStorage.setItem("lastUsedAuthMethod","apple"),sessionStorage.removeItem("pendingAuthMethod")),"true"===t.get("auth_success")&&a&&(localStorage.setItem("lastUsedAuthMethod",a),sessionStorage.removeItem("pendingAuthMethod"));const n=localStorage.getItem("lastUsedAuthMethod");c(n)},[y]);const w=e=>{const{name:t,value:r}=e.target;b(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:r})),s&&a(null),n&&l(null)};return(0,se.jsxs)(jW,{title:"Welcome to Base44",showImageColumn:!0,footerContent:(0,se.jsxs)("p",{className:"text-center text-xs text-slate-500",children:[(0,se.jsx)("a",{href:"https://base44.com/terms-of-service",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline hover:text-slate-700 cursor-pointer",children:"Terms of Service"})," ","and"," ",(0,se.jsx)("a",{href:"https://base44.com/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline hover:text-slate-700 cursor-pointer",children:"Privacy Policy"}),"."]}),children:[(0,se.jsx)("div",{className:"space-y-3",children:(0,se.jsx)(fW,{buttonText:{default:"Log in with Google",loading:"Logging in..."},showLastUsed:"google"===o})}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,se.jsx)(Tr,{})}),(0,se.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,se.jsx)("span",{className:"bg-white px-2 text-slate-500",children:"Or"})})]}),r&&(0,se.jsxs)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:["Please verify your email before logging in. Check your email for the verification code.",(0,se.jsx)("div",{className:"mt-2",children:(0,se.jsx)("button",{onClick:async()=>{if(v.email)try{t(!0),await jd.resendOtp(v.email),j("/verify-email",{state:{email:v.email,isFromLogin:!0}})}catch(s){a("Failed to resend verification code. Please try again.")}finally{t(!1)}else a("Please enter your email address first.")},disabled:e,className:"text-orange-600 hover:text-orange-500 underline",children:"Resend verification code"})})]}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),m)if(null!=h&&h.has_sso)(()=>{if(!h||!h.workspace_id)return void a("SSO configuration error. Please try again.");const e=new URLSearchParams(window.location.search).get("from_url")||"/",t="".concat((0,fe.Zk)(),"/workspaces/").concat(h.workspace_id,"/auth/sso/login?from_url=").concat(encodeURIComponent(e));window.location.replace(t)})();else{t(!0),a(null),l(null),i(!1);try{const e=new URLSearchParams(window.location.search),t=e.get("mcp_oauth_context");if(t){const e=await jd.login(v.email,v.password,null);if(!e.success||!e.access_token){const t=e.detail||"Login failed";return void(t.includes("verify your email")?(i(!0),a("Please verify your email before logging in. Check your email for the verification code.")):a(t))}return(0,ee.O5)(e.access_token),localStorage.setItem("lastUsedAuthMethod","email"),void(window.location.href="/oauth/consent?mcp_oauth_context=".concat(encodeURIComponent(t)))}const s=await jd.login(v.email,v.password,null);if(s.success&&s.access_token){(0,ee.O5)(s.access_token),localStorage.setItem("lastUsedAuthMethod","email");const t=Xc(e.get("from_url"),"/");window.location.href=t}else a("Login failed. Please try again.")}catch(s){var n;if(400===(null===(n=s.response)||void 0===n?void 0:n.status)){var r;const t=(null===(r=s.response.data)||void 0===r?void 0:r.detail)||"Invalid email or password";t.includes("verify your email")?(i(!0),a("Please verify your email before logging in. Check your email for the verification code.")):a(t)}else a("Login failed. Please try again.")}finally{t(!1)}}else await(async()=>{var e;const t=v.email;if(t.includes("@")&&null!==(e=t.split("@")[1])&&void 0!==e&&e.includes(".")){f(!0),a(null);try{const e=await jd.checkDomainSSO(t);p(e),x(!0),u(!e.has_sso)}catch(s){x(!0),u(!0),p(null)}finally{f(!1)}}else a("Please enter a valid email address")})()},className:"space-y-6",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:"email",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Email"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(gW,{name:"email",type:"email",placeholder:"Enter your email address",value:v.email,onChange:e=>{w(e),m&&(x(!1),u(!1),p(null))},required:!0,disabled:e||m,className:"bg-white text-[#09090B] h-9 px-3 py-1 rounded-md shadow-xs border border-[#E4E4E7] w-full ".concat(m?"pr-12":"")}),m&&!g&&(0,se.jsx)("button",{type:"button",onClick:()=>{x(!1),u(!1),p(null),a(null)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-sm font-medium text-[#71717A] hover:text-[#09090B] underline",children:"Edit"})]})]}),"email"===o&&!m&&(0,se.jsx)("div",{className:"absolute -top-2 right-0",children:(0,se.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-[#FF983B] text-white",children:"Last Used"})})]}),m&&!g&&(0,se.jsx)(se.Fragment,{children:null!=h&&h.has_sso?(0,se.jsxs)("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-md",children:[(0,se.jsxs)("p",{className:"text-sm text-slate-800",children:["SSO is enabled for ",(0,se.jsx)("strong",{children:h.workspace_name})]}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Click below to continue with your organization's login"})]}):(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("label",{htmlFor:"password",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Password"}),(0,se.jsx)(Z.Link,{to:"/forgot-password",className:"text-sm font-medium leading-5 tracking-normal text-[#71717A]",children:"Forgot password?"})]}),(0,se.jsx)(gW,{name:"password",type:"password",placeholder:"Enter your password",value:v.password,onChange:w,required:!(null!=h&&h.has_sso),disabled:e,autoFocus:!0,className:"bg-white text-[#09090B] h-9 px-3 py-1 rounded-md shadow-xs ".concat(s&&!r&&m?"border border-[#DC2626]":"border border-[#E4E4E7]")})]})}),s&&!r&&(0,se.jsx)("p",{className:"text-[14px] leading-[20px] tracking-[0%] text-[#DC2626] font-normal",children:s}),g&&(0,se.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500"}),"Checking authentication method..."]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(hW,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:e||g||!m&&!v.email,children:g?"Checking...":e?"Logging in...":m?null!=h&&h.has_sso?"Continue with ".concat(h.sso_provider||"SSO"):"Log In":"Continue"}),n&&(0,se.jsx)("div",{className:"p-4 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:n}),(0,se.jsxs)("p",{className:"text-center text-sm text-[#71717A]",children:["Don't have an account?"," ",(0,se.jsx)(Z.Link,{to:"/register".concat(y.search),className:"font-medium text-black underline",children:"Sign up"})]})]})]})]})},CW=e=>{let{name:t,value:s,onChange:a,placeholder:n="Enter your email address",required:l=!1,disabled:r=!1,label:i="Email",onValidationChange:o}=e;const[c,d]=Y.useState(null);return(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:t,className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:i}),(0,se.jsx)(gW,{name:t,type:"email",placeholder:n,value:s,onChange:e=>{const{value:t}=e.target;c&&(d(null),null==o||o(!0)),a(e)},onBlur:e=>{const{value:t}=e.target;t&&!Lv(t)?(d("That's not a valid email. Try a different email address."),null==o||o(!1)):t&&(d(null),null==o||o(!0))},required:l,disabled:r,className:"bg-white text-[#09090B] h-9 px-3 py-1 rounded-md shadow-xs ".concat(c?"border border-[#DC2626]":"border border-[#E4E4E7]")}),c&&(0,se.jsx)("p",{className:"text-[14px] leading-[20px] tracking-[0%] text-[#DC2626] font-normal mt-1",children:c})]})},AW=(0,Y.forwardRef)((e,t)=>{let{siteKey:s,onSuccess:a,onError:n,onExpired:l,theme:r="light",size:i="normal",className:o=""}=e;const c=(0,Y.useRef)(null),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{const e=()=>{window.turnstile?x(!0):setTimeout(e,100)};e()},[]),(0,Y.useEffect)(()=>{if(m&&c.current&&!d)try{const e=window.turnstile.render(c.current,{sitekey:s,theme:r,size:i,callback:e=>{null==a||a(e)},"error-callback":e=>{null==n||n(e)},"expired-callback":()=>{null==l||l()}});u(e)}catch(e){null==n||n("Failed to load security verification")}return()=>{if(d&&window.turnstile)try{window.turnstile.remove(d)}catch(e){}}},[m,s,r,i,d,a,n,l]);const h=()=>{if(d&&window.turnstile)try{window.turnstile.reset(d)}catch(e){}},p=()=>{if(d&&window.turnstile)try{return window.turnstile.getResponse(d)}catch(e){return""}return""};return(0,Y.useImperativeHandle)(t,()=>({reset:h,getResponse:p})),(0,se.jsx)("div",{className:"turnstile-container ".concat(o),children:(0,se.jsx)("div",{ref:c})})});AW.displayName="Turnstile";const SW=AW,EW="0x4AAAAAABkwg1ZNNlkay6SI",TW="light",IW="normal",PW=!0,LW=e=>e&&e.length>0,MW=e=>{let{onSuccess:t,onError:s,onExpired:a,isVerified:n=!1,className:l=""}=e;return PW?n?null:(0,se.jsx)("div",{className:"space-y-2 ".concat(l),children:(0,se.jsx)(SW,{siteKey:EW,theme:TW,size:IW,onSuccess:t,onError:s,onExpired:a,className:"flex justify-center"})}):null},RW=e=>{const[t,s]=(0,Y.useState)(null),a=LW(t),n=(0,Y.useCallback)(t=>{s(t),e&&e("")},[e]),l=(0,Y.useCallback)(t=>{s(null),e&&e((e=>{switch(e){case"timeout":return"Security verification timed out. Please try again.";case"network-error":return"Network error during security verification. Please check your connection.";case"invalid-sitekey":return"Invalid security configuration. Please contact support.";default:return"Security verification failed. Please try again."}})(t))},[e]),r=(0,Y.useCallback)(()=>{s(null)},[]),i=(0,Y.useCallback)(()=>!(PW&&!LW(t))||(e&&e("Please complete the security verification"),!1),[t,e]),o=(0,Y.useCallback)(t=>{e&&e(t)},[e]),c=(0,Y.useCallback)(()=>{e&&e("")},[e]);return{turnstileToken:t,isVerified:a,handleTurnstileSuccess:n,handleTurnstileError:l,handleTurnstileExpired:r,validateTurnstileToken:i,setError:o,clearError:c}};class DW extends te.H{getBaseURL(){return"/referrals"}async generateReferralCode(){try{return(await this.axios.post("/generate-code")).referral_code}catch(s){var e,t;throw new Error((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to generate referral code")}}async validateReferralCode(e){try{return await this.axios.post("/validate",{referral_code:e})}catch(a){var t,s;throw new Error((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"Failed to validate referral code")}}async getReferralStats(){try{return await this.axios.get("/stats")}catch(s){var e,t;throw new Error((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to fetch referral statistics")}}}const FW=new DW,OW=e=>{const t=e.length>=8,s=/[a-z]/.test(e)&&/[A-Z]/.test(e),a=/[#$&@!%*?&]/.test(e);let n=0;t&&n++,s&&n++,a&&n++;let l="Weak password";return n>=3?l="Strong password":n>=2&&(l="Average password"),{score:n,label:l,hasMinLength:t,hasUpperLower:s,hasSymbol:a}},UW=e=>e>=3?"bg-green-500":e>=2?"bg-yellow-500":"bg-orange-500",BW=e=>{const t=[];for(let s=0;s<3;s++)t.push((0,se.jsx)("div",{className:"h-1 flex-1 rounded-full ".concat(s<e?UW(e):"bg-gray-200")},s));return t},zW=e=>{let{password:t,showTooltip:s,onMouseEnter:a,onMouseLeave:n}=e;const l=OW(t);return s&&t?(0,se.jsxs)("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-3 w-[265px] bg-white border border-[#E4E4E7] rounded-lg shadow-lg py-3 px-3 z-10",style:{borderRadius:"8px"},onMouseEnter:a,onMouseLeave:n,children:[(0,se.jsx)("div",{className:"absolute right-full top-1/2 -translate-y-1/2 w-0 h-0 border-t-[6px] border-b-[6px] border-r-[6px] border-t-transparent border-b-transparent border-r-[#E4E4E7]"}),(0,se.jsx)("div",{className:"absolute right-full top-1/2 -translate-y-1/2 translate-x-px w-0 h-0 border-t-[6px] border-b-[6px] border-r-[6px] border-t-transparent border-b-transparent border-r-white"}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,se.jsx)("span",{className:"text-sm font-medium text-[#09090B]",children:l.label})}),(0,se.jsx)("div",{className:"flex space-x-1",children:BW(l.score)})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-[#71717A] mb-2",children:"Password must include:"}),(0,se.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-[18px] h-[18px] rounded-full border-2 flex items-center justify-center border-[#71717A]",children:l.hasMinLength&&(0,se.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",children:(0,se.jsx)("path",{d:"M9 1L3.5 6.5L1 4",stroke:"#71717A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,se.jsx)("span",{className:"text-[#09090B]",children:"At least 8 characters"})]}),(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-[18px] h-[18px] rounded-full border-2 flex items-center justify-center border-[#71717A]",children:l.hasUpperLower&&(0,se.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",children:(0,se.jsx)("path",{d:"M9 1L3.5 6.5L1 4",stroke:"#71717A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,se.jsx)("span",{className:"text-[#09090B]",children:"Upper & lower case letters"})]}),(0,se.jsxs)("li",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-[18px] h-[18px] rounded-full border-2 flex items-center justify-center border-[#71717A]",children:l.hasSymbol&&(0,se.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",children:(0,se.jsx)("path",{d:"M9 1L3.5 6.5L1 4",stroke:"#71717A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,se.jsx)("span",{className:"text-[#09090B]",children:"A symbol (#$&)"})]})]})]})]})]}):null},HW=e=>{let{password:t,showTooltip:s}=e;const a=OW(t);return s&&t?(0,se.jsxs)("div",{className:"w-full bg-[#F8F9FA] border border-[#E4E4E7] rounded-xl p-4 space-y-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-[#09090B] mb-3",children:"Password must include:"}),(0,se.jsxs)("ul",{className:"space-y-3",children:[(0,se.jsxs)("li",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center ".concat(a.hasMinLength?"bg-[#71717A] border-[#71717A]":"border-[#71717A] bg-transparent"),children:a.hasMinLength&&(0,se.jsx)("svg",{width:"12",height:"10",viewBox:"0 0 12 10",fill:"none",children:(0,se.jsx)("path",{d:"M10 2L4.5 7.5L2 5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,se.jsx)("span",{className:"text-sm text-[#09090B]",children:"At least 8 characters"})]}),(0,se.jsxs)("li",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center ".concat(a.hasUpperLower?"bg-[#71717A] border-[#71717A]":"border-[#71717A] bg-transparent"),children:a.hasUpperLower&&(0,se.jsx)("svg",{width:"12",height:"10",viewBox:"0 0 12 10",fill:"none",children:(0,se.jsx)("path",{d:"M10 2L4.5 7.5L2 5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,se.jsx)("span",{className:"text-sm text-[#09090B]",children:"Upper & lower case letters"})]}),(0,se.jsxs)("li",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center ".concat(a.hasSymbol?"bg-[#71717A] border-[#71717A]":"border-[#71717A] bg-transparent"),children:a.hasSymbol&&(0,se.jsx)("svg",{width:"12",height:"10",viewBox:"0 0 12 10",fill:"none",children:(0,se.jsx)("path",{d:"M10 2L4.5 7.5L2 5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,se.jsx)("span",{className:"text-sm text-[#09090B]",children:"At least one symbol (#$&)"})]})]})]}):null},VW=e=>{let{email:t,onSuccess:s,successRedirectPath:a="/login",isFromLogin:n=!1}=e;const[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(["","","","","",""]),[u,m]=(0,Y.useState)([!1,!1,!1,!1,!1,!1]),[x,h]=(0,Y.useState)(null),p=(0,J.Zp)(),g=(0,Y.useRef)([]);(0,Y.useEffect)(()=>{var e;null===(e=g.current[0])||void 0===e||e.focus()},[]);const f=e=>{e.preventDefault();const t=e.clipboardData.getData("text").slice(0,6),s=[...c];for(let r=0;r<t.length;r++)/^\d$/.test(t[r])&&(s[r]=t[r]);d(s);const a=s.findIndex(e=>!e);var n,l;-1!==a?null===(n=g.current[a])||void 0===n||n.focus():null===(l=g.current[5])||void 0===l||l.focus()};return(0,se.jsxs)(jW,{title:"Verify your email",subtitle:"We sent a verification code to ".concat(t),showImageColumn:!0,children:[i&&(0,se.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:i}),(0,se.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),r(!0),o(null),h(null);const l=c.map(e=>!e);if(l.some(e=>e))return m(l),h("Please fill out all fields."),void r(!1);const d=c.join("");try{const e=await jd.verifyOtp(t,d);if(e.success)if(n||(pw("registration_completed",{email:(0,fw.sha256)(t),user_id:e.id,registration_method:"email&password"}),Cu(e.id)),e.access_token){let t;if((0,ee.O5)(e.access_token),a.startsWith("/login")){const e=new URLSearchParams(a.split("?")[1]||""),s=e.get("mcp_oauth_context");if(s)t="/oauth/consent?mcp_oauth_context=".concat(encodeURIComponent(s));else{t=Xc(e.get("from_url"),"/")}}else t=Xc(a,"/");await new Promise(e=>setTimeout(e,500)),window.location.href=t}else s?s():p(a,{state:{message:n?"Email verified successfully! You can now log in.":"Email verified successfully! Please log in to continue.",email:t}});else o("Invalid verification code. Please try again.")}catch(i){var u,x;if(400===(null===(u=i.response)||void 0===u?void 0:u.status)||429===(null===(x=i.response)||void 0===x?void 0:x.status)){var g;const t=(null===(g=i.response.data)||void 0===g?void 0:g.detail)||"Invalid verification code";o(t)}else o("Verification failed. Please try again.")}finally{r(!1)}},className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:"otpCode",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Verification Code"}),(0,se.jsx)("div",{className:"flex gap-2",children:c.map((e,t)=>(0,se.jsx)(gW,{name:"otpCode".concat(t),type:"text",inputMode:"numeric",pattern:"\\d{1}",value:e,onChange:e=>((e,t)=>{if(t.length>1)return;const s=[...c];if(s[e]=t,d(s),t){const t=[...u];t[e]=!1,m(t),s.every(e=>e)&&h(null)}var a;t&&e<5&&(null===(a=g.current[e+1])||void 0===a||a.focus())})(t,e.target.value),onKeyDown:e=>((e,t)=>{var s;"Backspace"===t.key&&!c[e]&&e>0&&(null===(s=g.current[e-1])||void 0===s||s.focus())})(t,e),onPaste:0===t?f:void 0,disabled:l,className:"w-11 h-11 text-center text-lg font-semibold bg-white text-[#09090B] rounded-md shadow-xs ".concat(u[t]?"border border-[#DC2626]":"border border-[#E4E4E7] focus:border-slate-400 focus:ring-slate-400"),maxLength:1,ref:e=>g.current[t]=e},t))}),x&&(0,se.jsx)("p",{className:"text-[14px] leading-[20px] tracking-[0%] text-[#DC2626] font-normal mt-1",children:x}),(0,se.jsx)("p",{className:"text-xs text-slate-500 mt-3",children:"Enter the verification code sent to your email"})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(hW,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:l,children:l?"Verifying...":"Verify Email"}),(0,se.jsxs)("p",{className:"text-sm text-slate-600",children:["Didn't receive the code?"," ",(0,se.jsx)("button",{type:"button",onClick:async()=>{try{var e;r(!0),o(null),await jd.resendOtp(t),o("New verification code sent to your email."),d(["","","","","",""]),null===(e=g.current[0])||void 0===e||e.focus()}catch(i){o("Failed to resend verification code. Please try again.")}finally{r(!1)}},disabled:l,className:"font-medium text-black hover:text-slate-700 underline",children:"Resend email"})]})]})]})]})};var WW=s(29221);const qW=()=>{const[e]=(0,Z.useSearchParams)(),t=(0,J.Zp)(),s=(0,J.zy)(),a=e.get("ref"),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)({isValidating:!1,isValid:null,referrerInfo:null,validationMessage:null}),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(""),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(null),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)({score:0,label:"Weak password",hasMinLength:!1,hasUpperLower:!1,hasSymbol:!1}),[N,w]=(0,Y.useState)({email:"",password:""}),{user:_,isAuthenticated:k}=wd();wW({setAuthToken:ee.O5,flow:"register",referralCode:a}),(0,Y.useEffect)(()=>{if(k){const e=Xc(new URLSearchParams(s.search).get("from_url"),"/");t(e)}},[k,t,s.search]),(0,Y.useEffect)(()=>{const e="sign_up",t={user_id:k&&null!=_&&_.id?_.id:null,app_id:null,conversation_id:null};Hu(t,{page_name:e}),Tu("Page View",{page_name:e,page_url:window.location.pathname,user_id:t.user_id})},[]);const{turnstileToken:C,isVerified:A,handleTurnstileSuccess:S,handleTurnstileError:E,handleTurnstileExpired:T,validateTurnstileToken:I}=RW(i);(0,Y.useEffect)(()=>()=>{g&&clearTimeout(g)},[g]),(0,Y.useEffect)(()=>{a&&P()},[a]);const P=async()=>{if(a){c(e=>(0,ue.A)((0,ue.A)({},e),{},{isValidating:!0}));try{const e=await FW.validateReferralCode(a);c({isValidating:!1,isValid:e.is_valid,referrerInfo:e.referrer,validationMessage:e.message})}catch(r){c({isValidating:!1,isValid:!1,referrerInfo:null,validationMessage:"Failed to validate referral code"})}}},L=e=>{const{name:t,value:s}=e.target;w(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:s})),"password"===t&&y(OW(s)),r&&i(null)};if(d){const e="/login".concat(s.search);return(0,se.jsx)(VW,{email:m,isFromLogin:!1,successRedirectPath:e})}return(0,se.jsxs)(jW,{title:"Create your account",showImageColumn:!0,footerContent:(0,se.jsxs)("p",{className:"text-center text-xs text-slate-500",children:['By clicking "Sign Up", you agree to our'," ",(0,se.jsx)("a",{href:"https://base44.com/terms-of-service",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline hover:text-slate-700 cursor-pointer",children:"Terms of Service"})," ","and"," ",(0,se.jsx)("a",{href:"https://base44.com/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline hover:text-slate-700 cursor-pointer",children:"Privacy Policy"}),"."]}),children:[a&&(0,se.jsx)("div",{className:"mb-6 p-4 rounded-lg text-center border ".concat((o.isValidating||o.isValid,"bg-gray-50 border-gray-200")),children:o.isValidating?(0,se.jsxs)("div",{className:"flex items-center justify-center",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-800",children:"Validating referral code..."})]}):!1===o.isValid?(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,se.jsx)(WW.A,{className:"h-5 w-5 text-gray-600 mr-2"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-800",children:"Invalid Referral Code"})]}),(0,se.jsx)("p",{className:"text-sm text-gray-700",children:o.validationMessage})]}):o.isValid&&o.referrerInfo?(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,se.jsx)("svg",{className:"h-5 w-5 text-gray-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-800",children:"You've been invited!"})]}),(0,se.jsxs)("p",{className:"text-sm text-gray-700 mb-1",children:[(0,se.jsx)("strong",{children:o.referrerInfo.first_name||o.referrerInfo.email})," invited you to join Base44"]}),(0,se.jsx)("p",{className:"text-sm text-gray-600",children:"Sign up to get 10 free credits!"})]}):(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"text-sm font-medium text-gray-800",children:"You've been invited!"}),(0,se.jsx)("p",{className:"text-sm text-gray-700",children:"Let's build something amazing together!"}),(0,se.jsx)("p",{className:"text-sm text-gray-600",children:"Sign up to get 10 free credits!"})]})}),(0,se.jsx)("div",{className:"space-y-3",children:(0,se.jsx)(fW,{buttonText:{default:"Sign up with Google",loading:"Signing up..."}})}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,se.jsx)(Tr,{})}),(0,se.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,se.jsx)("span",{className:"bg-white px-2 text-slate-500",children:"Or"})})]}),r&&(0,se.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 rounded-md",children:r}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l(!0),i(null),I())try{const e=a&&o.isValid?a:null,t=Nu("_wixCIDX");(await jd.register(N.email,N.password,C,e,t)).id?(x(N.email),u(!0),i(null)):i("Registration failed. Please try again.")}catch(r){var t;if(400===(null===(t=r.response)||void 0===t?void 0:t.status)){var s;const t=(null===(s=r.response.data)||void 0===s?void 0:s.detail)||"Registration failed";i(t)}else i("Registration failed. Please try again.")}finally{l(!1)}else l(!1)},className:"space-y-6",children:[(0,se.jsx)(CW,{name:"email",value:N.email,onChange:e=>{L(e)},placeholder:"Enter your email address",required:!0,disabled:n,label:"Email"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:"password",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(gW,{name:"password",type:v?"text":"password",placeholder:"Enter your password",value:N.password,onChange:L,onFocus:()=>{g&&(clearTimeout(g),f(null)),p(!0)},onBlur:()=>{const e=setTimeout(()=>{p(!1)},150);f(e)},required:!0,disabled:n,className:"bg-white text-[#09090B] h-9 px-3 py-1 pr-20 border border-[#E4E4E7] rounded-md shadow-xs",minLength:8}),N.password&&(0,se.jsx)("div",{className:"absolute right-9 top-1/2 -translate-y-1/2 h-[18px] flex items-center",children:(0,se.jsx)("span",{className:"text-xs text-[#71717A] font-normal leading-none tracking-normal",children:j.label.replace(" password","")})}),N.password&&(0,se.jsx)("button",{type:"button",onClick:()=>b(!v),className:"absolute right-3 top-1/2 -translate-y-1/2 w-[18px] h-[18px] flex items-center justify-center text-[#71717A] hover:text-[#09090B]",children:v?(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,se.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,se.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,se.jsx)("div",{className:"hidden lg:block",children:(0,se.jsx)(zW,{password:N.password,showTooltip:h,onMouseEnter:()=>{g&&(clearTimeout(g),f(null))},onMouseLeave:()=>{p(!1)}})})]})]}),(0,se.jsx)("div",{className:"lg:hidden",children:(0,se.jsx)(HW,{password:N.password,showTooltip:!!N.password})}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(hW,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:n||j.score<3,children:n?"Creating account...":"Sign Up"}),(0,se.jsx)(MW,{onSuccess:S,onError:E,onExpired:T,isVerified:A,className:"flex justify-center"}),(0,se.jsxs)("p",{className:"text-center text-sm text-[#71717A]",children:["Already have a Base44 account?"," ",(0,se.jsx)(Z.Link,{to:"/login".concat(s.search),className:"font-medium text-black underline",children:"Log in"})]})]})]})]})},YW=()=>{var e,t;const s=(0,J.zy)(),a=(0,J.g)(),n=(null===(e=s.state)||void 0===e?void 0:e.email)||a.email||new URLSearchParams(s.search).get("email"),l=(null===(t=s.state)||void 0===t?void 0:t.isFromLogin)||!1;return n?(0,se.jsx)(VW,{email:n,isFromLogin:l,successRedirectPath:"/login"}):(0,se.jsx)(J.C5,{to:"/login",replace:!0})},GW=()=>{const[e,t]=(0,Y.useState)(!1),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(""),r=(0,J.Zp)();return(0,se.jsxs)(jW,{title:"Reset your password",subtitle:"Enter the email address you used to sign up, and we'll send you a link to reset your password.",showImageColumn:!0,backLink:{href:"/login",text:"Back to log in"},children:[s&&(0,se.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:s}),(0,se.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),t(!0),a(null);try{await jd.resetPasswordRequest(n,null);r("/check-email",{state:{email:n}})}catch(s){var l;if(400===(null===(l=s.response)||void 0===l?void 0:l.status)){var i;const t=(null===(i=s.response.data)||void 0===i?void 0:i.detail)||"Invalid email address";a(t)}else a("Failed to send reset link. Please try again.")}finally{t(!1)}},className:"space-y-6",children:[(0,se.jsx)(CW,{name:"email",value:n,onChange:e=>{(e=>{l(e.target.value),s&&a(null)})(e)},placeholder:"e.g., name@email.com",required:!0,disabled:e,label:"Login email"}),(0,se.jsx)("div",{className:"space-y-4",children:(0,se.jsx)(hW,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:e,children:e?"Sending...":"Verify Email"})})]})]})},KW=()=>{const[e,t]=(0,Y.useState)(!1),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(""),r=(0,J.zy)(),i=(0,J.Zp)();(0,Y.useEffect)(()=>{const e=r.state;null!=e&&e.email&&l(e.email)},[r]);return(0,se.jsxs)(jW,{title:"Check your email",subtitle:(0,se.jsxs)(se.Fragment,{children:["We've sent password reset instructions to"," ",(0,se.jsx)("span",{className:"font-medium text-[#09090B]",children:n}),"."]}),showImageColumn:!0,backLink:{href:"/forgot-password",text:"Back to Reset password"},children:[(0,se.jsx)("div",{className:"py-3 px-4 bg-[#FAFAFA] border border-[#E4E4E7] rounded-lg gap-x-3",children:(0,se.jsxs)("p",{className:"text-sm text-[#71717A] text-center leading-relaxed",children:[(0,se.jsx)("span",{className:"block",children:"Please check your email for the password reset link."}),(0,se.jsx)("span",{className:"block",children:"It may take a few minutes to arrive."})]})}),s&&(0,se.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:s}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(hW,{onClick:()=>i("/login"),className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs p-2 px-4 gap-2.5",children:"Go to Sign In"}),(0,se.jsx)("div",{className:"text-center",children:(0,se.jsxs)("span",{className:"text-sm text-[#71717A]",children:["Didn't get the email?"," ",(0,se.jsx)("button",{onClick:async()=>{if(n){t(!0),a(null);try{await jd.resetPasswordRequest(n),a("New password reset email sent. Please check your inbox.")}catch(s){var e;if(400===(null===(e=s.response)||void 0===e?void 0:e.status)){var l;const e=(null===(l=s.response.data)||void 0===l?void 0:l.detail)||"Failed to send email";a(e)}else a("Failed to resend email. Please try again.")}finally{t(!1)}}else a("Email address not found. Please go back and try again.")},disabled:e,className:"font-medium text-black hover:underline",children:e?"Resending...":"Resend email"})]})})]})]})},$W=()=>{const[e,t]=(0,Y.useState)(!1),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(null),[v,b]=(0,Y.useState)({score:0,label:"Weak password",hasMinLength:!1,hasUpperLower:!1,hasSymbol:!1}),[j]=(0,Z.useSearchParams)(),y=(0,J.Zp)(),N=j.get("token");Y.useEffect(()=>{N||y("/forgot-password")},[N,y]),(0,Y.useEffect)(()=>()=>{g&&clearTimeout(g)},[g]);return(0,se.jsxs)(jW,{title:"Set new password",subtitle:"Enter your new password for Base44",showImageColumn:!1,children:[s&&(0,se.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:s}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),N)if(r===o)if(v.score<3)a("Please create a strong password that meets all requirements.");else{t(!0),a(null),l(null);try{const e=await jd.resetPassword(N,r,null);e&&e.id?(l("Password reset successfully! Redirecting to login..."),setTimeout(()=>{y("/login",{state:{message:"Password reset successfully! Please log in with your new password."}})},2e3)):a("Failed to reset password. Please try again.")}catch(s){var n;if(400===(null===(n=s.response)||void 0===n?void 0:n.status)){var i;const t=(null===(i=s.response.data)||void 0===i?void 0:i.detail)||"Invalid or expired reset token";a(t)}else a("Failed to reset password. Please try again.")}finally{t(!1)}}else a("Passwords do not match. Please try again.");else a("Invalid or missing reset token. Please request a new password reset.")},className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:"newPassword",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"New password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(gW,{name:"newPassword",type:d?"text":"password",placeholder:"Enter your new password",value:r,onChange:e=>{const t=e.target.value;i(t),b(OW(t)),s&&a(null),n&&l(null)},onFocus:()=>{g&&(clearTimeout(g),f(null)),p(!0)},onBlur:()=>{const e=setTimeout(()=>{p(!1)},150);f(e)},required:!0,disabled:e,className:"bg-white text-[#09090B] h-9 px-3 py-1 pr-20 border border-[#E4E4E7] rounded-md shadow-xs",minLength:8}),r&&(0,se.jsx)("div",{className:"absolute right-9 top-1/2 -translate-y-1/2 h-[18px] flex items-center",children:(0,se.jsx)("span",{className:"text-xs text-[#71717A] font-normal leading-none tracking-normal",children:v.label.replace(" password","")})}),r&&(0,se.jsx)("button",{type:"button",onClick:()=>u(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 w-[18px] h-[18px] flex items-center justify-center text-[#71717A] hover:text-[#09090B]",children:d?(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,se.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,se.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,se.jsx)("div",{className:"hidden lg:block",children:(0,se.jsx)(zW,{password:r,showTooltip:h,onMouseEnter:()=>{g&&(clearTimeout(g),f(null))},onMouseLeave:()=>{p(!1)}})})]})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:"confirmPassword",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Confirm new password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(gW,{name:"confirmPassword",type:m?"text":"password",placeholder:"Confirm your new password",value:o,onChange:e=>{c(e.target.value),s&&a(null),n&&l(null)},required:!0,disabled:e,className:"bg-white text-[#09090B] h-9 px-3 py-1 pr-10 border border-[#E4E4E7] rounded-md shadow-xs",minLength:8}),o&&(0,se.jsx)("button",{type:"button",onClick:()=>x(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 w-[18px] h-[18px] flex items-center justify-center text-[#71717A] hover:text-[#09090B]",children:m?(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,se.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,se.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),(0,se.jsx)("div",{className:"lg:hidden",children:(0,se.jsx)(HW,{password:r,showTooltip:!!r})}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(hW,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:e||v.score<3,children:e?"Resetting...":"Reset Password"}),n&&(0,se.jsx)("div",{className:"p-4 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:n}),(0,se.jsx)("div",{className:"text-center",children:(0,se.jsx)(Z.Link,{to:"/login",className:"text-sm font-medium text-[#09090B] underline hover:text-[#71717A] leading-5 tracking-normal",children:"Back to Log In"})})]})]})]})};function ZW(e){let{children:t}=e;return(0,se.jsx)(db.oz,{className:"base44-markdown prose",remarkPlugins:[cb.A],children:t})}const JW=()=>{const e=(0,J.Zp)();return(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"max-w-md mx-auto text-center px-6",children:[(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("h1",{className:"text-8xl font-light text-slate-300 mb-4",children:"404"}),(0,se.jsx)("h2",{className:"text-2xl font-medium text-slate-900 mb-3",children:"Page not found"}),(0,se.jsx)("p",{className:"text-slate-600 leading-relaxed",children:"The page you're looking for doesn't exist or has been moved."})]}),(0,se.jsx)("button",{onClick:()=>e("/"),className:"inline-flex items-center px-6 py-3 text-sm font-medium text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2",children:"Go home"})]})})};class QW extends te.y{getBaseURL(){return"/integrations/StripeIntegration"}getOrCreateAccount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"express";return this.axios.post("/get-or-create-account",{account_type:e})}getAccount(){return this.axios.get("/get-account")}createAccountLink(e,t){if(!e)throw new Error("Account ID is required for this operation");return this.axios.post("/".concat(e,"/create-account-link"))}checkAccountStatus(e){if(!e)throw new Error("Account ID is required for this operation");return this.axios.get("/".concat(e,"/check-account-status"))}refreshProductCatalog(e){if(!e)throw new Error("Account ID is required for this operation");return this.axios.post("/".concat(e,"/refresh-product-catalog"))}connectToApp(e,t){if(!e)throw new Error("Account ID is required for this operation");return this.axios.get("/".concat(e,"/connect-to-app/").concat(t))}createCheckoutSession(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!e)throw new Error("Account ID is required for this operation");const a=window.location.href;return this.axios.post("/".concat(e,"/create-checkout-session"),{price_id:t,quantity:s,success_url:"".concat(a,"?checkout_status=success"),cancel_url:"".concat(a,"?checkout_status=canceled")})}deleteAccount(e){if(!e)throw new Error("Account ID is required for this operation");return this.axios.delete("/".concat(e,"/delete-account"))}}const XW=new QW;function eq(e){let{onAccountCreated:t}=e;const[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)("express"),{toast:r}=Cb();return(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Get Started with Stripe"}),(0,se.jsx)(Ps,{children:"Create a Stripe account to start accepting payments in your apps"})]}),(0,se.jsxs)(Ls,{children:[(0,se.jsx)("p",{className:"text-muted-foreground mb-4",children:"With Stripe, you can accept payments, manage subscriptions, and more. Your Stripe account will be created using Stripe Connect, which will allow your users to pay you directly."}),(0,se.jsxs)("div",{className:"mt-6",children:[(0,se.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Choose Account Type"}),(0,se.jsxs)(lr,{value:n,onValueChange:l,className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-start space-x-2 rounded-md border p-4",children:[(0,se.jsx)(rr,{value:"express",id:"express",className:"mt-1"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex space-x-2",children:[(0,se.jsx)(On,{htmlFor:"express",className:"font-medium",children:"Express Account"}),(0,se.jsx)("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700",children:"Recommended for new users"})]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Best for people who don't have a Stripe account yet. Express accounts offer a simplified onboarding process with a Stripe-hosted setup and dashboard. This is the quickest way to get started."})]})]}),(0,se.jsxs)("div",{className:"flex items-start space-x-2 rounded-md border p-4",children:[(0,se.jsx)(rr,{value:"standard",id:"standard",className:"mt-1"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex space-x-2",children:[(0,se.jsx)(On,{htmlFor:"standard",className:"font-medium",children:"Standard Account"}),(0,se.jsx)("span",{className:"inline-flex items-center rounded-full bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700",children:"For experienced users"})]}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Best for people who already have a Stripe account set up. Standard accounts provide more customization options and direct access to the full Stripe Dashboard. This option requires more setup steps but offers greater flexibility."})]})]})]})]})]}),(0,se.jsx)(Ms,{className:"flex justify-end",children:(0,se.jsx)(zt,{onClick:async()=>{a(!0);try{const e=await XW.getOrCreateAccount(n);t(e),r({title:"Success",description:"Stripe account created successfully",variant:"success"})}catch(e){r({variant:"destructive",title:"Error",description:"Failed to create Stripe account"})}finally{a(!1)}},disabled:s,children:s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Rj.A,{className:"mr-2 h-4 w-4"}),"Create Stripe Account"]})})})]})}function tq(e){var t;let{account:s,onAccountVerified:a}=e;const[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!1),{toast:d}=Cb();(0,Y.useEffect)(()=>{s&&u()},[s]);const u=async()=>{l(!0);try{const e=await XW.checkAccountStatus(s.id);i(e),e.is_complete&&a()}catch(e){d({variant:"destructive",title:"Error",description:"Failed to check Stripe account status"})}finally{l(!1)}};if(n)return(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Checking Your Stripe Account"}),(0,se.jsx)(Ps,{children:"Verifying your Stripe account setup..."})]}),(0,se.jsx)(Ls,{className:"flex justify-center items-center p-8",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]});if(null!=r&&r.is_complete)return(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Stripe Account Setup Complete"}),(0,se.jsx)(Ps,{children:"Your Stripe account is fully set up and ready to use"})]}),(0,se.jsx)(Ls,{children:(0,se.jsxs)(Dt,{className:"bg-green-50 border-green-200",children:[(0,se.jsx)(sd.A,{className:"h-4 w-4 text-green-600"}),(0,se.jsx)(Ft,{className:"text-green-600",children:"Ready to accept payments"}),(0,se.jsx)(Ot,{children:"Your Stripe account is ready to process payments and receive payouts."})]})}),(0,se.jsx)(Ms,{className:"flex justify-end",children:(0,se.jsx)(zt,{onClick:a,children:"Continue to Next Step"})})]});const m=(null==r||null===(t=r.requirements)||void 0===t?void 0:t.currently_due)||[];return(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Complete Your Stripe Account Setup"}),(0,se.jsx)(Ps,{children:"Your Stripe account needs additional information to start accepting payments"})]}),(0,se.jsxs)(Ls,{className:"space-y-4",children:[(0,se.jsxs)(Dt,{variant:"warning",className:"bg-yellow-50 border-yellow-200",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-yellow-600"}),(0,se.jsx)(Ft,{className:"text-yellow-600",children:"Account setup incomplete"}),(0,se.jsx)(Ot,{children:"Please continue the Stripe onboarding process to complete your account setup."})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:null!=r&&r.details_submitted?"text-green-600":"text-muted-foreground",children:[null!=r&&r.details_submitted?(0,se.jsx)(sd.A,{className:"inline h-4 w-4 mr-1"}):(0,se.jsx)(Uy.A,{className:"inline h-4 w-4 mr-1"}),"Account details provided"]})}),(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:null!=r&&r.charges_enabled?"text-green-600":"text-muted-foreground",children:[null!=r&&r.charges_enabled?(0,se.jsx)(sd.A,{className:"inline h-4 w-4 mr-1"}):(0,se.jsx)(Uy.A,{className:"inline h-4 w-4 mr-1"}),"Charges enabled"]})}),(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:null!=r&&r.payouts_enabled?"text-green-600":"text-muted-foreground",children:[null!=r&&r.payouts_enabled?(0,se.jsx)(sd.A,{className:"inline h-4 w-4 mr-1"}):(0,se.jsx)(Uy.A,{className:"inline h-4 w-4 mr-1"}),"Payouts enabled"]})})]}),m.length>0&&(0,se.jsxs)("div",{className:"mt-4",children:[(0,se.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Required Information:"}),(0,se.jsx)("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc pl-5",children:m.map((e,t)=>(0,se.jsx)("li",{children:e.split(".").join(" ").replace(/_/g," ")},t))})]})]}),(0,se.jsxs)(Ms,{className:"flex justify-between items-center",children:[(0,se.jsx)(zt,{variant:"outline",onClick:u,children:"Refresh Status"}),(0,se.jsx)(zt,{onClick:async()=>{c(!0);try{const e="".concat(window.location.origin,"/integrations/stripe"),t=await XW.createAccountLink(s.id,e);t.account_link_url&&(window.location.href=t.account_link_url)}catch(e){d({variant:"destructive",title:"Error",description:"Failed to create Stripe account link"}),c(!1)}},disabled:o,children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Preparing Onboarding..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Rj.A,{className:"mr-2 h-4 w-4"}),"Complete Stripe Onboarding"]})})]})]})}var sq=s(37656);function aq(e){let{integrationInstance:t}=e;const[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!1),{toast:r}=Cb(),i=e=>{if(!e||!e.unit_amount)return"N/A";const t=e.unit_amount/100;return new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency||"USD"}).format(t)},o=async()=>{try{l(!0),await XW.refreshProductCatalog(t.id),r({title:"Success",description:"Product catalog refreshed successfully from Stripe",variant:"success"})}catch(e){r({variant:"destructive",title:"Error",description:"Failed to refresh product catalog from Stripe"})}finally{l(!1)}};return t.product_catalog&&0!==t.product_catalog.length?(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,se.jsx)("h3",{className:"text-lg font-medium",children:"Product Catalog"}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:o,disabled:n,children:n?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"mr-2 h-4 w-4"}),"Refresh Catalog"]})})]}),(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.product_catalog.map(e=>(0,se.jsx)(Es,{className:"overflow-hidden",children:(0,se.jsxs)("div",{className:"p-4",children:[(0,se.jsx)("h4",{className:"font-semibold",children:e.name}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.description||"No description"}),e.images&&e.images.length>0&&(0,se.jsx)("div",{className:"mt-2",children:(0,se.jsx)("img",{src:e.images[0],alt:e.name,className:"w-full h-32 object-cover rounded-md"})}),e.prices&&e.prices.length>0?(0,se.jsxs)("div",{className:"mt-3",children:[(0,se.jsx)("h5",{className:"text-sm font-medium mb-1",children:"Prices:"}),(0,se.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:e.prices.map(e=>(0,se.jsxs)("div",{className:"bg-muted/30 p-2 rounded-md text-xs",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"font-medium",children:i(e)}),(0,se.jsx)("span",{className:"text-muted-foreground",children:e.recurring?"".concat(e.recurring.interval_count," ").concat(e.recurring.interval):"One-time"})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,se.jsxs)("div",{className:"text-muted-foreground text-xs truncate",title:e.id,children:["ID: ",e.id.substring(0,10),"..."]}),(0,se.jsxs)(zt,{size:"sm",variant:"secondary",className:"h-6 text-xs px-2",onClick:()=>(async e=>{try{a(e);const s=await XW.createCheckoutSession(t.id,e);s.checkout_url&&window.open(s.checkout_url,"_blank")}catch(s){}finally{a(null)}})(e.id),disabled:s===e.id,children:[s===e.id?(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin mr-1"}):null,"Checkout"]})]})]},e.id))})]}):(0,se.jsx)("div",{className:"mt-2 text-xs text-muted-foreground italic",children:"No prices defined for this product"}),(0,se.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["ID: ",e.id]})]})},e.id))})]}):(0,se.jsxs)("div",{className:"text-center py-6 bg-muted/30 rounded-lg",children:[(0,se.jsx)("p",{className:"text-muted-foreground mb-4",children:"No products available."}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:o,disabled:n,children:n?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"mr-2 h-4 w-4"}),"Refresh Products from Stripe"]})}),(0,se.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"This will fetch the latest products and prices from your Stripe account."})]})}function nq(e){let{account:t,onContinue:s}=e;const[a,n]=(0,Y.useState)(!1),{toast:l}=Cb();return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Manage Your Product Catalog"}),(0,se.jsx)(Ps,{children:"Set up products and prices in Stripe to offer to your customers"})]}),(0,se.jsxs)(Ls,{className:"space-y-4",children:[(0,se.jsxs)(Dt,{children:[(0,se.jsx)(sq.A,{className:"h-4 w-4"}),(0,se.jsx)(Ft,{children:"Optional Step"}),(0,se.jsx)(Ot,{children:"Create products in the Stripe dashboard to offer one-time purchases or subscriptions to your customers. This step is optional, but recommended if you want to offer paid content."})]}),(0,se.jsxs)("div",{className:"p-4 bg-muted/20 rounded-lg",children:[(0,se.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Instructions"}),(0,se.jsxs)("ol",{className:"space-y-2 text-sm text-muted-foreground list-decimal pl-5",children:[(0,se.jsx)("li",{children:"Go to the Stripe Dashboard by clicking the button below"}),(0,se.jsx)("li",{children:'Navigate to "Products" in the sidebar'}),(0,se.jsx)("li",{children:"Create new products with appropriate pricing"}),(0,se.jsx)("li",{children:"For subscriptions, set up recurring prices with the desired interval"}),(0,se.jsx)("li",{children:"Return here and refresh your product catalog when complete"})]})]})]}),(0,se.jsxs)(Ms,{className:"flex justify-between",children:[(0,se.jsxs)(zt,{variant:"outline",onClick:()=>window.open("https://dashboard.stripe.com/account","_blank"),children:[(0,se.jsx)(Rj.A,{className:"mr-2 h-4 w-4"}),"Open Stripe Dashboard"]}),(0,se.jsx)(zt,{onClick:async()=>{n(!0);try{await XW.refreshProductCatalog(t.id),l({title:"Success",description:"Product catalog refreshed successfully",variant:"success"})}catch(e){l({variant:"destructive",title:"Error",description:"Failed to refresh product catalog"})}finally{n(!1)}},disabled:a,children:a?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"mr-2 h-4 w-4"}),"Refresh Product Catalog"]})})]})]}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Current Product Catalog"}),(0,se.jsx)(Ps,{children:"Products and prices available for your apps"})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)(aq,{integrationInstance:t})}),(0,se.jsx)(Ms,{className:"flex justify-end",children:(0,se.jsx)(zt,{onClick:s,children:"Continue to Next Step"})})]})]})}var lq=s(56150),rq=s(2999);function iq(){const e=(0,J.Zp)();return(0,se.jsxs)(Es,{children:[(0,se.jsx)(Ts,{children:(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(Is,{children:"Stripe Integration Complete"}),(0,se.jsx)(Ps,{children:"Your Stripe integration is ready to use with your apps"})]}),(0,se.jsx)("div",{className:"p-1.5 rounded-full bg-green-100",children:(0,se.jsx)(lq.A,{className:"h-5 w-5 text-green-600"})})]})}),(0,se.jsx)(Ls,{children:(0,se.jsxs)(ji,{defaultValue:"navigation",children:[(0,se.jsxs)(yi,{className:"grid w-full grid-cols-2",children:[(0,se.jsx)(Ni,{value:"navigation",children:"Navigation Instructions"}),(0,se.jsx)(Ni,{value:"code",children:"Code Integration"})]}),(0,se.jsxs)(wi,{value:"navigation",className:"space-y-4 mt-4",children:[(0,se.jsxs)("div",{className:"p-4 bg-muted/20 rounded-lg space-y-4",children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"How to Use Your Stripe Integration"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h4",{className:"text-sm font-medium",children:"1. Navigate to an App"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Go to your app dashboard and select the app you want to add payment functionality to."})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h4",{className:"text-sm font-medium",children:"2. Go to the Payments Tab"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:'Open the app editor and click on the "Payments" tab in the sidebar.'})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h4",{className:"text-sm font-medium",children:"3. Connect Your Stripe Account"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:'Click "Connect Payments" to link your Stripe account to the app.'})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h4",{className:"text-sm font-medium",children:"4. Use the Product Catalog"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Once connected, use your Stripe products and prices in the app through the Product Catalog interface."})]})]}),(0,se.jsx)("div",{className:"flex justify-end",children:(0,se.jsxs)(zt,{onClick:()=>e("/apps"),children:["Go to My Apps ",(0,se.jsx)(bs.A,{className:"ml-2 h-4 w-4"})]})})]}),(0,se.jsx)(wi,{value:"code",className:"space-y-4 mt-4",children:(0,se.jsxs)("div",{className:"p-4 bg-muted/20 rounded-lg space-y-4",children:[(0,se.jsx)("h3",{className:"text-sm font-medium",children:"Code Integration"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h4",{className:"text-sm font-medium",children:"Using the API"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Access your Stripe integration programmatically by making API calls to create checkout sessions, access product catalogs, or check purchase history."})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h4",{className:"text-sm font-medium",children:"Example: Create a Checkout Session"}),(0,se.jsx)("pre",{className:"p-3 bg-muted/40 rounded-md text-xs overflow-x-auto",children:(0,se.jsx)("code",{children:"// Example API call\nconst createCheckout = async (priceId) => {\n  try {\n    const response = await fetch('/api/integrations/stripe/{account_id}/create-checkout-session', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        price_id: priceId,\n        quantity: 1,\n        success_url: window.location.origin + '/success',\n        cancel_url: window.location.origin + '/cancel'\n      })\n    });\n    \n    const data = await response.json();\n    window.location.href = data.checkout_url;\n  } catch (error) {\n    console.error('Error creating checkout session:', error);\n  }\n}"})})]})]})})]})}),(0,se.jsxs)(Ms,{className:"flex justify-between",children:[(0,se.jsxs)(zt,{variant:"outline",onClick:()=>window.open("https://stripe.com/docs","_blank"),children:[(0,se.jsx)(rq.A,{className:"mr-2 h-4 w-4"}),"Stripe Documentation"]}),(0,se.jsxs)(zt,{variant:"outline",onClick:()=>window.open("https://dashboard.stripe.com","_blank"),children:[(0,se.jsx)(Jv.A,{className:"mr-2 h-4 w-4"}),"Stripe Dashboard"]})]})]})}function oq(e){let{currentStep:t,totalSteps:s}=e;return(0,se.jsx)("div",{className:"flex items-center justify-center my-6",children:(0,se.jsx)("div",{className:"flex items-center",children:Array.from({length:s}).map((e,a)=>(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsxs)("div",{className:"flex flex-col items-center",children:[(0,se.jsx)("div",{className:"rounded-full flex items-center justify-center h-8 w-8 ".concat(a<t?"bg-green-100 text-green-600":a===t?"bg-blue-100 text-blue-600 border border-blue-300":"bg-muted text-muted-foreground"),children:a<t?(0,se.jsx)(hb.A,{className:"h-5 w-5"}):a===t?(0,se.jsx)(Ba.A,{className:"h-5 w-5"}):(0,se.jsx)(ED.A,{className:"h-5 w-5"})}),(0,se.jsxs)("span",{className:"text-xs mt-1 font-medium",children:["Step ",a+1]})]}),a<s-1&&(0,se.jsx)("div",{className:"h-px w-8 ".concat(a<t?"bg-green-400":"bg-muted-foreground/30")})]},a))})})}function cq(e){let{account:t,onAccountDeleted:s}=e;const[a,n]=(0,Y.useState)(!1),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),{toast:c}=Cb();return(0,se.jsxs)(Es,{className:"border-destructive/20 bg-destructive/5",children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{className:"text-destructive",children:"Delete Stripe Integration"}),(0,se.jsx)(Ps,{children:"Permanently remove this Stripe integration from your account"})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:"Deleting this integration will remove all configuration and connection to your Stripe account. This action cannot be undone. Your Stripe account will remain intact but will no longer be connected to this platform."})}),(0,se.jsx)(Ms,{children:(0,se.jsxs)(ma,{open:l,onOpenChange:r,children:[(0,se.jsx)(xa,{asChild:!0,children:(0,se.jsxs)(zt,{variant:"destructive",children:[(0,se.jsx)(zy.A,{className:"mr-2 h-4 w-4"}),"Delete Integration"]})}),(0,se.jsxs)(fa,{children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:"Are you sure you want to delete this Stripe integration?"}),(0,se.jsx)(ya,{children:"This action cannot be undone. This will permanently delete the integration and remove its data from our servers."})]}),i&&(0,se.jsxs)(Dt,{variant:"destructive",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4"}),(0,se.jsx)(Ot,{children:i})]}),(0,se.jsxs)(ba,{children:[(0,se.jsx)(zt,{variant:"outline",onClick:()=>r(!1),disabled:a,children:"Cancel"}),(0,se.jsx)(zt,{variant:"destructive",onClick:async()=>{n(!0),o(null);try{await XW.deleteAccount(t.id),c({title:"Account Deleted",description:"Your Stripe integration has been successfully deleted.",variant:"success"}),r(!1),s&&s()}catch(i){var e,a;const s=(null===(e=i.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to delete Stripe account. Please try again.";o(s),c({variant:"destructive",title:"Error",description:"Failed to delete Stripe account"})}finally{n(!1)}},disabled:a,children:a?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete Integration"})]})]})]})})]})}function dq(){const{user:e}=wd(),[t,s]=(0,Y.useState)(!0),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(0),[i,o]=(0,Y.useState)(null),{toast:c}=Cb(),d=(0,J.Zp)();(0,Y.useEffect)(()=>{(async()=>{try{s(!0);const e=await XW.getAccount();e?(n(e),r(1)):r(0)}catch(i){o("Failed to load Stripe account information"),c({variant:"destructive",title:"Error",description:"Failed to load Stripe account information"})}finally{s(!1)}})()},[c]);const u=e=>{n(e),r(1)},m=()=>{r(2)},x=()=>{r(3)};if(!Uj(e,"builder"))return(0,se.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,se.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),(0,se.jsxs)(Dt,{children:[(0,se.jsx)(Ft,{children:"Subscription Required"}),(0,se.jsx)(Ot,{children:"Stripe integration is currently available only for Pro and Enterprise users. Please upgrade your subscription to access this feature."})]}),(0,se.jsx)("div",{className:"mt-4",children:(0,se.jsx)(zt,{onClick:()=>d("/billing"),children:"Upgrade Subscription"})})]});return t?(0,se.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,se.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),(0,se.jsx)("div",{className:"flex justify-center items-center p-12",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):i?(0,se.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,se.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),(0,se.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4 mb-4",children:(0,se.jsxs)("div",{className:"flex items-start",children:[(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-amber-500 mt-0.5 mr-3"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-amber-800",children:"Something went wrong"}),(0,se.jsxs)("p",{className:"text-sm text-amber-700 mt-1",children:[i,". Refreshing the page might help resolve this issue."]})]})]})}),(0,se.jsx)("div",{className:"mt-4",children:(0,se.jsx)(zt,{onClick:()=>window.location.reload(),children:"Refresh Page"})})]}):(0,se.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,se.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,se.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),l>0&&(0,se.jsxs)(zt,{variant:"outline",onClick:()=>r(Math.max(0,l-1)),children:[(0,se.jsx)(Vs.A,{className:"mr-2 h-4 w-4"}),"Back"]})]}),(0,se.jsx)(oq,{currentStep:l,totalSteps:4}),(()=>{switch(l){case 0:default:return(0,se.jsx)(eq,{onAccountCreated:u});case 1:return(0,se.jsx)(tq,{account:a,onAccountVerified:m});case 2:return(0,se.jsx)(nq,{account:a,onContinue:x});case 3:return(0,se.jsx)(iq,{})}})(),a&&(0,se.jsx)("div",{className:"mt-8",children:(0,se.jsx)(cq,{account:a,onAccountDeleted:()=>{n(null),r(0),c({title:"Account Deleted",description:"Your Stripe integration has been successfully removed.",variant:"success"})}})})]})}function uq(){return(0,se.jsx)("div",{className:"p-9",children:(0,se.jsx)(ZW,{children:"\n\n**Base44 Responsible Use Policy**\n\nLast Updated: March 23, 2025  \n\nThis Responsible Use Policy (\u201c**RUP**\u201d) supplements the Base44 Terms of Service, or any other agreement or order form between Base44, Inc. or its affiliates (\u201c**Base44**\u201d) and you, being any Customer or User thereof (\u201c**you**\u201d), governing the use of Base44\u2019s Platform, Website, the Generated Output or other products and services (each of the foregoing, together and separately, the \u201c**Agreement\u201d**). The RUP applies to your access and use of the Platform, Customer Data (including the Input Data you provide to the Platform and the Generated Output created on its basis), whether as part of your Platform or your use of Generated Output outside of it. Capitalized but undefined terms used in the RUP have the meanings set forth in your applicable Agreement with Base44.\n\nYou will not share with the Platform any Input Data that, nor knowingly use the Platform to generate any Generated Output or use or make available to others any Generated Output:\n\n1. That in any way violates any applicable national, federal, state, local or international law or regulation;\n2. Generating and distributing spam in violation of the CAN-SPAM Act of 2003 and other applicable laws;\n3. For the purpose of exploiting, harming or attempting to exploit or harm minors in any way;\n4. Contains pornographic, sexually explicit, or adult content;\n5. To generate or disseminate verifiably false, misleading or deceptive information and/or content (including with regard to medicine, health and science);\n6. To generate or disseminate personal identifiable information that can be used to harm an individual;\n7. To generate or disseminate information and/or content (e.g. images, code, posts, articles), and place the information and/or content in any context (e.g. bot generating tweets) without expressly and intelligibly disclaiming that the information and/or content is machine generated;\n8. To defame, disparage, cyber-bully or otherwise harass others, or encourage self-harm or harm to others;\n9. To impersonate or attempt to impersonate (e.g. deepfakes) others without their consent;\n10. For fully automated decision making that adversely impacts an individual\u2019s legal rights or otherwise creates or modifies a binding, enforceable obligation;\n11. For any use intended to or which has the effect of discriminating against or harming individuals or groups based on online or offline social behavior or known or predicted personal or personality characteristics, or in a manner that is obscene, violent, hateful, racist or discriminatory or is otherwise offensive;\n12. To exploit any of the vulnerabilities of a specific group of persons based on their age, social, physical or mental characteristics, in order to materially distort the behavior of a person pertaining to that group in a manner that causes or is likely to cause that person or another person physical or psychological harm;\n13. For any use intended to or which has the effect of discriminating against individuals or groups based on legally protected characteristics or categories;\n14. To engage in political lobbying or campaigns to actively influence the decisions of government officials, legislators, or regulatory agencies on legislative, regulatory, or policy matters;\n15. To provide medical advice and medical results interpretation, or promote pharmaceutical or medical products and services, without having the qualifications, licenses and permits required by applicable law;\n16. To engage in and promote regulated services and professions, and/or deliver any regulated products or services, including but not limited to legal and accounting services, investment advice, insurance, banking and securities, without having the qualifications, licenses and permits required by applicable law;\n17. To generate or disseminate information for the purpose to be used for administration of justice, law enforcement, immigration or asylum processes, such as predicting an individual will commit fraud/crime commitment (e.g. by text profiling, drawing causal relationships between assertions made in documents, indiscriminate and arbitrarily-targeted use);\n18. To infringe, violate or misappropriate any patent, trademark, trade secret, copyright, or other intellectual property or other proprietary rights of any other person;\n19. To transmit or otherwise makes available any malicious code, including any virus, worm, trojan horse, time bomb, web bug, spyware, or any other malicious or harmful computer code, library, file, or program;\n20. To circumvent the technical and other safeguards set out by Base44 or our Third- Party Service providers meant to ensure adherence with the RUP and such Third- Party Service providers' equivalent usage policies, as applicable.\n\nTo the extent the Platform or Generated Output generate Generated Output containing any of the above, you will notify us in writing without undue delay upon becoming aware of it.\n\nEnforcing the RUP, including the determination whether a violation occurred and determining its severity, is at Baser44\u2019s sole and complete discretion, and failure to enforce it in one instance does not constitute a waiver to enforce it in any other instances.\n\nYou will promptly cease use of any Customer Data, Input Data or Generated Output violating this RUP, and Base44 has the right to promptly remove or delete any violating Customer Data, remove violating Generated Output from the Platform and Website in its sole discretion or modify the Platform to ensure compliance with the RUP and applicable law.\n\n"})})}function mq(e){let{onLoadMore:t,hasMore:s=!0,isLoading:a=!1,threshold:n=.1}=e;const[l,r]=(0,Y.useState)(!1),i=(0,Y.useRef)(null),o=(0,Y.useRef)(null),c=(0,Y.useCallback)(()=>{s&&!a&&t&&t()},[s,a,t]);return(0,Y.useEffect)(()=>{const e=i.current;if(e)return o.current=new IntersectionObserver(e=>{const[t]=e;r(t.isIntersecting),t.isIntersecting&&s&&!a&&c()},{threshold:n,rootMargin:"50px"}),o.current.observe(e),()=>{o.current&&o.current.disconnect()}},[c,s,a,n]),{targetRef:i,isIntersecting:l,hasMore:s}}function xq(e){let{activeTab:t,onTabChange:s}=e;const a="\n        relative h-12 rounded-none border-0 bg-transparent px-3 sm:px-6 pb-3 pt-3 \n        font-base44 font-medium text-gray-600 shadow-none transition-colors hover:text-gray-900 \n        focus-visible:ring-0 focus-visible:ring-offset-0 \n        data-[state=active]:bg-transparent data-[state=active]:text-black data-[state=active]:shadow-none \n        data-[state=active]:after:absolute data-[state=active]:after:bottom-0 data-[state=active]:after:left-0 \n        data-[state=active]:after:right-0 data-[state=active]:after:h-0.5 data-[state=active]:after:bg-black \n        data-[state=active]:after:content-['']\n    ".trim().replace(/\s+/g," ");return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-base44 font-medium mb-4 mt-6",children:"Integrations"}),(0,se.jsx)("p",{className:"text-base sm:text-lg font-base44 mb-6",children:"Discover pre-built integrations that let you connect to APIs, services, and tools to extend your app's capabilities."}),(0,se.jsx)(Kj,{value:t,onValueChange:s,className:"mb-8",children:(0,se.jsxs)($j,{className:"h-auto w-full bg-transparent p-0 border-b border-gray-200 justify-start",children:[(0,se.jsx)(Zj,{value:"catalog",className:a,children:"Integrations Catalog"}),(0,se.jsx)(Zj,{value:"my-integrations",className:a,children:"My Integrations"})]})})]})}const hq=[{value:"most-upvoted",label:"Most Popular"},{value:"newest",label:"Newest first"},{value:"oldest",label:"Oldest first"}];function pq(e){let{searchTerm:t,onSearchChange:s,selectedCategory:a,onCategoryChange:n,sortBy:l,onSortByChange:r,privacyFilter:i,onPrivacyFilterChange:o,statusFilter:c,onStatusFilterChange:d,isAdmin:u}=e;const[m,x]=(0,Y.useState)(t),h=(0,Y.useCallback)(e=>setTimeout(()=>{s(e)},300),[s]);return(0,Y.useEffect)(()=>{const e=h(m);return()=>clearTimeout(e)},[m,h]),(0,Y.useEffect)(()=>{x(t)},[t]),(0,se.jsx)("div",{className:"mt-[42px] mb-6 font-base44",children:(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 w-full sm:justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center rounded-xl border border-[#E4E4E7] bg-white flex-1 sm:max-w-[420px] h-[40px] px-3 sm:px-[11px]",children:[(0,se.jsx)(na.A,{className:"w-4 h-4 text-[#000] flex-shrink-0"}),(0,se.jsx)(Df,{placeholder:"Search integrations...",value:m,onChange:e=>x(e.target.value),className:"border-0 bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 placeholder:text-[#B4B4B4] text-black"})]}),(0,se.jsx)("div",{className:"flex items-center gap-3 justify-end sm:justify-start",children:(0,se.jsxs)(Wf,{value:l,onValueChange:r,children:[(0,se.jsx)(Yf,{className:"w-auto min-w-[140px] h-[40px] font-base44 border-0 bg-transparent px-0 text-black focus-visible:ring-0 focus-visible:ring-offset-0 [&>svg]:text-black [&>svg]:ml-2",children:(0,se.jsx)(qf,{placeholder:"Sort by"})}),(0,se.jsx)($f,{children:hq.map(e=>(0,se.jsx)(Zf,{value:e.value,className:"font-base44",children:e.label},e.value))})]})})]})})}var gq=s(95445);const fq=e=>{var t,s;let{item:a,onSelect:n,isAdmin:l,currentUser:r}=e;const{item:i,usage:o}=a,c=(null==r?void 0:r.email)===i.owner_email,d=!("pending"===i.status&&!i.is_private)||l||c,u="\n    h-full overflow-hidden transition-all duration-200 \n    bg-white flex flex-col  rounded-[16px] font-base44 shadow-none border-0\n    ".concat(d?"hover:shadow-md cursor-pointer border-gray-100":"border-dashed border-gray-100 bg-slate-50 opacity-70 cursor-not-allowed","\n  ");return(0,se.jsxs)(Bv,{className:u,onClick:()=>{d&&n(i.id)},children:[(0,se.jsx)(zv,{className:"pb-1 px-4 pt-4",children:(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)(hg,{className:"h-12 w-12 flex-shrink-0 rounded-md",children:[(0,se.jsx)(pg,{src:i.image_url,alt:i.name,className:"object-contain"}),(0,se.jsx)(gg,{className:"bg-gradient-to-br from-blue-100 to-teal-100 text-teal-700 text-sm font-medium",children:(null===(t=i.name)||void 0===t||null===(s=t.charAt(0))||void 0===s?void 0:s.toUpperCase())||"I"})]}),(0,se.jsxs)("div",{className:"w-full",children:[(0,se.jsx)(Hv,{className:"text-[16px] font-regular",children:i.name}),(0,se.jsxs)("div",{className:"flex gap-1.5 flex-wrap",children:[i.official&&(0,se.jsxs)(gk,{variant:"outline",className:"bg-blue-50 px-1.5 py-0 h-5 font-normal",children:[(0,se.jsx)(gq.A,{className:"h-3 w-3 mr-0.5"}),(0,se.jsx)("span",{className:"text-xs",children:"Official"})]}),i.is_private&&(0,se.jsxs)(gk,{variant:"outline",className:"bg-slate-100 text-slate-700 border-slate-200 px-1.5 py-0 h-5 font-normal",children:[(0,se.jsx)(Vc.A,{className:"h-3 w-3 mr-0.5"}),(0,se.jsx)("span",{className:"text-xs",children:"Private"})]}),"pending"===i.status&&!i.is_private&&(0,se.jsxs)(gk,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200 px-1.5 py-0 h-5 font-normal",children:[(0,se.jsx)(jS.A,{className:"h-3 w-3 mr-0.5"}),(0,se.jsx)("span",{className:"text-xs",children:"Pending Review"})]})]})]})]})}),(0,se.jsx)(Wv,{className:"pb-3 px-4 flex-1",children:(0,se.jsx)("div",{className:" overflow-hidden",children:(0,se.jsx)("p",{className:"text-sm font-light line-clamp-3 text-[#3C444C]",children:i.description||"No description provided."})})}),(0,se.jsx)(qv,{className:"px-4 py-2 flex mt-auto",children:(0,se.jsx)("div",{className:"flex gap-1 text-sm",children:(0,se.jsxs)("span",{className:"font-light font-base44 text-[#3C444C]",children:[o||0," installs"]})})})]})},vq=()=>(0,se.jsxs)(Bv,{className:"h-full overflow-hidden bg-white flex flex-col rounded-[16px] font-base44 shadow-none border-0 border-gray-100 animate-pulse",children:[(0,se.jsx)(zv,{className:"pb-1 px-4 pt-4",children:(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)("div",{className:"h-12 w-12 flex-shrink-0 rounded-md bg-slate-200"}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)("div",{className:"h-5 bg-slate-200 rounded w-3/4 mb-2"})})]})}),(0,se.jsx)(Wv,{className:"pb-3 px-4 flex-1",children:(0,se.jsx)("div",{className:"overflow-hidden",children:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("div",{className:"h-4 bg-slate-200 rounded w-full"}),(0,se.jsx)("div",{className:"h-4 bg-slate-200 rounded w-5/6"}),(0,se.jsx)("div",{className:"h-4 bg-slate-200 rounded w-4/6"})]})})}),(0,se.jsx)(qv,{className:"px-4 py-2 flex mt-auto",children:(0,se.jsx)("div",{className:"h-4 bg-slate-200 rounded w-20"})})]}),bq=e=>{let{count:t=12}=e;return(0,se.jsx)("div",{className:"space-y-6",children:(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 2xl:grid-cols-4 gap-5",children:Array.from({length:t}).map((e,t)=>(0,se.jsx)(vq,{},"skeleton-".concat(t)))})})},jq=()=>(0,se.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg px-4 py-3 flex items-center gap-3 w-fit",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-slate-700 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-slate-800 text-sm",children:"Custom integration support will be removed on March 1."})]}),yq=e=>{let{isLoading:t,isLoadingMore:s,items:a,onCardClick:n,hasMore:l,targetRef:r,isAdmin:i,onCreateIntegration:o,activeTab:c,currentUser:d}=e;if(t)return(0,se.jsx)(bq,{});if(0===a.length)return"my-integrations"===c?(0,se.jsxs)("div",{className:"space-y-4 pb-6",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-medium text-slate-900",children:"Custom Integrations"}),(0,se.jsx)("p",{className:"text-[16px] text-slate-600 font-light",children:"Requires API key configuration and custom prompts"})]}),(0,se.jsx)(jq,{})]}):(0,se.jsxs)("div",{className:"text-center p-12 border rounded-lg bg-slate-50",children:[(0,se.jsx)("div",{className:"text-slate-400 mb-3",children:(0,se.jsx)(na.A,{className:"h-12 w-12 mx-auto"})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-700 mb-1",children:"No matching integrations found"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"Try adjusting your search or filter settings."})]});return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-medium text-slate-900",children:"Custom Integrations"}),(0,se.jsx)("p",{className:"text-[16px] text-slate-600 font-light",children:"Requires API key configuration and custom prompts"})]}),(0,se.jsx)(jq,{})]}),(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 2xl:grid-cols-4 gap-5",children:a.map(e=>(0,se.jsx)(fq,{item:e,onSelect:n,isAdmin:i,currentUser:d},e.item.id))}),s&&(0,se.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,se.jsx)(Ac.A,{className:"h-6 w-6 text-teal-600 animate-spin mr-2"}),(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"Loading more integrations..."})]}),l&&!s&&(0,se.jsx)("div",{ref:r,className:"h-1"}),!l&&a.length>0&&(0,se.jsx)("div",{className:"text-center py-8 text-sm text-slate-500",children:"You've reached the end of the integrations catalog"})]})},Nq=e=>{var t,s,a,n;let{connector:l}=e;const[r,i]=(0,Y.useState)(!1),{user:o}=wd(),c=Uj(o,"builder"),d="coming-soon"!==l.status;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Bv,{className:de("h-full overflow-hidden","bg-gradient-to-br from-white to-slate-50/30 flex flex-col rounded-[16px] font-base44","border border-slate-200/60",!d&&"opacity-60"),children:[(0,se.jsx)(zv,{className:"pb-1 px-5 pt-5",children:(0,se.jsxs)("div",{className:"flex flex-col items-start gap-3",children:[l.icon?(0,se.jsx)("div",{className:"h-14 w-14 flex-shrink-0 rounded-xl border-2 border-white shadow-sm bg-white flex items-center justify-center p-2",children:(0,se.jsx)(l.icon,{className:"w-full h-full"})}):(0,se.jsxs)(hg,{className:"h-14 w-14 flex-shrink-0 rounded-xl border-2 border-white shadow-sm",children:[(0,se.jsx)(pg,{src:l.image_url,alt:l.name,className:"object-contain p-2"}),(0,se.jsx)(gg,{className:"bg-gradient-to-br from-teal-100 to-orange-100 text-teal-700 text-lg font-medium rounded-xl",children:(null===(t=l.name)||void 0===t||null===(s=t.charAt(0))||void 0===s?void 0:s.toUpperCase())||"C"})]}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(Hv,{className:"text-[17px] font-medium text-slate-900 mb-0",children:l.name})})]})}),(0,se.jsx)(Wv,{className:"pb-1 px-5 pt-0 flex-1",children:(0,se.jsx)("p",{className:"text-sm font-light leading-relaxed text-slate-600 line-clamp-2",children:l.subtitle})}),(0,se.jsx)(qv,{className:"px-5 py-3 mt-auto",children:(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),i(!0)},className:"w-full font-normal",children:"How to use"})})]}),(0,se.jsx)(Og,{open:r,onOpenChange:i,children:(0,se.jsxs)(Hg,{className:"w-[95vw] sm:w-[90vw] max-w-[600px] max-h-[80vh] overflow-y-auto font-base44",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[l.icon?(0,se.jsx)("div",{className:"h-24 w-24 rounded-lg border-2 border-white shadow-sm bg-white flex items-center justify-center p-4",children:(0,se.jsx)(l.icon,{className:"w-full h-full"})}):(0,se.jsxs)(hg,{className:"h-24 w-24 rounded-lg",children:[(0,se.jsx)(pg,{src:l.image_url,alt:l.name,className:"object-contain p-2"}),(0,se.jsx)(gg,{className:"bg-gradient-to-br from-teal-100 to-orange-100 text-teal-700 rounded-lg",children:(null===(a=l.name)||void 0===a||null===(n=a.charAt(0))||void 0===n?void 0:n.toUpperCase())||"C"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)(qg,{className:"text-xl",children:l.name}),(0,se.jsx)(Yg,{className:"text-sm mt-1",children:l.subtitle||l.description})]})]})}),(0,se.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900",children:"Get started"}),(0,se.jsx)("div",{className:"space-y-2",children:(0,se.jsx)("div",{className:"bg-gray-100 rounded-lg p-3",children:(0,se.jsxs)("p",{className:"text-sm text-slate-700 leading-relaxed",children:["Navigate to your app's Integrations tab to connect ",l.name," and get personalized prompts."]})})})]}),!c&&(0,se.jsx)("div",{className:"border-t pt-4",children:(0,se.jsx)("div",{className:"flex items-start gap-2",style:{borderRadius:"8px",background:"linear-gradient(92deg, rgba(255, 176, 137, 0.35) 0.9%, rgba(255, 211, 130, 0.24) 99.3%), linear-gradient(0deg, #FFF 0%, #FFF 100%), linear-gradient(90deg, #FAFAF9 0%, #F5F5F4 100%)",padding:"12px 16px",alignSelf:"stretch"},children:(0,se.jsxs)("p",{className:"text-sm text-slate-700 leading-relaxed",children:["This integration requires backend functions, a feature available only on Builder tier and above."," ",(0,se.jsx)("a",{href:"/billing",target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:text-orange-700 font-medium underline underline-offset-2",children:"See Plans"})]})})})]})]})})]})},wq=()=>(0,se.jsxs)("div",{className:"mb-12 font-base44",children:[(0,se.jsx)("div",{className:"flex items-center gap-3 mb-6",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-medium text-slate-900",children:"Connectors"}),(0,se.jsx)("p",{className:"text-[16px] text-slate-600 font-light",children:"Quick OAuth connections to popular services, supported by Base44."})]})}),(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 2xl:grid-cols-4 gap-5",children:EE.map(e=>(0,se.jsx)(Nq,{connector:e},e.id))})]});const _q=function(){const{user:e}=wd(),t=(0,Y.useRef)(0),[s,a]=(0,Y.useState)("catalog"),[n,l]=(0,Y.useState)([]),[r,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)("all"),[m,x]=(0,Y.useState)("most-upvoted"),[h,p]=(0,Y.useState)("all"),[g,f]=(0,Y.useState)("all"),[v,b]=(0,Y.useState)(new Set),j=(0,J.Zp)(),[y,N]=(0,Y.useState)(!0),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)(0),[A]=(0,Y.useState)(20),[S,E]=(0,Y.useState)(0),T=$p(null==e?void 0:e.platform_role),I=e=>{switch(e){case"newest":return"-created_date";case"oldest":return"created_date";default:return"-usage"}},P=(0,Y.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const a=++t.current;try{e?_(!0):(i(!0),E(0));const n=(()=>{const e={};return o.trim()&&(e.$or=[{name:{$regex:o.trim(),$options:"i"}},{description:{$regex:o.trim(),$options:"i"}},{created_by:{$regex:o.trim(),$options:"i"}}]),"all"!==d&&(e.categories=d),T&&("private"===h?e.is_private=!0:"public"===h&&(e.is_private=!1),"pending"===g?e.status="pending":"approved"===g&&(e.status="approved")),e})(),r=e?S:0,c="my-integrations"===s?await Yp.listMyItems((0,ue.A)((0,ue.A)({},n),{},{limit:A,skip:r,sort_by:I(m)})):await Yp.listCatalogItems((0,ue.A)((0,ue.A)({},n),{},{limit:A,skip:r,sort_by:I(m)}));if(a!==t.current)return;const u=c.data||c||[];e?(l(e=>[...e,...u]),E(e=>e+A)):(l(u),E(A)),N(u.length===A),C(t=>e?t+u.length:u.length);const x=new Set(u.filter(e=>e.did_current_user_upvote).map(e=>e.item.id));b(e?e=>new Set([...Array.from(e),...Array.from(x)]):x)}catch(n){if(a!==t.current)return;so({title:"Error",description:"Failed to load integrations",variant:"destructive"}),e||l([])}finally{a===t.current&&(i(!1),_(!1))}},[s,m,h,g,o,d,T,S,A,null==e?void 0:e.email]);(0,Y.useEffect)(()=>{P()},[]),(0,Y.useEffect)(()=>{P(!1)},[s,o,d,m,h,g]);const{targetRef:L}=mq({onLoadMore:()=>{y&&!w&&P(!0)},hasMore:y,isLoading:r||w}),M=n.length,R=k>0?"Showing ".concat(M," of ").concat(k," integrations"):"";return(0,se.jsxs)("div",{className:"px-4 sm:px-6 md:px-8 lg:px-12 max-w-[1600px] mx-auto",children:[(0,se.jsx)(xq,{activeTab:s,onTabChange:e=>{e!==s&&(l([]),i(!0),a(e),E(0),N(!0),C(0))}}),(0,se.jsx)(pq,{searchTerm:o,onSearchChange:e=>{c(e)},selectedCategory:d,onCategoryChange:e=>{u(e)},sortBy:m,onSortByChange:e=>{x(e)},privacyFilter:h,onPrivacyFilterChange:e=>{p(e)},statusFilter:g,onStatusFilterChange:e=>{f(e)},totalItems:k,displayedItems:M,showingText:R,isLoading:r,isAdmin:T}),(0,se.jsx)(wq,{}),(0,se.jsx)(yq,{isLoading:r,isLoadingMore:w,items:n,onCardClick:e=>{j("/integrations-catalog/item/".concat(e))},hasMore:y,targetRef:L,isAdmin:T,onCreateIntegration:()=>{j("/integrations-catalog/editor")},activeTab:s})]})},kq=()=>(0,se.jsx)("div",{className:"min-h-screen bg-white font-base44 animate-pulse",children:(0,se.jsxs)("div",{className:"mx-auto",children:[(0,se.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4",children:(0,se.jsxs)("nav",{className:"flex items-center space-x-2 text-sm",children:[(0,se.jsx)("div",{className:"h-4 w-20 bg-slate-200 rounded"}),(0,se.jsx)("span",{children:"/"}),(0,se.jsx)("div",{className:"h-4 w-32 bg-slate-200 rounded"})]})}),(0,se.jsx)("div",{className:"border-b border-slate-200"}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row max-w-7xl mx-auto gap-6 lg:gap-8 p-4 sm:p-6",children:[(0,se.jsx)("div",{className:"w-full lg:w-80 lg:flex-shrink-0",children:(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("div",{className:"flex gap-4 items-start mb-4",children:(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsx)("div",{className:"h-16 w-16 rounded-xl bg-slate-200"}),(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"h-6 w-40 bg-slate-200 rounded mb-2 mx-auto"}),(0,se.jsx)("div",{className:"h-4 w-16 bg-slate-200 rounded mx-auto"})]})]})}),(0,se.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-16 bg-slate-200 rounded"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-24 bg-slate-200 rounded"})]})]}),(0,se.jsx)("div",{className:"w-full lg:w-[280px] h-12 bg-slate-200 rounded-[16px] mb-4"}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"h-4 w-12 bg-slate-200 rounded mb-2"}),(0,se.jsx)("div",{className:"h-4 w-28 bg-slate-200 rounded"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded mb-1"}),(0,se.jsx)("div",{className:"h-4 w-3/4 bg-slate-200 rounded"})]})]}),(0,se.jsx)("div",{className:"h-px w-full bg-slate-200 my-6"}),(0,se.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,se.jsx)("div",{className:"h-4 w-36 bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,se.jsx)("div",{className:"h-4 w-32 bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"})]})]})]})}),(0,se.jsxs)("div",{className:"flex-1 border border-slate-200 p-6 rounded-[20px] min-w-0",children:[(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("div",{className:"h-6 sm:h-8 w-28 bg-slate-200 rounded mb-4"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-3/4 bg-slate-200 rounded"})]})]}),(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("div",{className:"h-6 w-40 bg-slate-200 rounded mb-4"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:(0,se.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"})}),(0,se.jsx)("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:(0,se.jsx)("div",{className:"h-4 w-5/6 bg-slate-200 rounded"})}),(0,se.jsx)("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:(0,se.jsx)("div",{className:"h-4 w-4/5 bg-slate-200 rounded"})})]})]}),(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsxs)("div",{className:"bg-slate-100 p-1 mb-6 rounded-md flex gap-1",children:[(0,se.jsx)("div",{className:"h-8 w-24 bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-8 w-32 bg-slate-200 rounded"})]}),(0,se.jsx)("div",{className:"space-y-4",children:(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,se.jsx)("div",{className:"h-5 w-32 bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-24 bg-slate-200 rounded"})]}),(0,se.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded mb-4"}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"bg-slate-100 rounded-lg p-4 border border-slate-200",children:[(0,se.jsx)("div",{className:"h-5 w-24 bg-slate-200 rounded mb-2"}),(0,se.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"})]}),(0,se.jsxs)("div",{className:"bg-slate-100 rounded-lg p-4 border border-slate-200",children:[(0,se.jsx)("div",{className:"h-5 w-32 bg-slate-200 rounded mb-2"}),(0,se.jsx)("div",{className:"h-4 w-5/6 bg-slate-200 rounded"})]})]})]})})]}),(0,se.jsx)("div",{className:"mb-8 p-4 bg-slate-100 border border-slate-200 rounded-lg",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"h-8 w-8 rounded-full bg-slate-200 flex-shrink-0"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"h-5 w-28 bg-slate-200 rounded mb-2"}),(0,se.jsx)("div",{className:"h-9 w-36 bg-slate-200 rounded"})]})]})})]})]}),(0,se.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 pb-8",children:(0,se.jsxs)("div",{className:"bg-slate-100 rounded-2xl border border-slate-200 p-6",children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsx)("div",{className:"h-6 w-48 bg-slate-200 rounded mb-2"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"}),(0,se.jsx)("div",{className:"h-4 w-2/3 bg-slate-200 rounded"})]})]}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[(0,se.jsx)("div",{className:"h-10 w-36 bg-slate-200 rounded-xl"}),(0,se.jsx)("div",{className:"h-10 w-28 bg-slate-200 rounded-xl"}),(0,se.jsx)("div",{className:"h-10 w-32 bg-slate-200 rounded-xl"}),(0,se.jsx)("div",{className:"h-10 w-20 bg-slate-200 rounded-xl"})]})]})})]})}),Cq=()=>{var e;const{itemId:t}=(0,J.g)(),s=(0,J.Zp)(),{user:a}=wd(),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)("details"),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(""),[_,k]=(0,Y.useState)(!1),C=$p(null==a?void 0:a.platform_role),A=a&&("free"===a.subscription_tier||"starter"===a.subscription_tier);(0,Y.useEffect)(()=>{t&&S()},[t]);const S=async()=>{if(t)try{i(!0);const e=await Yp.getCatalogItem(t);l(e.data||e),i(!1)}catch(e){c("Failed to load item details"),i(!1)}};if(r)return(0,se.jsx)(kq,{});if(o)return(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[500px] text-center p-4",children:[(0,se.jsxs)("div",{className:"text-red-500 text-xl font-semibold mb-2",children:["\u26a0\ufe0f ",o]}),(0,se.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",onClick:S,children:"Try Again"})]});if(!n)return null;const{item:E,is_user_the_owner:T}=n,I="approved"!==E.status,P=E.required_secrets&&E.required_secrets.length>0,L=E.requires_backend_functions&&A;return(0,se.jsx)("div",{className:"min-h-screen bg-white font-base44",children:(0,se.jsxs)("div",{className:"mx-auto",children:[(0,se.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4",children:(0,se.jsxs)("nav",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[(0,se.jsx)("button",{onClick:()=>{s("/integrations-catalog")},className:"hover:text-slate-900 transition-colors",children:"Integrations"}),(0,se.jsx)("span",{children:"/"}),(0,se.jsx)("span",{className:"text-slate-900 font-medium",children:E.name})]})}),(0,se.jsx)("div",{className:"border-b border-slate-200"}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row max-w-7xl mx-auto gap-6 lg:gap-8 p-4 sm:p-6",children:[(0,se.jsx)("div",{className:"w-full lg:w-80 lg:flex-shrink-0",children:(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("div",{className:"flex gap-4 items-start mb-4",children:(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsx)("div",{className:"h-16 w-16 rounded-xl overflow-hidden bg-white",children:E.image_url?(0,se.jsx)(Cg,{src:E.image_url,alt:E.name,className:"h-full w-full",objectFit:"contain",quality:85,lazy:!1}):(0,se.jsx)("div",{className:"h-full w-full bg-slate-50 flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-slate-600 text-lg font-semibold",children:E.name.charAt(0).toUpperCase()})})}),(0,se.jsx)("div",{className:"text-center",children:(0,se.jsx)("h1",{className:"text-lg sm:text-xl font-semibold break-words",children:E.name})}),E.official&&(0,se.jsxs)("div",{className:"flex items-center gap-1 mt-2",children:[(0,se.jsx)(gq.A,{className:"h-4 w-4 text-blue-600"}),(0,se.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"Official"})]})]})}),(0,se.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,se.jsx)(KP.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:E.is_private?"Private":"Public"})]}),E.created_at&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,se.jsx)(jS.A,{className:"h-4 w-4"}),(0,se.jsxs)("span",{children:["Added ",He().utc(E.created_at).fromNow()]})]})]}),L?(0,se.jsx)(Bx,{size:"lg",className:"w-full lg:w-[280px] bg-slate-200 text-slate-500 cursor-not-allowed mb-4 text-md rounded-[16px]",disabled:!0,children:"Use this integration"}):(0,se.jsx)(Bx,{onClick:()=>{s("/?integrations=".concat(t))},size:"lg",className:"w-full lg:w-[280px] bg-orange-500 hover:bg-orange-600 text-white mb-4 text-md rounded-[16px]",children:"Use this integration"}),L&&(0,se.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-3 mb-4",children:(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),(0,se.jsx)("p",{className:"text-sm text-amber-800",children:"This integration requires backend functions, a feature available only on Builder tier and above."})]})}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900",children:"Status"}),"approved"===E.status?(0,se.jsxs)(gk,{className:"bg-green-100 text-green-800 hover:bg-green-200",children:[(0,se.jsx)(sd.A,{className:"h-3 w-3 mr-1"}),"Approved"]}):(0,se.jsx)(gk,{className:"bg-amber-100 text-amber-800 hover:bg-amber-200",children:"Pending Approval"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-900 mb-3",children:"Share this integration"}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5 p-1.5 bg-slate-50 rounded-md border border-slate-200",children:[(0,se.jsx)("div",{className:"flex-1 text-xs text-slate-600 truncate font-mono",children:window.location.href}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-slate-200",onClick:async()=>{try{f(!0);const e=window.location.href;await navigator.clipboard.writeText(e),so({title:"Link copied",description:"Integration link has been copied to clipboard"}),setTimeout(()=>f(!1),1e3)}catch(e){so({title:"Error",description:"Failed to copy link to clipboard",variant:"destructive"}),f(!1)}},disabled:g,title:g?"Copied!":"Copy link",children:g?(0,se.jsx)(Ds.A,{className:"h-3.5 w-3.5 text-green-600"}):(0,se.jsx)(ob.A,{className:"h-3.5 w-3.5 text-slate-500"})})]})]}),E.requires_backend_functions&&(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-600 break-words",children:"Using this integration will automatically activate backend functions."}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mt-1 break-words",children:"Available on the Builder tier and above."})]})]}),(0,se.jsx)(ly,{className:"my-6 bg-gray-400"}),P&&(0,se.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,se.jsxs)("button",{className:"flex items-center justify-between w-full text-sm text-slate-600 hover:text-slate-900",children:[(0,se.jsx)("span",{children:"How to get your API key"}),(0,se.jsx)("span",{children:"\u2197"})]}),(0,se.jsxs)("button",{className:"flex items-center justify-between w-full text-sm text-slate-600 hover:text-slate-900",onClick:()=>s("/support"),children:[(0,se.jsx)("span",{children:"Base44 support hub"}),(0,se.jsx)("span",{children:"\u2197"})]})]})]})}),(0,se.jsxs)("div",{className:"flex-1 border border-slate-200 p-6 rounded-[20px] min-w-0",children:[(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-4",children:"Overview"}),(0,se.jsx)("p",{className:"text-slate-600 text-base leading-relaxed break-words",children:E.description})]}),E.example_asks&&E.example_asks.length>0&&(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Example prompts"}),(0,se.jsx)("div",{className:"space-y-2",children:E.example_asks.map((e,t)=>(0,se.jsx)("div",{className:"bg-slate-50 rounded-lg px-4 py-3 text-sm text-slate-700 break-words",children:e},t))})]}),(P||E.prompt)&&(0,se.jsx)("div",{className:"mb-8",children:(0,se.jsxs)(Kj,{defaultValue:P?"requirements":"instructions",className:"w-full",children:[(0,se.jsxs)($j,{className:"bg-slate-50 p-1 mb-6",children:[P&&(0,se.jsx)(Zj,{value:"requirements",className:"text-sm data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Requirements"}),E.prompt&&(0,se.jsx)(Zj,{value:"instructions",className:"text-sm data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Instructions Set"})]}),P&&(0,se.jsx)(Jj,{value:"requirements",children:(0,se.jsx)("div",{className:"space-y-4",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,se.jsx)("h4",{className:"font-semibold text-slate-900",children:"Required API Keys"})}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"You'll need these credentials to use this integration:"}),(0,se.jsx)("div",{className:"space-y-3",children:null===(e=E.required_secrets)||void 0===e?void 0:e.map((e,t)=>(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[(0,se.jsx)("h5",{className:"font-medium text-slate-900 mb-2 break-words",children:e.name}),(0,se.jsx)("p",{className:"text-sm text-slate-600 break-words",children:e.description||"Required for this integration to work properly."})]},t))})]})})}),E.prompt&&(0,se.jsx)(Jj,{value:"instructions",children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("div",{children:(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"These instructions will be injected into Base44's AI when this integration is used"})}),(0,se.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(ib.A,{className:"h-4 w-4 text-blue-600 flex-shrink-0 mt-0.5"}),(0,se.jsx)("div",{children:(0,se.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,se.jsx)("span",{className:"font-medium",children:"How this works:"})," When you use this integration, these instructions are automatically injected into Base44's AI system, enabling it to perform the specific tasks defined here."]})})]})}),(0,se.jsx)("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200 overflow-auto max-h-[500px]",children:(0,se.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-slate-700 font-mono break-words overflow-hidden",children:E.prompt})})]})})]})}),C&&I&&(0,se.jsx)("div",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:(0,se.jsx)(Yc.A,{className:"h-4 w-4 text-blue-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900",children:"Admin Actions"}),(0,se.jsx)("div",{className:"mt-2",children:(0,se.jsxs)(Bx,{onClick:async()=>{if(t)try{x(!0),await Yp.approveItem(t),so({title:"Success",description:"Integration has been approved"}),S()}catch(e){so({title:"Error",description:"Failed to approve integration",variant:"destructive"})}finally{x(!1)}},disabled:m,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,se.jsx)(sd.A,{className:"h-4 w-4 mr-1.5"}),m?"Approving...":"Approve Integration"]})})]})]})})]})]}),T&&(0,se.jsx)(se.Fragment,{children:(0,se.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 pb-8",children:(0,se.jsxs)("div",{className:"bg-slate-50 rounded-2xl border border-slate-200 p-6",children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Integration Management"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"As the owner of this integration, you can manage its settings and visibility."})]}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[(0,se.jsxs)(Bx,{variant:"outline",size:"default",onClick:()=>{s("/integrations-catalog/editor/".concat(t))},className:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50 rounded-xl px-6",children:[(0,se.jsx)(Qv.A,{className:"h-4 w-4 mr-2"}),"Edit Integration"]}),(0,se.jsx)(Bx,{variant:"outline",size:"default",onClick:async()=>{if(t&&n)try{y(!0),await Yp.update(t,{is_private:!n.item.is_private}),so({title:"Success",description:n.item.is_private?"Integration is now public":"Integration is now private"}),S()}catch(e){so({title:"Error",description:"Failed to update integration privacy setting",variant:"destructive"})}finally{y(!1)}},disabled:j,className:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50 rounded-xl px-6",children:j?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"h-4 w-4 mr-2 animate-spin rounded-full border-2 border-slate-400 border-t-transparent"}),"Updating..."]}):E.is_private?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(KP.A,{className:"h-4 w-4 mr-2"}),"Make Public"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Vc.A,{className:"h-4 w-4 mr-2"}),"Make Private"]})}),(0,se.jsxs)(Og,{open:_,onOpenChange:k,children:[(0,se.jsx)(Ug,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"outline",size:"default",className:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50 rounded-xl px-6",children:[(0,se.jsx)(BO.A,{className:"h-4 w-4 mr-2"}),"Invite Admin"]})}),(0,se.jsxs)(Hg,{className:"sm:max-w-[425px]",children:[(0,se.jsxs)(Vg,{children:[(0,se.jsx)(qg,{children:"Invite User"}),(0,se.jsx)(Yg,{children:"Invite a user to edit and administer this catalog item"})]}),(0,se.jsx)("div",{className:"grid gap-4 py-4",children:(0,se.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,se.jsx)(aN,{htmlFor:"email",className:"text-right",children:"Email"}),(0,se.jsx)(Df,{id:"email",type:"email",placeholder:"user@example.com",className:"col-span-3",value:N,onChange:e=>w(e.target.value)})]})}),(0,se.jsx)(Wg,{children:(0,se.jsx)(Bx,{onClick:async()=>{if(t&&N&&N.includes("@"))try{b(!0),await Yp.inviteAdmin(t,N),so({title:"Success",description:"Invitation sent to ".concat(N)}),w(""),k(!1)}catch(e){so({title:"Error",description:"Failed to send invitation",variant:"destructive"})}finally{b(!1)}else so({title:"Invalid email",description:"Please enter a valid email address",variant:"destructive"})},disabled:v||!N,className:"bg-slate-900 hover:bg-slate-800 text-white",children:v?"Sending...":"Send Invitation"})})]})]}),(0,se.jsxs)(Bx,{variant:"outline",size:"default",onClick:async()=>{if(t)try{p(!0),await Yp.archiveItem(t),so({title:"Success",description:"Integration has been archived"}),s("/integrations-catalog")}catch(e){so({title:"Error",description:"Failed to archive integration",variant:"destructive"}),p(!1)}},disabled:h,className:"bg-white text-red-600 border-red-200 hover:bg-red-50 rounded-xl px-6",children:[(0,se.jsx)(tB.A,{className:"h-4 w-4 mr-2"}),h?"Archiving...":"Archive"]})]})]})})})]})})};var Aq=s(23198),Sq=s(13052);const Eq=e=>{let{children:t}=e;return(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{delayDuration:300,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Pj.A,{className:"h-4 w-4 text-slate-400 ml-1.5 cursor-help"})}),(0,se.jsx)(pp,{className:"max-w-xs p-3 text-xs",children:t})]})})},Tq=()=>{const{itemId:e}=(0,J.g)(),t=(0,J.Zp)(),{toast:s}=ao(),a=!!e,[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!!e),[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)({name:"",description:"",prompt:"",image_url:"",example_asks:[],required_secrets:[],requires_backend_functions:!0,is_private:!1}),[g,f]=(0,Y.useState)("metadata"),[v,b]=(0,Y.useState)(""),[j,y]=(0,Y.useState)(""),[N,w]=(0,Y.useState)("");(0,Y.useEffect)(()=>{e?(async()=>{if(e)try{i(!0);const t=await Yp.getCatalogItem(e),s=t.data||t;l(s);const a=s.item;p({name:a.name||"",description:a.description||"",prompt:a.prompt||"",image_url:a.image_url||"",example_asks:a.example_asks||[],required_secrets:a.required_secrets||[],requires_backend_functions:!1!==a.requires_backend_functions,is_private:a.is_private||!1})}catch(t){x("Failed to load integration. It may have been deleted or you may not have permission to view it.")}finally{i(!1)}})():i(!1)},[e]);const _=e=>{const{name:t,value:s}=e.target;p(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:s}))},k=(e,t)=>{p(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))},C=async n=>{if(n&&n.preventDefault(),h.name.trim()?h.description.trim()?!(h.prompt.trim().length<50&&(s({title:"Validation Error",description:"Integration prompt must be at least 50 characters",variant:"destructive"}),f("content"),1)):(s({title:"Validation Error",description:"Integration description is required",variant:"destructive"}),f("metadata"),0):(s({title:"Validation Error",description:"Integration name is required",variant:"destructive"}),f("metadata"),0)){c(!0),x(null);try{let n;if(a&&e)await Yp.update(e,h),n=e;else{var l;const e=await Yp.create(h);n=(null===(l=e.data)||void 0===l?void 0:l.id)||e.id}s({title:"Success",description:a?"Integration updated successfully":"Integration created successfully"}),t("/integrations-catalog/item/".concat(n))}catch(r){x("Failed to save integration. Please try again."),s({title:"Error",description:"Failed to save integration. Please try again.",variant:"destructive"}),c(!1)}}},A=()=>{t("/integrations-catalog")};return r?(0,se.jsxs)("div",{className:"flex items-center justify-center h-[80vh]",children:[(0,se.jsx)(Ac.A,{className:"h-8 w-8 text-teal-600 animate-spin"}),(0,se.jsx)("span",{className:"ml-2 text-lg text-slate-700",children:"Loading integration..."})]}):m&&e&&!h.name?(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center h-[80vh]",children:[(0,se.jsx)("div",{className:"text-red-500 text-lg mb-4",children:m}),(0,se.jsx)(Bx,{onClick:A,className:"px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Return to Catalog"})]}):(0,se.jsxs)("div",{className:"max-w-screen-xl mx-auto px-4 py-8",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Bx,{variant:"ghost",size:"icon",onClick:A,className:"h-10 w-10 rounded-full",children:(0,se.jsx)(Vs.A,{className:"h-5 w-5"})}),(0,se.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:a?"Edit Integration":"Create New Integration"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:A,className:"px-4",children:"Cancel"}),(0,se.jsxs)(Bx,{onClick:()=>C(),disabled:o,className:"bg-teal-600 hover:bg-teal-700 px-4",children:[o?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(lV.A,{className:"h-4 w-4 mr-2"}),o?"Saving...":"Save Integration"]})]})]}),(0,se.jsxs)("div",{className:"bg-gradient-to-r from-amber-50 to-amber-100 border border-amber-200 rounded-lg p-4 mb-6 flex items-center",children:[(0,se.jsx)(_P.A,{className:"h-5 w-5 text-amber-500 mr-3 flex-shrink-0"}),(0,se.jsxs)("p",{className:"text-amber-800",children:[(0,se.jsx)("span",{className:"font-semibold",children:"Earn 250 credits!"})," Create a public integration that gets approved and we'll reward you with 250 credits to your account."]})]}),m&&(0,se.jsx)(DR,{variant:"destructive",className:"mb-6",children:(0,se.jsx)(OR,{children:m})}),(0,se.jsx)("div",{className:"bg-white rounded-xl border shadow-sm overflow-hidden",children:(0,se.jsxs)(Kj,{value:g,onValueChange:f,className:"w-full",children:[(0,se.jsx)("div",{className:"px-6 pt-6 border-b",children:(0,se.jsxs)($j,{className:"grid w-full grid-cols-2 max-w-md",children:[(0,se.jsxs)(Zj,{value:"metadata",className:"flex items-center gap-2",children:[(0,se.jsx)(vP.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Integration Metadata"})]}),(0,se.jsxs)(Zj,{value:"content",className:"flex items-center gap-2",children:[(0,se.jsx)(Jv.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Integration Content"})]})]})}),(0,se.jsx)(Jj,{value:"metadata",className:"p-6 space-y-8",children:(0,se.jsxs)("div",{className:"grid gap-8 max-w-3xl mx-auto",children:[(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Integration Name"}),(0,se.jsx)(Eq,{children:"A descriptive name for your integration that will be displayed in the catalog."})]}),(0,se.jsx)(Df,{id:"name",name:"name",value:h.name,onChange:_,placeholder:"E.g., OpenAI Text-To-Speech",required:!0,className:"text-lg"})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Description"}),(0,se.jsx)(Eq,{children:"A brief explanation of what this integration does and how it helps users."})]}),(0,se.jsx)(tN,{id:"description",name:"description",value:h.description,onChange:_,placeholder:"Describe what this integration does and how it can be useful...",rows:3,required:!0})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Integration Logo"}),(0,se.jsx)(Eq,{children:"An image that represents your integration. Square images work best."})]}),(0,se.jsxs)("div",{className:"flex items-center gap-8",children:[h.image_url?(0,se.jsx)("div",{className:"w-32 h-32 rounded-lg overflow-hidden border shadow-sm flex-shrink-0",children:(0,se.jsx)("img",{src:h.image_url,alt:"Integration Logo",className:"h-full w-full object-cover",onError:e=>{const t=e.target;t.src="",t.alt=""}})}):(0,se.jsxs)("div",{className:"w-32 h-32 rounded-lg border border-dashed flex-shrink-0 bg-slate-50 flex flex-col items-center justify-center",children:[(0,se.jsx)(Aq.A,{className:"h-8 w-8 text-slate-400 mb-2"}),(0,se.jsx)("p",{className:"text-xs text-slate-500 text-center px-2",children:"No logo uploaded"})]}),(0,se.jsxs)("div",{className:"flex-1 max-w-sm",children:[(0,se.jsx)("input",{type:"file",id:"logo-upload",className:"hidden",accept:"image/*",onChange:async e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s)try{u(!0);const e=(await ip.uploadFile(s)).url;p(t=>(0,ue.A)((0,ue.A)({},t),{},{image_url:e}))}catch(a){x("Failed to upload logo. Please try again.")}finally{u(!1)}}}),(0,se.jsxs)(Bx,{type:"button",variant:h.image_url?"outline":"default",disabled:d,className:"w-full mb-3",onClick:()=>{var e;return null===(e=document.getElementById("logo-upload"))||void 0===e?void 0:e.click()},children:[(0,se.jsx)(W_.A,{className:"h-4 w-4 mr-2"}),d?"Uploading...":h.image_url?"Change Logo":"Upload Logo"]}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Upload a square image in PNG or JPG format (recommended size: 256\xd7256px)"})]})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsxs)("h2",{className:"text-lg font-semibold text-slate-900 flex items-center",children:[(0,se.jsx)(Xx.A,{className:"h-4 w-4 mr-2 text-teal-600"}),"Example Prompts"]}),(0,se.jsx)(Eq,{children:"Add examples of how users can ask for this integration in plain language"})]}),(0,se.jsxs)("div",{className:"grid gap-4",children:[(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Df,{placeholder:"E.g., Convert text to speech",value:v,onChange:e=>b(e.target.value)}),(0,se.jsxs)(Bx,{type:"button",onClick:()=>{v.trim()&&(p(e=>(0,ue.A)((0,ue.A)({},e),{},{example_asks:[...e.example_asks,v.trim()]})),b(""))},className:"bg-teal-600 hover:bg-teal-700 flex-shrink-0",children:[(0,se.jsx)(Sq.A,{className:"h-4 w-4 mr-1"})," Add"]})]}),h.example_asks.length>0?(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:h.example_asks.map((e,t)=>(0,se.jsxs)(gk,{variant:"outline",className:"bg-teal-50 text-teal-700 border-teal-200 px-3 py-1 flex items-center gap-1",children:[e,(0,se.jsx)("button",{type:"button",onClick:()=>(e=>{p(t=>(0,ue.A)((0,ue.A)({},t),{},{example_asks:t.example_asks.filter((t,s)=>s!==e)}))})(t),className:"ml-1 text-teal-700 hover:text-teal-900",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]},t))}):(0,se.jsx)("div",{className:"text-sm text-slate-500 p-4 bg-slate-50 rounded-md border text-center",children:"No example prompts added yet. Add 3-5 examples to help users understand how to use this integration."})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Integration Visibility"}),(0,se.jsx)(Eq,{children:"Control whether your integration is private or public"})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg p-4 border flex items-center gap-4",children:[(0,se.jsx)("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:h.is_private?(0,se.jsx)(Vc.A,{className:"h-5 w-5 text-slate-700"}):(0,se.jsx)(KP.A,{className:"h-5 w-5 text-teal-600"})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"font-medium text-slate-900",children:h.is_private?"Private Integration":"Public Integration"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:h.is_private?"Only visible to you and invited collaborators":"Visible to all users and eligible for 250 credits when approved"})]}),(0,se.jsx)(aB,{checked:!h.is_private,onCheckedChange:e=>k("is_private",!e)})]})]}),(0,se.jsx)("div",{className:"flex justify-end",children:(0,se.jsx)(Bx,{onClick:()=>f("content"),className:"bg-teal-600 hover:bg-teal-700",children:"Continue to Integration Content"})})]})}),(0,se.jsx)(Jj,{value:"content",className:"p-6",children:(0,se.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,se.jsxs)("div",{className:"mb-8 bg-blue-50 rounded-lg p-4 border border-blue-100",children:[(0,se.jsxs)("h3",{className:"text-lg font-medium text-blue-800 mb-2 flex items-center",children:[(0,se.jsx)(Oy.A,{className:"h-5 w-5 mr-2"}),"About Integration Content"]}),(0,se.jsx)("p",{className:"text-blue-700 text-sm",children:"This section contains the core functionality of your integration. The prompt provides implementation instructions, and you can specify any API keys needed to make it work."})]}),(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsxs)("div",{className:"flex items-center mb-2",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"Integration Settings"}),(0,se.jsx)(Eq,{children:"Configure how your integration should behave and what capabilities it needs."})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"These settings determine how your integration functions and what features it can access."}),(0,se.jsx)(Bv,{className:"border-slate-200",children:(0,se.jsx)(Wv,{className:"pt-6 space-y-6",children:(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:(0,se.jsx)(yV.A,{className:"h-5 w-5 text-slate-700"})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"font-medium text-slate-900",children:"Backend Functions"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Most integrations with external APIs require backend functions"})]}),(0,se.jsx)(aB,{checked:h.requires_backend_functions,onCheckedChange:e=>k("requires_backend_functions",e)})]})})})]}),h.requires_backend_functions&&(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsxs)("div",{className:"flex items-center mb-2",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"Required API Keys"}),(0,se.jsx)(Eq,{children:"API keys that users will need to configure to use this integration."})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Define the credentials needed to connect to external services and how users can obtain them."}),(0,se.jsxs)(Bv,{className:"border-slate-200 shadow-sm mb-4",children:[(0,se.jsxs)(zv,{className:"pb-0",children:[(0,se.jsx)(Hv,{className:"text-base font-medium",children:"Add API Keys"}),(0,se.jsx)(Vv,{children:"Specify the API keys users will need to configure to use your integration"})]}),(0,se.jsx)(Wv,{className:"pt-4",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(aN,{htmlFor:"newSecretName",className:"mb-1 block",children:"Secret Name"}),(0,se.jsx)(Df,{id:"newSecretName",placeholder:"E.g., OPENAI_API_KEY",value:j,onChange:e=>y(e.target.value)}),(0,se.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"This is the environment variable name used in code"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)(aN,{htmlFor:"newSecretDescription",className:"mb-1 block",children:"Instructions for obtaining"}),(0,se.jsx)(Df,{id:"newSecretDescription",placeholder:"E.g., Get from platform.openai.com/api-keys",value:N,onChange:e=>w(e.target.value)}),(0,se.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Help users understand where to find this key"})]})]})}),(0,se.jsx)(qv,{className:"border-t pt-4 bg-slate-50",children:(0,se.jsxs)(Bx,{type:"button",onClick:()=>{if(j.trim()){const e={name:j.trim(),description:N.trim()};p(t=>(0,ue.A)((0,ue.A)({},t),{},{required_secrets:[...t.required_secrets,e]})),y(""),w("")}},className:"w-full bg-teal-600 hover:bg-teal-700",children:[(0,se.jsx)(Sq.A,{className:"h-4 w-4 mr-2"})," Add API Key"]})})]}),h.required_secrets.length>0?(0,se.jsx)("div",{className:"space-y-3",children:h.required_secrets.map((e,t)=>(0,se.jsxs)("div",{className:"bg-white rounded-lg p-4 border flex justify-between items-start",children:[(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(Qx.A,{className:"h-4 w-4 text-slate-600 mr-2"}),(0,se.jsx)("h4",{className:"font-medium text-slate-900",children:e.name})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mt-1 ml-6",children:e.description||"Required for this integration"})]}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>(e=>{p(t=>(0,ue.A)((0,ue.A)({},t),{},{required_secrets:t.required_secrets.filter((t,s)=>s!==e)}))})(t),className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:(0,se.jsx)(zy.A,{className:"h-4 w-4"})})]},t))}):(0,se.jsxs)("div",{className:"bg-slate-50 p-5 rounded-lg border text-center",children:[(0,se.jsx)(Qx.A,{className:"h-10 w-10 text-slate-400 mx-auto mb-2"}),(0,se.jsx)("p",{className:"text-slate-600 mb-1",children:"No API keys added yet"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Add keys if your integration requires external API access"})]})]}),(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsxs)("div",{className:"flex items-center mb-2",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"Integration Prompt"}),(0,se.jsx)(Eq,{children:"The implementation guide for your integration."})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Write detailed instructions on how to use this integration, including code examples and configuration guidance."}),(0,se.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,se.jsx)("div",{className:"lg:col-span-2",children:(0,se.jsxs)(Bv,{className:"h-full",children:[(0,se.jsxs)(zv,{className:"pb-2",children:[(0,se.jsx)(Hv,{className:"text-base font-medium",children:"Implementation Guide"}),(0,se.jsx)(Vv,{children:"Provide detailed instructions on how to use this integration"})]}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)(tN,{id:"prompt",name:"prompt",value:h.prompt,onChange:_,placeholder:"# Integration Name This integration allows you to... ## Example Code ```javascript\n// Code example\n``` ## Configuration Options - Option 1: Description\n- Option 2: Description ## Usage Tips ...",className:"font-mono min-h-[400px] bg-slate-50 border-slate-200"}),(0,se.jsxs)("div",{className:"flex justify-between items-center mt-2 text-xs",children:[(0,se.jsx)("div",{className:"text-slate-500",children:(0,se.jsx)("span",{children:"Supports Markdown formatting"})}),(0,se.jsx)("div",{children:(0,se.jsx)("span",{className:"font-medium ".concat(h.prompt.length<50?"text-red-500":"text-green-600"," flex items-center"),children:h.prompt.length<50?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(la.A,{className:"h-3 w-3 mr-1"}),h.prompt.length,"/50 characters (minimum)"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ds.A,{className:"h-3 w-3 mr-1"}),h.prompt.length," characters"]})})})]})]})]})}),(0,se.jsx)("div",{className:"lg:col-span-1",children:(0,se.jsxs)(Bv,{className:"bg-slate-50 border border-slate-200 h-full",children:[(0,se.jsxs)(zv,{className:"pb-2",children:[(0,se.jsxs)(Hv,{className:"text-base font-medium flex items-center text-slate-700",children:[(0,se.jsx)(Oy.A,{className:"h-4 w-4 mr-2 text-teal-600"}),"Tips for writing effective prompts"]}),(0,se.jsx)(Vv,{children:"Guidelines to help users implement your integration"})]}),(0,se.jsxs)(Wv,{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-slate-800 mb-1",children:"Structure your guide clearly"}),(0,se.jsxs)("ul",{className:"space-y-2 text-sm text-slate-600 list-disc pl-5",children:[(0,se.jsx)("li",{children:"Start with an introduction explaining what the integration does"}),(0,se.jsx)("li",{children:"Include complete code examples with explanations"}),(0,se.jsx)("li",{children:"Provide configuration and setup instructions"})]})]}),h.requires_backend_functions&&(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-slate-800 mb-1",children:"Backend Function Tips"}),(0,se.jsxs)("ul",{className:"space-y-2 text-sm text-slate-600 list-disc pl-5",children:[(0,se.jsxs)("li",{children:["Show how to implement with ",(0,se.jsx)("strong",{children:"Deno serve"})," (this is how backend functions run)"]}),(0,se.jsx)("li",{children:"Document the output schema for each function"}),(0,se.jsx)("li",{children:"Include examples of how to call these functions from frontend components"}),(0,se.jsx)("li",{children:"Provide error handling guidance"})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-medium text-slate-800 mb-1",children:"Recommended sections"}),(0,se.jsxs)("ul",{className:"space-y-2 text-sm text-slate-600 list-disc pl-5",children:[(0,se.jsxs)("li",{children:[(0,se.jsx)("strong",{children:"Introduction:"})," What the integration does"]}),(0,se.jsxs)("li",{children:[(0,se.jsx)("strong",{children:"API Reference:"})," Available functions and parameters"]}),(0,se.jsxs)("li",{children:[(0,se.jsx)("strong",{children:"Example Usage:"})," Practical implementation examples"]}),(0,se.jsxs)("li",{children:[(0,se.jsx)("strong",{children:"Troubleshooting:"})," Common issues and solutions"]})]})]}),(0,se.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md text-sm text-blue-700 border border-blue-100",children:[(0,se.jsx)("p",{className:"font-medium mb-1",children:"Pro Tip"}),(0,se.jsx)("p",{children:"The better your documentation, the more likely users will successfully implement your integration!"})]})]})]})})]})]}),(0,se.jsxs)("div",{className:"flex justify-between pt-4 border-t",children:[(0,se.jsxs)(Bx,{onClick:()=>f("metadata"),variant:"outline",children:[(0,se.jsx)(Vs.A,{className:"h-4 w-4 mr-2"}),"Back to Metadata"]}),(0,se.jsx)(Bx,{onClick:()=>C(),disabled:o,className:"bg-teal-600 hover:bg-teal-700",children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lV.A,{className:"h-4 w-4 mr-2"}),"Save Integration"]})})]})]})})]})})]})};function Iq(e){let{isHowToModalOpen:t=!1,setIsHowToModalOpen:s=()=>{}}=e;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-base44 font-medium mb-4 mt-6",children:"App Templates"}),(0,se.jsxs)(Og,{open:t,onOpenChange:s,children:[(0,se.jsxs)("p",{className:"text-base sm:text-lg font-base44 mb-6",children:["Explore a curated collection of applications built by our community."," "]}),(0,se.jsxs)(Hg,{className:"max-w-2xl",children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{className:"text-xl font-semibold text-slate-900",children:"How to Share Your App with the Community"})}),(0,se.jsxs)("div",{className:"space-y-6 pt-2",children:[(0,se.jsx)("p",{className:"text-slate-600 leading-relaxed",children:"Follow these simple steps:"}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-orange-500 text-white text-sm font-medium flex items-center justify-center mt-0.5",children:"1"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"font-medium text-slate-900",children:"Open your app's builder"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Navigate to an app you created or have admin access to"})]})]}),(0,se.jsx)("div",{className:"flex items-center justify-center",children:(0,se.jsx)(Uk.A,{className:"w-4 h-4 text-slate-400"})}),(0,se.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-orange-500 text-white text-sm font-medium flex items-center justify-center mt-0.5",children:"2"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"font-medium text-slate-900",children:"Go to catalog settings"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:(0,se.jsx)("span",{className:"font-mono text-xs bg-white px-2 py-1 rounded border",children:"Workspace \u2192 Settings \u2192 App Templates \u2192 Manage Listing"})})]})]}),(0,se.jsx)("div",{className:"flex items-center justify-center",children:(0,se.jsx)(Uk.A,{className:"w-4 h-4 text-slate-400"})}),(0,se.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-orange-500 text-white text-sm font-medium flex items-center justify-center mt-0.5",children:"3"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"font-medium text-slate-900",children:"Publish your listing"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Add a description, screenshots, and configure your listing visibility"})]})]})]}),(0,se.jsx)("div",{className:"p-4 rounded-xl bg-orange-50 border border-orange-200",children:(0,se.jsxs)("p",{className:"text-sm text-orange-800",children:[(0,se.jsx)("strong",{children:"Tip:"})," Make sure your app is deployed and has an engaging description to attract more users!"]})})]})]})]})]})}function Pq(e){let{activeTab:t,onTabChange:s,showMyTemplates:a,showWorkspace:n}=e;if(1+(n?1:0)+(a?1:0)<=1)return null;const l="\n        relative h-12 rounded-none border-0 bg-transparent px-3 sm:px-6 pb-3 pt-3 \n        font-base44 font-medium text-gray-600 shadow-none transition-colors hover:text-gray-900 \n        focus-visible:ring-0 focus-visible:ring-offset-0 \n        data-[state=active]:bg-transparent data-[state=active]:text-black data-[state=active]:shadow-none \n        data-[state=active]:after:absolute data-[state=active]:after:bottom-0 data-[state=active]:after:left-0 \n        data-[state=active]:after:right-0 data-[state=active]:after:h-0.5 data-[state=active]:after:bg-black \n        data-[state=active]:after:content-['']\n    ".trim().replace(/\s+/g," ");return(0,se.jsx)(Kj,{value:t,onValueChange:e=>s(e),className:"mb-8",children:(0,se.jsxs)($j,{className:"h-auto w-full bg-transparent p-0 border-b border-gray-200 justify-start",children:[(0,se.jsx)(Zj,{value:"community",className:l,children:"Community"}),n&&(0,se.jsx)(Zj,{value:"workspace",className:l,children:"Workspace"}),a&&(0,se.jsx)(Zj,{value:"my-templates",className:l,children:"My Templates"})]})})}const Lq=function(){const{user:e}=wd(),{activeWorkspace:t}=qd(),{templateId:s}=(0,J.g)(),a=(0,J.Zp)(),[n,l]=(0,Z.useSearchParams)(),{isNativeMobile:r,navigation:i}=fd(),o=(0,Y.useMemo)(()=>!t||!0===t.is_personal,[t]),c=(0,Y.useCallback)(()=>o?"community":"workspace",[o]),[d,u]=(0,Y.useState)(()=>{const e=n.get("tab");return"community"===e||"workspace"===e||"my-templates"===e?e:"community"}),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)([]),[j,y]=(0,Y.useState)(!0),[N,w]=(0,Y.useState)(""),[_,k]=(0,Y.useState)("all"),[C,A]=(0,Y.useState)(ev),[S,E]=(0,Y.useState)("en"),[T,I]=(0,Y.useState)(tv),[P,L]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{if(!n.get("tab")&&t)if(o||h){const e=c();u(e)}else u("community")},[t,c,n,o,h]),(0,Y.useEffect)(()=>{(async()=>{if(f(!1),null!=e&&e.email){try{const t=await Gg.listCatalogItems({created_by:e.email,limit:1}),s=t.items||t;x(s.length>0)}catch(t){}f(!0)}else f(!0)})()},[null==e?void 0:e.email]),(0,Y.useEffect)(()=>{(async()=>{if(null!=t&&t.id&&!o)try{const e=await Gg.filter({visibility_scope:"workspace",workspace_id:t.id});p((e||[]).length>0)}catch(e){p(!1)}else p(!1)})()},[null==t?void 0:t.id,o]);const M=(0,Y.useRef)(!1);(0,Y.useEffect)(()=>{M.current||(M.current=!0,Tu("App Templates - Page Viewed",{referrer:document.referrer||null}))},[]);const R=(0,Y.useCallback)(e=>{u(e),l({tab:e}),b([]),W(0),F(!0)},[l]),[D,F]=(0,Y.useState)(!0),[O,U]=(0,Y.useState)(!1),[B,z]=(0,Y.useState)(0),[H]=(0,Y.useState)(20),[V,W]=(0,Y.useState)(0),[q,G]=(0,Y.useState)(!1),[K,$]=(0,Y.useState)(!1),{data:Q,resetData:X}=Xd({query:async()=>{var e,t;if((null==Q||null===(e=Q.item)||void 0===e||null===(t=e.id)||void 0===t?void 0:t.toString())===s)return Q;const a=await Gg.getCatalogItem(s);return G(!0),a},enabled:!!s,initialData:null,onError:()=>{a("/app-templates",{replace:!0})},logErrorMsg:"Error fetching template by ID:",toastError:{title:"Error",description:"Template not found or unavailable."}},[s]);(0,Y.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("category");if(e){const t=Jf.find(t=>t.toLowerCase()===e.toLowerCase());t?k(t):"my-apps"===e.toLowerCase()&&k("my-apps")}},[]),(0,Y.useEffect)(()=>{const e=e=>{q&&("ArrowLeft"===e.key?le():"ArrowRight"===e.key&&re())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[q,Q]),(0,Y.useEffect)(()=>{g&&(b([]),W(0),F(!0),ee(!0))},[N,_,C,S,T,d,g]);const ee=(0,Y.useCallback)(async function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{s?y(!0):U(!0);const a=s?0:V,n="my-apps"===_;let l={skip:a,limit:H,sort_by:te(C)};"community"===d&&"all"!==_&&"my-apps"!==_&&(l.categories=[_]);const r=[];"community"===d?(r.push({$or:[{visibility_scope:"public"},{visibility_scope:{$exists:!1}}]}),N&&r.push({$or:[{name:{$regex:N,$options:"i"}},{description:{$regex:N,$options:"i"}},{categories:{$regex:N,$options:"i"}},{tags:{$regex:N,$options:"i"}},{created_by:{$regex:N,$options:"i"}}]}),S&&("en"===S?r.push({$or:[{language:"en"},{language:{$exists:!1}},{language:null}]}):r.push({language:S})),"free"===T?r.push({$or:[{is_paid:!1},{is_paid:{$exists:!1}}]}):"paid"===T&&r.push({is_paid:!0})):"workspace"===d?(r.push({visibility_scope:"workspace"}),null!=t&&t.id&&r.push({workspace_id:t.id})):"my-templates"===d&&(l.created_by=e.email),r.length>0&&(l.$and=r),Object.keys(l).forEach(e=>{void 0===l[e]&&delete l[e]});const i=n?await Gg.listMyItems(l):await Gg.listCatalogItems(l),o=i.items||i,c=i.total||o.length;s?(b(o),z(c)):b(e=>[...e,...o]),W(a+o.length),F(o.length>=H)}catch(a){so({title:"Error",description:"Failed to load catalog items",variant:"destructive"})}finally{y(!1),U(!1)}},[V,H,_,N,C,S,T,d,null==t?void 0:t.id,e.email]),te=e=>{switch(e){case"newest":return"-created_date";case"oldest":return"created_date";default:return"usage"}},ae=(0,Y.useCallback)(()=>{!D||O||j||ee(!1)},[D,O,j,ee]),{targetRef:ne}=mq({onLoadMore:ae,hasMore:D,isLoading:O||j}),le=()=>{if(!Q)return;const e=v.findIndex(e=>e.item.id===Q.item.id);if(e>0){const t=v[e-1];a("/app-templates/".concat(t.item.id),{replace:!1}),X({data:t,refetch:!1})}},re=()=>{if(!Q)return;const e=v.findIndex(e=>e.item.id===Q.item.id);if(e<v.length-1){const t=v[e+1];a("/app-templates/".concat(t.item.id),{replace:!1}),X({data:t,refetch:!1})}},ie=v.length,oe=B>0?"Showing ".concat(ie," of ").concat(B," items"):"",ce=!o&&(null==t?void 0:t.id)&&h;return(0,se.jsxs)("div",{className:"px-4 sm:px-6 md:px-8 lg:px-12 max-w-[1600px] mx-auto",children:[(0,se.jsx)(Iq,{isHowToModalOpen:K,setIsHowToModalOpen:$}),(0,se.jsx)(Pq,{activeTab:d,onTabChange:R,showMyTemplates:m,showWorkspace:ce}),"community"===d&&(0,se.jsx)(sv,{searchTerm:N,onSearchChange:e=>{w(e)},selectedCategory:_,onCategoryChange:e=>{k(e)},showAllCategories:P,setShowAllCategories:L,totalItems:B,displayedItems:ie,showingText:oe,isLoading:j,sortBy:C,onSortByChange:e=>{A(e)},selectedLanguage:S,onLanguageChange:e=>{E(e)},priceFilter:T,onPriceFilterChange:I}),(0,se.jsx)("div",{className:"mt-12",children:(0,se.jsx)(cv,{isLoading:j,isLoadingMore:O,items:v,onCardClick:e=>{Tu("App Templates - Template Clicked",{template_id:e.item.id,template_name:e.item.name,is_paid:e.item.is_paid||!1,price_usd:e.item.price_usd||null,categories:e.item.categories||[]}),r?i.push({screenName:Nf,passProps:{url:"".concat(window.location.origin,"/app-templates/").concat(e.item.id)}}):(a("/app-templates/".concat(e.item.id),{replace:!1}),X({data:e,refetch:!1}),G(!0))},hasMore:D,targetRef:ne})}),(0,se.jsx)(bf,{isOpen:q,onClose:()=>{G(!1),s&&(a("/app-templates",{replace:!0}),X({data:null,refetch:!1}))},selectedItem:Q,onItemUpdate:e=>{X({data:e,refetch:!1})}})]})};function Mq(e){let{connector:t,appId:s,isActive:a,error:n,onConnectorActive:l,connectingType:r,onConnectStart:i,onConnectorError:o,onShowScopes:c}=e;const{user:d}=wd(),u=(0,Y.useRef)(null),m=r===t.integration_type,x=TE(t.integration_type),h=null==x?void 0:x.icon,p=(null==x?void 0:x.name)||t.integration_type,g=(null==x?void 0:x.subtitle)||"Connect to use ".concat(p," features.");(0,Y.useEffect)(()=>()=>{u.current&&u.current()},[]);return(0,se.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-xl shadow-sm px-6 py-4 flex items-center gap-4",children:[(0,se.jsx)("div",{className:"w-10 h-10 rounded-lg bg-white border border-neutral-200 shadow-sm flex items-center justify-center flex-shrink-0",children:h?(0,se.jsx)(h,{className:"w-6 h-6"}):(0,se.jsx)("div",{className:"w-6 h-6 bg-neutral-200 rounded"})}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("p",{className:"text-base font-semibold text-neutral-900 leading-6",children:p}),(0,se.jsx)("p",{className:"text-sm text-gray-700 leading-5",children:g}),n&&(0,se.jsxs)("div",{className:"flex items-start gap-1 text-red-600 mt-1",children:[(0,se.jsx)(Oy.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("span",{className:"text-xs",children:[n,(0,se.jsx)("span",{className:"font-medium",children:" You can try connecting again."})]})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[t.scopes&&t.scopes.length>0&&(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>c(t),className:"h-9 px-3 rounded-lg border-neutral-200 hover:bg-neutral-50 text-sm font-medium",children:"View Access"}),a?(0,se.jsx)("span",{className:"text-sm font-medium text-emerald-600 bg-emerald-50 h-9 px-4 rounded-lg flex items-center justify-center whitespace-nowrap shadow-sm min-w-[120px]",children:"Connected"}):(0,se.jsx)(Bx,{onClick:async()=>{if(!s)return;i(t.integration_type);const e=await AE({appId:s,integrationType:t.integration_type,scopes:t.scopes,forceReconnect:!1,trackingContext:{source:"Clone App",userId:(null==d?void 0:d.id)||null,conversationId:null,messageId:null,prompt:null,isInitialMessage:null},onSuccess:async()=>{l(t.integration_type),i(null)},onError:e=>{o(t.integration_type,e.message),i(null)},onCancel:()=>{i(null)}});e&&(u.current=e)},disabled:m||null!==r&&r!==t.integration_type,variant:"outline",className:"gap-2 h-9 px-4 rounded-lg border-neutral-200 text-neutral-900 hover:bg-neutral-50 text-sm font-medium min-w-[120px] justify-center shadow-sm",children:m?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}),"Connecting..."]}):(0,se.jsxs)(se.Fragment,{children:["Connect",(0,se.jsx)(Rj.A,{className:"h-4 w-4"})]})})]})]})}function Rq(e){var t;let{connectors:s,appId:a,activeConnectors:n=[],connectorErrors:l={},onConnectorActive:r,onConnectorError:i,onSkip:o,onComplete:c}=e;const[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(null),h=n.length,p=h===s.length,g=h>0;return(0,se.jsxs)("div",{className:"w-full max-w-[868px] mx-auto",children:[(0,se.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 shadow-sm overflow-hidden",children:[(0,se.jsxs)("div",{className:"px-6 py-6 border-b border-neutral-200",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-neutral-900 leading-7 mb-1",children:"Set up your new app"}),(0,se.jsxs)("p",{className:"text-sm text-neutral-500 leading-5",children:["This app uses integrations that require your approval.",(0,se.jsx)("br",{}),"Connect them now to ensure the app works properly, or skip and connect later."]})]}),(0,se.jsx)("div",{className:"p-6 space-y-6",children:s.map(e=>(0,se.jsx)(Mq,{connector:e,appId:a,isActive:n.includes(e.integration_type),error:l[e.integration_type],onConnectorActive:r,onConnectorError:i,connectingType:d,onConnectStart:u,onShowScopes:x},e.integration_type))}),(0,se.jsxs)("div",{className:"p-6 flex justify-end gap-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:o,disabled:p,className:"h-9 px-4 rounded-lg border-neutral-200 text-neutral-900 hover:bg-neutral-50 text-sm font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Skip"}),(0,se.jsx)(Bx,{onClick:c,disabled:!g,className:"h-9 px-4 rounded-lg bg-neutral-900 hover:bg-neutral-800 text-white text-sm font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Done"})]})]}),(0,se.jsx)("p",{className:"text-center text-sm text-neutral-500 mt-6 leading-5",children:"You can always connect these integrations later in the integrations section in the app dashboard"}),(0,se.jsx)(Og,{open:!!m,onOpenChange:e=>!e&&x(null),children:(0,se.jsxs)(Hg,{children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{children:m&&"".concat(null===(t=TE(m.integration_type))||void 0===t?void 0:t.name," Access")})}),m&&(0,se.jsx)("div",{className:"flex flex-col gap-1 max-h-[500px] overflow-y-auto",children:m.scopes.map((e,t)=>(0,se.jsx)("span",{className:"inline-block px-2 py-0.5 bg-slate-100 text-blue-600 rounded text-sm w-fit",children:e},t))}),(0,se.jsx)(Wg,{children:(0,se.jsx)(Bx,{onClick:()=>x(null),children:"Done"})})]})})]})}function Dq(e){let{durationMs:t=1500,size:s=80,className:a=""}=e;return(0,se.jsxs)("svg",{className:a,style:{animation:"spin ".concat(t,"ms linear infinite")},viewBox:"0 0 ".concat(s," ").concat(s),fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("circle",{cx:s/2,cy:s/2,r:.45*s,stroke:"#e2e8f0",strokeWidth:.075*s,fill:"none"}),(0,se.jsx)("path",{d:"M".concat(s/2," ").concat(.05*s,"C").concat(s/2," ").concat(.05*s," ").concat(s/2," ").concat(.05*s," ").concat(s/2," ").concat(.05*s,"C").concat(.749*s," ").concat(.05*s," ").concat(.95*s," ").concat(.251*s," ").concat(.95*s," ").concat(s/2),stroke:"#334155",strokeWidth:.075*s,strokeLinecap:"round",fill:"none"})]})}function Fq(){const[e,t]=(0,Y.useState)("entering"),[s,a]=(0,Y.useState)(0);return(0,Y.useEffect)(()=>{let e=[];const s=()=>{t("entering"),a(0);for(let t=0;t<3;t++)e.push(setTimeout(()=>{a(t+1)},280*t));e.push(setTimeout(()=>{t("fading")},630));e.push(setTimeout(()=>{s()},1830))};return s(),()=>e.forEach(e=>clearTimeout(e))},[]),(0,se.jsx)("span",{className:"inline-flex w-8 text-left",children:[0,1,2].map(t=>(0,se.jsx)("span",{className:"ease-in-out",style:{opacity:"fading"===e?0:t<s?1:0,transition:"fading"===e?"opacity ".concat(1600,"ms ease-in-out ").concat(-200*t,"ms"):"opacity 50ms ease-in-out"},children:"."},t))})}function Oq(e){let{appName:t,showGoToApps:s}=e;const a=(0,J.Zp)(),{isNativeMobile:n,navigation:l}=fd(),r=(0,Y.useCallback)(()=>{if(n)return l.switchToTab({screenId:jf}),void l.pop();a("/apps")},[a,n,l]);return(0,se.jsx)("div",{className:"fixed inset-0 flex flex-col items-center justify-center bg-slate-50 bg-gradient-to-br from-orange-100/30 via-slate-50 to-slate-200/30",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-10 max-w-xl px-6",children:[(0,se.jsx)("div",{className:"relative w-20 h-20",children:(0,se.jsx)(Dq,{durationMs:1500,size:80})}),(0,se.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,se.jsxs)("h1",{className:"text-2xl font-medium text-slate-800",children:["Cloning ",t,(0,se.jsx)(Fq,{})]}),(0,se.jsx)("p",{className:"text-base text-slate-600",children:"This may take a few moments. You'll find it in the Apps page once it's ready"})]}),s&&(0,se.jsx)(zt,{className:"bg-slate-900 hover:bg-slate-800 text-white px-6 h-9 rounded-lg shadow-sm transition-all duration-300 animate-in fade-in slide-in-from-bottom-2",onClick:r,children:"Go to Apps"})]})})}function Uq(){const{user:e}=wd(),{appId:t}=(0,J.g)(),s=(0,J.Zp)(),[a,n]=(0,Y.useState)(!0),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)({}),[p,g]=(0,Y.useState)(!1),f=new URLSearchParams(window.location.search),v=f.get("clone_history"),b=f.get("transaction_id"),j=Kg(),y=(0,Y.useRef)(null),N=(0,Y.useRef)(null),[w,_]=(0,Y.useState)(!1),k=(0,Y.useRef)(null),[C,A]=(0,Y.useState)(null),[S,E]=(0,Y.useState)([]),[T,I]=(0,Y.useState)([]),[P,L]=(0,Y.useState)({}),[M,R]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>()=>{y.current&&clearInterval(y.current),N.current&&clearTimeout(N.current),k.current&&clearTimeout(k.current)},[]),(0,Y.useEffect)(()=>(l?k.current=setTimeout(()=>{_(!0)},3e4):(_(!1),k.current&&clearTimeout(k.current)),()=>{k.current&&clearTimeout(k.current)}),[l]);const D=(0,Y.useCallback)(e=>{I(t=>t.includes(e)?t:[...t,e]),L(t=>{const s=(0,ue.A)({},t);return delete s[e],s})},[]),F=(0,Y.useCallback)((e,t)=>{L(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))},[]),O=(0,Y.useCallback)(()=>{s("/apps/".concat(C,"/editor/preview"))},[C,s]),U=(0,Y.useCallback)(()=>{r(!0),d(null),zc.remixApp(t,{with_chat_history:"true"===v,secret_values:x,transaction_id:b||void 0}).then(async a=>{Sv(),e&&b&&j.templateCloned({transaction_id:b,item_id:t,new_app_id:a.id,is_first_clone:!0});try{const e=(await QS.listIntegrations(a.id)).integrations.filter(e=>"active"!==e.status);e.length>0?(A(a.id),E(e),r(!1),R(!0)):s("/apps/".concat(a.id,"/editor/preview"))}catch(n){s("/apps/".concat(a.id,"/editor/preview"))}}).catch(e=>{d(e.message||"An error occurred while cloning the app"),r(!1)})},[t,x,s,b]),B=(0,Y.useCallback)(()=>{n(!0),zc.remixAppRequirements(t).then(t=>{m(t);const s=new Set(t.shared_secrets||[]),a=(t.app_secret_names||[]).filter(e=>!s.has(e)),l=t.requires_backend_functions&&!Hj(e),r=a.length>0;l?n(!1):r?(g(!0),n(!1)):(n(!1),U())}).catch(e=>{d(e.message||"An error occurred while fetching cloning requirements"),n(!1)})},[t,e.subscription_tier,U]),z=(0,Y.useCallback)(async()=>{const s=12e4,a=Date.now();o(!0);const n=async()=>{try{const n=await sf.getTransactionStatus(b);"completed"===n.transaction.status?(clearInterval(y.current),clearTimeout(N.current),o(!1),e&&j.purchaseCompleted({transaction_id:b,item_id:t,item_name:n.item.name||"Purchased Template",price_usd:n.transaction.price_usd||0,seller_id:n.transaction.seller_user_id||"unknown",is_first_purchase:!1,user_tier:e.subscription_tier||"free"}),B()):Date.now()-a>s&&(clearInterval(y.current),clearTimeout(N.current),o(!1),d("Your purchase is taking longer than expected to confirm. Please check your email for confirmation, or contact support if the issue persists."))}catch(r){var n,l;404!==(null===(n=r.response)||void 0===n?void 0:n.status)&&403!==(null===(l=r.response)||void 0===l?void 0:l.status)||(clearInterval(y.current),clearTimeout(N.current),o(!1),d(r.message||"Unable to verify purchase. Please try again."))}};await n(),y.current=setInterval(n,1e3),N.current=setTimeout(()=>{y.current&&(clearInterval(y.current),o(!1),d("Your purchase is taking longer than expected to confirm. Please check your email for confirmation, or contact support if the issue persists."))},s)},[b,t,e,j,B]);(0,Y.useEffect)(()=>{b?z():B()},[t,b]);if(i)return(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-slate-50",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-6 p-8 bg-white rounded-xl shadow-lg max-w-md mx-4",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Ac.A,{className:"h-16 w-16 animate-spin text-orange-500"}),(0,se.jsx)(hb.A,{className:"h-6 w-6 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-orange-500 opacity-30"})]}),(0,se.jsxs)("div",{className:"text-center space-y-2",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-800",children:"Confirming your purchase..."}),(0,se.jsx)("p",{className:"text-slate-600 text-sm",children:"This usually takes just a few seconds"})]})]})});if(a)return(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,se.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin"})})});if(l)return(0,se.jsx)(Oq,{appName:(null==u?void 0:u.name)||"app",showGoToApps:w});if(c)return(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white rounded-lg shadow-xl max-w-md mx-auto",children:[(0,se.jsx)(ad.A,{className:"h-12 w-12 text-red-500"}),(0,se.jsx)("div",{className:"text-red-600 text-lg font-medium",children:"Error"}),(0,se.jsx)("p",{className:"text-gray-600 text-center",children:c}),(0,se.jsx)(zt,{onClick:()=>s(-1),variant:"outline",children:"Go Back"})]})});if(u&&u.requires_backend_functions&&!Hj(e))return(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white rounded-lg shadow-xl max-w-md mx-auto",children:[(0,se.jsx)(ad.A,{className:"h-12 w-12 text-red-500"}),(0,se.jsx)("div",{className:"text-red-600 text-lg font-medium",children:"Clone Not Allowed"}),(0,se.jsx)("p",{className:"text-gray-600 text-center",children:"This app requires backend functions. You need to be on the Builder tier or above to remix it."}),(0,se.jsx)(zt,{onClick:()=>s(-1),variant:"outline",children:"Go Back"})]})});if(M&&C&&S.length>0)return(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-slate-50 bg-gradient-to-br from-orange-100/30 via-slate-50 to-slate-200/30",children:(0,se.jsx)(Rq,{connectors:S,appId:C,activeConnectors:T,connectorErrors:P,onConnectorActive:D,onConnectorError:F,onSkip:O,onComplete:O})});return(0,se.jsx)("div",{className:"container mx-auto p-4 pt-10 max-w-2xl",children:p?(0,se.jsxs)("div",{className:"mb-6 p-6 border rounded-lg bg-slate-50",children:[(0,se.jsxs)("h1",{className:"text-2xl font-semibold mb-6",children:["Clone ",(null==u?void 0:u.name)||"App"]}),(0,se.jsx)("h2",{className:"text-lg font-medium mb-4 text-slate-700",children:"Configure Secrets"}),(0,se.jsx)(Qp,{secretNames:(()=>{if(!u)return[];const e=new Set(u.shared_secrets||[]);return(u.app_secret_names||[]).filter(t=>!e.has(t))})().map(e=>({name:e})),value:x,onChange:e=>{h(e)}}),(0,se.jsx)(zt,{onClick:()=>U(),disabled:l,className:"w-full mt-4",children:l?"Cloning ".concat((null==u?void 0:u.name)||"App","..."):"Clone ".concat((null==u?void 0:u.name)||"App")})]}):(0,se.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,se.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-black rounded-full animate-spin"}),(0,se.jsx)("p",{className:"text-gray-600",children:"Preparing..."})]})})})}var Bq=s(35219),zq=s(97104);function Hq(){const e=(0,Z.useSearchParams)()[0].get("appId"),{user:t}=wd();return{sessionContext:{app_id:e,user_id:null==t?void 0:t.id}}}const Vq=e=>{let{className:t}=e;return(0,se.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M18.8943 4.34399C17.5183 3.71467 16.057 3.256 14.5317 3C14.3396 3.33067 14.1263 3.77866 13.977 4.13067C12.3546 3.89599 10.7439 3.89599 9.14391 4.13067C8.99457 3.77866 8.77056 3.33067 8.58922 3C7.05325 3.256 5.59191 3.71467 4.22552 4.34399C1.46286 8.41865 0.716188 12.3973 1.08952 16.3226C2.92418 17.6559 4.69486 18.4666 6.4346 19C6.86126 18.424 7.24527 17.8053 7.57594 17.1546C6.9466 16.92 6.34927 16.632 5.77327 16.2906C5.9226 16.184 6.07194 16.0667 6.21061 15.9493C9.68793 17.5387 13.4543 17.5387 16.889 15.9493C17.0383 16.0667 17.177 16.184 17.3263 16.2906C16.7503 16.632 16.153 16.92 15.5236 17.1546C15.8543 17.8053 16.2383 18.424 16.665 19C18.4036 18.4666 20.185 17.6559 22.01 16.3226C22.4687 11.7787 21.2836 7.83202 18.8943 4.34399ZM8.05593 13.9013C7.01058 13.9013 6.15725 12.952 6.15725 11.7893C6.15725 10.6267 6.98925 9.67731 8.05593 9.67731C9.11191 9.67731 9.97588 10.6267 9.95454 11.7893C9.95454 12.952 9.11191 13.9013 8.05593 13.9013ZM15.065 13.9013C14.0196 13.9013 13.1652 12.952 13.1652 11.7893C13.1652 10.6267 13.9983 9.67731 15.065 9.67731C16.121 9.67731 16.985 10.6267 16.9636 11.7893C16.9636 12.952 16.1317 13.9013 15.065 13.9013Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})})},Wq=e=>{let{icon:t,title:s,description:a,action:n,variant:l="default",external:r=!1,onHover:i}=e;return(0,se.jsxs)("div",{className:"group cursor-pointer relative overflow-hidden rounded-2xl transition-all duration-500 hover:scale-[1.02] hover:-translate-y-1",onClick:n,onMouseEnter:i,children:[(0,se.jsx)("div",{className:"absolute inset-0 transition-all duration-500 ".concat("primary"===l?"bg-gradient-to-br from-orange-500 to-orange-600 group-hover:from-orange-600 group-hover:to-orange-700":"secondary"===l?"bg-gradient-to-br from-teal-500 to-teal-600 group-hover:from-teal-600 group-hover:to-teal-700":"bg-gradient-to-br from-slate-700 to-slate-800 group-hover:from-slate-800 group-hover:to-slate-900")}),(0,se.jsxs)("div",{className:"relative z-10 p-8 text-white",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,se.jsx)("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:(0,se.jsx)(t,{className:"w-7 h-7"})}),r&&(0,se.jsx)(Rj.A,{className:"w-5 h-5 opacity-60 group-hover:opacity-100 transition-opacity"})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("h3",{className:"text-xl font-bold leading-tight",children:s}),(0,se.jsx)("p",{className:"text-white/80 text-sm leading-relaxed",children:a})]}),(0,se.jsxs)("div",{className:"mt-6 inline-flex items-center text-sm font-semibold group-hover:translate-x-1 transition-transform duration-300",children:[(0,se.jsx)("span",{children:"Get Started"}),(0,se.jsx)(Ws.A,{className:"w-4 h-4 ml-2"})]})]})]})},qq=e=>{let{icon:t,title:s,description:a,action:n,count:l}=e;return(0,se.jsx)("div",{className:"group cursor-pointer p-6 bg-white rounded-xl border border-slate-200 hover:border-slate-300 hover:shadow-lg transition-all duration-300",onClick:n,children:(0,se.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,se.jsx)("div",{className:"w-12 h-12 bg-slate-100 text-slate-600 rounded-lg flex items-center justify-center group-hover:bg-orange-100 group-hover:text-orange-600 transition-colors",children:(0,se.jsx)(t,{className:"w-6 h-6"})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,se.jsx)("h4",{className:"font-semibold text-slate-900",children:s}),void 0!==l&&(0,se.jsx)("span",{className:"text-sm font-medium text-slate-500",children:l})]}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:a})]}),(0,se.jsx)(Ws.A,{className:"w-5 h-5 text-slate-400 group-hover:text-slate-600 group-hover:translate-x-1 transition-all"})]})})};function Yq(e){let{appId:t}=e;const[s]=(0,Z.useSearchParams)(),a=(0,J.Zp)(),[n,l]=(0,Y.useState)(t),r=function(){const e=Hq();return{pageView:()=>{Fu.track("support_main_page_view",e.sessionContext,{},{useBeacon:!0}).catch()},supportCardHover:t=>{let{type:s,ticketId:a}=t;Fu.track("support_main_open_ticket_hover",e.sessionContext,{type:s,ticket_id:a},{useBeacon:!0}).catch()},supportCardClick:t=>{let{type:s,ticketId:a}=t;Fu.track("support_main_open_ticket_click",e.sessionContext,{type:s,ticket_id:a},{useBeacon:!0}).catch()}}}();(0,Y.useEffect)(()=>{r.pageView()},[]),(0,Y.useEffect)(()=>{const e=s.get("appId");l(e||t)},[s,t]);return(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:[(0,se.jsx)("div",{className:"text-center mb-16",children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("h1",{className:"text-5xl font-bold text-slate-900 tracking-tight",children:"Help & Support"}),(0,se.jsx)("div",{className:"w-24 h-1 bg-gradient-to-r from-orange-500 to-teal-500 mx-auto rounded-full"}),(0,se.jsx)("p",{className:"text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed",children:"Get the help you need to build amazing applications with BASE44"})]})}),n&&(0,se.jsx)("div",{className:"mb-12 p-6 bg-slate-50 border border-slate-200 rounded-xl",children:(0,se.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,se.jsx)("div",{className:"w-10 h-10 bg-slate-100 text-slate-600 rounded-lg flex items-center justify-center",children:(0,se.jsx)(Bq.A,{className:"w-5 h-5"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-900",children:"App-Specific Support"}),(0,se.jsxs)("p",{className:"text-sm text-slate-600",children:["Support requests will be associated with app: ",(0,se.jsx)("span",{className:"font-mono bg-slate-100 px-2 py-1 rounded text-slate-800",children:n})]})]})]})}),(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-16",children:[(0,se.jsx)(Wq,{icon:Lj.A,title:"Documentation",description:"Explore comprehensive guides, tutorials, FAQs,and best practices for building with Base44.",action:()=>{r.supportCardClick({type:"documentation"}),window.open("https://docs.base44.com","_blank")},variant:"primary",external:!0,onHover:()=>r.supportCardHover({type:"documentation"})}),(0,se.jsx)(Wq,{icon:Vq,title:"Discord Community",description:"Connect with fellow builders and get instant help from our active community.",action:()=>{r.supportCardClick({type:"discord"}),window.open("https://discord.com/invite/ThpYPZpVts","_blank")},variant:"secondary",external:!0,onHover:()=>r.supportCardHover({type:"discord"})}),(0,se.jsx)(Wq,{icon:zq.A,title:"Open Support Ticket",description:"Submit a detailed support ticket and get personalized assistance.",action:()=>{r.supportCardClick({type:"support"});const e=new URLSearchParams({openNew:"true"});n&&e.set("appId",n),a("/support/conversations?".concat(e.toString()))},variant:"default",onHover:()=>r.supportCardHover({type:"support"})})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-2xl p-8",children:[(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Quick Actions"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Manage your support experience"})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,se.jsx)(qq,{icon:Xx.A,title:"My Support Tickets",description:"View and manage your existing support tickets",action:()=>{const e=new URLSearchParams;n&&e.set("appId",n),a("/support/conversations".concat(e.toString()?"?".concat(e.toString()):""))}}),(0,se.jsx)(qq,{icon:eb.A,title:"Community Forum",description:"Our brand-new reddit community",action:()=>{window.open("https://www.reddit.com/r/Base44","_blank")}})]})]})]})})}var Gq=s(83655),Kq=s(54598);class $q extends te.y{getBaseURL(){return"/support/conversations"}async addMessage(e,t){return await this.axios.post("/".concat(e,"/messages"),t)}async updateConversationNotifications(e,t){return await this.axios.put("/".concat(e,"/notifications"),t)}async closeTicket(e){return await this.axios.patch("/".concat(e,"/close"))}}const Zq=new $q;class Jq extends te.H{getBaseURL(){return"/support/admin"}async getTickets(e){const t=Object.fromEntries(Object.entries(e||{}).filter(e=>{let[t,s]=e;return null!==s}));return t.filters&&Array.isArray(t.filters)?t.filters=JSON.stringify(t.filters):void 0!==t.filters&&delete t.filters,await this.axios.get("",{params:t})}async getTicketDetail(e){return await this.axios.get("/".concat(e))}async updateTicketStatus(e,t){return await this.axios.patch("/".concat(e,"/status"),{status:t})}async polishResponse(e,t){return await this.axios.post("/".concat(e,"/messages/polish"),{text:t})}async changeTicketStatus(e,t){return await this.axios.patch("/".concat(e,"/change_ticket_status"),{status:t})}async assignTicket(e,t){return await this.axios.patch("/".concat(e,"/assign"),{user_email:t})}async escalateTicket(e){return await this.axios.patch("/".concat(e,"/escalate"))}async unescalateTicket(e){return await this.axios.patch("/".concat(e,"/unescalate"))}async updateInternalCategories(e,t){return await this.axios.patch("/".concat(e,"/internal_categories"),{internal_categories:t})}async updateInternalNotes(e,t){return await this.axios.patch("/".concat(e,"/internal_notes"),{internal_notes:t})}async updateTicketCategory(e,t){return await this.axios.patch("/".concat(e,"/category"),{category:t})}async resolveMany(e){return await this.axios.patch("/resolve-many",{ticket_ids:e})}async deleteMessage(e,t){return await this.axios.delete("/".concat(e,"/messages"),{data:{message_id:t}})}async generateSummary(e){return await this.axios.post("/".concat(e,"/summary"))}async markAsReference(e){return await this.axios.patch("/".concat(e,"/mark_reference"))}async unmarkAsReference(e){return await this.axios.patch("/".concat(e,"/unmark_reference"))}async findRelatedReferences(e){return await this.axios.post("/".concat(e,"/find_related_references"))}async generateFAQSuggestions(){return await this.axios.post("/faq/generate")}}const Qq=new Jq;class Xq extends te.H{getBaseURL(){return"/docs"}async getArticles(){return await this.axios.get("/articles")}async createArticle(e){return await this.axios.post("/articles",e)}async updateArticle(e,t){return await this.axios.put("/articles/".concat(e),t)}async deleteArticle(e){return await this.axios.delete("/articles/".concat(e))}async getAgentProperties(){return await this.axios.get("/agent")}async updateAgentProperties(e){return await this.axios.put("/agent",e)}}const eY=new Xq;class tY extends te.H{getBaseURL(){return"/support/analytics"}async exportTicketsCSV(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={start_date:e,end_date:t};s&&(a.category=s);const n=await this.axios.get("/export-csv",{params:a,responseType:"blob"}),l=window.URL.createObjectURL(new Blob([n])),r=document.createElement("a");return r.href=l,r.setAttribute("download","support_tickets_".concat(e.split("T")[0],"_").concat(t.split("T")[0],".csv")),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(l),n}async runTrendAnalysis(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={start_date:e,end_date:t};return s&&(a.category=s),await this.axios.post("/trend-analysis",a)}async getOperationalMetrics(e,t){const s={start_date:e,end_date:t};return await this.axios.get("/operational-metrics",{params:s})}}const sY=new tY;class aY extends te.H{getBaseURL(){return"/admin/support/recently-used-apps"}async getRecentlyUsedApps(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={user_email:e};return t&&(a.organization_id=t),s&&(a.ticket_id=s),await this.axios.get("",{params:a})}}const nY=new aY;class lY extends te.H{getBaseURL(){return"/support/bot"}async requestAnswer(e,t,s){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const n={title:e,content:t,category:s,file_urls:arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]};return a&&(n.app_id=a),await this.axios.post("/request",n)}async classifyIssue(e){return await this.axios.post("/classify",{issue_description:e})}async logAnswer(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return await this.axios.post("/log_answer",{support_ticket_id:e,answer:t,is_useful:s,ticket_body:a})}}const rY=new lY;class iY extends te.y{getBaseURL(){return"/support/agents"}updateRecord(e,t){return this.axios.post("/realtime/".concat(e,"/").concat(t))}}const oY=new iY;var cY=s(59027),dY=s(62702),uY=s(51107),mY=s(69650);const xY=["node"],hY=["node","className","children","inline"],pY=e=>{let{imageUrl:t,isOpen:s,onClose:a}=e;return s?(0,se.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,se.jsx)("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:a}),(0,se.jsxs)("div",{className:"relative z-10 max-w-7xl max-h-[90vh] mx-4",children:[(0,se.jsx)("button",{onClick:a,className:"absolute -top-12 right-0 w-10 h-10 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white transition-all duration-200 hover:scale-110",children:(0,se.jsx)(la.A,{size:20})}),(0,se.jsx)("img",{src:t,alt:"Full size image",className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl"})]})]}):null},gY=e=>{var t,s,a;let{message:n,onImageClick:l,isAdmin:r=!1,conversationId:i,onMessageDeleted:o}=e;const c="user"===n.role,d=null===(t=n.additional_message_params)||void 0===t?void 0:t.is_admin_message,u=null===(s=n.metadata)||void 0===s?void 0:s.created_by_full_name,[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1);return(0,se.jsx)("div",{className:"flex ".concat(c?"justify-end":"justify-start"," mb-4"),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:(0,se.jsxs)("div",{className:"flex max-w-[80%] ".concat(c?"flex-row-reverse":"flex-row"," items-start space-x-3 relative"),children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ".concat(c?"bg-slate-200 text-slate-600 ml-3":d?"bg-slate-700 text-white mr-3":"bg-teal-100 text-teal-600 mr-3"),children:c?(0,se.jsx)(ay.A,{size:16}):d?(0,se.jsx)(HO.A,{size:16}):(0,se.jsx)(wP.A,{size:16})}),(0,se.jsxs)("div",{className:"flex flex-col ".concat(c?"items-end":"items-start"),children:[d&&u&&(0,se.jsxs)("div",{className:"mb-2 flex items-center space-x-2",children:[(0,se.jsx)("div",{className:"text-xs font-medium text-slate-700",children:u.split(" ")[0]}),(0,se.jsx)("div",{className:"w-1 h-1 bg-slate-300 rounded-full"}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"Support Team"})]}),(0,se.jsxs)("div",{className:"rounded-2xl px-4 py-3 max-w-full ".concat(c?"bg-slate-700 text-white":"bg-white text-slate-900 border border-slate-200 shadow-sm"),children:[n.file_urls&&n.file_urls.length>0&&(0,se.jsx)("div",{className:"mb-3 flex flex-wrap gap-3",children:n.file_urls.map((e,t)=>(0,se.jsx)("div",{className:"relative",children:e.match(/\.(jpg|jpeg|png|gif|webp)$/i)?(0,se.jsxs)("div",{className:"relative group cursor-pointer",onClick:()=>l(e),children:[(0,se.jsx)("img",{src:e,alt:"Attached content",className:"max-w-[250px] max-h-[250px] rounded-lg border border-slate-200 shadow-sm object-cover transition-all duration-200 group-hover:shadow-lg group-hover:scale-[1.02]"}),(0,se.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 rounded-lg transition-all duration-200 flex items-center justify-center",children:(0,se.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-full p-2 opacity-0 group-hover:opacity-100 transition-all duration-200 transform scale-75 group-hover:scale-100",children:(0,se.jsx)(dY.A,{size:16,className:"text-slate-700"})})})]}):e.match(/\.(mp4|webm)$/i)?(0,se.jsx)("video",{controls:!0,className:"max-w-[400px] max-h-[300px] rounded-lg border border-slate-200 shadow-sm",src:e,children:"Your browser doesn't support video playback."}):(0,se.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-lg border ".concat(c?"bg-slate-600 border-slate-500 text-slate-200":"bg-slate-50 border-slate-200 text-slate-700"),children:[(0,se.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"flex-shrink-0",children:[(0,se.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,se.jsx)("polyline",{points:"14 2 14 8 20 8"})]}),(0,se.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-sm hover:underline ".concat(c?"text-slate-200":"text-blue-600"),children:"Attached file"})]})},t))}),(0,se.jsx)("div",{className:"text-sm leading-relaxed prose prose-sm max-w-[550px]",children:(0,se.jsx)(db.oz,{components:{p:e=>{let{children:t}=e;return(0,se.jsx)("p",{className:"mb-2 last:mb-0",children:t})},ul:e=>{let{children:t}=e;return(0,se.jsx)("ul",{className:"list-disc list-inside mb-2 last:mb-0",children:t})},ol:e=>{let{children:t}=e;return(0,se.jsx)("ol",{className:"list-decimal list-inside mb-2 last:mb-0",children:t})},li:e=>{let{children:t}=e;return(0,se.jsx)("li",{className:"mb-1",children:t})},code:e=>{let{children:t,inline:s}=e;return s?(0,se.jsx)("code",{className:"px-1 py-0.5 rounded text-xs font-mono ".concat(c?"bg-slate-600 text-slate-200":"bg-slate-100 text-slate-800"),children:t}):(0,se.jsx)("pre",{className:"p-2 rounded text-xs font-mono overflow-x-auto ".concat(c?"bg-slate-600 text-slate-200":"bg-slate-100 text-slate-800"),children:(0,se.jsx)("code",{children:t})})},blockquote:e=>{let{children:t}=e;return(0,se.jsx)("blockquote",{className:"border-l-4 pl-3 italic ".concat(c?"border-slate-400":"border-slate-300"),children:t})},strong:e=>{let{children:t}=e;return(0,se.jsx)("strong",{className:"font-semibold",children:t})},em:e=>{let{children:t}=e;return(0,se.jsx)("em",{className:"italic",children:t})},h1:e=>{let{children:t}=e;return(0,se.jsx)("h1",{className:"text-lg font-bold mb-2",children:t})},h2:e=>{let{children:t}=e;return(0,se.jsx)("h2",{className:"text-base font-bold mb-2",children:t})},h3:e=>{let{children:t}=e;return(0,se.jsx)("h3",{className:"text-sm font-bold mb-1",children:t})}},children:n.content})})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 mt-1 ".concat(c?"justify-end":"justify-start"),children:[(null===(a=n.metadata)||void 0===a?void 0:a.created_date)&&(0,se.jsx)("div",{className:"text-xs text-slate-500",children:(e=>{const t=He().utc(e).local(),s=He()().startOf("day");return t.isSame(s,"day")?t.format("HH:mm"):t.format("MMM DD, HH:mm")})(n.metadata.created_date)}),r&&!c&&"assistant"===n.role&&h&&(0,se.jsx)("button",{onClick:async()=>{if(!n.id||!i)return;if(window.confirm("Are you sure you want to delete this message?"))try{x(!0),await Qq.deleteMessage(i,n.id),o&&o()}catch(e){alert("Failed to delete message. Please try again.")}finally{x(!1)}},disabled:m,className:"ml-2 p-1 rounded-full transition-all duration-200 ".concat(m?"bg-red-100 text-red-400 cursor-not-allowed":"hover:bg-red-100 text-slate-400 hover:text-red-600"),title:"Delete message",children:m?(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-red-400"}):(0,se.jsx)(zy.A,{size:14})})]})]})]})})},fY=e=>{let{note:t}=e;return(0,se.jsx)("div",{className:"flex justify-center mb-4",children:(0,se.jsx)("div",{className:"max-w-[85%] w-full",children:(0,se.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg px-4 py-3 shadow-sm",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-2 pb-2 border-b border-orange-200",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)("div",{className:"w-6 h-6 rounded-full bg-orange-100 flex items-center justify-center",children:(0,se.jsx)(xb.A,{size:12,className:"text-orange-600"})}),(0,se.jsx)("span",{className:"text-xs font-medium text-orange-800",children:"Internal Note"}),(0,se.jsxs)("span",{className:"text-xs text-orange-600",children:["by ",(e=>{if(!e||"Unknown"===e)return"Admin";const t=e.split("@")[0];return t.charAt(0).toUpperCase()+t.slice(1)})(t.email)]})]}),t.timestamp&&(0,se.jsx)("span",{className:"text-xs text-orange-500",children:(e=>{if(!e)return"";const t=He().utc(e).local(),s=He()().startOf("day");return t.isSame(s,"day")?t.format("HH:mm"):t.format("MMM DD, HH:mm")})(t.timestamp)})]}),(0,se.jsx)("div",{className:"prose prose-sm max-w-none text-sm text-slate-700",children:(0,se.jsx)(db.oz,{remarkPlugins:[cb.A],components:{a:e=>{let{node:t}=e,s=(0,Nt.A)(e,xY);return(0,se.jsx)("a",(0,ue.A)((0,ue.A)({},s),{},{className:"text-orange-600 underline hover:text-orange-700 transition-colors",target:"_blank",rel:"noopener noreferrer"}))},code:e=>{let{node:t,className:s,children:a,inline:n}=e,l=(0,Nt.A)(e,hY);return n?(0,se.jsx)("code",(0,ue.A)((0,ue.A)({className:"bg-orange-100 text-orange-800 px-1 py-0.5 rounded text-xs font-mono"},l),{},{children:a})):(0,se.jsx)("code",(0,ue.A)((0,ue.A)({className:"block bg-slate-50 border border-slate-200 p-2 rounded text-xs font-mono overflow-x-auto text-slate-700"},l),{},{children:a}))},p:e=>{let{children:t}=e;return(0,se.jsx)("p",{className:"mb-2 last:mb-0 text-sm leading-relaxed",children:t})},ul:e=>{let{children:t}=e;return(0,se.jsx)("ul",{className:"list-disc list-inside mb-2 last:mb-0 text-sm space-y-1",children:t})},ol:e=>{let{children:t}=e;return(0,se.jsx)("ol",{className:"list-decimal list-inside mb-2 last:mb-0 text-sm space-y-1",children:t})},li:e=>{let{children:t}=e;return(0,se.jsx)("li",{className:"text-sm",children:t})},strong:e=>{let{children:t}=e;return(0,se.jsx)("strong",{className:"font-semibold text-slate-900",children:t})},em:e=>{let{children:t}=e;return(0,se.jsx)("em",{className:"italic text-slate-700",children:t})},blockquote:e=>{let{children:t}=e;return(0,se.jsx)("blockquote",{className:"border-l-2 border-orange-400 pl-3 italic text-slate-600 my-2",children:t})}},children:t.content})})]})})})},vY=e=>{let{event:t}=e;return(0,se.jsx)("div",{className:"flex justify-center my-2",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 text-[11px] text-slate-400",children:[(0,se.jsx)("div",{className:"w-8 h-px bg-slate-100"}),(0,se.jsx)("span",{className:(()=>{switch(t.event_type){case"status_change":return"resolved"===t.new_value?"text-green-500":"text-blue-500";case"escalation":return"true"===t.new_value?"text-red-400":"text-slate-400";case"assignment":return"text-purple-400";case"category_change":return"text-amber-500";case"label_change":return"text-teal-500";default:return"text-slate-400"}})(),children:(()=>{switch(t.event_type){case"status_change":default:return(0,se.jsx)(uY.A,{size:10});case"assignment":return(0,se.jsx)(NH.A,{size:10});case"escalation":return(0,se.jsx)(Ap.A,{size:10});case"category_change":return(0,se.jsx)(Gq.A,{size:10});case"label_change":return(0,se.jsx)(mY.A,{size:10})}})()}),(0,se.jsx)("span",{children:(()=>{var e,s,a,n,l,r,i;const o=(null===(e=t.created_by_name)||void 0===e||null===(s=e.split(" "))||void 0===s?void 0:s[0])||(null===(a=t.created_by_email)||void 0===a||null===(n=a.split("@"))||void 0===n?void 0:n[0])||"Someone";switch(t.event_type){case"status_change":return"".concat(o," changed status to ").concat(t.new_value);case"assignment":var c,d;return t.old_value?"".concat(o," reassigned to ").concat((null===(l=t.new_value)||void 0===l||null===(r=l.split("@"))||void 0===r?void 0:r[0])||"unknown"):"".concat(o," assigned to ").concat((null===(c=t.new_value)||void 0===c||null===(d=c.split("@"))||void 0===d?void 0:d[0])||"unknown");case"escalation":return"true"===t.new_value?"".concat(o," escalated"):"".concat(o," removed escalation");case"category_change":return"".concat(o," changed category to ").concat(null===(i=t.new_value)||void 0===i?void 0:i.replace(/_/g," "));case"label_change":{var u,m,x,h;const e=(null===(u=t.new_value)||void 0===u||null===(m=u.split(","))||void 0===m?void 0:m.filter(Boolean))||[],s=(null===(x=t.old_value)||void 0===x||null===(h=x.split(","))||void 0===h?void 0:h.filter(Boolean))||[],a=[];return e.length&&a.push("added ".concat(e.join(", "))),s.length&&a.push("removed ".concat(s.join(", "))),"".concat(o," ").concat(a.join("; "))}default:return"".concat(o," updated ticket")}})()}),t.created_date&&(0,se.jsxs)("span",{className:"opacity-50 cursor-default",title:(s=t.created_date,s?He().utc(s).local().format("dddd, MMMM D, YYYY [at] HH:mm:ss"):""),children:["\xb7 ",(e=>{if(!e)return"";const t=He().utc(e).local(),s=He()().startOf("day");return t.isSame(s,"day")?t.format("HH:mm"):t.format("MMM DD, HH:mm")})(t.created_date)]}),(0,se.jsx)("div",{className:"w-8 h-px bg-slate-100"})]})});var s},bY=()=>(0,se.jsx)("div",{className:"flex justify-start mb-4",children:(0,se.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center bg-teal-100 text-teal-600 mr-3",children:(0,se.jsx)(wP.A,{size:16})}),(0,se.jsx)("div",{className:"bg-white text-slate-900 border border-slate-200 shadow-sm rounded-2xl px-4 py-3",children:(0,se.jsxs)("div",{className:"flex space-x-1",children:[(0,se.jsx)("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),(0,se.jsx)("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,se.jsx)("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})});function jY(e){let{messages:t,isTyping:s,isAdmin:a=!1,conversationId:n,onMessageDeleted:l,internalNotes:r="",events:i=[]}=e;const o=(0,Y.useRef)(null),[c,d]=(0,Y.useState)(null),u=(0,Y.useMemo)(()=>{const e=t.map((e,t)=>{var s;return(0,ue.A)((0,ue.A)({},e),{},{itemType:"message",originalIndex:t,sortTimestamp:null!==(s=e.metadata)&&void 0!==s&&s.created_date?He().utc(e.metadata.created_date).valueOf():null})});if(!a)return e;const s=(r?(e=>{if(!e||"string"!=typeof e)return[];const t=[],s=e.split(/\n-{5,}\n/);for(const a of s){if(!a.trim())continue;const e=a.match(/^\[([^\]]+)\]\s*\[([^\]]+)\]:\s*([\s\S]*)/);if(e){const[,s,a,n]=e,l=He()().year(),r=He().utc("".concat(a," ").concat(l),"MMM DD, HH:mm YYYY");r.isAfter(He()())&&r.subtract(1,"year"),t.push({id:"note-".concat(s,"-").concat(a),email:s.trim(),timestamp:r.isValid()?r.toISOString():null,content:n.trim(),type:"internal_note"})}else t.push({id:"note-".concat(t.length),email:"Unknown",timestamp:null,content:a.trim(),type:"internal_note"})}return t})(r):[]).map((e,t)=>(0,ue.A)((0,ue.A)({},e),{},{itemType:"internal_note",originalIndex:t,sortTimestamp:e.timestamp?He().utc(e.timestamp).valueOf():null})),n=(i||[]).map((e,t)=>(0,ue.A)((0,ue.A)({},e),{},{itemType:"event",originalIndex:t,sortTimestamp:e.created_date?He().utc(e.created_date).valueOf():null})),l=[...e,...s,...n];return l.sort((e,t)=>null===e.sortTimestamp&&null===t.sortTimestamp?0:null===e.sortTimestamp?-1:null===t.sortTimestamp?1:e.sortTimestamp-t.sortTimestamp),l},[t,r,i,a]);(0,Y.useEffect)(()=>{var e;null===(e=o.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[u,s]);const m=e=>{d(e)};return(0,se.jsxs)("div",{className:"h-full overflow-y-auto px-4 py-4",children:[0===u.length?(0,se.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"w-16 h-16 bg-slate-100 text-slate-400 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(wP.A,{size:24})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Start the conversation"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Send a message to begin your support conversation"})]})}):(0,se.jsxs)("div",{className:"space-y-4",children:[u.map((e,t)=>"internal_note"===e.itemType?(0,se.jsx)(fY,{note:e},e.id||"note-".concat(t)):"event"===e.itemType?(0,se.jsx)(vY,{event:e},e.id||"event-".concat(t)):(0,se.jsx)(gY,{message:e,onImageClick:m,isAdmin:a,conversationId:n,onMessageDeleted:l},e.id||t)),s&&(0,se.jsx)(bY,{}),(0,se.jsx)("div",{ref:o})]}),c&&(0,se.jsx)(pY,{imageUrl:c,isOpen:!!c,onClose:()=>d(null)})]})}const yY=(0,Y.forwardRef)((e,t)=>{let{value:s,files:a=[],onSend:n,placeholder:l,disabled:r,isProcessing:i,showStopFeedback:o=!1,onValueChange:c,onFilesChange:d,onStop:u,customButtomRight:m,variant:x="default",isDiscussionMode:h=!1,isVisualEditMode:p=!1,className:g}=e;const f=(0,Y.useRef)(),v=uo(),{createChatKeyDownHandler:b}=Up(),[j,y]=(0,Y.useState)([]),[N,w]=(0,Y.useState)(null),_=[...Sp,...Ep],{mutate:k,isLoading:C}=eu({mutate:async e=>{const{valid:t,error:s}=await Rp(e,!0);if(!t)throw new Error(s);let a=e;if(e.type.startsWith("image/")){y(t=>[...t,"".concat(e.name," (processing...)")]);try{a=(await Dp(e)).file}catch(n){}y(t=>t.filter(t=>t!=="".concat(e.name," (processing...)")))}y(t=>[...t,e.name]);try{return(await ip.uploadFile(a)).url}finally{y(t=>t.filter(t=>t!==e.name))}},onError:e=>{w(e.message||"Failed to upload file")},onSuccess:e=>{w(null),d([...a,e])}}),A=()=>{n&&(n({text:s,files:a}),c(""),d([]),w(null))},S=b({onSend:A,value:s,onValueChange:c});return(0,se.jsxs)("div",{className:de("w-full relative",{"rounded-[30px] bg-white border border-[#E2E5EB] backdrop-blur px-2":"home"===x,"shadow-[0_8px_16px_0_rgba(0,0,0,0.04)]":!r&&"home"===x,"border border-gray-300 rounded-[16px] bg-white/80 backdrop-blur":"home"!==x,"shadow-[0px_1px_6px_3px_rgba(0,0,0,0.1)] ":!r&&"home"!==x},g),onDrop:e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);for(let s of t)k(s)},onDragOver:e=>{e.preventDefault()},children:[(0,se.jsx)(wp,{files:a,uploadingFiles:j,onRemoveFile:e=>d(a.filter(t=>t!==e))}),N&&(0,se.jsx)("div",{className:"px-4 py-2",children:(0,se.jsxs)(Dt,{variant:"destructive",className:"flex items-center justify-between",children:[(0,se.jsxs)(Ot,{children:[N,(0,se.jsxs)("div",{className:"mt-1 text-xs",children:["Please request support for additional file types at ",(0,se.jsx)("a",{href:"https://feedback.base44.com",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-destructive-foreground/80",children:"feedback.base44.com"})]})]}),(0,se.jsx)("button",{onClick:()=>w(null),className:"ml-2 inline-flex h-5 w-5 items-center justify-center rounded-full bg-destructive/10 hover:bg-destructive/20",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})}),(0,se.jsx)(Cp,{ref:t,value:s,onValueChange:c,onKeyDown:S,onPaste:e=>{var t,s;const a=null===(t=e.clipboardData||(null===(s=e.originalEvent)||void 0===s?void 0:s.clipboardData))||void 0===t?void 0:t.items;if(a)for(let n of a)if("file"===n.kind){const e=n.getAsFile();e&&k(e)}},placeholder:l,disabled:r,isProcessing:i,showStopFeedback:o,onStop:u,onSend:n?A:null,variant:x,isDiscussionMode:h,isVisualEditMode:p}),(0,se.jsx)("input",{ref:f,type:"file",id:"support-chat-file-upload",className:"hidden",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);for(let s of t)k(s);f.current.value=""},accept:_.join(",")}),(0,se.jsx)(yp,{onFileUploadClick:()=>document.getElementById("support-chat-file-upload").click(),value:s,isMobile:v,customButtomRight:m,customButtomLeft:()=>(0,se.jsx)(qi,{children:(0,se.jsxs)(Yi,{children:[(0,se.jsx)(Gi,{asChild:!0,children:(0,se.jsx)("button",{onClick:e=>{C||(document.getElementById("support-chat-file-upload").click(),e.currentTarget.blur())},disabled:C,className:"flex items-center gap-1 px-1 py-1 rounded-md text-xs ".concat(C?"text-gray-400 cursor-not-allowed":"text-black hover:bg-gray-100"),children:(0,se.jsx)(op.A,{className:"h-4 w-4"})})}),(0,se.jsx)(Ki,{side:"top",align:"start",sideOffset:5,children:(0,se.jsx)("p",{children:C?"Uploading...":"Upload files"})})]})}),variant:x})]})}),NY=yY,wY="support_templates",_Y=()=>{try{const e=localStorage.getItem(wY);return e?JSON.parse(e):[]}catch(e){return[]}},kY=e=>{let{onTemplateSelect:t,className:s=""}=e;const[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!0);if((0,Y.useEffect)(()=>{n(_Y());const e=e=>{e.key===wY&&n(_Y())};window.addEventListener("storage",e);const t=()=>{n(_Y())};return window.addEventListener("templatesUpdated",t),()=>{window.removeEventListener("storage",e),window.removeEventListener("templatesUpdated",t)}},[]),0===a.length||!i)return null;const c=["bg-blue-100 text-blue-800 border-blue-200 hover:bg-blue-200","bg-green-100 text-green-800 border-green-200 hover:bg-green-200","bg-purple-100 text-purple-800 border-purple-200 hover:bg-purple-200","bg-orange-100 text-orange-800 border-orange-200 hover:bg-orange-200","bg-teal-100 text-teal-800 border-teal-200 hover:bg-teal-200","bg-pink-100 text-pink-800 border-pink-200 hover:bg-pink-200","bg-indigo-100 text-indigo-800 border-indigo-200 hover:bg-indigo-200","bg-yellow-100 text-yellow-800 border-yellow-200 hover:bg-yellow-200","bg-red-100 text-red-800 border-red-200 hover:bg-red-200","bg-cyan-100 text-cyan-800 border-cyan-200 hover:bg-cyan-200"],d=a.length>10,u=l?a:a.slice(0,10);return(0,se.jsxs)("div",{className:"space-y-2 ".concat(s),children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(xb.A,{className:"w-3 h-3 text-slate-500"}),(0,se.jsx)("span",{className:"text-xs font-medium text-slate-700",children:"Quick Templates"}),(0,se.jsxs)("span",{className:"text-xs text-slate-500",children:["(",a.length,")"]})]}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>o(!1),className:"h-5 w-5 p-0 text-slate-400 hover:text-slate-600",children:(0,se.jsx)(la.A,{className:"w-3 h-3"})})]}),(0,se.jsxs)("div",{className:"flex flex-wrap gap-2",children:[u.map((e,s)=>{const a=c[s%c.length];return(0,se.jsx)("button",{onClick:()=>t(e.content),className:"\n                                px-2 py-1 rounded-md border text-xs font-medium \n                                transition-all duration-200 hover:shadow-sm\n                                max-w-32 truncate\n                                ".concat(a,"\n                            "),title:"".concat(e.name,"\n\nPreview: ").concat(e.content.substring(0,100),"..."),children:e.name},e.id)}),d&&(0,se.jsxs)("button",{onClick:()=>r(!l),className:"px-2 py-1 rounded-md border border-slate-300 bg-slate-50 text-slate-600 hover:bg-slate-100 text-xs font-medium transition-all duration-200 flex items-center space-x-1",children:[(0,se.jsx)(Nv.A,{className:"w-3 h-3"}),(0,se.jsx)("span",{children:l?"Less":"+".concat(a.length-10)}),l?(0,se.jsx)(ur.A,{className:"w-3 h-3"}):(0,se.jsx)(_t.A,{className:"w-3 h-3"})]})]})]})};function CY(e){var t;let{conversationId:s,isAdmin:a=!1,onMessageSent:n,ticket:l=null,onGenerateSummary:r=null,onViewSummary:i=null,isGeneratingSummary:o=!1}=e;const{user:c}=wd(),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(""),[N,w]=(0,Y.useState)(!1),[_,k]=(0,Y.useState)(""),[C,A]=(0,Y.useState)([]),[S,E]=(0,Y.useState)(!1),[T,I]=(0,Y.useState)(!1),[P,L]=(0,Y.useState)(!1),[M,R]=(0,Y.useState)(!1),[D,F]=(0,Y.useState)(0),O=a?null:500,U=s?"support-draft-".concat(s):"support-draft-temp";(0,Y.useEffect)(()=>{if(!s)return;let e=null,t=!0;return(async()=>{try{x(!0),p(null);const a=await Zq.fetchAndSubscribe(s,e=>{t&&(u(e),x(!1))});t?e=a:null==a||a()}catch(a){t&&(p("Failed to load conversation. Please try again."),x(!1))}})(),()=>{t=!1,e&&e()}},[s,D]),(0,Y.useEffect)(()=>{if(!a||!s)return;const e="/support/admin/conversations/".concat(s);return Fd.A.addListener(e,e=>{u(t=>t?(0,ue.A)((0,ue.A)({},t),e):t)})},[a,s]),(0,Y.useEffect)(()=>{if(a){const e=localStorage.getItem(U);k(e||"")}},[U,a]),(0,Y.useEffect)(()=>{a&&_&&localStorage.setItem(U,_)},[_,a,U]),(0,Y.useEffect)(()=>{a&&null!=d&&d.draft&&!v&&(b(!0),y(d.draft),w(!1))},[null==d?void 0:d.draft,a]),(0,Y.useEffect)(()=>{void 0!==(null==d?void 0:d.notify_via_email_on_admin_response)&&I(d.notify_via_email_on_admin_response)},[null==d?void 0:d.notify_via_email_on_admin_response]),(0,Y.useEffect)(()=>{if(!a)return;const e=e=>{(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey&&"k"===e.key:e.ctrlKey&&"k"===e.key)&&(e.preventDefault(),_.trim()&&!S&&z())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a,_,S]);const B=async()=>{try{x(!0),p(null);const e=await Zq.get(s);u(e),x(!1)}catch(e){p("Failed to load conversation. Please try again."),x(!1)}},z=async()=>{if(_.trim())try{E(!0);const e=await Qq.polishResponse(s,_);k(e)}catch(h){}finally{E(!1)}};if(m)return(0,se.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-400 mx-auto mb-4"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Loading conversation..."})]})});if(h)return(0,se.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(Xx.A,{className:"w-8 h-8"})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Error Loading Conversation"}),(0,se.jsx)("p",{className:"text-slate-600 mb-4",children:h}),(0,se.jsx)(zt,{onClick:()=>F(e=>e+1),variant:"outline",size:"sm",children:"Try Again"})]})});if(!d)return(0,se.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"w-16 h-16 bg-slate-100 text-slate-400 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(Xx.A,{className:"w-8 h-8"})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No Conversation Found"}),(0,se.jsx)("p",{className:"text-slate-600",children:"This conversation doesn't exist or you don't have access to it."})]})});const H="premium"==(((null==c?void 0:c.subscription_tier)||"free").toLowerCase().includes("elite")?"premium":"standard")?{tier:"Premium Support",message:"Priority support with faster response times",color:"text-slate-700 bg-slate-100 border-slate-200"}:{tier:"Standard Support",message:"Responses on standard support could take up to 48 hours, typically less",color:"text-slate-600 bg-slate-50 border-slate-200"},V="pending_admin_response"===(null==d?void 0:d.status),W=a?(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:z,disabled:!_.trim()||S,className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100",title:"Improve Grammar",children:S?(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-400"}):(0,se.jsx)(Dx.A,{className:"w-4 h-4"})}),null!=l&&l.ai_summary?(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:i,className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",title:"View AI Summary",children:(0,se.jsx)(lA.A,{className:"w-4 h-4"})}):r?(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:r,disabled:o,className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100",title:"Generate AI Summary",children:o?(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-400"}):(0,se.jsx)(_P.A,{className:"w-4 h-4"})}):null]}):null;return(0,se.jsxs)("div",{className:"flex flex-col h-full max-h-full overflow-hidden",children:[!a&&d&&(0,se.jsx)("div",{className:"flex-shrink-0 border-b border-slate-200 px-4 py-3 bg-slate-50",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center text-sm",children:"\u{1f4b3}"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-slate-900 line-clamp-1",children:d.title||"Support Ticket"}),(0,se.jsx)("p",{className:"text-xs text-slate-500 capitalize",children:(null===(t=d.category)||void 0===t?void 0:t.replace(/_/g," "))||"General"})]})]}),"closed"!==d.status&&"resolved"!==d.ticket_status&&(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:async()=>{if(window.confirm("Are you sure you want to close this ticket? This will mark it as resolved."))try{R(!0),await Zq.closeTicket(s);const e=window.location.pathname;e.includes("/support")&&!e.includes("/support/conversations/")?window.location.reload():(await B(),n&&n({conversationId:s,action:"ticket_closed",role:a?"admin":"user",conversation:d}))}catch(h){alert("Failed to close ticket. Please try again.")}finally{R(!1)}},disabled:M,className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50 border-teal-300 h-7 px-3 text-xs",children:M?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-teal-600 mr-1"}),"Closing..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(hb.A,{className:"w-3 h-3 mr-1"}),"Close Ticket"]})})]})}),(0,se.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:(0,se.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,se.jsx)(jY,{messages:d.messages||[],isTyping:d.is_bot_writing,isAdmin:a,conversationId:s,onMessageDeleted:async()=>{await B()},internalNotes:a?d.internal_notes:"",events:a?d.events:[]})})}),(0,se.jsx)("div",{className:"flex-shrink-0",children:a&&v&&j?(0,se.jsx)("div",{className:"px-4 py-2 border-t border-slate-200 bg-teal-50",children:(0,se.jsx)(Es,{className:"border-teal-200 bg-white",children:(0,se.jsxs)(Ls,{className:"p-3",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(ib.A,{className:"w-4 h-4 text-teal-600"}),(0,se.jsx)("span",{className:"text-sm font-medium text-teal-800",children:"AI Suggested Response"})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>{w(!N)},className:"h-6 px-2 text-xs text-teal-700 hover:bg-teal-100",children:N?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ur.A,{className:"w-3 h-3 mr-1"}),"Collapse"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(_t.A,{className:"w-3 h-3 mr-1"}),"View All"]})}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>{b(!1),y(""),w(!1)},className:"h-6 w-6 p-0 text-slate-400 hover:text-slate-600",children:(0,se.jsx)(la.A,{className:"w-3 h-3"})})]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"text-sm text-slate-700 bg-slate-50 p-3 rounded border transition-all duration-200 relative ".concat(N?"max-h-none":"max-h-20 overflow-hidden"),children:[(0,se.jsx)("pre",{className:"whitespace-pre-wrap font-sans text-xs leading-relaxed",children:j}),!N&&j.length>150&&(0,se.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-slate-50 to-transparent pointer-events-none"})]}),(0,se.jsx)("div",{className:"flex items-center",children:(0,se.jsxs)(zt,{size:"sm",onClick:async()=>{k(j),b(!1),y(""),w(!1)},className:"bg-teal-600 hover:bg-teal-700 h-7 px-3 text-xs",children:[(0,se.jsx)(cY.A,{className:"w-3 h-3 mr-1"}),"Use"]})})]})]})})}):!a&&(0,se.jsx)("div",{className:"px-4 py-3 border-t border-slate-200 bg-slate-50",children:(0,se.jsxs)("div",{className:"p-3 rounded-lg border ".concat(H.color),children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-current"}),(0,se.jsx)("span",{className:"text-sm font-medium",children:H.tier})]}),(0,se.jsx)("p",{className:"text-xs opacity-80",children:H.message}),V&&(0,se.jsx)("div",{className:"flex items-start space-x-2 mt-2 pt-2 border-t border-current/20",children:(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(Os,{id:"email-notifications",checked:T,onCheckedChange:async e=>{try{L(!0),await Zq.updateConversationNotifications(s,{notify_via_email_on_admin_response:e}),I(e)}catch(h){I(!e)}finally{L(!1)}},disabled:P,className:"h-3 w-3 data-[state=checked]:bg-slate-600 data-[state=checked]:border-slate-600 border-slate-400 rounded-sm"}),(0,se.jsxs)("label",{htmlFor:"email-notifications",className:"text-xs opacity-80 cursor-pointer flex items-center space-x-1",children:[(0,se.jsx)(Hc.A,{className:"w-3 h-3 flex-shrink-0"}),(0,se.jsx)("span",{children:"Notify me when a Base44 representative responds"})]})]})})]})})}),(0,se.jsxs)("div",{className:"flex-shrink-0 p-2",children:[a&&(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)(kY,{onTemplateSelect:e=>{const t=O?e.substring(0,O):e;k(t),setTimeout(()=>{const e=document.querySelector('textarea[placeholder*="Type your"]');e&&(e.focus(),e.setSelectionRange(e.value.length,e.value.length))},100)},className:"px-2"})}),"closed"===d.status?(0,se.jsx)("div",{className:"flex items-center justify-center py-4 text-slate-500 bg-slate-50 rounded-lg border",children:(0,se.jsx)("span",{className:"text-sm",children:"This conversation is closed"})}):"resolved"!==d.ticket_status||a?(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(NY,{value:_,files:C,onSend:async e=>{let t,{text:l,files:r}=e;f(!0);try{t={id:"temp-".concat(Date.now()),role:a?"assistant":"user",content:l,file_urls:r||[],created_date:(new Date).toISOString(),is_admin_message:a,is_temp:!0},u(e=>(0,ue.A)((0,ue.A)({},e),{},{messages:[...(null==e?void 0:e.messages)||[],t]}));const e=await Zq.addMessage(s,{role:a?"assistant":"user",content:l,file_urls:r||[],additional_message_params:a?{is_admin_message:!0}:{}});a&&localStorage.removeItem(U),n&&n({conversationId:s,action:"message_sent",role:a?"admin":"user",conversation:e})}catch(h){var i,o,c,d;if(t&&u(e=>(0,ue.A)((0,ue.A)({},e),{},{messages:((null==e?void 0:e.messages)||[]).filter(e=>e.id!==t.id)})),400===(null===(i=h.response)||void 0===i?void 0:i.status)&&null!==(o=h.response)&&void 0!==o&&null!==(c=o.data)&&void 0!==c&&null!==(d=c.detail)&&void 0!==d&&d.includes("already resolved"))return alert("This ticket has been resolved. Please create a new ticket for additional support."),void await B();throw h}finally{f(!1)}},placeholder:a?"Type your response...":"Type your message...",disabled:g||"resolved"===d.ticket_status&&!a,isProcessing:g,onValueChange:e=>{const t=O?e.substring(0,O):e;k(t)},onFilesChange:A,variant:"default",customButtomRight:W}),O&&(0,se.jsxs)("div",{className:"flex justify-between items-center px-3 py-1 text-xs text-slate-500",children:[(0,se.jsx)("span",{}),(0,se.jsxs)("span",{className:"".concat(_.length>.9*O?"text-orange-600 font-medium":_.length===O?"text-red-600 font-medium":""),children:[_.length,"/",O]})]})]}):(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center py-6 text-slate-500 bg-slate-50 rounded-lg border space-y-3",children:[(0,se.jsx)(hb.A,{className:"w-8 h-8 text-teal-500"}),(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-700 mb-1",children:"This ticket has been resolved"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Please create a new ticket for additional support"})]})]})]})]})}const AY={authentication:"\u{1f510}",billing:"\u{1f4b3}",bug_report:"\u{1f41b}",integrations_and_backend_functions:"\u26a1",chat_issues:"\u{1f4ac}",security:"\u{1f6e1}\ufe0f",other:"\u2753"};function SY(e){let{conversationId:t,isOpen:s,onClose:a,ticketTitle:n,ticket:l,onTicketUpdated:r}=e;const{user:i}=wd();return s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40 transition-opacity duration-300",onClick:a}),(0,se.jsxs)("div",{className:"fixed right-0 top-0 h-screen w-full max-w-2xl bg-white shadow-2xl z-50 transform transition-transform duration-300 ease-out flex flex-col ".concat(s?"translate-x-0":"translate-x-full"),children:[(0,se.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-slate-200 bg-white",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:a,className:"p-1.5 hover:bg-slate-100",children:(0,se.jsx)(Vs.A,{className:"w-4 h-4"})}),(0,se.jsx)("div",{className:"flex-1 min-w-0",children:(0,se.jsx)("h2",{className:"text-base font-semibold text-slate-900 leading-tight truncate",children:n||"Support Conversation"})})]}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:a,className:"p-1.5 hover:bg-slate-100",children:(0,se.jsx)(la.A,{className:"w-4 h-4"})})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,se.jsxs)("span",{className:"font-mono bg-slate-100 px-2 py-1 rounded text-xs",children:["#",null==t?void 0:t.slice(0,8)]}),(null==l?void 0:l.created_date)&&(0,se.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,se.jsx)(H_.A,{className:"w-3 h-3"}),(0,se.jsx)("span",{children:He().utc(l.created_date).fromNow()})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(null==l?void 0:l.category)&&(0,se.jsxs)("span",{className:"flex items-center space-x-1 text-xs",children:[(0,se.jsx)("span",{children:AY[l.category]||"\u{1f4cb}"}),(0,se.jsx)("span",{className:"hidden sm:inline",children:l.category.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())})]}),(null==l?void 0:l.app_id)&&(0,se.jsxs)("a",{href:"/apps/".concat(l.app_id),className:"flex items-center space-x-1 text-blue-600 hover:text-blue-800 hover:underline",children:[(0,se.jsx)(Gq.A,{className:"w-3 h-3"}),(0,se.jsx)("span",{className:"hidden sm:inline",children:"App"}),(0,se.jsx)(Rj.A,{className:"w-3 h-3"})]})]})]})]}),(0,se.jsx)(CY,{conversationId:t,isAdmin:!1,onMessageSent:e=>{r&&null!=e&&e.conversation&&r(t,"message_sent","user",e.conversation)}})]})]}):null}const EY=["node"],TY=["node","inline"],IY=["node"],PY=["node"],LY=["node"],MY=["node"],RY=["node"],DY=["node"],FY=["node"],OY=["node"],UY=[{value:"authentication",label:"Authentication",icon:Vc.A},{value:"billing",label:"Billing",icon:su.A},{value:"bug_report",label:"Bug Report",icon:NS.A},{value:"integrations_and_backend_functions",label:"Integrations & Backend",icon:yS.A},{value:"chat_issues",label:"Chat Issues",icon:lU.A},{value:"security",label:"Security",icon:HO.A},{value:"social_post_bonus_credits",label:"Social Post Bonus Credits",icon:Bz.A},{value:"other",label:"Other",icon:Pj.A}],BY=["billing","security","social_post_bonus_credits","other"],zY=(e,t)=>!t&&(e&&!BY.includes(e));function HY(e){let{value:t,onChange:s}=e;return(0,se.jsxs)(br,{value:t,onValueChange:s,children:[(0,se.jsx)(Nr,{className:"w-full",children:(0,se.jsx)(yr,{placeholder:"Select a category"})}),(0,se.jsx)(kr,{children:UY.map(e=>{const t=e.icon;return(0,se.jsx)(Ar,{value:e.value,children:(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(t,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:e.label})]})},e.value)})})]})}function VY(e){var t,s,a;let{appId:n,onSubmit:l,onCancel:r,initialData:i=null}=e;const{user:o}=wd(),[c,d]=(0,Y.useState)((null==i?void 0:i.title)||""),[u,m]=(0,Y.useState)((null==i?void 0:i.content)||""),[x,h]=(0,Y.useState)([]),[p,g]=(0,Y.useState)((null==i?void 0:i.category)||""),[f,v]=(0,Y.useState)((null==i?void 0:i.app_link)||""),[b,j]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)({}),[w,_]=(0,Y.useState)(null),[k,C]=(0,Y.useState)(!1),A=function(){const e=Hq(),t=(0,Y.useRef)({}),s=e=>{t.current=(0,ue.A)((0,ue.A)({},t.current),e)},a=t=>{let{ticketData:a}=t;s({ticketData:a}),Fu.track("support_ticket_modal_submitted",e.sessionContext,{ticket_id:null==a?void 0:a.id,conversation_id:null==a?void 0:a.id,category_selected:null==a?void 0:a.category,description:null==a?void 0:a.content,subject_selected:null==a?void 0:a.title},{useBeacon:!0}).catch()};return{botAnswered:a=>{var n;let{answerExists:l,answerContent:r,category:i}=a;Fu.track("support_ticket_modal_bot_answered",e.sessionContext,{ticket_id:null===(n=t.current.ticketData)||void 0===n?void 0:n.id,description:r,category:i},{useBeacon:!0}).catch(),s({hasBotAnswer:l,botAnswerContent:r})},ticketCreated:a,submitTicketClicked:e=>{let{ticketData:t}=e;s({submitTicketClicked:!0}),a({ticketData:t})},pageClosed:function(){var s,a;let{action:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Fu.track("support_ticket_modal_closed",e.sessionContext,{action:null!==(s=null!=n?n:t.current.closeAction)&&void 0!==s?s:"x_button",ticket_id:null===(a=t.current.ticketData)||void 0===a?void 0:a.id,is_after_bot_answer:t.current.hasBotAnswer},{useBeacon:!0}).catch(),t.current={}},botAnswerHelped:()=>{var s,a,n,l,r;Fu.track("support_ticket_modal_bot_helped_click",e.sessionContext,{ticket_id:null===(s=t.current.ticketData)||void 0===s?void 0:s.id,conversation_id:null===(a=t.current.ticketData)||void 0===a?void 0:a.id,category_selected:null===(n=t.current.ticketData)||void 0===n?void 0:n.category,description:null===(l=t.current.ticketData)||void 0===l?void 0:l.content,subject_selected:null===(r=t.current.ticketData)||void 0===r?void 0:r.title},{useBeacon:!0}).catch()},botAnswerNotHelped:()=>{var s,a,n,l,r;Fu.track("support_ticket_modal_still_need_help_click",e.sessionContext,{ticket_id:null===(s=t.current.ticketData)||void 0===s?void 0:s.id,conversation_id:null===(a=t.current.ticketData)||void 0===a?void 0:a.id,category_selected:null===(n=t.current.ticketData)||void 0===n?void 0:n.category,description:null===(l=t.current.ticketData)||void 0===l?void 0:l.content,subject_selected:null===(r=t.current.ticketData)||void 0===r?void 0:r.title},{useBeacon:!0}).catch()},pageView:()=>{t.current={},Fu.track("support_ticket_modal_view",e.sessionContext,{},{useBeacon:!0}).catch()},closeClicked:e=>{let{action:t}=e;s({closeAction:t})},helpTypeClick:s=>{var a;let{type:n}=s;Fu.track("support_ticket_modal_help_type_click",e.sessionContext,{ticket_id:null===(a=t.current.ticketData)||void 0===a?void 0:a.id,type:n},{useBeacon:!0}).catch()}}}();(0,Y.useEffect)(()=>(A.pageView(),()=>{A.pageClosed({})}),[]);const S=async()=>{j(!0);try{const e={title:c.trim(),content:u.trim(),category:p,app_id:n||null,app_link:f.trim()||null,file_urls:x||[]},t=await Zq.create(e);d(""),m(""),h([]),g(""),v(""),N({}),_(null),null==l||l(t),A.ticketCreated({ticketData:{id:t.id,category:p,content:u,title:c}})}catch(e){e.response&&e.response.data?N({submit:e.response.data.message}):N({submit:"Failed to submit your support ticket. Please try again."})}finally{j(!1)}},E=async e=>{if(null==e||e.preventDefault(),(()=>{const e={};return(!c.trim()||c.length<5)&&(e.title="Title must be at least 5 characters"),c.length>100&&(e.title="Title must be less than 100 characters"),x.length>0||(!u.trim()||u.length<20)&&(e.content="Please provide more details (at least 20 characters) or attach a file"),u.length>500&&(e.content="Description must be less than 500 characters"),p||(e.category="Please select a category"),zY(p,n)&&!f.trim()&&(e.appLink="App link is required for technical issues. Please provide a link to your app."),f.trim()&&!f.match(/^https?:\/\/.+/)&&(e.appLink="Please enter a valid URL (starting with http:// or https://)"),N(e),0===Object.keys(e).length})()){C(!0),_(null),N({}),A.submitTicketClicked({ticketData:{title:c,content:u,category:p}});try{const e=await rY.requestAnswer(c.trim(),u.trim(),p,x||[],n);e.answer_exists?(_(e),A.botAnswered({answerExists:!0,answerContent:e.answer,category:p})):await S()}catch(t){await S()}finally{C(!1)}}},T=async()=>{if(w)try{const t=w;_(null),j(!0);const s={title:c.trim(),content:u.trim(),category:p,app_id:n||null,app_link:f.trim()||null,file_urls:x||[]},a=await Zq.create(s);try{const e="category: ".concat(p,"\ntitle: ").concat(c.trim(),"\n\ncontent: ").concat(u.trim());await rY.logAnswer(a.id,t,!1,e)}catch(e){}d(""),m(""),h([]),g(""),v(""),N({}),null==l||l(a),A.ticketCreated({ticketData:{id:a.id,category:p,content:u,title:c}}),A.botAnswerNotHelped()}catch(t){t.response&&t.response.data?N({submit:t.response.data.message}):N({submit:"Failed to submit your support ticket. Please try again."})}finally{j(!1)}else await S()},I=async()=>{if(w){try{const e="category: ".concat(p,"\ntitle: ").concat(c.trim(),"\n\ncontent: ").concat(u.trim());await rY.logAnswer(null,w,!0,e)}catch(e){}A.botAnswerHelped()}d(""),m(""),h([]),g(""),v(""),N({}),_(null),A.closeClicked({action:"bot_answer_helped_click"}),null==r||r()};return w&&w.answer_exists?(0,se.jsxs)("div",{className:"w-full p-6",children:[(0,se.jsx)("div",{className:"mb-4",children:(0,se.jsxs)("button",{onClick:()=>{_(null),A.closeClicked({action:"back_button_click"})},className:"inline-flex items-center text-xs text-slate-500 hover:text-slate-700 transition-colors",children:[(0,se.jsx)(vs.A,{className:"w-3 h-3 mr-1"}),"Back"]})}),(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)("h2",{className:"text-base font-medium text-slate-900 mb-1",children:"This might help"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Here's what we found in our documentation"})]}),(0,se.jsx)("div",{className:"border-t border-b border-slate-200 py-6 mb-6",children:(0,se.jsx)("div",{children:(0,se.jsx)("div",{className:"prose prose-slate prose-sm max-w-none",children:(0,se.jsx)(db.oz,{remarkPlugins:[cb.A],components:{a:e=>{let{node:t}=e,s=(0,Nt.A)(e,EY);return(0,se.jsx)("a",(0,ue.A)((0,ue.A)({},s),{},{className:"text-slate-700 underline decoration-slate-300 hover:text-slate-900 hover:decoration-slate-500 transition-colors",target:"_blank",rel:"noopener noreferrer"}))},code:e=>{let{node:t,inline:s}=e,a=(0,Nt.A)(e,TY);return s?(0,se.jsx)("code",(0,ue.A)({className:"bg-slate-100 px-1 py-0.5 rounded text-xs font-mono text-slate-700"},a)):(0,se.jsx)("code",(0,ue.A)({className:"block bg-white border border-slate-200 p-3 rounded text-xs font-mono overflow-x-auto text-slate-700"},a))},blockquote:e=>{let{node:t}=e,s=(0,Nt.A)(e,IY);return(0,se.jsx)("blockquote",(0,ue.A)({className:"border-l-2 border-slate-300 pl-4 text-slate-600"},s))},h1:e=>{let{node:t}=e,s=(0,Nt.A)(e,PY);return(0,se.jsx)("h1",(0,ue.A)({className:"text-lg font-semibold text-slate-900 mt-6 mb-3"},s))},h2:e=>{let{node:t}=e,s=(0,Nt.A)(e,LY);return(0,se.jsx)("h2",(0,ue.A)({className:"text-base font-medium text-slate-900 mt-5 mb-2"},s))},h3:e=>{let{node:t}=e,s=(0,Nt.A)(e,MY);return(0,se.jsx)("h3",(0,ue.A)({className:"text-sm font-medium text-slate-900 mt-4 mb-2"},s))},ul:e=>{let{node:t}=e,s=(0,Nt.A)(e,RY);return(0,se.jsx)("ul",(0,ue.A)({className:"list-disc pl-5 space-y-1 text-sm mb-4"},s))},ol:e=>{let{node:t}=e,s=(0,Nt.A)(e,DY);return(0,se.jsx)("ol",(0,ue.A)({className:"list-decimal pl-5 space-y-1 text-sm mb-4"},s))},li:e=>{let{node:t}=e,s=(0,Nt.A)(e,FY);return(0,se.jsx)("li",(0,ue.A)({className:"text-slate-600"},s))},p:e=>{var t;let{node:s}=e,a=(0,Nt.A)(e,OY);const n=(null===(t=a.children)||void 0===t?void 0:t.toString())||"",l=n.startsWith("Important")||n.startsWith("Source:");return(0,se.jsx)("p",(0,ue.A)({className:"text-slate-600 leading-relaxed text-sm ".concat(l?"mt-5 mb-3":"mb-3")},a))}},children:w.answer})})})}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,se.jsxs)(zt,{onClick:I,className:"flex-1 bg-slate-900 hover:bg-slate-800 text-white",children:[(0,se.jsx)(hb.A,{className:"w-4 h-4 mr-2"}),"This helps"]}),(0,se.jsx)(zt,{variant:"outline",onClick:T,disabled:b,className:"flex-1 border-slate-300 text-slate-700 hover:bg-slate-50",children:b?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-slate-600 border-t-transparent rounded-full animate-spin mr-2"}),"Submitting ticket..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lU.A,{className:"w-4 h-4 mr-2"}),"Still need help"]})})]}),(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-4 text-center",children:"Not the answer you're looking for? Submit a ticket for human support."})]}):(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 p-6",children:[(0,se.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,se.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{className:"text-sm font-medium text-gray-700",children:"Category"}),(0,se.jsx)(HY,{value:p,onChange:g}),y.category&&(0,se.jsx)("p",{className:"text-sm text-red-600",children:y.category}),p&&!n&&zY(p,n)&&(0,se.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-md p-2",children:(0,se.jsxs)("p",{className:"text-xs text-orange-700 flex items-start",children:[(0,se.jsx)(ad.A,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("span",{children:["For ",p.replace(/_/g," ")," issues, you'll need to provide a link to your app."]})]})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{htmlFor:"title",className:"text-sm font-medium text-gray-700",children:"Subject"}),(0,se.jsx)(nl,{id:"title",value:c,onChange:e=>d(e.target.value),placeholder:"Brief description of your issue",className:"w-full ".concat(y.title?"border-red-500":"")}),y.title&&(0,se.jsx)("p",{className:"text-sm text-red-600",children:y.title})]}),!n&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(On,{htmlFor:"appLink",className:"text-sm font-medium text-gray-700",children:["App Link ",zY(p,n)?(0,se.jsx)("span",{className:"text-red-500",children:"*"}):(0,se.jsx)("span",{className:"text-gray-400",children:"(optional)"})]}),(0,se.jsx)(nl,{id:"appLink",value:f,onChange:e=>v(e.target.value),placeholder:"https://your-app-url.com or https://yourapp.base44.app",className:"w-full ".concat(y.appLink?"border-red-500":"")}),(0,se.jsxs)("div",{className:"space-y-1",children:[zY(p,n)?(0,se.jsxs)("div",{className:"flex items-start space-x-1",children:[(0,se.jsx)(ad.A,{className:"w-3 h-3 text-orange-500 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("p",{className:"text-xs text-orange-600",children:["App link is required for ",null==p?void 0:p.replace(/_/g," ")," issues. This helps us investigate and resolve your issue faster."]})]}):(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"Provide a link to your app to help us better understand the context of your issue."}),p&&BY.includes(p)&&(0,se.jsxs)("p",{className:"text-xs text-gray-400 italic",children:["App link is optional for ",p.replace(/_/g," ")," issues."]})]}),y.appLink&&(0,se.jsx)("p",{className:"text-sm text-red-600",children:y.appLink})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(On,{className:"text-sm font-medium text-gray-700",children:"Steps to Reproduce / Description"}),(0,se.jsx)("div",{className:"".concat(y.content?"border border-red-500 rounded-lg":""),children:(0,se.jsx)(NY,{value:u,files:x,placeholder:"Please provide detailed information about your issue, including any error messages, steps to reproduce, or relevant context...",disabled:b,isProcessing:!1,onValueChange:m,onFilesChange:h,variant:"default",customButtomRight:()=>null})}),(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"Please provide: what happened, what you expected, steps to recreate the issue, relevant links, and screenshots. The more specific details you include, the faster we can resolve your issue."}),(0,se.jsxs)("p",{className:"text-xs ".concat(u.length>500?"text-red-500":u.length>450?"text-orange-500":"text-gray-400"),children:[u.length,"/500"]})]}),y.content&&(0,se.jsx)("p",{className:"text-sm text-red-600",children:y.content})]}),y.submit&&(0,se.jsx)(Dt,{variant:"destructive",children:(0,se.jsx)(Ot,{children:y.submit})})]})}),(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,se.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Ticket Information"}),n&&(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"App ID"}),(0,se.jsx)("p",{className:"text-sm font-mono text-gray-900 bg-white px-2 py-1 rounded border",children:n})]}),!n&&f&&(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"App Link"}),(0,se.jsx)("p",{className:"text-sm text-gray-900 bg-white px-2 py-1 rounded border break-all",children:f})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"text-xs text-gray-500",children:"Support Tier"}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(null!=o&&null!==(t=o.subscription_tier)&&void 0!==t&&t.toLowerCase().includes("elite")?"bg-purple-100 text-purple-800":null!=o&&null!==(s=o.subscription_tier)&&void 0!==s&&s.toLowerCase().includes("pro")?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:(null==o?void 0:o.subscription_tier)||"free"}),(null==o||null===(a=o.subscription_tier)||void 0===a?void 0:a.toLowerCase().includes("elite"))&&(0,se.jsx)("span",{className:"text-xs text-purple-600",children:"Priority Support"})]})]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(zt,{onClick:E,disabled:b||k,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:k?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Checking for solutions..."]}):b?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Submitting..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(iy.A,{className:"w-4 h-4 mr-2"}),"Submit Ticket"]})}),(0,se.jsxs)(zt,{variant:"outline",onClick:()=>{A.closeClicked({action:"cancel_click"}),null==r||r()},className:"w-full",children:[(0,se.jsx)(la.A,{className:"w-4 h-4 mr-2"}),"Cancel"]})]}),(0,se.jsx)("div",{className:"text-sm text-gray-500 space-y-2",children:(0,se.jsxs)("p",{children:[(0,se.jsx)("strong",{children:"Need immediate help?"})," Check our"," ",(0,se.jsx)("a",{onClick:()=>A.helpTypeClick({type:"documentation"}),href:"https://docs.base44.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline py-2 -my-1 inline-block",children:"documentation"})," ","or join our"," ",(0,se.jsx)("a",{onClick:()=>A.helpTypeClick({type:"discord"}),href:"https://discord.gg/ThpYPZpVts",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline py-2 -my-1 inline-block",children:"Discord community"}),"."]})})]})]})})}var WY=s(66370);const qY="support_ticket_draft";function YY(){try{localStorage.removeItem(qY)}catch(e){}}const GY=e=>"w-6 h-6 ".concat(e?"text-neutral-900 stroke-[1.5]":"text-neutral-500 stroke-[1.5]");const KY={authentication:{id:"authentication",label:"Authentication",icon:function(e){let{selected:t}=e;return(0,se.jsx)(Vc.A,{className:GY(t)})}},billing:{id:"billing",label:"Billing",icon:function(e){let{selected:t}=e;return(0,se.jsx)(su.A,{className:GY(t)})}},bug_report:{id:"bug_report",label:"Bug Report",icon:function(e){let{selected:t}=e;return(0,se.jsx)(NS.A,{className:GY(t)})}},domain:{id:"domain",label:"Domain",icon:function(e){let{selected:t}=e;return(0,se.jsx)(KP.A,{className:GY(t)})}},integrations_and_backend_functions:{id:"integrations_and_backend_functions",label:"Integrations & Backend",icon:function(e){let{selected:t}=e;return(0,se.jsx)(yS.A,{className:GY(t)})}},chat_issues:{id:"chat_issues",label:"Chat Issues",icon:function(e){let{selected:t}=e;return(0,se.jsx)(lU.A,{className:GY(t)})}},security:{id:"security",label:"Security",icon:function(e){let{selected:t}=e;return(0,se.jsx)(HO.A,{className:GY(t)})}},social_post_bonus_credits:{id:"social_post_bonus_credits",label:"Social Post Bonus Credits",icon:function(e){let{selected:t}=e;return(0,se.jsx)(Bz.A,{className:GY(t)})}},other:{id:"other",label:"Other",icon:function(e){let{selected:t}=e;return(0,se.jsx)(Pj.A,{className:GY(t)})}}},$Y=["billing","social_post_bonus_credits","other"];var ZY=s(7865);const JY=[".jpg",".jpeg",".png",".pdf"];function QY(e){const t=e.split("/").pop()||"file",s=t.lastIndexOf(".");return-1===s?{name:t,extension:""}:{name:t.substring(0,s),extension:t.substring(s+1).toUpperCase()}}const XY=["children"],eG=["inline","children"],tG=["children"],sG=["children"],aG=["children"],nG=["children"],lG=["children"],rG=["children"],iG=["children"];const oG=[{id:1,title:"Tell us about your issue",component:function(e){let{formData:t,setFormData:s,error:a,setError:n,title:l,appId:r,biEvents:i}=e;const o=(0,Y.useRef)(null),[c,d]=(0,Y.useState)([]),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!1),p=JY,g=async e=>{try{var t;const a="."+(null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase());if(!p.includes(a))return void m('File type "'.concat(e.name.split(".").pop(),'" is not supported. Supported types: jpg, jpeg, png, pdf.'));const{valid:l,error:r}=await Rp(e,!1);if(!l)return void m(r||"Invalid file");let i=e;if(e.type.startsWith("image/")){d(t=>[...t,"".concat(e.name," (processing...)")]);try{i=(await Dp(e)).file}catch(n){}d(t=>t.filter(t=>t!=="".concat(e.name," (processing...)")))}d(t=>[...t,e.name]);try{const e=await ip.uploadFile(i);m(null),s(t=>(0,ue.A)((0,ue.A)({},t),{},{files:[...t.files,e.url]}))}finally{d(t=>t.filter(t=>t!==e.name))}}catch(a){m(a instanceof Error?a.message:"Failed to upload file"),d(t=>t.filter(t=>t!==e.name))}},f=e=>{var t;null==i||null===(t=i.trackDeleteAttachedFile)||void 0===t||t.call(i),s(t=>(0,ue.A)((0,ue.A)({},t),{},{files:t.files.filter(t=>t!==e)}))};return(0,se.jsxs)("div",{className:"flex flex-col h-full flex-1 gap-5",children:[(0,se.jsx)("h2",{className:"text-2xl font-medium leading-8 text-[#0a0a0a]",style:{marginTop:"-8px"},children:l}),(0,se.jsxs)("div",{className:"flex flex-col flex-1 gap-2.5",children:[(0,se.jsx)("p",{className:"text-base leading-6 text-[#0a0a0a]",children:"Please share what you were doing, what went wrong, how we can reproduce it."}),(0,se.jsxs)("div",{className:"flex flex-col flex-1 gap-2 pt-1.5",children:[(0,se.jsx)("label",{className:"text-sm font-medium leading-none text-[#0a0a0a]",children:"Description"}),(0,se.jsx)("textarea",{value:t.issueDescription,onClick:()=>{var e;return null==i||null===(e=i.trackDescriptionAreaClick)||void 0===e?void 0:e.call(i)},onChange:e=>{s(t=>(0,ue.A)((0,ue.A)({},t),{},{issueDescription:e.target.value})),a&&n&&n(null)},maxLength:500,placeholder:"Example:\n\u2022 What you were trying to do\n\u2022 What happened instead\n\u2022 Any error message\n\u2022 Steps to reproduce (if relevant)",className:"w-full flex-1 min-h-[120px] px-3 py-2 border rounded-lg text-sm leading-5 text-[#0a0a0a] placeholder:text-[#737373] focus:outline-none focus:ring-1 resize-none shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] ".concat(a?"border-red-600 focus:ring-red-600 focus:border-red-600":"border-[#e5e5e5] focus:ring-slate-400 focus:border-slate-400")}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("span",{className:"text-xs text-[#737373]",children:[t.issueDescription.length," / 500"]}),a&&(0,se.jsx)("p",{className:"text-red-600 text-sm leading-5",children:a})]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 pt-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium leading-none text-[#0a0a0a]",children:"Attachments"}),r&&t.selectedAppLink&&(0,se.jsxs)("a",{href:t.selectedAppLink,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 py-0.5 text-sm font-medium leading-none text-[#737373] underline hover:text-[#525252] transition-colors",children:["View app",(0,se.jsx)(Rj.A,{className:"w-3 h-3"})]})]}),u&&(0,se.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-red-50 border border-red-200 rounded-lg",children:[(0,se.jsx)("p",{className:"text-sm leading-5 text-red-600",children:u}),(0,se.jsx)("button",{onClick:()=>m(null),className:"p-1 hover:bg-red-100 rounded transition-colors",children:(0,se.jsx)(la.A,{className:"w-3.5 h-3.5 text-red-500"})})]}),(0,se.jsxs)("div",{onDrop:e=>{e.preventDefault(),h(!1);const t=Array.from(e.dataTransfer.files);for(const s of t)g(s)},onDragOver:e=>{e.preventDefault(),h(!0)},onDragLeave:e=>{e.preventDefault(),h(!1)},className:"flex items-center gap-2.5 px-4 py-3 bg-white border border-dashed rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] transition-colors cursor-pointer ".concat(x?"border-slate-400 bg-slate-50":"border-[#e5e5e5] hover:border-slate-300"),children:[(0,se.jsx)("div",{className:"flex-1 min-w-0",children:t.files.length>0||c.length>0?(0,se.jsxs)("div",{className:"flex flex-wrap gap-2.5 items-start",children:[t.files.map((e,t)=>{return(0,se.jsx)("div",{className:"relative",children:(s=e,/\.(jpg|jpeg|png)$/i.test(s)?(0,se.jsxs)("div",{className:"relative w-[50px] h-[50px]",children:[(0,se.jsx)("img",{src:e,alt:"Attached",className:"w-full h-full object-cover rounded-md border border-slate-100"}),(0,se.jsx)("button",{onClick:t=>{t.stopPropagation(),f(e)},className:"absolute -top-1 -right-[7px] w-[18px] h-[18px] bg-black rounded-full flex items-center justify-center hover:bg-gray-800 transition-colors",children:(0,se.jsx)(la.A,{className:"w-3.5 h-3.5 text-neutral-100",strokeWidth:2})})]}):(0,se.jsxs)("div",{className:"relative flex flex-col justify-center gap-1 h-[50px] min-w-[100px] max-w-[140px] px-3 py-2 border border-slate-100 rounded-md",children:[(0,se.jsx)("span",{className:"text-xs text-gray-950 truncate leading-none",children:QY(e).name.length>16?"".concat(QY(e).name.substring(0,14),"..."):QY(e).name}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(ZY.A,{className:"w-3 h-3 text-gray-400",strokeWidth:1.5}),(0,se.jsx)("span",{className:"text-xs text-gray-400 leading-none",children:QY(e).extension})]}),(0,se.jsx)("button",{onClick:t=>{t.stopPropagation(),f(e)},className:"absolute -top-1 -right-[7px] w-[18px] h-[18px] bg-black rounded-full flex items-center justify-center hover:bg-gray-800 transition-colors",children:(0,se.jsx)(la.A,{className:"w-3.5 h-3.5 text-neutral-100",strokeWidth:2})})]}))},t);var s}),c.map((e,t)=>(0,se.jsxs)("div",{className:"flex flex-col justify-center gap-1 h-[50px] min-w-[100px] max-w-[140px] px-3 py-2 border border-slate-100 rounded-md bg-slate-50",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,se.jsx)(Ac.A,{className:"w-3 h-3 animate-spin text-slate-500"}),(0,se.jsx)("span",{className:"text-xs text-gray-500 truncate leading-none",children:e.length>14?"".concat(e.substring(0,12),"..."):e})]}),(0,se.jsx)("span",{className:"text-xs text-gray-400 leading-none",children:"Uploading..."})]},"uploading-".concat(t)))]}):(0,se.jsx)("p",{className:"text-sm leading-5 text-[#737373] truncate",children:x?"Drop files here":"Drag and drop files here"})}),(0,se.jsx)("input",{ref:o,type:"file",id:"file-upload-tell-us",className:"hidden",accept:p.join(","),multiple:!0,onChange:e=>{const t=Array.from(e.target.files||[]);for(const s of t)g(s);o.current&&(o.current.value="")}}),(0,se.jsx)("button",{type:"button",onClick:e=>{var t,s;e.stopPropagation(),null==i||null===(t=i.trackBrowseFilesClick)||void 0===t||t.call(i),null===(s=o.current)||void 0===s||s.click()},disabled:c.length>0,className:"h-8 px-3 py-2 bg-[#f5f5f5] text-[#171717] text-sm font-medium leading-5 rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] hover:bg-slate-200 transition-colors shrink-0 disabled:opacity-50 disabled:cursor-not-allowed",children:c.length>0?"Uploading...":"Browse files"})]})]})]})]})}},{id:2,title:"What type of issue are you experiencing?",component:function(e){let{formData:t,setFormData:s,suggestedCategories:a,isLoadingCategories:n,title:l,biEvents:r}=e;const i=a?[...a.map(e=>KY[e]).filter(Boolean),KY.other]:Object.values(KY);return(0,Y.useEffect)(()=>{a&&a.length>0&&!t.category&&s(e=>(0,ue.A)((0,ue.A)({},e),{},{category:a[0]}))},[a]),n?(0,se.jsx)("div",{className:"flex flex-1 flex-col justify-center items-center min-h-[200px]",children:(0,se.jsx)("p",{className:"text-2xl font-medium text-[#0a0a0a] text-center relative overflow-hidden",children:(0,se.jsxs)("span",{className:"relative",children:["Analyzing your issue...",(0,se.jsx)("span",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/60 to-transparent animate-shimmer",style:{backgroundSize:"200% 100%"}})]})})}):(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("h2",{className:"mb-6 text-2xl font-medium leading-8 text-slate-900 font-base44 shrink-0",style:{marginTop:"-8px"},children:l}),(0,se.jsxs)("p",{className:"text-[#0a0a0a] text-base leading-6",children:["It looks like your issue falls into one of these categories.",(0,se.jsx)("br",{}),"Select the one that fits best \u2014 it helps us guide you to the right solution."]}),(0,se.jsx)("div",{className:"grid grid-cols-3 gap-3",children:i.map(e=>{const a=t.category===e.id,n=e.icon;return(0,se.jsxs)("button",{type:"button",onClick:()=>{var t;null==r||null===(t=r.trackCategoryClick)||void 0===t||t.call(r,e.label),s(t=>(0,ue.A)((0,ue.A)({},t),{},{category:e.id}))},className:"relative rounded-[10px] p-3 cursor-pointer transition-all text-left ".concat(a?"border-2 border-[#171717] bg-[#f5f5f5]":"border border-[#e5e5e5] hover:border-[#d4d4d4]"),children:[a&&(0,se.jsx)("div",{className:"absolute -top-[10px] -right-[10px] w-5 h-5 bg-[#171717] rounded-full flex items-center justify-center",children:(0,se.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M10 3L4.5 8.5L2 6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,se.jsxs)("div",{className:"flex flex-col items-start gap-2.5",children:[(0,se.jsx)(n,{selected:a}),(0,se.jsx)("span",{className:"text-sm font-medium text-[#0a0a0a] leading-none",children:e.label})]})]},e.id)})})]})}},{id:3,title:"Select the app related to your issue",component:function(e){let{formData:t,setFormData:s,setError:a,title:n,biEvents:l}=e;const[r,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)([]),[m,x]=(0,Y.useState)(!0),[h,p]=(0,Y.useState)(1),[g,f]=(0,Y.useState)(!0),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(!t.selectedAppId&&!!t.selectedAppLink),[N,w]=(0,Y.useState)(!t.selectedAppId&&t.selectedAppLink?t.selectedAppLink:""),[_,k]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{const e=setTimeout(()=>{c(r)},300);return()=>clearTimeout(e)},[r]),(0,Y.useEffect)(()=>{t.selectedAppId&&"custom"!==t.selectedAppId&&!t.selectedAppName&&zc.get(t.selectedAppId).then(e=>{null!=e&&e.name&&s(t=>(0,ue.A)((0,ue.A)({},t),{},{selectedAppName:e.name,selectedAppLink:"".concat(window.location.origin,"/apps/").concat(e.id,"/editor/preview")}))}).catch(e=>{})},[]);const C=(0,Y.useCallback)(async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{1===e?x(!0):b(!0);const a={};t&&(a.$or=[{name:{$regex:t,$options:"i"}},{user_description:{$regex:t,$options:"i"}}]);const n=await zc.filter(a,"-updated_date",10,10*(e-1),["id","name","logo_url","user_description","updated_date"].join(","),"owned_by_me"),l=n.filter(e=>e.id&&e.name).map(e=>({id:e.id,name:e.name,logo_url:e.logo_url,user_description:e.user_description,updated_date:e.updated_date}));u(e=>s?[...e,...l]:l),f(10===n.length)}catch(a){}finally{x(!1),b(!1)}},[]);(0,Y.useEffect)(()=>{C(1,o)},[]);const A=(0,Y.useRef)(o);return(0,Y.useEffect)(()=>{A.current!==o&&(A.current=o,p(1),u([]),C(1,o))},[o,C]),(0,se.jsxs)("div",{className:"space-y-2 flex flex-col h-full",children:[(0,se.jsx)("h2",{className:"mb-6 text-2xl font-medium leading-8 text-slate-900 font-base44 shrink-0",style:{marginTop:"-8px"},children:n}),(0,se.jsxs)("div",{className:"relative shrink-0",children:[(0,se.jsxs)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,se.jsx)("circle",{cx:"11",cy:"11",r:"7",stroke:"currentColor",strokeWidth:"1.5"}),(0,se.jsx)("path",{d:"M16 16L20 20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),(0,se.jsx)("input",{type:"text",placeholder:"Search for apps...",value:r,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-slate-600 focus:border-slate-600"})]}),(0,se.jsx)("div",{children:j?(0,se.jsxs)("div",{className:"flex flex-col gap-2 pt-3 pb-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-slate-900",children:"Add app link"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("input",{type:"url",placeholder:"e. g., https://your-app-url.com or https://yourapp.base44.app",value:N,onChange:e=>{const t=e.target.value;if(w(t),t.trim()){/^https?:\/\/.+/.test(t.trim())?(k(null),s(e=>(0,ue.A)((0,ue.A)({},e),{},{selectedAppId:null,selectedAppName:null,selectedAppLink:t.trim(),hasUrlError:!1}))):(k("Please enter a valid URL starting with http:// or https://"),s(e=>(0,ue.A)((0,ue.A)({},e),{},{selectedAppId:null,selectedAppName:null,selectedAppLink:null,hasUrlError:!0})))}else k(null),s(e=>(0,ue.A)((0,ue.A)({},e),{},{selectedAppId:null,selectedAppName:null,selectedAppLink:null,hasUrlError:!1}))},autoFocus:!0,className:"w-full h-9 pl-3 pr-9 border rounded-lg text-sm focus:outline-none shadow-sm ".concat(_?"border-red-300 focus:ring-[3px] focus:ring-red-100 focus:border-red-400":"border-slate-200 focus:ring-[3px] focus:ring-slate-300/50 focus:border-slate-400")}),(0,se.jsx)("button",{type:"button",onClick:()=>{y(!1),w(""),k(null),s(e=>(0,ue.A)((0,ue.A)({},e),{},{selectedAppId:e.selectedAppId,selectedAppName:e.selectedAppName,selectedAppLink:e.selectedAppId?e.selectedAppLink:null,hasUrlError:!1}))},className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",children:(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]}),_&&(0,se.jsx)("p",{className:"text-xs text-red-500 mt-1",children:_})]}):(0,se.jsxs)("button",{type:"button",onClick:()=>y(!0),className:"flex items-center gap-2 px-2 py-3 w-full rounded-md hover:bg-slate-50 transition-colors",children:[(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-slate-500",children:[(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"1.5"}),(0,se.jsx)("path",{d:"M12 8V16M8 12H16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900",children:"Add app link"})]})}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto space-y-1",children:m?(0,se.jsx)("div",{className:"space-y-1",children:[...Array(5)].map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center gap-3 px-3 py-2.5 rounded-lg",children:[(0,se.jsx)("div",{className:"w-8 h-8 rounded-md bg-slate-200 animate-pulse"}),(0,se.jsx)("div",{className:"flex-1 space-y-1.5",children:(0,se.jsx)("div",{className:"h-4 bg-slate-200 rounded animate-pulse w-3/4"})})]},t))}):0===d.length?(0,se.jsx)("p",{className:"text-sm text-slate-500 text-center py-4",children:r?"No apps found":"No apps available"}):(0,se.jsxs)(se.Fragment,{children:[d.map(e=>{const a=t.selectedAppId===e.id;return(0,se.jsxs)("div",{onClick:()=>{var t;null==l||null===(t=l.trackAppClick)||void 0===t||t.call(l,e.name,e.id),s(t=>(0,ue.A)((0,ue.A)({},t),{},{selectedAppId:e.id,selectedAppName:e.name,selectedAppLink:"".concat(window.location.origin,"/apps/").concat(e.id,"/editor/preview"),hasUrlError:!1})),y(!1),w(""),k(null)},className:"flex items-center gap-2 px-2 py-3 rounded-md cursor-pointer transition-colors ".concat(a?"bg-[#F5F5F5]":"hover:bg-[#F5F5F5]"),children:[e.logo_url?(0,se.jsx)("img",{src:e.logo_url,alt:e.name,className:"size-6 rounded-sm object-cover shrink-0"}):(0,se.jsx)("div",{className:"size-6 rounded-sm bg-[#F5F5F5] flex items-center justify-center shrink-0",children:(0,se.jsx)("span",{className:"text-[10px] font-medium text-slate-500",children:e.name.charAt(0).toUpperCase()})}),(0,se.jsx)("span",{className:"text-sm text-slate-900 flex-1 truncate",children:e.name}),e.updated_date&&(0,se.jsx)("span",{className:"text-sm text-[#737373] shrink-0",children:(()=>{const t=new Date,s=new Date(e.updated_date),a=t.getTime()-s.getTime(),n=Math.floor(a/864e5);return 0===n?"edited today":1===n?"edited 1 day ago":"edited ".concat(n," days ago")})()}),a&&(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"shrink-0",children:(0,se.jsx)("path",{d:"M13 4L6 11L3 8",stroke:"#171717",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]},e.id)}),g&&(0,se.jsx)("div",{className:"pt-2",children:(0,se.jsx)("button",{onClick:()=>{const e=h+1;p(e),C(e,o,!0)},disabled:v,className:"w-full py-2 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors disabled:opacity-50",children:v?(0,se.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,se.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-slate-300 border-t-slate-600 rounded-full"}),"Loading..."]}):"Load more apps"})})]})})]})}},{id:4,title:"This might help",component:function(e){var t;let{formData:s,botResponse:a,isLoadingBot:n,title:l,onStillNeedHelp:r,isSubmitting:i,biEvents:o}=e;const[c,d]=(0,Y.useState)(!1),u=(0,Y.useRef)(!1),m=s.category?(null===(t=KY[s.category])||void 0===t?void 0:t.label)||s.category:"Issue";return(0,Y.useEffect)(()=>{n||a&&a.answer_exists||!r||u.current||(u.current=!0,r())},[n,a,r]),(0,Y.useEffect)(()=>{var e;!n&&null!=a&&a.answer_exists&&(null==o||null===(e=o.trackThisMightHelpLoaded)||void 0===e||e.call(o))},[n,null==a?void 0:a.answer_exists]),n?(0,se.jsx)("div",{className:"flex flex-1 flex-col justify-center items-center min-h-[200px]",children:(0,se.jsx)("p",{className:"text-2xl font-medium text-[#0a0a0a] text-center relative overflow-hidden",children:(0,se.jsxs)("span",{className:"relative",children:["Checking for solution...",(0,se.jsx)("span",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/60 to-transparent animate-shimmer",style:{backgroundSize:"200% 100%"}})]})})}):i?(0,se.jsx)("div",{className:"flex flex-1 flex-col justify-center items-center min-h-[200px]",children:(0,se.jsx)("p",{className:"text-2xl font-medium text-[#0a0a0a] text-center relative overflow-hidden",children:(0,se.jsxs)("span",{className:"relative",children:["Submitting your ticket...",(0,se.jsx)("span",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/60 to-transparent animate-shimmer",style:{backgroundSize:"200% 100%"}})]})})}):a&&a.answer_exists?(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("h2",{className:"mb-6 text-2xl font-medium leading-8 text-slate-900 font-base44 shrink-0",style:{marginTop:"-8px"},children:l}),(0,se.jsxs)("div",{className:"bg-gray-50 border border-slate-200 rounded-[10px] overflow-hidden",children:[(0,se.jsxs)("div",{onClick:()=>{var e;null==o||null===(e=o.trackSummaryClick)||void 0===e||e.call(o),d(!c)},className:"flex flex-col sm:flex-row sm:items-center gap-2 px-4 py-4 cursor-pointer hover:bg-gray-100 transition-colors",children:[(0,se.jsxs)("div",{className:"flex sm:hidden items-center gap-2",children:[(0,se.jsx)("span",{className:"h-6 px-2.5 bg-red-100 text-slate-900 text-sm font-medium rounded-md inline-flex items-center",children:m}),s.selectedAppName&&(0,se.jsxs)("span",{className:"h-6 px-2.5 bg-white border border-slate-200 text-slate-900 text-sm font-medium rounded-md inline-flex items-center gap-1",children:[s.selectedAppName,(0,se.jsx)(Rj.A,{className:"w-3 h-3"})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,se.jsx)(_P.A,{className:"w-4 h-4 text-slate-900 shrink-0"}),(0,se.jsx)("span",{className:"text-base font-medium text-slate-900",children:"Summary of your issue"}),(0,se.jsxs)("div",{className:"hidden sm:flex flex-1 items-center justify-end gap-2 pr-1.5",children:[(0,se.jsx)("span",{className:"h-6 px-2.5 bg-red-100 text-slate-900 text-sm font-medium rounded-md inline-flex items-center",children:m}),s.selectedAppName&&(0,se.jsxs)("span",{className:"h-6 px-2.5 bg-white border border-slate-200 text-slate-900 text-sm font-medium rounded-md inline-flex items-center gap-1",children:[s.selectedAppName,(0,se.jsx)(Rj.A,{className:"w-3 h-3"})]})]}),(0,se.jsx)("svg",{className:"w-4 h-4 text-slate-500 transition-transform shrink-0 sm:hidden ".concat(c?"rotate-180":""),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M6 9L12 15L18 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),(0,se.jsx)("svg",{className:"hidden sm:block w-4 h-4 text-slate-500 transition-transform shrink-0 ".concat(c?"rotate-180":""),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M6 9L12 15L18 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),c&&(0,se.jsx)("div",{className:"px-4 pb-4 border-t border-slate-200 bg-white",children:(0,se.jsx)("p",{className:"text-base text-slate-900 mt-3 leading-relaxed",children:a.issue_summary||s.issueDescription})})]}),(0,se.jsxs)("div",{dir:"auto",className:"border border-slate-200 rounded-[10px] p-6",children:[(0,se.jsx)("div",{className:"max-w-none",children:(0,se.jsx)(db.oz,{remarkPlugins:[cb.A],components:{a:e=>{let{children:t}=e,s=(0,Nt.A)(e,XY);return(0,se.jsx)("a",(0,ue.A)((0,ue.A)({},s),{},{className:"text-slate-900 underline decoration-slate-400 hover:decoration-slate-600 transition-colors",target:"_blank",rel:"noopener noreferrer",children:t}))},code:e=>{let{inline:t,children:s}=e,a=(0,Nt.A)(e,eG);return t?(0,se.jsx)("code",(0,ue.A)((0,ue.A)({className:"bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono text-slate-900"},a),{},{children:s})):(0,se.jsx)("code",(0,ue.A)((0,ue.A)({className:"block bg-slate-50 border border-slate-200 p-3 rounded-lg text-sm font-mono overflow-x-auto text-slate-900"},a),{},{children:s}))},h1:e=>{let{children:t}=e,s=(0,Nt.A)(e,tG);return(0,se.jsx)("h1",(0,ue.A)((0,ue.A)({className:"text-xl font-semibold text-slate-900 mb-3 first:mt-0 mt-6"},s),{},{children:t}))},h2:e=>{let{children:t}=e,s=(0,Nt.A)(e,sG);return(0,se.jsx)("h2",(0,ue.A)((0,ue.A)({className:"text-lg font-semibold text-slate-900 mt-6 mb-2"},s),{},{children:t}))},h3:e=>{let{children:t}=e,s=(0,Nt.A)(e,aG);return(0,se.jsx)("h3",(0,ue.A)((0,ue.A)({className:"text-base font-semibold text-slate-900 mt-4 mb-2"},s),{},{children:t}))},ul:e=>{let{children:t}=e,s=(0,Nt.A)(e,nG);return(0,se.jsx)("ul",(0,ue.A)((0,ue.A)({className:"list-disc pl-5 space-y-1 text-base mb-4"},s),{},{children:t}))},ol:e=>{let{children:t}=e,s=(0,Nt.A)(e,lG);return(0,se.jsx)("ol",(0,ue.A)((0,ue.A)({className:"list-decimal pl-5 space-y-1 text-base mb-4"},s),{},{children:t}))},li:e=>{let{children:t}=e,s=(0,Nt.A)(e,rG);return(0,se.jsx)("li",(0,ue.A)((0,ue.A)({className:"text-slate-900 leading-relaxed"},s),{},{children:t}))},p:e=>{let{children:t}=e,s=(0,Nt.A)(e,iG);return(0,se.jsx)("p",(0,ue.A)((0,ue.A)({className:"text-slate-900 leading-relaxed text-base mb-4 last:mb-0"},s),{},{children:t}))}},children:a.answer})}),a.sources&&a.sources.length>0&&(0,se.jsxs)("div",{className:"mt-6 pt-4",children:[(0,se.jsx)("h4",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Useful sources"}),(0,se.jsx)("div",{className:"flex flex-wrap gap-3",children:a.sources.map((e,t)=>(0,se.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",onClick:()=>{var t;return null==o||null===(t=o.trackSuggestionsUrlClick)||void 0===t?void 0:t.call(o,e.url)},className:"h-8 px-3.5 bg-slate-100 text-slate-900 text-sm font-medium rounded-xl inline-flex items-center gap-1 hover:bg-slate-200 transition-colors",children:[e.title,(0,se.jsx)(Rj.A,{className:"w-3 h-3"})]},t))})]})]})]}):null}}],cG={0:"Resume_step",1:"Tell_us_about_your_issue",2:"What_type_of_issue",3:"Select_app",4:"This_might_help"},dG=(e,t)=>{e&&t&&Promise.resolve().then(()=>{try{Tu(e,t)}catch(s){}})};function uG(e,t){const s=wd(),a=null==s?void 0:s.user,n=(0,co.Ub)({maxWidth:767}),l=(0,Y.useCallback)(()=>n?"mobile":"desktop",[n]),r=(0,Y.useCallback)((s,n,r,i,o)=>{try{var c,d,u;const m=(0,ue.A)((0,ue.A)((0,ue.A)({user_id:null!==(c=null==a?void 0:a.id)&&void 0!==c?c:null,app_id:null!==(d=null!==(u=null==o?void 0:o.appId)&&void 0!==u?u:e)&&void 0!==d?d:null,flow_id:null!=t?t:null,source:l(),page:n,action:r},null!=i&&{value:i}),void 0!==(null==o?void 0:o.attachments)&&{attachments:o.attachments}),void 0!==(null==o?void 0:o.ticketId)&&{ticketId:o.ticketId});dG(s,m)}catch(m){}},[null==a?void 0:a.id,e,t,l]),i=(0,Y.useCallback)((e,t)=>{var s;return t?"Resume_step":null==e?"Tell_us_about_your_issue":null!==(s=cG[e])&&void 0!==s?s:"Tell_us_about_your_issue"},[]);return{trackCancelClick:(e,t)=>r("support_ticket_modal_click",i(e,t),"cancel_button_click"),trackContinueClick:(e,t,s,a)=>r("support_ticket_modal_click",i(e,t),"continue_button_click",a,{attachments:s}),trackBackClick:e=>r("support_ticket_modal_click",i(e),"back_button_click"),trackContinueWhereYouLeftOff:()=>r("support_ticket_modal_click","Resume_step","continue_where_you_left_off"),trackStartNewTicket:()=>r("support_ticket_modal_click","Resume_step","start_a_new_ticket"),trackBrowseFilesClick:()=>r("support_ticket_modal_click","Tell_us_about_your_issue","Browse_files_button"),trackDeleteAttachedFile:()=>r("support_ticket_modal_click","Tell_us_about_your_issue","delete_attached_file_click"),trackDescriptionAreaClick:()=>r("support_ticket_modal_click","Tell_us_about_your_issue","description_area_click"),trackCategoryClick:e=>r("support_ticket_modal_click","What_type_of_issue","category_button_click",null!=e?e:""),trackAppClick:(e,t)=>r("support_ticket_modal_click","Select_app","app_click",null!=e?e:"",{appId:t}),trackSkipClick:()=>r("support_ticket_modal_click","Select_app","skip_button_click"),trackThisMightHelpLoaded:()=>r("page loaded","This_might_help","this_might_help_loaded"),trackSummaryClick:()=>r("support_ticket_modal_click","This_might_help","summary_of_your_issue_click"),trackSuggestionsUrlClick:e=>r("support_ticket_modal_click","This_might_help","suggestions_url_clicked",null!=e?e:""),trackThisHelps:()=>r("support_ticket_modal_click","This_might_help","This_helps"),trackStillNeedHelp:()=>r("support_ticket_modal_click","This_might_help","still_need_help"),trackDocumentationClick:e=>r("support_ticket_modal_click",i(e),"documentation_button_click"),trackDiscordClick:e=>r("support_ticket_modal_click",i(e),"discord_community_button_click"),trackLoadingExitAnalyze:()=>r("support_ticket_modal_load","Analyze_your_issue","exit_modal"),trackLoadingExitCheckingSolution:()=>r("support_ticket_modal_load","Checking_for_solution","exit_modal"),trackTicketCreated:e=>r("support_ticket_created","ticket_created",void 0,void 0,{ticketId:e}),trackModalOpened:(s,n)=>{try{var r,i;const o={user_id:null!==(r=null==a?void 0:a.id)&&void 0!==r?r:null,app_id:null!=e?e:null,flow_id:null!==(i=null!=n?n:t)&&void 0!==i?i:null,source:l(),entry_point:null!=s?s:"Open_support_ticket"};dG("support_ticket_modal_opened",o)}catch(o){}},trackCustomEvent:(e,t,s,a)=>{e&&t&&s&&r(e,t,s,a)}}}function mG(e){let{onContinueDraft:t,onStartNew:s,onContinueWhereYouLeftOff:a,onStartNewTicket:n}=e;const[l,r]=(0,Y.useState)("continue");return(0,se.jsxs)("div",{className:"flex flex-col h-full flex-1",children:[(0,se.jsxs)("div",{className:"flex-1 flex flex-col gap-4",children:[(0,se.jsxs)("div",{className:"text-base text-slate-900 leading-relaxed",children:[(0,se.jsx)("p",{className:"mb-0",children:"You started creating a support ticket earlier."}),(0,se.jsx)("p",{children:"Choose how you'd like to proceed:"})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsxs)("button",{type:"button",onClick:()=>r("continue"),className:"flex items-center gap-3 p-3 rounded-lg border transition-colors text-left ".concat("continue"===l?"bg-slate-100 border-slate-900":"bg-white border-slate-200 hover:border-slate-300"),children:[(0,se.jsx)("div",{className:"w-4 h-4 rounded-full border flex items-center justify-center shrink-0 ".concat("continue"===l?"bg-slate-900 border-slate-900":"bg-white border-slate-300"),children:"continue"===l&&(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-white"})}),(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900",children:"Continue where you left off"}),(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"Restore your previous inputs and continue from the last step."})]})]}),(0,se.jsxs)("button",{type:"button",onClick:()=>r("new"),className:"flex items-center gap-3 p-3 rounded-lg border transition-colors text-left ".concat("new"===l?"bg-slate-100 border-slate-900":"bg-white border-slate-200 hover:border-slate-300"),children:[(0,se.jsx)("div",{className:"w-4 h-4 rounded-full border flex items-center justify-center shrink-0 ".concat("new"===l?"bg-slate-900 border-slate-900":"bg-white border-slate-300"),children:"new"===l&&(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-white"})}),(0,se.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900",children:"Start a new ticket"}),(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"Discard the draft and start a new support request."})]})]})]})]}),(0,se.jsx)("div",{className:"flex justify-end pt-4",children:(0,se.jsx)("button",{type:"button",onClick:()=>{"continue"===l?(null==a||a(),t()):(null==n||n(),s())},className:"px-6 py-2  bg-slate-900 hover:bg-slate-700 text-white text-sm font-medium rounded-md transition-colors shadow-sm",children:"Continue"})})]})}function xG(e){let{error:t,onClose:s,onRetry:a}=e;const n=t.isRateLimit;return(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,se.jsx)("div",{className:"w-full h-1 bg-slate-100 shrink-0",children:(0,se.jsx)("div",{className:"h-full bg-orange-500 w-full"})}),(0,se.jsx)("div",{className:"px-6 pt-6 pb-2 shrink-0",children:(0,se.jsx)("p",{className:"text-base font-medium leading-none text-[#737373]",children:"Submit support ticket"})}),(0,se.jsx)("div",{className:"flex-1 flex flex-col items-center justify-center px-6 py-8",children:(0,se.jsxs)("div",{className:"flex flex-col items-center max-w-sm text-center",children:[(0,se.jsx)("div",{className:"w-14 h-14 rounded-full flex items-center justify-center mb-5 bg-red-50",children:(0,se.jsx)(ad.A,{className:"w-7 h-7 text-red-500",strokeWidth:1.5})}),(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-900 mb-2",children:n?"Daily limit reached":"Something went wrong"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed mb-6",children:t.message}),(0,se.jsx)("div",{className:"flex flex-col gap-3 w-full",children:n?null:(0,se.jsxs)(se.Fragment,{children:[a&&(0,se.jsx)("button",{onClick:a,className:"w-full h-10 px-6 bg-slate-900 hover:bg-slate-800 text-white text-sm font-medium rounded-lg transition-colors",children:"Try again"}),(0,se.jsx)("button",{onClick:s,className:"w-full h-10 px-6 bg-slate-100 hover:bg-slate-200 text-slate-700 text-sm font-medium rounded-lg transition-colors",children:a?"Cancel":"Close"})]})})]})})]})}function hG(e){let{appId:t,flowId:s,onSubmit:a,onCancel:n,initialData:l}=e;const r=(0,Y.useMemo)(()=>function(){try{const e=localStorage.getItem(qY);if(!e)return null;const t=JSON.parse(e),s=6048e5;return Date.now()-t.savedAt>s?(YY(),null):t}catch(e){return null}}(),[]),[i,o]=(0,Y.useState)(!!r&&!l),[c,d]=(0,Y.useState)(1),u={issueDescription:(null==l?void 0:l.content)||"",category:(null==l?void 0:l.category)||null,selectedAppId:t,selectedAppName:null,selectedAppLink:t?"".concat(window.location.origin,"/apps/").concat(t,"/editor/preview"):null,additionalInfo:"",files:[]},[m,x]=(0,Y.useState)(u),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(!1),[j,y]=(0,Y.useState)(null),[N,w]=(0,Y.useState)(null),[_,k]=(0,Y.useState)(null),[C,A]=(0,Y.useState)(!1),[S,E]=(0,Y.useState)(null),T=uG(t,s),I=(0,Y.useRef)(C),P=(0,Y.useRef)(g);(0,Y.useEffect)(()=>{I.current=C,P.current=g},[C,g]),(0,Y.useEffect)(()=>()=>{I.current?T.trackLoadingExitAnalyze():P.current&&T.trackLoadingExitCheckingSolution()},[]),(0,Y.useEffect)(()=>{if(!i&&c>=1){(m.issueDescription.trim().length>0||m.files.length>0)&&function(e,t){const s={formData:e,currentStep:t,savedAt:Date.now()};try{localStorage.setItem(qY,JSON.stringify(s))}catch(a){}}(m,c)}},[m,c,i]);const L=()=>{r&&(x(r.formData),d(r.currentStep)),o(!1)},M=()=>{YY(),x(u),d(1),o(!1)},R=oG.length,D=oG.find(e=>e.id===c),F=null==D?void 0:D.component,O=c===R,U=()=>{const e=m.issueDescription.trim();return e.length<=100?e:e.substring(0,97)+"..."},B=()=>{let e=m.issueDescription;return m.additionalInfo&&(e+="\n\nAdditional info: ".concat(m.additionalInfo)),(m.selectedAppId||m.selectedAppName)&&(e+="\n\nApp: ".concat(m.selectedAppName||"Unknown"," (ID: ").concat(m.selectedAppId||t||"N/A",")")),m.selectedAppLink&&(e+="\nApp Link: ".concat(m.selectedAppLink)),e.trim()},z=async()=>{f(!0),p(null);try{const e=U(),s=B(),a=m.category||"other",n=await rY.requestAnswer(e,s,a,m.files,m.selectedAppId||t);p({answer_exists:n.answer_exists||!1,answer:n.answer||"",reasoning:n.reasoning||"",issue_summary:n.issue_summary||"",title:n.title||""})}catch(e){p({answer_exists:!1,answer:""})}finally{f(!1)}},H=async()=>{var e;const t=1===c?m.files.length>0:void 0,s=2===c&&null!==(e=m.category)&&void 0!==e?e:void 0;if(T.trackContinueClick(c,!1,t,s),1===c){const e=m.issueDescription.trim();return 0===e.length?void y("Please add a description"):e.length<20?void y("Please add a bit more detail. Minimum is 20 characters."):(d(2),void(async()=>{A(!0),k(null);try{const e=await rY.classifyIssue(m.issueDescription);k(e.categories||[])}catch(e){k(null)}finally{A(!1)}})())}if(3===c){const e=m.category&&$Y.includes(m.category);return m.selectedAppId||m.selectedAppLink||e?(m.hasUrlError&&x(e=>(0,ue.A)((0,ue.A)({},e),{},{hasUrlError:!1})),d(4),void z()):void w("Choose one of your apps or add a link so we know where the issue is happening.")}O?W():d(c+1)},V=()=>{c>1?(T.trackBackClick(c),d(c-1),4===c&&p(null),2===c&&y(null),3===c&&w(null)):(T.trackCancelClick(c),n())},W=async()=>{if(T.trackThisHelps(),h&&h.answer_exists)try{const e="category: ".concat(m.category,"\ntitle: ").concat(U(),"\n\ncontent: ").concat(B());await rY.logAnswer(null,h,!0,e)}catch(e){}YY(),n()},q=async()=>{T.trackStillNeedHelp(),b(!0);try{const e={title:(null==h?void 0:h.title)||U(),content:B(),category:m.category||"other",app_id:m.selectedAppId||t||null,app_link:m.selectedAppLink||null,file_urls:m.files},s=await Zq.create(e);if(T.trackTicketCreated(s.id),h&&h.answer_exists)try{const e="category: ".concat(m.category,"\ntitle: ").concat(U(),"\n\ncontent: ").concat(B());await rY.logAnswer(s.id,h,!1,e)}catch(i){}YY(),a(s)}catch(o){var e,s,n,l,r;const t=null==o||null===(e=o.response)||void 0===e?void 0:e.status,a=429===t,i=(null==o||null===(s=o.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.message)||(null==o||null===(l=o.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail)||"Failed to submit your support ticket. Please try again.";E({message:i,isRateLimit:a,statusCode:t})}finally{b(!1)}},G=i?0:c/R*100,K=(()=>{switch(c){case 1:case 4:default:return!0;case 2:return null!==m.category;case 3:return!m.hasUrlError}})();return S?(0,se.jsx)(xG,{error:S,onClose:n,onRetry:S.isRateLimit?void 0:()=>{E(null)}}):i?(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,se.jsx)("div",{className:"w-full h-2 bg-slate-100 shrink-0",children:(0,se.jsx)("div",{className:"h-full bg-orange-500 transition-all duration-300 ease-out",style:{width:"0%"}})}),(0,se.jsx)("div",{className:"px-6 pt-6 pb-2 shrink-0",children:(0,se.jsx)("p",{className:"text-base font-medium leading-none text-neutral-600",children:"Submit a support ticket"})}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col px-6 py-2 min-h-0 overflow-y-auto",children:[(0,se.jsx)("h2",{className:"mb-5 text-2xl font-medium leading-8 text-slate-900 shrink-0",children:"Continue your support request?"}),(0,se.jsx)(mG,{onContinueDraft:L,onStartNew:M,onContinueWhereYouLeftOff:T.trackContinueWhereYouLeftOff,onStartNewTicket:T.trackStartNewTicket})]})]}):(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,se.jsx)("div",{className:"w-full h-1 bg-slate-100 shrink-0",children:(0,se.jsx)("div",{className:"h-full bg-orange-500 transition-all duration-300 ease-out",style:{width:"".concat(G,"%")}})}),(0,se.jsx)("div",{className:"px-6 pt-6 pb-2 shrink-0",children:(0,se.jsx)("p",{className:"text-base font-medium leading-none text-[#737373]",children:"Submit support ticket"})}),(0,se.jsx)("div",{className:"flex-1 flex flex-col px-6 py-2 min-h-0 ".concat(3!==c?"overflow-y-auto":"overflow-hidden"),children:(0,se.jsx)("div",{className:"flex-1 flex flex-col min-h-0",children:F&&(0,se.jsx)(F,{onNext:H,onBack:V,formData:m,setFormData:x,botResponse:h,isLoadingBot:g,error:1===c?j:3===c?N:null,setError:1===c?y:3===c?w:void 0,suggestedCategories:_,isLoadingCategories:C,title:null==D?void 0:D.title,appId:t,onStillNeedHelp:q,isSubmitting:v,biEvents:T})})}),3===c&&N&&(0,se.jsxs)("div",{className:"flex items-center gap-1.5 px-6 shrink-0",children:[(0,se.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"shrink-0",children:[(0,se.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"#dc2626",strokeWidth:"1.5"}),(0,se.jsx)("path",{d:"M12 8V12",stroke:"#dc2626",strokeWidth:"1.5",strokeLinecap:"round"}),(0,se.jsx)("circle",{cx:"12",cy:"16",r:"1",fill:"#dc2626"})]}),(0,se.jsx)("p",{className:"text-red-600 text-sm",children:N})]}),(0,se.jsxs)("div",{className:"flex px-6 py-4 shrink-0 bg-white ".concat(O?"flex-col gap-3 sm:flex-row sm:justify-between sm:items-center":"flex-row justify-between items-center gap-3"),children:[(0,se.jsx)("button",{onClick:V,disabled:v||g||C,className:"h-9 sm:h-10 px-4 py-2 border border-[#E5E5E5] hover:border-slate-400 bg-white hover:bg-[#E5E5E5] text-[#0A0A0A] text-sm font-medium rounded-md transition-colors disabled:opacity-50 shadow-sm ".concat(O?"w-full sm:w-auto order-2 sm:order-1":""),children:1===c?"Cancel":"Back"}),(0,se.jsxs)("div",{className:"flex items-center gap-3 ".concat(O?"order-1 sm:order-2 w-full sm:w-auto":""),children:[O&&(0,se.jsx)("button",{onClick:q,disabled:v||g||C,className:"flex-1 sm:flex-none h-9 sm:h-10 px-4 py-2 bg-[#F5F5F5] hover:bg-slate-200 text-black text-sm font-medium rounded-md transition-colors disabled:opacity-50",children:v?(0,se.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,se.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-slate-400 border-t-slate-600 rounded-full"}),"Submitting..."]}):(0,se.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,se.jsx)(WY.A,{className:"w-4 h-4"}),"Still need help"]})}),3===c&&m.category&&$Y.includes(m.category)&&(0,se.jsx)("button",{onClick:()=>{T.trackSkipClick(),d(4),z()},disabled:v||g||C||m.hasUrlError,className:"h-9 sm:h-10 px-6 py-2 bg-white border border-[#e5e5e5] text-[#0a0a0a] text-sm font-medium rounded-md shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] hover:bg-slate-50 transition-colors disabled:opacity-50",children:"Skip"}),(0,se.jsx)("button",{onClick:H,disabled:v||g||C||!K,className:"h-9 sm:h-10 px-6 py-2 bg-slate-900 hover:bg-slate-700 text-white text-sm font-medium rounded-md transition-colors shadow-sm disabled:opacity-50 ".concat(O?"flex-1 sm:flex-none":""),children:O?"This helps":"Continue"})]})]})]})}const pG={authentication:Vc.A,billing:su.A,bug_report:NS.A,integrations_and_backend_functions:yS.A,chat_issues:lU.A,security:HO.A,other:Pj.A},gG={open:{label:"Open",color:"bg-orange-100 text-orange-800 border-orange-200",icon:jS.A},resolved:{label:"Resolved",color:"bg-green-100 text-green-800 border-green-200",icon:sd.A}},fG=e=>{var t,s,a,n,l;let{ticket:r,onClick:i,isSelected:o}=e;const c=(null===(t=gG[r.ticket_status])||void 0===t?void 0:t.icon)||ad.A,d=pG[r.category]||Pj.A;return(0,se.jsxs)(Es,{className:"group hover:shadow-lg transition-all duration-300 cursor-pointer ".concat(o?"border-orange-500 bg-orange-50 shadow-lg":"border-slate-200 hover:border-slate-300"),onClick:()=>i(r),children:[(0,se.jsx)(Ts,{className:"pb-3",children:(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)(Is,{className:"text-lg font-semibold truncate transition-colors ".concat(o?"text-orange-900":"text-slate-900 group-hover:text-slate-700"),children:r.title}),(0,se.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,se.jsxs)(gs,{variant:"secondary",className:"".concat(null===(s=gG[r.ticket_status])||void 0===s?void 0:s.color," border text-xs font-medium"),children:[(0,se.jsx)(c,{className:"w-3 h-3 mr-1"}),null===(a=gG[r.ticket_status])||void 0===a?void 0:a.label]}),r.category&&(0,se.jsxs)(gs,{variant:"outline",className:"text-xs",children:[(0,se.jsx)(d,{className:"w-3 h-3 mr-1"}),r.category.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())]})]})]}),(0,se.jsxs)("div",{className:"ml-4 flex items-center",children:[(0,se.jsx)(H_.A,{className:"w-3 h-3 mr-2 text-slate-400"}),(e=>{if(!e)return"Not available";const t=He().utc(e);return(0,se.jsxs)("div",{className:"text-right text-xs text-slate-500",children:[(0,se.jsx)("div",{className:"font-medium",children:t.format("MMM DD, YYYY")}),(0,se.jsx)("div",{className:"text-slate-400 mt-0.5",children:t.fromNow()})]})})(r.created_date)]})]})}),(0,se.jsxs)(Ls,{className:"pt-0",children:[(0,se.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed line-clamp-2 mb-3",children:r.content}),(0,se.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[(0,se.jsx)("div",{className:"flex items-center space-x-4",children:r.app_id&&(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(Gq.A,{className:"w-3 h-3 mr-1"}),(0,se.jsxs)("span",{children:["App: ",r.app_id]})]})}),(0,se.jsx)(gs,{variant:"outline",className:"text-xs ".concat(null!==(n=r.user_subscription_tier)&&void 0!==n&&n.toLowerCase().includes("elite")?"border-purple-200 text-purple-700":null!==(l=r.user_subscription_tier)&&void 0!==l&&l.toLowerCase().includes("pro")?"border-blue-200 text-blue-700":"border-gray-200 text-gray-700"),children:r.user_subscription_tier||"free"})]})]})]})},vG=e=>{let{filter:t,onCreateTicket:s}=e;return(0,se.jsxs)("div",{className:"text-center py-16",children:[(0,se.jsx)("div",{className:"mx-auto w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-6",children:(0,se.jsx)(Bq.A,{className:"w-12 h-12 text-slate-400"})}),(0,se.jsxs)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:["No ","open"===t?"Open":"closed"===t?"Closed":""," ","Tickets"]}),(0,se.jsx)("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:"open"===t?"You don't have any open support tickets at the moment.":"closed"===t?"No closed tickets found.":"You haven't submitted any support tickets yet."}),(0,se.jsxs)(zt,{className:"bg-orange-500 hover:bg-orange-600",onClick:()=>s("lower_button"),children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-2"}),"Create New Ticket"]})]})};function bG(){const[e,t]=(0,Z.useSearchParams)(),s=(0,J.Zp)(),{toast:a}=ao(),n=qu(),l=e.get("appId"),r="true"===e.get("openNew"),[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)(!0),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)("open"),[p,g]=(0,Y.useState)(null),{hasFlag:f}=ej(),v=f("new-support-flow"),[b,j]=(0,Y.useState)(null),[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)(!1),[k,C]=(0,Y.useState)(null),A=function(){const e=Hq();return{pageView:()=>{Fu.track("support_my_tickets_page_view",e.sessionContext,{},{useBeacon:!0}).catch()},newTicketClick:()=>{Fu.track("support_my_tickets_new_ticket_click",e.sessionContext,{},{useBeacon:!0}).catch()}}}(),S=uG(l,k);(0,Y.useEffect)(()=>{if(r){const s=(0,xw.A)();C(s),S.trackModalOpened("Open_support_ticket",s),_(!0);const a=new URLSearchParams(e);a.delete("openNew");const n=a.get("content"),l=a.get("title"),r=a.get("category");g({content:n,title:l,category:r}),a.delete("content"),a.delete("title"),a.delete("category"),t(a,{replace:!0})}},[r,e,t]),(0,Y.useEffect)(()=>{E(),A.pageView()},[l]);const E=async()=>{try{d(!0),m(null);const e=await Zq.list("-updated_date",1e3);e&&1e3===e.length&&a({title:"Ticket Limit Reached",description:"There are more tickets than can be loaded. Only the top 1000 most recent tickets were loaded.",variant:"default"});let t=e||[];l&&(t=t.filter(e=>e.app_id===l)),o(t)}catch(e){m("Failed to load support tickets. Please try again.")}finally{d(!1)}},T=e=>{j(e),N(!0)},I=e=>{A.newTicketClick();const t=(0,xw.A)();C(t),S.trackModalOpened(e,t),_(!0)},P=async e=>{_(!1),await E();const t=await Zq.list("-updated_date",1e3);t&&1e3===t.length&&a({title:"Ticket Limit Reached",description:"There are more tickets than can be loaded. Only the top 1000 most recent tickets were loaded.",variant:"default"});let s=t||[];l&&(s=s.filter(e=>e.app_id===l));const n=s.find(t=>t.title===e.title&&t.content===e.content);n&&(j(n),N(!0),o(s))},L=()=>{_(!1)},M=(()=>{switch(x){case"open":return i.filter(e=>"open"===e.ticket_status);case"closed":return i.filter(e=>"resolved"===e.ticket_status);default:return i}})(),R=i.filter(e=>"open"===e.ticket_status).length,D=i.filter(e=>"resolved"===e.ticket_status).length;return c?(0,se.jsx)("div",{className:"w-full max-w-6xl mx-auto px-6 py-12",children:(0,se.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,se.jsx)("div",{className:"h-8 bg-slate-200 rounded w-1/3"}),(0,se.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,se.jsx)("div",{className:"h-32 bg-slate-200 rounded-lg"},e))})]})}):u?(0,se.jsx)("div",{className:"w-full max-w-6xl mx-auto px-6 py-12",children:(0,se.jsxs)("div",{className:"text-center py-16",children:[(0,se.jsx)("div",{className:"mx-auto w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,se.jsx)(ad.A,{className:"w-12 h-12 text-red-500"})}),(0,se.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Error Loading Tickets"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:u}),(0,se.jsx)(zt,{onClick:E,variant:"outline",children:"Try Again"})]})}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"w-full max-w-6xl mx-auto px-4 py-6 sm:px-6 sm:py-12",children:[(0,se.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between mb-4",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:space-x-4",children:[(0,se.jsxs)(zt,{variant:"ghost",size:"sm",onClick:()=>{s("/support")},className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100 w-fit",children:[(0,se.jsx)(Vs.A,{className:"w-4 h-4 mr-2"}),"Back to Support"]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:"My Support Tickets"}),l&&(0,se.jsxs)("p",{className:"text-slate-600 mt-1 text-sm sm:text-base",children:["Showing tickets for App:"," ",(0,se.jsx)("span",{className:"font-mono text-xs sm:text-sm break-all",children:l})]})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,se.jsxs)(zt,{onClick:E,variant:"outline",size:"sm",children:[(0,se.jsx)(Kq.A,{className:"w-4 h-4 sm:mr-2"}),(0,se.jsx)("span",{className:"hidden sm:inline",children:"Refresh"})]}),(0,se.jsxs)(zt,{className:"bg-orange-500 hover:bg-orange-600",size:"sm",onClick:()=>I("upper_button"),children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-2"}),"New Ticket"]})]})]}),l&&(0,se.jsx)("div",{className:"mb-4 sm:mb-6",children:(0,se.jsxs)("div",{className:"inline-flex items-center gap-2 bg-blue-50 border border-blue-200 rounded-lg px-3 py-2 sm:px-4 max-w-full",children:[(0,se.jsx)(By.A,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),(0,se.jsxs)("span",{className:"text-xs sm:text-sm font-medium text-blue-800 truncate",children:["Filtered by App: ",(0,se.jsx)("span",{className:"font-mono break-all",children:l})]}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>{window.location.href="/support/conversations"},className:"h-auto p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 flex-shrink-0",children:(0,se.jsx)(la.A,{className:"w-4 h-4"})})]})})]}),(0,se.jsxs)(ji,{value:x,onValueChange:h,className:"mb-6",children:[(0,se.jsxs)(yi,{className:"grid w-full grid-cols-3 sm:w-auto sm:inline-grid lg:w-96",children:[(0,se.jsxs)(Ni,{value:"open",className:"flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3",children:[(0,se.jsx)(jS.A,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("span",{className:"hidden sm:inline",children:"Open "}),"(",R,")"]})]}),(0,se.jsxs)(Ni,{value:"closed",className:"flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3",children:[(0,se.jsx)(sd.A,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("span",{className:"hidden sm:inline",children:"Closed "}),"(",D,")"]})]}),(0,se.jsxs)(Ni,{value:"all",className:"flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-3",children:[(0,se.jsx)(Bq.A,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),(0,se.jsxs)("span",{children:[(0,se.jsx)("span",{className:"hidden sm:inline",children:"All "}),"(",i.length,")"]})]})]}),(0,se.jsx)(wi,{value:x,className:"mt-6",children:0===M.length?(0,se.jsx)(vG,{filter:x,onCreateTicket:I}):(0,se.jsx)("div",{className:"grid grid-cols-1 gap-4",children:M.map(e=>(0,se.jsx)(fG,{ticket:e,onClick:T,isSelected:(null==b?void 0:b.id)===e.id},e.id))})})]})]}),!n&&(0,se.jsx)(ma,{open:w,onOpenChange:_,children:(0,se.jsx)(fa,{className:v?"max-w-[calc(100vw-2rem)] sm:max-w-[650px] h-[564px] font-base44 p-0 flex flex-col overflow-hidden":"max-w-6xl max-h-[90vh] overflow-y-auto font-base44 p-0 flex flex-col",children:v?(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,se.jsx)(hG,{appId:l,flowId:k,onSubmit:P,onCancel:L,initialData:p}),(0,se.jsx)("div",{className:"w-full border-t border-gray-200 bg-gray-50 px-6 py-4 shrink-0",children:(0,se.jsxs)("p",{className:"text-sm text-black font-semibold",children:["Need immediate help?"," ",(0,se.jsx)("span",{className:"font-normal",children:"Check our "}),(0,se.jsx)("a",{onClick:()=>A.helpTypeClick({type:"documentation"}),href:"https://docs.base44.com",target:"_blank",rel:"noopener noreferrer",className:"font-normal hover:text-orange-600 underline py-2 -my-1 inline-block",children:"documentation"})," ",(0,se.jsx)("span",{className:"font-normal",children:"or join our "}),(0,se.jsx)("a",{onClick:()=>A.helpTypeClick({type:"discord"}),href:"https://discord.gg/ThpYPZpVts",target:"_blank",rel:"noopener noreferrer",className:"font-normal hover:text-orange-600 underline py-2 -my-1 inline-block",children:"Discord community"}),"."]})})]}):(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,se.jsx)("div",{className:"p-6 pb-0 shrink-0",children:(0,se.jsx)(va,{children:(0,se.jsx)(ja,{className:"text-base font-medium leading-none text-neutral-600",children:"Submit support ticket"})})}),(0,se.jsx)(VY,{appId:l,onSubmit:P,onCancel:L})]})})}),n&&(0,se.jsx)(Fr,{open:w,onOpenChange:_,children:(0,se.jsxs)(Vr,{side:"bottom",className:"h-[calc(100dvh-96px)] rounded-t-[10px] p-0 flex flex-col font-base44 [&>button]:hidden",children:[(0,se.jsx)("div",{className:"flex justify-center pt-4 shrink-0",children:(0,se.jsx)("div",{className:"w-[120px] h-2 bg-slate-200 rounded-full"})}),v?(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,se.jsx)(hG,{appId:l,flowId:k,onSubmit:P,onCancel:L,initialData:p}),(0,se.jsx)("div",{className:"w-full border-t border-slate-200 bg-slate-50 px-6 py-3 shrink-0",children:(0,se.jsxs)("p",{className:"text-sm text-black",children:[(0,se.jsx)("span",{className:"font-semibold",children:"Need immediate help?"})," ","Check our"," ",(0,se.jsx)("a",{onClick:()=>A.helpTypeClick({type:"documentation"}),href:"https://docs.base44.com",target:"_blank",rel:"noopener noreferrer",className:"underline py-2 -my-1 inline-block",children:"documentation"})," ","or join our"," ",(0,se.jsx)("a",{onClick:()=>A.helpTypeClick({type:"discord"}),href:"https://discord.gg/ThpYPZpVts",target:"_blank",rel:"noopener noreferrer",className:"underline py-2 -my-1 inline-block",children:"Discord community"}),"."]})})]}):(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 px-4 pt-4",children:[(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsx)("p",{className:"text-sm text-slate-500 leading-5",children:"Submit a support ticket"}),(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Tell us about your issue"})]}),(0,se.jsx)(VY,{appId:l,onSubmit:P,onCancel:L,initialData:p})]})]})}),(0,se.jsx)(SY,{conversationId:null==b?void 0:b.id,isOpen:y,onClose:()=>{N(!1),j(null)},ticketTitle:null==b?void 0:b.title,ticket:b,onTicketUpdated:(e,t,s,a)=>{if(o(n=>n.map(n=>{if(n.id===e){if(a){let e="admin";if(a.messages&&a.messages.length>0){e="user"===a.messages[a.messages.length-1].role?"admin":"user"}return(0,ue.A)((0,ue.A)((0,ue.A)({},n),a),{},{pending_response_from:e,updated_date:(new Date).toISOString()})}if("message_sent"===t){const e="user"===s;return(0,ue.A)((0,ue.A)({},n),{},{pending_response_from:e?"admin":"user",updated_date:(new Date).toISOString()})}return n}return n})),b&&b.id===e&&a){let e="admin";if(a.messages&&a.messages.length>0){const t=a.messages[a.messages.length-1];e="user"===t.role?"admin":"user"}j(t=>(0,ue.A)((0,ue.A)((0,ue.A)({},t),a),{},{pending_response_from:e,updated_date:(new Date).toISOString()}))}}})]})}function jG(e){let{error:t,onRetry:s}=e;return(0,se.jsx)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:(0,se.jsxs)("div",{className:"text-center py-16",children:[(0,se.jsx)("div",{className:"mx-auto w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,se.jsx)(ad.A,{className:"w-12 h-12 text-red-500"})}),(0,se.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Error Loading Tickets"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:t}),(0,se.jsx)(zt,{onClick:s,variant:"outline",children:"Try Again"})]})})}var yG=s(22736),NG=s(35503),wG=s(90887);const _G=e=>e?e.replace(/_ils$/,""):"free",kG={authentication:Vc.A,billing:su.A,bug_report:NS.A,domain:KP.A,integrations_and_backend_functions:yS.A,chat_issues:lU.A,security:HO.A,social_post_bonus_credits:Bz.A,other:Pj.A},CG=(jS.A,sd.A,{starter:{label:"Starter",color:"bg-green-100 text-green-800 border-green-200"},starter_yearly:{label:"Starter (Yearly)",color:"bg-green-100 text-green-800 border-green-200"},starter25:{label:"Starter 25",color:"bg-emerald-100 text-emerald-800 border-emerald-200"},starter25_yearly:{label:"Starter 25 (Yearly)",color:"bg-emerald-100 text-emerald-800 border-emerald-200"},builder:{label:"Builder",color:"bg-blue-100 text-blue-800 border-blue-200"},builder_yearly:{label:"Builder (Yearly)",color:"bg-blue-100 text-blue-800 border-blue-200"},pro:{label:"Pro",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},pro_yearly:{label:"Pro (Yearly)",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},elite:{label:"Elite",color:"bg-purple-100 text-purple-800 border-purple-200"},elite_yearly:{label:"Elite (Yearly)",color:"bg-purple-100 text-purple-800 border-purple-200"},elite_2:{label:"Elite 2",color:"bg-violet-100 text-violet-800 border-violet-200"},elite_2_yearly:{label:"Elite 2 (Yearly)",color:"bg-violet-100 text-violet-800 border-violet-200"},elite_3:{label:"Elite 3",color:"bg-pink-100 text-pink-800 border-pink-200"},elite_3_yearly:{label:"Elite 3 (Yearly)",color:"bg-pink-100 text-pink-800 border-pink-200"},elite_4:{label:"Elite 4",color:"bg-pink-100 text-pink-800 border-pink-200"},elite_4_yearly:{label:"Elite 4 (Yearly)",color:"bg-pink-100 text-pink-800 border-pink-200"},free:{label:"Free",color:"bg-gray-100 text-gray-800 border-gray-200"},enterprise:{label:"Enterprise",color:"bg-amber-100 text-amber-800 border-amber-200"}});function AG(e){let{userEmail:t,userName:s,currentTicketId:a}=e;const[n,l]=(0,Y.useState)([]),[r,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(0);(0,Y.useEffect)(()=>{t&&h()},[t]);const h=async()=>{try{i(!0);const e=(await Qq.getTickets({created_by:t,show_resolved:!0})||[]).sort((e,t)=>new Date(t.created_date)-new Date(e.created_date));l(e)}catch(o){c(o)}finally{i(!1)}};if(r)return(0,se.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-400"})});if(o)return(0,se.jsx)("div",{className:"text-xs text-red-600 p-2",children:"Failed to load tickets"});if(0===n.length)return(0,se.jsx)("div",{className:"text-xs text-slate-500 italic p-2",children:"No previous tickets found"});const p=e=>{if(!e)return"";const t=He().utc(e),s=He().utc().startOf("day");return t.isSame(s,"day")?t.format("HH:mm"):t.format("MMM DD, HH:mm")},g=e=>{var t,s,a;let{message:n,isInitialContent:l=!1,displayUserName:r=null}=e;const i="user"===n.role||l,o=null===(t=n.additional_message_params)||void 0===t?void 0:t.is_admin_message,c=null===(s=n.metadata)||void 0===s?void 0:s.created_by_full_name;return(0,se.jsx)("div",{className:"flex ".concat(i?"justify-end":"justify-start"," mb-4"),children:(0,se.jsxs)("div",{className:"flex max-w-[80%] ".concat(i?"flex-row-reverse":"flex-row"," items-start space-x-3"),children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ".concat(i?"bg-slate-200 text-slate-600 ml-3":o?"bg-slate-700 text-white mr-3":"bg-teal-100 text-teal-600 mr-3"),children:i?(0,se.jsx)(ay.A,{size:16}):o?(0,se.jsx)(HO.A,{size:16}):(0,se.jsx)(wP.A,{size:16})}),(0,se.jsxs)("div",{className:"flex flex-col ".concat(i?"items-end":"items-start"),children:[i&&r&&(0,se.jsx)("div",{className:"mb-2 flex items-center space-x-2",children:(0,se.jsx)("div",{className:"text-xs font-medium text-slate-700",children:r})}),o&&c&&(0,se.jsxs)("div",{className:"mb-2 flex items-center space-x-2",children:[(0,se.jsx)("div",{className:"text-xs font-medium text-slate-700",children:c.split(" ")[0]}),(0,se.jsx)("div",{className:"w-1 h-1 bg-slate-300 rounded-full"}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"Support Team"})]}),(0,se.jsx)("div",{className:"rounded-2xl px-4 py-3 max-w-full ".concat(i?"bg-slate-700 text-white":"bg-white text-slate-900 border border-slate-200 shadow-sm"),children:(0,se.jsx)("div",{className:"text-sm leading-relaxed prose prose-sm max-w-[550px]",children:(0,se.jsx)(db.oz,{components:{p:e=>{let{children:t}=e;return(0,se.jsx)("p",{className:"mb-2 last:mb-0",children:t})},ul:e=>{let{children:t}=e;return(0,se.jsx)("ul",{className:"list-disc list-inside mb-2 last:mb-0",children:t})},ol:e=>{let{children:t}=e;return(0,se.jsx)("ol",{className:"list-decimal list-inside mb-2 last:mb-0",children:t})},li:e=>{let{children:t}=e;return(0,se.jsx)("li",{className:"mb-1",children:t})},code:e=>{let{children:t,inline:s}=e;return s?(0,se.jsx)("code",{className:"px-1 py-0.5 rounded text-xs font-mono ".concat(i?"bg-slate-600 text-slate-200":"bg-slate-100 text-slate-800"),children:t}):(0,se.jsx)("pre",{className:"p-2 rounded text-xs font-mono overflow-x-auto ".concat(i?"bg-slate-600 text-slate-200":"bg-slate-100 text-slate-800"),children:(0,se.jsx)("code",{children:t})})},blockquote:e=>{let{children:t}=e;return(0,se.jsx)("blockquote",{className:"border-l-4 pl-3 italic ".concat(i?"border-slate-400":"border-slate-300"),children:t})},strong:e=>{let{children:t}=e;return(0,se.jsx)("strong",{className:"font-semibold",children:t})},em:e=>{let{children:t}=e;return(0,se.jsx)("em",{className:"italic",children:t})},h1:e=>{let{children:t}=e;return(0,se.jsx)("h1",{className:"text-lg font-bold mb-2",children:t})},h2:e=>{let{children:t}=e;return(0,se.jsx)("h2",{className:"text-base font-bold mb-2",children:t})},h3:e=>{let{children:t}=e;return(0,se.jsx)("h3",{className:"text-sm font-bold mb-1",children:t})}},children:n.content})})}),(0,se.jsx)("div",{className:"flex items-center gap-2 mt-1 ".concat(i?"justify-end":"justify-start"),children:(0,se.jsx)("div",{className:"text-xs text-slate-500",children:p((null===(a=n.metadata)||void 0===a?void 0:a.created_date)||n.created_date)})})]})]})})};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[n.slice(0,10).map((e,t)=>{const s=e.id===a;return(0,se.jsxs)("div",{onClick:()=>((e,t)=>{u(e),x(t)})(e,t),className:"block p-2 rounded-lg border transition-colors group cursor-pointer ".concat(s?"border-teal-500 bg-teal-50 ring-1 ring-teal-500":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"),children:[(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h4",{className:"text-xs font-medium text-slate-900 line-clamp-2 group-hover:text-slate-700",children:e.title}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("div",{className:"flex items-center space-x-2",children:"resolved"===e.ticket_status?(0,se.jsxs)(gs,{variant:"secondary",className:"text-[10px] bg-green-100 text-green-800 border-green-200 h-auto py-0.5 px-1",children:[(0,se.jsx)(sd.A,{className:"w-2.5 h-2.5 mr-0.5"}),"Resolved"]}):(0,se.jsxs)(gs,{variant:"secondary",className:"text-[10px] h-auto py-0.5 px-1 ".concat("admin"===e.pending_response_from?"bg-orange-100 text-orange-800 border-orange-200":"bg-blue-100 text-blue-800 border-blue-200"),children:[(0,se.jsx)(jS.A,{className:"w-2.5 h-2.5 mr-0.5"}),"admin"===e.pending_response_from?"Pending Admin":"Pending User"]})}),(0,se.jsx)("span",{className:"text-[10px] text-slate-500",children:He().utc(e.created_date).fromNow()})]}),e.category&&(0,se.jsxs)("div",{className:"flex items-center text-[10px] text-slate-600",children:[(0,se.jsx)(Xx.A,{className:"w-2.5 h-2.5 mr-1"}),(0,se.jsx)("span",{className:"capitalize",children:e.category.replace(/_/g," ")})]})]}),(0,se.jsx)("div",{className:"flex items-center justify-end mt-1",children:s?(0,se.jsx)("span",{className:"text-[10px] text-teal-600 font-medium",children:"Current ticket"}):(0,se.jsx)(Rj.A,{className:"w-2.5 h-2.5 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})})]},e.id)}),n.length>10&&(0,se.jsxs)("div",{className:"text-[10px] text-slate-500 text-center py-2",children:["Showing 10 of ",n.length," tickets"]})]}),(0,se.jsx)(ma,{open:!!d,onOpenChange:e=>!e&&u(null),children:(0,se.jsx)(gt.Portal,{children:(0,se.jsxs)(gt.Content,{className:de("fixed left-[50%] top-[50%] z-50 grid w-[60vw] h-[85vh] max-h-[85vh] translate-x-[-50%] translate-y-[-50%] gap-4 border-2 border-orange-500 bg-background p-6 shadow-2xl duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg flex flex-col ring-4 ring-orange-500/20"),children:[(0,se.jsxs)(va,{className:"flex-shrink-0 pr-10",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-slate-200",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>{if(m>0){const e=n.slice(0,10),t=m-1;x(t),u(e[t])}},disabled:0===m,className:"h-8 w-8 p-0",children:(0,se.jsx)(vs.A,{className:"w-4 h-4"})}),(0,se.jsxs)("span",{className:"text-sm text-slate-600 font-medium min-w-[80px] text-center",children:[m+1," of ",Math.min(n.length,10)]}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>{const e=n.slice(0,10);if(m<e.length-1){const t=m+1;x(t),u(e[t])}},disabled:m>=Math.min(n.length,10)-1,className:"h-8 w-8 p-0",children:(0,se.jsx)(bs.A,{className:"w-4 h-4"})})]}),(0,se.jsxs)(zt,{onClick:()=>{return e=null==d?void 0:d.id,void window.open("/support/admin/conversations?conversationId=".concat(e),"_blank");var e},className:"bg-orange-500 hover:bg-orange-600 text-white",size:"sm",children:[(0,se.jsx)(Rj.A,{className:"w-4 h-4 mr-2"}),"Open in New Tab"]})]}),(0,se.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)(ja,{className:"text-xl font-semibold text-slate-900 mb-3",children:null==d?void 0:d.title}),(0,se.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:["resolved"===(null==d?void 0:d.ticket_status)?(0,se.jsxs)(gs,{variant:"secondary",className:"bg-green-100 text-green-800 border-green-200",children:[(0,se.jsx)(sd.A,{className:"w-3 h-3 mr-1"}),"Resolved"]}):(0,se.jsxs)(gs,{variant:"secondary",className:"bg-orange-100 text-orange-800 border-orange-200",children:[(0,se.jsx)(jS.A,{className:"w-3 h-3 mr-1"}),"Open"]}),(null==d?void 0:d.category)&&(0,se.jsxs)(gs,{variant:"outline",className:"text-xs",children:[(0,se.jsx)(Xx.A,{className:"w-3 h-3 mr-1"}),d.category.replace(/_/g," ")]}),(0,se.jsxs)("span",{className:"text-sm text-slate-600",children:["Created ",He().utc(null==d?void 0:d.created_date).format("MMM DD, YYYY")]})]})]})})]}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0 mt-4 px-4",children:(0,se.jsx)("div",{children:null!=d&&d.messages&&d.messages.length>0?d.messages.map((e,t)=>(0,se.jsx)(g,{message:e,displayUserName:"user"===e.role?s:null},e.id||t)):(null==d?void 0:d.content)&&(0,se.jsx)(g,{message:{content:d.content,role:"user",created_date:d.created_date,metadata:{created_date:d.created_date}},isInitialContent:!0,displayUserName:s})})}),(0,se.jsxs)(gt.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,se.jsx)(la.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"sr-only",children:"Close"})]})]})})})]})}function SG(){const e=function(){const e=(0,Z.useSearchParams)()[0].get("appId"),{user:t}=wd();return{sessionContext:{app_id:e,user_id:null==t?void 0:t.id}}}(),t=(0,Y.useRef)({});return{escalateClick:()=>{var s,a,n,l,r,i,o,c,d,u,m;Fu.track("support_admin_escalate_click",e.sessionContext,{ticket_id:null!==(s=null===(a=t.current.supportConversation)||void 0===a?void 0:a.id)&&void 0!==s?s:"",created_by_email:null!==(n=null===(l=t.current.supportConversation)||void 0===l?void 0:l.created_by)&&void 0!==n?n:"",from_category:null!==(r=null===(i=t.current.supportConversation)||void 0===i?void 0:i.category)&&void 0!==r?r:"",internal_note:null!==(o=null===(c=t.current.supportConversation)||void 0===c?void 0:c.internal_notes)&&void 0!==o?o:"",last_user_message_id:null!==(d=null===(u=EG(null===(m=t.current.supportConversation)||void 0===m?void 0:m.messages,"user"))||void 0===u?void 0:u.id)&&void 0!==d?d:"not_found"}).catch()},unescalateClick:()=>{var s,a,n,l,r,i,o,c,d,u,m,x;const h=null===(s=EG(null===(a=t.current.supportConversation)||void 0===a?void 0:a.messages,"assistant"))||void 0===s?void 0:s.id,p=null===(n=EG(null===(l=t.current.supportConversation)||void 0===l?void 0:l.messages,"user"))||void 0===n?void 0:n.id;Fu.track("support_admin_unescalate_click",e.sessionContext,{ticket_id:null!==(r=null===(i=t.current.supportConversation)||void 0===i?void 0:i.id)&&void 0!==r?r:"",created_by_email:null!==(o=null===(c=t.current.supportConversation)||void 0===c?void 0:c.created_by)&&void 0!==o?o:"",from_category:null!==(d=null===(u=t.current.supportConversation)||void 0===u?void 0:u.category)&&void 0!==d?d:"",internal_note:null!==(m=null===(x=t.current.supportConversation)||void 0===x?void 0:x.internal_notes)&&void 0!==m?m:"",last_assistant_message_id:null!=h?h:"not_found",last_user_message_id:null!=p?p:"not_found"}).catch()},setSupportConversation:e=>{let{supportConversation:s}=e;var a;a={supportConversation:s},t.current=(0,ue.A)((0,ue.A)({},t.current),a)},resolvedOpenClick:s=>{var a,n,l,r,i,o,c,d,u,m,x,h;let{toStatus:p}=s;Fu.track("support_admin_resolved_open_click",e.sessionContext,{to_status:p,ticket_id:null!==(a=null===(n=t.current.supportConversation)||void 0===n?void 0:n.id)&&void 0!==a?a:"",from_category:null!==(l=null===(r=t.current.supportConversation)||void 0===r?void 0:r.category)&&void 0!==l?l:"",internal_note:null!==(i=null===(o=t.current.supportConversation)||void 0===o?void 0:o.internal_notes)&&void 0!==i?i:"",last_user_message_id:null!==(c=null===(d=EG(null===(u=t.current.supportConversation)||void 0===u?void 0:u.messages,"user"))||void 0===d?void 0:d.id)&&void 0!==c?c:"not_found",last_assistant_message_id:null!==(m=null===(x=EG(null===(h=t.current.supportConversation)||void 0===h?void 0:h.messages,"assistant"))||void 0===x?void 0:x.id)&&void 0!==m?m:"not_found"}).catch()},internalNoteContentChange:s=>{var a,n,l,r,i,o,c,d,u,m,x,h;let{newInternalNote:p}=s;Fu.track("support_admin_internal_note_content_change",e.sessionContext,{ticket_id:null!==(a=null===(n=t.current.supportConversation)||void 0===n?void 0:n.id)&&void 0!==a?a:"",created_by_email:null!==(l=null===(r=t.current.supportConversation)||void 0===r?void 0:r.created_by)&&void 0!==l?l:"",old_internal_note:null!==(i=null===(o=t.current.supportConversation)||void 0===o?void 0:o.internal_notes)&&void 0!==i?i:"",internal_note:p,last_user_message_id:null!==(c=null===(d=EG(null===(u=t.current.supportConversation)||void 0===u?void 0:u.messages,"user"))||void 0===d?void 0:d.id)&&void 0!==c?c:"not_found",last_assistant_message_id:null!==(m=null===(x=EG(null===(h=t.current.supportConversation)||void 0===h?void 0:h.messages,"assistant"))||void 0===x?void 0:x.id)&&void 0!==m?m:"not_found"}).catch()},categoryChange:s=>{var a,n,l,r,i,o,c,d,u,m,x,h;let{newCategory:p}=s;Fu.track("support_admin_category_change",e.sessionContext,{ticket_id:null!==(a=null===(n=t.current.supportConversation)||void 0===n?void 0:n.id)&&void 0!==a?a:"",created_by_email:null!==(l=null===(r=t.current.supportConversation)||void 0===r?void 0:r.created_by)&&void 0!==l?l:"",old_category_id:null!==(i=null===(o=t.current.supportConversation)||void 0===o?void 0:o.category)&&void 0!==i?i:"",category_id:p,last_user_message_id:null!==(c=null===(d=EG(null===(u=t.current.supportConversation)||void 0===u?void 0:u.messages,"user"))||void 0===d?void 0:d.id)&&void 0!==c?c:"not_found",last_assistant_message_id:null!==(m=null===(x=EG(null===(h=t.current.supportConversation)||void 0===h?void 0:h.messages,"assistant"))||void 0===x?void 0:x.id)&&void 0!==m?m:"not_found"}).catch()}}}function EG(e,t){var s;return null==e||null===(s=e.filter(e=>e.role===t))||void 0===s?void 0:s.sort((e,t)=>{var s,a;return new Date(null!==(s=t.created_date)&&void 0!==s?s:Date.now()).getTime()-new Date(null!==(a=e.created_date)&&void 0!==a?a:Date.now()).getTime()})[0]}function TG(e){let{relatedTickets:t,isReference:s,referenceTickets:a=[]}=e;const[n,l]=(0,Y.useState)(new Set),r=t.length>0,i=t.length;return r||s?(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)("div",{className:"p-3",children:(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(fv.A,{className:"w-4 h-4 text-amber-500"}),(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"Reference Tickets"}),i>0&&(0,se.jsxs)(gk,{variant:"secondary",className:"text-xs bg-amber-100 text-amber-700 hover:bg-amber-100",children:[i," found"]})]})}),(0,se.jsx)(Wv,{className:"pt-0 pb-3 px-3",children:(0,se.jsxs)("div",{className:"space-y-3",children:[t.length>0&&(0,se.jsx)("div",{className:"space-y-2",children:t.map(e=>{const t=a.find(t=>t.id===e.id),s=n.has(e.id);return(0,se.jsxs)("div",{className:"border border-slate-100 rounded-lg overflow-hidden bg-slate-50",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,se.jsxs)("button",{onClick:()=>{return t=e.id,void l(e=>{const s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s});var t},className:"flex items-center gap-2 text-left flex-1 min-w-0",children:[s?(0,se.jsx)(_t.A,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}):(0,se.jsx)(bs.A,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("div",{className:"text-xs font-medium text-slate-800 truncate",children:e.title}),(0,se.jsxs)("div",{className:"text-[10px] text-slate-500 flex items-center mt-0.5",children:[(0,se.jsx)(jS.A,{className:"w-2.5 h-2.5 mr-1"}),(r=e.created_date,r?He()(r).fromNow():"")]})]})]}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>{return t=e.id,void window.open("/support/admin/conversations?conversationId=".concat(t),"_blank");var t},className:"h-5 px-1.5 text-[10px] text-slate-500 hover:text-slate-700",children:(0,se.jsx)(Rj.A,{className:"w-2.5 h-2.5"})})]}),s&&(null==t?void 0:t.expert_response)&&(0,se.jsxs)("div",{className:"px-3 pb-3 pt-1 border-t border-slate-100",children:[(0,se.jsx)("div",{className:"text-[10px] font-medium text-slate-500 mb-1 uppercase tracking-wide",children:"Expert Response"}),(0,se.jsx)("div",{className:"text-xs text-slate-700 bg-white p-2 rounded border border-slate-100 whitespace-pre-wrap max-h-32 overflow-y-auto",children:t.expert_response})]})]},e.id);var r})}),0===t.length&&!s&&(0,se.jsx)("p",{className:"text-xs text-slate-500 italic",children:"No similar reference tickets found."}),s&&(0,se.jsx)("div",{className:"".concat(t.length>0?"pt-2 border-t border-slate-200":""),children:(0,se.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,se.jsx)(fv.A,{className:"w-3 h-3 text-amber-500 fill-amber-500"}),(0,se.jsx)("span",{className:"text-slate-600",children:"This is a reference ticket"})]})})]})})]}):null}const IG=["bg-blue-100 text-blue-800 border-blue-200","bg-green-100 text-green-800 border-green-200","bg-purple-100 text-purple-800 border-purple-200","bg-orange-100 text-orange-800 border-orange-200","bg-pink-100 text-pink-800 border-pink-200","bg-teal-100 text-teal-800 border-teal-200","bg-indigo-100 text-indigo-800 border-indigo-200","bg-amber-100 text-amber-800 border-amber-200","bg-cyan-100 text-cyan-800 border-cyan-200","bg-rose-100 text-rose-800 border-rose-200"],PG=e=>{let t=0;for(let s=0;s<e.length;s++)t=e.charCodeAt(s)+((t<<5)-t);return IG[Math.abs(t)%IG.length]};function LG(e){let{selectedLabels:t,availableLabels:s,onApplyLabels:a,isSaving:n=!1}=e;const[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(t);(0,Y.useEffect)(()=>{l||d(t)},[t,l]),(0,Y.useEffect)(()=>{l&&(d(t),o(""))},[l,t]);const u=(0,Y.useMemo)(()=>{if(c.length!==t.length)return!0;const e=[...c].sort(),s=[...t].sort();return!e.every((e,t)=>e===s[t])},[c,t]),{selectedFiltered:m,availableFiltered:x}=(0,Y.useMemo)(()=>{const e=i.toLowerCase().trim(),t=[...c].sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())),a=s.filter(e=>!c.includes(e)).sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()));return{selectedFiltered:e?t.filter(t=>t.toLowerCase().includes(e)):t,availableFiltered:e?a.filter(t=>t.toLowerCase().includes(e)):a}},[c,s,i]),h=e=>{d(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,se.jsx)("div",{className:"space-y-0",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1.5 shrink-0",children:[(0,se.jsx)(Gq.A,{className:"w-3.5 h-3.5 text-slate-500"}),(0,se.jsx)("span",{className:"text-xs font-medium text-slate-700",children:"Labels"})]}),(0,se.jsx)("div",{className:"flex-1 flex flex-wrap gap-1 min-w-0",children:t.length>0?[...t].sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())).map(e=>(0,se.jsx)(gk,{variant:"outline",className:"text-[10px] px-1.5 py-0 h-5 ".concat(PG(e)),children:e},e)):(0,se.jsx)("span",{className:"text-xs text-slate-400 italic",children:"None"})}),(0,se.jsxs)(mS,{open:l,onOpenChange:r,children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-slate-500 hover:text-slate-700 shrink-0",disabled:n,children:(0,se.jsx)(op.A,{className:"w-3.5 h-3.5"})})}),(0,se.jsxs)(hS,{className:"w-64 p-0",align:"end",sideOffset:4,children:[(0,se.jsx)("div",{className:"p-2 border-b border-slate-100",children:(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400"}),(0,se.jsx)(Df,{placeholder:"Search labels...",value:i,onChange:e=>o(e.target.value),className:"h-7 pl-7 text-xs"})]})}),(0,se.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:[m.length>0&&(0,se.jsxs)("div",{className:"p-2",children:[(0,se.jsx)("div",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide mb-1.5",children:"Selected"}),(0,se.jsx)("div",{className:"space-y-0.5",children:m.map(e=>(0,se.jsxs)("button",{onClick:()=>h(e),disabled:n,className:"w-full flex items-center gap-2 px-2 py-1.5 rounded text-xs hover:bg-slate-50 transition-colors text-left",children:[(0,se.jsx)(E_,{checked:!0,className:"h-3.5 w-3.5 pointer-events-none"}),(0,se.jsx)("span",{className:"flex-1 truncate",children:e}),(0,se.jsx)(Ds.A,{className:"w-3 h-3 text-green-600"})]},e))})]}),x.length>0&&(0,se.jsxs)("div",{className:"p-2 ".concat(m.length>0?"border-t border-slate-100":""),children:[(0,se.jsx)("div",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide mb-1.5",children:"Available"}),(0,se.jsx)("div",{className:"space-y-0.5",children:x.map(e=>(0,se.jsxs)("button",{onClick:()=>h(e),disabled:n,className:"w-full flex items-center gap-2 px-2 py-1.5 rounded text-xs hover:bg-slate-50 transition-colors text-left",children:[(0,se.jsx)(E_,{checked:!1,className:"h-3.5 w-3.5 pointer-events-none"}),(0,se.jsx)("span",{className:"flex-1 truncate",children:e})]},e))})]}),0===m.length&&0===x.length&&(0,se.jsx)("div",{className:"p-4 text-center text-xs text-slate-500",children:i?"No labels match your search":"No labels available"})]}),(0,se.jsx)("div",{className:"p-2 border-t border-slate-100",children:(0,se.jsx)(Bx,{size:"sm",onClick:async()=>{u?(await a(c),r(!1)):r(!1)},disabled:n,className:"w-full h-7 text-xs",children:n?"Saving...":"Apply"})})]})]})]})})}const MG=["node"],RG=["node","className","children"],DG=[{value:"open",label:"Open",icon:jS.A,color:"text-orange-600"},{value:"resolved",label:"Resolved",icon:sd.A,color:"text-green-600"}],FG=[{value:"authentication",label:"Authentication"},{value:"billing",label:"Billing"},{value:"bug_report",label:"Bug Report"},{value:"domain",label:"Domain"},{value:"integrations_and_backend_functions",label:"Integrations & Backend"},{value:"chat_issues",label:"Chat Issues"},{value:"security",label:"Security"},{value:"social_post_bonus_credits",label:"Social Post Bonus Credits"},{value:"other",label:"Other"}],OG=e=>{let{category:t}=e;const s=kG[t]||ad.A,a=t?t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):"Uncategorized";return(0,se.jsxs)(gk,{variant:"outline",className:"text-xs",children:[(0,se.jsx)(s,{className:"w-3 h-3 mr-1"}),a]})},UG=e=>{let{title:t,icon:s,children:a,isCollapsible:n=!1,defaultExpanded:l=!0,className:r=""}=e;const[i,o]=(0,Y.useState)(l);return(0,se.jsxs)(Bv,{className:"border-slate-200 ".concat(r),children:[(0,se.jsx)("div",{className:"p-3 ".concat(n?"cursor-pointer":""),onClick:n?()=>o(!i):void 0,children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(s,{className:"w-4 h-4 text-slate-600"}),(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:t})]}),n&&(0,se.jsx)("div",{className:"text-slate-400",children:i?(0,se.jsx)(ur.A,{className:"w-4 h-4"}):(0,se.jsx)(_t.A,{className:"w-4 h-4"})})]})}),i&&(0,se.jsx)(Wv,{className:"pt-0 pb-3 px-3",children:a})]})},BG=e=>{let{label:t,value:s,className:a=""}=e;return(0,se.jsxs)("div",{className:"flex justify-between items-start py-1.5 ".concat(a),children:[(0,se.jsx)("span",{className:"text-xs text-slate-600 flex-shrink-0 w-20",children:t}),(0,se.jsx)("span",{className:"text-xs text-slate-900 text-right flex-1",children:s})]})};function zG(e){var t,s,a,n,l,r,i,o,c,d;let{conversationId:u,onTicketUpdated:m}=e;const{user:x}=wd(),{conversationId:h}=(0,J.g)(),[p]=(0,Z.useSearchParams)(),g=p.get("conversationId"),f=u||h||g,[v,b]=(0,Y.useState)(null),[j,y]=(0,Y.useState)(!0),[N,w]=(0,Y.useState)(null),[_,k]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)([]),[S,E]=(0,Y.useState)([]),[T,I]=(0,Y.useState)([]),[P,L]=(0,Y.useState)(!1),[M,R]=(0,Y.useState)([]),[D,F]=(0,Y.useState)(!1),[O,U]=(0,Y.useState)(!1),[B,z]=(0,Y.useState)(""),[H,V]=(0,Y.useState)(""),[W,q]=(0,Y.useState)(!1),[G,K]=(0,Y.useState)(""),[$,Q]=(0,Y.useState)(!1),[X,ee]=(0,Y.useState)(""),[te,ae]=(0,Y.useState)(!1),[ne,le]=(0,Y.useState)(!1),[re,ie]=(0,Y.useState)(!1),[oe,ce]=(0,Y.useState)(!1),[de,me]=(0,Y.useState)(!1),[xe,he]=(0,Y.useState)(!1),pe=(0,Y.useRef)(null),ge=(0,Y.useRef)(null),fe=(0,Y.useRef)(f),[ve,be]=(0,Y.useState)(!1),[je,ye]=(0,Y.useState)(""),[Ne,we]=(0,Y.useState)(""),[_e,ke]=(0,Y.useState)({start:0,end:0}),Ce=SG(),{data:Ae,isLoading:Se,resetData:Ee}=Xd({query:async()=>{var e;if(null==v||null===(e=v.ticket)||void 0===e||!e.created_by)return{apps:[]};return await nY.getRecentlyUsedApps(v.ticket.created_by,v.ticket.organization_id,f)},initialData:{apps:[]},enabled:!(null==v||null===(t=v.ticket)||void 0===t||!t.created_by)},[null==v||null===(s=v.ticket)||void 0===s?void 0:s.created_by,null==v||null===(a=v.ticket)||void 0===a?void 0:a.organization_id,f]);(0,Y.useEffect)(()=>{f&&(fe.current=f,b(null),y(!0),w(null),Ee(),Te())},[f]),(0,Y.useEffect)(()=>{if(!f||null==v||!v.ticket)return;if(v.ticket.id!==f)return;let e=null,t=!0;const s=f;return(async()=>{try{const a=await Zq.subscribe(f,v.ticket,(e,a)=>{t&&fe.current===s&&(b(t=>{var a;return t?(null===(a=t.ticket)||void 0===a?void 0:a.id)!==s?t:(0,ue.A)((0,ue.A)({},t),{},{ticket:(0,ue.A)((0,ue.A)({},t.ticket),e)}):t}),void 0!==e.internal_categories&&I(e.internal_categories||[]),void 0!==e.internal_notes&&K(e.internal_notes||""),m&&(null==a?void 0:a.length)>0&&m(s,"realtime_update",void 0,e))});t?e=a:null==a||a()}catch(a){}})(),()=>{t=!1,e&&e()}},[f,null==v||null===(n=v.ticket)||void 0===n?void 0:n.id,m]),(0,Y.useEffect)(()=>{if($&&pe.current){pe.current.focus();const e=pe.current.value.length;pe.current.setSelectionRange(e,e),pe.current.scrollTop=pe.current.scrollHeight}},[$]),(0,Y.useEffect)(()=>{!$&&ge.current&&G&&(ge.current.scrollTop=ge.current.scrollHeight)},[G,$]);const Te=async()=>{try{var e,t;y(!0),w(null);const[s,a]=await Promise.all([Qq.getTicketDetail(f),eY.getAgentProperties()]);b(s),A((null==a?void 0:a.internal_category_options)||[]),E((null==a?void 0:a.reference_admins)||[]),I((null==s||null===(e=s.ticket)||void 0===e?void 0:e.internal_categories)||[]),K((null==s||null===(t=s.ticket)||void 0===t?void 0:t.internal_notes)||""),Ce.setSupportConversation({supportConversation:null==s?void 0:s.ticket})}catch(s){w("Failed to load ticket details. Please try again.")}finally{y(!1)}},Ie=async()=>{const e=(t=B).trim()?Lv(t)?t.endsWith("@base44.com")||t.endsWith("@wix.com")?"":"Email must be from @base44.com or @wix.com domain":"Please enter a valid email address":"Email is required";var t;if(e)V(e);else try{q(!0),V("");const e=await Qq.assignTicket(f,B.trim());b(t=>t?(0,ue.A)((0,ue.A)({},t),{},{ticket:(0,ue.A)((0,ue.A)({},t.ticket),e)}):t),m&&m(f,"assigned",B.trim(),e),U(!1),z("")}catch(s){V("Failed to assign ticket. Please try again.")}finally{q(!1)}},Pe=()=>{ee(""),Q(!1)},Le=e=>{const t=pe.current;if(!t)return;const s=t.selectionStart,a=t.selectionEnd,n=X.substring(s,a),l=X.substring(0,s),r=X.substring(a);let i="",o=0;switch(e){case"bold":n?(i="".concat(l,"**").concat(n,"**").concat(r),o=a+4):(i="".concat(l,"****").concat(r),o=s+2);break;case"italic":n?(i="".concat(l,"*").concat(n,"*").concat(r),o=a+2):(i="".concat(l,"**").concat(r),o=s+1);break;case"link":return ye(n||""),we(""),ke({start:s,end:a}),void be(!0);case"code":n?(i="".concat(l,"`").concat(n,"`").concat(r),o=a+2):(i="".concat(l,"``").concat(r),o=s+1);break;case"bullet_list":const e=n||"List item";i="".concat(l,"- ").concat(e).concat(r),o=s+2+e.length;break;case"numbered_list":const t=n||"List item";i="".concat(l,"1. ").concat(t).concat(r),o=s+3+t.length;break;default:return}ee(i),setTimeout(()=>{t.focus(),t.setSelectionRange(o,o)},0)},Me=()=>{if(!Ne.trim())return;const{start:e,end:t}=_e,s=X.substring(0,e),a=X.substring(t),n=je.trim()||Ne,l="".concat(s,"[").concat(n,"](").concat(Ne,")").concat(a);ee(l),be(!1),ye(""),we(""),setTimeout(()=>{if(pe.current){pe.current.focus();const t=e+n.length+Ne.length+4;pe.current.setSelectionRange(t,t)}},0)},Re=async()=>{try{ae(!0),await Qq.updateInternalNotes(f,X),K(X),Q(!1),ee(""),m&&m(f,"notes_updated"),Ce.internalNoteContentChange({newInternalNote:X})}catch(e){w("Failed to update internal notes. Please try again.")}finally{ae(!1)}},De=async()=>{if(f)try{he(!0);const e=await Qq.generateSummary(f);b(t=>t?(0,ue.A)((0,ue.A)({},t),{},{ticket:(0,ue.A)((0,ue.A)({},t.ticket),{},{ai_summary:e.summary})}):t)}catch(e){}finally{he(!1)}};if(j)return(0,se.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-slate-400 mx-auto mb-3"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Loading conversation..."})]})});if(N)return(0,se.jsx)("div",{className:"h-full flex items-center justify-center p-6",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,se.jsx)(ad.A,{className:"w-6 h-6 text-red-500"})}),(0,se.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Error Loading Ticket"}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mb-4",children:N}),(0,se.jsx)(Bx,{onClick:Te,variant:"outline",size:"sm",children:"Try Again"})]})});const Fe=(null==v?void 0:v.ticket)||{id:f,title:"Loading...",content:"Loading ticket content...",status:"pending_admin_response",category:"other",app_id:null,created_by:"unknown@example.com",user_subscription_tier:"free",created_date:(new Date).toISOString(),updated_date:(new Date).toISOString()},Oe=(null==v?void 0:v.user)||{id:"unknown",email:Fe.created_by||"unknown@example.com",name:"Unknown User",stripe_customer_id:null,created_date:(new Date).toISOString()},Ue=(null==v?void 0:v.subscriptions)||[];return(0,se.jsxs)("div",{className:"h-full flex flex-col min-h-0",children:[(0,se.jsx)("div",{className:"border-b border-slate-200 p-4 bg-slate-50 flex-shrink-0 min-h-fit",children:(0,se.jsx)("div",{className:"space-y-4",children:(0,se.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsxs)("div",{className:"flex items-start gap-2",children:[(0,se.jsx)("h2",{className:"text-lg font-semibold text-slate-900 leading-snug break-words",children:Fe.title}),Fe.is_escalated&&(0,se.jsxs)(gk,{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200 flex-shrink-0",children:[(0,se.jsx)(Ap.A,{className:"w-3 h-3 mr-1"}),"Escalated"]})]}),(0,se.jsxs)("div",{className:"flex items-start justify-between mt-3 gap-4",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-3 flex-wrap min-w-0",children:[(0,se.jsx)(OG,{category:Fe.category}),(0,se.jsx)("div",{className:"text-xs text-slate-600",children:(0,se.jsx)("span",{className:"font-medium capitalize",children:Fe.ticket_status})}),Fe.assigned_to&&(0,se.jsxs)("div",{className:"text-xs text-slate-600",children:[(0,se.jsx)(NH.A,{className:"w-3 h-3 inline mr-1"}),(0,se.jsx)("span",{className:"font-medium",children:Fe.assigned_to})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 flex-wrap",children:[S.includes((null==x?void 0:x.email)||"")&&(0,se.jsxs)(Bx,{variant:Fe.is_reference?"default":"outline",size:"sm",onClick:async()=>{try{var e;ce(!0);!(null==v||null===(e=v.ticket)||void 0===e||!e.is_reference)?(await Qq.unmarkAsReference(f),b(e=>e?(0,ue.A)((0,ue.A)({},e),{},{ticket:(0,ue.A)((0,ue.A)({},e.ticket),{},{is_reference:!1})}):e)):(await Qq.markAsReference(f),b(e=>e?(0,ue.A)((0,ue.A)({},e),{},{ticket:(0,ue.A)((0,ue.A)({},e.ticket),{},{is_reference:!0})}):e)),m&&m(f,"reference_updated")}catch(t){w("Failed to toggle reference status. Please try again.")}finally{ce(!1)}},disabled:oe,className:"h-auto py-1 px-2 text-xs ".concat(Fe.is_reference?"bg-amber-500 hover:bg-amber-600 text-white":"text-slate-600 hover:text-slate-900 hover:bg-slate-100"),children:[oe?(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current mr-1"}):(0,se.jsx)(fv.A,{className:"w-3 h-3 mr-1 ".concat(Fe.is_reference?"fill-current":"")}),Fe.is_reference?"Reference":"Mark Reference"]}),"resolved"!==Fe.ticket_status&&(0,se.jsxs)(Bx,{variant:Fe.is_escalated?"destructive":"outline",size:"sm",onClick:async()=>{try{var e;ie(!0);const t=(null==v||null===(e=v.ticket)||void 0===e?void 0:e.is_escalated)||!1;let s;s=t?await Qq.unescalateTicket(f):await Qq.escalateTicket(f),b(e=>e?(0,ue.A)((0,ue.A)({},e),{},{ticket:(0,ue.A)((0,ue.A)({},e.ticket),s)}):e),m&&m(f,"escalation_updated",void 0,s),t?Ce.unescalateClick():Ce.escalateClick()}catch(t){w("Failed to change escalation status. Please try again.")}finally{ie(!1)}},disabled:re,className:"h-auto py-1 px-2 text-xs ".concat(Fe.is_escalated?"bg-red-500 hover:bg-red-600 text-white":"text-slate-600 hover:text-slate-900 hover:bg-slate-100"),children:[re?(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current mr-1"}):(0,se.jsx)(Ap.A,{className:"w-3 h-3 mr-1"}),Fe.is_escalated?"Unescalate":"Escalate"]}),"resolved"!==Fe.ticket_status&&(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{z(""),V(""),U(!0)},className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100 h-auto py-1 px-2 text-xs",children:[(0,se.jsx)(BO.A,{className:"w-3 h-3 mr-1"}),Fe.assigned_to?"Reassign":"Assign"]}),(0,se.jsxs)(Wf,{value:Fe.category||"other",onValueChange:async e=>{try{le(!0);const t=await Qq.updateTicketCategory(f,e);b(e=>e?(0,ue.A)((0,ue.A)({},e),{},{ticket:(0,ue.A)((0,ue.A)({},e.ticket),t)}):e),m&&m(f,"category_updated",void 0,t),Ce.categoryChange({newCategory:e})}catch(t){w("Failed to change ticket category. Please try again.")}finally{le(!1)}},disabled:ne,children:[(0,se.jsx)(Yf,{className:"h-auto py-1 w-auto text-xs border-slate-300 hover:border-slate-400",children:(0,se.jsxs)("div",{className:"flex items-center",children:[ne?(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-slate-400 mr-1"}):(0,se.jsx)(Gq.A,{className:"w-3 h-3 mr-1"}),(0,se.jsx)("span",{className:"mr-1",children:"Category:"}),(0,se.jsx)(qf,{})]})}),(0,se.jsx)($f,{children:FG.map(e=>(0,se.jsx)(Zf,{value:e.value,children:e.label},e.value))})]}),(0,se.jsxs)(Wf,{value:Fe.ticket_status,onValueChange:async e=>{try{k(!0);const t=await Qq.changeTicketStatus(f,e);b(e=>e?(0,ue.A)((0,ue.A)({},e),{},{ticket:(0,ue.A)((0,ue.A)({},e.ticket),t)}):e),m&&m(f,e,void 0,t),Ce.resolvedOpenClick({toStatus:e})}catch(t){w("Failed to change ticket status. Please try again.")}finally{k(!1)}},disabled:_,children:[(0,se.jsx)(Yf,{className:"h-auto py-1 w-auto text-xs border-slate-300 hover:border-slate-400",children:(0,se.jsxs)("div",{className:"flex items-center",children:[_?(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-slate-400 mr-1"}):(()=>{const e=DG.find(e=>e.value===Fe.ticket_status),t=(null==e?void 0:e.icon)||jS.A;return(0,se.jsx)(t,{className:"w-3 h-3 mr-1"})})(),(0,se.jsx)(qf,{})]})}),(0,se.jsx)($f,{children:DG.map(e=>{const t=e.icon;return(0,se.jsx)(Zf,{value:e.value,children:(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(t,{className:"w-4 h-4 ".concat(e.color)}),(0,se.jsx)("span",{children:e.label})]})},e.value)})})]})]})]})]}),(0,se.jsxs)("div",{className:"flex flex-col items-end space-y-1 text-xs text-slate-600 flex-shrink-0",children:[(0,se.jsxs)("span",{className:"font-mono bg-white px-2 py-1 rounded text-xs whitespace-nowrap",children:["id: ",Fe.id]}),(0,se.jsx)("span",{className:"text-right text-xs",children:FH(Fe.created_date)})]})]})})}),(0,se.jsxs)(ZF,{direction:"horizontal",className:"flex-1 overflow-hidden min-h-0",children:[(0,se.jsx)(JF,{defaultSize:90,minSize:20,children:(0,se.jsx)("div",{className:"h-full flex flex-col min-h-0",children:(0,se.jsx)(CY,{conversationId:f,isAdmin:!0,ticket:Fe,onGenerateSummary:De,onViewSummary:()=>me(!0),isGeneratingSummary:xe,onMessageSent:e=>{"object"==typeof e&&e.conversationId?m&&m(e.conversationId,e.action,e.role,e.conversation):m&&m(f,"message_sent","admin")}},f)})}),(0,se.jsx)(QF,{withHandle:!0,className:"hidden lg:flex group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,se.jsx)(JF,{defaultSize:30,minSize:15,maxSize:40,className:"hidden lg:block",children:(0,se.jsx)("div",{className:"w-full border-l border-slate-200 bg-slate-50 h-full flex flex-col",children:(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[(0,se.jsx)(Og,{open:de,onOpenChange:me,children:(0,se.jsxs)(Hg,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)(qg,{className:"flex items-center gap-2",children:[(0,se.jsx)(_P.A,{className:"w-5 h-5 text-teal-600"}),"AI Summary"]})}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,se.jsx)("div",{className:"prose prose-slate prose-sm max-w-none text-sm leading-relaxed whitespace-pre-wrap",children:Fe.ai_summary})}),(0,se.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-slate-200",children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:De,disabled:xe,className:"text-xs",children:xe?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current mr-1.5"}),"Regenerating..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(_P.A,{className:"w-3 h-3 mr-1.5"}),"Regenerate"]})}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>me(!1),children:"Close"})]})]})}),(0,se.jsx)(Bv,{className:"border-slate-200",children:(0,se.jsx)(Wv,{className:"p-3",children:(0,se.jsx)(LG,{selectedLabels:T,availableLabels:C,onApplyLabels:async e=>{const t=[...T];I(e),F(!0);try{await Qq.updateInternalCategories(f,e),m&&m(f,"categories_updated")}catch(s){I(t),w("Failed to update labels. Please try again.")}finally{F(!1)}},isSaving:D})})}),(0,se.jsx)(UG,{title:"Internal Notes",icon:xb.A,isCollapsible:!0,defaultExpanded:!!G,className:G?"border-2 border-orange-400 bg-orange-50/50 shadow-md":"",children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"text-xs text-slate-600 mb-2",children:"Private notes visible only to admins."}),$?(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1 p-2 bg-slate-50 border border-slate-200 rounded-lg",children:[(0,se.jsx)("button",{type:"button",onClick:()=>Le("bold"),className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:"Bold (".concat(navigator.platform.includes("Mac")?"\u2318":"Ctrl","+B)"),children:(0,se.jsx)(yG.A,{className:"w-3.5 h-3.5 text-slate-600"})}),(0,se.jsx)("button",{type:"button",onClick:()=>Le("italic"),className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:"Italic (".concat(navigator.platform.includes("Mac")?"\u2318":"Ctrl","+I)"),children:(0,se.jsx)(NG.A,{className:"w-3.5 h-3.5 text-slate-600"})}),(0,se.jsx)("button",{type:"button",onClick:()=>Le("link"),className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:"Link (".concat(navigator.platform.includes("Mac")?"\u2318":"Ctrl","+K)"),children:(0,se.jsx)(rk.A,{className:"w-3.5 h-3.5 text-slate-600"})}),(0,se.jsx)("button",{type:"button",onClick:()=>Le("code"),className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:"Inline Code",children:(0,se.jsx)(Jv.A,{className:"w-3.5 h-3.5 text-slate-600"})}),(0,se.jsx)("div",{className:"w-px h-4 bg-slate-300 mx-1"}),(0,se.jsx)("button",{type:"button",onClick:()=>Le("bullet_list"),className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:"Bullet List",children:(0,se.jsx)(jv.A,{className:"w-3.5 h-3.5 text-slate-600"})}),(0,se.jsx)("button",{type:"button",onClick:()=>Le("numbered_list"),className:"p-1.5 hover:bg-slate-200 rounded transition-colors",title:"Numbered List",children:(0,se.jsx)(wG.A,{className:"w-3.5 h-3.5 text-slate-600"})})]}),(0,se.jsx)(tN,{ref:pe,value:X,onChange:e=>ee(e.target.value),onKeyDown:e=>(e.metaKey||e.ctrlKey)&&"Enter"===e.key?(e.preventDefault(),void Re()):"Escape"===e.key?(e.preventDefault(),void Pe()):(e.metaKey||e.ctrlKey)&&"b"===e.key?(e.preventDefault(),void Le("bold")):(e.metaKey||e.ctrlKey)&&"i"===e.key?(e.preventDefault(),void Le("italic")):(e.metaKey||e.ctrlKey)&&"k"===e.key?(e.preventDefault(),void Le("link")):void 0,placeholder:"Add internal notes here...",className:"min-h-[120px] h-[25vh] max-h-[40vh] text-xs resize-none overflow-y-auto",disabled:te}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(Bx,{variant:"default",size:"sm",onClick:Re,disabled:te,className:"h-6 px-2 text-xs",children:te?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-1"}),"Saving..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lV.A,{className:"w-3 h-3 mr-1"}),"Save"]})}),(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:Pe,disabled:te,className:"h-6 px-2 text-xs",children:[(0,se.jsx)(la.A,{className:"w-3 h-3 mr-1"}),"Cancel"]})]})]}):(0,se.jsxs)("div",{className:"space-y-2",children:[G?(0,se.jsx)("div",{ref:ge,className:"p-2 bg-white rounded-lg border border-orange-300 min-h-[120px] max-h-[40vh] overflow-y-auto",children:(0,se.jsx)("div",{className:"prose prose-slate prose-sm max-w-none text-xs",children:(0,se.jsx)(db.oz,{remarkPlugins:[cb.A],components:{a:e=>{let{node:t}=e,s=(0,Nt.A)(e,MG);return(0,se.jsx)("a",(0,ue.A)((0,ue.A)({},s),{},{className:"text-orange-600 underline hover:text-orange-700 transition-colors",target:"_blank",rel:"noopener noreferrer"}))},code:e=>{let{node:t,className:s,children:a}=e,n=(0,Nt.A)(e,RG);return(null==n?void 0:n.inline)||!s?(0,se.jsx)("code",(0,ue.A)((0,ue.A)({className:"bg-orange-50 text-orange-800 px-1 py-0.5 rounded text-[10px] font-mono"},n),{},{children:a})):(0,se.jsx)("code",(0,ue.A)((0,ue.A)({className:"block bg-slate-50 border border-slate-200 p-2 rounded text-[10px] font-mono overflow-x-auto text-slate-700"},n),{},{children:a}))},p:e=>{let{children:t}=e;return(0,se.jsx)("p",{className:"mb-1 last:mb-0 text-xs leading-relaxed",children:t})},ul:e=>{let{children:t}=e;return(0,se.jsx)("ul",{className:"list-disc list-inside mb-1 last:mb-0 text-xs space-y-0.5",children:t})},ol:e=>{let{children:t}=e;return(0,se.jsx)("ol",{className:"list-decimal list-inside mb-1 last:mb-0 text-xs space-y-0.5",children:t})},li:e=>{let{children:t}=e;return(0,se.jsx)("li",{className:"text-xs",children:t})},strong:e=>{let{children:t}=e;return(0,se.jsx)("strong",{className:"font-semibold text-slate-900",children:t})},em:e=>{let{children:t}=e;return(0,se.jsx)("em",{className:"italic text-slate-700",children:t})},blockquote:e=>{let{children:t}=e;return(0,se.jsx)("blockquote",{className:"border-l-2 border-orange-400 pl-2 italic text-slate-600 my-1",children:t})},h1:e=>{let{children:t}=e;return(0,se.jsx)("h1",{className:"text-sm font-bold text-slate-900 mb-1 mt-2",children:t})},h2:e=>{let{children:t}=e;return(0,se.jsx)("h2",{className:"text-xs font-bold text-slate-900 mb-1 mt-1.5",children:t})},h3:e=>{let{children:t}=e;return(0,se.jsx)("h3",{className:"text-xs font-semibold text-slate-900 mb-0.5 mt-1",children:t})}},children:G})})}):(0,se.jsx)("p",{className:"text-xs text-slate-500 italic",children:"No internal notes added."}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{const e=(null==x?void 0:x.email)||"",t=He().utc().format("MMM DD, HH:mm"),s="[".concat(e,"] [").concat(t,"]:\n\n");ee(G?G+"\n\n---------\n"+s:s),Q(!0)},className:"h-6 px-2 text-xs",children:[(0,se.jsx)(Qv.A,{className:"w-3 h-3 mr-1"}),"Add Notes"]}),G&&(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{ee(G),Q(!0)},className:"h-6 px-2 text-xs",children:[(0,se.jsx)(Qv.A,{className:"w-3 h-3 mr-1"}),"Edit Notes"]})]})]})]})}),(0,se.jsx)(TG,{relatedTickets:Fe.related_tickets||[],isReference:Fe.is_reference||!1}),(0,se.jsx)(UG,{title:"User",icon:ay.A,isCollapsible:!0,defaultExpanded:!0,children:(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(BG,{label:"Email",value:Oe.email}),(0,se.jsx)(BG,{label:"Name",value:Oe.full_name||"Not provided"}),(0,se.jsx)(BG,{label:"Created",value:Oe.created_date?FH(Oe.created_date,!0):"Not available"}),(0,se.jsx)(BG,{label:"Subscription Status",value:Oe.stripe_subscription_status||"Not provided"}),(0,se.jsx)(BG,{label:"Manage",value:(0,se.jsxs)(Z.Link,{to:"/user-management?userId=".concat(Oe.id),target:"_blank",className:"inline-flex items-center text-slate-600 hover:text-slate-900 text-xs transition-colors",children:["View Profile",(0,se.jsx)(Rj.A,{className:"w-2 h-2 ml-1"})]})}),Oe.stripe_customer_id&&(0,se.jsx)(BG,{label:"Stripe",value:(0,se.jsxs)("a",{href:"https://dashboard.stripe.com/customers/".concat(Oe.stripe_customer_id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800 text-xs",children:["View",(0,se.jsx)(Rj.A,{className:"w-2 h-2 ml-1"})]})})]})}),(0,se.jsx)(UG,{title:"Previous Tickets",icon:eh.A,isCollapsible:!0,defaultExpanded:!0,children:(0,se.jsx)(AG,{userEmail:Oe.email,userName:Oe.full_name||Oe.email,currentTicketId:f})}),(0,se.jsx)(UG,{title:"Subscription",icon:su.A,isCollapsible:!0,defaultExpanded:!0,children:Ue&&Ue.length>0?(0,se.jsx)("div",{className:"space-y-2",children:Ue.map((e,t)=>{var s,a,n;return(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)(BG,{label:"Plan",value:(null===(s=e.plan)||void 0===s?void 0:s.nickname)||"Unknown"}),(0,se.jsx)(BG,{label:"Status",value:e.status}),(0,se.jsx)(BG,{label:"Amount",value:"$".concat(((null===(a=e.plan)||void 0===a?void 0:a.amount)/100).toFixed(2),"/").concat(null===(n=e.plan)||void 0===n?void 0:n.interval)})]},t)})}):(0,se.jsx)("p",{className:"text-xs text-slate-600",children:"No subscriptions found."})}),(0,se.jsx)(UG,{title:"App",icon:Xx.A,isCollapsible:!0,defaultExpanded:!0,children:(0,se.jsxs)("div",{className:"space-y-2",children:[(null==v?void 0:v.app_deleted)&&(0,se.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-3 mb-2",children:(0,se.jsxs)("div",{className:"flex items-start gap-2",children:[(0,se.jsx)(Ap.A,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("p",{className:"text-xs font-medium text-amber-800",children:"App Deleted"}),(0,se.jsx)("p",{className:"text-xs text-amber-700 mt-1",children:"This ticket was linked to an app that has been deleted."}),(null==v?void 0:v.deleted_app_id)&&(0,se.jsxs)("p",{className:"text-xs text-amber-600 font-mono mt-1",children:["ID: ",v.deleted_app_id]})]})]})}),(0,se.jsx)(BG,{label:"Name",value:(null==v||null===(l=v.app)||void 0===l?void 0:l.name)||(null!=v&&v.app_deleted?"Deleted":"None")}),(0,se.jsx)(BG,{label:"Link",value:null!=v&&null!==(r=v.app)&&void 0!==r&&r.id?(0,se.jsxs)("a",{href:"https://app.base44.com/apps/".concat(v.app.id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800 text-xs",children:["View App",(0,se.jsx)(Rj.A,{className:"w-2 h-2 ml-1"})]}):null!=v&&v.app_deleted?(0,se.jsx)("span",{className:"text-xs text-amber-600",children:"App was deleted"}):"No app linked"}),(0,se.jsx)(BG,{label:"App Visiblity",value:(null==v||null===(i=v.app)||void 0===i?void 0:i.visibility)||"Not available"}),(0,se.jsx)(BG,{label:"Created",value:null!=v&&null!==(o=v.app)&&void 0!==o&&o.created_date?FH(v.app.created_date):"Not available"}),(0,se.jsx)(BG,{label:"Updated",value:null!=v&&null!==(c=v.app)&&void 0!==c&&c.updated_date?FH(v.app.updated_date):"Not available"}),(0,se.jsx)(BG,{label:"App ID",value:(null==v?void 0:v.deleted_app_id)||(null==Fe?void 0:Fe.app_id)||"None"})]})}),(0,se.jsx)(UG,{title:"Recently Used Apps",icon:eh.A,isCollapsible:!0,defaultExpanded:!0,children:Se?(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"Loading apps..."}):(null==Ae||null===(d=Ae.apps)||void 0===d?void 0:d.length)>0?(0,se.jsx)("div",{className:"space-y-2",children:Ae.apps.map(e=>(0,se.jsx)("div",{className:"border-b border-slate-100 pb-2 last:border-0",children:(0,se.jsx)("div",{className:"flex items-start justify-between",children:(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("a",{href:e.app_link,target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1",children:[e.app_name,(0,se.jsx)(Rj.A,{className:"w-3 h-3"})]}),(0,se.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:["Updated ",e.updated_date?FH(e.updated_date):"N/A"]})]})})},e.app_id))}):(0,se.jsx)("p",{className:"text-xs text-slate-500 italic",children:"No recently used apps found."})})]})})})]}),(0,se.jsx)(Og,{open:O,onOpenChange:U,children:(0,se.jsxs)(Hg,{className:"sm:max-w-md",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)(qg,{className:"flex items-center",children:[(0,se.jsx)(BO.A,{className:"w-5 h-5 mr-2"}),Fe.assigned_to?"Reassign Ticket":"Assign Ticket"]})}),(0,se.jsxs)("div",{className:"space-y-4 py-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"assignEmail",children:"Agent Email"}),(0,se.jsx)(Df,{id:"assignEmail",type:"email",value:B,onChange:e=>{z(e.target.value),H&&V("")},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),Ie())},placeholder:"agent@base44.com",className:"w-full ".concat(H?"border-red-500":""),disabled:W}),H&&(0,se.jsx)("p",{className:"text-sm text-red-600",children:H}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Email must be from @base44.com or @wix.com domain"})]}),Fe.assigned_to&&(0,se.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,se.jsx)("p",{className:"text-xs text-slate-600 mb-1",children:"Currently assigned to:"}),(0,se.jsx)("p",{className:"text-sm font-medium text-slate-900",children:Fe.assigned_to})]})]}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>{z(""),V(""),U(!1)},disabled:W,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:Ie,disabled:W||!B.trim(),children:W?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Assigning..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(NH.A,{className:"w-4 h-4 mr-2"}),Fe.assigned_to?"Reassign":"Assign"," Ticket"]})})]})]})}),(0,se.jsx)(Og,{open:ve,onOpenChange:be,children:(0,se.jsxs)(Hg,{className:"sm:max-w-md",children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{children:"Add link"})}),(0,se.jsxs)("div",{className:"space-y-4 py-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"linkText",children:"Text"}),(0,se.jsx)(Df,{id:"linkText",type:"text",value:je,onChange:e=>ye(e.target.value),placeholder:"Link text",className:"w-full",autoFocus:!0,onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null===(t=document.getElementById("linkUrl"))||void 0===t||t.focus())}})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"linkUrl",children:"Link"}),(0,se.jsx)(Df,{id:"linkUrl",type:"url",value:Ne,onChange:e=>we(e.target.value),placeholder:"https://example.com",className:"w-full",onKeyDown:e=>{"Enter"===e.key&&Ne.trim()&&(e.preventDefault(),Me())}})]})]}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>{be(!1),ye(""),we(""),setTimeout(()=>{pe.current&&pe.current.focus()},0)},children:"Cancel"}),(0,se.jsx)(Bx,{onClick:Me,disabled:!Ne.trim(),children:"Save"})]})]})})]})}const HG=function(e,t,s,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=[...e];return n.includes("status")||("resolved"===t.status?l=l.filter(e=>"resolved"===e.ticket_status):"all"===t.status||("admin"===t.status||"user"===t.status?l=l.filter(e=>"resolved"!==e.ticket_status&&e.pending_response_from===t.status):s&&(l=l.filter(e=>"resolved"!==e.ticket_status)))),!n.includes("category")&&t.category.length>0&&(l=l.filter(e=>t.category.includes(e.category))),!n.includes("user_subscription_tier")&&t.user_subscription_tier.length>0&&(l=l.filter(e=>{const s=_G(e.user_subscription_tier);return t.user_subscription_tier.includes(s)})),!n.includes("assigned_to")&&t.assigned_to&&(l="unassigned"===t.assigned_to?l.filter(e=>!e.assigned_to):l.filter(e=>e.assigned_to===t.assigned_to)),!n.includes("internal_category")&&t.internal_category&&(l=l.filter(e=>e.internal_categories&&e.internal_categories.includes(t.internal_category))),n.includes("is_escalated")||!0!==t.is_escalated||(l=l.filter(e=>!0===e.is_escalated)),n.includes("is_reference")||!0!==t.is_reference||(l=l.filter(e=>!0===e.is_reference)),a&&(l=l.filter(e=>{var t,s,n,l;return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes(a.toLowerCase()))||(null===(s=e.content)||void 0===s?void 0:s.toLowerCase().includes(a.toLowerCase()))||(null===(n=e.app_id)||void 0===n?void 0:n.toLowerCase().includes(a.toLowerCase()))||(null===(l=e.created_by)||void 0===l?void 0:l.toLowerCase().includes(a.toLowerCase()))})),l},VG=hu({allTickets:[],searchQuery:"",isResolvingMany:!1,selectedTicketId:null,sortDirection:"desc",sortField:"last_agent_response_date",showResolved:!1,activeAgents:{},filters:{status:"",category:[],user_subscription_tier:[],app_id:"",created_by:"",assigned_to:"",internal_category:"",is_escalated:!1,is_reference:!1}},{_selectedTicketIds:[]}).use(rm("supportAdmin",{storage:localStorage,pick:["searchQuery","selectedTicketId","sortDirection","sortField","showResolved","filters","_selectedTicketIds"]})).use(mu({hasActiveFilters:e=>{const t=e.filters;return t.status||t.category.length>0||t.assigned_to||t.internal_category||t.user_subscription_tier.length>0||t.is_escalated||t.is_reference||e.searchQuery||e.showResolved},selectedTicket:e=>e.selectedTicketId?e.allTickets.find(t=>t.id===e.selectedTicketId):null,filteredTickets:e=>HG(e.allTickets,e.filters,e.showResolved,e.searchQuery),ticketsForStatusFilter:e=>HG(e.allTickets,e.filters,e.showResolved,e.searchQuery,["status"]),ticketsForCategoryFilter:e=>HG(e.allTickets,e.filters,e.showResolved,e.searchQuery,["category"]),ticketsForTierFilter:e=>HG(e.allTickets,e.filters,e.showResolved,e.searchQuery,["user_subscription_tier"]),ticketsForAssignedFilter:e=>HG(e.allTickets,e.filters,e.showResolved,e.searchQuery,["assigned_to"]),ticketsForInternalCategoryFilter:e=>HG(e.allTickets,e.filters,e.showResolved,e.searchQuery,["internal_category"]),ticketsForEscalatedFilter:e=>HG(e.allTickets,e.filters,e.showResolved,e.searchQuery,["is_escalated"])})).use(e=>({useSelectedTicketIds:()=>{const t=e.useFilteredTickets(),s=e(e=>e._selectedTicketIds),a=(0,Y.useMemo)(()=>{const e=t.map(e=>e.id),a=s.filter(t=>e.includes(t));return new Set(a)},[t,s]);return a},updateTicket:(t,s)=>{const a=e.allTickets.findIndex(e=>e.id===t);if(-1===a)return!1;const n=e.allTickets[a];return e.setState(e=>{e.allTickets[a]=(0,ue.A)((0,ue.A)((0,ue.A)({},n),s),{},{updated_date:(new Date).toISOString()})}),!0},clearFilters:()=>{e.setState(t=>{t.filters=e.getInitialState().filters}),e.searchQuery="",e.showResolved=!1},setFilter:(t,s)=>{e.setState(e=>{e.filters[t]=s,"status"!==t||"all"!==s&&"resolved"!==s||(e.showResolved=!0),"is_reference"===t&&!0===s&&(e.showResolved=!0,e.filters.status="all")})},isMultiSelectFilterSelected:(t,s)=>"all"===s?0===e.filters[t].length:e.filters[t].includes(s),toggleMultiSelectFilter:(t,s,a)=>{if("all"===s)return void e.setState(e=>{e.filters[t]=[]});const n=e.filters[t],l=n.includes(s);if(!a)return void e.setState(e=>{e.filters[t]=l&&1===n.length?[]:[s]});const r=l?n.filter(e=>e!==s):[...n,s];e.setState(e=>{e.filters[t]=r})},setSelectedTicketIds:t=>{e._selectedTicketIds=t},toggleSelectedTicketId:t=>{e._selectedTicketIds.includes(t)?e._selectedTicketIds=e._selectedTicketIds.filter(e=>e!==t):e.setState(e=>{e._selectedTicketIds.push(t)})},clearSelectedTicketIds:()=>{e._selectedTicketIds=[]}})),WG=e=>{var t,s,a,n,l,r,i,o,c,d,u,m,x,h,p,g;let{ticketCounts:f}=e;const{user:v}=wd(),b=VG.useFilters(),j=VG.useSearchQuery(),y=VG.useShowResolved(),N=VG.useHasActiveFilters(),w=null!==(t=f.totalForStatus)&&void 0!==t?t:f.total,_=null!==(s=f.totalForCategory)&&void 0!==s?s:f.total,k=null!==(a=f.totalForTier)&&void 0!==a?a:Object.values(null!==(n=null==f?void 0:f.tier)&&void 0!==n?n:{}).reduce((e,t)=>e+t,0),C=[{value:"",label:"Open Only",count:w-f.resolved},{value:"admin",label:"Pending Admin",count:f.pending_admin},{value:"user",label:"Pending User",count:f.pending_user},{value:"resolved",label:"Resolved Only",count:f.resolved},{value:"all",label:"All Tickets",count:w}],A=[{value:"all",label:"All",count:_},{value:"authentication",label:"Auth",count:(null===(l=f.category)||void 0===l?void 0:l.authentication)||0},{value:"billing",label:"Billing",count:(null===(r=f.category)||void 0===r?void 0:r.billing)||0},{value:"bug_report",label:"Bugs",count:(null===(i=f.category)||void 0===i?void 0:i.bug_report)||0},{value:"domain",label:"Domain",count:(null===(o=f.category)||void 0===o?void 0:o.domain)||0},{value:"integrations_and_backend_functions",label:"Integrations",count:(null===(c=f.category)||void 0===c?void 0:c.integrations_and_backend_functions)||0},{value:"chat_issues",label:"Chat",count:(null===(d=f.category)||void 0===d?void 0:d.chat_issues)||0},{value:"security",label:"Security",count:(null===(u=f.category)||void 0===u?void 0:u.security)||0},{value:"social_post_bonus_credits",label:"Social Bonus",count:(null===(m=f.category)||void 0===m?void 0:m.social_post_bonus_credits)||0},{value:"other",label:"Other",count:(null===(x=f.category)||void 0===x?void 0:x.other)||0}],S=null!==(h=f.totalForAssigned)&&void 0!==h?h:f.total,E=null==v?void 0:v.email,T=E&&(null===(p=f.assigned_to)||void 0===p?void 0:p[E])||0,I=[{value:"",label:"All Assigned",count:S},{value:"unassigned",label:"Unassigned",count:(null===(g=f.assigned_to)||void 0===g?void 0:g.unassigned)||0},...E?[{value:E,label:"Me",count:T}]:[],...Object.entries(f.assigned_to||{}).filter(e=>{let[t]=e;return"unassigned"!==t&&t!==E}).map(e=>{let[t,s]=e;return{value:t,label:t.split("@")[0],count:s}})];return(0,se.jsxs)("div",{className:"w-full h-full bg-white border-r border-slate-200 flex flex-col",children:[(0,se.jsx)("div",{className:"flex-shrink-0 p-3 border-b border-slate-100",children:(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-slate-400 w-3 h-3"}),(0,se.jsx)(Df,{placeholder:"Search...",value:j,onChange:e=>{VG.searchQuery=e.target.value},className:"pl-7 text-xs h-8"})]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 space-y-4 text-xs",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2 p-2 bg-slate-50 rounded border",children:[(0,se.jsx)(E_,{id:"show-resolved",checked:y,onCheckedChange:e=>{VG.showResolved=e},className:"h-4 w-4"}),(0,se.jsx)("label",{htmlFor:"show-resolved",className:"text-xs font-medium text-slate-700 cursor-pointer flex-1",children:"Include resolved tickets"})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 p-2 bg-slate-50 rounded border",children:[(0,se.jsx)(E_,{id:"show-reference-only",checked:b.is_reference,onCheckedChange:e=>{VG.setFilter("is_reference",e)},className:"h-4 w-4"}),(0,se.jsx)("label",{htmlFor:"show-reference-only",className:"text-xs font-medium text-slate-700 cursor-pointer flex-1",children:"Reference tickets only"})]})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Pending Response"}),(0,se.jsx)("div",{className:"space-y-0.5",children:C.map(e=>(0,se.jsx)("button",{onClick:()=>{VG.setFilter("status",b.status===e.value?"":e.value)},className:"w-full text-left px-2 py-1 rounded text-xs transition-colors ".concat(b.status===e.value?"bg-teal-100 text-teal-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"truncate",children:e.label}),void 0!==e.count&&(0,se.jsx)(gk,{variant:"secondary",className:"text-xs h-4 px-1",children:e.count})]})},e.value))})]}),f.escalated>0&&(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Priority"}),(0,se.jsx)("div",{className:"space-y-0.5",children:(0,se.jsx)("button",{onClick:()=>VG.setFilter("is_escalated",!0==!b.is_escalated),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors ".concat(!0===b.is_escalated?"bg-red-100 text-red-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,se.jsx)(Ap.A,{className:"w-3 h-3"}),(0,se.jsx)("span",{className:"truncate",children:"Escalated"})]}),(0,se.jsx)(gk,{variant:"secondary",className:"text-xs h-4 px-1",children:f.escalated})]})})})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Assigned"}),(0,se.jsx)("div",{className:"space-y-0.5 max-h-32 overflow-y-auto",children:I.map(e=>(0,se.jsx)("button",{onClick:()=>VG.setFilter("assigned_to",b.assigned_to===e.value?"":e.value),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors ".concat(b.assigned_to===e.value?"bg-blue-100 text-blue-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"truncate",children:e.label}),void 0!==e.count&&(0,se.jsx)(gk,{variant:"secondary",className:"text-xs h-4 px-1",children:e.count})]})},e.value))})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Subscription"}),(0,se.jsx)("div",{className:"space-y-0.5 max-h-32 overflow-y-auto",children:Object.entries((0,ue.A)({all:{label:"All Tiers"}},CG)).map(e=>{var t;let[s,a]=e;const n="all"===s?k:(null===(t=f.tier)||void 0===t?void 0:t[s])||0;return 0!==n||"all"===s||b.user_subscription_tier.includes(s)?(0,se.jsx)("button",{onClick:e=>VG.toggleMultiSelectFilter("user_subscription_tier",s,e.shiftKey),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors ".concat(VG.isMultiSelectFilterSelected("user_subscription_tier",s)?"bg-purple-100 text-purple-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"truncate",children:a.label}),(0,se.jsx)(gk,{variant:"secondary",className:"text-xs h-4 px-1",children:n})]})},s):null})})]}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Category"}),(0,se.jsx)("div",{className:"space-y-0.5",children:A.map(e=>(0,se.jsx)("button",{onClick:t=>{VG.toggleMultiSelectFilter("category",e.value,t.shiftKey)},className:"w-full text-left px-2 py-1 rounded text-xs transition-colors ".concat(VG.isMultiSelectFilterSelected("category",e.value)?"bg-orange-100 text-orange-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"truncate",children:e.label}),void 0!==e.count&&(0,se.jsx)(gk,{variant:"secondary",className:"text-xs h-4 px-1",children:e.count})]})},e.value))})]}),f.internal_categories&&Object.keys(f.internal_categories).length>0&&(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Internal Categories"}),(0,se.jsx)("div",{className:"space-y-0.5 max-h-32 overflow-y-auto",children:Object.entries(f.internal_categories).map(e=>{let[t,s]=e;return(0,se.jsx)("button",{onClick:()=>VG.setFilter("internal_category",b.internal_category===t?"":t),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors ".concat(b.internal_category===t?"bg-purple-100 text-purple-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"truncate",children:t}),(0,se.jsx)(gk,{variant:"secondary",className:"text-xs h-4 px-1",children:s})]})},t)})})]}),N&&(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:VG.clearFilters,className:"w-full text-xs h-7",children:"Clear Filters"})]})]})},qG=e=>{let{ticket:t,isSelected:s,onClick:a,onCheckboxToggle:n,showCheckbox:l,activeAgents:r,isCurrentUserViewing:i}=e;const o=kG[t.category],c=r||[];return(0,se.jsxs)("div",{className:"flex items-start p-3 border-b border-slate-100 transition-colors ".concat(s?"bg-teal-50 border-l-4 border-l-teal-500":"hover:bg-slate-50"),children:["resolved"!==t.ticket_status&&(0,se.jsx)("div",{className:"mr-3 mt-1",children:(0,se.jsx)(E_,{checked:l,onCheckedChange:()=>{n()},onClick:e=>e.stopPropagation(),className:"h-4 w-4"})}),(0,se.jsxs)("div",{onClick:a,className:"flex-1 cursor-pointer space-y-1.5",children:[(0,se.jsxs)("div",{className:"flex items-start gap-1",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900 text-sm line-clamp-2 leading-tight flex-1",children:t.title}),t.is_escalated&&(0,se.jsx)(Ap.A,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5",title:"Escalated"})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[(0,se.jsx)("span",{className:"truncate",children:t.created_by}),t.category&&(0,se.jsxs)("div",{className:"flex items-center space-x-1 flex-shrink-0 ml-2",children:[o&&(0,se.jsx)(o,{className:"w-3 h-3 text-slate-500"}),(0,se.jsx)("span",{className:"capitalize",children:"integrations_and_backend_functions"===t.category?"Integrations":t.category.replace("_"," ")})]})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[(0,se.jsxs)("span",{children:[(0,se.jsx)("span",{className:"text-slate-400",children:"created:"})," ",He().utc(t.created_date).fromNow()]}),t.last_agent_response_date&&(0,se.jsxs)("span",{children:[(0,se.jsx)("span",{className:"text-slate-400",children:"wait time:"})," ",He().utc(t.last_agent_response_date).fromNow()]})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("div",{className:"flex items-center space-x-2",children:t.pending_response_from?(0,se.jsx)(gk,{variant:"secondary",className:"text-xs ".concat("admin"===t.pending_response_from?"bg-orange-100 text-orange-800 border-orange-200":"user"===t.pending_response_from?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-800 border-gray-200"),children:"admin"===t.pending_response_from?"Pending Admin":"user"===t.pending_response_from?"Pending User":t.pending_response_from}):(0,se.jsx)(gk,{variant:"secondary",className:"text-xs bg-green-100 text-green-800 border-green-200",children:"Resolved"})}),(0,se.jsx)("div",{className:"flex items-center space-x-2",children:(0,se.jsx)("span",{className:"text-xs text-slate-500",children:t.assigned_to?(0,se.jsxs)("span",{children:[(0,se.jsx)("span",{className:"text-slate-400",children:"assigned:"})," ",t.assigned_to.split("@")[0]]}):(0,se.jsx)("span",{className:"text-slate-400 italic",children:"Unassigned"})})})]}),(c.length>0||i)&&(0,se.jsxs)("div",{className:"mt-1.5 flex items-center space-x-1.5 bg-teal-50 rounded-md px-2 py-1",children:[(0,se.jsx)(lA.A,{className:"w-3 h-3 text-teal-600"}),(0,se.jsxs)("div",{className:"flex -space-x-2",children:[i&&(0,se.jsx)("div",{className:"relative inline-flex items-center justify-center w-5 h-5 bg-orange-500 text-white rounded-full ring-2 ring-teal-50 text-[10px] font-medium shadow-sm hover:z-10 transition-all",title:"You",children:"Me"}),c.slice(0,i?2:3).map((e,t)=>(0,se.jsx)("div",{className:"relative inline-flex items-center justify-center w-5 h-5 bg-teal-500 text-white rounded-full ring-2 ring-teal-50 text-xs font-medium shadow-sm hover:z-10 transition-all",title:e.name,children:e.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)},e.id)),c.length>(i?2:3)&&(0,se.jsxs)("div",{className:"relative inline-flex items-center justify-center w-5 h-5 bg-slate-400 text-white rounded-full ring-2 ring-teal-50 text-xs font-medium shadow-sm",title:"".concat(c.length-(i?2:3)," more agents viewing"),children:["+",c.length-(i?2:3)]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full animate-pulse"}),(0,se.jsx)("span",{className:"text-xs text-teal-700 font-medium",children:[...i?["You"]:[],...c.map(e=>e.name.split(" ")[0])].join(", ")})]})]})]})]})};function YG(){const{user:e}=wd(),t=(0,J.Zp)(),[s]=(0,Z.useSearchParams)(),a=s.get("conversationId"),[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),d=VG.useActiveAgents(),{allTickets:u,isResolvingMany:m,showResolved:x,sortDirection:h,sortField:p,selectedTicketId:g}=VG.usePick("showResolved","sortDirection","allTickets","isResolvingMany","selectedTicketId","sortField"),f=VG.useFilters(),v=VG.useSelectedTicketIds(),b=VG.useFilteredTickets(),j=VG.useHasActiveFilters(),y=VG.useTicketsForStatusFilter(),N=VG.useTicketsForCategoryFilter(),w=VG.useTicketsForTierFilter(),_=VG.useTicketsForAssignedFilter(),k=VG.useTicketsForInternalCategoryFilter(),C=VG.useTicketsForEscalatedFilter();(0,Y.useEffect)(()=>{A(!0)},[]),(0,Y.useEffect)(()=>{u.length>0&&A()},[x,p,h,f.is_reference]),(0,Y.useEffect)(()=>{VG.selectedTicketId=null!=a?a:null},[a]),(0,Y.useEffect)(()=>{if(g&&u.length>0){u.find(e=>e.id===g)}},[u,g,t]),(0,Y.useEffect)(()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get("conversationId");if(e){u.find(t=>t.id===e)&&(VG.selectedTicketId=e)}else VG.selectedTicketId=null};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[u]);const A=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?l(!0):i(!0),c(null);const t=[];f.is_reference&&t.push({field:"is_reference",operator:"eq",value:!0});const s=await Qq.getTickets((0,ue.A)({show_resolved:x,sort_field:p,sort_direction:h},t.length>0&&{filters:t}));VG.allTickets=s||[]}catch(t){c("Failed to load support tickets. Please try again.")}finally{l(!1),i(!1)}};(0,Y.useEffect)(()=>{let e=null;return(async()=>{e=await oY.fetchAndSubscribe("realtime",e=>{if(e&&e.records){const t={};e.records.forEach(e=>{t[e.ticket_id]||(t[e.ticket_id]=[]),t[e.ticket_id].push({id:e.agent_user_id,name:e.agent_name,updatedAt:e.updated_date})}),VG.activeAgents=t}})})(),()=>{e&&e()}},[]),(0,Y.useEffect)(()=>{const e=Fd.A.addListener("/support/admin/tickets",e=>{e&&e.id&&VG.updateTicket(e.id,e)});return()=>{e()}},[]),(0,Y.useEffect)(()=>{let t,s;if(e&&e.id&&g){oY.updateRecord(e.id,g);const a=()=>{oY.updateRecord(e.id,g).catch(e=>{})},n=()=>{t&&clearInterval(t),t=setInterval(a,48e4)};document.hidden||n(),s=()=>{document.hidden?t&&(clearInterval(t),t=null):(a(),n())},document.addEventListener("visibilitychange",s)}else e&&e.id&&!g&&oY.updateRecord(e.id,null);return()=>{t&&clearInterval(t),s&&document.removeEventListener("visibilitychange",s)}},[e,g]);const S=(0,Y.useCallback)((e,t,s,a)=>{let n={};switch(!0){case!!a:let e=a.pending_response_from;if(!e&&(e="admin",a.messages&&a.messages.length>0)){e="user"===a.messages[a.messages.length-1].role?"admin":"user"}n=(0,ue.A)((0,ue.A)({},a),{},{pending_response_from:e});break;case"assigned"===t:n.assigned_to=s;break;case"categories_updated"===t:break;case"message_sent"===t:const l="admin"===s;n.pending_response_from=l?"user":"admin";break;case"ticket_closed"===t:n.ticket_status="resolved";break;default:n.ticket_status=t}VG.updateTicket(e,n)},[]),E=[...b].sort((e,t)=>{let s=0;if("updated_date"===p||"created_date"===p||"last_agent_response_date"===p){const a=new Date(e[p]),n=new Date(t[p]);s=a.getTime()-n.getTime()}else"subject"===p?s=(e.title||"").localeCompare(t.title||""):"category"===p?s=(e.category||"").localeCompare(t.category||""):"assigned_to"===p&&(s=(e.assigned_to||"").localeCompare(t.assigned_to||""));return"desc"===h?-s:s}),T=(e=>{let{ticketsForStatus:t,ticketsForCategory:s,ticketsForTier:a,ticketsForAssigned:n,ticketsForInternalCategory:l,ticketsForEscalated:r,statusFilter:i=""}=e;const o=e=>"resolved"===i?"resolved"===e.ticket_status:"all"===i||"resolved"!==e.ticket_status,c=s.filter(o).length,d=n.filter(o).length,u=a.filter(o).length,m={status:{},tier:{},category:{},assigned_to:{},internal_categories:{},escalated:0,pending_admin:0,pending_user:0,resolved:0,pending_response_from:{},total:t.length,totalForStatus:t.length,totalForCategory:c,totalForAssigned:d,totalForTier:u};return t.forEach(e=>{if("resolved"===e.ticket_status)m.status.resolved=(m.status.resolved||0)+1;else{const t=e.pending_response_from;t&&(m.status[t]=(m.status[t]||0)+1)}}),a.forEach(e=>{if(o(e)){const t=_G(e.user_subscription_tier);m.tier[t]=(m.tier[t]||0)+1}}),s.forEach(e=>{if(o(e)){const t=e.category;t&&(m.category[t]=(m.category[t]||0)+1)}}),n.forEach(e=>{if(o(e)){const t=e.assigned_to||"unassigned";m.assigned_to[t]=(m.assigned_to[t]||0)+1}}),l.forEach(e=>{o(e)&&e.internal_categories&&Array.isArray(e.internal_categories)&&e.internal_categories.forEach(e=>{m.internal_categories[e]=(m.internal_categories[e]||0)+1})}),r.forEach(e=>{o(e)&&!0===e.is_escalated&&m.escalated++}),m.pending_admin=m.status.admin||0,m.pending_user=m.status.user||0,m.resolved=m.status.resolved||0,m})({ticketsForStatus:y,ticketsForCategory:N,ticketsForTier:w,ticketsForAssigned:_,ticketsForInternalCategory:k,ticketsForEscalated:C,statusFilter:f.status});return n?(0,se.jsx)("div",{className:"h-screen flex items-center justify-center",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-400 mx-auto mb-4"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Loading conversations..."})]})}):o&&0===u.length?(0,se.jsx)(jG,{error:o,onRetry:()=>A(!0)}):(0,se.jsxs)("div",{className:"w-full h-screen bg-slate-50",children:[(0,se.jsx)("div",{className:"bg-white border-b border-slate-200 px-4 md:px-6 py-3 relative z-10",children:(0,se.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2 md:space-x-4",children:[(0,se.jsx)("h1",{className:"text-lg md:text-xl font-semibold text-slate-900",children:"Support Admin"}),(0,se.jsxs)("span",{className:"text-xs md:text-sm text-slate-500",children:[E.length," conversations"]}),r&&(0,se.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-slate-500",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-slate-400"}),(0,se.jsx)("span",{children:"Refreshing..."})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[v.size>0&&(0,se.jsxs)(Bx,{onClick:async()=>{if(0===v.size)return;const e="Are you sure you want to resolve ".concat(v.size," ticket").concat(v.size>1?"s":"","?");if(window.confirm(e))try{VG.isResolvingMany=!0;const e=Array.from(v),s=await Qq.resolveMany(e);if(s.resolved&&s.resolved.length>0){var t;VG.clearSelectedTicketIds(),await A();const e=s.resolved.length,a=(null===(t=s.errors)||void 0===t?void 0:t.length)||0;let n="Successfully resolved ".concat(e," ticket").concat(e>1?"s":"");a>0&&(n+=" (".concat(a," failed)")),alert(n)}}catch(s){alert("Failed to resolve tickets. Please try again.")}finally{VG.isResolvingMany=!1}},disabled:m,variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700",children:[m?(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):(0,se.jsx)(hb.A,{className:"w-4 h-4 mr-2"}),"Resolve ",v.size," ticket",v.size>1?"s":""]}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:VG.clearFilters,disabled:!j,children:"Clear Filters"}),(0,se.jsxs)(Bx,{onClick:()=>t("/support/admin/agent-backoffice"),variant:"outline",size:"sm",children:[(0,se.jsx)(vP.A,{className:"w-4 h-4 mr-2"}),"AI Settings"]}),(0,se.jsxs)(Bx,{onClick:()=>A(),variant:"outline",size:"sm",disabled:r,children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2 ".concat(r?"animate-spin":"")}),"Refresh"]})]})]})}),(0,se.jsxs)(MP,{direction:"horizontal",style:{height:"calc(100vh - 80px)"},children:[(0,se.jsx)(RP,{defaultSize:8,minSize:5,maxSize:25,className:"hidden md:block",children:(0,se.jsx)(WG,{ticketCounts:T})}),(0,se.jsx)(DP,{withHandle:!0,className:"hidden md:flex group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,se.jsxs)(RP,{defaultSize:10,minSize:5,maxSize:40,className:"bg-white border-r border-slate-200 flex flex-col",children:[E.some(e=>"resolved"!==e.ticket_status)&&(0,se.jsxs)("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 p-3 flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(E_,{checked:v.size>0&&E.every(e=>v.has(e.id)),onCheckedChange:()=>{const e=E.filter(e=>"resolved"!==e.ticket_status);v.size===e.length?VG.clearSelectedTicketIds():VG.setSelectedTicketIds(e.map(e=>e.id))},className:"h-4 w-4"}),(0,se.jsx)("span",{className:"text-xs text-slate-600",children:"Select all open tickets"})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-slate-500",children:[(0,se.jsx)("span",{children:"Sort:"}),(0,se.jsxs)("select",{value:p,onChange:e=>VG.sortField=e.target.value,className:"bg-transparent border-none text-xs text-slate-600 focus:outline-none",children:[(0,se.jsx)("option",{value:"last_agent_response_date",children:"Wait Time"}),(0,se.jsx)("option",{value:"updated_date",children:"Updated"}),(0,se.jsx)("option",{value:"created_date",children:"Created"}),(0,se.jsx)("option",{value:"subject",children:"Subject"}),(0,se.jsx)("option",{value:"category",children:"Category"}),(0,se.jsx)("option",{value:"assigned_to",children:"Assigned"})]}),(0,se.jsx)(Bx,{onClick:()=>VG.sortDirection="desc"===h?"asc":"desc",variant:"ghost",size:"sm",className:"h-5 w-5 p-0",children:"desc"===h?(0,se.jsx)(Uk.A,{className:"w-3 h-3"}):(0,se.jsx)(kp.A,{className:"w-3 h-3"})})]})]}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===b.length?(0,se.jsx)("div",{className:"p-8 text-center text-slate-500",children:(0,se.jsx)("p",{children:"No conversations found"})}):(0,se.jsx)("div",{children:E.map(e=>(0,se.jsx)(qG,{ticket:e,isSelected:g===e.id,onClick:()=>(e=>{VG.selectedTicketId=e;const s=new URLSearchParams(window.location.search);s.set("conversationId",e),t("?".concat(s.toString()),{replace:!0})})(e.id),onCheckboxToggle:()=>VG.toggleSelectedTicketId(e.id),showCheckbox:v.has(e.id),activeAgents:d[e.id],isCurrentUserViewing:g===e.id},e.id))})})]}),(0,se.jsx)(DP,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,se.jsx)(RP,{defaultSize:50,minSize:10,className:"bg-white min-w-0 overflow-hidden",children:g?(0,se.jsx)(zG,{conversationId:g,onTicketUpdated:S}):(0,se.jsx)("div",{className:"h-full flex items-center justify-center text-slate-500 p-4",children:(0,se.jsxs)("div",{className:"text-center max-w-md",children:[(0,se.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(vP.A,{className:"w-8 h-8"})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Select a conversation"}),(0,se.jsx)("p",{className:"text-slate-600 text-sm",children:"Choose a support ticket from the list to view details and respond"})]})})})]})]})}const GG=e=>{if(!e)return"Not available";const t=He().utc(e);return"".concat(t.format("MMM DD, YYYY")," (").concat(t.fromNow(),")")},KG=e=>{let{article:t,onEdit:s,onDelete:a}=e;return(0,se.jsxs)(Bv,{className:"group hover:shadow-lg transition-all duration-300 border-slate-200 hover:border-slate-300",children:[(0,se.jsx)(zv,{className:"pb-3",children:(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)(Hv,{className:"text-lg font-semibold text-slate-900 truncate group-hover:text-slate-700 transition-colors",children:t.title}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,se.jsxs)(gk,{variant:"outline",className:"text-xs",children:[(0,se.jsx)(xb.A,{className:"w-3 h-3 mr-1"}),"Article"]}),t.created_date&&(0,se.jsxs)("span",{className:"text-xs text-slate-500",children:["Created ",GG(t.created_date)]})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>s(t),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,se.jsx)(Qv.A,{className:"w-4 h-4"})}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>a(t),className:"opacity-0 group-hover:opacity-100 transition-opacity text-red-600 hover:text-red-800",children:(0,se.jsx)(zy.A,{className:"w-4 h-4"})})]})]})}),(0,se.jsx)(Wv,{className:"pt-0",children:(0,se.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed line-clamp-3",children:t.content||"No content available"})})]})},$G=e=>{let{article:t,isOpen:s,onClose:a,onSave:n,isCreating:l}=e;const[r,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{t?(i(t.title||""),c(t.content||"")):(i(""),c(""))},[t,s]);return(0,se.jsx)(Og,{open:s,onOpenChange:a,children:(0,se.jsxs)(Hg,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)(qg,{className:"flex items-center",children:[(0,se.jsx)(xb.A,{className:"w-5 h-5 mr-2"}),l?"Create New Article":"Edit Article"]})}),(0,se.jsxs)("div",{className:"space-y-6 py-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"title",children:"Title"}),(0,se.jsx)(Df,{id:"title",value:r,onChange:e=>i(e.target.value),placeholder:"Enter article title...",className:"w-full"})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"content",children:"Content"}),(0,se.jsx)(tN,{id:"content",value:o,onChange:e=>c(e.target.value),placeholder:"Enter article content...",className:"min-h-[400px] resize-none"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"You can use markdown formatting for better presentation."})]}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:a,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:async()=>{if(r.trim()&&o.trim()){u(!0);try{await n({id:null==t?void 0:t.id,title:r.trim(),content:o.trim()}),a()}catch(e){}finally{u(!1)}}},disabled:d||!r.trim()||!o.trim(),children:d?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lV.A,{className:"w-4 h-4 mr-2"}),l?"Create Article":"Save Changes"]})})]})]})]})})},ZG=e=>{let{categories:t,onSave:s}=e;const[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{n(t||[])},[t]);const u=()=>{const e=l.trim();e&&!a.includes(e)&&(n([...a,e]),r(""))};return(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)(Hv,{className:"flex items-center",children:[(0,se.jsx)(Gq.A,{className:"w-5 h-5 mr-2"}),"Internal Category Options"]}),!i&&(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>o(!0),children:[(0,se.jsx)(Qv.A,{className:"w-4 h-4 mr-2"}),"Edit"]})]})}),(0,se.jsx)(Wv,{children:i?(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex space-x-2",children:[(0,se.jsx)(Df,{value:l,onChange:e=>r(e.target.value),placeholder:"Add new internal category...",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),u())},className:"flex-1"}),(0,se.jsx)(Bx,{onClick:u,disabled:!l.trim(),children:(0,se.jsx)(op.A,{className:"w-4 h-4"})})]}),(0,se.jsxs)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[a.map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded-lg",children:[(0,se.jsx)("span",{className:"text-sm text-slate-700",children:e}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>{return t=e,void n(a.filter(e=>e!==t));var t},className:"text-red-600 hover:text-red-800 h-6 w-6 p-0",children:(0,se.jsx)(la.A,{className:"w-3 h-3"})})]},t)),0===a.length&&(0,se.jsx)("p",{className:"text-sm text-slate-500 text-center py-4",children:"No internal categories defined yet"})]})]}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsxs)(Bx,{variant:"outline",onClick:()=>{n(t||[]),r(""),o(!1)},children:[(0,se.jsx)(la.A,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,se.jsx)(Bx,{onClick:async()=>{d(!0);try{await s(a),o(!1)}catch(e){}finally{d(!1)}},disabled:c,children:c?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lV.A,{className:"w-4 h-4 mr-2"}),"Save Categories"]})})]})]}):(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:a.length>0?a.map((e,t)=>(0,se.jsxs)(gk,{variant:"outline",className:"text-xs",children:[(0,se.jsx)(Gq.A,{className:"w-3 h-3 mr-1"}),e]},t)):(0,se.jsx)("div",{className:"text-sm text-slate-500 bg-slate-50 rounded-lg p-4 text-center w-full",children:"No internal categories defined yet"})}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"These categories can be assigned to support tickets for internal organization and tracking."})]})})]})},JG=e=>{let{admins:t,onSave:s,currentUserEmail:a,isCurrentUserAdmin:n}=e;const[l,r]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)("");(0,Y.useEffect)(()=>{r(t||[])},[t]);const p=()=>{const e=i.trim().toLowerCase();h(""),e&&(Lv(e)?l.includes(e)?h("This email is already in the list"):(r([...l,e]),o("")):h("Please enter a valid email address"))},g=n;return(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)(Hv,{className:"flex items-center",children:[(0,se.jsx)(fv.A,{className:"w-5 h-5 mr-2 text-amber-500"}),"Reference Ticket Admins"]}),!c&&g&&(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>d(!0),children:[(0,se.jsx)(Qv.A,{className:"w-4 h-4 mr-2"}),"Edit"]})]})}),(0,se.jsx)(Wv,{children:c?(0,se.jsxs)("div",{className:"space-y-4",children:[x&&(0,se.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-600 flex items-center",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 mr-2"}),x]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex space-x-2",children:[(0,se.jsx)(Df,{type:"email",value:i,onChange:e=>o(e.target.value),placeholder:"Add admin email...",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),p())},className:"flex-1"}),(0,se.jsx)(Bx,{onClick:p,disabled:!i.trim(),children:(0,se.jsx)(op.A,{className:"w-4 h-4"})})]}),(0,se.jsxs)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[l.map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded-lg",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(NH.A,{className:"w-4 h-4 text-slate-400"}),(0,se.jsx)("span",{className:"text-sm text-slate-700",children:e}),e===a&&(0,se.jsx)(gk,{variant:"outline",className:"text-xs",children:"You"})]}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>{return t=e,void(1!==l.length?r(l.filter(e=>e!==t)):h("Cannot remove the last admin"));var t},className:"text-red-600 hover:text-red-800 h-6 w-6 p-0",disabled:1===l.length,children:(0,se.jsx)(la.A,{className:"w-3 h-3"})})]},t)),0===l.length&&(0,se.jsx)("p",{className:"text-sm text-slate-500 text-center py-4",children:"No reference admins defined yet"})]})]}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsxs)(Bx,{variant:"outline",onClick:()=>{r(t||[]),o(""),d(!1),h("")},children:[(0,se.jsx)(la.A,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,se.jsx)(Bx,{onClick:async()=>{if(0!==l.length){m(!0),h("");try{await s(l),d(!1)}catch(a){var e,t;h((null==a||null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to save changes")}finally{m(!1)}}else h("At least one admin is required")},disabled:u,children:u?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lV.A,{className:"w-4 h-4 mr-2"}),"Save Admins"]})})]})]}):(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:l.length>0?l.map((e,t)=>(0,se.jsxs)(gk,{variant:"outline",className:"text-xs",children:[(0,se.jsx)(NH.A,{className:"w-3 h-3 mr-1"}),e,e===a&&(0,se.jsx)("span",{className:"ml-1 text-teal-600",children:"(You)"})]},t)):(0,se.jsx)("div",{className:"text-sm text-slate-500 bg-slate-50 rounded-lg p-4 text-center w-full",children:"No reference admins defined yet"})}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"These users can mark tickets as reference tickets. Only existing admins can modify this list."}),!g&&(0,se.jsx)("p",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded",children:"Only reference admins can edit this list."})]})})]})},QG=e=>{let{title:t,systemPrompt:s,onSave:a,promptKey:n}=e;const[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{r(s||"")},[s]);return(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)(Hv,{className:"flex items-center",children:[(0,se.jsx)(yS.A,{className:"w-5 h-5 mr-2"}),t]}),!i&&(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>o(!0),children:[(0,se.jsx)(Qv.A,{className:"w-4 h-4 mr-2"}),"Edit"]})]})}),(0,se.jsx)(Wv,{children:i?(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)(tN,{value:l,onChange:e=>r(e.target.value),placeholder:"Enter ".concat(t.toLowerCase()," for AI assistance..."),className:"min-h-[200px] resize-none"}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsxs)(Bx,{variant:"outline",onClick:()=>{r(s||""),o(!1)},children:[(0,se.jsx)(la.A,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,se.jsx)(Bx,{onClick:async()=>{d(!0);try{await a(n,l),o(!1)}catch(e){}finally{d(!1)}},disabled:c,children:c?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lV.A,{className:"w-4 h-4 mr-2"}),"Save Prompt"]})})]})]}):(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"bg-slate-50 rounded-lg p-4 border",children:(0,se.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-slate-700 font-sans leading-relaxed",children:l||"No ".concat(t.toLowerCase()," configured")})}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"response_system_prompt"===n?"This prompt guides the AI when responding to support questions.":"This prompt guides the AI when polishing and improving message grammar."})]})})]})},XG="support_templates",eK=e=>{try{localStorage.setItem(XG,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("templatesUpdated"))}catch(t){}},tK=e=>{let{}=e;const[t,s]=(0,Y.useState)([]),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{s((()=>{try{const e=localStorage.getItem(XG);return e?JSON.parse(e):[]}catch(e){return[]}})())},[]);const p=()=>{n(null),r(!0),o(""),d("")};return(0,se.jsxs)("div",{className:"space-y-6",children:[(l||a)&&(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsxs)(Hv,{className:"flex items-center",children:[(0,se.jsx)(xb.A,{className:"w-5 h-5 mr-2"}),l?"Create New Template":"Edit Template"]})}),(0,se.jsxs)(Wv,{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"templateName",children:"Template Name"}),(0,se.jsx)(Df,{id:"templateName",value:i,onChange:e=>o(e.target.value),placeholder:"Enter template name...",className:"w-full"})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"templateContent",children:"Template Content"}),(0,se.jsx)(tN,{id:"templateContent",value:c,onChange:e=>d(e.target.value),placeholder:"Enter template content...",className:"min-h-[200px] resize-none"})]}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsxs)(Bx,{variant:"outline",onClick:()=>{n(null),r(!1),o(""),d("")},children:[(0,se.jsx)(la.A,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,se.jsx)(Bx,{onClick:async()=>{if(i.trim()&&c.trim()){m(!0);try{const e={id:(null==a?void 0:a.id)||Date.now().toString(),name:i.trim(),content:c.trim(),created_date:(null==a?void 0:a.created_date)||(new Date).toISOString(),updated_date:(new Date).toISOString()},l=a?t.map(t=>t.id===a.id?e:t):[...t,e];s(l),eK(l),n(null),r(!1),o(""),d("")}catch(e){}finally{m(!1)}}},disabled:u||!i.trim()||!c.trim(),children:u?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(lV.A,{className:"w-4 h-4 mr-2"}),l?"Create Template":"Save Changes"]})})]})]})]}),(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)(Hv,{className:"flex items-center",children:[(0,se.jsx)(xb.A,{className:"w-5 h-5 mr-2"}),"Response Templates (",t.length,")"]}),!l&&!a&&(0,se.jsxs)(Bx,{onClick:p,children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-2"}),"New Template"]})]})}),(0,se.jsx)(Wv,{children:0===t.length?(0,se.jsxs)("div",{className:"text-center py-8",children:[(0,se.jsx)("div",{className:"mx-auto w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:(0,se.jsx)(xb.A,{className:"w-8 h-8 text-slate-400"})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No Templates Yet"}),(0,se.jsx)("p",{className:"text-slate-600 mb-4",children:"Create reusable response templates to speed up your workflow."}),(0,se.jsxs)(Bx,{onClick:p,children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-2"}),"Create First Template"]})]}):(0,se.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,se.jsxs)("div",{className:"border border-slate-200 rounded-lg p-4 hover:bg-slate-50 transition-colors",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-900 truncate",children:e.name}),(0,se.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["Created ",GG(e.created_date),e.updated_date!==e.created_date&&(0,se.jsxs)("span",{children:[" \u2022 Updated ",GG(e.updated_date)]})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>(e=>{n(e),r(!1),o(e.name),d(e.content)})(e),className:"h-8 w-8 p-0",children:(0,se.jsx)(Qv.A,{className:"w-4 h-4"})}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>(e=>{h(e)})(e),className:"h-8 w-8 p-0 text-red-600 hover:text-red-800",children:(0,se.jsx)(zy.A,{className:"w-4 h-4"})})]})]}),(0,se.jsx)("div",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3 border",children:(0,se.jsx)("div",{className:"line-clamp-3",children:e.content})})]},e.id))})})]}),(0,se.jsx)(Og,{open:!!x,onOpenChange:()=>h(null),children:(0,se.jsxs)(Hg,{children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)(qg,{className:"flex items-center text-red-600",children:[(0,se.jsx)(ad.A,{className:"w-5 h-5 mr-2"}),"Delete Template"]})}),(0,se.jsx)("div",{className:"py-4",children:(0,se.jsxs)("p",{className:"text-slate-600",children:['Are you sure you want to delete the template "',null==x?void 0:x.name,'"? This action cannot be undone.']})}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>h(null),children:"Cancel"}),(0,se.jsxs)(Bx,{variant:"destructive",onClick:()=>{if(x){const e=t.filter(e=>e.id!==x.id);s(e),eK(e),h(null)}},children:[(0,se.jsx)(zy.A,{className:"w-4 h-4 mr-2"}),"Delete Template"]})]})]})})]})},sK=e=>{let{suggestion:t,index:s}=e;const[a,n]=(0,Y.useState)(!1),l={high:"bg-red-100 text-red-800 border-red-200",medium:"bg-amber-100 text-amber-800 border-amber-200",low:"bg-green-100 text-green-800 border-green-200"};return(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-3",children:(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,se.jsxs)(gk,{variant:"outline",className:"text-xs",children:["#",s+1]}),(0,se.jsx)(gk,{className:"text-xs ".concat(l[t.priority]||l.medium),children:t.priority}),(0,se.jsx)(gk,{variant:"outline",className:"text-xs",children:t.category})]}),(0,se.jsx)(Hv,{className:"text-lg font-semibold text-slate-900",children:t.title})]}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>n(!a),className:"ml-2",children:a?(0,se.jsx)(ur.A,{className:"w-4 h-4"}):(0,se.jsx)(_t.A,{className:"w-4 h-4"})})]})}),(0,se.jsxs)(Wv,{className:"pt-0 space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-1",children:"Question"}),(0,se.jsx)("p",{className:"text-slate-600 text-sm bg-slate-50 p-3 rounded-lg border",children:t.question})]}),a&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-1",children:"Suggested Answer"}),(0,se.jsx)("div",{className:"text-slate-600 text-sm bg-slate-50 p-3 rounded-lg border whitespace-pre-wrap",children:t.suggested_answer})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-1",children:"Why This Should Be Added"}),(0,se.jsx)("p",{className:"text-slate-600 text-sm bg-amber-50 p-3 rounded-lg border border-amber-200",children:t.reasoning})]}),t.source_tickets.length>0&&(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-1",children:"Source Tickets"}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:t.source_tickets.map(e=>(0,se.jsxs)("a",{href:"/support/admin/conversations?conversationId=".concat(e),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-teal-600 hover:text-teal-800 bg-teal-50 px-2 py-1 rounded border border-teal-200",children:[e.slice(0,8),"...",(0,se.jsx)(Rj.A,{className:"w-3 h-3 ml-1"})]},e))})]})]}),!a&&(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"text-xs text-slate-500",children:"Show full suggestion..."})]})]})},aK=()=>{const[e,t]=(0,Y.useState)(!1),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null);return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsxs)(Hv,{className:"flex items-center",children:[(0,se.jsx)(ib.A,{className:"w-5 h-5 mr-2 text-amber-500"}),"FAQ Generator"]})}),(0,se.jsxs)(Wv,{className:"space-y-4",children:[(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Analyze reference tickets against documentation to identify knowledge gaps. This uses AI to find information that exists in expert responses but is missing from the docs."}),(0,se.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg border space-y-2",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700",children:"How it works:"}),(0,se.jsxs)("ul",{className:"text-sm text-slate-600 list-disc list-inside space-y-1",children:[(0,se.jsx)("li",{children:"Fetches all reference tickets (tickets marked with exemplary responses)"}),(0,se.jsx)("li",{children:"Compares them against the current documentation"}),(0,se.jsx)("li",{children:"Uses Claude Opus 4.5 with high reasoning to identify gaps"}),(0,se.jsx)("li",{children:"Generates FAQ suggestions to fill those gaps"})]})]}),(0,se.jsx)(Bx,{onClick:async()=>{t(!0),l(null);try{const e=await Qq.generateFAQSuggestions();a({suggestions:e.suggestions||[],analysis_summary:e.analysis_summary||"",total_reference_tickets_analyzed:e.total_reference_tickets_analyzed||0,documentation_gaps_found:e.documentation_gaps_found||0})}catch(n){var e,s;l((null==n||null===(e=n.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to generate FAQ suggestions. Please try again.")}finally{t(!1)}},disabled:e,className:"w-full",children:e?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Analyzing... (this may take a few minutes)"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ib.A,{className:"w-4 h-4 mr-2"}),"Generate FAQ Suggestions"]})}),n&&(0,se.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-600 flex items-center",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 mr-2"}),n]})]})]}),s&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Bv,{children:[(0,se.jsx)(zv,{children:(0,se.jsx)(Hv,{className:"text-lg",children:"Analysis Summary"})}),(0,se.jsxs)(Wv,{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg border text-center",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:s.total_reference_tickets_analyzed}),(0,se.jsx)("div",{className:"text-sm text-slate-600",children:"Reference Tickets Analyzed"})]}),(0,se.jsxs)("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 text-center",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-amber-700",children:s.documentation_gaps_found}),(0,se.jsx)("div",{className:"text-sm text-amber-600",children:"Documentation Gaps Found"})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[(0,se.jsx)("h4",{className:"text-sm font-medium text-slate-700 mb-2",children:"AI Analysis"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 whitespace-pre-wrap",children:s.analysis_summary})]})]})]}),s.suggestions.length>0?(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("h3",{className:"text-lg font-semibold text-slate-900",children:["FAQ Suggestions (",s.suggestions.length,")"]}),s.suggestions.map((e,t)=>(0,se.jsx)(sK,{suggestion:e,index:t},t))]}):(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"py-8 text-center",children:[(0,se.jsx)("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:(0,se.jsx)(ib.A,{className:"w-8 h-8 text-green-500"})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No Gaps Found"}),(0,se.jsx)("p",{className:"text-slate-600",children:"The documentation appears to cover the topics discussed in reference tickets well."})]})})]})]})};function nK(){const e=(0,J.Zp)(),{user:t}=wd(),[s,a]=(0,Y.useState)(""),[n,l]=(0,Y.useState)(""),[r,i]=(0,Y.useState)([]),[o,c]=(0,Y.useState)([]),[d,u]=(0,Y.useState)(""),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,b]=(0,Y.useState)(null),{data:{articles:j},isLoading:y,error:N,refetch:w}=Xd({initialData:{articles:[]},query:async()=>{var e,t;const[s,n]=await Promise.all([eY.getArticles(),eY.getAgentProperties()]);return l((null==n?void 0:n.polish_system_prompt)||""),a((null==n?void 0:n.response_system_prompt)||""),i((null==n?void 0:n.internal_category_options)||[]),c((null==n?void 0:n.reference_admins)||[]),{articles:null!==(e=null!==(t=null==s?void 0:s.articles)&&void 0!==t?t:s)&&void 0!==e?e:[]}},logErrorMsg:"Error fetching docs data:"},[]),_=()=>{x(null),f(!0),p(!0)},k=e=>{x(e),f(!1),p(!0)},C=e=>{b(e)},A=async(e,t)=>{const s={};s[e]=t,await eY.updateAgentProperties(s),"response_system_prompt"===e?a(t):"polish_system_prompt"===e&&l(t)},S=o.includes((null==t?void 0:t.email)||""),E=j.filter(e=>{var t,s;return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))||(null===(s=e.content)||void 0===s?void 0:s.toLowerCase().includes(d.toLowerCase()))});return y?(0,se.jsx)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:(0,se.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,se.jsx)("div",{className:"h-8 bg-slate-200 rounded w-1/3"}),(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,se.jsx)("div",{className:"h-48 bg-slate-200 rounded-lg"}),(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(e=>(0,se.jsx)("div",{className:"h-32 bg-slate-200 rounded-lg"},e))})]})]})}):Boolean(N)?(0,se.jsx)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:(0,se.jsxs)("div",{className:"text-center py-16",children:[(0,se.jsx)("div",{className:"mx-auto w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,se.jsx)(ad.A,{className:"w-12 h-12 text-red-500"})}),(0,se.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Error Loading Documentation"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6",children:"Failed to load documentation data. Please try again."}),(0,se.jsx)(Bx,{onClick:w,variant:"outline",children:"Try Again"})]})}):(0,se.jsxs)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:[(0,se.jsx)("div",{className:"mb-8",children:(0,se.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,se.jsxs)(Bx,{variant:"ghost",size:"sm",onClick:()=>e("/support/admin/conversations"),className:"text-slate-600 hover:text-slate-900",children:[(0,se.jsx)(Vs.A,{className:"w-4 h-4 mr-2"}),"Back to list"]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"AI Settings"}),(0,se.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage support articles and AI system prompts"})]})]}),(0,se.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,se.jsxs)(Bx,{onClick:w,variant:"outline",size:"sm",children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,se.jsxs)(Bx,{onClick:_,children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-2"}),"New Article"]})]})]})}),(0,se.jsxs)(Kj,{defaultValue:"articles",className:"space-y-6",children:[(0,se.jsxs)($j,{className:"grid w-full grid-cols-6 lg:w-[1050px]",children:[(0,se.jsxs)(Zj,{value:"articles",className:"flex items-center space-x-2",children:[(0,se.jsx)(Lj.A,{className:"w-4 h-4"}),(0,se.jsxs)("span",{children:["Articles (",j.length,")"]})]}),(0,se.jsxs)(Zj,{value:"system-prompts",className:"flex items-center space-x-2",children:[(0,se.jsx)(vP.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:"System Prompts"})]}),(0,se.jsxs)(Zj,{value:"templates",className:"flex items-center space-x-2",children:[(0,se.jsx)(xb.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:"Templates"})]}),(0,se.jsxs)(Zj,{value:"internal-categories",className:"flex items-center space-x-2",children:[(0,se.jsx)(Gq.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:"Categories"})]}),(0,se.jsxs)(Zj,{value:"reference-admins",className:"flex items-center space-x-2",children:[(0,se.jsx)(fv.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:"Reference Admins"})]}),(0,se.jsxs)(Zj,{value:"faq-generator",className:"flex items-center space-x-2",children:[(0,se.jsx)(ib.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:"FAQ Generator"})]})]}),(0,se.jsxs)(Jj,{value:"articles",className:"space-y-6",children:[(0,se.jsx)("div",{className:"flex items-center space-x-4",children:(0,se.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,se.jsx)(Df,{placeholder:"Search articles...",value:d,onChange:e=>u(e.target.value),className:"pl-10"})]})}),0===E.length?(0,se.jsxs)("div",{className:"text-center py-16",children:[(0,se.jsx)("div",{className:"mx-auto w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-6",children:(0,se.jsx)(xb.A,{className:"w-12 h-12 text-slate-400"})}),(0,se.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:d?"No Articles Found":"No Articles Yet"}),(0,se.jsx)("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:d?"No articles match your search criteria. Try adjusting your search terms.":"Get started by creating your first support article."}),!d&&(0,se.jsxs)(Bx,{onClick:_,children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-2"}),"Create First Article"]})]}):(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(e=>(0,se.jsx)(KG,{article:e,onEdit:k,onDelete:C},e.id))})]}),(0,se.jsxs)(Jj,{value:"system-prompts",className:"space-y-6",children:[(0,se.jsx)(QG,{title:"Response System Prompt",systemPrompt:s,onSave:A,promptKey:"response_system_prompt"}),(0,se.jsx)(QG,{title:"Polish System Prompt",systemPrompt:n,onSave:A,promptKey:"polish_system_prompt"})]}),(0,se.jsx)(Jj,{value:"templates",className:"space-y-6",children:(0,se.jsx)(tK,{})}),(0,se.jsx)(Jj,{value:"internal-categories",className:"space-y-6",children:(0,se.jsx)(ZG,{categories:r,onSave:async e=>{await eY.updateAgentProperties({internal_category_options:e}),i(e)}})}),(0,se.jsx)(Jj,{value:"reference-admins",className:"space-y-6",children:(0,se.jsx)(JG,{admins:o,onSave:async e=>{await eY.updateAgentProperties({reference_admins:e}),c(e)},currentUserEmail:(null==t?void 0:t.email)||"",isCurrentUserAdmin:S})}),(0,se.jsx)(Jj,{value:"faq-generator",className:"space-y-6",children:(0,se.jsx)(aK,{})})]}),(0,se.jsx)($G,{article:m,isOpen:h,onClose:()=>p(!1),onSave:async e=>{g?await eY.createArticle(e):await eY.updateArticle(e.id,e),await w()},isCreating:g}),(0,se.jsx)(Og,{open:!!v,onOpenChange:()=>b(null),children:(0,se.jsxs)(Hg,{children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)(qg,{className:"flex items-center text-red-600",children:[(0,se.jsx)(ad.A,{className:"w-5 h-5 mr-2"}),"Delete Article"]})}),(0,se.jsx)("div",{className:"py-4",children:(0,se.jsxs)("p",{className:"text-slate-600",children:['Are you sure you want to delete "',null==v?void 0:v.title,'"? This action cannot be undone.']})}),(0,se.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>b(null),children:"Cancel"}),(0,se.jsxs)(Bx,{variant:"destructive",onClick:async()=>{if(v)try{await eY.deleteArticle(v.id),await w(),b(null)}catch(N){}},children:[(0,se.jsx)(zy.A,{className:"w-4 h-4 mr-2"}),"Delete Article"]})]})]})})]})}var lK=s(57456);const rK=(0,Y.createContext)(null);function iK(e){var t,s;let{children:a,workspaceId:n}=e;const[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)([]),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(null),b=(0,Y.useRef)(null),j=(0,Y.useCallback)(async()=>{try{o(!0),d(null);const e=await Hd.getDashboard(n);r(e),b.current&&b.current(),b.current=Hd.subscribeToDashboard(n,e,t=>{var s,a;const n=(0,ue.A)((0,ue.A)((0,ue.A)({},e),t),{},{workspace:(0,ue.A)((0,ue.A)((0,ue.A)({},e.workspace),t.workspace),{},{is_personal:void 0!==(null===(s=t.workspace)||void 0===s?void 0:s.is_personal)?t.workspace.is_personal:null===(a=e.workspace)||void 0===a?void 0:a.is_personal})});r(n)})}catch(e){d(e)}finally{o(!1)}},[n]),y=(0,Y.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=(null==e?void 0:e.map(e=>e.price_id))||null,s=await Hd.getAvailablePlans(t);m(s.plans||[])}catch(c){m([])}},[]),N=(0,Y.useCallback)(async()=>{await j()},[j]),w=(0,Y.useCallback)(()=>{var e;const t=null==l?void 0:l.user_role;return!(null!=l&&null!==(e=l.workspace)&&void 0!==e&&e.is_personal)&&[yR.OWNER,yR.ADMIN].includes(t)},[l]),_=(0,Y.useCallback)(()=>{const e=null==l?void 0:l.user_role;return[yR.OWNER,yR.ADMIN].includes(e)},[l]),k=(0,Y.useCallback)(async(e,t)=>{h(!0);try{await Hd.inviteUser(e,t,n)}finally{h(!1)}},[n]),C=(0,Y.useCallback)(async(e,t)=>{h(!0);try{await Hd.updateMemberRole(e,t,n)}catch(c){throw c}finally{h(!1)}},[n]),A=(0,Y.useCallback)(async(e,t)=>{h(!0);try{await Hd.updateMemberSeat(e,t,n)}catch(c){throw c}finally{h(!1)}},[n]),S=(0,Y.useCallback)(e=>{v(e),g(!0)},[]),E=(0,Y.useCallback)(()=>{g(!1),v(null)},[]),T=(0,Y.useCallback)(async()=>{if(f){g(!1),h(!0);try{await Hd.removeMember(f.email,n),v(null)}catch(c){throw c}finally{h(!1)}}},[f,n]),I=(0,Y.useCallback)(async(e,t,s)=>{h(!0);try{let l;if(l="buy"===s?await Hd.buySeats(e,t,n):await Hd.removeSeats(e,t,n),!l)throw new Error("Invalid response from server");if("stripe_checkout_required"===l.status)try{const e=await ow.createWorkspaceCheckoutSession(l.workspace_id,l.pending_changes);if(e.subscription_updated);else{if(!e.url)throw new Error("No checkout URL received from billing service");window.location.href=e.url}}catch(a){throw a}}catch(c){throw c}finally{h(!1)}},[n]);(0,Y.useEffect)(()=>(j(),()=>{b.current&&b.current()}),[j]),(0,Y.useEffect)(()=>{var e;if(i)return;const t=null==l||null===(e=l.workspace)||void 0===e?void 0:e.plans;y(t||null)},[i,null==l||null===(t=l.workspace)||void 0===t?void 0:t.plans,y]);const P={loading:i,error:c,actionLoading:x,availablePlans:u,currentWorkspace:null==l?void 0:l.workspace,plans:(null==l||null===(s=l.workspace)||void 0===s?void 0:s.plans)||[],members:(null==l?void 0:l.members)||[],userRole:(null==l?void 0:l.user_role)||yR.MEMBER,currentUser:null==l?void 0:l.current_user,workspaceId:n,showRemoveDialog:p,memberToRemove:f,loadDashboard:j,inviteUser:k,updateMemberRole:C,updateMemberSeat:A,showRemoveMemberDialog:S,hideRemoveMemberDialog:E,confirmRemoveMember:T,manageSeat:I,handleCheckoutSuccess:N,canInviteUsers:w,canManageSeats:_};return(0,se.jsx)(rK.Provider,{value:P,children:a})}function oK(){const e=(0,Y.useContext)(rK);if(!e)throw new Error("useWorkspaceDashboard must be used within a WorkspaceDashboardProvider");return e}var cK=s(40602);const dK=e=>{let{users:t,onSelectUser:s,anchorElement:a,onClose:n}=e;const[l,r]=(0,Y.useState)({left:0,top:0,width:0}),i=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{const e=()=>{if(!a)return;const e=a.getBoundingClientRect(),t=window.innerHeight,s=window.innerWidth,n=Math.max(e.width,300),l=t-e.bottom,i=e.top,o=l<192&&i>192;let c=e.left;c+n>s&&(c=s-n-10),c<10&&(c=10),r({left:c,top:o?e.top-192-4:e.bottom+4,width:n})};e();const t=()=>e(),s=()=>e();return window.addEventListener("scroll",t,!0),window.addEventListener("resize",s),()=>{window.removeEventListener("scroll",t,!0),window.removeEventListener("resize",s)}},[a]),(0,Y.useEffect)(()=>{const e=e=>{i.current&&!i.current.contains(e.target)&&a&&!a.contains(e.target)&&n()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[n,a]);const o=(0,se.jsx)("div",{ref:i,className:"fixed z-[1000] bg-white border border-slate-200 rounded-md shadow-xl max-h-48 overflow-y-auto",style:{left:"".concat(l.left,"px"),top:"".concat(l.top,"px"),width:"".concat(l.width,"px")},children:t.map(e=>(0,se.jsx)("div",{className:"px-3 py-2 hover:bg-orange-50 cursor-pointer transition-colors border-b border-slate-100 last:border-b-0",onClick:()=>s(e.email),children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-100 to-orange-200 rounded-full flex items-center justify-center",children:(0,se.jsx)(ay.A,{className:"w-3 h-3 text-orange-600"})}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700 truncate max-w-[200px]",children:e.email}),"pending"===e.status&&(0,se.jsx)("span",{className:"text-xs text-orange-500 font-medium",children:"Pending invitation"})]})]})},e.email))});return xc.createPortal(o,document.body)},uK=e=>{let{anchorElement:t,onClose:s}=e;const[a,n]=(0,Y.useState)({left:0,top:0,width:0}),l=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{const e=()=>{if(!t)return;const e=t.getBoundingClientRect(),s=window.innerWidth,a=Math.max(e.width,300);let l=e.left;l+a>s&&(l=s-a-10),l<10&&(l=10),n({left:l,top:e.bottom+4,width:a})};e();const s=()=>e(),a=()=>e();return window.addEventListener("scroll",s,!0),window.addEventListener("resize",a),()=>{window.removeEventListener("scroll",s,!0),window.removeEventListener("resize",a)}},[t]),(0,Y.useEffect)(()=>{const e=e=>{l.current&&!l.current.contains(e.target)&&t&&!t.contains(e.target)&&s()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[s,t]);const r=(0,se.jsx)("div",{ref:l,className:"fixed z-[1000] bg-white border border-slate-200 rounded-md shadow-xl",style:{left:"".concat(a.left,"px"),top:"".concat(a.top,"px"),width:"".concat(a.width,"px")},children:(0,se.jsx)("div",{className:"px-3 py-2 text-sm text-slate-500 text-center",children:"No users found"})});return xc.createPortal(r,document.body)},mK=e=>{let{open:t,onOpenChange:s,planName:a}=e;const[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(new Set),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)(""),[g,f]=(0,Y.useState)(null),{workspaceId:v,members:b}=oK();(0,Y.useEffect)(()=>{t&&a?j():t||(x(null),p(""),f(null))},[t,a]),(0,Y.useEffect)(()=>{p(""),f(null)},[m]);const j=async()=>{try{i(!0),c(null),l(null);const e=await Hd.getSeatUsage(a,v);l(e.data||e)}catch(s){var e,t;c((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to fetch seat usage data")}finally{i(!1)}},y=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="".concat(a,"_").concat(t);try{if(u(e=>new Set([...Array.from(e),r])),x(null),p(""),f(null),s)await Hd.updateMemberSeat(e,null,v);else{var i;const s=null==n||null===(i=n.plan)||void 0===i?void 0:i.price_id;if(!s)throw new Error("Plan price ID not found");await Hd.updateMemberSeat(e,s,v,t)}l(a=>{if(!a)return a;const n=a.seats.map(a=>a.assigned_user===e&&a.seat_number!==t?(0,ue.A)((0,ue.A)({},a),{},{assigned_user:null,status:"available"}):a.seat_number===t?(0,ue.A)((0,ue.A)({},a),{},{assigned_user:s?null:e,status:s?"available":"assigned"}):a),l=n.filter(e=>"assigned"===e.status).length,r=a.plan.total_seats-l;return(0,ue.A)((0,ue.A)({},a),{},{seats:n,summary:(0,ue.A)((0,ue.A)({},a.summary),{},{total_assigned:l,total_available:r}),plan:(0,ue.A)((0,ue.A)({},a.plan),{},{used_seats:l,available_seats:r})})})}catch(m){var o,d;c((null===(o=m.response)||void 0===o||null===(d=o.data)||void 0===d?void 0:d.detail)||"Failed to assign user to seat")}finally{u(e=>{const t=new Set(e);return t.delete(r),t})}},N=e=>"assigned"===e?(0,se.jsx)(ay.A,{className:"w-3 h-3"}):(0,se.jsx)(eb.A,{className:"w-3 h-3"});return(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsxs)(Hg,{className:"max-w-5xl max-h-[90vh] flex flex-col",children:[(0,se.jsxs)(Vg,{className:"pb-3",children:[(0,se.jsxs)(qg,{className:"flex items-center gap-2 text-lg",children:[(0,se.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-100 to-orange-200 rounded-full flex items-center justify-center",children:(0,se.jsx)(eb.A,{className:"w-4 h-4 text-orange-600"})}),(0,se.jsxs)("span",{className:"font-semibold text-slate-800",children:[a," Seats Usage"]})]}),(0,se.jsx)(Yg,{className:"text-slate-600 text-sm ml-10",children:"Detailed view of seat allocation and usage for this plan. Click available seats to assign users."})]}),r&&(0,se.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}),o&&(0,se.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,se.jsx)("p",{className:"text-red-800 text-sm",children:o})}),n&&(0,se.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[(0,se.jsxs)(Bv,{className:"p-3 bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-orange-500 rounded-full flex items-center justify-center",children:(0,se.jsx)(eb.A,{className:"w-3 h-3 text-white"})}),(0,se.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Total Seats"})]}),(0,se.jsx)("div",{className:"text-xl font-bold text-slate-900",children:n.plan.total_seats})]}),(0,se.jsxs)(Bv,{className:"p-3 bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,se.jsx)(ay.A,{className:"w-3 h-3 text-white"})}),(0,se.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Assigned"})]}),(0,se.jsx)("div",{className:"text-xl font-bold text-slate-900",children:n.summary.total_assigned})]}),(0,se.jsxs)(Bv,{className:"p-3 bg-gradient-to-br from-teal-50 to-teal-100 border-teal-200",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-teal-500 rounded-full flex items-center justify-center",children:(0,se.jsx)(Pf.A,{className:"w-3 h-3 text-white"})}),(0,se.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Period Usage"})]}),(0,se.jsxs)("div",{className:"text-xl font-bold text-slate-900",children:[n.summary.current_month_usage,"/",n.summary.monthly_limit||0]}),(0,se.jsx)("div",{className:"text-xs text-slate-500 mt-1 font-medium",children:n.summary.period})]})]}),(0,se.jsx)(ly,{className:"mb-4"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-slate-900 mb-3",children:"Individual Seats"}),(0,se.jsxs)("div",{className:"border rounded-xl overflow-hidden bg-white shadow-sm",children:[(0,se.jsx)(pD,{children:(0,se.jsx)(gD,{className:"bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200",children:(0,se.jsxs)(vD,{children:[(0,se.jsx)(bD,{className:"w-20 font-semibold text-slate-700 py-2",children:"Seat #"}),(0,se.jsx)(bD,{className:"w-24 font-semibold text-slate-700 py-2",children:"Status"}),(0,se.jsx)(bD,{className:"font-semibold text-slate-700 py-2",children:"Assigned User"}),(0,se.jsx)(bD,{className:"w-32 text-right font-semibold text-slate-700 py-2",children:"Period Usage"})]})})}),(0,se.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,se.jsx)(pD,{children:(0,se.jsx)(fD,{children:n.seats.map(e=>{const t=(()=>{if(!b)return[];let e=b.filter(e=>"active"===e.status||"pending"===e.status);return h.trim()&&(e=e.filter(e=>e.email.toLowerCase().includes(h.toLowerCase()))),e})(),s=d.has("".concat(a,"_").concat(e.seat_number)),n=m===e.seat_number;return(0,se.jsxs)(vD,{className:"hover:bg-slate-50/50 transition-colors",children:[(0,se.jsxs)(jD,{className:"font-semibold w-20 text-slate-600 py-2",children:["#",e.seat_number]}),(0,se.jsx)(jD,{className:"w-24 py-2",children:(0,se.jsxs)(gk,{className:"text-xs font-medium ".concat((l=e.status,"assigned"===l?"bg-green-100 text-green-800 border-green-200 hover:bg-green-100 hover:text-green-800":"bg-slate-100 text-slate-600 border-slate-200 hover:bg-slate-100 hover:text-slate-600")),children:[N(e.status),(0,se.jsx)("span",{className:"ml-1 capitalize",children:e.status})]})}),(0,se.jsx)(jD,{className:"py-2",children:s?(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-100 to-orange-200 rounded-full flex items-center justify-center",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border border-orange-400 border-t-transparent"})}),(0,se.jsx)("span",{className:"text-sm font-medium text-orange-600 animate-pulse",children:"Updating..."})]}):e.assigned_user?(0,se.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-green-100 to-green-200 rounded-full flex items-center justify-center",children:(0,se.jsx)(ay.A,{className:"w-3 h-3 text-green-600"})}),(0,se.jsx)("div",{className:"flex-1 min-w-0",children:(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700 truncate block",children:e.assigned_user})}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",disabled:s,onClick:()=>y(e.assigned_user,e.seat_number,!0),className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-50 hover:text-red-600 rounded-full",title:"Remove user from seat",children:"\xd7"})]}):n?(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-2 top-2.5 h-3 w-3 text-slate-400"}),(0,se.jsx)(Df,{placeholder:"Search users...",value:h,onChange:e=>p(e.target.value),className:"pl-7 pr-8 h-8 text-sm border-orange-200 focus:border-orange-400 focus:ring-orange-200",autoFocus:!0,ref:e=>{e&&!g&&f(e)}}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>{x(null),p(""),f(null)},className:"absolute right-1 top-1 h-6 w-6 p-0 hover:bg-slate-100 rounded-full",children:(0,se.jsx)(la.A,{className:"h-3 w-3 text-slate-400"})})]}),g&&t.length>0&&(0,se.jsx)(dK,{users:t,onSelectUser:t=>y(t,e.seat_number),anchorElement:g,onClose:()=>{x(null),p(""),f(null)}}),g&&h&&0===t.length&&(0,se.jsx)(uK,{anchorElement:g,onClose:()=>{x(null),p(""),f(null)}})]}):(0,se.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,se.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center",children:(0,se.jsx)(BO.A,{className:"w-3 h-3 text-slate-500"})}),(0,se.jsx)("span",{className:"text-sm text-slate-500 cursor-pointer hover:text-orange-600 hover:underline transition-colors font-medium",onClick:t=>{x(e.seat_number)},title:"Click to assign user",children:"Available for assignment"})]})}),(0,se.jsx)(jD,{className:"text-right w-32 py-2",children:(0,se.jsxs)("div",{className:"font-semibold text-slate-700 bg-slate-50 px-2 py-1 rounded-md inline-block text-sm",children:[e.current_month_usage,"/",e.monthly_limit||0]})})]},e.seat_number);var l})})})})]})]})]})]})})},xK={Starter:(0,se.jsx)(OP.A,{className:"text-orange-500"}),Builder:(0,se.jsx)(cK.A,{className:"text-teal-500"}),Pro:(0,se.jsx)(ry.A,{className:"text-orange-400"}),Elite:(0,se.jsx)(yS.A,{className:"text-purple-500"})},hK=e=>{if(!e)return null;const t=e.replace(/\s*\d+$/,"");return xK[t]||xK.Elite};function pK(e){let{onRemoveSeats:t,onBuySeats:s}=e;const{plans:a,canManageSeats:n}=oK(),[l,r]=(0,Y.useState)({open:!1,planName:null});return a&&0!==a.length?(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[a.map(e=>(0,se.jsxs)(Bv,{className:"bg-white rounded-xl shadow-sm p-6 flex flex-col gap-3",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0",children:hK(e.name)}),(0,se.jsxs)("span",{className:"font-semibold text-lg",children:[e.name," Seats"]})]}),n()&&(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-slate-400 hover:text-slate-600",children:(0,se.jsx)(mb.A,{className:"h-3 w-3"})})}),(0,se.jsxs)(Aj,{align:"end",className:"w-40",children:[(0,se.jsxs)(Sj,{onClick:()=>{return t=e.name,void r({open:!0,planName:t});var t},children:[(0,se.jsx)(GP.A,{className:"w-4 h-4 mr-2"}),"Seats Usage"]}),(0,se.jsx)(Sj,{onClick:()=>s(e.name),children:"Add Seats"}),e.used_seats<e.total_seats&&(0,se.jsx)(Sj,{onClick:()=>t(e.name),children:"Remove Seats"})]})]})]}),(0,se.jsxs)("div",{className:"text-2xl font-bold",children:[e.used_seats," / ",e.total_seats]}),(0,se.jsxs)("div",{className:"text-slate-500 text-sm",children:[e.available_seats," seats available"]})]},e.name)),n()&&(0,se.jsxs)(Bv,{className:"bg-gradient-to-br from-orange-50 to-teal-50 border-orange-200/50 rounded-xl shadow-sm p-6 flex flex-col justify-center items-center text-center hover:shadow-md transition-all cursor-pointer",onClick:()=>s(),children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,se.jsx)(op.A,{className:"w-6 h-6 text-orange-500"}),(0,se.jsx)("span",{className:"font-semibold text-lg text-slate-900",children:"Buy More Seats"})]}),(0,se.jsx)("div",{className:"text-slate-600 text-sm",children:"Expand your workspace size"})]}),(0,se.jsx)(mK,{open:l.open,onOpenChange:()=>{r({open:!1,planName:null})},planName:l.planName})]}):(0,se.jsx)("div",{className:"mb-8",children:(0,se.jsx)(Bv,{className:"bg-gradient-to-br from-orange-50 to-teal-50 border-orange-200/50 rounded-xl shadow-sm p-8",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:(0,se.jsx)(eb.A,{className:"w-8 h-8 text-orange-600"})}),(0,se.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Get Started with Workspace Seats"}),(0,se.jsx)("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:"Purchase seats to invite workspace members and start collaborating."}),n()&&(0,se.jsxs)(Bx,{onClick:()=>s(),className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium",children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-2"}),"Buy Your First Seats"]})]})})})}const gK={Starter:(0,se.jsx)(OP.A,{className:"text-orange-500"}),Builder:(0,se.jsx)(cK.A,{className:"text-teal-500"}),Pro:(0,se.jsx)(ry.A,{className:"text-orange-400"}),Elite:(0,se.jsx)(yS.A,{className:"text-purple-500"})},fK=e=>{if(!e)return null;const t=e.replace(/\s*\d+$/,"");return gK[t]||gK.Elite};function vK(e){var t;let{member:s}=e;const{currentUser:a,plans:n,userRole:l,canManageSeats:r,updateMemberRole:i,updateMemberSeat:o,showRemoveMemberDialog:c,actionLoading:d}=oK(),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),{displayStatus:p,seatTypeName:g}=(0,Y.useMemo)(()=>{let e=s.status;if("pending"===s.status){s.invitation_expires_at&&new Date(s.invitation_expires_at)<new Date&&(e="expired")}const t=s.seat_type?n.find(e=>e.price_id===s.seat_type):null;return{displayStatus:e,seatPlan:t,seatTypeName:t?t.name:null}},[s,n]),f=[yR.OWNER,yR.ADMIN].includes(l),v=f&&s.email!==(null==a?void 0:a.email),b=s.email===(null==a?void 0:a.email),j=f&&!b&&(l===yR.OWNER||l===yR.ADMIN&&"owner"!==s.role),y=f&&!b&&(l===yR.OWNER||l===yR.ADMIN&&"owner"!==s.role),N=l===yR.OWNER&&!b,w=async e=>{if(s.role!==e&&f){m(!0);try{await i(s.email,e)}finally{m(!1)}}},_=async e=>{if(s.seat_type!==e&&r()){h(!0);try{await o(s.email,e)}finally{h(!1)}}};return(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4 border-b border-slate-100 last:border-b-0 gap-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,se.jsx)(hg,{className:"h-10 w-10 flex-shrink-0",children:(0,se.jsx)(gg,{className:"bg-slate-100 text-slate-700 font-bold text-sm",children:null===(t=s.email[0])||void 0===t?void 0:t.toUpperCase()})}),(0,se.jsx)("div",{className:"min-w-0 flex-1",children:(0,se.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,se.jsx)("span",{className:"font-medium text-slate-900 truncate max-w-[200px] sm:max-w-none",children:s.email}),"pending"===p&&(0,se.jsx)(gk,{variant:"secondary",className:"bg-orange-100 text-orange-700 border-orange-200 text-xs flex-shrink-0",children:"Pending"}),"expired"===p&&(0,se.jsx)(gk,{variant:"destructive",className:"bg-red-100 text-red-700 border-red-200 text-xs flex-shrink-0",children:"Expired"})]})})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0 ml-[52px] sm:ml-0",children:[(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"outline",size:"sm",className:"min-w-[100px] justify-between",disabled:u||d||!j&&!y&&!N,children:[(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[u?(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin"}):(0,se.jsx)(ay.A,{className:"h-3 w-3"}),(0,se.jsx)("span",{className:"capitalize",children:s.role})]}),(0,se.jsx)(_t.A,{className:"h-3 w-3"})]})}),(0,se.jsxs)(Aj,{align:"end",className:"w-40",children:[(0,se.jsxs)(Sj,{onClick:()=>w("member"),disabled:"member"===s.role||!j||u,children:[(0,se.jsx)(ay.A,{className:"mr-2 h-4 w-4"}),"Member"]}),(0,se.jsxs)(Sj,{onClick:()=>w("admin"),disabled:"admin"===s.role||!y||u,children:[(0,se.jsx)(ay.A,{className:"mr-2 h-4 w-4"}),"Admin"]}),(0,se.jsxs)(Sj,{onClick:()=>w("owner"),disabled:"owner"===s.role||!N||u,children:[(0,se.jsx)(ay.A,{className:"mr-2 h-4 w-4"}),"Owner"]}),v&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"border-t border-slate-100 my-1"}),(0,se.jsxs)(Sj,{onClick:()=>{c(s)},disabled:d||u,className:"text-red-600 hover:text-red-700 focus:text-red-700",children:[d?(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,se.jsx)(ay.A,{className:"mr-2 h-4 w-4"}),"Remove Member"]})]})]})]}),(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"outline",size:"sm",className:"min-w-[120px] justify-between",disabled:x||d,children:[(0,se.jsx)("div",{className:"flex items-center gap-1",children:x?(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin"}):g?(0,se.jsxs)(se.Fragment,{children:[fK(g),(0,se.jsx)("span",{children:g})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ay.A,{className:"h-3 w-3"}),(0,se.jsx)("span",{children:"Viewer"})]})}),(0,se.jsx)(_t.A,{className:"h-3 w-3"})]})}),(0,se.jsxs)(Aj,{align:"end",className:"w-50",children:[(0,se.jsxs)(Sj,{onClick:()=>_(null),disabled:!s.seat_type||x,children:[(0,se.jsx)(ay.A,{className:"mr-2 h-4 w-4"}),"Viewer"]}),n.length>0&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"border-t border-slate-100 my-1"}),n.map(e=>(0,se.jsxs)(Sj,{onClick:()=>_(e.price_id),disabled:s.seat_type===e.price_id||!r()||x||0===e.available_seats,className:0===e.available_seats?"opacity-50":"",children:[(0,se.jsx)("div",{className:"flex items-center mr-2 h-4 w-4",children:fK(e.name)}),(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsx)("span",{children:e.name}),(0,se.jsxs)("span",{className:"text-xs text-slate-500",children:[e.available_seats," available"]})]})]},e.price_id))]})]})]})]})]})}function bK(e){let{onInviteUser:t,onBulkInvite:s}=e;const{currentWorkspace:a,members:n,canInviteUsers:l,plans:r}=oK(),[i,o]=(0,Y.useState)(""),c=(0,Y.useMemo)(()=>{if(!i.trim())return n;const e=i.toLowerCase();return n.filter(t=>{var s,a,n;const l=(e=>{if(!e.seat_type)return"no seat";const t=null==r?void 0:r.find(t=>t.price_id===e.seat_type);return t?t.name.toLowerCase():"no seat"})(t);return(null===(s=t.email)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(a=t.role)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(n=t.status)||void 0===n?void 0:n.toLowerCase().includes(e))||l.includes(e)})},[n,i,r]),d=n&&n.length>0,u=c&&c.length>0;return(0,se.jsxs)(Bv,{children:[(0,se.jsxs)(zv,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(eb.A,{className:"text-slate-400"}),(0,se.jsxs)(Hv,{children:["Members ",i?(0,se.jsxs)("span",{children:["(",(null==c?void 0:c.length)||0," of ",(null==n?void 0:n.length)||0,")"]}):(0,se.jsxs)("span",{children:["(",(null==n?void 0:n.length)||0,")"]})]})]}),l()&&(0,se.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,se.jsxs)(Bx,{variant:"outline",onClick:s,className:"text-orange-600 border-orange-200 hover:bg-orange-50",size:"sm",children:[(0,se.jsx)(W_.A,{className:"h-4 w-4 mr-2"}),"Bulk Invite"]}),(0,se.jsxs)(Bx,{onClick:t,size:"sm",children:[(0,se.jsx)(op.A,{className:"h-4 w-4 mr-1"}),"Invite User"]})]})]}),(0,se.jsxs)(Wv,{children:[d&&(0,se.jsxs)("div",{className:"mb-4",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),(0,se.jsx)(Df,{type:"text",placeholder:"Search by email, role, status, or seat type (e.g., starter, pro)...",value:i,onChange:e=>o(e.target.value),className:"pl-10 bg-white border-slate-200 focus:border-orange-300 focus:ring-orange-200"})]}),i&&(0,se.jsx)("div",{className:"mt-2 text-xs text-slate-500",children:'Tip: Search for seat types like "starter", "builder", "pro", "elite", or "no seat"'})]}),d?!u&&i?(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,se.jsx)(na.A,{className:"text-slate-200 text-5xl mb-2"}),(0,se.jsx)("div",{className:"font-semibold text-lg",children:"No members found"}),(0,se.jsxs)("div",{className:"text-slate-500",children:['No members match "',i,'"']}),(0,se.jsx)(Bx,{variant:"outline",onClick:()=>o(""),className:"mt-4 text-orange-600 border-orange-200 hover:bg-orange-50",children:"Clear search"})]}):(0,se.jsx)("div",{className:"space-y-0",children:c.map(e=>(0,se.jsx)(vK,{member:e},e.id))}):(0,se.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,se.jsx)(eb.A,{className:"text-slate-200 text-5xl mb-2"}),(0,se.jsx)("div",{className:"font-semibold text-lg",children:"No workspace members yet"}),(0,se.jsx)("div",{className:"text-slate-500",children:null!=a&&a.is_personal?"Personal workspaces contain only you":"Start by inviting your first workspace member"})]})]})]})}function jK(e){let{isOpen:t,onClose:s,onInvite:a}=e;const{actionLoading:n}=oK(),[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)("member"),[c,d]=(0,Y.useState)(""),u=()=>{r(""),o("member"),d(""),s()};return(0,se.jsx)(Og,{open:t,onOpenChange:u,children:(0,se.jsxs)(Hg,{className:"max-w-md",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"rounded bg-teal-100 p-2",children:(0,se.jsx)(Hc.A,{className:"text-teal-600 w-5 h-5"})}),(0,se.jsx)(qg,{className:"text-2xl font-bold",children:"Invite Workspace Member"})]})}),(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l.trim())if(l.includes("@"))try{d(""),await a(l.trim(),i),u()}catch(n){var t,s;const e=n;d((null==e||null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||e.message||"Failed to invite user")}else d("Please enter a valid email address");else d("Email is required")},className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email Address"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Hc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,se.jsx)(Df,{type:"email",placeholder:"colleague@company.com",value:l,onChange:e=>r(e.target.value),disabled:n,className:"pl-10 focus:ring-2 focus:ring-teal-500",autoFocus:!0})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Role"}),(0,se.jsxs)("select",{className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-teal-500",value:i,onChange:e=>o(e.target.value),disabled:n,children:[(0,se.jsx)("option",{value:"member",children:"Member"}),(0,se.jsx)("option",{value:"admin",children:"Admin"})]})]}),c&&(0,se.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,se.jsx)("p",{className:"text-red-700 text-sm",children:c})}),(0,se.jsxs)(Wg,{children:[(0,se.jsx)(Bx,{type:"button",variant:"outline",onClick:u,disabled:n,children:"Cancel"}),(0,se.jsx)(Bx,{type:"submit",className:"bg-teal-600 hover:bg-teal-700 text-white",disabled:n||!l.trim(),children:n?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending Invite..."]}):"Send Invite"})]})]})]})})}const yK=[{value:"member",label:"Member"},{value:"admin",label:"Admin"}];function NK(e){let{isOpen:t,onClose:s,onSuccess:a}=e;const{workspaceId:n,plans:l,availablePlans:r}=oK(),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)("member"),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(""),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)([]),[b,j]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(!1),[w,_]=(0,Y.useState)(!1),k=(0,Y.useRef)(null),C=Y.useMemo(()=>{const e=[{value:null,label:"Viewer"}];return r&&r.length>0&&e.push(...r.map(e=>({value:e.name.toLowerCase(),label:e.name}))),e},[r]),A=e=>"text/csv"===e.type||e.name.endsWith(".csv")?(o(e),h(""),S(e),!0):(h("Please upload a CSV file"),!1),S=e=>{const t=new FileReader;t.onload=e=>{try{var t;const s=(null===(t=e.target)||void 0===t?void 0:t.result).split("\n").filter(e=>e.trim());if(0===s.length)return void h("CSV file is empty");const a=s[0].split(",").map(e=>e.trim().toLowerCase());if(!a.includes("email"))return void h('CSV must contain an "email" column');const n=[];for(let e=1;e<s.length;e++){const t=s[e].split(",").map(e=>e.trim()),l={};a.forEach((e,s)=>{l[e]=t[s]||""}),l.email&&n.push({email:l.email,role:l.role||"",seat:l.seat||""})}if(0===n.length)return void h("No valid email addresses found in CSV");v(n),j(!0),h("")}catch(s){const e="string"==typeof s.message?s.message:"Unknown parsing error";h("Error parsing CSV file: "+e)}},t.readAsText(e)},E=async e=>{if(e.preventDefault(),i)if(0!==p.length){N(!0),h("");try{const e=new FileReader;e.onload=async e=>{try{var t;const s=(null===(t=e.target)||void 0===t?void 0:t.result).split("\n").filter(e=>e.trim()),l=s[0].split(",").map(e=>e.trim().toLowerCase()),r=[];for(let e=1;e<s.length;e++){const t=s[e].split(",").map(e=>e.trim()),a={};l.forEach((e,s)=>{a[e]=t[s]||""}),a.email&&r.push({email:a.email,role:a.role||c,seat:a.seat||u})}T(r),await Hd.bulkInviteUsers(r,n),a&&a(),I()}catch(r){var s,l;let e="Failed to send bulk invitations";null!=r&&null!==(s=r.response)&&void 0!==s&&null!==(l=s.data)&&void 0!==l&&l.detail?"string"==typeof r.response.data.detail?e=r.response.data.detail:Array.isArray(r.response.data.detail)?e=r.response.data.detail.map(e=>e.msg||e.message||e).join(", "):"object"==typeof r.response.data.detail&&(e=r.response.data.detail.msg||r.response.data.detail.message||JSON.stringify(r.response.data.detail)):null!=r&&r.message&&(e=r.message),h(e)}finally{N(!1)}},e.readAsText(i)}catch(l){var t,s;let e="Failed to send bulk invitations";null!=l&&null!==(t=l.response)&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.detail?"string"==typeof l.response.data.detail?e=l.response.data.detail:Array.isArray(l.response.data.detail)?e=l.response.data.detail.map(e=>e.msg||e.message||e).join(", "):"object"==typeof l.response.data.detail&&(e=l.response.data.detail.msg||l.response.data.detail.message||JSON.stringify(l.response.data.detail)):null!=l&&l.message&&(e=l.message),h(e),N(!1)}}else h("No valid invitations to send");else h("Please upload a CSV file")},T=e=>{const t={};if(e.forEach(e=>{e.seat&&"none"!==e.seat&&(t[e.seat]=(t[e.seat]||0)+1)}),0===Object.keys(t).length)return;const s=[],a=[],n=[];if(Object.entries(t).forEach(e=>{let[t,i]=e;const o=r.find(e=>e.name.toLowerCase()===t.toLowerCase());if(!o)return void n.push("Invalid seat type: ".concat(t,". Available types: ").concat(r.map(e=>e.name.toLowerCase()).join(", ")));const c=l.find(e=>e.name.toLowerCase()===t.toLowerCase());c?c.available_seats<i&&s.push({seat_type:t,plan_name:c.name,requested:i,available:c.available_seats,needed:i-c.available_seats}):a.push({seat_type:t,plan_name:o.name,requested:i,available:0,needed:i})}),a.length>0||s.length>0||n.length>0){let e="\u{1f6ab} Cannot proceed with bulk invite - seat issues detected:\n\n";throw a.length>0&&(e+="\u{1f4cb} Plans Not Purchased:\n",a.forEach(t=>{e+="\u25b6 ".concat(t.plan_name," Plan: You need to purchase this plan first (").concat(t.requested," seat").concat(t.requested>1?"s":""," needed)\n")}),e+="\n"),s.length>0&&(e+="\u{1f4ca} Insufficient Seats:\n",s.forEach(t=>{e+="\u25b6 ".concat(t.plan_name," Plan: Need to purchase ").concat(t.needed," more seat").concat(t.needed>1?"s":"","\n"),e+="   (You're trying to assign ".concat(t.requested," seats, but only ").concat(t.available," are available)\n")}),e+="\n"),(a.length>0||s.length>0)&&(e+="\u{1f4a1} Next Steps:\n",e+="1. Go to Workspace Settings \u2192 Seat Management\n",e+="2. Purchase the required plans/seats\n",e+="3. Return here to complete the bulk invite\n\n",e+="\u{1f504} Alternatively, you can reduce the number of seat assignments in your CSV file."),n.length>0&&(e+="\n\n\u274c Invalid Seat Types:\n"+n.join("\n")),new Error(e)}},I=()=>{o(null),d("member"),m(null),h(""),g([]),v([]),j(!1),N(!1),_(!1),k.current&&(k.current.value=""),s()};return(0,Y.useEffect)(()=>{if(f.length>0){const e=f.map(e=>({email:e.email,role:e.role||c,seat:e.seat||u}));g(e)}},[c,u,f]),(0,se.jsx)(Og,{open:t,onOpenChange:I,children:(0,se.jsxs)(Hg,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"rounded bg-orange-100 p-2",children:(0,se.jsx)(eb.A,{className:"text-orange-600 w-5 h-5"})}),(0,se.jsx)(qg,{className:"text-2xl font-bold",children:"Bulk Invite Members"})]})}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,se.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)(aN,{className:"text-sm font-medium text-slate-700",children:"CSV File"}),(0,se.jsxs)(Bx,{type:"button",variant:"outline",size:"sm",onClick:()=>{var e,t;const s=(null===(e=r[0])||void 0===e?void 0:e.name.toLowerCase())||"starter",a=(null===(t=r[1])||void 0===t?void 0:t.name.toLowerCase())||"pro",n="email,role,seat\nexample@company.com,member,".concat(s,"\nuser2@company.com,admin,").concat(a),l=new Blob([n],{type:"text/csv"}),i=window.URL.createObjectURL(l),o=document.createElement("a");o.href=i,o.download="bulk_invite_template.csv",o.click(),window.URL.revokeObjectURL(i)},className:"text-orange-600 border-orange-200 hover:bg-orange-50",children:[(0,se.jsx)(aL.A,{className:"h-4 w-4 mr-1.5"}),"Download Template"]})]}),(0,se.jsxs)("div",{className:"border-2 border-dashed border-slate-200 rounded-lg p-6 text-center hover:border-orange-300 transition-colors ".concat(w?"border-orange-300 bg-orange-50":""),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),w||_(!0)},onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),_(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation();const t=e.currentTarget.getBoundingClientRect(),s=e.clientX,a=e.clientY;(s<t.left||s>=t.right||a<t.top||a>=t.bottom)&&_(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),_(!1);const t=e.dataTransfer.files;if(t.length>0){const e=t[0];A(e)}},children:[(0,se.jsx)(W_.A,{className:"mx-auto h-8 w-8 mb-2 transition-colors ".concat(w?"text-orange-500":"text-slate-400")}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("p",{className:"text-sm transition-colors ".concat(w?"text-orange-600 font-medium":"text-slate-600"),children:w?"Drop your CSV file here":"Drag & drop a CSV file or click to upload"}),(0,se.jsxs)("p",{className:"text-xs text-slate-500",children:["CSV should contain columns: ",(0,se.jsx)("span",{className:"font-mono text-orange-600",children:"email, role, seat"})]}),(0,se.jsx)(Df,{ref:k,type:"file",accept:".csv",onChange:e=>{const t=e.target.files[0];t&&A(t)},disabled:y,className:"max-w-xs mx-auto"})]}),i&&(0,se.jsxs)("div",{className:"mt-3 flex items-center justify-center gap-2 text-sm text-green-600",children:[(0,se.jsx)(xb.A,{className:"h-4 w-4"}),i.name]})]}),(0,se.jsxs)(DR,{children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),(0,se.jsx)(OR,{className:"text-sm",children:"CSV format: email (required), role (optional), seat (optional). If role or seat are empty, default values below will be used."})]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"defaultRole",className:"text-sm font-medium text-slate-700",children:"Default Role"}),(0,se.jsxs)(Wf,{value:c,onValueChange:d,children:[(0,se.jsx)(Yf,{id:"defaultRole",className:"h-11 border-slate-200 focus:ring-orange-500 focus:border-orange-500",children:(0,se.jsx)(qf,{placeholder:"Select default role"})}),(0,se.jsx)($f,{children:yK.map(e=>(0,se.jsx)(Zf,{value:e.value,className:"py-3",children:(0,se.jsx)("div",{className:"flex flex-col",children:(0,se.jsx)("span",{className:"font-medium",children:e.label})})},e.value))})]})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"defaultSeat",className:"text-sm font-medium text-slate-700",children:"Default Seat"}),(0,se.jsxs)(Wf,{value:u||"none",onValueChange:e=>m("none"===e?null:e),children:[(0,se.jsx)(Yf,{id:"defaultSeat",className:"h-11 border-slate-200 focus:ring-orange-500 focus:border-orange-500",children:(0,se.jsx)(qf,{placeholder:"Select default seat"})}),(0,se.jsx)($f,{children:C.map(e=>(0,se.jsx)(Zf,{value:e.value||"none",className:"py-3",children:(0,se.jsx)("div",{className:"flex flex-col",children:(0,se.jsx)("span",{className:"font-medium",children:e.label})})},e.value||"none"))})]})]})]}),b&&p.length>0&&(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)(aN,{className:"text-sm font-medium text-slate-700",children:["Preview (",p.length," invitation",1!==p.length?"s":"",")"]}),(0,se.jsx)("div",{className:"bg-slate-50 rounded-lg border border-slate-200 max-h-48 overflow-y-auto",children:(0,se.jsxs)("table",{className:"w-full text-sm",children:[(0,se.jsx)("thead",{className:"bg-slate-100 sticky top-0",children:(0,se.jsxs)("tr",{children:[(0,se.jsx)("th",{className:"text-left p-3 font-medium",children:"Email"}),(0,se.jsx)("th",{className:"text-left p-3 font-medium",children:"Role"}),(0,se.jsx)("th",{className:"text-left p-3 font-medium",children:"Seat"})]})}),(0,se.jsx)("tbody",{children:p.map((e,t)=>(0,se.jsxs)("tr",{className:"border-t border-slate-200",children:[(0,se.jsx)("td",{className:"p-3 font-mono text-xs",children:e.email}),(0,se.jsx)("td",{className:"p-3 capitalize",children:e.role}),(0,se.jsx)("td",{className:"p-3 capitalize",children:e.seat||"Viewer"})]},t))})]})})]})]})}),x&&(0,se.jsxs)("div",{className:"px-6 pb-4 relative",children:[(0,se.jsxs)(DR,{variant:"destructive",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),(0,se.jsx)(OR,{className:"whitespace-pre-line text-sm pr-8",children:x})]}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>h(""),className:"absolute top-5 right-9 h-5 w-5 p-0 text-red-600 hover:text-red-800 hover:bg-red-100/50 transition-colors flex items-center justify-center rounded-sm",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),(0,se.jsxs)(Wg,{className:"gap-3 pt-4 border-t",children:[(0,se.jsx)(Bx,{variant:"outline",type:"button",onClick:I,disabled:y,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:E,className:"bg-orange-600 hover:bg-orange-700 text-white",disabled:y||!i||0===p.length,children:y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Sending Invitations..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(eb.A,{className:"w-4 h-4 mr-2"}),"Send ",p.length," Invitation",1!==p.length?"s":""]})})]})]})})}function wK(e){let{isOpen:t,onClose:s,onAction:a,action:n="buy",selectedPlanName:l=null}=e;const{plans:r,availablePlans:i,currentWorkspace:o,actionLoading:c}=oK(),[d,u]=(0,Y.useState)(""),[m,x]=(0,Y.useState)(1),[h,p]=(0,Y.useState)(""),[g,f]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{if(t)if(p(""),f(!1),l)u(l);else if("buy"===n&&i.length>0){const e=i.find(e=>"pro"===e.name.toLowerCase());u(e?e.name:i[0].name)}else if("remove"===n&&r.length>0){var e;u((null===(e=r[0])||void 0===e?void 0:e.name)||"")}},[t,n,i,r,l]);const v=()=>{u(""),x(1),p(""),f(!1),s()},b="buy"===n?i:r,j=b.find(e=>e.name===d),y=c||g,N=o&&!o.is_personal,w=d&&m>=1&&("buy"===n||"remove"===n&&j&&m<=(j.available_seats||0));return(0,se.jsx)(Og,{open:t,onOpenChange:v,children:(0,se.jsxs)(Hg,{className:"max-w-md",children:[(0,se.jsx)(Vg,{children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"buy"===n?"rounded bg-teal-100 p-2":"rounded bg-red-100 p-2",children:(0,se.jsx)(eb.A,{className:"buy"===n?"text-teal-600 w-5 h-5":"text-red-600 w-5 h-5"})}),(0,se.jsx)(qg,{className:"text-2xl font-bold",children:"buy"===n?"Purchase Seats":"Remove Seats"})]})}),c&&!g?(0,se.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-teal-600"})}):(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!d||m<1)p("Please select a valid plan and enter a quantity of at least 1");else{if("remove"===n){const e=r.find(e=>e.name===d);if(e&&m>(e.available_seats||0))return void p("Cannot remove ".concat(m," seats. Only ").concat(e.available_seats," available."))}try{p(""),f(!0),await a(d,m),v()}catch(l){var t,s;const e=l;p((null==e||null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||(null==e?void 0:e.message)||"Failed to ".concat(n," seats."))}finally{f(!1)}}},className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex gap-4",children:[(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Seat Type"}),(0,se.jsx)("select",{className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-teal-500",value:d,onChange:e=>u(e.target.value),disabled:y,children:0===b.length?(0,se.jsx)("option",{children:"buy"===n?"No plans available":"No seats to remove"}):b.map(e=>(0,se.jsxs)("option",{value:e.name,children:[e.name," ","remove"===n?"(".concat(e.available_seats," available)"):""]},e.name))})]}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantity"}),(0,se.jsx)("input",{type:"number",min:1,max:"remove"===n?(null==j?void 0:j.available_seats)||0:void 0,className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-teal-500",value:m,onChange:e=>x(Math.max(1,Number(e.target.value))),disabled:y})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 border",children:[(0,se.jsxs)("div",{className:"flex justify-between text-slate-600 text-sm mb-1",children:[(0,se.jsx)("span",{children:"Seat Type"}),(0,se.jsx)("span",{className:"font-medium",children:d||"None selected"})]}),"buy"===n&&(null==j?void 0:j.price)&&(0,se.jsxs)("div",{className:"flex justify-between text-slate-600 text-sm mb-1",children:[(0,se.jsx)("span",{children:"Price per seat"}),(0,se.jsxs)("span",{className:"font-medium",children:[j.currency_symbol||"$",j.price,"/month"]})]}),(0,se.jsxs)("div",{className:"flex justify-between text-slate-600 text-sm mb-1",children:[(0,se.jsx)("span",{children:"Quantity"}),(0,se.jsxs)("span",{className:"font-medium",children:[m," seat",m>1?"s":""]})]}),(0,se.jsx)("hr",{className:"my-2"}),(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"font-bold text-lg",children:"buy"===n?"Total Cost":"Action"}),(0,se.jsx)("span",{className:"buy"===n?"font-bold text-2xl text-green-600":"font-bold text-2xl text-red-600",children:"buy"===n&&null!=j&&j.price?"".concat(j.currency_symbol||"$").concat((j.price*m).toLocaleString(),"/month"):"".concat("buy"===n?"+":"-").concat(m," seat").concat(m>1?"s":"")})]})]}),N&&(0,se.jsx)("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-3",children:(0,se.jsxs)("p",{className:"text-teal-800 text-sm",children:[(0,se.jsx)(Rj.A,{className:"inline w-4 h-4 mr-1"}),"buy"===n?"You'll be redirected to Stripe checkout to complete your payment.":"Changes will be applied to your subscription."]})}),h&&(0,se.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,se.jsx)("p",{className:"text-red-700 text-sm",children:h})}),(0,se.jsxs)(Wg,{children:[(0,se.jsx)(Bx,{type:"button",variant:"outline",onClick:v,disabled:y,children:"Cancel"}),(0,se.jsx)(Bx,{type:"submit",className:"buy"===n?"bg-teal-600 hover:bg-teal-700 text-white":"bg-red-600 hover:bg-red-700 text-white",disabled:y||!w,children:y?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"buy"===n?"Processing...":"Removing..."]}):"buy"===n?"Purchase Seats":"Remove Seats"})]})]})]})})}const _K=function(){const{showRemoveDialog:e,memberToRemove:t,hideRemoveMemberDialog:s,confirmRemoveMember:a}=oK();return(0,se.jsx)(NN,{open:e,onOpenChange:s,children:(0,se.jsxs)(kN,{children:[(0,se.jsxs)(CN,{children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(Ap.A,{className:"h-5 w-5 text-orange-500"}),(0,se.jsx)(SN,{children:"Remove Member"})]}),(0,se.jsxs)(EN,{className:"space-y-3 pt-2",children:[(0,se.jsxs)(__,{children:["Are you sure you want to remove"," ",(0,se.jsx)(__,{weight:"bold",tagName:"span",children:null==t?void 0:t.email})," from this workspace?"]}),(0,se.jsxs)(DR,{className:"border-orange-200 bg-orange-50",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-orange-600"}),(0,se.jsxs)(OR,{className:"text-orange-800",children:[(0,se.jsx)(__,{weight:"bold",tagName:"span",children:"Warning:"})," This user will no longer have access to workspace apps and will be removed from all workspace applications with restricted access."]})]})]})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{children:"Cancel"}),(0,se.jsx)(TN,{onClick:a,className:Ux({variant:"destructive"}),children:"Remove Member"})]})]})})},kK=e=>{let{children:t,content:s,side:a="left"}=e;const n="right"===a,l="top"===a,r="bottom"===a,i="left"===a;return(0,se.jsxs)("div",{className:"relative group",children:[t,(0,se.jsxs)("div",{className:de("absolute px-3 py-2 bg-gray-900 text-white text-xs rounded-md","opacity-0 group-hover:opacity-100 transition-opacity duration-200","pointer-events-none whitespace-nowrap z-50 min-w-max",r&&"top-full mt-2 left-1/2 transform -translate-x-1/2",l&&"bottom-full mb-2 left-1/2 transform -translate-x-1/2",n&&"bottom-full mb-2 right-0",i&&"right-full mr-2 top-1/2 transform -translate-y-1/2",!r&&!l&&!n&&!i&&"bottom-full mb-2 left-0"),children:[s,(0,se.jsx)("div",{className:de("absolute border-4 border-transparent",r&&"bottom-full -mb-1 left-1/2 transform -translate-x-1/2 border-b-gray-900",l&&"top-full -mt-1 left-1/2 transform -translate-x-1/2 border-t-gray-900",n&&"top-full -mt-1 right-4 border-t-gray-900",i&&"left-full -ml-1 top-1/2 transform -translate-y-1/2 border-l-gray-900",!r&&!l&&!n&&!i&&"top-full -mt-1 left-4 border-t-gray-900")})]})]})},CK={google:{name:"google",displayName:"Google Workspace",description:"Google Workspace (formerly G Suite) SSO",defaults:{discovery_url:"https://accounts.google.com/.well-known/openid-configuration",scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:2,tooltip:"OIDC discovery endpoint (pre-configured for Google)"}]},microsoft:{name:"microsoft",displayName:"Microsoft Azure AD",description:"Microsoft Azure Active Directory (requires tenant ID)",defaults:{scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"tenant_id",required:!0,row:2,tooltip:"Azure AD Directory (tenant) ID - found in Azure Portal \u2192 Azure Active Directory \u2192 Overview",placeholder:"Your Azure AD tenant ID"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:3,tooltip:"OIDC discovery endpoint automatically generated from your tenant ID"}],autoGenerate:{field:"tenant_id",template:e=>"https://login.microsoftonline.com/".concat(e,"/v2.0/.well-known/openid-configuration"),target:"discovery_url"}},github:{name:"github",displayName:"GitHub",description:"GitHub OAuth (not OIDC compatible)",defaults:{scope:"user:email",auth_endpoint:"https://github.com/login/oauth/authorize",token_endpoint:"https://github.com/login/oauth/access_token",userinfo_endpoint:"https://api.github.com/user"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (user:email for GitHub)"},{name:"auth_endpoint",required:!1,row:2,tooltip:"GitHub OAuth authorization endpoint (pre-configured)"},{name:"token_endpoint",required:!1,row:3,tooltip:"GitHub OAuth token endpoint (pre-configured)"},{name:"userinfo_endpoint",required:!1,row:3,tooltip:"GitHub API user endpoint (pre-configured)"}]},okta:{name:"okta",displayName:"Okta",description:"Okta (requires your tenant domain)",defaults:{scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"okta_domain",required:!0,row:2,tooltip:"Your Okta domain name (e.g., 'your-company' from your-company.okta.com)",placeholder:"your-company"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:3,tooltip:"OIDC discovery endpoint automatically generated from your Okta domain"}],autoGenerate:{field:"okta_domain",template:e=>"https://".concat(e,".okta.com/.well-known/openid-configuration"),target:"discovery_url"}},advanced:{name:"advanced",displayName:"Advanced / Manual Configuration",description:"Configure all fields manually for any OAuth/OIDC provider",defaults:{scope:"email profile"},fields:[{name:"name",required:!0,row:1,tooltip:"Custom name for your SSO provider"},{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:2,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"discovery_url",required:!1,row:2,tooltip:"OIDC discovery endpoint URL (if supported by your provider)"},{name:"scope",required:!1,row:3,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"auth_endpoint",required:!1,row:3,tooltip:"OAuth authorization endpoint URL"},{name:"token_endpoint",required:!1,row:4,tooltip:"OAuth token endpoint URL"},{name:"userinfo_endpoint",required:!1,row:4,tooltip:"OAuth userinfo endpoint URL"},{name:"jwks_uri",required:!1,row:5,tooltip:"JSON Web Key Set URI for token verification"}]}},AK=e=>{var t;let{ssoConfig:s,ssoInSetupMode:a,ssoSettingsExpanded:n,appsEnforceSSO:l,isUpdatingSSO:r,onToggle:i,onSetupClick:o,onExpandClick:c}=e;return(0,se.jsxs)("div",{className:"bg-white rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200",children:[(0,se.jsxs)("div",{className:"p-4 flex justify-start items-center gap-4",children:[(0,se.jsx)("div",{className:"w-10 h-10 bg-slate-900 rounded-lg border border-slate-900 flex items-center justify-center",children:(0,se.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,se.jsxs)("div",{className:"flex-1 flex flex-col justify-start items-start gap-0.5",children:[(0,se.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,se.jsx)("div",{className:"text-gray-900 text-sm font-medium leading-tight",children:"Single Sign-on Configuration"}),(0,se.jsx)(kK,{content:"Configure SSO for your workspace",side:"top",children:(0,se.jsx)("span",{})})]}),(0,se.jsx)("div",{className:"self-stretch text-gray-500 text-sm font-normal leading-tight",children:"Enable SSO to streamline authentication for your workspace members."})]}),(0,se.jsx)("div",{className:"flex items-center gap-3",children:s.sso_provider_name&&!a?(0,se.jsx)(aB,{id:"sso-toggle","data-hook":"sso-toggle",checked:!0===s.sso_enabled,onCheckedChange:i,disabled:r}):(0,se.jsx)(Bx,{onClick:o,variant:"outline",size:"sm",disabled:r,children:r?"Setting up...":"Set Up"})})]}),(s.sso_provider_name||a)&&!n&&(0,se.jsx)("div",{className:"px-4 pb-4 space-y-2",children:(0,se.jsxs)("button",{onClick:c,className:"w-full h-10 flex items-center justify-between hover:bg-gray-50 transition-colors group bg-white rounded-md border border-gray-200 px-3",children:[(0,se.jsx)("div",{className:"flex items-center gap-3",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"text-gray-900 text-sm font-medium",children:a?"Set up SSO Configuration":(null===(t=CK[s.sso_provider_name])||void 0===t?void 0:t.displayName)||"".concat(s.sso_provider_name," SSO")}),!a&&l&&(0,se.jsx)(kK,{content:"This SSO is enforced for all apps in the workspace, meaning they automatically use it for authentication. To update enforcement settings, go to Apps Configuration.",side:"top",children:(0,se.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-700 border border-slate-200",children:"Enforced for apps"})})]})}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,se.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),(0,se.jsx)("span",{className:"text-sm",children:a?"Set up":"Configure"}),(0,se.jsx)(_t.A,{className:"w-4 h-4 transition-transform ".concat(n?"rotate-180":"")})]})]})})]})},SK=e=>Boolean(e&&"string"==typeof e&&(e.match(/^X+$/)||e.match(/^\u2022+$/))),EK=e=>{var t;let{providerId:s,ssoSettings:a,onSettingChange:n,canManageSSO:l}=e;const r=CK[s];if(null==r||null===(t=r.fields)||void 0===t||!t.length)return null;const i=r.fields.reduce((e,t)=>{const s=t.row||1;return e[s]||(e[s]=[]),e[s].push(t),e},{});return(0,se.jsx)("div",{className:"space-y-4",children:Object.entries(i).sort((e,t)=>{let[s]=e,[a]=t;return parseInt(s)-parseInt(a)}).map(e=>{let[t,s]=e;return(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map((e,t)=>{var i,o;const c=s.length>1&&1===t,d=a[e.name]||"",u=e.placeholder||"Enter ".concat(e.name.replace("_"," ")),m=SK(x=d)?"\u2022".repeat(20):x||"";var x;const h="discovery_url"===e.name&&"discovery_url"===(null===(i=r.autoGenerate)||void 0===i?void 0:i.target)&&Boolean(d);return(0,se.jsxs)("div",{children:[(0,se.jsxs)(aN,{className:"text-gray-500 text-sm flex items-center gap-1",children:[e.name.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),e.required&&" *",e.name===(null===(o=r.autoGenerate)||void 0===o?void 0:o.target)&&d&&" (Auto-generated)",(0,se.jsx)(kK,{content:e.tooltip,side:c?"right":"left",children:(0,se.jsx)(Oy.A,{className:"w-3.5 h-3.5 text-gray-400 hover:text-gray-600 cursor-help"})})]}),(0,se.jsx)(Df,{className:"mt-1 w-full h-8 ".concat(h?"bg-gray-50":""),type:"text",placeholder:u,value:m,onChange:t=>{SK(t.target.value)||n(e.name,t.target.value)},onFocus:t=>{SK(m)&&(t.target.value="",n(e.name,""))},readOnly:h,disabled:!l})]},e.name)})},t)})})},TK=e=>{var t,s;let{selectedProvider:a,ssoSettings:n,ssoInSetupMode:l,isUpdatingSSO:r,canManageSSO:i,onProviderChange:o,onSettingChange:c,onSave:d,onCancel:u}=e;const m=CK[a],x=null!==(t=null==m||null===(s=m.fields)||void 0===s?void 0:s.some(e=>e.required&&!n[e.name]))&&void 0!==t&&t;return(0,se.jsx)("div",{className:"border-t border-gray-100 p-4 bg-white",children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-gray-500 text-sm font-normal leading-tight mb-2",children:"Select SSO Provider"}),(0,se.jsxs)(Wf,{value:a,onValueChange:o,children:[(0,se.jsx)(Yf,{"data-hook":"sso-provider-select",className:"w-full px-4 py-3 bg-white rounded-md shadow-sm outline outline-1 outline-offset-[-1px] outline-gray-200",children:(0,se.jsx)(qf,{placeholder:"Select SSO Provider"})}),(0,se.jsx)($f,{children:Object.entries(CK).map(e=>{let[t,s]=e;return(0,se.jsx)(Zf,{value:t,"data-hook":"sso-provider-option-".concat(t),children:s.displayName},t)})})]})]}),(0,se.jsx)(EK,{providerId:a,ssoSettings:n,onSettingChange:c,canManageSSO:i}),(0,se.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,se.jsx)(Bx,{onClick:u,variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:l?"Cancel Setup":"Dismiss"}),(0,se.jsx)(Bx,{onClick:d,disabled:r||!a||x,className:"bg-gray-900 text-white","data-hook":"sso-save-button",children:r?"Saving...":l?"Enable SSO":"Save SSO Settings"})]})]})})};function IK(e){let{text:t,label:s}=e;const[a,n]=(0,Y.useState)(!1);return(0,se.jsx)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(t),n(!0),setTimeout(()=>n(!1),2e3)}catch(e){$.default.error("Failed to copy to clipboard")}},className:"ml-2 p-1 text-slate-400 hover:text-slate-600 transition-colors",title:"Copy ".concat(s),children:a?(0,se.jsx)(Ds.A,{className:"h-4 w-4 text-green-500"}):(0,se.jsx)(ob.A,{className:"h-4 w-4"})})}function PK(e){let{workspaceId:t,domain:s,canEdit:a,domainInput:n,onVerificationChange:l,isInputFocused:r=!1}=e;const[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!0),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),f=(0,Y.useRef)(null),v=(0,Y.useRef)(5e3),b=(0,Y.useRef)(!1),j=(0,Y.useRef)(null),y=(0,Y.useCallback)(async()=>{if(t)try{const e=await Hd.getDomainVerificationStatus(t);return o(e),l&&l("verified"===e.status),e}catch(e){return null}finally{d(!1)}},[t,l]),N=(0,Y.useCallback)(()=>{b.current=!1,h(!1),j.current=null,f.current&&(clearTimeout(f.current),f.current=null)},[]),w=(0,Y.useCallback)(e=>{if(b.current&&!document.hidden)return j.current&&Date.now()-j.current>3e5?(N(),void $.default.error("DNS verification timed out. Please check your DNS settings and try again.")):void(f.current=setTimeout(async()=>{await e(),v.current=Math.min(1.5*v.current,6e4),b.current&&w(e)},v.current))},[N]),_=(0,Y.useCallback)(async()=>{if(b.current)try{const e=await Hd.verifyDomain(t);if(!b.current)return;e.verified&&(N(),$.default.success("Domain verified successfully!"),await y())}catch(e){}},[t,y,N]),k=(0,Y.useCallback)(()=>{b.current||(b.current=!0,j.current=Date.now(),v.current=5e3,h(!0),_(),w(_))},[_,w]);(0,Y.useEffect)(()=>{const e=()=>{document.hidden?f.current&&(clearTimeout(f.current),f.current=null):b.current&&w(_)};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[_,w]),(0,Y.useEffect)(()=>{y()},[y]),(0,Y.useEffect)(()=>{const e=(null==i?void 0:i.pending_domain)||s;return"pending"===(null==i?void 0:i.status)&&e&&k(),()=>{N()}},[null==i?void 0:i.status,null==i?void 0:i.pending_domain,s,k,N]),(0,Y.useEffect)(()=>()=>{b.current=!1,f.current&&clearTimeout(f.current)},[]);const C=(0,Y.useRef)(s),A=(0,Y.useRef)(!1);(0,Y.useEffect)(()=>{if(!a||!t)return;if(!A.current)return void(A.current=!0);if(s===C.current)return;N(),o(null),l&&l(!1);const e=null==s?void 0:s.trim(),n=setTimeout(async()=>{try{await Hd.updateWorkspace(t,{domain:e||""})}catch(s){}},500);return()=>clearTimeout(n)},[s,t,a,N,l]);const S=async()=>{if(s&&s.trim()){m(!0);try{await Hd.updateWorkspace(t,{domain:s.trim()});const e=await Hd.initiateDomainVerification(t);o(e),"pending"===e.status&&(k(),$.default.success("Domain saved. Add the DNS record to verify ownership."))}catch(n){var e,a;$.default.error((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to configure domain verification")}finally{m(!1)}}else $.default.error("Please enter a domain first")},E=async()=>{g(!0),N();try{await Hd.resetDomainVerification(t),await y(),$.default.success("Domain verification has been reset")}catch(a){var e,s;$.default.error((null===(e=a.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to reset domain verification")}finally{g(!1)}};return(0,se.jsxs)("div",{className:"w-full",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[n,(()=>{if(c)return(0,se.jsx)("div",{className:"flex items-center justify-center px-4 py-2 bg-slate-100 border border-gray-300 rounded-md ml-3",children:(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-slate-400"})});if("verified"===(null==i?void 0:i.status))return(0,se.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-2 bg-emerald-500 rounded-md ml-3",children:[(0,se.jsx)(Yc.A,{className:"h-4 w-4 text-white"}),(0,se.jsx)("span",{className:"text-sm font-medium text-white",children:"Verified"})]});if("pending"===(null==i?void 0:i.status))return(0,se.jsxs)("div",{className:"flex items-center gap-1.5 px-4 py-2 bg-orange-400 rounded-md ml-3",children:[x&&(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-white"}),(0,se.jsx)("span",{className:"text-sm font-medium text-white",children:"Checking"})]});const e=!s||!s.trim(),t=u||!a||e,n=t||!r;return(0,se.jsxs)("button",{onClick:S,disabled:t,onMouseDown:e=>e.preventDefault(),className:"flex items-center gap-1.5 px-4 py-2 rounded-md ml-3 transition-colors disabled:cursor-not-allowed ".concat(n?"bg-slate-400 text-white":"bg-teal-600 hover:bg-teal-700 text-white"),children:[u?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-white"}):null,(0,se.jsx)("span",{className:"text-sm font-medium",children:"Check"})]})})()]}),(()=>{if("pending"!==(null==i?void 0:i.status))return null;const e=(null==i?void 0:i.pending_domain)||(null==i?void 0:i.domain)||s;return(0,se.jsxs)("div",{className:"mt-4 border border-slate-200 rounded-lg overflow-hidden bg-white",children:[(0,se.jsxs)("div",{className:"p-5",children:[(0,se.jsxs)("h3",{className:"font-semibold text-slate-900 text-base mb-1",children:["Add DNS records for ",e]}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Log into your domain provider, go to the DNS settings, and add this TXT record."})]}),(0,se.jsxs)("div",{className:"mx-5 mb-5 border border-slate-200 rounded-lg p-4 space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-xs font-medium text-slate-500 mb-1.5",children:"Type"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900",children:"TXT"}),(0,se.jsx)(IK,{text:"TXT",label:"Type"})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-xs font-medium text-slate-500 mb-1.5",children:"Host / Name"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900",children:"@"}),(0,se.jsx)(IK,{text:"@",label:"Host"})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"text-xs font-medium text-slate-500 mb-1.5",children:"Value"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-900 break-all",children:(null==i?void 0:i.verification_token)||""}),(0,se.jsx)(IK,{text:(null==i?void 0:i.verification_token)||"",label:"Value"})]})]})]}),(0,se.jsxs)("div",{className:"mx-5 mb-5 flex items-start gap-2 text-sm text-slate-500",children:[(0,se.jsx)("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,se.jsx)("span",{children:"DNS verification can take a few minutes. Once everything is updated, we'll automatically verify your domain."})]}),(0,se.jsxs)("div",{className:"px-5 py-3 bg-slate-50 border-t border-slate-200 flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[x&&(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}),(0,se.jsx)("span",{children:"Checking your DNS records..."})]}),a&&(0,se.jsx)("button",{onClick:E,disabled:p,className:"px-4 py-1.5 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md hover:bg-slate-50 disabled:opacity-50",children:p?"Resetting...":"Reset"})]})]})})()]})}const LK=e=>{let{workspaceId:t,domainInput:s,canManageSSO:a,isDomainInputFocused:n,onDomainChange:l,onDomainFocus:r,onDomainBlur:i}=e;return(0,se.jsxs)("div",{className:"bg-white rounded-lg border border-[#E5E5E5] shadow-sm",children:[(0,se.jsx)("div",{className:"border-b px-4 py-4",children:(0,se.jsx)("h3",{className:"text-xl font-semibold leading-7 text-foreground",children:"Domain Verification"})}),(0,se.jsxs)("div",{className:"space-y-2 p-4",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Workspace domain"}),(0,se.jsx)(PK,{workspaceId:t,domain:s,canEdit:a,isInputFocused:n,domainInput:(0,se.jsx)("input",{type:"text",value:s,onChange:e=>l(e.target.value),onFocus:r,onBlur:i,disabled:!a,className:de("flex-1 px-3 py-2 rounded-md border border-gray-300 text-sm",a?"bg-white focus:outline-none":"bg-zinc-100 text-neutral-400 cursor-not-allowed"),placeholder:"Add your domain"}),onVerificationChange:void 0}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"The domain linked to your workspace"})]})]})},MK=e=>{let{workspace:t,userRole:s}=e;const{toast:a}=ao(),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(new Set),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)({sso_provider_name:"",sso_enabled:!1,is_enterprise:!1}),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)({name:"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""}),[v,b]=(0,Y.useState)(""),[j,y]=(0,Y.useState)(""),[N,w]=(0,Y.useState)(!1),_="owner"===s&&!(null!=t&&t.is_personal),k=Y.useRef(null);(0,Y.useEffect)(()=>{if(t&&t.id!==k.current){var e;k.current=t.id;const s=(null===(e=t.domain_verification)||void 0===e?void 0:e.pending_domain)||t.domain||"";y(s)}},[t]),(0,Y.useEffect)(()=>{(async()=>{if(null!=t&&t.id&&_)try{const e=await $R.getSSOSettings(t.id);x(e.config);const s=(0,ue.A)({},e.settings);Object.keys(s).forEach(e=>{s[e]&&s[e].match(/^X+$/)&&(s[e]="\u2022".repeat(20))}),f(s),e.config.sso_provider_name&&(CK[e.config.sso_provider_name]?b(e.config.sso_provider_name):b("advanced"))}catch(e){a({title:"Error",description:"Failed to load SSO settings",variant:"destructive"})}})(),(async()=>{if(null!=t&&t.id)try{var e;const s=await jR.getAppSettings(t.id);null!=s&&null!==(e=s.settings)&&void 0!==e&&e.apps_must_use_workspace_sso&&p(s.settings.apps_must_use_workspace_sso)}catch(s){a({title:"Error",description:"Failed to load app settings",variant:"destructive"})}})()},[null==t?void 0:t.id,_,a]);return null!=t&&t.is_personal?(0,se.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,se.jsx)(Vc.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,se.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Not Available"}),(0,se.jsx)("p",{className:"text-gray-600",children:"Single Sign-On (SSO) is not available for personal workspaces."})]}):_?(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(AK,{ssoConfig:m,ssoInSetupMode:d,ssoSettingsExpanded:r,appsEnforceSSO:h,isUpdatingSSO:n,onToggle:async e=>{if(!n){l(!0);try{e?(await $R.enableSSO(t.id),x(e=>(0,ue.A)((0,ue.A)({},e),{},{sso_enabled:!0})),i(!0),!v&&m.sso_provider_name&&(CK[m.sso_provider_name]?b(m.sso_provider_name):b("advanced")),a({title:"SSO Enabled",description:"Single Sign-On has been enabled for your workspace"})):(await $R.disableSSO(t.id),x(e=>(0,ue.A)((0,ue.A)({},e),{},{sso_enabled:!1})),a({title:"SSO Disabled",description:"Single Sign-On has been disabled"}))}catch(s){a({title:"Error",description:s.message||"Failed to update SSO status",variant:"destructive"})}finally{l(!1)}}},onSetupClick:()=>{u(!0),i(!0),b("google")},onExpandClick:()=>{i(!r),r||v||!m.sso_provider_name||(CK[m.sso_provider_name]?b(m.sso_provider_name):b("advanced"))}}),r&&(m.sso_provider_name||d)&&(0,se.jsx)(TK,{selectedProvider:v,ssoSettings:g,ssoInSetupMode:d,isUpdatingSSO:n,canManageSSO:_,onProviderChange:e=>{if(b(e),"advanced"===e)f({name:"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""});else if(e&&CK[e]){const t=CK[e];f((0,ue.A)((0,ue.A)({},{name:"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""}),{},{name:t.name},t.defaults))}},onSettingChange:(e,t)=>{f(s=>{const a=(0,ue.A)((0,ue.A)({},s),{},{[e]:t}),n=CK[v];if(null!=n&&n.autoGenerate&&e===n.autoGenerate.field&&t){const e=n.autoGenerate.template(t);a[n.autoGenerate.target]=e,c(e=>new Set(e).add(n.autoGenerate.target))}return a}),c(t=>new Set(t).add(e))},onSave:async()=>{l(!0);try{const e={};o.forEach(t=>{const s=g[t];!s||s.match(/^\u2022+$/)||s.match(/^X+$/)||(e[t]=s)});let s=v;"advanced"===v&&(s=g.name||"advanced"),await $R.updateSSOSettings(t.id,e,s),x(e=>(0,ue.A)((0,ue.A)({},e),{},{sso_provider_name:s,sso_enabled:!0})),c(new Set),u(!1),i(!1),a({title:"Success",description:"SSO settings updated successfully"})}catch(e){a({title:"Error",description:e.message||"Failed to update SSO settings",variant:"destructive"})}finally{l(!1)}},onCancel:()=>{i(!1),d&&u(!1),b(""),c(new Set)}})]}),(0,se.jsx)(LK,{workspaceId:t.id,domainInput:j,canManageSSO:_,isDomainInputFocused:N,onDomainChange:y,onDomainFocus:()=>w(!0),onDomainBlur:()=>w(!1)})]}):(0,se.jsx)("div",{className:"bg-yellow-50 rounded-lg p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(Ap.A,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-yellow-900",children:"Limited Access"}),(0,se.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"Only workspace owners can configure SSO settings."})]})]})})},RK=ei,DK=On,FK=br,OK=Nr,UK=yr,BK=kr,zK=Ar,HK=Yi,VK=Gi,WK=Ki,qK=qi,YK=[{value:"private_with_login",label:"Private",description:"Only specific users can access the app - login required",icon:Vc.A,isPublic:!1},{value:"workspace_with_login",label:"Workspace",description:"All workspace members can access the app - login required",icon:eb.A,isPublic:!1},{value:"public_with_login",label:"Public (Login Required)",description:"Anyone on the internet can access the app - login required",icon:KP.A,isPublic:!0},{value:"public_without_login",label:"Public (No Login)",description:"Anyone on the internet can access the app - no login required",icon:KP.A,isPublic:!0}];const GK=e=>{let{workspace:t,userRole:s}=e;const{toast:a}=ao(),[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)({default_app_visibility:"private_with_login",members_can_create_public_apps:!1,apps_must_use_workspace_sso:!1}),d=NR(s),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!0),p=(0,Y.useCallback)(async()=>{try{l(!0);const e=await jR.getAppSettings(t.id);null!=e&&e.settings&&c(e.settings)}catch(n){var e,s;a({title:"Error loading settings",description:(null===(e=n.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to load workspace app settings",variant:"destructive"})}finally{l(!1)}},[null==t?void 0:t.id,a]),g=(0,Y.useCallback)(async()=>{if(null!=t&&t.is_personal)h(!1);else try{h(!0);const e=await $R.getSSOSettings(t.id);null!=e&&e.config&&m(e.config)}catch(e){}finally{h(!1)}},[null==t?void 0:t.id,null==t?void 0:t.is_personal]);(0,Y.useEffect)(()=>{null!=t&&t.id&&(p(),g())},[null==t?void 0:t.id,p,g]);return n?(0,se.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-teal-500"})}):(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200",children:[(0,se.jsx)("div",{className:"px-6 py-4 border-b border-slate-200",children:(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Apps Visibility"})}),(0,se.jsxs)("div",{className:"p-6 space-y-6",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between pb-6 border-b border-slate-200",children:[(0,se.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsx)(DK,{htmlFor:"public-apps-permission",className:"text-base font-medium text-slate-900 cursor-pointer",children:"Allow members to create public apps"})}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Members can create apps with public visibility, accessible to anyone on the internet. When turned off, members can only create private or workspace-visible apps"})]}),(0,se.jsx)(RK,{id:"public-apps-permission",checked:o.members_can_create_public_apps||!1,onCheckedChange:async e=>{if(d)try{var s;i(!0);let n={members_can_create_public_apps:e};if(!e){const e=YK.find(e=>e.value===o.default_app_visibility);null!=e&&e.isPublic&&(n.default_app_visibility="private_with_login")}c(e=>(0,ue.A)((0,ue.A)({},e),n));const l=await jR.updateAppSettings(t.id,n);null!=l&&null!==(s=l.data)&&void 0!==s&&s.new_settings&&c(l.data.new_settings),a({title:"Settings updated",description:e?"Members can now create public apps":"Members cannot create public apps",variant:"default"})}catch(r){var n,l;const e=r;await p(),a({title:"Error updating settings",description:(null===(n=e.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.detail)||"Failed to update workspace app settings",variant:"destructive"})}finally{i(!1)}},disabled:!d||r,className:"data-[state=checked]:bg-teal-600"})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-base font-medium text-slate-900",children:"Initial app visibility"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Choose the starting visibility for new apps created in this workspace."})]}),(0,se.jsxs)(FK,{value:o.default_app_visibility,onValueChange:async e=>{if(!d)return;if(!["private_with_login","workspace_with_login","public_with_login","public_without_login"].includes(e))return;const s=YK.find(t=>t.value===e);if(null==s||!s.isPublic||o.members_can_create_public_apps)try{var n;i(!0);const s={default_app_visibility:e};c(e=>(0,ue.A)((0,ue.A)({},e),s));const l=await jR.updateAppSettings(t.id,s);null!=l&&null!==(n=l.data)&&void 0!==n&&n.new_settings&&c(l.data.new_settings),a({title:"Settings updated",description:"Default app visibility updated successfully",variant:"default"})}catch(u){var l,r;const e=u;await p(),a({title:"Error updating settings",description:(null===(l=e.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail)||"Failed to update workspace app settings",variant:"destructive"})}finally{i(!1)}},disabled:!d||r,children:[(0,se.jsx)(OK,{className:"w-full h-auto min-h-[56px] px-4 py-3",children:(0,se.jsx)(UK,{children:(()=>{const e=YK.find(e=>e.value===o.default_app_visibility);if(e){const t=e.icon;return(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(t,{className:"h-5 w-5 text-slate-600 flex-shrink-0"}),(0,se.jsxs)("div",{className:"text-left",children:[(0,se.jsx)("div",{className:"font-medium text-slate-900",children:e.label}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:e.description})]})]})}return null})()})}),(0,se.jsx)(BK,{className:"w-[var(--radix-select-trigger-width)]",children:YK.map(e=>{const t=e.icon,s=e.isPublic&&!o.members_can_create_public_apps;return(0,se.jsx)(zK,{value:e.value,disabled:s,className:"cursor-pointer py-3 px-3 focus:bg-slate-50 ".concat(s?"opacity-50 cursor-not-allowed":""),children:(0,se.jsxs)("div",{className:"flex items-center gap-3 w-full",children:[(0,se.jsx)(t,{className:"h-5 w-5 ".concat(s?"text-slate-400":"text-slate-600"," flex-shrink-0")}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsx)("div",{className:"font-medium ".concat(s?"text-slate-400":"text-slate-900"),children:e.label}),(0,se.jsx)("div",{className:"text-xs mt-0.5 whitespace-normal ".concat(s?"text-slate-400":"text-slate-500"),children:e.description})]})]})},e.value)})})]})]}),!d&&(0,se.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4 mt-6",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(Yc.A,{className:"h-5 w-5 text-slate-500 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"View Only"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Only workspace administrators and owners can modify workspace app settings."})]})]})})]})]}),(null==t?void 0:t.is_enterprise)&&(null==u?void 0:u.sso_enabled)&&(0,se.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200",children:[(0,se.jsx)("div",{className:"px-6 py-4 border-b border-slate-200",children:(0,se.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Apps SSO"})}),(0,se.jsx)("div",{className:"p-6",children:(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(DK,{htmlFor:"sso-enforcement",className:"text-base font-medium text-slate-900 cursor-pointer",children:"Enforce workspace SSO for all apps"}),(0,se.jsx)(qK,{children:(0,se.jsxs)(HK,{children:[(0,se.jsx)(VK,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"w-4 h-4 text-slate-400 cursor-help"})}),(0,se.jsxs)(WK,{className:"max-w-xs bg-black text-white border-black",children:[(0,se.jsx)("p",{className:"text-sm text-white",children:"When enabled, all apps in this workspace will use the same SSO provider configured for the workspace."}),(0,se.jsxs)("p",{className:"text-sm text-white mt-1",children:["Workspace SSO: ",(null==u?void 0:u.sso_provider_name)||"Workspace SSO"]}),(0,se.jsx)("p",{className:"text-sm text-white mt-1",children:"To edit, go to Workspace SSO"})]})]})})]}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"All apps in this workspace will automatically use the workspace SSO settings. App-level configuration is disabled."})]}),(0,se.jsx)(RK,{id:"sso-enforcement",checked:o.apps_must_use_workspace_sso||!1,onCheckedChange:async e=>{if(!r)try{var s;i(!0),c(t=>(0,ue.A)((0,ue.A)({},t),{},{apps_must_use_workspace_sso:e}));const n=await jR.updateAppSettings(t.id,{apps_must_use_workspace_sso:e});null!=n&&null!==(s=n.data)&&void 0!==s&&s.new_settings&&c(n.data.new_settings),a({title:"Settings updated",description:e?"Apps must now use workspace SSO":"Apps can now configure their own authentication",variant:"default"})}catch(o){var n,l;const e=o;await p(),a({title:"Error updating settings",description:(null===(n=e.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.detail)||"Failed to update SSO enforcement setting",variant:"destructive"})}finally{i(!1)}},disabled:!d||r||x,className:"data-[state=checked]:bg-teal-600"})]})})]})]})};class KK extends te.H{getBaseURL(){return"/v1/monitoring"}getAnalytics(e,t){return this.axios.get("/analytics/".concat(e),{params:t})}getUsers(e,t){return this.axios.get("/".concat(e,"/users"),{params:t})}healthCheck(){return this.axios.get("/health")}}const $K=new KK;var ZK=s(64688),JK=s(42309);const QK=e=>{let{icon:t,value:s,label:a,subValue:n}=e;return(0,se.jsxs)("div",{className:"flex flex-col items-center p-4 min-w-[120px]",children:[(0,se.jsx)("div",{className:"text-slate-500 mb-2",children:t}),(0,se.jsx)("div",{className:"text-2xl font-semibold text-slate-900",children:s}),(0,se.jsx)("div",{className:"text-sm text-slate-500 text-center",children:a}),n&&(0,se.jsx)("div",{className:"text-xs text-slate-400 mt-0.5",children:n})]})},XK=e=>{let{summary:t,seats:s,credits:a}=e;const n=e=>e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"k"):e.toLocaleString();return(0,se.jsxs)("div",{className:"bg-white rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200",children:[(0,se.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-10 h-10 bg-slate-900 rounded-lg flex items-center justify-center",children:(0,se.jsx)(Cz.A,{className:"w-5 h-5 text-white"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Workspace Analytics"}),(0,se.jsx)("p",{className:"text-sm text-gray-500",children:"Real-time usage metrics for your workspace"})]})]})}),(0,se.jsxs)("div",{className:"flex flex-wrap justify-around items-center py-2 px-2 divide-x divide-gray-100",children:[(0,se.jsx)(QK,{icon:(0,se.jsx)(eb.A,{className:"w-5 h-5"}),value:t.total_registered_users,label:"Total Users",subValue:"".concat(t.active_users_last_30d," active")}),(0,se.jsx)(QK,{icon:(0,se.jsx)(yv.A,{className:"w-5 h-5"}),value:t.total_applications,label:"Total Apps",subValue:"".concat(t.published_apps," published")}),(0,se.jsx)(QK,{icon:(0,se.jsx)(ZK.A,{className:"w-5 h-5"}),value:"".concat(Math.round(s.utilization_percent),"%"),label:"Seats Utilized",subValue:"".concat(s.assigned,"/").concat(s.total)}),(0,se.jsx)(QK,{icon:(0,se.jsx)(JK.A,{className:"w-5 h-5"}),value:n(a.total_credits),label:"Credits Used",subValue:"".concat(n(a.message_credits)," msg")})]})]})},e$=e=>{let{title:t,subtitle:s,icon:a,defaultOpen:n=!1,children:l}=e;const[r,i]=(0,Y.useState)(n);return(0,se.jsxs)("div",{className:"bg-white rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200",children:[(0,se.jsxs)("button",{onClick:()=>i(!r),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[a&&(0,se.jsx)("div",{className:"text-slate-500",children:a}),(0,se.jsxs)("div",{className:"text-left",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t}),s&&(0,se.jsx)("div",{className:"text-xs text-gray-500",children:s})]})]}),(0,se.jsx)(_t.A,{className:"w-4 h-4 text-gray-500 transition-transform duration-200 ".concat(r?"rotate-180":"")})]}),r&&(0,se.jsx)("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100",children:l})]})},t$=e=>{let{data:t}=e;return(0,se.jsx)(e$,{title:"User Distribution",subtitle:"".concat(t.total_users," total users by seat type"),icon:(0,se.jsx)(eb.A,{className:"w-4 h-4"}),children:(0,se.jsxs)("div",{className:"space-y-3",children:[t.by_seat_type.map((e,t)=>{return(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-400"}),(0,se.jsx)("span",{className:"text-sm text-gray-700",children:(s=e.seat_type,s.replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim())})]}),(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.count}),(0,se.jsxs)("span",{className:"text-xs text-gray-500 w-12 text-right",children:[e.percentage.toFixed(1),"%"]})]})]},t);var s}),0===t.by_seat_type.length&&(0,se.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No user distribution data available"})]})})},s$=e=>{let{data:t}=e;return(0,se.jsx)(e$,{title:"App Distribution",subtitle:"Median ".concat(t.median_apps_per_user.toFixed(1)," apps per user"),icon:(0,se.jsx)(yv.A,{className:"w-4 h-4"}),children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Distribution of apps owned by users"}),t.apps_per_user_ranges.map((e,s)=>{const a=Math.max(...t.apps_per_user_ranges.map(e=>e.count)),n=a>0?e.count/a*100:0;return(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)("div",{className:"w-16 text-sm text-gray-600 shrink-0",children:[e.range," apps"]}),(0,se.jsx)("div",{className:"flex-1 h-5 bg-gray-100 rounded-sm overflow-hidden",children:(0,se.jsx)("div",{className:"h-full bg-slate-400 rounded-sm transition-all duration-300",style:{width:"".concat(n,"%")}})}),(0,se.jsx)("div",{className:"w-12 text-sm font-medium text-gray-900 text-right",children:e.count})]},s)}),0===t.apps_per_user_ranges.length&&(0,se.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No app distribution data available"})]})})},a$=e=>{let{data:t}=e;const s=e=>e.toLocaleString(),a=[{label:"Message Credits",value:t.message_credits,color:"bg-blue-400"},{label:"Integration Credits",value:t.integration_credits,color:"bg-teal-400"}],n=t.total_credits;return(0,se.jsx)(e$,{title:"Credits Breakdown",subtitle:"".concat(s(n)," total credits consumed"),icon:(0,se.jsx)(JK.A,{className:"w-4 h-4"}),children:(0,se.jsxs)("div",{className:"space-y-4",children:[a.map((e,t)=>{const a=n>0?e.value/n*100:0;return(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.color)}),(0,se.jsx)("span",{className:"text-sm text-gray-700",children:e.label})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:s(e.value)}),(0,se.jsxs)("span",{className:"text-xs text-gray-500 w-12 text-right",children:[a.toFixed(1),"%"]})]})]}),(0,se.jsx)("div",{className:"h-1.5 bg-gray-100 rounded-full overflow-hidden",children:(0,se.jsx)("div",{className:"h-full ".concat(e.color," rounded-full transition-all duration-300"),style:{width:"".concat(a,"%")}})})]},t)}),(0,se.jsx)("div",{className:"pt-3 border-t border-gray-100",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Total Credits"}),(0,se.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:s(n)})]})})]})})},n$=e=>{let{data:t}=e;const s=[{label:"Total Seats",value:t.total},{label:"Assigned Seats",value:t.assigned},{label:"Available Seats",value:t.available}];return(0,se.jsx)(e$,{title:"Seats Details",subtitle:"".concat(Math.round(t.utilization_percent),"% utilization"),icon:(0,se.jsx)(ZK.A,{className:"w-4 h-4"}),children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,se.jsx)("span",{children:"Utilization"}),(0,se.jsxs)("span",{children:[t.utilization_percent.toFixed(1),"%"]})]}),(0,se.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,se.jsx)("div",{className:"h-full bg-slate-500 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(t.utilization_percent,100),"%")}})})]}),(0,se.jsx)("div",{className:"grid grid-cols-3 gap-4 pt-2",children:s.map((e,t)=>(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"text-xl font-semibold text-gray-900",children:e.value}),(0,se.jsx)("div",{className:"text-xs text-gray-500",children:e.label})]},t))})]})})},l$=e=>{let{workspace:t,userRole:s}=e;const[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null),c="owner"===s||"admin"===s,d=async()=>{if(null!=t&&t.id&&c){r(!0),o(null);try{const e=await $K.getAnalytics(t.id);n(e)}catch(e){o(e.message||"Failed to load analytics data")}finally{r(!1)}}};return(0,Y.useEffect)(()=>{d()},[null==t?void 0:t.id,c]),null!=t&&t.is_personal?(0,se.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,se.jsx)(Vc.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,se.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Not Available"}),(0,se.jsx)("p",{className:"text-gray-600",children:"Analytics are not available for personal workspaces."})]}):c?l?(0,se.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,se.jsx)(Ac.A,{className:"w-8 h-8 text-gray-400 animate-spin"})}):i?(0,se.jsx)("div",{className:"bg-red-50 rounded-lg p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(Ap.A,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-red-900",children:"Error Loading Analytics"}),(0,se.jsx)("p",{className:"text-sm text-red-700 mt-1",children:i}),(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:d,className:"mt-3",children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2"}),"Retry"]})]})]})}):a?(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)("div",{className:"flex justify-end",children:(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:d,disabled:l,children:[(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2 ".concat(l?"animate-spin":"")}),"Refresh"]})}),(0,se.jsx)(XK,{summary:a.summary,seats:a.seats,credits:a.credits}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(t$,{data:a.user_distribution}),(0,se.jsx)(s$,{data:a.app_distribution}),(0,se.jsx)(a$,{data:a.credits}),(0,se.jsx)(n$,{data:a.seats})]})]}):(0,se.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:(0,se.jsx)("p",{className:"text-gray-600",children:"No analytics data available."})}):(0,se.jsx)("div",{className:"bg-yellow-50 rounded-lg p-4",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)(Ap.A,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-yellow-900",children:"Limited Access"}),(0,se.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"Only workspace owners and admins can view analytics."})]})]})})};class r$ extends te.H{getBaseURL(){return"/workspace/ip-allowlist"}async getIpAllowlistSettings(e){return this.axios.get("/".concat(e))}async updateIpAllowlistSettings(e,t){return this.axios.put("/".concat(e),t)}}const i$=new r$,o$="Valid formats: 192.168.1.5, 192.168.1.5-192.168.1.50, or 192.168.1.0/24",c$="Invalid IP address format",d$="Invalid IP range format",u$="Invalid CIDR IP format",m$="CIDR bits must be between 0 and 32",x$="This IP address already exists in the allowlist",h$="Failed to load IP allowlist settings",p$="Failed to enable",g$="Failed to disable",f$="Failed to add IP address",v$="Failed to remove IP address",b$="Error loading settings",j$="Error enabling IP allowlist",y$="Error disabling IP allowlist",N$="Error adding IP",w$="Error removing IP",_$="IP removed",k$=e=>"".concat(e," was removed from Allowed IPs."),C$="When enabled with an empty list, all access will be blocked.",A$={ip_allowlist:{enabled:!1,entries:[]}};var S$=s(37063);const E$=/^(\d{1,3}\.){3}\d{1,3}$/,T$=/^(\d{1,3}\.){3}\d{1,3}\s*-\s*(\d{1,3}\.){3}\d{1,3}$/,I$=/^(\d{1,3}\.){3}\d{1,3}\/\d{1,2}$/;function P$(e){return e.split(".").every(e=>{const t=parseInt(e,10);return t>=0&&t<=255})}const L$=UE.Ik({ip:UE.Yj().superRefine((e,t)=>{if(!e.trim())return;const s=function(e){const t=e.trim();if(E$.test(t))return P$(t)?null:c$;if(T$.test(t))return t.split(/\s*-\s*/).every(P$)?null:d$;if(I$.test(t)){const[e,s]=t.split("/");if(!P$(e))return u$;const a=parseInt(s,10);return a<0||a>32?m$:null}return"Invalid IP format. ".concat(o$)}(e);s&&t.addIssue({code:BE.eq.custom,message:s})}),note:UE.Yj().optional().default("")});const M$=e=>{let{isActive:t,isLoading:s=!1,isEditing:a=!1}=e;if(void 0===t)return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin text-orange-500"}),(0,se.jsx)(__,{size:"tiny",secondary:!0,children:"Loading..."})]});return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"inline-block w-1.5 h-1.5 rounded-full ".concat(t?"bg-green-500":"bg-gray-400")}),(0,se.jsx)(__,{size:"tiny",secondary:!0,children:t?"Active":a?"Editing":"Disabled"}),s&&(0,se.jsx)(Ac.A,{className:"h-3 w-3 animate-spin text-orange-500"})]})};s(70703);const R$=function(e){const t={component:e};for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];for(const l of a)t[l]="".concat(e,"-").concat(l);return t}("ip-allowlist","title","description","toggle","statusIndicator","ipInput","noteInput","addButton","content","warning","table","tableRow","deleteButton","removeDialog"),D$=e=>{let{enabled:t,isActive:s,onEnabledChange:a,disabled:n=!1,isLoading:l=!1,isEditing:r=!1}=e;return(0,se.jsx)(zv,{className:"border-b px-4",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Hv,{className:"text-xl font-semibold leading-7 text-foreground","data-hook":R$.title,children:"IP Allowlist"}),(0,se.jsx)("div",{className:"flex items-center gap-1.5 text-xs font-medium px-2 py-0.5 rounded-full bg-slate-100","data-hook":R$.statusIndicator,children:(0,se.jsx)(M$,{isActive:s,isLoading:l,isEditing:r})})]}),(0,se.jsx)(Vv,{className:"text-sm text-muted-foreground","data-hook":R$.description,children:"Restrict app access to approved IP addresses only. Anything not included in the list will be blocked automatically."})]}),(0,se.jsx)(aB,{"data-hook":R$.toggle,checked:t,onCheckedChange:a,disabled:n,"aria-label":"Toggle IP allowlist"})]})})},F$=["className"],O$=["className"],U$=["className"],B$=["className","children"],z$=yt.FormProvider,H$=Y.createContext({}),V$=e=>{let t=Object.assign({},((0,fs.A)(e),e));return(0,se.jsx)(H$.Provider,{value:{name:t.name},children:(0,se.jsx)(yt.Controller,(0,ue.A)({},t))})},W$=()=>{const e=Y.useContext(H$),t=Y.useContext(q$),{getFieldState:s,formState:a}=(0,yt.useFormContext)();if(!e.name)throw new Error("useFormField should be used within <FormField>");const n=s(e.name,a),{id:l}=t;return(0,ue.A)({id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message")},n)},q$=Y.createContext({}),Y$=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,F$);const n=Y.useId();return(0,se.jsx)(q$.Provider,{value:{id:n},children:(0,se.jsx)("div",(0,ue.A)({ref:t,className:de("space-y-2",s)},a))})});Y$.displayName="FormItem";const G$=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,O$);const{formItemId:n}=W$();return(0,se.jsx)(aN,(0,ue.A)({ref:t,className:s,htmlFor:n},a))});G$.displayName="FormLabel";const K$=Y.forwardRef((e,t)=>{let s=Object.assign({},((0,fs.A)(e),e));const{error:a,formItemId:n,formDescriptionId:l,formMessageId:r}=W$();return(0,se.jsx)(nt.Slot,(0,ue.A)({ref:t,id:n,"aria-describedby":a?"".concat(l," ").concat(r):"".concat(l),"aria-invalid":!!a},s))});K$.displayName="FormControl";const $$=Y.forwardRef((e,t)=>{let{className:s}=e,a=(0,Nt.A)(e,U$);const{formDescriptionId:n}=W$();return(0,se.jsx)("p",(0,ue.A)({ref:t,id:n,className:de("text-sm text-muted-foreground",s)},a))});$$.displayName="FormDescription";const Z$=Y.forwardRef((e,t)=>{let{className:s,children:a}=e,n=(0,Nt.A)(e,B$);const{error:l,formMessageId:r}=W$(),i=l?String(null==l?void 0:l.message):a;return i?(0,se.jsx)("p",(0,ue.A)((0,ue.A)({ref:t,id:r,className:de("text-sm font-medium text-destructive",s)},n),{},{children:i})):null});Z$.displayName="FormMessage";const J$=e=>{let{form:t,onSubmit:s,disabled:a=!1,isLoading:n=!1}=e;const l=t.watch("ip"),r=!!t.formState.errors.ip,i=a||n||!(null!=l&&l.trim())||r;return(0,se.jsx)(z$,(0,ue.A)((0,ue.A)({},t),{},{children:(0,se.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s()},className:"flex gap-6 items-start",children:[(0,se.jsx)(V$,{control:t.control,name:"ip",render:e=>{let{field:t,fieldState:s}=e;return(0,se.jsxs)(Y$,{className:"flex-1",children:[(0,se.jsx)(G$,{children:"IP address"}),(0,se.jsx)(K$,{children:(0,se.jsx)(Df,(0,ue.A)({"data-hook":R$.ipInput,placeholder:"Add IP, range, or subnet (CIDR)",disabled:a||n},t))}),s.error?(0,se.jsx)(Z$,{}):(0,se.jsx)($$,{children:o$})]})}}),(0,se.jsx)(V$,{control:t.control,name:"note",render:e=>{let{field:t}=e;return(0,se.jsxs)(Y$,{className:"flex-1",children:[(0,se.jsx)(G$,{children:"Add note (optional)"}),(0,se.jsx)(K$,{children:(0,se.jsx)(Df,(0,ue.A)({"data-hook":R$.noteInput,placeholder:"e.g., Office network, VPN endpoint",disabled:a||n},t))})]})}}),(0,se.jsx)("div",{className:"pt-8",children:(0,se.jsx)(Bx,{type:"submit","data-hook":R$.addButton,disabled:i,size:"sm",className:"h-9",children:n?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-1"}),"Adding..."]}):"Add"})})]})}))},Q$=e=>{let{entries:t,onRemoveEntry:s,disabled:a=!1,removingIP:n=null}=e;const[l,r]=(0,Y.useState)(null),i=(0,Y.useMemo)(()=>t.map(e=>(0,ue.A)((0,ue.A)({},e),{},{id:e.ip_address})),[t]),o=(0,Y.useCallback)(e=>{r(e)},[]),c=(0,Y.useCallback)(()=>{l&&(s(l),r(null))},[l,s]),d=(e=>{let{onRemoveEntry:t,disabled:s=!1,removingIP:a=null}=e;return(0,Y.useMemo)(()=>[{id:"ip_address",title:"IP Address",render:e=>(0,se.jsx)(__,{size:"small",children:e.ip_address}),width:"40%"},{id:"note",title:"Note",render:e=>(0,se.jsx)(__,{size:"small",secondary:!0,children:e.note})},{id:"actions",title:"",align:"end",width:"60px",render:e=>{const n=a===e.ip_address;return(0,se.jsx)(kC,{alwaysVisible:!0,primaryAction:(0,se.jsx)(Bx,{variant:"ghost",size:"icon",className:"h-6 w-6","data-hook":R$.deleteButton,onClick:s=>{s.stopPropagation(),t(e.ip_address)},disabled:s||n,children:n?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-muted-foreground"}):(0,se.jsx)(zy.A,{className:"h-4 w-4 text-destructive"})})})}}],[t,s,a])})({onRemoveEntry:o,disabled:a,removingIP:n});return i.length?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(wC,{data:i,columns:d,rowVerticalPadding:"small",showLastRowDivider:!1,"data-hook":R$.table,children:[(0,se.jsx)(wC.Toolbar,{children:(0,se.jsx)(wC.Toolbar.Title,{children:"Allowed IPs"})}),(0,se.jsx)(wC.Content,{titleBarDisplay:!1})]}),(0,se.jsx)(fk,{open:!!l,onOpenChange:e=>!e&&r(null),title:"Remove IP",description:"This IP will no longer have access to the application. Are you sure you want to remove it?\n\nIP: ".concat(l),confirmText:"Remove IP",cancelText:"Cancel",variant:"destructive",onConfirm:c,dataHook:R$.removeDialog})]}):null},X$=()=>(0,se.jsxs)(DR,{className:"border-orange-200 bg-orange-50","data-hook":R$.warning,children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-orange-600"}),(0,se.jsx)(OR,{className:"text-orange-800",children:C$})]}),eZ=e=>{let{workspace:t,userRole:s}=e;const a=NR(s),{loading:n,enabled:l,entries:r,isExpanded:i,saving:o,showContent:c,handleToggleChange:d,handleAddEntry:u,handleRemoveEntry:m}=function(e){var t;let{workspaceId:s,canManage:a}=e;const{toast:n}=ao(),[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(null),{data:p,isLoading:g,refetch:f}=Xd({query:async()=>{try{return await i$.getIpAllowlistSettings(s)}catch(e){if(function(e){var t;return 404===(null===(t=e.response)||void 0===t?void 0:t.status)}(e))return A$;throw e}},toastError:{title:b$,description:h$}},[s]),v=null!==(t=null==p?void 0:p.ip_allowlist.enabled)&&void 0!==t&&t,b=(0,Y.useMemo)(()=>{var e;return null!==(e=null==p?void 0:p.ip_allowlist.entries)&&void 0!==e?e:[]},[null==p?void 0:p.ip_allowlist.entries]),j=(0,Y.useCallback)((e,t)=>i$.updateIpAllowlistSettings(s,function(e,t){return{ip_allowlist:{enabled:e,entries:t}}}(e,t)),[s]),y=(0,Y.useCallback)(async e=>{if(a)if(e){if(0===b.length)return void r(!0);d(!0);try{await j(!0,b),await f(),r(!0),o(!1)}catch(t){n({title:j$,description:p$,variant:"destructive"})}finally{d(!1)}}else{if(!v)return r(!1),void o(!1);d(!0);try{await j(!1,b),await f(),r(!1),o(!1)}catch(s){n({title:y$,description:g$,variant:"destructive"})}finally{d(!1)}}},[a,b,v,j,f,n]),N=(0,Y.useCallback)(async e=>{if(!a)return!1;const t={ip_address:e.ip.trim(),note:e.note.trim()||null},s=0===b.length||v;m(!0);try{return await j(s,[...b,t]),await f(),o(!1),!0}catch(l){return n({title:N$,description:f$,variant:"destructive"}),!1}finally{m(!1)}},[a,b,v,j,f,n]),w=(0,Y.useCallback)(async e=>{if(!a)return;const t=b.filter(t=>t.ip_address!==e),s=0===t.length;h(e);try{await j(!s&&v,t),await f(),s&&(r(!1),o(!0)),n({title:_$,description:k$(e),variant:"success"})}catch(l){n({title:w$,description:v$,variant:"destructive"})}finally{h(null)}},[a,b,v,j,f,n]);return(0,Y.useEffect)(()=>{const e=setInterval(()=>f(),3e4);return()=>clearInterval(e)},[f]),{loading:g,enabled:v,entries:b,isExpanded:!g&&(v||l),saving:{toggle:c,add:u,removingIP:x},showContent:v||l||i,handleToggleChange:y,handleAddEntry:N,handleRemoveEntry:w}}({workspaceId:t.id,canManage:a}),{form:x,handleSubmit:h}=function(e){let{entries:t,handleAddEntry:s}=e;const a=(0,yt.useForm)({resolver:(0,S$.u)(L$),defaultValues:{ip:"",note:""},mode:"onChange"}),n=(0,Y.useCallback)(async()=>{if(!await a.trigger())return;const e=a.getValues(),n=e.ip.trim();t.some(e=>e.ip_address===n)?a.setError("ip",{message:x$}):await s({ip:n,note:e.note||""})&&a.reset()},[a,t,s]);return{form:a,handleSubmit:n}}({entries:r,handleAddEntry:u}),p=0===r.length,g=!n&&(l||i),f=n?void 0:l,v=n||!a,b=n||o.add,j=v||o.toggle,y=n||o.toggle,N=l&&p,w=!n&&!l&&c&&p;return(0,se.jsxs)(Bv,{className:"rounded-xl","data-hook":R$.component,children:[(0,se.jsx)(D$,{enabled:g,isActive:f,onEnabledChange:d,disabled:j,isLoading:y,isEditing:w}),c&&(0,se.jsxs)(Wv,{className:"px-4 py-6 space-y-6","data-hook":R$.content,children:[N&&(0,se.jsx)(X$,{}),(0,se.jsx)(J$,{form:x,onSubmit:h,disabled:v,isLoading:b}),(0,se.jsx)(Q$,{entries:r,onRemoveEntry:m,disabled:v,removingIP:o.removingIP})]})]})},tZ=e=>{const[t]=Y.useState(()=>new Q.E);return(0,se.jsx)(X.Ht,{client:t,children:(0,se.jsx)(eZ,(0,ue.A)({},e))})},sZ={get:"bg-emerald-100 text-emerald-700",post:"bg-blue-100 text-blue-700",put:"bg-amber-100 text-amber-700",patch:"bg-orange-100 text-orange-700",delete:"bg-red-100 text-red-700"},aZ=e=>sZ[e.toLowerCase()]||"bg-slate-100 text-slate-700",nZ=e=>{let{method:t,className:s=""}=e;return(0,se.jsx)(gk,{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold uppercase ".concat(aZ(t)," ").concat(s),children:t})},lZ=e=>{let{integration:t,onEdit:s,onDelete:a,canManage:n}=e;const[l,r]=Y.useState(!1);return(0,se.jsx)(Bv,{className:"overflow-hidden",children:(0,se.jsxs)("div",{className:"p-5",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0 space-y-1",children:[(0,se.jsx)(R_,{size:"small",children:t.name}),t.description&&(0,se.jsx)(__,{size:"small",secondary:!0,className:"line-clamp-2",children:t.description}),(0,se.jsx)("a",{href:t.base_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 hover:underline inline-block",children:t.base_url})]}),n&&(0,se.jsxs)(Nj,{children:[(0,se.jsx)(wj,{asChild:!0,children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-slate-400 hover:text-slate-600",children:(0,se.jsx)(mb.A,{className:"h-4 w-4"})})}),(0,se.jsxs)(Aj,{align:"end",children:[(0,se.jsxs)(Sj,{onClick:()=>s(t),children:[(0,se.jsx)(Zw.A,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,se.jsxs)(Sj,{onClick:()=>a(t),className:"text-red-600 focus:text-red-600",children:[(0,se.jsx)(zy.A,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),(0,se.jsxs)(Bx,{variant:"ghost",size:"sm",onClick:()=>r(!l),className:"mt-4 gap-1.5 px-0 hover:bg-transparent text-slate-700 hover:text-slate-900",children:[(0,se.jsxs)("span",{children:[t.selected_endpoints.length," Endpoints"]}),l?(0,se.jsx)(ur.A,{className:"w-4 h-4"}):(0,se.jsx)(_t.A,{className:"w-4 h-4"})]}),l&&(0,se.jsx)("div",{className:"flex flex-wrap gap-2 mt-3",children:t.selected_endpoints.map(e=>(0,se.jsxs)(gk,{variant:"outline",className:"inline-flex items-center gap-1.5 bg-white rounded-md border-slate-200 px-2 py-1",children:[(0,se.jsx)(nZ,{method:e.method}),(0,se.jsx)("span",{className:"text-xs text-slate-600 font-mono",children:e.path})]},e.operation_id))})]})})},rZ=e=>{let{integrations:t,onEdit:s,onDelete:a,canManage:n,loading:l}=e;return l?(0,se.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,se.jsx)(Ac.A,{className:"w-8 h-8 text-slate-400 animate-spin"})}):0===t.length?(0,se.jsx)("div",{className:"border border-dashed border-slate-300 rounded-lg px-12 py-6 flex flex-col items-center justify-center gap-4",children:(0,se.jsxs)("div",{className:"text-center space-y-2",children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-slate-900",children:"No Integrations"}),(0,se.jsx)(__,{size:"medium",secondary:!0,tagName:"p",children:"No integrations have been created for this workspace"})]})}):(0,se.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,se.jsx)(lZ,{integration:e,onEdit:s,onDelete:a,canManage:n},e.id))})};class iZ extends te.H{getBaseURL(){return"/custom-integrations"}parseOpenAPI(e){return this.axios.post("/parse",e)}validateSlug(e,t){return this.axios.post("/validate-slug",{slug:e,exclude_id:t})}listIntegrations(){return this.axios.get("")}getIntegration(e){return this.axios.get("/".concat(e))}createIntegration(e){return this.axios.post("",e)}updateIntegration(e,t){return this.axios.put("/".concat(e),t)}deleteIntegration(e){return this.axios.delete("/".concat(e))}getAvailableEndpoints(e){return this.axios.get("/".concat(e,"/endpoints"))}getIntegrationHeaders(e){return this.axios.get("/".concat(e,"/headers"))}}const oZ=new iZ,cZ=(e,t)=>{var s,a;if(e instanceof Error){var n,l;const s=e;return(null==s||null===(n=s.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.detail)||s.message||t}const r=e;return(null==r||null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail)||(null==r?void 0:r.message)||t},dZ=30,uZ="******",mZ={slug:"",name:"",description:"",openapiUrl:"",openapiJson:"",sourceType:"url",baseUrl:"",selectedEndpoints:[],customHeaders:[{key:"",value:""}]};var xZ=s(53060);const hZ=e=>{let{sourceType:t,openapiUrl:s,openapiJson:a,onSourceTypeChange:n,onUrlChange:l,onJsonChange:r}=e;return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(Kj,{value:t,onValueChange:e=>n(e),className:"w-full",children:(0,se.jsxs)($j,{className:"grid w-full grid-cols-2 bg-slate-100",children:[(0,se.jsxs)(Zj,{value:"url",className:"gap-2 data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[(0,se.jsx)(rk.A,{className:"w-4 h-4"}),"From URL"]}),(0,se.jsxs)(Zj,{value:"json",className:"gap-2 data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[(0,se.jsx)(xZ.A,{className:"w-4 h-4"}),"Paste JSON"]})]})}),"url"===t&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"openapi-url",children:"OpenAPI Specification URL"}),(0,se.jsx)(Df,{id:"openapi-url",placeholder:"https://api.example.com/openapi.json",value:s,onChange:e=>l(e.target.value)}),(0,se.jsx)(__,{size:"tiny",secondary:!0,tagName:"p",children:"Enter the URL of your OpenAPI/Swagger specification (JSON or YAML)"})]}),"json"===t&&(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"openapi-json",children:"OpenAPI Specification JSON"}),(0,se.jsx)(tN,{id:"openapi-json",placeholder:'{"openapi": "3.0.0", ...}',value:a,onChange:e=>r(e.target.value),className:"font-mono text-sm h-64"}),(0,se.jsx)(__,{size:"tiny",secondary:!0,tagName:"p",children:"Paste your OpenAPI/Swagger specification in JSON format"})]})]})},pZ=e=>{let{endpoints:t,selectedEndpoints:s,maxEndpoints:a,searchValue:n,onSearchChange:l,onEndpointToggle:r,onClearAll:i,className:o=""}=e;const c=(0,Y.useMemo)(()=>{if(!t.length)return[];if(!n.trim())return t;const e=n.toLowerCase();return t.filter(t=>{var s,a;return t.path.toLowerCase().includes(e)||t.method.toLowerCase().includes(e)||t.operation_id.toLowerCase().includes(e)||(null===(s=t.summary)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(a=t.description)||void 0===a?void 0:a.toLowerCase().includes(e))})},[t,n]);return(0,se.jsxs)("div",{className:"space-y-4 ".concat(o),children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)(__,{size:"small",secondary:!0,children:["Select endpoints to expose (max ",a,")"]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[s.length>0&&i&&(0,se.jsx)(Bx,{type:"button",variant:"link",size:"sm",onClick:i,className:"text-slate-500 hover:text-slate-700 px-0",children:"Clear all"}),(0,se.jsxs)(__,{size:"small",weight:"bold",skin:s.length>=a?"error":"standard",children:[s.length," / ",a," selected"]})]})]}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,se.jsx)(Df,{placeholder:"Search endpoints...",value:n,onChange:e=>l(e.target.value),className:"pl-9"})]}),(0,se.jsxs)("div",{className:"max-h-[350px] overflow-y-auto border border-slate-200 rounded-lg divide-y divide-slate-200",children:[c.map((e,t)=>{const a=s.includes(e.operation_id);return(0,se.jsxs)("div",{className:"p-3 flex items-start gap-3 cursor-pointer hover:bg-slate-50 transition-colors ".concat(a?"bg-teal-50":""),onClick:()=>r(e.operation_id),children:[(0,se.jsx)(E_,{checked:a,onCheckedChange:()=>r(e.operation_id),onClick:e=>e.stopPropagation(),className:"mt-1 data-[state=checked]:bg-teal-600 data-[state=checked]:border-teal-600"}),(0,se.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(nZ,{method:e.method}),(0,se.jsx)("code",{className:"text-sm font-mono text-slate-700 truncate",children:e.path})]}),(e.summary||e.description)&&(0,se.jsx)(__,{size:"tiny",secondary:!0,tagName:"p",className:"mt-1 line-clamp-2",children:e.summary||e.description})]})]},"".concat(e.method,"-").concat(e.path,"-").concat(t))}),0===c.length&&(0,se.jsx)("div",{className:"p-6 text-center",children:(0,se.jsx)(__,{size:"small",secondary:!0,children:"No endpoints match your search"})})]})]})},gZ=e=>{let{slug:t,name:s,description:a,baseUrl:n,customHeaders:l,selectedEndpoints:r,parsedSpec:i,slugValid:o,slugMessage:c,headerError:d,headersLoadError:u,showHeaderValues:m,redactedHeaderKeys:x,onShowHeaderValuesChange:h,onSlugChange:p,onNameChange:g,onDescriptionChange:f,onBaseUrlChange:v,onHeaderChange:b,onAddHeader:j,onRemoveHeader:y,isEditing:N,onEditEndpoints:w}=e;return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(aN,{htmlFor:"integration-slug",children:["Slug ",(0,se.jsx)("span",{className:"text-blue-600",children:"*"})]}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(Df,{id:"integration-slug",placeholder:"my-api",value:t,onChange:e=>p(e.target.value.toLowerCase()),className:"pr-8 ".concat(!1===o?"border-red-300":!0===o?"border-green-300":"")}),null!==o&&(0,se.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:o?(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-green-500"}):(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500"})})]}),c&&(0,se.jsx)(__,{size:"tiny",skin:!1===o?"error":"standard",secondary:!0,tagName:"p",children:c})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(aN,{htmlFor:"integration-name",children:["Name ",(0,se.jsx)("span",{className:"text-blue-600",children:"*"})]}),(0,se.jsx)(Df,{id:"integration-name",placeholder:"My API Integration",value:s,onChange:e=>g(e.target.value)})]})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"integration-description",children:"Description"}),(0,se.jsx)(tN,{id:"integration-description",placeholder:"Describe what this integration does...",value:a,onChange:e=>f(e.target.value),className:"h-20"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)(aN,{htmlFor:"base-url",className:"whitespace-nowrap text-sm font-medium",children:"Base URL"}),(0,se.jsx)(Df,{id:"base-url",placeholder:"https://api.example.com",value:n,onChange:e=>v(e.target.value),className:"flex-1"})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(aN,{className:"text-sm font-medium",children:"Custom Headers"}),(0,se.jsx)(__,{size:"tiny",secondary:!0,tagName:"p",className:"mt-0.5",children:"Add headers that will be sent with every request (e.g. API keys)"})]}),u&&(0,se.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0"}),(0,se.jsxs)("div",{className:"text-sm",children:[(0,se.jsx)(__,{size:"small",weight:"bold",skin:"error",tagName:"p",children:"Failed to load authentication headers"}),(0,se.jsx)(__,{size:"small",skin:"error",tagName:"p",className:"mt-0.5",children:u}),(0,se.jsx)(__,{size:"small",skin:"error",tagName:"p",className:"mt-1",children:"Saving is disabled to prevent accidental data loss. Please try closing and reopening this dialog."})]})]}),(0,se.jsxs)(Bx,{type:"button",variant:"outline",size:"sm",onClick:j,children:[(0,se.jsx)(op.A,{className:"w-4 h-4 mr-1"}),"Add Header"]}),(0,se.jsx)("div",{className:"space-y-2",children:l.map((e,t)=>{const s=x.has(e.key);return(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Df,{placeholder:"Header name",value:e.key,onChange:e=>b(t,"key",e.target.value),disabled:s,readOnly:s,className:"flex-1 ".concat(s?"bg-slate-100 text-slate-500 cursor-not-allowed":"")}),(0,se.jsx)("div",{className:"relative flex-1",children:s?(0,se.jsx)(Df,{placeholder:"(sensitive - delete to change)",disabled:!0,readOnly:!0,className:"bg-slate-100 text-slate-400 italic cursor-not-allowed"}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Df,{placeholder:"Header value",type:m[t]?"text":"password",value:e.value,onChange:e=>b(t,"value",e.target.value),className:"pr-10"}),(0,se.jsx)(Bx,{type:"button",variant:"ghost",size:"icon",onClick:()=>h(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:!e[t]})),className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 text-slate-400 hover:text-slate-600",children:m[t]?(0,se.jsx)(FD.A,{className:"w-4 h-4"}):(0,se.jsx)(lA.A,{className:"w-4 h-4"})})]})}),l.length>1&&(0,se.jsx)(Bx,{type:"button",variant:"ghost",size:"icon",onClick:()=>y(t),className:"text-slate-400 hover:text-red-500",children:(0,se.jsx)(zy.A,{className:"w-4 h-4"})})]},t)})}),d&&(0,se.jsxs)("div",{className:"flex items-center gap-1.5 text-red-500 text-sm",children:[(0,se.jsx)(ad.A,{className:"w-4 h-4"}),(0,se.jsx)("span",{children:d})]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)(__,{size:"small",weight:"bold",children:[r.length," Endpoints"]}),N&&w&&(0,se.jsx)(Bx,{type:"button",variant:"outline",size:"sm",onClick:w,children:"Edit Endpoints"})]}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map(e=>{const t=null==i?void 0:i.endpoints.find(t=>t.operation_id===e);return t?(0,se.jsxs)(gk,{variant:"outline",className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-white border-slate-200",children:[(0,se.jsx)(nZ,{method:t.method}),(0,se.jsx)("span",{className:"font-mono",children:t.path})]},e):null})})]})]})},fZ=[{key:"source",label:"Add source"},{key:"endpoints",label:"Select endpoint"},{key:"config",label:"Configure"}],vZ=e=>{let{currentStep:t}=e;return(0,se.jsx)("div",{className:"flex items-center h-6 max-w-md",children:fZ.map((e,s)=>{const a="endpoints"===t&&0===s||"config"===t&&s<=1,n=t===e.key;return(0,se.jsxs)(Y.Fragment,{children:[(0,se.jsx)("div",{className:"flex items-center gap-1.5",children:(0,se.jsxs)(__,{size:"small",weight:n?"normal":"thin",className:n?"text-blue-600":a?"text-slate-600":"text-slate-400",children:[a?"\u2713":"".concat(s+1,".")," ",e.label]})}),s<fZ.length-1&&(0,se.jsx)("span",{className:"mx-2 text-slate-300",children:"\u203a"})]},e.key)})})},bZ=e=>{let{open:t,onClose:s,onApply:a,integrationId:n,currentSelectedEndpoints:l}=e;const{toast:r}=ao(),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)([]),[u,m]=(0,Y.useState)([]),[x,h]=(0,Y.useState)(""),p=(0,Y.useRef)(s);p.current=s;const g=(0,Y.useRef)(!1);(0,Y.useEffect)(()=>{t||(g.current=!1)},[t]),(0,Y.useEffect)(()=>{(async()=>{if(t&&n&&!g.current){g.current=!0,o(!0),m([...l]),h("");try{const e=await oZ.getAvailableEndpoints(n);d(e)}catch(e){r({title:"Error loading endpoints",description:cZ(e,"Failed to load available endpoints"),variant:"destructive"}),p.current()}finally{o(!1)}}})()},[t,n,l,r]);return(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsxs)(Hg,{className:"w-[600px] max-w-[800px] h-[550px] overflow-hidden flex flex-col p-0 gap-0 rounded-[10px]",showClose:!1,children:[(0,se.jsx)("div",{className:"px-6 pt-6 pb-4 border-b border-slate-200",children:(0,se.jsx)(Vg,{className:"p-0",children:(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)(qg,{className:"text-xl font-semibold",children:"Edit Endpoints"}),(0,se.jsx)(Bx,{variant:"ghost",size:"icon",onClick:s,className:"text-slate-400 hover:text-slate-600",children:(0,se.jsx)(la.A,{className:"w-5 h-5"})})]})})}),i?(0,se.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,se.jsx)(Ac.A,{className:"w-8 h-8 animate-spin text-slate-400"})}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"flex-1 overflow-hidden flex flex-col px-6 py-4",children:(0,se.jsx)(pZ,{endpoints:c,selectedEndpoints:u,maxEndpoints:dZ,searchValue:x,onSearchChange:h,onEndpointToggle:e=>{m(t=>t.includes(e)?t.filter(t=>t!==e):t.length<dZ?[...t,e]:(r({title:"Maximum endpoints reached",description:"You can select up to ".concat(dZ," endpoints"),variant:"destructive"}),t))},onClearAll:()=>{m([])}})}),(0,se.jsxs)(Wg,{className:"gap-2 px-6 py-4 border-t border-slate-200",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:s,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:()=>{0!==u.length?(a(u,c),s()):r({title:"No endpoints selected",description:"Please select at least one endpoint",variant:"destructive"})},disabled:0===u.length,children:"Apply Changes"})]})]})]})})},jZ=e=>{let{open:t,onClose:s,onSave:a,integration:n,workspaceId:l}=e;const[r,i]=(0,Y.useState)(!1),{formState:o,step:c,loading:d,saving:u,parsedSpec:m,slugValid:x,slugMessage:h,headerError:p,headersLoadError:g,endpointSearch:f,showHeaderValues:v,redactedHeaderKeys:b,isEditing:j,setStep:y,setEndpointSearch:N,setShowHeaderValues:w,updateFormField:_,handleEndpointToggle:k,handleClearAllEndpoints:C,handleApplyEndpointChanges:A,handleHeaderChange:S,addHeader:E,removeHeader:T,handleParseSpec:I,handleSave:P,canProceedFromSource:L,canProceedFromEndpoints:M,canSave:R}=function(e){let{open:t,integration:s,workspaceId:a,onSave:n,onClose:l}=e;const{toast:r}=ao(),{user:i}=wd(),o=!!s,[c,d]=(0,Y.useState)(mZ),[u,m]=(0,Y.useState)("source"),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(null),[b,j]=(0,Y.useState)(null),[y,N]=(0,Y.useState)(""),[w,_]=(0,Y.useState)(null),[k,C]=(0,Y.useState)(""),[A,S]=(0,Y.useState)({}),[E,T]=(0,Y.useState)(!1),[I,P]=(0,Y.useState)(null),[L,M]=(0,Y.useState)(new Set),[R,D]=(0,Y.useState)(new Set),F=(0,Y.useRef)(!1);(0,Y.useEffect)(()=>{if(t)if(t&&s){var e,a;F.current=!0,d({slug:s.slug,name:s.name,description:s.description||"",openapiUrl:null!==(e=s.openapi_source)&&void 0!==e&&e.startsWith("http")?s.openapi_source:"",openapiJson:"json"===s.openapi_source?JSON.stringify(s.openapi_spec,null,2):"",sourceType:null!==(a=s.openapi_source)&&void 0!==a&&a.startsWith("http")?"url":"json",baseUrl:s.base_url,selectedEndpoints:s.selected_endpoints.map(e=>e.operation_id),customHeaders:[{key:"",value:""}]}),v({title:s.name,description:s.description||void 0,version:"1.0.0",base_url:s.base_url,endpoints:s.selected_endpoints.map(e=>(0,ue.A)((0,ue.A)({},e),{},{tags:[]})),source:s.openapi_source||"json"}),m("config"),j(!0),_(null),T(!1),P(null),D(new Set);const t=async()=>{try{const e=await oZ.getIntegrationHeaders(s.id),t=Object.entries(e.headers),a=new Set;t.forEach(e=>{let[t,s]=e;s===uZ&&a.add(t)}),M(a),d(e=>(0,ue.A)((0,ue.A)({},e),{},{customHeaders:t.length>0?t.map(e=>{let[t,s]=e;return{key:t,value:s}}):[{key:"",value:""}]})),T(!0),P(null)}catch(e){P(cZ(e,"Failed to load authentication headers")),T(!1)}};t()}else t&&!F.current&&(F.current=!0,d(mZ),v(null),m("source"),j(null),N(""),_(null),T(!0),P(null),M(new Set),D(new Set));else F.current=!1},[t,s]);const O=(0,Y.useCallback)(async e=>{if(!e||e.length<2)return j(null),void N("");try{const t=await oZ.validateSlug(e,null==s?void 0:s.id);j(t.valid),N(t.message||""),t.valid&&t.normalized_slug!==e&&d(e=>(0,ue.A)((0,ue.A)({},e),{},{slug:t.normalized_slug}))}catch(t){j(!1),N("Error validating slug")}},[null==s?void 0:s.id]);(0,Y.useEffect)(()=>{const e=setTimeout(()=>{c.slug&&O(c.slug)},500);return()=>clearTimeout(e)},[c.slug,O]);const U=(0,Y.useCallback)((e,t)=>{d(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))},[]),B=(0,Y.useCallback)(e=>{d(t=>t.selectedEndpoints.includes(e)?(0,ue.A)((0,ue.A)({},t),{},{selectedEndpoints:t.selectedEndpoints.filter(t=>t!==e)}):t.selectedEndpoints.length<dZ?(0,ue.A)((0,ue.A)({},t),{},{selectedEndpoints:[...t.selectedEndpoints,e]}):(r({title:"Maximum endpoints reached",description:"You can select up to ".concat(dZ," endpoints"),variant:"destructive"}),t))},[r]),z=(0,Y.useCallback)(()=>{d(e=>(0,ue.A)((0,ue.A)({},e),{},{selectedEndpoints:[]}))},[]),H=(0,Y.useCallback)((e,t)=>{d(t=>(0,ue.A)((0,ue.A)({},t),{},{selectedEndpoints:e})),v(e=>e?(0,ue.A)((0,ue.A)({},e),{},{endpoints:t}):null)},[]),V=(0,Y.useCallback)((e,t,s)=>{_(null),d(a=>{const n=[...a.customHeaders];return n[e]=(0,ue.A)((0,ue.A)({},n[e]),{},{[t]:s}),(0,ue.A)((0,ue.A)({},a),{},{customHeaders:n})})},[]),W=(0,Y.useCallback)(()=>{d(e=>(0,ue.A)((0,ue.A)({},e),{},{customHeaders:[...e.customHeaders,{key:"",value:""}]}))},[]),q=(0,Y.useCallback)(e=>{var t;_(null);const s=null===(t=c.customHeaders[e])||void 0===t?void 0:t.key;d(t=>(0,ue.A)((0,ue.A)({},t),{},{customHeaders:t.customHeaders.filter((t,s)=>s!==e)})),S(t=>{const s={};return Object.entries(t).forEach(t=>{let[a,n]=t;const l=Number(a);l<e?s[l]=n:l>e&&(s[l-1]=n)}),s}),s&&D(e=>{const t=new Set(e);return t.add(s),t}),s&&M(e=>{const t=new Set(e);return t.delete(s),t})},[c.customHeaders]),G=(0,Y.useCallback)(async()=>{h(!0);try{let t={};if("url"===c.sourceType){if(!c.openapiUrl)return void r({title:"URL required",description:"Please enter an OpenAPI specification URL",variant:"destructive"});t.url=c.openapiUrl}else{if(!c.openapiJson)return void r({title:"JSON required",description:"Please enter OpenAPI specification JSON",variant:"destructive"});try{t.spec_json=JSON.parse(c.openapiJson)}catch(e){return void r({title:"Invalid JSON",description:"The provided JSON is not valid",variant:"destructive"})}}const s=await oZ.parseOpenAPI(t);v(s),d(e=>(0,ue.A)((0,ue.A)({},e),{},{name:e.name||s.title,baseUrl:s.base_url,selectedEndpoints:[]})),C(""),m("endpoints"),r({title:"Spec parsed successfully",description:"Found ".concat(s.endpoints.length," endpoints")})}catch(t){r({title:"Error parsing specification",description:cZ(t,"Failed to parse OpenAPI spec"),variant:"destructive"})}finally{h(!1)}},[c.sourceType,c.openapiUrl,c.openapiJson,r]),K=(0,Y.useCallback)(()=>{const e=c.customHeaders.filter(e=>e.key&&!e.value||!e.key&&e.value);if(e.length>0){const t=e.some(e=>e.key&&!e.value),s=e.some(e=>!e.key&&e.value);return _(t&&s?"Some headers are missing names or values":t?"Please provide a value for all headers with a name":"Please provide a name for all headers with a value"),!1}return!0},[c.customHeaders]),$=(0,Y.useCallback)(async()=>{if(c.slug&&c.name&&0!==c.selectedEndpoints.length)if(!1!==b)if(!o||E){if(K()){g(!0);try{var e;const t={};let d;if(c.customHeaders.forEach(e=>{e.key&&e.value&&e.value!==uZ&&(t[e.key]=e.value)}),o&&s){const e=R.size>0?Array.from(R):void 0;d=await oZ.updateIntegration(s.id,{slug:c.slug,name:c.name,description:c.description||void 0,base_url:c.baseUrl,selected_endpoint_ids:c.selectedEndpoints,custom_headers:t,delete_header_keys:e})}else d=await oZ.createIntegration({slug:c.slug,name:c.name,description:c.description||void 0,openapi_url:"url"===c.sourceType?c.openapiUrl:void 0,openapi_spec:"json"===c.sourceType?JSON.parse(c.openapiJson):void 0,base_url:c.baseUrl,selected_endpoint_ids:c.selectedEndpoints,custom_headers:t});Tu(o?"Custom Integration - Updated":"Custom Integration - Created",{user_id:null!==(e=null==i?void 0:i.id)&&void 0!==e?e:null,workspace_id:a,integration_id:d.id,integration_slug:d.slug,integration_name:d.name,openapi_source_type:c.sourceType,endpoints_selected_count:c.selectedEndpoints.length,headers_count:c.customHeaders.filter(e=>e.key&&e.value).length,redacted_headers_count:L.size,deleted_headers_count:o?R.size:0}),r({title:o?"Integration updated":"Integration created",description:"".concat(d.name," has been saved successfully")}),n(d),l()}catch(t){r({title:"Error saving integration",description:cZ(t,"Failed to save integration"),variant:"destructive"})}finally{g(!1)}}}else r({title:"Cannot save",description:I||"Authentication headers failed to load. Please try closing and reopening the dialog.",variant:"destructive"});else r({title:"Invalid slug",description:y||"Please fix the slug before saving",variant:"destructive"});else r({title:"Validation error",description:"Please fill in all required fields and select at least one endpoint",variant:"destructive"})},[c,b,y,o,s,K,n,l,r,E,I,R,a,null==i?void 0:i.id,L]),Z="url"===c.sourceType?!!c.openapiUrl:!!c.openapiJson,J=c.selectedEndpoints.length>0,Q=!(!(c.slug&&c.name&&c.selectedEndpoints.length>0&&!1!==b)||o&&!E);return{formState:c,step:u,loading:x,saving:p,parsedSpec:f,slugValid:b,slugMessage:y,headerError:w,headersLoaded:E,headersLoadError:I,endpointSearch:k,showHeaderValues:A,redactedHeaderKeys:L,isEditing:o,setStep:m,setEndpointSearch:C,setShowHeaderValues:S,setParsedSpec:v,updateFormField:U,handleEndpointToggle:B,handleClearAllEndpoints:z,handleApplyEndpointChanges:H,handleHeaderChange:V,addHeader:W,removeHeader:q,handleParseSpec:G,handleSave:$,canProceedFromSource:Z,canProceedFromEndpoints:J,canSave:Q}}({open:t,integration:n,workspaceId:l,onSave:a,onClose:s});return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Og,{open:t,onOpenChange:s,children:(0,se.jsxs)(Hg,{className:"w-[600px] max-w-[800px] h-[500px] overflow-hidden flex flex-col p-0 gap-4 rounded-[10px]",showClose:!0,onInteractOutside:e=>e.preventDefault(),children:[(0,se.jsxs)("div",{className:"px-6 pt-6 pb-0",children:[(0,se.jsx)(Vg,{className:"p-0 mb-2",children:(0,se.jsx)(qg,{className:"text-xl font-semibold",children:j?"Edit Integration":"Add custom integration"})}),!j&&(0,se.jsx)(vZ,{currentStep:c})]}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto px-6",children:["source"===c&&(0,se.jsx)(hZ,{sourceType:o.sourceType,openapiUrl:o.openapiUrl,openapiJson:o.openapiJson,onSourceTypeChange:e=>_("sourceType",e),onUrlChange:e=>_("openapiUrl",e),onJsonChange:e=>_("openapiJson",e)}),"endpoints"===c&&m&&(0,se.jsx)(pZ,{endpoints:m.endpoints,selectedEndpoints:o.selectedEndpoints,maxEndpoints:dZ,searchValue:f,onSearchChange:N,onEndpointToggle:k,onClearAll:C}),"config"===c&&(0,se.jsx)(gZ,{slug:o.slug,name:o.name,description:o.description,baseUrl:o.baseUrl,customHeaders:o.customHeaders,selectedEndpoints:o.selectedEndpoints,parsedSpec:m,slugValid:x,slugMessage:h,headerError:p,headersLoadError:g,showHeaderValues:v,redactedHeaderKeys:b,onShowHeaderValuesChange:w,onSlugChange:e=>_("slug",e),onNameChange:e=>_("name",e),onDescriptionChange:e=>_("description",e),onBaseUrlChange:e=>_("baseUrl",e),onHeaderChange:S,onAddHeader:E,onRemoveHeader:T,isEditing:j,onEditEndpoints:()=>i(!0)})]}),(0,se.jsxs)(Wg,{className:"gap-2 px-6 py-4 border-t border-slate-200",children:["source"!==c&&!j&&(0,se.jsx)(Bx,{type:"button",variant:"outline",onClick:()=>y("config"===c?"endpoints":"source"),children:"Back"}),(0,se.jsx)("div",{className:"flex-1"}),(0,se.jsx)(Bx,{variant:"outline",onClick:s,children:"Cancel"}),"source"===c&&(0,se.jsxs)(Bx,{onClick:I,disabled:!L||d,children:[d&&(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Continue"]}),"endpoints"===c&&(0,se.jsx)(Bx,{onClick:()=>y("config"),disabled:!M,children:"Continue"}),"config"===c&&(0,se.jsxs)(Bx,{onClick:P,disabled:!R||u,children:[u&&(0,se.jsx)(Ac.A,{className:"w-4 h-4 mr-2 animate-spin"}),j?"Save":"Create Integration"]})]})]})}),j&&n&&(0,se.jsx)(bZ,{open:r,onClose:()=>i(!1),onApply:A,integrationId:n.id,currentSelectedEndpoints:o.selectedEndpoints})]})},yZ=e=>{let{workspace:t,userRole:s}=e;const{loading:a,integrations:n,dialogOpen:l,editingIntegration:r,deletingIntegration:i,deleting:o,handleAddNew:c,handleEdit:d,handleDeleteConfirm:u,handleSave:m,handleDialogClose:x,setDeletingIntegration:h,handleDeleteDialogClose:p}=(e=>{let{workspaceId:t}=e;const{toast:s}=ao(),[a,n]=(0,Y.useState)(!0),[l,r]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!1);return(0,Y.useEffect)(()=>{(async()=>{if(t)try{n(!0);const e=await oZ.listIntegrations();r(e.integrations||[])}catch(e){s({title:"Error loading integrations",description:cZ(e,"Failed to load custom integrations"),variant:"destructive"})}finally{n(!1)}})()},[t,s]),{loading:a,integrations:l,dialogOpen:i,editingIntegration:c,deletingIntegration:u,deleting:x,handleAddNew:()=>{d(null),o(!0)},handleEdit:e=>{d(e),o(!0)},handleDeleteConfirm:async()=>{if(u){h(!0);try{await oZ.deleteIntegration(u.id),r(e=>e.filter(e=>e.id!==u.id)),s({title:"Integration deleted",description:"".concat(u.name," has been deleted")})}catch(e){s({title:"Error deleting integration",description:cZ(e,"Failed to delete integration"),variant:"destructive"})}finally{h(!1),m(null)}}},handleSave:e=>{r(t=>t.find(t=>t.id===e.id)?t.map(t=>t.id===e.id?e:t):[...t,e])},handleDialogClose:()=>{o(!1),d(null)},setDeletingIntegration:m,handleDeleteDialogClose:()=>{m(null)}}})({workspaceId:null==t?void 0:t.id}),g=[yR.OWNER,yR.ADMIN].includes(s);return(0,se.jsxs)("div",{children:[(0,se.jsxs)(Bv,{className:"overflow-hidden",children:[(0,se.jsx)(zv,{className:"flex-row items-center justify-between space-y-0 py-6",children:(0,se.jsx)(R_,{size:"medium",children:"Integrations"})}),(0,se.jsxs)(Wv,{className:"pb-6 space-y-4",children:[(0,se.jsx)(jq,{}),(0,se.jsx)(rZ,{integrations:n,onEdit:d,onDelete:h,canManage:g,loading:a})]})]}),(0,se.jsx)(jZ,{open:l,onClose:x,onSave:m,integration:r,workspaceId:t.id}),(0,se.jsx)(NN,{open:!!i,onOpenChange:p,children:(0,se.jsxs)(kN,{children:[(0,se.jsxs)(CN,{children:[(0,se.jsx)(SN,{children:"Delete Integration"}),(0,se.jsxs)(EN,{children:['Are you sure you want to delete "',null==i?void 0:i.name,'"? This action cannot be undone and apps using this integration will no longer work.']})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{disabled:o,children:"Cancel"}),(0,se.jsxs)(TN,{onClick:u,disabled:o,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:[o?(0,se.jsx)(Fx.A,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Delete"]})]})]})})]})};function NZ(){const[e,t]=(0,Z.useSearchParams)(),{handleCheckoutSuccess:s}=oK();(0,Y.useEffect)(()=>{const a=e.get("success"),n=e.get("subscription_update");"true"!==a&&"success"!==n||(e.delete("success"),e.delete("subscription_update"),t(e,{replace:!0}),s())},[e,t,s])}function wZ(){const{currentWorkspace:e,userRole:t,currentUser:s,loading:a,inviteUser:n,manageSeat:l}=oK(),{user:r}=wd(),i=(0,J.Zp)();NZ();const o=!(null!=e&&e.is_personal)&&(null==e?void 0:e.is_enterprise)&&$p(null==r?void 0:r.platform_role),c=!(null!=e&&e.is_personal)&&(t===yR.OWNER||t===yR.ADMIN)&&Vj(null==s?void 0:s.effective_tier),[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)("buy"),[v,b]=(0,Y.useState)(null),j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;f(e),b(t||null),p(!0)};return a?(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500"})}):e?e.is_personal||[yR.OWNER,yR.ADMIN].includes(t)?(0,se.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 min-h-screen flex flex-col max-w-6xl",children:[(0,se.jsxs)("div",{className:"mb-8 relative",children:[(0,se.jsxs)("h1",{className:"text-4xl font-bold text-slate-900 mb-1",children:[e.name," Workspace Dashboard"]}),(0,se.jsx)("p",{className:"text-slate-500 text-lg",children:"Manage your workspace and seats"}),(0,se.jsx)("div",{className:"absolute -bottom-2.5 left-0 w-48 h-0.5 bg-orange-500 rounded-full"})]}),(0,se.jsxs)(Kj,{defaultValue:"overview",className:"space-y-6",children:[(0,se.jsxs)($j,{className:"grid w-full ".concat(e.is_personal?"grid-cols-1 max-w-xs":e.is_enterprise?o&&c?"grid-cols-5 max-w-3xl":o||c?"grid-cols-4 max-w-2xl":"grid-cols-3 max-w-xl":c?"grid-cols-3 max-w-xl":"grid-cols-2 max-w-sm"," bg-slate-200 p-1"),children:[(0,se.jsx)(Zj,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm text-slate-600",children:"Team"}),!e.is_personal&&(0,se.jsxs)(Zj,{value:"security",className:"flex items-center gap-2 whitespace-nowrap data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm text-slate-600",children:[(0,se.jsx)(HO.A,{className:"w-4 h-4 flex-shrink-0"}),(0,se.jsx)("span",{children:"Security and Auth"})]}),o&&(0,se.jsxs)(Zj,{value:"analytics",className:"flex items-center gap-2 whitespace-nowrap data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm text-slate-600",children:[(0,se.jsx)(GP.A,{className:"w-4 h-4 flex-shrink-0"}),(0,se.jsx)("span",{children:"Analytics"})]}),e.is_enterprise&&(0,se.jsxs)(Zj,{value:"management",className:"flex items-center gap-2 whitespace-nowrap data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm text-slate-600",children:[(0,se.jsx)(lK.A,{className:"w-4 h-4 flex-shrink-0"}),(0,se.jsx)("span",{children:"Apps"})]}),c&&(0,se.jsxs)(Zj,{value:"integrations",className:"flex items-center gap-2 whitespace-nowrap data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm text-slate-600",children:[(0,se.jsx)($P.A,{className:"w-4 h-4 flex-shrink-0"}),(0,se.jsx)("span",{children:"Integrations"})]})]}),(0,se.jsxs)(Jj,{value:"overview",className:"space-y-6",children:[(0,se.jsx)(pK,{onRemoveSeats:e=>j("remove",e),onBuySeats:e=>j("buy",e)}),(0,se.jsx)(bK,{onInviteUser:()=>u(!0),onBulkInvite:()=>x(!0)})]}),!e.is_personal&&(0,se.jsxs)(Jj,{value:"security",className:"space-y-6",children:[(0,se.jsx)(MK,{workspace:e,userRole:t}),e.is_enterprise&&(0,se.jsx)(tZ,{workspace:e,userRole:t})]}),e.is_enterprise&&(0,se.jsx)(Jj,{value:"management",className:"space-y-6",children:(0,se.jsx)(GK,{workspace:e,userRole:t})}),o&&(0,se.jsx)(Jj,{value:"analytics",className:"space-y-6",children:(0,se.jsx)(l$,{workspace:e,userRole:t})}),c&&(0,se.jsx)(Jj,{value:"integrations",className:"space-y-6",children:(0,se.jsx)(yZ,{workspace:e,userRole:t})})]}),(0,se.jsx)(jK,{isOpen:d,onClose:()=>u(!1),onInvite:async(e,t)=>{try{await n(e,t),u(!1)}catch(s){}}}),(0,se.jsx)(NK,{isOpen:m,onClose:()=>x(!1),onSuccess:()=>{}}),(0,se.jsx)(wK,{isOpen:h,onClose:()=>{p(!1),b(null)},onAction:async(e,t)=>{try{const s="remove"===g&&v?v:e;await l(s,t,g),p(!1),b(null)}catch(s){}},action:g,selectedPlanName:v}),(0,se.jsx)(_K,{})]}):(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,se.jsxs)("div",{className:"text-center max-w-md mx-auto p-8",children:[(0,se.jsx)(Vc.A,{className:"mx-auto h-16 w-16 text-slate-400 mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Access Restricted"}),(0,se.jsxs)("p",{className:"text-slate-500 mb-6",children:["You don't have permission to access the workspace dashboard for ",(0,se.jsx)("strong",{children:e.name}),". Only workspace administrators and owners can manage workspace settings."]}),(0,se.jsx)("button",{onClick:()=>i("/"),className:"bg-teal-600 hover:bg-teal-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go to Home"})]})}):(0,se.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(Zg.A,{className:"mx-auto h-12 w-12 text-slate-400 mb-4"}),(0,se.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Workspace Not Found"}),(0,se.jsx)("p",{className:"text-slate-500",children:"The requested workspace could not be found or you don't have access to it."})]})})}const _Z=function(){const{workspaceId:e}=(0,J.g)();return(0,se.jsx)(iK,{workspaceId:e,children:(0,se.jsx)(wZ,{})})};const kZ=function(){const e=(0,J.Zp)(),{refetchWorkspaces:t,switchActiveWorkspace:s}=qd(),{isNativeMobile:a}=fd(),[n,l]=(0,Y.useState)(""),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)("");return(0,se.jsx)("div",{className:"min-h-screen p-8",children:(0,se.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,se.jsxs)("div",{className:"mb-8",children:[!a&&(0,se.jsxs)(Bx,{variant:"ghost",onClick:()=>e(-1),className:"mb-4 text-slate-600 hover:text-slate-800",children:[(0,se.jsx)(Vs.A,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,se.jsx)("div",{className:"rounded-lg bg-orange-100 p-3",children:(0,se.jsx)(eb.A,{className:"h-6 w-6 text-orange-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Create a Workspace"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Start collaborating with your workspace members"})]})]})]}),(0,se.jsxs)(Bv,{className:"shadow-sm",children:[(0,se.jsx)(zv,{children:(0,se.jsxs)(Hv,{className:"flex items-center gap-2",children:[(0,se.jsx)(eb.A,{className:"h-5 w-5 text-slate-600"}),"Workspace Information"]})}),(0,se.jsx)(Wv,{children:(0,se.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),n.trim()){i(!0),c("");try{const a=(await Hd.createWorkspace(n.trim())).workspace_id;await t(),s(a),e("/workspace/".concat(a))}catch(o){var l,r;const e=(null==o||null===(l=o.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.detail)||o.message||"Failed to create workspace";e.includes("Workspace limit reached")?c("Workspace limit reached. You can create a maximum of 3 workspaces."):c(e)}finally{i(!1)}}else c("Workspace name is required")},className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)(aN,{htmlFor:"workspaceName",className:"text-sm font-medium text-slate-700",children:["Workspace Name ",(0,se.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,se.jsx)(Df,{id:"workspaceName",type:"text",placeholder:"Enter your workspace name",value:n,onChange:e=>l(e.target.value),disabled:r,className:"w-full",maxLength:100}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Choose a name that represents your workspace"})]}),o&&(0,se.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,se.jsx)("p",{className:"text-sm text-red-600",children:o})}),(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsx)(Bx,{type:"button",variant:"outline",onClick:()=>e(-1),disabled:r,className:"flex-1",children:"Cancel"}),(0,se.jsx)(Bx,{type:"submit",disabled:r||!n.trim(),className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white",children:r?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Creating Workspace..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(eb.A,{className:"mr-2 h-4 w-4"}),"Create Workspace"]})})]})]})})]}),(0,se.jsx)(Bv,{className:"mt-6 bg-teal-50 border-teal-200",children:(0,se.jsx)(Wv,{className:"pt-6",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"rounded-full bg-teal-100 p-2 mt-0.5",children:(0,se.jsx)(eb.A,{className:"h-4 w-4 text-teal-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-medium text-teal-900 mb-1",children:"What happens next?"}),(0,se.jsxs)("ul",{className:"text-sm text-teal-800 space-y-1",children:[(0,se.jsx)("li",{children:"\u2022 You'll be the workspace owner with full management permissions"}),(0,se.jsx)("li",{children:"\u2022 You can invite workspace members and manage seats"}),(0,se.jsx)("li",{children:"\u2022 Access your workspace dashboard to get started"})]})]})]})})})]})})};function CZ(e){let{title:t,description:s}=e;return(0,se.jsxs)("div",{className:"mb-6",children:[(0,se.jsx)(R_,{size:"large",children:t}),s&&(0,se.jsx)(__,{size:"small",secondary:!0,children:s})]})}function AZ(e){let{workspace:t,userRole:s}=e;const{refetchWorkspaces:a}=qd(),[n,l]=(0,Y.useState)(""),[r,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(!1),d=(null==t?void 0:t.is_personal)||!1,u=s===yR.OWNER||s===yR.ADMIN;(0,Y.useEffect)(()=>{t&&(l(d?"Personal Workspace":t.name||""),i(t.description||""))},[t,d]);const m=(0,Y.useCallback)(()=>{if(!t)return!1;const e=d?"Personal Workspace":t.name||"",s=t.description||"";return n!==e||r!==s},[t,d,n,r]);if(!t)return(0,se.jsxs)("div",{children:[(0,se.jsx)(CZ,{title:"Basic information"}),(0,se.jsx)("div",{className:"text-muted-foreground text-sm",children:"Loading workspace information..."})]});const x=u?"Manage your workspace details and settings.":"View workspace details. Only workspace owners and admins can edit.";return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(CZ,{title:"Workspace Basic information",description:x}),(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"p-6 space-y-6",children:[(0,se.jsxs)("div",{className:"max-w-md space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"workspace-name",className:"text-sm font-medium",children:"Workspace name"}),(0,se.jsx)(Df,{id:"workspace-name",value:n,onChange:e=>l(e.target.value),disabled:d||!u,placeholder:"Enter workspace name"})]}),(0,se.jsxs)("div",{className:"max-w-md space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"workspace-description",className:"text-sm font-medium",children:"Workspace description"}),(0,se.jsx)(tN,{id:"workspace-description",value:r,onChange:e=>i(e.target.value),disabled:!u,placeholder:"Describe your workspace...",className:"min-h-[100px] resize-none"})]})]})}),u&&m()&&(0,se.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,se.jsx)(Bx,{variant:"outline",onClick:()=>{t&&(l(d?"Personal Workspace":t.name||""),i(t.description||""))},disabled:o,children:"Cancel"}),(0,se.jsx)(Bx,{onClick:async()=>{if(t&&u&&m()){c(!0);try{const e={};d||(e.name=n),e.description=r,await Hd.updateWorkspace(t.id,e),$.default.success("Workspace settings updated successfully!"),await a()}catch(l){var e,s;const t=l;$.default.error("Failed to update workspace settings: "+((null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||t.message||"Unknown error"))}finally{c(!1)}}},disabled:o,children:o?"Saving...":"Save Changes"})]})]})}function SZ(){const{user:e}=wd(),t=qu(),[s,a]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!0),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(null),d=hv(o),u=()=>{window.open("/billing","_blank")};(0,Y.useEffect)(()=>{const e=e=>{const t=parseInt(e);if(t>=1e3){const e=t/1e3;return"".concat(e%1==0?e:e.toFixed(1),"k")}return t.toString()};(async()=>{try{l(!0);const[t,s]=await Promise.all([Yd.default.getMonthlyPlans(),Yd.default.getStats().catch(()=>null)]);if(s&&c(s),null!=t&&t.plans){const s=["starter","builder","pro","elite"],n=t.plans.filter(e=>s.includes(e.tier)),l=n.sort((e,t)=>t.price_data.unit_amount-e.price_data.unit_amount).map(t=>((t,s)=>{var a,n;const l=(null===(a=s.metadata)||void 0===a?void 0:a.monthly_message_limit)||"0",r=(null===(n=s.metadata)||void 0===n?void 0:n.monthly_integration_credits)||"0",i=t.charAt(0).toUpperCase()+t.slice(1),o="pro"===t?"Upgrade to "+i:"Upgrade";return{name:i,monthlyCredits:e(l),integrationCredits:e(r),buttonText:o,isRecommended:"pro"===t,price:"$".concat(Math.round(s.unit_amount/100))}})(t.tier,t.price_data));a(l)}else i("Unable to load pricing information")}catch(t){i("Failed to load plans")}finally{l(!1)}})()},[]);return n?(0,se.jsx)("div",{className:"py-8",children:(0,se.jsx)(oL,{})}):r?(0,se.jsx)("div",{className:"py-8 text-center",children:(0,se.jsx)(__,{skin:"error",children:r})}):(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,se.jsxs)(__,{secondary:!0,size:"small",children:["You're currently on the ",e.subscription_tier.charAt(0).toUpperCase()+e.subscription_tier.slice(1)," Plan"]}),(0,se.jsx)(Bx,{variant:"link",size:"sm",className:"text-slate-700 hover:text-slate-900 p-0 h-auto",onClick:u,children:"Compare Plans"})]}),(0,se.jsx)("div",{className:"grid gap-3 ".concat(t?"grid-cols-2":"grid-cols-4"),children:s.map(e=>{const s=parseInt(e.price.replace("$","")),a=Math.ceil(s*(1-uv.discountPercent)),n=e.name.toLowerCase(),l=d&&uv.eligibleTiers.includes(n)&&!uv.yearlyOnly;return(0,se.jsx)(Bv,{className:"flex-1 min-w-[160px] ".concat(t?"w-full":""," ").concat(e.isRecommended?"border-orange-400 border-2":""),children:(0,se.jsxs)(Wv,{className:"".concat("p-4"," flex flex-col h-full"),children:[(0,se.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,se.jsx)(__,{size:"small",weight:"bold",children:e.name}),e.isRecommended&&(0,se.jsx)(gk,{className:"bg-orange-100 text-orange-500 border-orange-200 text-xs px-1.5 py-0",children:"Recommended"})]}),(0,se.jsxs)("div",{className:"flex items-end gap-1 mb-4",children:[l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("span",{className:"text-2xl font-semibold",children:["$",a]}),(0,se.jsx)(__,{secondary:!0,className:"line-through text-sm",children:e.price})]}):(0,se.jsx)("span",{className:"text-2xl font-semibold",children:e.price}),(0,se.jsx)(__,{secondary:!0,size:"small",children:"/mo"})]}),(0,se.jsxs)("div",{className:"space-y-1.5 mb-4 flex-1",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(__,{weight:"bold",size:"small",children:e.monthlyCredits}),(0,se.jsx)(__,{secondary:!0,size:"small",children:"monthly credits"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(__,{weight:"bold",size:"small",children:e.integrationCredits}),(0,se.jsx)(__,{secondary:!0,size:"small",children:"integration credits"})]})]}),(0,se.jsx)(Bx,{variant:e.isRecommended?"default":"secondary",size:"sm",className:"w-full ".concat(e.isRecommended?"bg-orange-500 hover:bg-orange-600":""),onClick:u,children:e.buttonText})]})},e.name)})})]})}function EZ(e){var t;let{handleModalClose:s}=e;const{user:a}=wd(),n=(0,J.Zp)(),l=qu(),[r,i]=(0,Y.useState)([]),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(!0),[m,x]=(0,Y.useState)(null),h=a.subscription_tier.replace(/_/g," "),p=h.charAt(0).toUpperCase()+h.slice(1);(0,Y.useEffect)(()=>{(async()=>{try{u(!0);const[e,t]=await Promise.all([ow.getInvoices(),Yd.default.getStats()]);i(e.invoices||[]),c(t)}catch(e){x("Failed to load billing data")}finally{u(!1)}})()},[]);const g=async()=>{try{const e="past_due"===a.stripe_subscription_status?"payment_method_update":void 0,t=await ow.createPortalSession(e);"past_due"===a.stripe_subscription_status?window.location.href=t.url:window.open(t.url,"_blank")}catch(m){$.default.error("Failed to open payment management. Please try again.")}},f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e)},v=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",b=!0===(null==o||null===(t=o.stripe_subscription)||void 0===t?void 0:t.cancel_at_period_end),j=e=>{switch(e.toLowerCase()){case"paid":return"bg-emerald-100 text-emerald-700 border-emerald-200 hover:bg-emerald-100";case"pending":case"open":return"bg-orange-100 text-orange-700 border-orange-200 hover:bg-orange-100";case"failed":case"past_due":return"bg-red-100 text-red-700 border-red-200 hover:bg-red-100";default:return"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-100"}};return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(Bv,{children:(0,se.jsx)(Wv,{className:"".concat(l?"p-4":"p-6"),children:(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)(__,{size:"medium",children:["You're currently using the ",(0,se.jsx)(__,{weight:"bold",tagName:"span",children:p})," plan"]}),(0,se.jsxs)("div",{className:"space-y-0.5",children:[(0,se.jsx)(__,{size:"small",secondary:!0,children:a.subscription_period_end?b?"Your subscription will end on ".concat(v(a.subscription_period_end)):"Your subscription renews on ".concat(v(a.subscription_period_end)):"No active subscription"}),b&&(0,se.jsxs)(__,{size:"small",secondary:!0,children:["Want to keep your subscription? Click"," ",(0,se.jsx)("button",{className:"underline text-blue-500 hover:text-blue-600",onClick:g,children:"Manage Plan"})," ","and Cancel the change."]})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!l&&(0,se.jsx)(Bx,{variant:"outline",size:l?"sm":"default",onClick:g,children:"Manage Plan"}),(0,se.jsx)(Bx,{variant:"outline",size:l?"sm":"default",onClick:()=>{"past_due"===a.stripe_subscription_status?g():(n("/billing"),s())},className:"border-orange-500 text-orange-500 hover:bg-orange-50 hover:text-orange-600",children:"past_due"===a.stripe_subscription_status?"Update Payment":"Upgrade Plan"})]})]})})}),"past_due"===a.stripe_subscription_status&&(0,se.jsxs)(DR,{className:"border-orange-200 bg-orange-50",children:[(0,se.jsx)(Ap.A,{className:"h-4 w-4 text-orange-600"}),(0,se.jsx)(FR,{className:"text-orange-800",children:"Payment overdue"}),(0,se.jsx)(OR,{className:"text-orange-700",children:"Your subscription payment is past due. Please update your payment method to restore full access to your plan features."})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-foreground",children:"Billing History"}),(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"".concat(l?"p-4":"p-6"),children:[d&&(0,se.jsx)("div",{className:"text-center py-8",children:(0,se.jsx)(__,{secondary:!0,children:"Loading billing history..."})}),m&&(0,se.jsx)("div",{className:"text-center py-8",children:(0,se.jsx)(__,{skin:"error",children:m})}),!d&&!m&&0===r.length&&(0,se.jsx)("div",{className:"text-center py-8",children:(0,se.jsx)(__,{secondary:!0,children:"No billing history available"})}),!d&&!m&&r.length>0&&(0,se.jsx)("div",{className:"space-y-0",children:r.map((e,t)=>{return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-4 ".concat(l?"flex-wrap":""," py-3"),children:[(0,se.jsxs)("div",{className:"".concat(l?"w-full flex justify-between items-center":"w-32"),children:[(0,se.jsx)(__,{size:"small",children:(s=e.date,new Date(1e3*s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))}),l&&(0,se.jsx)(gk,{variant:"outline",className:j(e.status),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),(0,se.jsx)("div",{className:"".concat(l?"flex-1":"w-24"),children:(0,se.jsx)(__,{size:"small",weight:"bold",children:f(e.amount,e.currency)})}),!l&&(0,se.jsx)("div",{className:"w-20",children:(0,se.jsx)(gk,{variant:"outline",className:j(e.status),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),!l&&(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)(__,{size:"small",secondary:!0,children:e.description||"".concat(p," Plan")})}),(0,se.jsx)("div",{className:"flex-shrink-0",children:e.invoice_pdf||e.hosted_invoice_url?(0,se.jsx)(Bx,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-500 hover:text-slate-700",onClick:()=>{return t=e.invoice_pdf||e.hosted_invoice_url,void window.open(t,"_blank");var t},title:"Download Invoice",children:(0,se.jsx)(aL.A,{className:"h-4 w-4"})}):(0,se.jsx)("div",{className:"h-8 w-8 flex items-center justify-center",children:(0,se.jsx)(aL.A,{className:"h-4 w-4 text-slate-300"})})})]}),t<r.length-1&&(0,se.jsx)(ly,{})]},e.id);var s})})]})})]})]})}function TZ(e){let{workspace:t}=e;const{activeWorkspace:s}=qd(),a=qu(),n=null!=t?t:s,[l,r]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{(async()=>{if(null!=n&&n.id)try{o(!0);const e=(await Hd.getWorkspaceInvoices(n.id)).invoices||[];r(e)}catch(e){d("Failed to load workspace billing history")}finally{o(!1)}})()},[null==n?void 0:n.id]);const u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e)},m=e=>{switch(e.toLowerCase()){case"paid":return"bg-emerald-100 text-emerald-700 border-emerald-200 hover:bg-emerald-100";case"pending":case"open":return"bg-orange-100 text-orange-700 border-orange-200 hover:bg-orange-100";case"failed":case"past_due":return"bg-red-100 text-red-700 border-red-200 hover:bg-red-100";default:return"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-100"}};return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(Bv,{children:(0,se.jsx)(Wv,{className:"".concat(a?"p-4":"p-6"),children:(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,se.jsxs)("div",{className:"space-y-1",children:[(0,se.jsxs)(__,{size:"medium",children:["Managing billing for ",(0,se.jsx)(__,{weight:"bold",tagName:"span",children:(null==n?void 0:n.name)||"workspace"})]}),(0,se.jsx)(__,{size:"small",secondary:!0,children:null!=n&&n.subscription_period_end?"Workspace subscription renews on ".concat((x=n.subscription_period_end,x?new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A")):" No active workspace subscription"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!a&&"owner"===(null==n?void 0:n.user_role)&&(0,se.jsx)(Bx,{variant:"outline",size:"default",onClick:async()=>{if(null!=n&&n.id)try{const e=(await Hd.createWorkspacePortalSession(n.id)).url;e?window.open(e,"_blank"):$.default.error("Failed to open billing portal. Please try again later or contact support.")}catch(c){$.default.error("Failed to open billing portal. Please try again later or contact support.")}},children:"Manage"}),(0,se.jsx)(Bx,{variant:"outline",size:a?"sm":"default",onClick:()=>{null!=n&&n.id&&window.open("/workspace/".concat(n.id,"/settings/seats-members"),"_blank")},className:"border-orange-500 text-orange-500 hover:bg-orange-50 hover:text-orange-600",children:"Add Seats"})]})]})})}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-foreground",children:"Billing History"}),(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"".concat(a?"p-4":"p-6"),children:[i&&(0,se.jsx)("div",{className:"text-center py-8",children:(0,se.jsx)(__,{secondary:!0,children:"Loading billing history..."})}),c&&(0,se.jsx)("div",{className:"text-center py-8",children:(0,se.jsx)(__,{skin:"error",children:c})}),!i&&!c&&0===l.length&&(0,se.jsx)("div",{className:"text-center py-8",children:(0,se.jsx)(__,{secondary:!0,children:"No billing history available"})}),!i&&!c&&l.length>0&&(0,se.jsx)("div",{className:"space-y-0",children:l.map((e,t)=>{return(0,se.jsxs)("div",{children:[(0,se.jsxs)("div",{className:"flex items-center gap-4 ".concat(a?"flex-wrap":""," py-3"),children:[(0,se.jsxs)("div",{className:"".concat(a?"w-full flex justify-between items-center":"w-32"),children:[(0,se.jsx)(__,{size:"small",children:(s=e.date,new Date(1e3*s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))}),a&&(0,se.jsx)(gk,{variant:"outline",className:m(e.status),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),(0,se.jsx)("div",{className:"".concat(a?"flex-1":"w-24"),children:(0,se.jsx)(__,{size:"small",weight:"bold",children:u(e.amount,e.currency)})}),!a&&(0,se.jsx)("div",{className:"w-20",children:(0,se.jsx)(gk,{variant:"outline",className:m(e.status),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),!a&&(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)(__,{size:"small",secondary:!0,children:e.description||"Workspace Seats"})}),(0,se.jsx)("div",{className:"flex-shrink-0",children:e.invoice_pdf||e.hosted_invoice_url?(0,se.jsx)(Bx,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-500 hover:text-slate-700",onClick:()=>{return t=e.invoice_pdf||e.hosted_invoice_url,void window.open(t,"_blank");var t},title:"Download Invoice",children:(0,se.jsx)(aL.A,{className:"h-4 w-4"})}):(0,se.jsx)("div",{className:"h-8 w-8 flex items-center justify-center",children:(0,se.jsx)(aL.A,{className:"h-4 w-4 text-slate-300"})})})]}),t<l.length-1&&(0,se.jsx)(ly,{})]},e.id);var s})})]})})]})]});var x}function IZ(e){var t,s,a,n;let{workspace:l}=e;const{activeWorkspace:r}=qd(),i=qu(),o=null!=l?l:r,[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)(!0),[x,h]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{(async()=>{if(null!=o&&o.id)try{m(!0);const e=await Hd.getMySeatInfo(o.id);d(e.data||e)}catch(e){h("Failed to load seat information")}finally{m(!1)}})()},[null==o?void 0:o.id]);return u?(0,se.jsx)("div",{className:"py-16",children:(0,se.jsx)(oL,{})}):x?(0,se.jsx)("div",{className:"py-16 text-center",children:(0,se.jsx)(__,{skin:"error",children:x})}):(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"".concat(i?"p-4":"p-6"," space-y-4"),children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)(__,{weight:"bold",children:(null==o?void 0:o.name)||"Workspace"}),(null==c?void 0:c.user_role)&&(0,se.jsxs)(__,{size:"small",secondary:!0,className:"capitalize",children:[c.user_role," access"]})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-slate-100",children:[(0,se.jsx)(__,{children:(e=>{if(null==e||!e.user_seat)return"Viewer access";const{user_seat:t}=e;return"assigned"===t.status&&t.seat_type?"".concat(t.seat_type," seat assigned"):"Viewer access"})(c)}),(0,se.jsx)(gk,{variant:"outline",className:(g=null==c||null===(t=c.user_seat)||void 0===t?void 0:t.status,"assigned"===g?"bg-emerald-100 text-emerald-700 border-emerald-200 hover:bg-emerald-100":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-100"),children:"assigned"===(null==c||null===(s=c.user_seat)||void 0===s?void 0:s.status)?"Active":"Viewer"})]}),"assigned"===(null==c||null===(a=c.user_seat)||void 0===a?void 0:a.status)&&(0,se.jsxs)("div",{className:"pt-2 border-t border-slate-100 space-y-1",children:[(0,se.jsx)(__,{size:"small",weight:"bold",children:"Seat Details"}),c.user_seat.seat_id&&(0,se.jsxs)(__,{size:"small",secondary:!0,children:["Seat ID: ",c.user_seat.seat_id]}),(0,se.jsxs)(__,{size:"small",secondary:!0,children:["Plan: ",c.user_seat.seat_type]})]}),(null==o?void 0:o.subscription_period_end)&&(0,se.jsx)("div",{className:"pt-2 border-t border-slate-100",children:(0,se.jsxs)(__,{size:"small",secondary:!0,children:["Workspace subscription renews on ",(p=o.subscription_period_end,p?new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A")]})})]})}),(null==c?void 0:c.workspace_admins)&&c.workspace_admins.length>0&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-foreground",children:"Workspace Administrators"}),(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"".concat(i?"p-4":"p-6"),children:[(0,se.jsx)(__,{size:"small",secondary:!0,className:"mb-4 block",children:"Contact your workspace administrators for seat assignments:"}),(0,se.jsx)("div",{className:"space-y-2",children:c.workspace_admins.map(e=>(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,se.jsx)(__,{size:"small",children:e.email}),(0,se.jsx)(__,{size:"small",secondary:!0,className:"capitalize",children:e.role})]},e.email))})]})})]}),"assigned"!==(null==c||null===(n=c.user_seat)||void 0===n?void 0:n.status)&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("h3",{className:"text-base font-semibold text-foreground",children:"Need a Seat?"}),(0,se.jsxs)(DR,{className:"border-blue-200 bg-blue-50",children:[(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-blue-600"}),(0,se.jsx)(OR,{className:"text-blue-800",children:"You don't currently have a seat assigned in this workspace. Contact your workspace administrators to request a seat assignment."})]})]})]});var p,g}function PZ(e){let{handleModalClose:t,workspace:s,userRole:a}=e;const{user:n}=wd(),{activeWorkspace:l}=qd(),r=null!=s?s:l,i=null!=a?a:null==r?void 0:r.user_role;return r&&!r.is_personal?NR(i)?(0,se.jsx)(TZ,{workspace:r}):(0,se.jsx)(IZ,{workspace:r}):n.stripe_customer_id||n.stripe_subscription_status?(0,se.jsx)(EZ,{handleModalClose:t}):(0,se.jsx)(SZ,{})}function LZ(e){let{workspace:t,userRole:s}=e;return(0,se.jsxs)("div",{children:[(0,se.jsx)(CZ,{title:"Plan and billing",description:"Manage your subscription plan and billing settings."}),(0,se.jsx)(PZ,{handleModalClose:()=>{},workspace:t,userRole:s})]})}function MZ(e){let{title:t,current:s,total:a,percentage:n,remaining:l}=e;const[r,i]=(0,Y.useState)(0);(0,Y.useEffect)(()=>{const e=setTimeout(()=>{i(n)},100);return()=>clearTimeout(e)},[n]);return(0,se.jsxs)("div",{className:"flex flex-col gap-2 animate-in fade-in duration-500",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium leading-tight",children:t}),(0,se.jsxs)("div",{className:"text-black text-sm font-medium leading-tight",children:[s,"/",a]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,se.jsx)("div",{className:"flex items-center gap-3",children:(0,se.jsx)("div",{className:"flex-1 flex items-center gap-1.5",children:(0,se.jsx)("div",{className:"flex-1 h-2 bg-slate-100 rounded-full flex",children:(0,se.jsx)("div",{className:"h-full bg-gray-900 rounded-full transition-all duration-700 ease-out ".concat((e=>e>90?"bg-red-500":e>75?"bg-yellow-500":"bg-slate-600")(n)),style:{width:"".concat(r,"%")}})})})}),(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsxs)("div",{className:"text-gray-500 text-sm font-normal leading-tight",children:[n,"% used"]}),(0,se.jsxs)("div",{className:"text-gray-500 text-sm font-normal leading-tight",children:[l," ",t.toLowerCase().includes("credit")?"credits":"messages"," remaining"]})]})]})]})}function RZ(){var e,t,s;const[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)([]),{user:x}=wd(),{toast:h}=ao(),p=(!(null!=c&&c.tier)||"free"===(null==c?void 0:c.tier.toLowerCase()))&&(null==c?void 0:c.daily_usage)>=(null==c?void 0:c.daily_limit),g=async()=>{if(null!=c&&c.past_due)try{const e="payment_method_update",t=await ow.createPortalSession(e);window.location.href=t.url}catch(i){h({variant:"destructive",title:"Error",description:"Failed to open payment management. Please try again."})}else window.open("/billing","_blank")};(0,Y.useEffect)(()=>{f()},[]);const f=async()=>{try{r(!0);const[e,t]=await Promise.all([Yd.default.getStats(),Yd.default.getCurrentIntegrationUsage()]),s=e,a=t,l=[{title:"Monthly Messages",current:Math.round((null==s?void 0:s.monthly_usage)||0),total:(null==s?void 0:s.monthly_limit)||0,percentage:null!=s&&s.monthly_limit?Math.round(s.monthly_usage/s.monthly_limit*100):0,remaining:Math.max(0,((null==s?void 0:s.monthly_limit)||0)-Math.round((null==s?void 0:s.monthly_usage)||0))},...null!=s&&s.daily_limit?[{title:"Daily Messages",current:Math.round((null==s?void 0:s.daily_usage)||0),total:(null==s?void 0:s.daily_limit)||0,percentage:null!=s&&s.daily_limit?Math.round(s.daily_usage/s.daily_limit*100):0,remaining:Math.max(0,((null==s?void 0:s.daily_limit)||0)-Math.round((null==s?void 0:s.daily_usage)||0))}]:[],{title:"Integration Credits",current:(null==a?void 0:a.credits_this_month)||0,total:(null==a?void 0:a.credits_limit)||0,percentage:null!=a&&a.credits_limit?Math.round(a.credits_this_month/a.credits_limit*100):0,remaining:Math.max(0,((null==a?void 0:a.credits_limit)||0)-((null==a?void 0:a.credits_this_month)||0))}];n(l),m((null==s?void 0:s.usage_by_date)||[]),d({subscription_status:null==s?void 0:s.subscription_status,is_over_limit:null==s?void 0:s.is_over_limit,past_due:null==s?void 0:s.past_due,tier:null==s?void 0:s.tier,next_period_start_date:null==s?void 0:s.next_period_start_date,daily_usage:null==s?void 0:s.daily_usage,daily_limit:null==s?void 0:s.daily_limit}),o(null)}catch(e){o("Failed to load usage statistics"),n([{title:"Monthly Messages",current:0,total:0,percentage:0,remaining:0},{title:"Integration Credits",current:0,total:0,percentage:0,remaining:0}]),m([])}finally{r(!1)}};return l?(0,se.jsx)("div",{className:"flex flex-col gap-6 animate-in fade-in duration-300",children:(0,se.jsxs)("div",{className:"bg-gray-100 rounded-xl border border-gray-200 flex flex-col transition-all duration-300",children:[(0,se.jsxs)("div",{className:"pl-6 pr-3 py-3 rounded-t-xl flex items-center gap-2.5",children:[(0,se.jsx)("div",{className:"flex-1 flex items-center gap-2",children:(0,se.jsx)("div",{className:"h-5 w-56 bg-gray-200 rounded animate-pulse"})}),(0,se.jsx)("div",{className:"h-8 w-28 bg-gray-200 rounded-md animate-pulse"})]}),(0,se.jsxs)("div",{className:"p-6 bg-white rounded-xl border border-gray-200 flex flex-col gap-6",children:[(0,se.jsx)("div",{className:"flex justify-center max-w-md mx-auto",children:(0,se.jsx)("div",{className:"h-10 w-64 bg-gray-100 rounded-lg border border-gray-200 animate-pulse"})}),[1,2,3].map(e=>(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("div",{className:"h-4 w-32 bg-gray-200 rounded animate-pulse"}),(0,se.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}),(0,se.jsx)("div",{className:"h-2 w-full bg-gray-200 rounded-full animate-pulse"}),(0,se.jsx)("div",{className:"h-3 w-24 bg-gray-100 rounded animate-pulse"})]},e)),(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsx)("div",{className:"h-5 w-40 bg-gray-200 rounded animate-pulse"}),(0,se.jsx)("div",{className:"h-48 w-full bg-gray-100 rounded-lg animate-pulse"})]})]})]})}):i?(0,se.jsx)("div",{className:"flex flex-col gap-6 animate-in fade-in duration-300",children:(0,se.jsx)("div",{className:"bg-gray-100 rounded-xl border border-gray-200 flex flex-col transition-all duration-300",children:(0,se.jsx)("div",{className:"p-6 flex items-center justify-center",children:(0,se.jsx)("div",{className:"text-red-500 animate-in fade-in duration-500",children:i})})})}):(0,se.jsx)("div",{className:"flex flex-col gap-6 animate-in fade-in duration-500",children:(0,se.jsxs)("div",{className:"bg-gray-100 rounded-xl border border-gray-200 flex flex-col transition-all duration-300",children:[(0,se.jsxs)("div",{className:"pl-6 pr-3 py-3 rounded-t-xl flex items-center gap-2.5 animate-in fade-in slide-in-from-top-2 duration-400",children:[(0,se.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,se.jsxs)("div",{className:"text-black text-base font-medium leading-normal",children:["You're currently on the ",x.subscription_tier.charAt(0).toUpperCase()+x.subscription_tier.slice(1)," Plan"]}),(null==c?void 0:c.is_over_limit)&&(0,se.jsx)("div",{className:"px-2 py-1 bg-red-100 text-red-600 text-xs rounded-md animate-in fade-in duration-500",children:"Over Limit"})]}),"elite3"!==x.subscription_tier&&(null!=c&&c.past_due?(0,se.jsx)("button",{onClick:g,className:"px-4 py-1.5 bg-black rounded-md shadow-[0px_1px_2px_0px_rgba(0,0,0,0.10)] flex items-center gap-2.5 hover:bg-gray-800 transition-all duration-200 animate-in fade-in slide-in-from-right-2 duration-500",children:(0,se.jsx)("div",{className:"text-white text-sm font-medium leading-tight",children:"Update Payment"})}):(0,se.jsxs)("button",{onClick:g,className:"px-4 py-1.5 rounded-md shadow-[0px_1px_2px_0px_rgba(0,0,0,0.10)] flex items-center gap-2.5 transition-all duration-200 animate-in fade-in slide-in-from-right-2 duration-500 text-white",style:{background:"linear-gradient(49deg, rgba(255, 85, 0, 1) 0%, rgba(255, 196, 148, 1) 100%)"},children:[(0,se.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M12.0287 0.0164795C12.1965 0.042961 12.3596 0.100934 12.5095 0.188599C12.7069 0.304114 12.8762 0.468088 13.005 0.666504L14.7355 3.75L14.738 3.75366C14.899 3.99942 14.9897 4.28987 15 4.58862L14.9991 4.71771C14.9843 5.06147 14.8634 5.39025 14.6562 5.65155L14.6545 5.6543L14.6536 5.65338L8.5794 14.4424L8.57768 14.4406C8.4508 14.6113 8.29197 14.7507 8.10978 14.8471C7.92041 14.9474 7.712 15 7.50143 15C7.29086 15 7.08245 14.9474 6.89308 14.8471C6.71098 14.7507 6.55114 14.6121 6.42433 14.4415L0.345341 5.65338L0.343618 5.65155C0.13648 5.39026 0.0163288 5.06138 0.00152918 4.71771C-0.0131882 4.37397 0.0786621 4.0346 0.262619 3.75366L0.264343 3.75L1.99786 0.666504C2.1268 0.4679 2.29663 0.304156 2.49419 0.188599C2.69408 0.0717083 2.91669 0.00678431 3.1439 0H11.8598L12.0287 0.0164795ZM8.37087 13.2788L13.5248 5.63873H11.1017L8.37087 13.2788ZM6.6027 13.2431L4.21086 5.63873H1.47501L6.6027 13.2431ZM7.48937 13.0389L10.0962 5.63873H5.18973L7.48937 13.0389ZM3.09909 0.9375C3.03124 0.948211 2.96586 0.972569 2.90521 1.008C2.82421 1.05537 2.75351 1.12204 2.70099 1.20392L2.69668 1.21124L0.964892 4.29108L0.965754 4.29199C0.892875 4.40351 0.856552 4.53824 0.862352 4.67468C0.862739 4.68362 0.865053 4.69236 0.865798 4.70123H4.13847L5.03874 0.931091H3.16716L3.09909 0.9375ZM11.1845 4.70123H14.1349C14.1356 4.69236 14.1379 4.68361 14.1383 4.67468C14.1441 4.53821 14.1076 4.40334 14.0349 4.29199L12.3062 1.21124L12.301 1.20392C12.2486 1.12227 12.1793 1.05528 12.0985 1.008C12.0378 0.972495 11.9717 0.948222 11.9038 0.9375L11.8348 0.931091H10.2873L11.1845 4.70123ZM5.15785 4.70123H10.1651L9.26788 0.931091H6.05811L5.15785 4.70123Z",fill:"white"})}),(0,se.jsx)("div",{className:"text-white text-sm font-medium leading-tight",children:"Upgrade"})]}))]}),(null==c?void 0:c.past_due)&&(0,se.jsx)("div",{className:"mx-6 mt-3 mb-3 p-4 bg-orange-50 border border-orange-200 rounded-lg animate-in fade-in duration-500",children:(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"flex-shrink-0 w-5 h-5 bg-orange-500 rounded-full flex items-center justify-center mt-0.5",children:(0,se.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,se.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"text-orange-800 font-medium text-sm mb-1",children:"Payment overdue"}),(0,se.jsxs)("p",{className:"text-orange-700 text-sm",children:["Your subscription payment is past due. Credits and limits shown are based on your last paid plan (",(null==c||null===(e=c.tier)||void 0===e||null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())+(null==c||null===(s=c.tier)||void 0===s?void 0:s.slice(1)),")."]})]})]})}),(0,se.jsxs)("div",{className:"p-6 bg-white rounded-xl border border-gray-200 flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-2 duration-600",children:[(null==c?void 0:c.next_period_start_date)&&(0,se.jsx)("div",{className:"flex justify-center max-w-md mx-auto",children:(0,se.jsx)(vI,{endDate:null==c?void 0:c.next_period_start_date,isDaily:p,className:"flex text-sm text-black font-base44 font-light justify-center rounded-lg border border-gray-200 p-2"})}),a.map((e,t)=>(0,se.jsx)("div",{style:{animationDelay:"".concat(100*t,"ms")},className:"animate-in fade-in slide-in-from-bottom-1 duration-500",children:(0,se.jsx)(MZ,(0,ue.A)({},e))},t)),(0,se.jsx)("div",{style:{animationDelay:"".concat(100*a.length,"ms")},className:"animate-in fade-in slide-in-from-bottom-1 duration-500",children:(0,se.jsx)(UH,{usageByDate:u})})]})]})})}const DZ=e=>{let{activeView:t="billing",isWorkspaceContext:s=!1}=e;const[a,n]=(0,Y.useState)(""),[l,r]=(0,Y.useState)("idle"),[i,o]=(0,Y.useState)(""),c="loading"===l||"success"===l;return(0,se.jsxs)("div",{className:"flex items-start gap-8",children:[(0,se.jsxs)("div",{className:"flex-1 min-w-0 pt-1",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Have a credits coupon code?"}),(0,se.jsx)("p",{className:"text-sm text-gray-500",children:"Your credits will appear once the code is valid"})]}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),a.trim()){r("loading"),o("");try{await dV.addCouponCode(a.trim()),r("success"),n("")}catch(l){var t,s;r("error"),o((null===(t=l.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"The code is Invalid. Please Try again")}}},className:"flex items-center gap-2",children:[(0,se.jsx)(Df,{type:"text",placeholder:"Enter your credits coupon code",value:a,onChange:e=>{n(e.target.value),"error"!==l&&"success"!==l||(r("idle"),o(""))},disabled:c,className:"flex-1 h-8 text-sm border-gray-200 ".concat("success"===l?"bg-gray-50 text-gray-400":"")}),(0,se.jsx)(Bx,{type:"submit",variant:"outline",disabled:c||!a.trim(),className:"h-8 px-4 text-sm font-medium min-w-[70px]",children:"loading"===l?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):"Apply"})]}),"error"===l&&(0,se.jsxs)("div",{className:"flex items-center gap-1.5 mt-2 text-red-500",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 flex-shrink-0"}),(0,se.jsx)("span",{className:"text-sm",children:i})]}),"success"===l&&(0,se.jsxs)("div",{className:"flex items-center gap-1.5 mt-2 text-green-600",children:[(0,se.jsx)(hb.A,{className:"h-4 w-4 flex-shrink-0"}),(0,se.jsx)("span",{className:"text-sm",children:"Coupon applied successfully!"})]})]})]})};function FZ(){return(0,se.jsxs)("div",{className:"space-y-8",children:[(0,se.jsx)(CZ,{title:"Credit Usage",description:"Monitor your credit consumption and usage patterns."}),(0,se.jsx)(RZ,{}),(0,se.jsx)(DZ,{isWorkspaceContext:!0})]})}function OZ(){const{inviteUser:e,manageSeat:t}=oK(),[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)("buy"),[d,u]=(0,Y.useState)(null),m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;c(e),u(t||null),i(!0)};return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(CZ,{title:"Seats and members",description:"Manage workspace seats and team members."}),(0,se.jsx)(pK,{onRemoveSeats:e=>m("remove",e),onBuySeats:e=>m("buy",e)}),(0,se.jsx)(bK,{onInviteUser:()=>a(!0),onBulkInvite:()=>l(!0)}),(0,se.jsx)(jK,{isOpen:s,onClose:()=>a(!1),onInvite:async(t,s)=>{try{await e(t,s),a(!1)}catch(n){}}}),(0,se.jsx)(NK,{isOpen:n,onClose:()=>l(!1),onSuccess:()=>l(!1)}),(0,se.jsx)(wK,{isOpen:r,onClose:()=>{i(!1),u(null)},onAction:async(e,s)=>{try{const a="remove"===o&&d?d:e;await t(a,s,o),i(!1),u(null)}catch(a){}},action:o,selectedPlanName:d}),(0,se.jsx)(_K,{})]})}function UZ(e){let{workspace:t,userRole:s}=e;return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsx)(CZ,{title:"Auth and Security",description:"Configure authentication and security settings for your workspace."}),(0,se.jsx)(MK,{workspace:t,userRole:s}),t.is_enterprise&&(0,se.jsx)(tZ,{workspace:t,userRole:s})]})}function BZ(e){let{workspace:t,userRole:s}=e;return(0,se.jsxs)("div",{children:[(0,se.jsx)(CZ,{title:"Apps Configuration",description:"Configure app settings and visibility for your workspace."}),(0,se.jsx)(GK,{workspace:t,userRole:s})]})}function zZ(e){let{workspace:t,userRole:s}=e;return(0,se.jsxs)("div",{children:[(0,se.jsx)(CZ,{title:"Integrations",description:"Manage custom integrations and external connections."}),(0,se.jsx)(yZ,{workspace:t,userRole:s})]})}function HZ(e){let{workspace:t,userRole:s}=e;return(0,se.jsxs)("div",{children:[(0,se.jsx)(CZ,{title:"Analytics",description:"Monitor workspace usage, user activity, and resource consumption."}),(0,se.jsx)(l$,{workspace:t,userRole:s})]})}function VZ(e){let{userEmail:t,userFullName:s,profileImageUrl:a,size:n="default"}=e;const{activeWorkspace:l}=qd(),r={default:{containerClass:"flex items-center gap-3 pl-4 pr-1 py-1 rounded-xl bg-[rgba(103,48,23,0.05)] hover:bg-[rgba(103,48,23,0.10)] transition-colors duration-150 cursor-pointer",imageClass:"h-7 w-7 rounded-lg object-cover bg-white",initialsClass:"h-7 w-7 rounded-lg bg-white flex items-center justify-center text-sm font-base44 font-semibold text-slate-600 select-none",showWorkspace:!0},lg:{containerClass:"flex items-center justify-center",imageClass:"h-16 w-16 rounded-2xl object-cover bg-white",initialsClass:"h-16 w-16 rounded-2xl bg-gray-100 flex items-center justify-center text-2xl font-base44 font-semibold text-slate-600 select-none",showWorkspace:!1}},i=r[n]||r.default;return(0,se.jsxs)("div",{className:i.containerClass,title:"".concat(s||"Unknown"," (").concat(t||"No email",")"),children:[i.showWorkspace&&(0,se.jsx)("span",{className:"text-sm font-base44 font-light text-slate-700",children:l&&!l.is_personal?"".concat(l.name.length>8?l.name.substring(0,8)+"...":l.name):"My Workspace"}),a?(0,se.jsx)("img",{src:a,alt:"".concat(s||"User"," profile"),className:i.imageClass,onError:e=>{e.target.style.display="none";const t=e.target.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,se.jsx)("div",{className:i.initialsClass,style:{display:a?"none":"flex"},children:s?s.charAt(0).toUpperCase():"U"})]})}function WZ(e){let{size:t="default"}=e;const{user:s}=wd();return s?(0,se.jsx)(VZ,{userEmail:null==s?void 0:s.email,userFullName:null==s?void 0:s.full_name,profileImageUrl:null==s?void 0:s.profile_image_url,size:t}):null}function qZ(e){let{value:t,onChange:s,userEmail:a,userFullName:n}=e;const[l,r]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),u=(0,Y.useRef)(null);return(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Profile Image"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsxs)("div",{className:"relative cursor-pointer group inline-block",onClick:()=>{var e;null===(e=u.current)||void 0===e||e.click()},title:"Click to upload image",children:[t&&!l?(0,se.jsx)("img",{src:t,alt:"Profile",className:"h-12 w-12 rounded-lg object-cover border border-slate-300 group-hover:border-slate-400 transition-colors",onLoad:()=>{r(!1),o(!0)},onError:()=>{r(!0),o(!1)},style:{display:i&&!l?"block":"none"}}):null,(!t||l||!i)&&(0,se.jsx)("div",{className:"h-12 w-12 rounded-lg text-slate-600 border border-slate-300 flex items-center justify-center bg-slate-50 font-medium group-hover:border-slate-400 transition-colors",children:n?n.charAt(0).toUpperCase():"U"}),(0,se.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 rounded-lg flex items-center justify-center transition-all duration-200",children:(0,se.jsx)(W_.A,{className:"w-4 h-4 text-white opacity-0 group-hover:opacity-100 transition-opacity"})}),c&&(0,se.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-75 rounded-lg flex items-center justify-center",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-gray-900"})})]}),(0,se.jsx)("input",{ref:u,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:async e=>{const t=e.target.files[0];if(!t)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(t.type))return void $.default.error("Please upload a valid image file (JPG, PNG, GIF, or WebP)");if(t.size>5242880)$.default.error("Image must be less than 5MB");else try{d(!0);const e=(await ip.uploadFile(t)).url;s(e),$.default.success("Profile image uploaded successfully!")}catch(a){$.default.error("Failed to upload image. Please try again.")}finally{d(!1)}},className:"hidden"})]})]})}function YZ(e){let{shortcut:t,className:s,labelClassName:a,symbolClassName:n}=e;const{modifierKey:l,modifierSymbol:r}=Fp(),i=Y.useMemo(()=>{switch(t){case"enter":default:return"Enter";case"cmd_enter":return"".concat(l," + Enter");case"shift_enter":return"Shift + Enter"}},[t,l]);return(0,se.jsxs)("div",{className:de("flex items-center justify-between w-full",s),children:[(0,se.jsx)("span",{className:de("font-mono text-sm text-black",a),children:i}),(0,se.jsx)("span",{className:de("font-sans text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded mr-2",n),children:(()=>{const e=(0,se.jsx)("span",{style:{position:"relative",top:"2px"},children:"\u21b5"});switch(t){case"enter":default:return e;case"cmd_enter":return(0,se.jsxs)(se.Fragment,{children:[r," + ",e]});case"shift_enter":return(0,se.jsxs)(se.Fragment,{children:["\u21e7 + ",e]})}})()})]})}const GZ=["enter","shift_enter","cmd_enter"];function KZ(e){let{value:t,onChange:s,label:a,disabled:n=!1,className:l,excludeOptions:r=[],disabledOptions:i=[]}=e;const{modifierKey:o,modifierSymbol:c}=Fp(),d=Y.useCallback(e=>{switch(e){case"enter":default:return{label:"Enter",symbol:"\u21b5"};case"cmd_enter":return{label:"".concat(o," + Enter"),symbol:"".concat(c," + \u21b5")};case"shift_enter":return{label:"Shift + Enter",symbol:"\u21e7 + \u21b5"}}},[o,c]),u=Y.useMemo(()=>GZ.filter(e=>!r.includes(e)),[r]);return(0,se.jsxs)("div",{className:de("flex flex-col gap-2",l),children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:a}),(0,se.jsxs)(Wf,{value:t,onValueChange:e=>s(e),disabled:n,children:[(0,se.jsx)(Yf,{className:de("w-full h-9 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-colors",n&&"bg-gray-50 cursor-not-allowed"),children:(0,se.jsx)(YZ,{shortcut:t})}),(0,se.jsx)($f,{className:"min-w-[200px]",children:u.map(e=>{const t=d(e),s=i.includes(e);return(0,se.jsx)(Zf,{value:e,className:"px-4 py-2.5 cursor-pointer",hideCheckIcon:!0,disabled:s,children:(0,se.jsx)("span",{className:"font-mono text-sm",children:t.label})},e)})})]})]})}function $Z(e){let{sendValue:t,newLineValue:s,onChange:a,disabled:n=!1,className:l}=e;const r=Y.useCallback(e=>{a(e,e===s?t:s)},[t,s,a]),i=Y.useCallback(e=>{e!==t&&a(t,e)},[t,a]);return(0,se.jsxs)("div",{className:de("flex flex-col sm:flex-row gap-4",l),children:[(0,se.jsx)("div",{className:"flex-1 max-w-[450px]",children:(0,se.jsx)(KZ,{label:"Send message shortcut",value:t,onChange:r,disabled:n})}),(0,se.jsx)("div",{className:"flex-1 max-w-[450px]",children:(0,se.jsx)(KZ,{label:"Insert new line shortcut",value:s,onChange:i,disabled:n,disabledOptions:[t]})})]})}const ZZ=[{value:"on_first_prompt",label:"On first prompt only"},{value:"every_prompt",label:"On every prompt completion"},{value:"never",label:"Disable notification sounds"}];function JZ(e){let{values:t,onChange:s,disabled:a=!1,className:n}=e;const l=Y.useCallback((e,a)=>{s((0,ue.A)((0,ue.A)({},t),{},{sendMessageShortcut:e,insertNewLineShortcut:a}))},[t,s]),r=Y.useCallback(e=>{s((0,ue.A)((0,ue.A)({},t),{},{notificationPreference:e}))},[t,s]),i=Y.useMemo(()=>{var e;return(null===(e=ZZ.find(e=>e.value===t.notificationPreference))||void 0===e?void 0:e.label)||"On every prompt completion"},[t.notificationPreference]);return(0,se.jsxs)("div",{className:de("space-y-6",n),children:[(0,se.jsx)("div",{className:"text-black text-base font-semibold",children:"Chat Settings"}),(0,se.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,se.jsx)($Z,{sendValue:t.sendMessageShortcut,newLineValue:t.insertNewLineShortcut,onChange:l,disabled:a}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 w-full sm:w-[calc(50%-8px)] max-w-[450px]",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Sound Preferences"}),(0,se.jsxs)(Wf,{value:t.notificationPreference,onValueChange:e=>r(e),disabled:a,children:[(0,se.jsx)(Yf,{className:de("w-full h-9 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-colors",a&&"bg-gray-50 cursor-not-allowed"),children:(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:i})}),(0,se.jsx)($f,{className:"min-w-[200px]",children:ZZ.map(e=>(0,se.jsx)(Zf,{value:e.value,className:"px-4 py-2.5 cursor-pointer",hideCheckIcon:!0,children:(0,se.jsx)("span",{className:"text-sm font-medium",children:e.label})},e.value))})]})]})]})]})}const QZ="enter",XZ="shift_enter";function eJ(){return(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("p",{className:"text-sm text-slate-700 leading-relaxed",children:"This will schedule your account and all associated data for permanent deletion."}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-semibold text-slate-900 mb-2",children:"What will be deleted:"}),(0,se.jsxs)("ul",{className:"text-sm text-slate-600 space-y-1 ml-1",children:[(0,se.jsxs)("li",{className:"flex items-start gap-2",children:[(0,se.jsx)("span",{className:"text-slate-400",children:"\u2022"}),(0,se.jsx)("span",{children:"Your account and profile"})]}),(0,se.jsxs)("li",{className:"flex items-start gap-2",children:[(0,se.jsx)("span",{className:"text-slate-400",children:"\u2022"}),(0,se.jsx)("span",{children:"All apps you've created"})]}),(0,se.jsxs)("li",{className:"flex items-start gap-2",children:[(0,se.jsx)("span",{className:"text-slate-400",children:"\u2022"}),(0,se.jsx)("span",{children:"All data stored in your apps"})]}),(0,se.jsxs)("li",{className:"flex items-start gap-2",children:[(0,se.jsx)("span",{className:"text-slate-400",children:"\u2022"}),(0,se.jsx)("span",{children:"Uploaded files and media"})]})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-1",children:[(0,se.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed",children:"You'll have 7 days to cancel this request. After that, our team will review and process your deletion shortly."}),(0,se.jsx)("p",{className:"text-sm text-slate-600 font-medium",children:"Subscription cancellation is final with no refunds"})]})]})}function tJ(e){let{onCancel:t,onConfirm:s,isLoading:a}=e;return(0,se.jsxs)("div",{className:"flex gap-3 justify-start",children:[(0,se.jsx)(zt,{variant:"outline",onClick:t,className:"border-slate-300 text-slate-900 hover:bg-slate-50",children:"Cancel"}),(0,se.jsxs)(zt,{onClick:s,disabled:a,className:"bg-red-500 hover:bg-red-600 text-white",children:[a&&(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Delete Account"]})]})}function sJ(e){let{isOpen:t,onOpenChange:s,onConfirm:a,isLoading:n}=e;return(0,se.jsx)(ma,{open:t,onOpenChange:s,children:(0,se.jsxs)(fa,{className:"sm:max-w-md",children:[(0,se.jsx)(va,{children:(0,se.jsx)(ja,{className:"text-lg font-semibold text-black",children:"Delete Your Account"})}),(0,se.jsx)(ya,{asChild:!0,children:(0,se.jsx)("div",{children:(0,se.jsx)(eJ,{})})}),(0,se.jsx)(ba,{className:"gap-3 sm:gap-3 pt-2",children:(0,se.jsx)(tJ,{onCancel:()=>s(!1),onConfirm:()=>{a(),s(!1)},isLoading:n})})]})})}function aJ(e){let{user:t,onShowDeleteConfirmation:s}=e;const[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1),x=od(),h=(0,Y.useCallback)(async()=>{if(null!=t&&t.id){r(!0);try{const e=await VH.getOwnRequests();n(e||[])}catch(e){n([])}finally{r(!1)}}},[null==t?void 0:t.id]);(0,Y.useEffect)(()=>{h()},[h]),(0,Y.useEffect)(()=>{a.some(e=>"pending"===e.status||"in_progress"===e.status)&&m(!0)},[a]);const p=(0,Y.useCallback)(async()=>{if(t){o("create");try{await VH.submitOwnDeleteRequest(),$.default.success("Deletion request submitted. We will review and process it after the 7-day grace period."),await h()}catch(e){$.default.error("Failed to submit deletion request. Please try again.")}finally{o(null)}}},[t,h]),g=a.find(e=>"pending"===e.status||"in_progress"===e.status),f=!!g;return(0,se.jsxs)("div",{className:"w-full",children:[(0,se.jsx)("div",{className:"border-t border-gray-200 mb-6"}),(0,se.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl",children:[(0,se.jsxs)("button",{type:"button",onClick:()=>m(!u),className:"w-full px-5 py-4 flex items-center justify-between hover:bg-slate-50 transition-colors ".concat(u?"rounded-t-xl":"rounded-xl"),children:[(0,se.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:"Delete account"}),(0,se.jsx)(_t.A,{className:"h-5 w-5 text-slate-400 transition-transform duration-200 ".concat(u?"rotate-180":"")})]}),u&&(0,se.jsx)("div",{className:"px-5 pb-4 border-t border-slate-100",children:l?(0,se.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,se.jsx)(Ac.A,{className:"h-5 w-5 animate-spin text-slate-400"})}):f?(()=>{const{daysRemaining:e,formattedEnd:t}=WH(g.created_date);return(0,se.jsxs)("div",{className:"pt-4 flex flex-col gap-4",children:[(0,se.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed",children:"pending"===g.status?(0,se.jsxs)(se.Fragment,{children:["Your account, subscription, owned apps and workspaces will be deleted in"," ",(0,se.jsxs)("span",{className:"font-semibold text-slate-900",children:[e," days"]})," ","(",t,") and will be permanent from that date. Until then you can cancel the deletion."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 text-teal-600 animate-spin inline mr-2"}),"Deletion is being processed..."]})}),"pending"===g.status&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(zt,{variant:"default",size:"sm",onClick:()=>(async e=>{o(e);try{await VH.cancelOwnRequest(e),$.default.success("Deletion request cancelled successfully."),await h()}catch(t){$.default.error("Failed to cancel request. Please try again.")}finally{o(null)}})(g.id),disabled:i===g.id,className:"bg-neutral-900 hover:bg-neutral-800 text-white self-start",children:[i===g.id&&(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Cancel request"]}),(0,se.jsxs)("div",{className:"flex gap-3 p-3 bg-amber-50 rounded-lg",children:[(0,se.jsx)("svg",{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,se.jsxs)("p",{className:"text-sm text-amber-900 leading-relaxed",children:["If your subscription is scheduled to renew during these ",e," days, the renewal will still occur unless you cancel the subscription manually before the renewal date"]})]})]})]})})():(0,se.jsxs)("div",{className:"pt-4 flex flex-col gap-4",children:[(0,se.jsxs)("p",{className:"text-sm text-slate-600 leading-relaxed",children:["Delete your account along with all associated data, settings, and activity.",(0,se.jsx)("br",{}),"You will have access to your account for 1 week after requesting deletion."]}),(0,se.jsxs)("button",{type:"button",onClick:()=>{x&&s?s({onConfirm:p,fetchRequests:h}):d(!0)},disabled:"create"===i,className:"self-start inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-lg border border-[#DC2626] text-[#DC2626] bg-white shadow-sm hover:bg-red-50 hover:border-[#B91C1C] hover:text-[#B91C1C] active:bg-red-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{touchAction:"manipulation"},children:["create"===i&&(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}),"Delete Account"]}),!x&&(0,se.jsx)(sJ,{isOpen:c,onOpenChange:d,onConfirm:p,isLoading:"create"===i})]})})]})]})}function nJ(e){var t,s;let{onFullScreenChange:a,onBackToTab:n}=e;const{user:l,updateUser:r}=wd(),i=qu(),[o,c]=(0,Y.useState)(!1),d=od(),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(!1),{hasFlag:f}=ej(),{activeWorkspace:v}=qd(),b=!0===(null==v?void 0:v.is_personal),j=Uj(l,"builder"),y=f(tj)&&b,N=f(ij),w=Bj(l),_=zj(l),[k,C]=(0,Y.useState)(!1),[A,S]=(0,Y.useState)(!1),[E,T]=(0,Y.useState)({email:"",fullName:"",phoneNumber:"",profileImageUrl:"",notificationPreference:"every_prompt",enableBackendFunctionsByDefault:!1,enableAgentsByDefault:!1,enableDevEnvironmentByDefault:!1,keyboardPreferences:{sendMessageShortcut:QZ,insertNewLineShortcut:XZ}});(0,Y.useEffect)(()=>{if(l){var e,t;const s=Bj(l),a=zj(l);T({email:l.email||"",fullName:l.full_name||"",phoneNumber:l.phone_number||"",profileImageUrl:l.profile_image_url||"",enableBackendFunctionsByDefault:s&&l.enable_backend_functions_by_default||!1,enableAgentsByDefault:l.enable_agents_by_default||!1,enableDevEnvironmentByDefault:a&&l.enable_dev_environment_by_default||!1,notificationPreference:l.notification_preference||"every_prompt",keyboardPreferences:{sendMessageShortcut:(null===(e=l.keyboard_preferences)||void 0===e?void 0:e.send_message)||QZ,insertNewLineShortcut:(null===(t=l.keyboard_preferences)||void 0===t?void 0:t.insert_new_line)||XZ}})}},[l]);const I=l&&(E.fullName!==(l.full_name||"")||E.phoneNumber!==(l.phone_number||"")||E.profileImageUrl!==(l.profile_image_url||"")||E.enableBackendFunctionsByDefault!==(w&&l.enable_backend_functions_by_default||!1)||E.enableAgentsByDefault!==(l.enable_agents_by_default||!1)||E.enableDevEnvironmentByDefault!==(_&&l.enable_dev_environment_by_default||!1)||E.notificationPreference!==(l.notification_preference||"every_prompt")||E.keyboardPreferences.sendMessageShortcut!==((null===(t=l.keyboard_preferences)||void 0===t?void 0:t.send_message)||QZ)||E.keyboardPreferences.insertNewLineShortcut!==((null===(s=l.keyboard_preferences)||void 0===s?void 0:s.insert_new_line)||XZ)),P=(e,t)=>{T(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))},L=()=>{m(!1),h(null),null==a||a(!1)},M=async()=>{if(null!=x&&x.onConfirm){g(!0);try{await x.onConfirm(),x.fetchRequests&&await x.fetchRequests(),m(!1),null==a||a(!1),h(null)}finally{g(!1)}}};return l?d&&u?(0,se.jsxs)("div",{className:"bg-white",children:[(0,se.jsxs)("div",{className:"px-4 py-4 bg-white border-b border-gray-200 flex items-center gap-2",children:[(0,se.jsx)("button",{onClick:L,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full flex-shrink-0",children:(0,se.jsx)(vs.A,{size:20})}),(0,se.jsx)("span",{className:"text-black text-lg font-semibold",children:"Delete Your Account"})]}),(0,se.jsxs)("div",{className:"px-5 py-6 space-y-6",children:[(0,se.jsx)(eJ,{}),(0,se.jsx)(tJ,{onCancel:L,onConfirm:M,isLoading:p})]})]}):(0,se.jsxs)("div",{className:"h-full flex flex-col",children:[(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,se.jsxs)("div",{className:"".concat(i?"px-5 pt-6":"px-6"," pb-6 md:px-8 md:pb-8 lg:px-10 lg:pb-10 space-y-8"),children:[(0,se.jsxs)("div",{className:"space-y-6",children:[!i&&(0,se.jsx)("div",{className:"space-y-3",children:(0,se.jsx)("div",{className:"text-black text-base font-semibold",children:"Account"})}),(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Email"}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)("input",{type:"email",value:E.email,disabled:!0,className:"w-full px-3 py-1.5 bg-zinc-100 rounded-md border border-gray-300 text-neutral-400 text-sm",placeholder:"No email set"})})]}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Full Name"}),(0,se.jsx)("div",{className:"flex-1",children:(0,se.jsx)("input",{type:"text",value:E.fullName,onChange:e=>P("fullName",e.target.value),className:"w-full px-3 py-1.5 bg-white rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter your full name",required:!0})})]}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Phone Number"}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsx)("input",{type:"tel",value:E.phoneNumber,onChange:e=>P("phoneNumber",e.target.value),className:"w-full px-3 py-1.5 bg-white rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter your phone number"}),(0,se.jsx)("div",{className:"text-gray-500 text-xs",children:"By entering your phone number, you agree to receive SMS notifications from us."})]})]}),(0,se.jsx)(qZ,{value:E.profileImageUrl,onChange:e=>P("profileImageUrl",e),userEmail:E.email,userFullName:E.fullName}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Default Backend Functions"}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(ei,{checked:E.enableBackendFunctionsByDefault,onCheckedChange:e=>P("enableBackendFunctionsByDefault",e),disabled:!w,className:"data-[state=checked]:bg-black"}),(0,se.jsx)("div",{className:"text-sm text-gray-700",children:"Enable backend functions for new apps by default"})]}),(0,se.jsx)("div",{className:"text-gray-500 text-xs",children:"When enabled, new apps will automatically have backend functions activated."}),!w&&(0,se.jsx)(zR,{})]})]}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Default Agents"}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(ei,{checked:E.enableAgentsByDefault,onCheckedChange:e=>P("enableAgentsByDefault",e),className:"data-[state=checked]:bg-black"}),(0,se.jsx)("div",{className:"text-sm text-gray-700",children:"Enable agents for new apps by default"})]}),(0,se.jsx)("div",{className:"text-gray-500 text-xs",children:"When enabled, new apps will automatically have agents enabled, allowing them to run autonomous tasks and use tools."})]})]}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Default Test Data"}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(ei,{checked:E.enableDevEnvironmentByDefault,onCheckedChange:e=>P("enableDevEnvironmentByDefault",e),disabled:!_,className:"data-[state=checked]:bg-black"}),(0,se.jsx)("div",{className:"text-sm text-gray-700",children:"Enable test data for new apps by default"})]}),(0,se.jsx)("div",{className:"text-gray-500 text-xs",children:"When enabled, new apps start with test data turned on so you can safely test changes without affecting live data."}),!_&&(0,se.jsx)("div",{className:"text-xs text-orange-600",children:"This feature requires Builder plan or higher."})]})]}),(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,se.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"API Key"}),(0,se.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"flex-1 h-10 px-3 py-2 bg-zinc-100 rounded-md border border-gray-300 flex items-center min-w-0",children:(0,se.jsx)("div",{className:"text-black text-sm font-mono truncate",children:l.api_key})}),(0,se.jsxs)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(l.api_key),S(!0),$.default.success("API key copied to clipboard!"),setTimeout(()=>S(!1),2e3)}catch(e){$.default.error("Failed to copy API key")}},className:"w-9 h-9 bg-white rounded-md border border-stone-300 flex items-center justify-center hover:bg-gray-50 transition-colors relative flex-shrink-0",title:"Copy API key",children:[(0,se.jsx)(ob.A,{size:16}),A&&(0,se.jsx)("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded",children:"Copied!"})]}),(0,se.jsxs)("button",{onClick:async()=>{C(!0);try{const e=await jd.regenerateApiKey(l.id);r(e),$.default.success("API key regenerated successfully!")}catch(e){$.default.error("Failed to regenerate API key: "+(e.detail||e.message||"Unknown error"))}finally{C(!1)}},disabled:k,className:"h-9 px-2 sm:px-4 py-1.5 bg-white rounded-md border border-stone-300 hover:bg-gray-50 transition-colors flex items-center gap-1 sm:gap-2 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",children:[(0,se.jsx)(Fx.A,{size:14,className:k?"animate-spin":""}),(0,se.jsx)("div",{className:"text-black text-xs sm:text-sm font-medium hidden sm:block",children:k?"Regenerating...":"Regenerate"}),(0,se.jsx)("div",{className:"text-black text-xs font-medium sm:hidden",children:k?"Regen...":"Regen"})]})]}),(0,se.jsx)("div",{className:"text-gray-500 text-xs",children:"Your API key provides access to your workspace. Do not share it with others."})]})]})]})]}),(0,se.jsx)("div",{className:"border-t border-gray-200"}),(0,se.jsx)(JZ,{values:{sendMessageShortcut:E.keyboardPreferences.sendMessageShortcut,insertNewLineShortcut:E.keyboardPreferences.insertNewLineShortcut,notificationPreference:E.notificationPreference},onChange:e=>{T(t=>(0,ue.A)((0,ue.A)({},t),{},{notificationPreference:e.notificationPreference,keyboardPreferences:{sendMessageShortcut:e.sendMessageShortcut,insertNewLineShortcut:e.insertNewLineShortcut}}))},disabled:o}),(0,se.jsx)(Ij,{enabled:y,hasRequiredPlan:j}),N&&(0,se.jsx)(aJ,{user:l,onShowDeleteConfirmation:e=>{let{onConfirm:t,fetchRequests:s}=e;h({onConfirm:t,fetchRequests:s}),m(!0),null==a||a(!0)}})]})}),I&&(0,se.jsxs)("div",{className:"flex-shrink-0 p-4 bg-white border-t border-gray-200 flex justify-end items-center gap-3",children:[(0,se.jsx)("button",{onClick:()=>{if(l){var e,t;const s=Bj(l),a=zj(l);T({email:l.email||"",fullName:l.full_name||"",phoneNumber:l.phone_number||"",profileImageUrl:l.profile_image_url||"",notificationPreference:l.notification_preference||"every_prompt",enableBackendFunctionsByDefault:s&&l.enable_backend_functions_by_default||!1,enableAgentsByDefault:l.enable_agents_by_default||!1,enableDevEnvironmentByDefault:a&&l.enable_dev_environment_by_default||!1,keyboardPreferences:{sendMessageShortcut:(null===(e=l.keyboard_preferences)||void 0===e?void 0:e.send_message)||QZ,insertNewLineShortcut:(null===(t=l.keyboard_preferences)||void 0===t?void 0:t.insert_new_line)||XZ}})}},disabled:o,className:"px-4 py-2 bg-white rounded-md border border-gray-300 hover:bg-gray-50 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,se.jsx)("button",{onClick:async()=>{c(!0);try{var e,t;const s=await jd.updateUser(l.id,{full_name:E.fullName.length>0?E.fullName:null,phone_number:(E.phoneNumber||"").length>0?E.phoneNumber:null,profile_image_url:(E.profileImageUrl||"").length>0?E.profileImageUrl:null,notification_preference:E.notificationPreference,enable_backend_functions_by_default:!!w&&E.enableBackendFunctionsByDefault,enable_agents_by_default:E.enableAgentsByDefault,enable_dev_environment_by_default:!!_&&E.enableDevEnvironmentByDefault,keyboard_preferences:{send_message:E.keyboardPreferences.sendMessageShortcut,insert_new_line:E.keyboardPreferences.insertNewLineShortcut}});r(s);const a=Bj(s),n=zj(s);T({email:s.email||"",fullName:s.full_name||"",phoneNumber:s.phone_number||"",profileImageUrl:s.profile_image_url||"",notificationPreference:s.notification_preference||"every_prompt",enableBackendFunctionsByDefault:a&&s.enable_backend_functions_by_default||!1,enableAgentsByDefault:s.enable_agents_by_default||!1,enableDevEnvironmentByDefault:n&&s.enable_dev_environment_by_default||!1,keyboardPreferences:{sendMessageShortcut:(null===(e=s.keyboard_preferences)||void 0===e?void 0:e.send_message)||QZ,insertNewLineShortcut:(null===(t=s.keyboard_preferences)||void 0===t?void 0:t.insert_new_line)||XZ}}),$.default.success("Account settings updated successfully!")}catch(s){$.default.error("Failed to update account settings: "+(s.detail||s.message||"Unknown error"))}finally{c(!1)}},disabled:o,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Saving...":"Save Changes"})]})]}):(0,se.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-gray-900"})})}function lJ(){return(0,se.jsxs)("div",{children:[(0,se.jsx)(CZ,{title:"Account settings",description:"Manage your personal account preferences and settings."}),(0,se.jsx)(nJ,{onFullScreenChange:()=>{},onBackToTab:()=>{}})]})}function rJ(e,t){const s=t||"basic-information";return"/workspace/".concat(e,"/settings/").concat(s)}function iJ(e,t,s){switch(e){case"basic-information":default:return(0,se.jsx)(AZ,{workspace:t,userRole:s});case"plan-billing":return(0,se.jsx)(LZ,{workspace:t,userRole:s});case"credit-usage":return(0,se.jsx)(FZ,{});case"seats-members":return(0,se.jsx)(OZ,{});case"auth-security":return(0,se.jsx)(UZ,{workspace:t,userRole:s});case"apps-configuration":return(0,se.jsx)(BZ,{workspace:t,userRole:s});case"integrations":return(0,se.jsx)(zZ,{workspace:t,userRole:s});case"analytics":return(0,se.jsx)(HZ,{workspace:t,userRole:s});case"account":return(0,se.jsx)(lJ,{})}}function oJ(e){let{workspace:t,userRole:s,isPlatformAdmin:a=!1,hasBuilderTier:n=!1}=e;return(0,Y.useMemo)(()=>{const e=function(e){return e?e.is_personal?"personal":e.is_enterprise?"enterprise":"shared":"personal"}(t),l="personal"===e,r="enterprise"===e,i=NR(s),o=!l&&i,c=r&&i,d=[];d.push({id:"basic-information",label:"Basic information",path:"basic-information"}),d.push({id:"plan-billing",label:"Plan and billing",path:"plan-billing"}),d.push({id:"credit-usage",label:"Credit Usage",path:"credit-usage"}),o&&(d.push({id:"seats-members",label:"Seats and members",path:"seats-members"}),d.push({id:"auth-security",label:"Auth and Security",path:"auth-security"})),o&&n&&d.push({id:"integrations",label:"Integrations",path:"integrations"}),c&&(d.push({id:"apps-configuration",label:"Apps Configuration",path:"apps-configuration"}),a&&d.push({id:"analytics",label:"Analytics",path:"analytics"}));return[{label:"Workspace",items:d},{label:"Account",items:[{id:"account",label:"Account settings",path:"account"}]}]},[t,s,a,n])}function cJ(e){let{sections:t,currentSection:s,workspaceId:a,isMobile:n=!1}=e;const l=(0,J.Zp)(),r=e=>{l("/workspace/".concat(a,"/settings/").concat(e))};return n?(0,se.jsxs)("div",{className:"flex flex-col h-full bg-stone-100",children:[(0,se.jsx)("div",{className:"px-6 py-6",children:(0,se.jsx)(R_,{size:"medium",className:"text-lg",children:"Settings"})}),(0,se.jsx)("nav",{className:"flex-1 px-6 pb-6 overflow-y-auto",children:(0,se.jsx)("div",{className:"flex flex-col gap-9",children:t.map(e=>(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsx)("div",{className:"py-3",children:(0,se.jsx)(__,{size:"tiny",className:"text-slate-500 font-normal",children:e.label})}),e.items.map(e=>(0,se.jsxs)("button",{onClick:()=>r(e.path),className:"flex items-center justify-between px-3 py-2 text-left hover:bg-neutral-100 rounded-md transition-colors",children:[(0,se.jsx)(__,{size:"small",children:e.label}),(0,se.jsx)(bs.A,{className:"h-4 w-4 text-muted-foreground"})]},e.id))]},e.label))})})]}):(0,se.jsxs)("div",{className:"w-60 flex-shrink-0 border-r border-neutral-200 bg-stone-100 flex flex-col h-full",children:[(0,se.jsx)("div",{className:"px-6 py-6",children:(0,se.jsx)(R_,{size:"medium",className:"text-lg",children:"Settings"})}),(0,se.jsx)("nav",{className:"flex-1 px-6 pb-6 overflow-y-auto",children:(0,se.jsx)("div",{className:"flex flex-col gap-9",children:t.map(e=>(0,se.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,se.jsx)("div",{className:"py-3",children:(0,se.jsx)(__,{size:"tiny",className:"text-slate-500 font-normal",children:e.label})}),e.items.map(e=>{const t=s===e.id;return(0,se.jsx)("button",{onClick:()=>r(e.path),className:de("px-3 py-2 rounded-md text-left transition-colors",t?"bg-neutral-200":"hover:bg-neutral-100"),children:(0,se.jsx)(__,{size:"small",weight:t?"normal":"thin",className:t?"text-neutral-900":void 0,children:e.label})},e.id)})]},e.label))})})]})}function dJ(e){var t;let{sections:s,currentSection:a,workspaceId:n,children:l,showMobileMenu:r=!1}=e;const i=(0,J.Zp)(),o=null===(t=s.flatMap(e=>e.items).find(e=>e.id===a))||void 0===t?void 0:t.label;return(0,se.jsxs)("div",{className:"min-h-screen bg-stone-100",children:[(0,se.jsx)("div",{className:"md:hidden sticky top-0 z-10 bg-white border-b border-neutral-200",children:!r&&(0,se.jsxs)("div",{className:"flex items-center gap-3 p-4",children:[(0,se.jsx)(Bx,{variant:"outline",size:"icon",onClick:()=>{i("/workspace/".concat(n,"/settings"))},className:"h-9 w-9 shrink-0","aria-label":"Back to settings menu",children:(0,se.jsx)(vs.A,{className:"h-4 w-4"})}),(0,se.jsx)(R_,{size:"medium",as:"h1",className:"text-lg leading-none",children:o||"Settings"})]})}),(0,se.jsxs)("div",{className:"flex h-full min-h-screen md:px-[60px]",children:[(0,se.jsx)("div",{className:"hidden md:block flex-shrink-0",children:(0,se.jsx)(cJ,{sections:s,currentSection:a,workspaceId:n})}),r&&(0,se.jsx)("div",{className:"md:hidden w-full",children:(0,se.jsx)(cJ,{sections:s,currentSection:a,workspaceId:n,isMobile:!0})}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto ".concat(r?"hidden md:block":""),children:(0,se.jsx)("div",{className:"px-4 py-6 md:p-9",children:l})})]})]})}const uJ=e=>{let{workspaceName:t}=e;const s=(0,J.Zp)();return(0,se.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,se.jsx)(Bv,{className:"max-w-md mx-auto",children:(0,se.jsxs)(Wv,{className:"flex flex-col items-center text-center py-8",children:[(0,se.jsx)(Vc.A,{className:"h-16 w-16 text-slate-400 mb-4"}),(0,se.jsx)(R_,{size:"large",as:"h2",className:"mb-2",children:"Access Restricted"}),(0,se.jsxs)(__,{secondary:!0,className:"mb-6 max-w-sm",children:["You don't have permission to access this section for"," ",(0,se.jsx)(__,{weight:"bold",tagName:"span",children:t}),"."," ","Only workspace administrators and owners can access this area."]}),(0,se.jsx)(Bx,{onClick:()=>s("/"),children:"Go to Home"})]})})})},mJ=e=>{let{workspace:t,userRole:s,sections:a,sectionName:n,showAccessRestricted:l=!1}=e;const r=(0,Y.useMemo)(()=>a.flatMap(e=>e.items.map(e=>e.id)),[a]),i=!n,o=n||"basic-information",c=r.includes(o);if(!c&&n){if(l)return(0,se.jsx)(dJ,{sections:a,currentSection:o,workspaceId:t.id,showMobileMenu:!1,children:(0,se.jsx)(uJ,{workspaceName:t.name||"this workspace"})});const e=r[0];if(e)return(0,se.jsx)(J.C5,{to:rJ(t.id,e),replace:!0})}if(!c){const e=r[0];if(e)return(0,se.jsx)(J.C5,{to:rJ(t.id,e),replace:!0})}return(0,se.jsx)(dJ,{sections:a,currentSection:o,workspaceId:t.id,showMobileMenu:i,children:iJ(o,t,s)})},xJ=e=>{let{workspace:t,sectionName:s}=e;const{userRole:a,currentUser:n,loading:l,error:r}=oK(),{user:i}=wd();NZ();const o=$p(null==i?void 0:i.platform_role),c=Vj(null==n?void 0:n.effective_tier),d=oJ({workspace:t,userRole:null!=a?a:yR.MEMBER,isPlatformAdmin:o,hasBuilderTier:c});return l?(0,se.jsx)("div",{className:"h-screen bg-stone-100",children:(0,se.jsx)(oL,{})}):r?(0,se.jsx)("div",{className:"h-screen flex items-center justify-center bg-stone-100",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(R_,{size:"small",as:"h2",className:"text-red-600",children:"Error loading workspace"}),(0,se.jsx)(__,{secondary:!0,className:"mt-2",children:r.message})]})}):(0,se.jsx)(mJ,{workspace:t,userRole:null!=a?a:yR.MEMBER,sections:d,sectionName:s})},hJ=e=>{var t,s;let{workspace:a,sectionName:n}=e;const{user:l}=wd(),r=null!==(t=null!==(s=a.user_role)&&void 0!==s?s:a.role)&&void 0!==t?t:yR.MEMBER,i=oJ({workspace:a,userRole:r,isPlatformAdmin:$p(null==l?void 0:l.platform_role),hasBuilderTier:!1});return(0,se.jsx)(mJ,{workspace:a,userRole:r,sections:i,sectionName:n,showAccessRestricted:!0})},pJ=e=>{let{workspace:t,sectionName:s}=e;const{user:a}=wd(),n=$p(null==a?void 0:a.platform_role),l=oJ({workspace:t,userRole:yR.OWNER,isPlatformAdmin:n,hasBuilderTier:!1});return(0,se.jsx)(mJ,{workspace:t,userRole:yR.OWNER,sections:l,sectionName:s})},gJ=()=>(0,se.jsx)("div",{className:"h-screen flex items-center justify-center bg-stone-100",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(R_,{size:"small",as:"h2",children:"Workspace not found"}),(0,se.jsx)(__,{secondary:!0,className:"mt-2",children:"The requested workspace could not be found or you don't have access."})]})}),fJ=e=>{let{sectionName:t}=e;const{currentWorkspace:s,loading:a,error:n}=oK();return a?(0,se.jsx)("div",{className:"h-screen bg-stone-100",children:(0,se.jsx)(oL,{})}):n||!s?(0,se.jsx)(gJ,{}):s.is_personal?(0,se.jsx)(pJ,{workspace:s,sectionName:t}):(0,se.jsx)(xJ,{workspace:s,sectionName:t})},vJ=()=>{var e;const{workspaceId:t,sectionName:s}=(0,J.g)(),{workspaces:a,isLoadingWorkspaces:n,activeWorkspace:l,switchActiveWorkspace:r}=qd(),{user:i}=wd(),o=$p(null==i?void 0:i.platform_role);if((0,Y.useEffect)(()=>{t&&(null==l?void 0:l.id)!==t&&r(t)},[t,null==l?void 0:l.id,r]),!t)return(0,se.jsx)(J.C5,{to:"/",replace:!0});if(n)return(0,se.jsx)("div",{className:"h-screen bg-stone-100",children:(0,se.jsx)(oL,{})});const c=null==a?void 0:a.find(e=>e.id===t);if(!c)return o?(0,se.jsx)(iK,{workspaceId:t,children:(0,se.jsx)(fJ,{sectionName:s})}):(0,se.jsx)(gJ,{});if(c.is_personal)return(0,se.jsx)(pJ,{workspace:c,sectionName:s});const d=null!==(e=c.user_role)&&void 0!==e?e:c.role;return NR(d)?(0,se.jsx)(iK,{workspaceId:t,children:(0,se.jsx)(xJ,{workspace:c,sectionName:s})}):(0,se.jsx)(hJ,{workspace:c,sectionName:s})};var bJ=s(58325);const jJ=()=>{var e,t,s,a;const[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)(!1),h=(0,J.zy)(),p=(0,J.Zp)(),{user:g,logout:f}=wd(),{switchActiveWorkspace:v,refetchWorkspaces:b}=qd(),j=new URLSearchParams(h.search).get("token");(0,Y.useEffect)(()=>{if(!j)return u("Invalid invitation link"),void i(!1);y()},[j]);const y=async()=>{try{const e=await Hd.getInvitationDetails(j);l(e)}catch(s){var e,t;404===(null===(e=s.response)||void 0===e?void 0:e.status)?u("Invitation not found"):410===(null===(t=s.response)||void 0===t?void 0:t.status)?u("This invitation has expired"):u("Failed to load invitation details")}finally{i(!1)}};return r?(0,se.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"flex items-center gap-3 text-slate-600",children:[(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin"}),(0,se.jsx)("span",{children:"Loading invitation..."})]})}):d?(0,se.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,se.jsxs)(Es,{className:"w-full max-w-md",children:[(0,se.jsxs)(Ts,{className:"text-center",children:[(0,se.jsx)("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,se.jsx)(ad.A,{className:"h-6 w-6 text-red-600"})}),(0,se.jsx)(Is,{className:"text-red-900",children:"Invitation Error"}),(0,se.jsx)(Ps,{className:"text-red-600",children:d})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)(zt,{onClick:()=>p("/"),className:"w-full",variant:"outline",children:"Go to Homepage"})})]})}):(0,se.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,se.jsxs)(Es,{className:"w-full max-w-lg",children:[(0,se.jsxs)(Ts,{className:"text-center",children:[(0,se.jsx)("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center mb-4",children:(0,se.jsx)(eb.A,{className:"h-8 w-8 text-white"})}),(0,se.jsx)(Is,{className:"text-2xl text-slate-900",children:"You're Invited!"}),(0,se.jsx)(Ps,{className:"text-slate-600",children:"Join your workspace and start collaborating"})]}),(0,se.jsxs)(Ls,{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 space-y-3",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(eb.A,{className:"h-5 w-5 text-slate-500"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"font-semibold text-slate-900",children:n.workspace.name}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:n.workspace.domain})]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Hc.A,{className:"h-5 w-5 text-slate-500"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Invited as"}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"font-medium text-slate-900",children:n.email}),(0,se.jsx)(gs,{className:(e=>{switch(e){case"owner":return"bg-purple-100 text-purple-800 hover:bg-purple-200";case"admin":return"bg-blue-100 text-blue-800 hover:bg-blue-200";case"member":return"bg-green-100 text-green-800 hover:bg-green-200";default:return"bg-slate-100 text-slate-800 hover:bg-slate-200"}})(n.role),children:n.role})]})]})]}),n.expires_at&&(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(H_.A,{className:"h-5 w-5 text-slate-500"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Expires"}),(0,se.jsx)("p",{className:"font-medium text-slate-900",children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})(n.expires_at)})]})]})]}),(null==n?void 0:n.requires_security_confirmation)&&(0,se.jsxs)(Dt,{className:"border-red-300 bg-red-50",children:[(0,se.jsx)(bJ.A,{className:"h-5 w-5 text-red-600"}),(0,se.jsx)(Ft,{className:"text-red-800 font-bold",children:"Security Warning - Unverified Workspace"}),(0,se.jsx)(Ot,{className:"text-red-700 mt-2",children:(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsx)("p",{className:"font-medium",children:"This workspace has SSO (Single Sign-On) enabled. Before accepting, please verify that you know and trust the person who invited you."}),(0,se.jsx)("p",{className:"text-sm",children:"Accepting invitations from unknown sources to SSO-enabled workspaces may pose security risks to your account."}),(0,se.jsxs)("div",{className:"flex items-center space-x-2 mt-2 p-3 bg-white rounded border border-red-200",children:[(0,se.jsx)(Os,{id:"security-confirm",checked:m,onCheckedChange:x,className:"border-red-400 data-[state=checked]:bg-red-600 data-[state=checked]:border-red-600"}),(0,se.jsx)("label",{htmlFor:"security-confirm",className:"text-sm font-medium text-red-800 cursor-pointer select-none",children:"I verify that I know and trust the workspace administrator who sent this invitation"})]})]})})]}),(null==g||null===(e=g.email)||void 0===e?void 0:e.toLowerCase())!==(null==n||null===(t=n.email)||void 0===t?void 0:t.toLowerCase())&&(0,se.jsxs)(Dt,{className:"border-amber-200 bg-amber-50",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-amber-600"}),(0,se.jsx)(Ot,{className:"text-amber-800",children:(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsxs)("div",{children:["This invitation was sent to ",(0,se.jsx)("strong",{children:n.email}),", but you're logged in as ",(0,se.jsx)("strong",{children:g.email}),". Please log in with the correct account to accept this invitation."]}),(0,se.jsx)(zt,{onClick:async()=>{try{await f(),$.toast.success("Logged out successfully. Please log in with the correct email address."),p("/login")}catch(e){$.toast.error("Failed to log out")}},size:"sm",className:"self-start bg-amber-600 hover:bg-amber-700 text-white",disabled:o,children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-3 w-3 animate-spin"}),"Logging out..."]}):"Logout & Login with Correct Email"})]})})]}),(null==g||null===(s=g.email)||void 0===s?void 0:s.toLowerCase())===(null==n||null===(a=n.email)||void 0===a?void 0:a.toLowerCase())&&(0,se.jsxs)("div",{className:"flex gap-3",children:[(0,se.jsx)(zt,{onClick:async()=>{var e,t;if((null==g||null===(e=g.email)||void 0===e?void 0:e.toLowerCase())===(null==n||null===(t=n.email)||void 0===t?void 0:t.toLowerCase())){c(!0);try{var s;const e=await Hd.acceptInvitation(j);await b(),null!==(s=e.workspace)&&void 0!==s&&s.id&&v(e.workspace.id),$.toast.success("Welcome to ".concat(e.workspace.name,"!")),p("/")}catch(r){var a,l;const e=(null===(a=r.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.detail)||r.message||"Failed to accept invitation";$.toast.error(e)}finally{c(!1)}}else $.toast.error("This invitation is for a different email address")},className:"flex-1 text-white ".concat(null!=n&&n.requires_security_confirmation?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700":"bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700"),disabled:o||(null==n?void 0:n.requires_security_confirmation)&&!m,children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Accepting..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(sd.A,{className:"mr-2 h-4 w-4"}),"Accept Invitation"]})}),(0,se.jsx)(zt,{onClick:async()=>{c(!0);try{await Hd.declineInvitation(j),$.toast.success("Invitation declined"),p("/")}catch(s){var e,t;const a=(null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||s.message||"Failed to decline invitation";$.toast.error(a)}finally{c(!1)}},variant:"outline",className:"flex-1 border-slate-300 text-slate-700 hover:bg-slate-50",disabled:o,children:o?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Declining..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Uy.A,{className:"mr-2 h-4 w-4"}),"Decline"]})})]}),(0,se.jsx)("div",{className:"text-center",children:(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"If you didn't expect this invitation, you can safely ignore it."})})]})]})})},yJ=()=>(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"absolute inset-0 pointer-events-none bg-white"}),(0,se.jsx)("div",{className:"absolute pointer-events-none",style:{width:"951px",height:"755px",bottom:"-480px",left:"50%",transform:"translateX(-50%) rotate(180deg)",background:"radial-gradient(\n                    ellipse at center,\n                    #FF5500 0%,\n                    #FFEAA6 50%,\n                    transparent 70%\n                )",filter:"blur(150px)"}})]}),NJ=e=>{let{title:t,messages:s}=e;const a=(0,J.Zp)();return(0,se.jsxs)("div",{className:"min-h-screen relative flex flex-col overflow-hidden",children:[(0,se.jsx)(yJ,{}),(0,se.jsx)("div",{className:"relative z-10 px-5 md:px-[60px] py-6",children:(0,se.jsx)(Z.Link,{to:"/",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",width:"114",height:"28"})})}),(0,se.jsx)("div",{className:"relative z-10 flex-1 flex items-center justify-center px-5 md:px-[130px]",children:(0,se.jsxs)("div",{className:"w-full max-w-[1024px] flex flex-col gap-6 text-center",children:[(0,se.jsx)(R_,{size:"extraLarge",as:"h1",className:"!font-medium !text-[#001e36] !text-[48px] md:!text-[80px] !leading-[1.36] tracking-[-1px]",children:t}),(0,se.jsx)("div",{className:"max-w-[671px] mx-auto",children:s.map((e,t)=>(0,se.jsx)(__,{tagName:"p",size:"medium",className:"!text-black !text-[18px] md:!text-[24px] !leading-8 !font-normal",children:e},t))}),(0,se.jsx)(Bx,{variant:"link",onClick:()=>a("/"),className:"font-base44 !text-black !text-[18px] md:!text-[24px] !underline hover:!text-slate-700 !leading-8 !font-normal !p-0",children:"Continue to your account \u2192"})]})})]})},wJ=()=>(0,se.jsx)(NJ,{title:"Invitation Has Expired",messages:["The transfer request you received is no longer valid.","Please Contact the sender to receive a new invite."]}),_J=e=>{let{message:t}=e;return(0,se.jsx)(NJ,{title:"Transfer Error",messages:[t]})},kJ=()=>(0,se.jsx)(se.Fragment,{children:(0,se.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(\n                    to bottom,\n                    #FFFFFF 0%,\n                    #D8DCEF 60%,\n                    #EFD8ED 80%,\n                    #F7C791 100%\n                )"}})}),CJ=()=>(0,se.jsxs)("div",{className:"min-h-screen relative flex flex-col overflow-hidden",children:[(0,se.jsx)(kJ,{}),(0,se.jsx)("div",{className:"relative z-10 px-5 md:px-[60px] py-6",children:(0,se.jsx)(Z.Link,{to:"/",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",width:"114",height:"28"})})}),(0,se.jsx)("div",{className:"relative z-10 flex-1 flex items-center justify-center",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin text-slate-600"}),(0,se.jsx)(__,{size:"medium",secondary:!0,children:"Loading transfer details..."})]})})]}),AJ=()=>{var e,t,s,a;const n=(0,J.zy)(),l=(0,J.Zp)(),{toast:r}=ao(),i=new URLSearchParams(n.search).get("token"),{data:o,isLoading:c,error:d}=Xd({query:()=>F_.getTransferDetails(i),enabled:!!i,logErrorMsg:"Failed to fetch transfer details"},[i]),{mutate:u,isLoading:m}=eu({mutate:()=>F_.acceptTransfer(i),onSuccess:e=>{r({title:"Ownership transferred!",description:"You are now the owner of ".concat(e.app_name)}),l("/apps/".concat(e.app_id,"/editor/workspace/users"))},onError:e=>{var t,s;r({title:"Error",description:(null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to accept transfer",variant:"destructive"})}}),x=410===(null==d||null===(e=d.response)||void 0===e?void 0:e.status)||"TRANSFER_EXPIRED"===(null==d||null===(t=d.response)||void 0===t||null===(s=t.data)||void 0===s||null===(a=s.extra_data)||void 0===a?void 0:a.error_code);if(!i)return(0,se.jsx)(_J,{message:"Invalid transfer link"});if(c)return(0,se.jsx)(CJ,{});if(x)return(0,se.jsx)(wJ,{});if(d&&!x){var h,p;const e=(null==d||null===(h=d.response)||void 0===h||null===(p=h.data)||void 0===p?void 0:p.message)||"Failed to load transfer details";return(0,se.jsx)(_J,{message:e})}return o?(0,se.jsxs)("div",{className:"min-h-screen relative flex flex-col overflow-hidden",children:[(0,se.jsx)(kJ,{}),(0,se.jsx)("div",{className:"relative z-10 px-5 md:px-[60px] py-6",children:(0,se.jsx)(Z.Link,{to:"/",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",width:"114",height:"28"})})}),(0,se.jsx)("div",{className:"relative z-10 flex-1 flex items-center justify-center p-4",children:(0,se.jsx)("div",{className:"w-full max-w-[450px]",children:(0,se.jsx)("div",{className:"bg-white border border-gray-200 rounded-[10px] shadow-md overflow-hidden",children:(0,se.jsx)("div",{className:"p-8 flex flex-col items-center",children:(0,se.jsxs)("div",{className:"flex flex-col gap-6 items-center w-full",children:[(0,se.jsxs)("div",{className:"flex flex-col gap-1.5 items-center text-center w-full",children:[(0,se.jsxs)(R_,{size:"large",as:"h1",className:"!text-3xl !font-medium !leading-9 text-gray-950 w-full",children:["Take ownership of ",o.app_name]}),(0,se.jsxs)(__,{size:"medium",secondary:!0,className:"w-full",children:[o.current_owner_email," has invited you to become the owner of ",o.app_name,"."]})]}),(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)("div",{className:"bg-blue-50 rounded-[10px] p-3 w-full",children:(0,se.jsx)(__,{size:"small",secondary:!0,className:"text-center block",children:"Once you accept this invitation, the app and all its data will appear under your account. Any future edits, updates, or app usage by end users will use credits from your account balance."})})}),(0,se.jsxs)("div",{className:"flex flex-col gap-3 items-center w-full",children:[(0,se.jsx)(Bx,{onClick:()=>u(void 0),className:"w-full bg-neutral-900 hover:bg-neutral-800 text-white h-10 rounded-lg shadow-sm",disabled:m,children:m?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"mr-1.5 h-4 w-4 animate-spin"}),"Accepting..."]}):"Accept Ownership"}),o.expires_at&&(0,se.jsxs)(__,{size:"small",secondary:!0,className:"font-light",children:["Invitation expires on ",(g=o.expires_at,new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))]})]})]})})})})})]}):null;var g},SJ={primary:"#0ea5e9",secondary:"#64748b",success:"#10b981",warning:"#f59e0b",danger:"#ef4444",purple:"#8b5cf6",teal:"#14b8a6",orange:"#f97316"},EJ=[SJ.primary,SJ.teal,SJ.purple,SJ.warning,SJ.orange,SJ.danger],TJ=e=>{let{title:t,value:s,description:a,icon:n,trend:l,color:r=SJ.primary}=e;return(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,se.jsx)(Is,{className:"text-sm font-medium",children:t}),(0,se.jsx)(n,{className:"h-4 w-4",style:{color:r}})]}),(0,se.jsxs)(Ls,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold",children:s}),a&&(0,se.jsx)("p",{className:"text-xs text-muted-foreground",children:a}),l&&(0,se.jsxs)("div",{className:"flex items-center text-xs mt-2",children:[(0,se.jsx)(Pf.A,{className:"h-3 w-3 mr-1",style:{color:l>0?SJ.success:SJ.danger}}),(0,se.jsxs)("span",{style:{color:l>0?SJ.success:SJ.danger},children:[Math.abs(l),"% from last period"]})]})]})]})},IJ=e=>{let{ticketClass:t}=e;return(0,se.jsxs)(Es,{className:"hover:shadow-lg transition-shadow",children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{className:"text-lg",children:t.class_name}),(0,se.jsx)(Ps,{children:t.description})]}),(0,se.jsxs)(Ls,{className:"space-y-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"Example Tickets:"}),(0,se.jsx)("ul",{className:"text-sm text-muted-foreground space-y-1",children:t.example_titles.slice(0,3).map((e,t)=>(0,se.jsxs)("li",{className:"line-clamp-1",children:["\u2022 ",e]},t))})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"Common Issues:"}),(0,se.jsx)("div",{className:"flex flex-wrap gap-1",children:t.common_issues.slice(0,3).map((e,t)=>(0,se.jsx)(gs,{variant:"secondary",className:"text-xs",children:e},t))})]}),t.suggested_improvements&&(0,se.jsxs)("div",{className:"pt-2 border-t",children:[(0,se.jsx)("h4",{className:"text-sm font-semibold mb-1 text-teal-700",children:"Suggested Improvements:"}),(0,se.jsx)("p",{className:"text-xs text-muted-foreground",children:t.suggested_improvements})]}),(0,se.jsxs)("div",{className:"text-xs text-muted-foreground",children:[t.ticket_ids.length," tickets in this category"]})]})]})};function PJ(){const[e,t]=(0,Y.useState)(!0),[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(null),[m,x]=(0,Y.useState)({preset:"last7days",startDate:He()().subtract(7,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()}),[h,p]=(0,Y.useState)(null),g=[{value:"today",label:"Today",getDates:()=>({startDate:He()().startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"yesterday",label:"Yesterday",getDates:()=>({startDate:He()().subtract(1,"day").startOf("day").toISOString(),endDate:He()().subtract(1,"day").endOf("day").toISOString()})},{value:"last2days",label:"Last 2 Days",getDates:()=>({startDate:He()().subtract(2,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"last3days",label:"Last 3 Days",getDates:()=>({startDate:He()().subtract(3,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"last7days",label:"Last 7 Days",getDates:()=>({startDate:He()().subtract(7,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"last14days",label:"Last 14 Days",getDates:()=>({startDate:He()().subtract(14,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"last30days",label:"Last 30 Days",getDates:()=>({startDate:He()().subtract(30,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"last60days",label:"Last 60 Days",getDates:()=>({startDate:He()().subtract(60,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"last90days",label:"Last 90 Days",getDates:()=>({startDate:He()().subtract(90,"days").startOf("day").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"thisWeek",label:"This Week",getDates:()=>({startDate:He()().startOf("week").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"lastWeek",label:"Last Week",getDates:()=>({startDate:He()().subtract(1,"week").startOf("week").toISOString(),endDate:He()().subtract(1,"week").endOf("week").toISOString()})},{value:"thisMonth",label:"This Month",getDates:()=>({startDate:He()().startOf("month").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"lastMonth",label:"Last Month",getDates:()=>({startDate:He()().subtract(1,"month").startOf("month").toISOString(),endDate:He()().subtract(1,"month").endOf("month").toISOString()})},{value:"thisQuarter",label:"This Quarter",getDates:()=>({startDate:He()().startOf("quarter").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"lastQuarter",label:"Last Quarter",getDates:()=>({startDate:He()().subtract(1,"quarter").startOf("quarter").toISOString(),endDate:He()().subtract(1,"quarter").endOf("quarter").toISOString()})},{value:"thisYear",label:"This Year",getDates:()=>({startDate:He()().startOf("year").toISOString(),endDate:He()().endOf("day").toISOString()})},{value:"lastYear",label:"Last Year",getDates:()=>({startDate:He()().subtract(1,"year").startOf("year").toISOString(),endDate:He()().subtract(1,"year").endOf("year").toISOString()})}];(0,Y.useEffect)(()=>{f()},[m]);const f=async()=>{try{t(!0),u(null);const e=await sY.getOperationalMetrics(m.startDate,m.endDate);i(e)}catch(e){u("Failed to load analytics data")}finally{t(!1)}},v=e=>e?e<1?"".concat(Math.round(60*e),"m"):e<24?"".concat(e.toFixed(1),"h"):"".concat(Math.round(e/24),"d"):"N/A",b=r?Object.entries(r.tickets_by_category).map(e=>{let[t,s]=e;return{name:"uncategorized"===t?"Uncategorized":t.replace(/_/g," "),value:s}}):[],j=r?Object.entries(r.tickets_by_user_tier).map(e=>{let[t,s]=e;return{name:"unknown"===t?"Unknown":t,value:s}}):[],y=(null==r?void 0:r.busiest_days)||[],N=(null==r?void 0:r.tickets_by_hour)||[];return e?(0,se.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):d?(0,se.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,se.jsxs)(Es,{className:"p-6",children:[(0,se.jsxs)("div",{className:"flex items-center space-x-2 text-red-600",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5"}),(0,se.jsx)("p",{children:d})]}),(0,se.jsx)(zt,{onClick:f,className:"mt-4",children:"Retry"})]})}):(0,se.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Support Analytics"}),(0,se.jsx)("p",{className:"text-muted-foreground mt-1",children:"Analyze support ticket trends and performance metrics"}),(0,se.jsxs)("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1",children:[(0,se.jsx)(H_.A,{className:"h-3 w-3"}),He()(m.startDate).format("MMM DD, YYYY")," - ",He()(m.endDate).format("MMM DD, YYYY")]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsxs)(br,{value:m.preset,onValueChange:e=>{const t=g.find(t=>t.value===e);if(t){const s=t.getDates();x((0,ue.A)({preset:e},s))}},children:[(0,se.jsxs)(Nr,{className:"w-[200px]",children:[(0,se.jsx)(H_.A,{className:"h-4 w-4 mr-2"}),(0,se.jsx)(yr,{})]}),(0,se.jsxs)(kr,{className:"max-h-[400px]",children:[(0,se.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Quick Ranges"}),g.slice(0,9).map(e=>(0,se.jsx)(Ar,{value:e.value,children:e.label},e.value)),(0,se.jsx)("div",{className:"my-1 h-px bg-border"}),(0,se.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Weekly/Monthly"}),g.slice(9,13).map(e=>(0,se.jsx)(Ar,{value:e.value,children:e.label},e.value)),(0,se.jsx)("div",{className:"my-1 h-px bg-border"}),(0,se.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Quarterly/Yearly"}),g.slice(13).map(e=>(0,se.jsx)(Ar,{value:e.value,children:e.label},e.value))]})]}),(0,se.jsxs)(zt,{onClick:async()=>{try{a(!0),await sY.exportTicketsCSV(m.startDate,m.endDate,h)}catch(e){alert("Failed to export tickets")}finally{a(!1)}},disabled:s,variant:"outline",children:[s?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,se.jsx)(aL.A,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]}),(0,se.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,se.jsx)(TJ,{title:"Total Tickets",value:(null==r?void 0:r.total_tickets)||0,description:"".concat((null==r?void 0:r.open_tickets)||0," open, ").concat((null==r?void 0:r.resolved_tickets)||0," resolved"),icon:Xx.A,color:SJ.primary}),(0,se.jsx)(TJ,{title:"Avg Response Time",value:v(null==r?void 0:r.avg_response_time_hours),description:"First admin response",icon:jS.A,color:SJ.teal}),(0,se.jsx)(TJ,{title:"Avg Resolution Time",value:v(null==r?void 0:r.avg_resolution_time_hours),description:"Time to resolve tickets",icon:sd.A,color:SJ.success}),(0,se.jsx)(TJ,{title:"Pending Admin Response",value:(null==r?void 0:r.tickets_pending_admin_response)||0,description:"".concat((null==r?void 0:r.tickets_pending_user_response)||0," pending user response"),icon:ad.A,color:SJ.warning})]}),(0,se.jsxs)(ji,{defaultValue:"overview",className:"space-y-4",children:[(0,se.jsxs)(yi,{children:[(0,se.jsx)(Ni,{value:"overview",children:"Overview"}),(0,se.jsx)(Ni,{value:"trends",children:"AI Trend Analysis"}),(0,se.jsx)(Ni,{value:"performance",children:"Performance"})]}),(0,se.jsxs)(wi,{value:"overview",className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Tickets by Category"}),(0,se.jsx)(Ps,{children:"Distribution of support tickets across categories"})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(fA.r,{children:[(0,se.jsx)(vA.F,{data:b,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:e=>{let{name:t,percent:s}=e;return"".concat(t," ").concat((100*s).toFixed(0),"%")},children:b.map((e,t)=>(0,se.jsx)(bA.f,{fill:EJ[t%EJ.length]},"cell-".concat(t)))}),(0,se.jsx)(aA.m,{})]})})})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Tickets by User Tier"}),(0,se.jsx)(Ps,{children:"Support requests by subscription tier"})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(xA.E,{data:j,children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"name"}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{}),(0,se.jsx)(hA.y,{dataKey:"value",fill:SJ.purple})]})})})})]})]}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Ticket Volume Over Time"}),(0,se.jsx)(Ps,{children:"Daily ticket creation trends"})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(QC.Q,{data:y,children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"date",tickFormatter:e=>He()(e).format("MMM DD")}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{labelFormatter:e=>He()(e).format("MMMM DD, YYYY")}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"count",stroke:SJ.primary,fill:SJ.primary,fillOpacity:.3,name:"Tickets"})]})})})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Tickets by Hour of Day"}),(0,se.jsx)(Ps,{children:"When support tickets are typically created"})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"h-[300px]",children:(0,se.jsx)(JC.u,{width:"100%",height:"100%",children:(0,se.jsxs)(xA.E,{data:N,children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3"}),(0,se.jsx)(eA.W,{dataKey:"label",angle:-45,textAnchor:"end",height:60}),(0,se.jsx)(tA.h,{}),(0,se.jsx)(aA.m,{labelFormatter:e=>"Hour: ".concat(e),formatter:e=>["".concat(e," tickets"),"Count"]}),(0,se.jsx)(hA.y,{dataKey:"count",fill:SJ.teal,radius:[4,4,0,0]})]})})})})]})]}),(0,se.jsx)(wi,{value:"trends",className:"space-y-4",children:(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsxs)(Is,{className:"flex items-center gap-2",children:[(0,se.jsx)(_P.A,{className:"h-5 w-5 text-purple-500"}),"AI-Powered Trend Analysis"]}),(0,se.jsx)(Ps,{children:"Use AI to identify patterns and group similar tickets"})]}),(0,se.jsxs)(Ls,{children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,se.jsxs)(br,{value:h||"all",onValueChange:e=>p("all"===e?null:e),children:[(0,se.jsx)(Nr,{className:"w-[200px]",children:(0,se.jsx)(yr,{placeholder:"Filter by category"})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"all",children:"All Categories"}),(0,se.jsx)(Ar,{value:"authentication",children:"Authentication"}),(0,se.jsx)(Ar,{value:"billing",children:"Billing"}),(0,se.jsx)(Ar,{value:"bug_report",children:"Bug Reports"}),(0,se.jsx)(Ar,{value:"integrations_and_backend_functions",children:"Integrations"}),(0,se.jsx)(Ar,{value:"chat_issues",children:"Chat Issues"}),(0,se.jsx)(Ar,{value:"security",children:"Security"}),(0,se.jsx)(Ar,{value:"other",children:"Other"})]})]}),(0,se.jsx)(zt,{onClick:async()=>{try{l(!0),c(null);const e=await sY.runTrendAnalysis(m.startDate,m.endDate,h);c(e)}catch(e){alert("Failed to run trend analysis")}finally{l(!1)}},disabled:n,children:n?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin mr-2"}),"Analyzing..."]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(GP.A,{className:"h-4 w-4 mr-2"}),"Run Analysis"]})})]}),o&&(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,se.jsx)("h3",{className:"font-semibold mb-2",children:"Analysis Summary"}),(0,se.jsx)("p",{className:"text-sm text-muted-foreground",children:o.analysis_summary}),(0,se.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Analyzed ",o.total_tickets_analyzed," tickets"]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold mb-3",children:"Identified Ticket Classes"}),(0,se.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:o.ticket_classes.map((e,t)=>(0,se.jsx)(IJ,{ticketClass:e},t))})]}),o.recommendations&&o.recommendations.length>0&&(0,se.jsxs)("div",{className:"bg-teal-50 p-4 rounded-lg",children:[(0,se.jsx)("h3",{className:"font-semibold mb-2 text-teal-900",children:"Strategic Recommendations"}),(0,se.jsx)("ul",{className:"space-y-2",children:o.recommendations.map((e,t)=>(0,se.jsxs)("li",{className:"text-sm text-teal-800 flex items-start",children:[(0,se.jsx)("span",{className:"text-teal-600 mr-2",children:"\u2022"}),e]},t))})]})]}),!o&&!n&&(0,se.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,se.jsx)(GP.A,{className:"h-12 w-12 mx-auto mb-3 text-slate-300"}),(0,se.jsx)("p",{children:'Click "Run Analysis" to generate AI insights'})]})]})]})}),(0,se.jsx)(wi,{value:"performance",className:"space-y-4",children:(0,se.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Tickets by Assignee"}),(0,se.jsx)(Ps,{children:"Workload distribution across team members"})]}),(0,se.jsx)(Ls,{children:(0,se.jsx)("div",{className:"space-y-3",children:r&&Object.entries(r.tickets_by_assignee).map(e=>{let[t,s]=e;return(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(eb.A,{className:"h-4 w-4 text-muted-foreground"}),(0,se.jsx)("span",{className:"text-sm",children:"unassigned"===t?"Unassigned":t})]}),(0,se.jsx)(gs,{variant:"unassigned"===t?"secondary":"default",children:s})]},t)})})})]}),(0,se.jsxs)(Es,{children:[(0,se.jsxs)(Ts,{children:[(0,se.jsx)(Is,{children:"Response Status"}),(0,se.jsx)(Ps,{children:"Current pending responses breakdown"})]}),(0,se.jsx)(Ls,{children:(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(ad.A,{className:"h-5 w-5 text-orange-600"}),(0,se.jsx)("span",{className:"font-medium",children:"Pending Admin"})]}),(0,se.jsx)("span",{className:"text-2xl font-bold text-orange-600",children:(null==r?void 0:r.tickets_pending_admin_response)||0})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(jS.A,{className:"h-5 w-5 text-blue-600"}),(0,se.jsx)("span",{className:"font-medium",children:"Pending User"})]}),(0,se.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:(null==r?void 0:r.tickets_pending_user_response)||0})]})]})})]})]})})]})]})}const LJ=[{label:"English",value:"en"},{label:"Deutsch",value:"de"},{label:"Espa\xf1ol",value:"es"},{label:"Fran\xe7ais",value:"fr"},{label:"Italiano",value:"it"},{label:"\u65e5\u672c\u8a9e",value:"ja"},{label:"\u4e2d\u6587",value:"zh"},{label:"\u0939\u093f\u0928\u094d\u0926\u0940",value:"hi"},{label:"Portugu\xeas",value:"pt"},{label:"\u05e2\u05d1\u05e8\u05d9\u05ea",value:"he"},{label:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",value:"ar"},{label:"Bahasa Indonesia",value:"id"}];function MJ(){var e,t,s;const{user:a}=wd(),[n,l]=(0,Y.useState)([]),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)({key:"created_date",direction:"desc"}),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)({}),[g,f]=(0,Y.useState)({}),[v,b]=(0,Y.useState)(new Set),[j,y]=(0,Y.useState)("all"),[N,w]=(0,Y.useState)("en"),[_,k]=(0,Y.useState)("all"),[C,A]=(0,Y.useState)("all"),[S,E]=(0,Y.useState)(""),[T,I]=(0,Y.useState)(""),[P,L]=(0,Y.useState)(1),[M,R]=(0,Y.useState)(0),D=100,[F,O]=(0,Y.useState)(!1),[U,B]=(0,Y.useState)([]),[z,H]=(0,Y.useState)(!1),[V,W]=(0,Y.useState)({isOpen:!1,action:null,item:null}),[q,G]=(0,Y.useState)(""),[K,$]=(0,Y.useState)("en"),[Z,J]=(0,Y.useState)({isOpen:!1,imageUrl:"",imageAlt:""}),[Q,X]=(0,Y.useState)({}),[ee,te]=(0,Y.useState)({}),[ae,ne]=(0,Y.useState)({}),[le,re]=(0,Y.useState)({});(0,Y.useEffect)(()=>{ie()},[]),(0,Y.useEffect)(()=>{if(m&&clearTimeout(m),1===P)return x(setTimeout(()=>{ie()},500)),()=>{m&&clearTimeout(m)};L(1)},[o,j,N,_,C,S,T,d]),(0,Y.useEffect)(()=>{ie()},[P]);const ie=async()=>{i(!0);try{let e={visibility_scope:"public"};if(o&&(e.$or=[{name:{$regex:o,$options:"i"}},{description:{$regex:o,$options:"i"}},{categories:{$regex:o,$options:"i"}},{created_by:{$regex:o,$options:"i"}}]),j&&"all"!==j&&("has_pending_update"===j?e.pending_snapshot_id={$ne:null}:"pending_resubmission"===j?(e.status="pending",e._filter_resubmission=!0):e.status=j),N&&("en"===N?o?(e.$and=[e.$or?{$or:e.$or}:{},{$or:[{language:"en"},{language:{$exists:!1}},{language:null}]}],delete e.$or):e.$or=[{language:"en"},{language:{$exists:!1}},{language:null}]:e.language=N),_&&"all"!==_&&(e.is_paid="paid"===_),"all"!==C){const t=He()();let s;switch(C){case"today":s=t.clone().startOf("day"),e.created_at={$gte:s.toISOString()};break;case"week":s=t.clone().subtract(7,"days").startOf("day"),e.created_at={$gte:s.toISOString()};break;case"month":s=t.clone().subtract(30,"days").startOf("day"),e.created_at={$gte:s.toISOString()};break;case"custom":S&&T?e.created_at={$gte:He()(S).startOf("day").toISOString(),$lte:He()(T).endOf("day").toISOString()}:S?e.created_at={$gte:He()(S).startOf("day").toISOString()}:T&&(e.created_at={$lte:He()(T).endOf("day").toISOString()})}}const t=await Gg.listCatalogItems((0,ue.A)((0,ue.A)({},e),{},{limit:D,skip:(P-1)*D,sort_by:"desc"===d.direction?"-".concat(d.key):d.key})),s=t.items||t;l(s),s.length<D?R((P-1)*D+s.length):R(P*D+1)}catch(e){so({title:"Error",description:"Failed to load catalog items",variant:"destructive"})}finally{i(!1)}},oe=(e,t)=>{$(t.item.language||"en"),W({isOpen:!0,action:e,item:t})},ce=()=>{W({isOpen:!1,action:null,item:null}),G("")},de=(e,t)=>{J({isOpen:!0,imageUrl:e,imageAlt:t})},me=e=>{const t=d.key===e&&"asc"===d.direction?"desc":"asc";u({key:e,direction:t}),L(1)},xe=async e=>{if(!Q[e]&&!ee[e]){te(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!0}));try{const t=await Gg.getPendingChanges(e);X(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t}))}catch(t){}finally{te(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!1}))}}},he=async(e,t)=>{const s="".concat(e,"-").concat(t?"pending":"approved");ne(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:!0}));try{const a=await Gg.cloneFromSnapshot(e,t);re(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:{id:a.id,name:a.name}})),so({title:"Clone Created",description:"Successfully cloned ".concat(t?"pending":"approved"," version")})}catch(l){var a,n;so({title:"Clone Failed",description:(null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail)||"Failed to clone from snapshot",variant:"destructive"})}finally{ne(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:!1}))}},pe=()=>"all"!==j||"en"!==N||"all"!==_||"all"!==C||""!==o||""!==S||""!==T,ge=e=>{const t=LJ.find(t=>t.value===e);return t?t.label:e},fe=e=>{switch(e){case"approved":return(0,se.jsxs)(gk,{className:"bg-emerald-100 text-emerald-700 border-emerald-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1.5"}),"Approved"]});case"pending":return(0,se.jsxs)(gk,{className:"bg-amber-100 text-amber-700 border-amber-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)(jS.A,{className:"w-3 h-3 mr-1.5"}),"Pending"]});case"rejected":return(0,se.jsxs)(gk,{className:"bg-red-100 text-red-700 border-red-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),"Rejected"]});case"archived":return(0,se.jsxs)(gk,{className:"bg-gray-100 text-gray-700 border-gray-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)(tB.A,{className:"w-3 h-3 mr-1.5"}),"Archived"]});default:return(0,se.jsx)(gk,{variant:"secondary",className:"font-medium px-2.5 py-0.5 text-xs",children:e})}};return $p(null==a?void 0:a.platform_role)?(0,se.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold",children:"App Templates Management"}),(0,se.jsxs)(Bx,{onClick:()=>F?O(!1):(async()=>{H(!0);try{const e=await Gg.listCatalogItems({limit:1e4,skip:0,sort_by:"-created_date"}),t=e.items||e;B(t),O(!0)}catch(e){so({title:"Error",description:"Failed to fetch analytics data",variant:"destructive"})}finally{H(!1)}})(),disabled:z,className:"flex items-center gap-2",variant:F?"default":"outline",children:[(0,se.jsx)(GP.A,{className:"h-4 w-4"}),z?"Analyzing...":F?"Hide Analytics":"Analyze"]})]}),F&&U.length>0&&(0,se.jsxs)("div",{className:"mb-8 bg-gradient-to-br from-slate-50 to-white p-8 rounded-2xl border border-slate-200 shadow-lg",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"p-2 bg-blue-100 rounded-xl",children:(0,se.jsx)(GP.A,{className:"h-6 w-6 text-blue-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Analytics Dashboard"}),(0,se.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:["Real-time insights across ",U.length," catalog items"]})]})]}),(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>O(!1),className:"h-10 w-10 p-0 hover:bg-slate-100 rounded-xl",children:(0,se.jsx)(la.A,{className:"h-5 w-5 text-slate-400"})})]}),(()=>{const e=(e=>{const t={total:e.length,approved:e.filter(e=>"approved"===e.item.status).length,pending:e.filter(e=>"pending"===e.item.status).length,rejected:e.filter(e=>"rejected"===e.item.status).length,archived:e.filter(e=>e.item.archived).length},s=e.reduce((e,t)=>{const s=t.item.language||"en";return e[s]=(e[s]||0)+1,e},{}),a={totalUsage:e.reduce((e,t)=>e+(t.item.usage_count||0),0),averageUsage:e.length?e.reduce((e,t)=>e+(t.item.usage_count||0),0)/e.length:0,topUsage:Math.max(...e.map(e=>e.item.usage_count||0),0),zeroUsage:e.filter(e=>0===(e.item.usage_count||0)).length},n={withDescriptions:e.filter(e=>e.item.description&&e.item.description.trim()).length,withScreenshots:e.filter(e=>e.item.screenshot_urls&&e.item.screenshot_urls.length>0).length,publicApps:e.filter(e=>!e.item.is_private).length,privateApps:e.filter(e=>e.item.is_private).length},l=e.reduce((e,t)=>{var s;const a=(null===(s=t.item_creator)||void 0===s?void 0:s.full_name)||"Unknown";return e[a]=(e[a]||0)+1,e},{}),r=e.reduce((e,t)=>{var s;return null===(s=t.item.categories)||void 0===s||s.forEach(t=>{e[t]=(e[t]||0)+1}),e},{}),i=He()(),o=e.filter(e=>He()(e.item.created_date).isSame(i,"month")).length,c=e.filter(e=>He()(e.item.created_date).isSame(i,"quarter")).length;return{statusStats:t,languageStats:s,usageStats:a,contentStats:n,creatorStats:Object.entries(l).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,10),categories:Object.entries(r).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,10),temporalStats:{thisMonth:o,thisQuarter:c,totalCreators:Object.keys(l).length}}})(U);return(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-emerald-100 rounded-lg",children:(0,se.jsx)(_P.A,{className:"h-5 w-5 text-emerald-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Status Overview"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Approval pipeline health"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"text-center p-4 bg-slate-50 rounded-lg",children:[(0,se.jsx)("div",{className:"text-3xl font-bold text-slate-900",children:e.statusStats.total}),(0,se.jsx)("div",{className:"text-sm text-slate-600 font-medium",children:"Total Apps"})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-emerald-700",children:"Approved"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-emerald-700",children:[e.statusStats.approved," (",(e.statusStats.approved/e.statusStats.total*100).toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-emerald-100 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-emerald-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.statusStats.approved/e.statusStats.total*100,"%")}})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-amber-700",children:"Pending"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-amber-700",children:[e.statusStats.pending," (",(e.statusStats.pending/e.statusStats.total*100).toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-amber-100 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-amber-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.statusStats.pending/e.statusStats.total*100,"%")}})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-red-700",children:"Rejected"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-red-700",children:[e.statusStats.rejected," (",(e.statusStats.rejected/e.statusStats.total*100).toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-red-100 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.statusStats.rejected/e.statusStats.total*100,"%")}})})]})]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,se.jsx)(ob.A,{className:"h-5 w-5 text-blue-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Usage Analytics"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Clone and adoption metrics"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.usageStats.totalUsage.toLocaleString()}),(0,se.jsx)("div",{className:"text-xs text-blue-700 font-medium",children:"Total Clones"})]}),(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-indigo-900",children:e.usageStats.averageUsage.toFixed(1)}),(0,se.jsx)("div",{className:"text-xs text-indigo-700 font-medium",children:"Avg per App"})]})]}),(0,se.jsxs)("div",{className:"p-4 bg-slate-50 rounded-lg border-l-4 border-green-500",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Top Performer"}),(0,se.jsx)("span",{className:"text-lg font-bold text-green-600",children:e.usageStats.topUsage.toLocaleString()})]}),(0,se.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:"Most cloned app"})]}),(0,se.jsxs)("div",{className:"p-4 bg-orange-50 rounded-lg border-l-4 border-orange-500",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Zero Usage"}),(0,se.jsx)("span",{className:"text-lg font-bold text-orange-600",children:e.usageStats.zeroUsage})]}),(0,se.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:[e.statusStats.total>0?(e.usageStats.zeroUsage/e.statusStats.total*100).toFixed(1):0,"% of total apps"]})]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,se.jsx)(lA.A,{className:"h-5 w-5 text-purple-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Content Quality"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Completeness metrics"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"With Descriptions"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[(e.contentStats.withDescriptions/e.statusStats.total*100).toFixed(1),"%"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.contentStats.withDescriptions/e.statusStats.total*100,"%")}})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"With Screenshots"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[(e.contentStats.withScreenshots/e.statusStats.total*100).toFixed(1),"%"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.contentStats.withScreenshots/e.statusStats.total*100,"%")}})})]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[(0,se.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg border border-green-200",children:[(0,se.jsx)("div",{className:"text-xl font-bold text-green-700",children:e.contentStats.publicApps}),(0,se.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"Public"})]}),(0,se.jsxs)("div",{className:"text-center p-3 bg-orange-50 rounded-lg border border-orange-200",children:[(0,se.jsx)("div",{className:"text-xl font-bold text-orange-700",children:e.contentStats.privateApps}),(0,se.jsx)("div",{className:"text-xs text-orange-600 font-medium",children:"Private"})]})]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-teal-100 rounded-lg",children:(0,se.jsx)(KP.A,{className:"h-5 w-5 text-teal-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Language Distribution"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Global reach insights"})]})]}),(0,se.jsx)("div",{className:"space-y-3",children:Object.entries(e.languageStats).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,6).map((t,s)=>{let[a,n]=t;const l=n/e.statusStats.total*100;return(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:ge(a)}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[n," (",l.toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"".concat(["bg-blue-500","bg-green-500","bg-purple-500","bg-orange-500","bg-pink-500","bg-indigo-500"][s]," h-2 rounded-full transition-all duration-500"),style:{width:"".concat(l,"%")}})})]},a)})})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-rose-100 rounded-lg",children:(0,se.jsx)(eb.A,{className:"h-5 w-5 text-rose-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Top Creators"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Most active contributors"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-rose-50 to-rose-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-rose-900",children:e.temporalStats.totalCreators}),(0,se.jsx)("div",{className:"text-xs text-rose-700 font-medium",children:"Total Creators"})]}),(0,se.jsx)("div",{className:"space-y-3",children:e.creatorStats.slice(0,5).map((e,t)=>{let[s,a]=e;return(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:t+1}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700 truncate max-w-24",children:s})]}),(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:"text-right",children:[(0,se.jsx)("div",{className:"text-sm font-bold text-slate-900",children:a}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"apps"})]})})]},s)})})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-cyan-100 rounded-lg",children:(0,se.jsx)(H_.A,{className:"h-5 w-5 text-cyan-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Recent Activity"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Growth and trends"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,se.jsxs)("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-green-700",children:"This Month"}),(0,se.jsx)("span",{className:"text-xl font-bold text-green-900",children:e.temporalStats.thisMonth})]}),(0,se.jsx)("div",{className:"text-xs text-green-600 mt-1",children:"new submissions"})]}),(0,se.jsxs)("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg border border-blue-200",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"This Quarter"}),(0,se.jsx)("span",{className:"text-xl font-bold text-blue-900",children:e.temporalStats.thisQuarter})]}),(0,se.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"total submissions"})]})]}),e.categories.length>0&&(0,se.jsxs)("div",{className:"p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-purple-700 mb-2",children:"Most Popular Category"}),(0,se.jsx)("div",{className:"text-lg font-bold text-purple-900",children:e.categories[0][0]}),(0,se.jsxs)("div",{className:"text-xs text-purple-600 mt-1",children:[e.categories[0][1]," apps in this category"]})]})]})]})]})})()]}),(0,se.jsxs)("div",{className:"mb-8 space-y-4",children:[(0,se.jsx)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3 items-start lg:items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center flex-1",children:[(0,se.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,se.jsx)(Df,{placeholder:"Search apps, creators, categories...",className:"pl-10 h-9 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-200",value:o,onChange:e=>c(e.target.value)})]}),(0,se.jsxs)(Wf,{value:j,onValueChange:y,children:[(0,se.jsx)(Yf,{className:"w-40 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(_P.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(qf,{placeholder:"Status"})]})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Status"}),(0,se.jsx)(Zf,{value:"pending",children:"Pending"}),(0,se.jsx)(Zf,{value:"pending_resubmission",children:"Pending (Resubmission)"}),(0,se.jsx)(Zf,{value:"approved",children:"Approved"}),(0,se.jsx)(Zf,{value:"rejected",children:"Rejected"}),(0,se.jsx)(Zf,{value:"archived",children:"Archived"}),(0,se.jsx)(Zf,{value:"has_pending_update",children:"Has Pending Update"})]})]}),(0,se.jsxs)(Wf,{value:N,onValueChange:w,children:[(0,se.jsx)(Yf,{className:"w-40 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(KP.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(qf,{placeholder:"Language"})]})}),(0,se.jsx)($f,{children:LJ.map(e=>(0,se.jsx)(Zf,{value:e.value,children:e.label},e.value))})]}),(0,se.jsxs)(Wf,{value:_,onValueChange:k,children:[(0,se.jsx)(Yf,{className:"w-32 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(GP.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(qf,{placeholder:"Pricing"})]})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Apps"}),(0,se.jsx)(Zf,{value:"free",children:"Free"}),(0,se.jsx)(Zf,{value:"paid",children:"Paid"})]})]}),pe()&&(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{y("all"),w("en"),k("all"),A("all"),E(""),I(""),c(""),L(1)},className:"h-9 px-3 text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-all duration-200",children:[(0,se.jsx)(la.A,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-1.5 rounded-lg",children:[(0,se.jsx)(lA.A,{className:"h-3.5 w-3.5"}),M>0?"".concat(M," total apps"):"".concat(n.length," apps")]})]})}),"custom"===C&&(0,se.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:(0,se.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),(0,se.jsx)(Df,{type:"date",value:S,onChange:e=>E(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),(0,se.jsx)(Df,{type:"date",value:T,onChange:e=>I(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]})]})}),pe()&&(0,se.jsxs)("div",{className:"flex flex-wrap gap-2 items-center p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:[(0,se.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[(0,se.jsx)(By.A,{className:"h-3.5 w-3.5"}),"Active filters:"]}),"all"!==j&&(0,se.jsxs)(gk,{className:"bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Status: ","has_pending_update"===j?"Has Pending Update":"pending_resubmission"===j?"Pending (Resubmission)":j,(0,se.jsx)("button",{onClick:()=>y("all"),className:"ml-1 hover:bg-blue-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),"en"!==N&&(0,se.jsxs)(gk,{className:"bg-teal-100 text-teal-800 hover:bg-teal-200 transition-colors",children:["Language: ",ge(N),(0,se.jsx)("button",{onClick:()=>w("en"),className:"ml-1 hover:bg-teal-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),"all"!==_&&(0,se.jsxs)(gk,{className:"bg-orange-100 text-orange-800 hover:bg-orange-200 transition-colors",children:["Pricing: ","paid"===_?"Paid":"Free",(0,se.jsx)("button",{onClick:()=>k("all"),className:"ml-1 hover:bg-orange-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),"all"!==C&&(0,se.jsxs)(gk,{className:"bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:["Date: ","custom"===C?"Custom":C,(0,se.jsx)("button",{onClick:()=>A("all"),className:"ml-1 hover:bg-purple-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),o&&(0,se.jsxs)(gk,{className:"bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:['Search: "',o,'"',(0,se.jsx)("button",{onClick:()=>c(""),className:"ml-1 hover:bg-green-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})]})]}),(0,se.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,se.jsxs)(pD,{children:[(0,se.jsx)(gD,{children:(0,se.jsxs)(vD,{children:[(0,se.jsx)(bD,{className:"w-8"}),(0,se.jsx)(bD,{className:"cursor-pointer",onClick:()=>me("name"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["App Name",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer w-24",onClick:()=>me("item_creator"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Creator",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer",onClick:()=>me("status"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Status",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer w-40",onClick:()=>me("created_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Created Date",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer w-40",onClick:()=>me("updated_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Last Updated",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer",onClick:()=>me("usage"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["#Clones",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer",onClick:()=>me("language"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Language",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer",onClick:()=>me("is_paid"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Price",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(bD,{children:"Actions"})]})}),(0,se.jsx)(fD,{children:r?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:10,className:"text-center py-8",children:"Loading apps..."})}):0===n.length?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:10,className:"text-center py-8",children:"No apps found"})}):n.map(e=>{var t,s,a,n,l,r,i;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(vD,{className:"hover:bg-gray-50/80 transition-colors duration-200 group h-12",children:[(0,se.jsx)(jD,{className:"py-2",children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>{return t=e.item.id,s=!!(e.item.pending_snapshot_id||e.item.pending_metadata&&Object.keys(e.item.pending_metadata).length>0),void b(e=>{const a=new Set(e);return a.has(t)?a.delete(t):(a.add(t),s&&xe(t)),a});var t,s},className:"h-6 w-6 p-0 rounded hover:bg-gray-100 transition-all duration-200 group",children:v.has(e.item.id)?(0,se.jsx)(_t.A,{className:"h-3 w-3 text-gray-600 group-hover:text-gray-900 transition-colors"}):(0,se.jsx)(bs.A,{className:"h-3 w-3 text-gray-600 group-hover:text-gray-900 transition-colors"})})}),(0,se.jsx)(jD,{className:"font-medium py-2 text-sm",children:(0,se.jsxs)("div",{className:"flex items-center gap-1.5",children:[(null===(t=e.item.name)||void 0===t?void 0:t.length)>100?"".concat(e.item.name.slice(0,100),"..."):e.item.name,(null===(s=e.item.pending_metadata)||void 0===s?void 0:s.name)&&e.item.pending_metadata.name!==e.item.name&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(jS.A,{className:"w-3.5 h-3.5 text-orange-500 cursor-help flex-shrink-0"})}),(0,se.jsx)(pp,{className:"w-[200px]",children:(0,se.jsxs)("p",{className:"text-sm text-wrap",children:['New name "',e.item.pending_metadata.name,'"']})})]})})]})}),(0,se.jsx)(jD,{className:"py-2 text-xs w-24 truncate",children:null===(a=e.item_creator)||void 0===a?void 0:a.full_name}),(0,se.jsx)(jD,{className:"py-2",children:(0,se.jsxs)("div",{className:"flex items-center gap-1.5 flex-wrap",children:[fe(e.item.status),e.item.pending_snapshot_id&&(0,se.jsxs)(gk,{className:"bg-orange-100 text-orange-700 border-orange-200 font-medium px-2 py-0.5 text-xs",children:[(0,se.jsx)(Fx.A,{className:"w-3 h-3 mr-1"}),"Update Pending"]})]})}),(0,se.jsx)(jD,{className:"py-2 w-40",children:He().utc(e.item.created_date).fromNow()}),(0,se.jsx)(jD,{className:"py-2 w-40",children:He().utc(e.item.updated_date).fromNow()}),(0,se.jsx)(jD,{className:"py-2",children:(0,se.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,se.jsx)(ob.A,{className:"h-3 w-3 text-gray-500"}),e.item.usage_count||0]})}),(0,se.jsx)(jD,{className:"py-2",children:(0,se.jsx)("span",{className:"text-xs text-gray-700",children:ge(e.item.language||"en")})}),(0,se.jsx)(jD,{className:"py-2",children:e.item.is_paid?(0,se.jsxs)("span",{className:"text-sm font-semibold text-green-700",children:["$",(null===(n=e.item.price_usd)||void 0===n?void 0:n.toFixed(2))||"0.00"]}):(0,se.jsx)("span",{className:"text-xs text-gray-500",children:"Free"})}),(0,se.jsx)(jD,{className:"py-2",children:(0,se.jsxs)("div",{className:"flex gap-1",children:[(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-all duration-200 group",onClick:t=>{t.stopPropagation(),oe("approve",e)},disabled:h[e.item.id],title:"Approve",children:(0,se.jsx)(Ds.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})}),(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-all duration-200 group",onClick:t=>{t.stopPropagation(),oe("decline",e)},disabled:h[e.item.id],title:"Decline",children:(0,se.jsx)(la.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})}),(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded transition-all duration-200 group",onClick:t=>{t.stopPropagation(),oe("archive",e)},disabled:h[e.item.id],title:"Archive",children:(0,se.jsx)(tB.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})}),(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded transition-all duration-200 group",onClick:t=>{t.stopPropagation(),(async e=>{f(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!0}));try{const{url:t}=await zc.getAppPublishedUrl(e);window.open(t,"_blank")}catch(t){so({title:"Error",description:"Failed to open app",variant:"destructive"})}finally{f(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!1}))}})(e.item.app_id)},disabled:g[e.item.app_id],title:"Open New Tab",children:(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})}),(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-purple-600 hover:text-purple-700 hover:bg-purple-50 rounded transition-all duration-200 group",onClick:t=>{t.stopPropagation(),window.open("/apps/".concat(e.item.app_id),"_blank")},title:"Open Editor",children:(0,se.jsx)(Zw.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})})]})})]},e.item.id),v.has(e.item.id)&&(0,se.jsx)(vD,{children:(0,se.jsxs)(jD,{colSpan:10,className:"bg-gradient-to-br from-gray-50 to-gray-100/50 p-8 border-t border-gray-100",children:[(e.item.pending_snapshot_id||e.item.pending_metadata&&Object.keys(e.item.pending_metadata).length>0)&&(0,se.jsxs)("div",{className:"mb-8 bg-orange-50 border border-orange-200 rounded-xl p-6",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,se.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,se.jsx)(Fx.A,{className:"h-5 w-5 text-orange-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-orange-900",children:"Pending Update for Review"}),(0,se.jsx)("p",{className:"text-sm text-orange-700",children:"This listing has changes awaiting approval"})]})]}),ee[e.item.id]?(0,se.jsxs)("div",{className:"flex items-center gap-2 text-orange-700",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}),(0,se.jsx)("span",{className:"text-sm",children:"Loading pending changes..."})]}):Q[e.item.id]?(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex flex-wrap gap-2",children:[Q[e.item.id].has_code_changes&&(0,se.jsxs)(gk,{className:"bg-orange-100 text-orange-800 border-orange-300",children:[(0,se.jsx)(BV.A,{className:"h-3 w-3 mr-1"}),"App Code Changes"]}),Q[e.item.id].has_metadata_changes&&(0,se.jsxs)(gk,{className:"bg-orange-100 text-orange-800 border-orange-300",children:[(0,se.jsx)(xb.A,{className:"h-3 w-3 mr-1"}),"Listing Details Changed"]})]}),Q[e.item.id].has_metadata_changes&&(0,se.jsxs)("div",{className:"bg-white rounded-lg border border-orange-200 overflow-hidden",children:[(0,se.jsx)("div",{className:"px-4 py-2 bg-orange-100 border-b border-orange-200",children:(0,se.jsx)("h4",{className:"text-sm font-medium text-orange-900",children:"Listing Changes"})}),(0,se.jsx)("div",{className:"divide-y divide-orange-100",children:Object.entries(Q[e.item.id].metadata_diff).map(e=>{let[t,s]=e;return(0,se.jsxs)("div",{className:"p-4",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2 capitalize",children:t.replace(/_/g," ")}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:[(0,se.jsx)("div",{className:"text-xs font-medium text-red-600 mb-1",children:"Current"}),(0,se.jsx)("div",{className:"text-sm text-red-900 break-words",children:"object"==typeof s.old?JSON.stringify(s.old,null,2):String(s.old||"(empty)")}),"screenshot_urls"===t&&Array.isArray(s.old)&&s.old.length>0&&(0,se.jsx)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:s.old.map((e,t)=>(0,se.jsx)("img",{src:e,alt:"Current screenshot ".concat(t+1),className:"w-full h-24 object-cover rounded border border-red-200 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>de(e,"Current Screenshot ".concat(t+1))},t))})]}),(0,se.jsxs)("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[(0,se.jsx)("div",{className:"text-xs font-medium text-green-600 mb-1",children:"Pending"}),(0,se.jsx)("div",{className:"text-sm text-green-900 break-words",children:"object"==typeof s.new?JSON.stringify(s.new,null,2):String(s.new||"(empty)")}),"screenshot_urls"===t&&Array.isArray(s.new)&&s.new.length>0&&(0,se.jsx)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:s.new.map((e,t)=>(0,se.jsx)("img",{src:e,alt:"Pending screenshot ".concat(t+1),className:"w-full h-24 object-cover rounded border border-green-200 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>de(e,"Pending Screenshot ".concat(t+1))},t))})]})]})]},t)})})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-3 pt-2",children:[(0,se.jsxs)("div",{className:"flex gap-3",children:[e.item.snapshot_id&&(0,se.jsxs)(Bx,{size:"sm",variant:"outline",onClick:()=>he(e.item.id,!1),disabled:ae["".concat(e.item.id,"-approved")],className:"border-emerald-300 text-emerald-700 hover:bg-emerald-50",children:[ae["".concat(e.item.id,"-approved")]?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(ob.A,{className:"h-4 w-4 mr-2"}),"Clone Current Approved Version"]}),e.item.pending_snapshot_id&&(0,se.jsxs)(Bx,{size:"sm",variant:"outline",onClick:()=>he(e.item.id,!0),disabled:ae["".concat(e.item.id,"-pending")],className:"border-orange-300 text-orange-700 hover:bg-orange-50",children:[ae["".concat(e.item.id,"-pending")]?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(ob.A,{className:"h-4 w-4 mr-2"}),"Clone Pending Version"]})]}),(le["".concat(e.item.id,"-approved")]||le["".concat(e.item.id,"-pending")])&&(0,se.jsxs)("div",{className:"flex flex-wrap gap-3 bg-white/50 rounded-lg p-3 border border-gray-200",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:"Cloned apps:"}),le["".concat(e.item.id,"-approved")]&&(0,se.jsxs)("a",{href:"/apps/".concat(le["".concat(e.item.id,"-approved")].id,"/editor/preview"),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 text-sm text-emerald-700 hover:text-emerald-800 hover:underline font-medium",children:[(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5"}),"Approved: ",le["".concat(e.item.id,"-approved")].name]}),le["".concat(e.item.id,"-pending")]&&(0,se.jsxs)("a",{href:"/apps/".concat(le["".concat(e.item.id,"-pending")].id,"/editor/preview"),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 text-sm text-orange-700 hover:text-orange-800 hover:underline font-medium",children:[(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5"}),"Pending: ",le["".concat(e.item.id,"-pending")].name]})]})]})]}):(0,se.jsx)(Bx,{size:"sm",variant:"outline",onClick:()=>xe(e.item.id),className:"border-orange-300 text-orange-700 hover:bg-orange-100",children:"Load Pending Changes"})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-blue-500 rounded-full"}),"Description",e.item.pending_snapshot_id&&"approved"===e.item.status&&(0,se.jsx)(gk,{className:"ml-2 bg-emerald-100 text-emerald-700 text-xs",children:"Current Live"})]}),(0,se.jsx)("div",{className:"text-sm text-gray-600 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Xg(e.item.description||'<p class="text-gray-400 italic">No description available</p>')}})]}),(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-green-500 rounded-full"}),"Technical Details"]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-3 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,se.jsx)("span",{className:"font-medium text-gray-700",children:"App ID:"}),(0,se.jsx)("code",{className:"text-gray-600 bg-gray-100 px-2 py-1 rounded text-xs",children:e.item.app_id})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,se.jsx)("span",{className:"font-medium text-gray-700",children:"Organization:"}),(0,se.jsx)("code",{className:"text-gray-600 bg-gray-100 px-2 py-1 rounded text-xs",children:e.item.organization_id})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,se.jsx)("span",{className:"font-medium text-gray-700",children:"Pricing:"}),e.item.is_paid?(0,se.jsxs)("span",{className:"text-green-700 font-semibold",children:["$",(null===(l=e.item.price_usd)||void 0===l?void 0:l.toFixed(2))||"0.00"]}):(0,se.jsx)("span",{className:"text-gray-600",children:"Free"})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,se.jsx)("span",{className:"font-medium text-gray-700",children:"Created:"}),(0,se.jsx)("span",{className:"text-gray-600",children:He().utc(e.item.created_date).format("MMM DD, YYYY HH:mm")})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,se.jsx)("span",{className:"font-medium text-gray-700",children:"Updated:"}),(0,se.jsx)("span",{className:"text-gray-600",children:He().utc(e.item.updated_date).format("MMM DD, YYYY HH:mm")})]})]})]}),"rejected"===e.item.status&&e.item.rejected_reason&&(0,se.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-red-500 rounded-full"}),"Rejection Reason"]}),(0,se.jsx)("div",{className:"text-sm text-red-800 bg-white p-3 rounded border border-red-200",children:e.item.rejected_reason})]}),(null===(r=e.item.categories)||void 0===r?void 0:r.length)>0&&(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-purple-500 rounded-full"}),"Categories"]}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:e.item.categories.map((e,t)=>(0,se.jsx)(gk,{className:"bg-purple-50 text-purple-700 border-purple-200 hover:bg-purple-100 transition-colors",children:e},t))})]})]}),(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 h-fit",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-orange-500 rounded-full"}),"Screenshots"]}),(null===(i=e.item.screenshot_urls)||void 0===i?void 0:i.length)>0?(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[e.item.screenshot_urls.slice(0,3).map((t,s)=>(0,se.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-gray-200 group",children:[(0,se.jsx)("img",{src:t,alt:"Screenshot ".concat(s+1),className:"w-full h-36 object-cover group-hover:scale-105 transition-all duration-300 cursor-pointer",onClick:a=>{a.stopPropagation(),de(t,"".concat(e.item.name," - Screenshot ").concat(s+1))}}),(0,se.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 flex items-center justify-center",children:(0,se.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white/90 backdrop-blur-sm rounded-full p-2",children:(0,se.jsx)(lA.A,{className:"h-4 w-4 text-gray-700"})})})]},s)),e.item.screenshot_urls.length>3&&(0,se.jsx)("div",{className:"text-center py-2 bg-gray-50 rounded-lg border border-gray-200",children:(0,se.jsxs)("p",{className:"text-sm text-gray-600 font-medium",children:["+",e.item.screenshot_urls.length-3," more screenshots"]})})]}):(0,se.jsxs)("div",{className:"text-center py-8 text-gray-400 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[(0,se.jsx)(lA.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,se.jsx)("p",{className:"text-sm",children:"No screenshots available"})]})]})]})]})})]})})})]})}),n.length>0&&(0,se.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,se.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:(0,se.jsxs)("span",{children:["Showing ",(P-1)*D+1," to ",Math.min(P*D,M)," of ",M," items"]})}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>L(e=>Math.max(e-1,1)),disabled:1===P||r,className:"h-8 px-3",children:"Previous"}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[P>2&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>L(1),className:"h-8 w-8 p-0",children:"1"}),P>3&&(0,se.jsx)("span",{className:"px-1 text-gray-400",children:"..."})]}),P>1&&(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>L(e=>e-1),className:"h-8 w-8 p-0",children:P-1}),(0,se.jsx)(Bx,{variant:"default",size:"sm",className:"h-8 w-8 p-0",children:P}),n.length===D&&(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>L(e=>e+1),disabled:r,className:"h-8 w-8 p-0",children:P+1})]}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:()=>L(e=>e+1),disabled:n.length<D||r,className:"h-8 px-3",children:"Next"})]})]}),(0,se.jsx)(Og,{open:Z.isOpen,onOpenChange:()=>{J({isOpen:!1,imageUrl:"",imageAlt:""})},children:(0,se.jsxs)(Hg,{className:"max-w-4xl max-h-[90vh] p-0 overflow-hidden z-[100]",children:[(0,se.jsx)(Vg,{className:"p-6 pb-0",children:(0,se.jsx)(qg,{className:"text-lg font-semibold text-gray-900",children:Z.imageAlt})}),(0,se.jsx)("div",{className:"p-6 pt-4",children:(0,se.jsx)("div",{className:"relative rounded-lg overflow-hidden bg-gray-100",children:(0,se.jsx)("img",{src:Z.imageUrl,alt:Z.imageAlt,className:"w-full max-h-[70vh] object-contain"})})})]})}),(0,se.jsx)(Og,{open:V.isOpen,onOpenChange:ce,children:(0,se.jsxs)(Hg,{children:[(0,se.jsxs)(Vg,{children:[(0,se.jsxs)(qg,{children:["approve"===V.action&&"Approve App Listing","decline"===V.action&&"Decline App Listing","archive"===V.action&&"Archive App Listing"]}),(0,se.jsxs)(Yg,{children:["approve"===V.action&&(0,se.jsxs)(se.Fragment,{children:["Are you sure you want to approve ",(0,se.jsx)("strong",{children:null===(e=V.item)||void 0===e?void 0:e.item.name}),"?",(0,se.jsx)("br",{}),"This will make the app publicly visible in the catalog.",(0,se.jsxs)("div",{className:"mt-4",children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language:"}),(0,se.jsxs)(Wf,{value:K,onValueChange:$,children:[(0,se.jsx)(Yf,{className:"w-full",children:(0,se.jsx)(qf,{placeholder:"Select language"})}),(0,se.jsx)($f,{children:LJ.map(e=>(0,se.jsx)(Zf,{value:e.value,children:e.label},e.value))})]})]})]}),"decline"===V.action&&(0,se.jsxs)(se.Fragment,{children:["Are you sure you want to decline ",(0,se.jsx)("strong",{children:null===(t=V.item)||void 0===t?void 0:t.item.name}),"?",(0,se.jsx)("br",{}),"This will remove the app from public visibility in the catalog.",(0,se.jsxs)("div",{className:"mt-4",children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for decline (optional):"}),(0,se.jsx)("textarea",{placeholder:"Enter reason for declining this app listing...",value:q,onChange:e=>G(e.target.value),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),"archive"===V.action&&(0,se.jsxs)(se.Fragment,{children:["Are you sure you want to archive ",(0,se.jsx)("strong",{children:null===(s=V.item)||void 0===s?void 0:s.item.name}),"?",(0,se.jsx)("br",{}),"This will permanently remove the app from the catalog."]})]})]}),(0,se.jsxs)(Wg,{children:[(0,se.jsx)(Bx,{variant:"outline",onClick:ce,children:"Cancel"}),(0,se.jsxs)(Bx,{onClick:async()=>{if(!V.action||!V.item)return;const{action:e,item:t}=V,s=t.item.id;p(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:!0})),ce();try{switch(e){case"approve":await Gg.approveItem(s,K);break;case"decline":await Gg.declineItem(s,q||void 0);break;case"archive":await Gg.archiveItem(s)}so({title:"Success",description:"Item ".concat(e,"d successfully")}),await ie()}catch(a){so({title:"Error",description:"Failed to ".concat(e," item"),variant:"destructive"})}finally{p(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:!1}))}},className:"approve"===V.action?"bg-green-600 hover:bg-green-700":"decline"===V.action?"bg-red-600 hover:bg-red-700":"bg-gray-600 hover:bg-gray-700",children:["approve"===V.action&&"Approve","decline"===V.action&&"Decline","archive"===V.action&&"Archive"]})]})]})})]}):(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(jH.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,se.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}function RJ(e){let{currentPage:t,totalPages:s,onPageChange:a}=e;return s<=1?null:(0,se.jsxs)("div",{className:"flex items-center justify-center space-x-2 mt-12",children:[(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>a(Math.max(1,t-1)),disabled:1===t,className:"h-9 px-3",children:[(0,se.jsx)(vs.A,{className:"w-4 h-4 mr-1"}),"Previous"]}),(0,se.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(s,7)},(e,n)=>{let l;return l=s<=7||t<=4?n+1:t>=s-3?s-6+n:t-3+n,(0,se.jsx)(Bx,{variant:t===l?"default":"outline",size:"sm",onClick:()=>a(l),className:"h-9 w-9 p-0",children:l},l)})}),(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>a(Math.min(s,t+1)),disabled:t===s,className:"h-9 px-3",children:["Next",(0,se.jsx)(bs.A,{className:"w-4 h-4 ml-1"})]})]})}function DJ(){var e,t,s;const{user:a}=wd(),[n,l]=(0,Y.useState)([]),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(""),[d,u]=(0,Y.useState)({key:"created_date",direction:"desc"}),[m,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)({}),[g,f]=(0,Y.useState)(new Set),[v,b]=(0,Y.useState)(1),[j,y]=(0,Y.useState)(20),[N,w]=(0,Y.useState)(0),[_,k]=(0,Y.useState)(1),[C,A]=(0,Y.useState)("all"),[S,E]=(0,Y.useState)("all"),[T,I]=(0,Y.useState)(""),[P,L]=(0,Y.useState)(""),[M,R]=(0,Y.useState)({isOpen:!1,action:null,item:null}),[D,F]=(0,Y.useState)("");(0,Y.useEffect)(()=>{O()},[]),(0,Y.useEffect)(()=>(m&&clearTimeout(m),x(setTimeout(()=>{O()},500)),()=>{m&&clearTimeout(m)}),[o,C,S,T,P,v,j]);const O=async()=>{i(!0);try{let e={limit:j,skip:(v-1)*j,sort_by:"".concat("desc"===d.direction?"-":"").concat(d.key)};if(o&&(e.$or=[{name:{$regex:o,$options:"i"}},{description:{$regex:o,$options:"i"}},{categories:{$regex:o,$options:"i"}},{created_by:{$regex:o,$options:"i"}}]),C&&"all"!==C&&(e.status=C),"all"!==S){const t=He()();let s;switch(S){case"today":s=t.clone().startOf("day"),e.created_at={$gte:s.toISOString()};break;case"week":s=t.clone().subtract(7,"days").startOf("day"),e.created_at={$gte:s.toISOString()};break;case"month":s=t.clone().subtract(30,"days").startOf("day"),e.created_at={$gte:s.toISOString()};break;case"custom":T&&P?e.created_at={$gte:He()(T).startOf("day").toISOString(),$lte:He()(P).endOf("day").toISOString()}:T?e.created_at={$gte:He()(T).startOf("day").toISOString()}:P&&(e.created_at={$lte:He()(P).endOf("day").toISOString()})}}const t=await Yp.listCatalogItems(e),s=t.items||t,a=t.total||s.length;l(s),w(a),k(Math.ceil(a/j))}catch(e){so({title:"Error",description:"Failed to load catalog items",variant:"destructive"})}finally{i(!1)}},U=(e,t)=>{R({isOpen:!0,action:e,item:t})},B=()=>{R({isOpen:!1,action:null,item:null}),F("")},z=e=>{u({key:e,direction:d.key===e&&"asc"===d.direction?"desc":"asc"}),b(1)},H=()=>"all"!==C||"all"!==S||""!==o||""!==T||""!==P,V=e=>{switch(e){case"approved":return(0,se.jsxs)(gk,{className:"bg-emerald-100 text-emerald-700 border-emerald-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1.5"}),"Approved"]});case"pending":return(0,se.jsxs)(gk,{className:"bg-amber-100 text-amber-700 border-amber-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)(jS.A,{className:"w-3 h-3 mr-1.5"}),"Pending"]});case"declined":return(0,se.jsxs)(gk,{className:"bg-red-100 text-red-700 border-red-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),"Declined"]});case"archived":return(0,se.jsxs)(gk,{className:"bg-gray-100 text-gray-700 border-gray-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)(tB.A,{className:"w-3 h-3 mr-1.5"}),"Archived"]});default:return(0,se.jsx)(gk,{variant:"secondary",className:"font-medium px-2.5 py-0.5 text-xs",children:e})}},W=n;return $p(null==a?void 0:a.platform_role)?(0,se.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Integration Catalog Management"}),(0,se.jsxs)("div",{className:"mb-8 space-y-4",children:[(0,se.jsx)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3 items-start lg:items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center flex-1",children:[(0,se.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,se.jsx)(Df,{placeholder:"Search integrations, creators, categories...",className:"pl-10 h-9 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-200",value:o,onChange:e=>c(e.target.value)})]}),(0,se.jsxs)(Wf,{value:C,onValueChange:A,children:[(0,se.jsx)(Yf,{className:"w-36 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(_P.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(qf,{placeholder:"Status"})]})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Status"}),(0,se.jsx)(Zf,{value:"pending",children:"Pending"}),(0,se.jsx)(Zf,{value:"approved",children:"Approved"}),(0,se.jsx)(Zf,{value:"declined",children:"Declined"}),(0,se.jsx)(Zf,{value:"archived",children:"Archived"})]})]}),H()&&(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{A("all"),E("all"),I(""),L(""),c(""),b(1)},className:"h-9 px-3 text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-all duration-200",children:[(0,se.jsx)(la.A,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-1.5 rounded-lg",children:[(0,se.jsx)(lA.A,{className:"h-3.5 w-3.5"}),N," total integrations"]})]})}),"custom"===S&&(0,se.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:(0,se.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),(0,se.jsx)(Df,{type:"date",value:T,onChange:e=>I(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),(0,se.jsx)(Df,{type:"date",value:P,onChange:e=>L(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]})]})}),H()&&(0,se.jsxs)("div",{className:"flex flex-wrap gap-2 items-center p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:[(0,se.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[(0,se.jsx)(By.A,{className:"h-3.5 w-3.5"}),"Active filters:"]}),"all"!==C&&(0,se.jsxs)(gk,{className:"bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Status: ",C,(0,se.jsx)("button",{onClick:()=>A("all"),className:"ml-1 hover:bg-blue-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),"all"!==S&&(0,se.jsxs)(gk,{className:"bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:["Date: ","custom"===S?"Custom":S,(0,se.jsx)("button",{onClick:()=>E("all"),className:"ml-1 hover:bg-purple-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),o&&(0,se.jsxs)(gk,{className:"bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:['Search: "',o,'"',(0,se.jsx)("button",{onClick:()=>c(""),className:"ml-1 hover:bg-green-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})]})]}),(0,se.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,se.jsxs)(pD,{children:[(0,se.jsx)(gD,{children:(0,se.jsxs)(vD,{className:"hover:bg-transparent border-b",children:[(0,se.jsx)(bD,{className:"w-8"}),(0,se.jsx)(bD,{className:"cursor-pointer font-semibold py-3",onClick:()=>z("name"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Integration Name",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer font-semibold py-3 w-32",onClick:()=>z("status"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Status",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer font-semibold py-3 w-36",onClick:()=>z("created_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Created",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,se.jsx)(bD,{className:"cursor-pointer font-semibold py-3 w-36",onClick:()=>z("updated_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Updated",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,se.jsx)(bD,{className:"font-semibold py-3 w-40",children:"Categories"}),(0,se.jsx)(bD,{className:"cursor-pointer font-semibold py-3 w-24",onClick:()=>z("is_private"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Privacy",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4 opacity-50"})]})})]})}),(0,se.jsx)(fD,{children:r?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:7,className:"text-center py-8",children:"Loading integrations..."})}):0===W.length?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:7,className:"text-center py-8",children:"No integrations found"})}):W.map(e=>{var t,s,a,n;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(vD,{className:"hover:bg-gray-50/60 transition-colors duration-150 group border-b border-gray-100",children:[(0,se.jsx)(jD,{className:"py-3",children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>{return t=e.item.id,void f(e=>{const s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s});var t},className:"h-6 w-6 p-0 rounded-md hover:bg-gray-100 transition-all duration-150",children:g.has(e.item.id)?(0,se.jsx)(_t.A,{className:"h-3.5 w-3.5 text-gray-500"}):(0,se.jsx)(bs.A,{className:"h-3.5 w-3.5 text-gray-500"})})}),(0,se.jsx)(jD,{className:"font-medium py-3 text-sm",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{className:"truncate",children:e.item.name}),(0,se.jsxs)("div",{className:"flex gap-1",children:[(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-green-600 hover:text-green-700 hover:bg-green-50 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:t=>{t.stopPropagation(),U("approve",e)},disabled:h[e.item.id],title:"Approve",children:(0,se.jsx)(Ds.A,{className:"h-3 w-3"})}),(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-red-600 hover:text-red-700 hover:bg-red-50 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:t=>{t.stopPropagation(),U("decline",e)},disabled:h[e.item.id],title:"Decline",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})}),(0,se.jsx)(Bx,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:t=>{t.stopPropagation(),window.open("/integrations-catalog/item/".concat(e.item.id),"_blank")},title:"View Integration",children:(0,se.jsx)(lA.A,{className:"h-3 w-3"})})]})]})}),(0,se.jsx)(jD,{className:"py-3",children:V(e.item.status)}),(0,se.jsx)(jD,{className:"py-3 text-sm text-gray-600",children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(H_.A,{className:"h-3 w-3 text-gray-400"}),He().utc(e.item.created_date).format("MMM DD")]})}),(0,se.jsx)(jD,{className:"py-3 text-sm text-gray-600",children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(jS.A,{className:"h-3 w-3 text-gray-400"}),He().utc(e.item.updated_date).format("MMM DD")]})}),(0,se.jsx)(jD,{className:"py-3",children:(0,se.jsx)("div",{className:"flex flex-wrap gap-1",children:(null===(t=e.item.categories)||void 0===t?void 0:t.length)>0?(0,se.jsxs)(se.Fragment,{children:[e.item.categories.slice(0,2).map((e,t)=>(0,se.jsx)(gk,{variant:"outline",className:"text-xs px-1.5 py-0 h-5",children:e},t)),e.item.categories.length>2&&(0,se.jsxs)(gk,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-gray-50",children:["+",e.item.categories.length-2]})]}):(0,se.jsx)("span",{className:"text-gray-400 text-xs",children:"None"})})}),(0,se.jsx)(jD,{className:"py-3",children:(0,se.jsx)("div",{className:"flex items-center gap-1.5",children:e.item.is_private?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Vc.A,{className:"h-3 w-3 text-amber-500"}),(0,se.jsx)("span",{className:"text-xs text-amber-600 font-medium",children:"Private"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(KP.A,{className:"h-3 w-3 text-green-500"}),(0,se.jsx)("span",{className:"text-xs text-green-600 font-medium",children:"Public"})]})})})]},e.item.id),g.has(e.item.id)&&(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:7,className:"bg-gradient-to-br from-gray-50 to-gray-100/50 p-6 border-t border-gray-100",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-4 bg-blue-500 rounded-full"}),"Creator & Usage"]}),(0,se.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-gray-600",children:"Creator:"}),(0,se.jsx)("span",{className:"font-medium text-gray-900",children:(null===(s=e.item_creator)||void 0===s?void 0:s.full_name)||(0,se.jsx)("span",{className:"text-gray-400 italic",children:"Unknown"})})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-gray-600",children:"Uses:"}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(ob.A,{className:"h-3 w-3 text-gray-500"}),(0,se.jsx)("span",{className:"font-medium text-gray-900",children:e.item.usage_count||0})]})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-gray-600",children:"Status:"}),V(e.item.status)]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-4 bg-purple-500 rounded-full"}),"Admin Actions"]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsxs)(Bx,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:t=>{t.stopPropagation(),U("approve",e)},disabled:h[e.item.id],children:[(0,se.jsx)(Ds.A,{className:"h-3 w-3 mr-1"}),"Approve"]}),(0,se.jsxs)(Bx,{size:"sm",variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50",onClick:t=>{t.stopPropagation(),U("decline",e)},disabled:h[e.item.id],children:[(0,se.jsx)(la.A,{className:"h-3 w-3 mr-1"}),"Decline"]}),(0,se.jsxs)(Bx,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),window.open("/integrations-catalog/item/".concat(e.item.id),"_blank")},children:[(0,se.jsx)(lA.A,{className:"h-3 w-3 mr-1"}),"View"]})]})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-4 bg-emerald-500 rounded-full"}),"Description"]}),(0,se.jsx)("div",{className:"text-sm text-gray-600 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Xg(e.item.description||'<p class="text-gray-400 italic">No description available</p>')}})]}),(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-4 bg-orange-500 rounded-full"}),"Technical Details"]}),(0,se.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,se.jsx)("span",{className:"text-gray-600",children:"Integration ID:"}),(0,se.jsx)("code",{className:"text-gray-900 bg-gray-100 px-2 py-0.5 rounded text-xs font-mono",children:e.item.integration_id})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,se.jsx)("span",{className:"text-gray-600",children:"Organization:"}),(0,se.jsx)("code",{className:"text-gray-900 bg-gray-100 px-2 py-0.5 rounded text-xs font-mono",children:e.item.organization_id})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,se.jsx)("span",{className:"text-gray-600",children:"Created:"}),(0,se.jsx)("span",{className:"text-gray-900 font-medium",children:He().utc(e.item.created_date).format("MMM DD, YYYY")})]}),(0,se.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,se.jsx)("span",{className:"text-gray-600",children:"Updated:"}),(0,se.jsx)("span",{className:"text-gray-900 font-medium",children:He().utc(e.item.updated_date).format("MMM DD, YYYY")})]})]})]}),(null===(a=e.item.categories)||void 0===a?void 0:a.length)>0&&(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-purple-500 rounded-full"}),"Categories"]}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:e.item.categories.map((e,t)=>(0,se.jsx)(gk,{className:"bg-purple-50 text-purple-700 border-purple-200 hover:bg-purple-100 transition-colors",children:e},t))})]})]}),(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 h-fit",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-orange-500 rounded-full"}),"Screenshots"]}),(null===(n=e.item.screenshot_urls)||void 0===n?void 0:n.length)>0?(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[e.item.screenshot_urls.slice(0,3).map((e,t)=>(0,se.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-gray-200 group",children:[(0,se.jsx)("img",{src:e,alt:"Screenshot ".concat(t+1),className:"w-full h-36 object-cover group-hover:scale-105 transition-all duration-300 cursor-pointer",onClick:()=>window.open(e,"_blank")}),(0,se.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 flex items-center justify-center",children:(0,se.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white/90 backdrop-blur-sm rounded-full p-2",children:(0,se.jsx)(lA.A,{className:"h-4 w-4 text-gray-700"})})})]},t)),e.item.screenshot_urls.length>3&&(0,se.jsx)("div",{className:"text-center py-2 bg-gray-50 rounded-lg border border-gray-200",children:(0,se.jsxs)("p",{className:"text-sm text-gray-600 font-medium",children:["+",e.item.screenshot_urls.length-3," more screenshots"]})})]}):(0,se.jsxs)("div",{className:"text-center py-8 text-gray-400 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[(0,se.jsx)(lA.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,se.jsx)("p",{className:"text-sm",children:"No screenshots available"})]})]})]})})})]})})})]})}),(0,se.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,se.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("span",{children:"Showing"}),(0,se.jsxs)("span",{className:"font-semibold text-gray-900",children:[Math.min((v-1)*j+1,N),"-",Math.min(v*j,N)]}),(0,se.jsx)("span",{children:"of"}),(0,se.jsx)("span",{className:"font-semibold text-gray-900",children:N}),(0,se.jsx)("span",{children:"integrations"})]}),(0,se.jsxs)(Wf,{value:j.toString(),onValueChange:e=>{return t=parseInt(e),y(t),void b(1);var t},children:[(0,se.jsx)(Yf,{className:"w-24 h-8 text-sm",children:(0,se.jsx)(qf,{})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"10",children:"10"}),(0,se.jsx)(Zf,{value:"20",children:"20"}),(0,se.jsx)(Zf,{value:"50",children:"50"}),(0,se.jsx)(Zf,{value:"100",children:"100"})]})]}),(0,se.jsx)("span",{className:"text-gray-500",children:"per page"})]}),(0,se.jsx)(RJ,{currentPage:v,totalPages:_,onPageChange:e=>{b(e)}})]}),(0,se.jsx)(Og,{open:M.isOpen,onOpenChange:B,children:(0,se.jsxs)(Hg,{children:[(0,se.jsxs)(Vg,{children:[(0,se.jsxs)(qg,{children:["approve"===M.action&&"Approve Integration","decline"===M.action&&"Decline Integration","archive"===M.action&&"Archive Integration"]}),(0,se.jsxs)(Yg,{children:["approve"===M.action&&(0,se.jsxs)(se.Fragment,{children:["Are you sure you want to approve ",(0,se.jsx)("strong",{children:null===(e=M.item)||void 0===e?void 0:e.item.name}),"?",(0,se.jsx)("br",{}),"This will make the integration publicly visible in the catalog."]}),"decline"===M.action&&(0,se.jsxs)(se.Fragment,{children:["Are you sure you want to decline ",(0,se.jsx)("strong",{children:null===(t=M.item)||void 0===t?void 0:t.item.name}),"?",(0,se.jsx)("br",{}),"This will remove the integration from public visibility in the catalog.",(0,se.jsxs)("div",{className:"mt-4",children:[(0,se.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for decline (optional):"}),(0,se.jsx)("textarea",{placeholder:"Enter reason for declining this integration...",value:D,onChange:e=>F(e.target.value),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),"archive"===M.action&&(0,se.jsxs)(se.Fragment,{children:["Are you sure you want to archive ",(0,se.jsx)("strong",{children:null===(s=M.item)||void 0===s?void 0:s.item.name}),"?",(0,se.jsx)("br",{}),"This will permanently remove the integration from the catalog."]})]})]}),(0,se.jsxs)(Wg,{children:[(0,se.jsx)(Bx,{variant:"outline",onClick:B,children:"Cancel"}),(0,se.jsxs)(Bx,{onClick:async()=>{if(!M.action||!M.item)return;const{action:e,item:t}=M,s=t.item.id;p(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:!0})),B();try{switch(e){case"approve":await Yp.approveItem(s);break;case"decline":await Yp.declineItem(s,D||void 0);break;case"archive":await Yp.archiveItem(s)}so({title:"Success",description:"Integration ".concat(e,"d successfully")}),await O()}catch(a){so({title:"Error",description:"Failed to ".concat(e," integration"),variant:"destructive"})}finally{p(e=>(0,ue.A)((0,ue.A)({},e),{},{[s]:!1}))}},className:"approve"===M.action?"bg-green-600 hover:bg-green-700":"decline"===M.action?"bg-red-600 hover:bg-red-700":"bg-gray-600 hover:bg-gray-700",children:["approve"===M.action&&"Approve","decline"===M.action&&"Decline","archive"===M.action&&"Archive"]})]})]})})]}):(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(jH.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,se.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}var FJ=s(47770),OJ=s(14215);const UJ="/admin/app_template_marketplace";async function BJ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=localStorage.getItem("token");if(!s)throw new Error("No authentication token found");const a=await fetch("".concat((0,fe.Gt)()).concat(e),(0,ue.A)((0,ue.A)({},t),{},{headers:(0,ue.A)({Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},t.headers)}));if(!a.ok){const e=await a.json().catch(()=>({detail:"Request failed"}));throw new Error(e.detail||"Request failed with status ".concat(a.status))}return a}const zJ={listTransactions:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&""!==a&&t.append(s,String(a))}),(await BJ("".concat(UJ,"/transactions?").concat(t.toString()))).json()},getTransactionSummary:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&t.append(s,String(a))}),(await BJ("".concat(UJ,"/transactions/summary?").concat(t.toString()))).json()},getTransaction:async function(e){return(await BJ("".concat(UJ,"/transactions/").concat(e))).json()},getAnalytics:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new URLSearchParams;return void 0!==e.days&&t.append("days",String(e.days)),void 0!==e.granularity&&t.append("granularity",e.granularity),(await BJ("".concat(UJ,"/transactions/analytics?").concat(t.toString()))).json()},getSellersSummary:async function(){return(await BJ("".concat(UJ,"/sellers/summary"))).json()},listSellers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[s,a]=e;null!=a&&""!==a&&t.append(s,String(a))}),(await BJ("".concat(UJ,"/sellers?").concat(t.toString()))).json()},getSellerDetail:async function(e){return(await BJ("".concat(UJ,"/sellers/").concat(e))).json()},getSellerTransactions:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new URLSearchParams;return Object.entries(t).forEach(e=>{let[t,a]=e;null!=a&&s.append(t,String(a))}),(await BJ("".concat(UJ,"/sellers/").concat(e,"/transactions?").concat(s.toString()))).json()}},HJ=zJ;function VJ(){var e,t,s,a,n;const[l,r]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!0),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(""),[f,v]=(0,Y.useState)("completed"),[b,j]=(0,Y.useState)("all"),[y,N]=(0,Y.useState)("-created_date"),[w,_]=(0,Y.useState)(0),[k]=(0,Y.useState)(50),C=(0,Y.useCallback)(async()=>{d(!0);try{const[e,t]=await Promise.all([HJ.listTransactions({limit:k,offset:w,status:f,payout_status:b,sort_by:y}),HJ.getTransactionSummary()]);r(e.transactions),o(t)}catch(e){so({title:"Error",description:e.message||"Failed to load transactions",variant:"destructive"})}finally{d(!1)}},[k,w,f,b,y]);(0,Y.useEffect)(()=>{C()},[C]);const A=e=>{switch(e){case"completed":return(0,se.jsxs)(gk,{className:"bg-emerald-100 text-emerald-700 border-emerald-200",children:[(0,se.jsx)(hb.A,{className:"w-3 h-3 mr-1"}),"Completed"]});case"pending":return(0,se.jsxs)(gk,{className:"bg-amber-100 text-amber-700 border-amber-200",children:[(0,se.jsx)(jS.A,{className:"w-3 h-3 mr-1"}),"Pending"]});case"cancelled":return(0,se.jsxs)(gk,{className:"bg-red-100 text-red-700 border-red-200",children:[(0,se.jsx)(Uy.A,{className:"w-3 h-3 mr-1"}),"Cancelled"]});default:return(0,se.jsx)(gk,{variant:"secondary",children:e})}},S=e=>e&&"pending"!==e?"paid"===e?(0,se.jsx)(gk,{className:"bg-teal-100 text-teal-700 border-teal-200",children:"Paid"}):(0,se.jsx)(gk,{variant:"secondary",children:e}):(0,se.jsx)(gk,{variant:"outline",className:"text-slate-600 border-slate-300",children:"Unpaid"}),E=l.filter(e=>{var t,s,a;if(!p)return!0;const n=p.toLowerCase();return e.id.toLowerCase().includes(n)||(null===(t=e.seller_email)||void 0===t?void 0:t.toLowerCase().includes(n))||(null===(s=e.seller_name)||void 0===s?void 0:s.toLowerCase().includes(n))||(null===(a=e.item_name)||void 0===a?void 0:a.toLowerCase().includes(n))});return(0,se.jsxs)("div",{className:"space-y-6",children:[i&&(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(Pf.A,{className:"h-4 w-4"}),"Total Revenue"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsxs)("div",{className:"text-2xl font-bold text-slate-900",children:["$",i.total_revenue.toFixed(2)]}),(0,se.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[i.total_transactions," transactions"]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(OJ.A,{className:"h-4 w-4"}),"Seller Earnings"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsxs)("div",{className:"text-2xl font-bold text-slate-900",children:["$",i.total_seller_earnings.toFixed(2)]}),(0,se.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["$",i.total_platform_fees.toFixed(2)," platform fees"]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(jS.A,{className:"h-4 w-4"}),"Unpaid Amount"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:["$",i.unpaid_amount.toFixed(2)]}),(0,se.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[i.unpaid_count," pending payouts"]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(hb.A,{className:"h-4 w-4"}),"Paid Out"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-emerald-600",children:i.paid_out_count}),(0,se.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"transactions paid"})]})]})]}),(0,se.jsx)(Bv,{className:"border-slate-200",children:(0,se.jsx)(Wv,{className:"py-4",children:(0,se.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,se.jsxs)("div",{className:"relative flex-1 min-w-[250px] max-w-md",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-slate-400"}),(0,se.jsx)(Df,{placeholder:"Search transactions, sellers, items...",value:p,onChange:e=>g(e.target.value),className:"pl-9 border-slate-200"})]}),(0,se.jsxs)(Wf,{value:f,onValueChange:e=>v(e),children:[(0,se.jsx)(Yf,{className:"w-[150px] border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Status"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Status"}),(0,se.jsx)(Zf,{value:"completed",children:"Completed"}),(0,se.jsx)(Zf,{value:"pending",children:"Pending"}),(0,se.jsx)(Zf,{value:"cancelled",children:"Cancelled"})]})]}),(0,se.jsxs)(Wf,{value:b,onValueChange:e=>j(e),children:[(0,se.jsx)(Yf,{className:"w-[150px] border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Payout Status"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Payouts"}),(0,se.jsx)(Zf,{value:"pending",children:"Unpaid"}),(0,se.jsx)(Zf,{value:"paid",children:"Paid"})]})]}),(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{g(""),v("completed"),j("all"),_(0)},className:"border-slate-200",children:[(0,se.jsx)(la.A,{className:"h-4 w-4 mr-1"}),"Reset"]}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:C,disabled:c,className:"border-slate-200",children:c?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):"Refresh"})]})})}),(0,se.jsx)(Bv,{className:"border-slate-200",children:(0,se.jsx)(Wv,{className:"p-0",children:(0,se.jsxs)(pD,{children:[(0,se.jsx)(gD,{children:(0,se.jsxs)(vD,{className:"bg-slate-50",children:[(0,se.jsx)(bD,{className:"cursor-pointer hover:bg-slate-100",onClick:()=>(e=>{const t=y===e?"-".concat(e):y==="-".concat(e)?e:"-".concat(e);N(t)})("created_date"),children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:["Date",(0,se.jsx)(yH.A,{className:"h-3 w-3"})]})}),(0,se.jsx)(bD,{children:"Transaction ID"}),(0,se.jsx)(bD,{children:"Seller"}),(0,se.jsx)(bD,{children:"Item"}),(0,se.jsx)(bD,{className:"text-right",children:"Amount"}),(0,se.jsx)(bD,{className:"text-right",children:"Earnings"}),(0,se.jsx)(bD,{children:"Status"}),(0,se.jsx)(bD,{children:"Payout"}),(0,se.jsx)(bD,{})]})}),(0,se.jsx)(fD,{children:c?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:9,className:"text-center py-8",children:(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin mx-auto text-slate-400"})})}):0===E.length?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:9,className:"text-center py-8 text-slate-500",children:"No transactions found"})}):E.map(e=>{var t,s;return(0,se.jsxs)(vD,{className:"hover:bg-slate-50",children:[(0,se.jsx)(jD,{className:"text-sm text-slate-600",children:null!==(t=e.payment_info)&&void 0!==t&&t.completed_at?(0,z_.GP)(new Date(e.payment_info.completed_at),"MMM d, yyyy"):(0,z_.GP)(new Date(e.created_date),"MMM d, yyyy")}),(0,se.jsxs)(jD,{className:"font-mono text-xs text-slate-500",children:[e.id.slice(0,8),"..."]}),(0,se.jsx)(jD,{children:(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-900",children:e.seller_name||e.seller_email}),e.seller_payout_id&&(0,se.jsx)("p",{className:"text-xs text-slate-500",children:e.seller_payout_id})]})}),(0,se.jsx)(jD,{className:"text-sm text-slate-700",children:e.item_name||"Unknown"}),(0,se.jsxs)(jD,{className:"text-right font-medium",children:["$",e.pricing_info.price_usd.toFixed(2)]}),(0,se.jsxs)(jD,{className:"text-right font-medium text-emerald-600",children:["$",e.pricing_info.seller_earnings_usd.toFixed(2)]}),(0,se.jsx)(jD,{children:A(e.status)}),(0,se.jsx)(jD,{children:S(null===(s=e.payout_info)||void 0===s?void 0:s.status)}),(0,se.jsx)(jD,{children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>(async e=>{try{const t=await HJ.getTransaction(e.id);m(t),h(!0)}catch(t){so({title:"Error",description:t.message||"Failed to load transaction details",variant:"destructive"})}})(e),className:"h-8 w-8 p-0",children:(0,se.jsx)(bs.A,{className:"h-4 w-4"})})})]},e.id)})})]})})}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("p",{className:"text-sm text-slate-500",children:["Showing ",E.length," transactions"]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",disabled:0===w,onClick:()=>_(Math.max(0,w-k)),children:"Previous"}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",disabled:l.length<k,onClick:()=>_(w+k),children:"Next"})]})]}),(0,se.jsx)(Og,{open:x,onOpenChange:h,children:(0,se.jsxs)(Hg,{className:"max-w-2xl",children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{children:"Transaction Details"})}),u&&(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Transaction ID"}),(0,se.jsx)("p",{className:"font-mono text-sm",children:u.id})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Status"}),A(u.status)]})]}),(0,se.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Buyer"}),(0,se.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-slate-600",children:"Email"}),(0,se.jsx)("span",{className:"font-medium",children:u.buyer_email||u.buyer_id})]}),u.buyer_name&&u.buyer_name!==u.buyer_email&&(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-slate-600",children:"Name"}),(0,se.jsx)("span",{children:u.buyer_name})]})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Quick Links"}),(0,se.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,se.jsxs)("a",{href:"".concat(window.location.origin,"/apps/").concat(u.item_info.app_id,"/editor/preview"),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-200 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 hover:border-slate-300 transition-colors",children:[(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5"}),"App Dashboard"]}),(0,se.jsxs)("a",{href:"".concat(window.location.origin,"/app-templates/").concat(u.item_info.marketplace_item_id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-200 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 hover:border-slate-300 transition-colors",children:[(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5"}),"Listing Page"]}),(null===(e=u.payment_info)||void 0===e?void 0:e.stripe_payment_intent_id)&&(0,se.jsxs)("a",{href:"https://dashboard.stripe.com/payments/".concat(u.payment_info.stripe_payment_intent_id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-200 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 hover:border-slate-300 transition-colors",children:[(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5"}),"Stripe Payment"]})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Pricing Breakdown"}),(0,se.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-slate-600",children:"Subtotal"}),(0,se.jsxs)("span",{children:["$",u.pricing_info.subtotal_usd.toFixed(2)]})]}),u.pricing_info.tax_amount_usd>0&&(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-slate-600",children:"Tax"}),(0,se.jsxs)("span",{children:["$",u.pricing_info.tax_amount_usd.toFixed(2)]})]}),(0,se.jsxs)("div",{className:"flex justify-between font-medium border-t pt-2",children:[(0,se.jsx)("span",{children:"Total Paid"}),(0,se.jsxs)("span",{children:["$",u.pricing_info.price_usd.toFixed(2)]})]}),(0,se.jsxs)("div",{className:"flex justify-between text-slate-500",children:[(0,se.jsx)("span",{children:"Platform Fee"}),(0,se.jsxs)("span",{children:["$",u.pricing_info.platform_fee_usd.toFixed(2)]})]}),(0,se.jsxs)("div",{className:"flex justify-between font-medium text-emerald-600",children:[(0,se.jsx)("span",{children:"Seller Earnings"}),(0,se.jsxs)("span",{children:["$",u.pricing_info.seller_earnings_usd.toFixed(2)]})]})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Payout Status"}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[S(null===(t=u.payout_info)||void 0===t?void 0:t.status),(null===(s=u.payout_info)||void 0===s?void 0:s.payout_batch_id)&&(0,se.jsxs)("span",{className:"text-sm text-slate-500",children:["Batch: ",u.payout_info.payout_batch_id.slice(0,8),"..."]}),(null===(a=u.payout_info)||void 0===a?void 0:a.paid_at)&&(0,se.jsxs)("span",{className:"text-sm text-slate-500",children:["Paid on ",(0,z_.GP)(new Date(u.payout_info.paid_at),"MMM d, yyyy")]})]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-slate-500",children:"Created"}),(0,se.jsx)("p",{children:(0,z_.GP)(new Date(u.created_date),"PPpp")})]}),(null===(n=u.payment_info)||void 0===n?void 0:n.completed_at)&&(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-slate-500",children:"Payment Completed"}),(0,se.jsx)("p",{children:(0,z_.GP)(new Date(u.payment_info.completed_at),"PPpp")})]})]})]})]})})]})}function WJ(){var e,t,s,a,n,l,r;const[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)(0),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!0),[p,g]=(0,Y.useState)(null),[f,v]=(0,Y.useState)(!1),[b,j]=(0,Y.useState)(""),[y,N]=(0,Y.useState)("all"),[w,_]=(0,Y.useState)("all"),k="-created_date",[C,A]=(0,Y.useState)(0),[S]=(0,Y.useState)(50),E=(0,Y.useCallback)(async()=>{try{const e=await HJ.getSellersSummary();m(e)}catch(e){}},[]),T=(0,Y.useCallback)(async()=>{h(!0);try{const e=await HJ.listSellers({limit:S,offset:C,search:b||void 0,onboarding_status:y,has_transactions:"all"===w?void 0:"yes"===w,sort_by:k});o(e.sellers),d(e.total)}catch(e){so({title:"Error",description:e.message||"Failed to load sellers",variant:"destructive"})}finally{h(!1)}},[S,C,b,y,w,k]);(0,Y.useEffect)(()=>{E()},[E]),(0,Y.useEffect)(()=>{const e=setTimeout(()=>{T()},b?300:0);return()=>clearTimeout(e)},[T]);const I=e=>"completed"===e?(0,se.jsxs)(gk,{className:"bg-emerald-100 text-emerald-700 border-emerald-200",children:[(0,se.jsx)(hb.A,{className:"w-3 h-3 mr-1"}),"Completed"]}):(0,se.jsxs)(gk,{variant:"outline",className:"text-slate-500 border-slate-300",children:[(0,se.jsx)(ad.A,{className:"w-3 h-3 mr-1"}),"Not Started"]});return(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(eb.A,{className:"h-4 w-4"}),"Total Sellers"]})}),(0,se.jsx)(Wv,{children:(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:null!==(e=null==u?void 0:u.total_sellers)&&void 0!==e?e:c})})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(hb.A,{className:"h-4 w-4"}),"Onboarding Completed"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-emerald-600",children:null!==(t=null==u?void 0:u.onboarding_completed)&&void 0!==t?t:0}),u&&u.total_sellers>0&&(0,se.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[(u.onboarding_completed/u.total_sellers*100).toFixed(0),"% of sellers"]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(OJ.A,{className:"h-4 w-4"}),"Total Unpaid Earnings"]})}),(0,se.jsx)(Wv,{children:(0,se.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:["$",(null!==(s=null==u?void 0:u.total_unpaid_earnings)&&void 0!==s?s:0).toFixed(2)]})})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),"Not Started"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-600",children:null!==(a=null==u?void 0:u.onboarding_not_started)&&void 0!==a?a:0}),(0,se.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"need onboarding"})]})]})]}),(0,se.jsx)(Bv,{className:"border-slate-200",children:(0,se.jsx)(Wv,{className:"py-4",children:(0,se.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,se.jsxs)("div",{className:"relative flex-1 min-w-[250px] max-w-md",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-slate-400"}),(0,se.jsx)(Df,{placeholder:"Search by email or name...",value:b,onChange:e=>j(e.target.value),className:"pl-9 border-slate-200"})]}),(0,se.jsxs)(Wf,{value:y,onValueChange:N,children:[(0,se.jsx)(Yf,{className:"w-[170px] border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Onboarding Status"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Status"}),(0,se.jsx)(Zf,{value:"not_started",children:"Not Started"}),(0,se.jsx)(Zf,{value:"completed",children:"Completed"})]})]}),(0,se.jsxs)(Wf,{value:w,onValueChange:_,children:[(0,se.jsx)(Yf,{className:"w-[150px] border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Transactions"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"all",children:"All Sellers"}),(0,se.jsx)(Zf,{value:"yes",children:"Has Sales"}),(0,se.jsx)(Zf,{value:"no",children:"No Sales"})]})]}),(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:()=>{j(""),N("all"),_("all"),A(0)},className:"border-slate-200",children:[(0,se.jsx)(la.A,{className:"h-4 w-4 mr-1"}),"Reset"]}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:T,disabled:x,className:"border-slate-200",children:x?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):"Refresh"})]})})}),(0,se.jsx)(Bv,{className:"border-slate-200",children:(0,se.jsx)(Wv,{className:"p-0",children:(0,se.jsxs)(pD,{children:[(0,se.jsx)(gD,{children:(0,se.jsxs)(vD,{className:"bg-slate-50",children:[(0,se.jsx)(bD,{children:"Seller"}),(0,se.jsx)(bD,{children:"Onboarding"}),(0,se.jsx)(bD,{className:"text-right",children:"Transactions"}),(0,se.jsx)(bD,{className:"text-right",children:"Total Earnings"}),(0,se.jsx)(bD,{className:"text-right",children:"Unpaid"}),(0,se.jsx)(bD,{children:"Actions"})]})}),(0,se.jsx)(fD,{children:x?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:6,className:"text-center py-8",children:(0,se.jsx)(Ac.A,{className:"h-6 w-6 animate-spin mx-auto text-slate-400"})})}):0===i.length?(0,se.jsx)(vD,{children:(0,se.jsx)(jD,{colSpan:6,className:"text-center py-8 text-slate-500",children:"No sellers found"})}):i.map(e=>(0,se.jsxs)(vD,{className:"hover:bg-slate-50",children:[(0,se.jsx)(jD,{children:(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"font-medium text-slate-900",children:e.full_name||e.business_name||e.email}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:e.email}),e.country&&(0,se.jsx)("p",{className:"text-xs text-slate-400",children:e.country})]})}),(0,se.jsx)(jD,{children:I(e.onboarding_status)}),(0,se.jsx)(jD,{className:"text-right font-medium",children:e.transaction_count}),(0,se.jsxs)(jD,{className:"text-right font-medium",children:["$",e.total_earnings.toFixed(2)]}),(0,se.jsxs)(jD,{className:"text-right font-medium text-orange-600",children:["$",e.unpaid_earnings.toFixed(2)]}),(0,se.jsx)(jD,{children:(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:()=>(async e=>{try{const t=await HJ.getSellerDetail(e.user_id);g(t),v(!0)}catch(t){so({title:"Error",description:t.message||"Failed to load seller details",variant:"destructive"})}})(e),className:"h-8 w-8 p-0",children:(0,se.jsx)(bs.A,{className:"h-4 w-4"})})})]},e.user_id))})]})})}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("p",{className:"text-sm text-slate-500",children:["Showing ",C+1,"-",Math.min(C+i.length,c)," of ",c," sellers"]}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Bx,{variant:"outline",size:"sm",disabled:0===C,onClick:()=>A(Math.max(0,C-S)),children:"Previous"}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",disabled:C+i.length>=c,onClick:()=>A(C+S),children:"Next"})]})]}),(0,se.jsx)(Og,{open:f,onOpenChange:v,children:(0,se.jsxs)(Hg,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,se.jsx)(Vg,{children:(0,se.jsx)(qg,{children:"Seller Details"})}),p&&(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Name"}),(0,se.jsx)("p",{className:"font-medium",children:p.full_name||"\u2014"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Email"}),(0,se.jsx)("p",{className:"font-medium",children:p.email})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Business Name"}),(0,se.jsx)("p",{className:"font-medium",children:(null===(n=p.marketplace_profile)||void 0===n?void 0:n.business_name)||"\u2014"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Country"}),(0,se.jsx)("p",{className:"font-medium",children:(null===(l=p.marketplace_profile)||void 0===l?void 0:l.country)||"\u2014"})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Onboarding Status"}),(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[I(p.onboarding_status),(null===(r=p.marketplace_profile)||void 0===r?void 0:r.onboarding_completed)&&(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"Completed"})]})]}),(0,se.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,se.jsx)("h4",{className:"font-medium text-slate-900 mb-3",children:"Earnings Summary"}),(0,se.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Total Earnings"}),(0,se.jsxs)("p",{className:"text-xl font-bold text-slate-900",children:["$",p.total_earnings.toFixed(2)]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Paid Out"}),(0,se.jsxs)("p",{className:"text-xl font-bold text-emerald-600",children:["$",p.paid_earnings.toFixed(2)]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Unpaid"}),(0,se.jsxs)("p",{className:"text-xl font-bold text-orange-600",children:["$",p.unpaid_earnings.toFixed(2)]})]})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsxs)("h4",{className:"font-medium text-slate-900 mb-3",children:["Recent Transactions (",p.transaction_count,")"]}),p.transactions.length>0?(0,se.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,se.jsxs)(pD,{children:[(0,se.jsx)(gD,{children:(0,se.jsxs)(vD,{className:"bg-slate-50",children:[(0,se.jsx)(bD,{children:"Date"}),(0,se.jsx)(bD,{className:"text-right",children:"Amount"}),(0,se.jsx)(bD,{className:"text-right",children:"Earnings"}),(0,se.jsx)(bD,{children:"Status"})]})}),(0,se.jsx)(fD,{children:p.transactions.slice(0,10).map(e=>{var t,s,a;return(0,se.jsxs)(vD,{children:[(0,se.jsx)(jD,{className:"text-sm",children:(0,z_.GP)(new Date(e.created_date),"MMM d, yyyy")}),(0,se.jsxs)(jD,{className:"text-right",children:["$",e.pricing_info.price_usd.toFixed(2)]}),(0,se.jsxs)(jD,{className:"text-right text-emerald-600 font-medium",children:["$",e.pricing_info.seller_earnings_usd.toFixed(2)]}),(0,se.jsx)(jD,{children:(0,se.jsx)(gk,{variant:"paid"===(null===(t=e.payout_info)||void 0===t?void 0:t.status)?"default":"outline",className:"paid"===(null===(s=e.payout_info)||void 0===s?void 0:s.status)?"bg-teal-100 text-teal-700":"",children:"paid"===(null===(a=e.payout_info)||void 0===a?void 0:a.status)?"Paid":"Pending"})})]},e.id)})})]})}):(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"No transactions yet"})]}),p.marketplace_profile&&(0,se.jsxs)("div",{className:"flex gap-3",children:[p.marketplace_profile.website_url&&(0,se.jsxs)("a",{href:p.marketplace_profile.website_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[(0,se.jsx)(Rj.A,{className:"h-3 w-3"}),"Website"]}),p.marketplace_profile.linkedin_url&&(0,se.jsxs)("a",{href:p.marketplace_profile.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[(0,se.jsx)(Rj.A,{className:"h-3 w-3"}),"LinkedIn"]})]})]})]})})]})}var qJ=s(11440),YJ=s(99438),GJ=s(85106),KJ=s(82681);const $J={primary:"#0f172a",orange:"#f97316",teal:"#14b8a6",completed:"#10b981",pending:"#f59e0b",cancelled:"#ef4444",revenue:"#3b82f6",earnings:"#10b981",fees:"#8b5cf6"};function ZJ(){const[e,t]=(0,Y.useState)(null),[s,a]=(0,Y.useState)(!0),[n,l]=(0,Y.useState)(30),[r,i]=(0,Y.useState)("day"),o=(0,Y.useCallback)(async()=>{a(!0);try{const e=await HJ.getAnalytics({days:n,granularity:r});t(e)}catch(e){so({title:"Error",description:e.message||"Failed to load analytics",variant:"destructive"})}finally{a(!1)}},[n,r]);(0,Y.useEffect)(()=>{o()},[o]);const c=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),d=e=>{if(null===e)return"N/A";return"".concat(e>=0?"+":"").concat(e.toFixed(1),"%")},u=e=>null===e?null:e>=0?(0,se.jsx)(au.A,{className:"h-4 w-4 text-emerald-500"}):(0,se.jsx)(qJ.A,{className:"h-4 w-4 text-red-500"}),m=e=>null===e?"text-slate-500":e>=0?"text-emerald-600":"text-red-600",x=e?[{name:"Completed",value:e.completed_count,color:$J.completed},{name:"Pending",value:e.pending_count,color:$J.pending},{name:"Cancelled",value:e.cancelled_count,color:$J.cancelled}].filter(e=>e.value>0):[],h=e=>{let{active:t,payload:s,label:a}=e;return t&&s&&s.length?(0,se.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg shadow-lg p-3",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-slate-900 mb-2",children:(0,z_.GP)(new Date(a),"MMM d, yyyy")}),s.map((e,t)=>(0,se.jsxs)("p",{className:"text-sm",style:{color:e.color},children:[e.name,": ",e.name.includes("Revenue")||e.name.includes("Earnings")?c(e.value):e.value]},t))]}):null};return s&&!e?(0,se.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-slate-400"})}):(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsxs)(Wf,{value:String(n),onValueChange:e=>l(Number(e)),children:[(0,se.jsx)(Yf,{className:"w-[150px] border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Time Range"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"7",children:"Last 7 days"}),(0,se.jsx)(Zf,{value:"30",children:"Last 30 days"}),(0,se.jsx)(Zf,{value:"90",children:"Last 90 days"}),(0,se.jsx)(Zf,{value:"180",children:"Last 6 months"}),(0,se.jsx)(Zf,{value:"365",children:"Last year"})]})]}),(0,se.jsxs)(Wf,{value:r,onValueChange:e=>i(e),children:[(0,se.jsx)(Yf,{className:"w-[150px] border-slate-200",children:(0,se.jsx)(qf,{placeholder:"Granularity"})}),(0,se.jsxs)($f,{children:[(0,se.jsx)(Zf,{value:"day",children:"Daily"}),(0,se.jsx)(Zf,{value:"week",children:"Weekly"}),(0,se.jsx)(Zf,{value:"month",children:"Monthly"})]})]})]}),(0,se.jsx)(Bx,{variant:"outline",size:"sm",onClick:o,disabled:s,className:"border-slate-200",children:s?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Fx.A,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(OJ.A,{className:"h-4 w-4"}),"Total Revenue"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:c(e.total_revenue)}),(0,se.jsxs)("div",{className:"flex items-center gap-1 text-sm mt-1 ".concat(m(e.revenue_change_pct)),children:[u(e.revenue_change_pct),(0,se.jsxs)("span",{children:[d(e.revenue_change_pct)," vs prev period"]})]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(YJ.A,{className:"h-4 w-4"}),"Transactions"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:e.completed_count}),(0,se.jsxs)("div",{className:"flex items-center gap-1 text-sm mt-1 ".concat(m(e.transaction_change_pct)),children:[u(e.transaction_change_pct),(0,se.jsxs)("span",{children:[d(e.transaction_change_pct)," vs prev period"]})]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(Pf.A,{className:"h-4 w-4"}),"Avg. Order Value"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:c(e.avg_transaction_value)}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Per completed transaction"})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsxs)(Hv,{className:"text-sm font-medium text-slate-600 flex items-center gap-2",children:[(0,se.jsx)(GJ.A,{className:"h-4 w-4"}),"Completion Rate"]})}),(0,se.jsxs)(Wv,{children:[(0,se.jsxs)("div",{className:"text-2xl font-bold text-slate-900",children:[e.completion_rate.toFixed(1),"%"]}),(0,se.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[e.completed_count," of ",e.completed_count+e.cancelled_count," finalized"]})]})]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,se.jsxs)(Bv,{className:"border-slate-200 lg:col-span-2",children:[(0,se.jsxs)(zv,{children:[(0,se.jsx)(Hv,{className:"text-lg",children:"Revenue Over Time"}),(0,se.jsxs)(Vv,{children:[(0,z_.GP)(new Date(e.date_from),"MMM d, yyyy")," - ",(0,z_.GP)(new Date(e.date_to),"MMM d, yyyy")]})]}),(0,se.jsx)(Wv,{children:e.time_series.length>0?(0,se.jsx)(JC.u,{width:"100%",height:300,children:(0,se.jsxs)(QC.Q,{data:e.time_series,children:[(0,se.jsx)("defs",{children:(0,se.jsxs)("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,se.jsx)("stop",{offset:"5%",stopColor:$J.revenue,stopOpacity:.3}),(0,se.jsx)("stop",{offset:"95%",stopColor:$J.revenue,stopOpacity:0})]})}),(0,se.jsx)(XC.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,se.jsx)(eA.W,{dataKey:"date",tickFormatter:e=>(0,z_.GP)(new Date(e),"MMM d"),stroke:"#94a3b8",fontSize:12}),(0,se.jsx)(tA.h,{tickFormatter:e=>"$".concat(e),stroke:"#94a3b8",fontSize:12}),(0,se.jsx)(aA.m,{content:(0,se.jsx)(h,{})}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:$J.revenue,fillOpacity:1,fill:"url(#colorRevenue)",strokeWidth:2})]})}):(0,se.jsx)("div",{className:"flex items-center justify-center h-[300px] text-slate-500",children:"No data available for this period"})})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsxs)(zv,{children:[(0,se.jsx)(Hv,{className:"text-lg",children:"Transaction Status"}),(0,se.jsxs)(Vv,{children:["Distribution of ",e.total_transactions," transactions"]})]}),(0,se.jsx)(Wv,{children:x.length>0?(0,se.jsx)(JC.u,{width:"100%",height:300,children:(0,se.jsxs)(fA.r,{children:[(0,se.jsx)(vA.F,{data:x,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",children:x.map((e,t)=>(0,se.jsx)(bA.f,{fill:e.color},"cell-".concat(t)))}),(0,se.jsx)(aA.m,{formatter:(e,t)=>[e,t]}),(0,se.jsx)(KJ.s,{verticalAlign:"bottom",height:36,formatter:e=>(0,se.jsx)("span",{className:"text-sm text-slate-600",children:e})})]})}):(0,se.jsx)("div",{className:"flex items-center justify-center h-[300px] text-slate-500",children:"No transactions in this period"})})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsxs)(zv,{children:[(0,se.jsx)(Hv,{className:"text-lg",children:"Transaction Volume"}),(0,se.jsx)(Vv,{children:"Completed vs Pending vs Cancelled transactions"})]}),(0,se.jsx)(Wv,{children:e.time_series.length>0?(0,se.jsx)(JC.u,{width:"100%",height:250,children:(0,se.jsxs)(QC.Q,{data:e.time_series,children:[(0,se.jsxs)("defs",{children:[(0,se.jsxs)("linearGradient",{id:"colorCompleted",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,se.jsx)("stop",{offset:"5%",stopColor:$J.completed,stopOpacity:.3}),(0,se.jsx)("stop",{offset:"95%",stopColor:$J.completed,stopOpacity:0})]}),(0,se.jsxs)("linearGradient",{id:"colorPending",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,se.jsx)("stop",{offset:"5%",stopColor:$J.pending,stopOpacity:.3}),(0,se.jsx)("stop",{offset:"95%",stopColor:$J.pending,stopOpacity:0})]}),(0,se.jsxs)("linearGradient",{id:"colorCancelled",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,se.jsx)("stop",{offset:"5%",stopColor:$J.cancelled,stopOpacity:.3}),(0,se.jsx)("stop",{offset:"95%",stopColor:$J.cancelled,stopOpacity:0})]})]}),(0,se.jsx)(XC.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,se.jsx)(eA.W,{dataKey:"date",tickFormatter:e=>(0,z_.GP)(new Date(e),"MMM d"),stroke:"#94a3b8",fontSize:12}),(0,se.jsx)(tA.h,{stroke:"#94a3b8",fontSize:12}),(0,se.jsx)(aA.m,{content:(0,se.jsx)(h,{})}),(0,se.jsx)(KJ.s,{verticalAlign:"top",height:36,formatter:e=>(0,se.jsx)("span",{className:"text-sm text-slate-600",children:e})}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"completed",name:"Completed",stackId:"1",stroke:$J.completed,fill:"url(#colorCompleted)"}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"pending",name:"Pending",stackId:"1",stroke:$J.pending,fill:"url(#colorPending)"}),(0,se.jsx)(sA.G,{type:"monotone",dataKey:"cancelled",name:"Cancelled",stackId:"1",stroke:$J.cancelled,fill:"url(#colorCancelled)"})]})}):(0,se.jsx)("div",{className:"flex items-center justify-center h-[250px] text-slate-500",children:"No data available for this period"})})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsxs)(zv,{children:[(0,se.jsxs)(Hv,{className:"text-lg flex items-center gap-2",children:[(0,se.jsx)(eb.A,{className:"h-5 w-5"}),"Top Sellers"]}),(0,se.jsx)(Vv,{children:"Top 10 sellers by revenue in this period"})]}),(0,se.jsx)(Wv,{children:e.top_sellers.length>0?(0,se.jsx)(JC.u,{width:"100%",height:Math.max(200,40*e.top_sellers.length),children:(0,se.jsxs)(xA.E,{data:e.top_sellers,layout:"vertical",margin:{left:100,right:20},children:[(0,se.jsx)(XC.d,{strokeDasharray:"3 3",stroke:"#e2e8f0",horizontal:!1}),(0,se.jsx)(eA.W,{type:"number",tickFormatter:e=>"$".concat(e),stroke:"#94a3b8",fontSize:12}),(0,se.jsx)(tA.h,{type:"category",dataKey:"name",width:100,tickFormatter:e=>e||"Unknown",stroke:"#94a3b8",fontSize:12}),(0,se.jsx)(aA.m,{formatter:e=>[c(e),"Revenue"],labelFormatter:e=>"Seller: ".concat(e||"Unknown")}),(0,se.jsx)(hA.y,{dataKey:"total_revenue",name:"Revenue",fill:$J.teal,radius:[0,4,4,0]})]})}):(0,se.jsx)("div",{className:"flex items-center justify-center h-[200px] text-slate-500",children:"No seller data available for this period"})})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsx)(Hv,{className:"text-sm font-medium text-slate-600",children:"Seller Earnings"})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-emerald-600",children:c(e.total_seller_earnings)}),(0,se.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[(e.total_seller_earnings/e.total_revenue*100||0).toFixed(1),"% of revenue"]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsx)(Hv,{className:"text-sm font-medium text-slate-600",children:"Platform Fees"})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-violet-600",children:c(e.total_platform_fees)}),(0,se.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[(e.total_platform_fees/e.total_revenue*100||0).toFixed(1),"% of revenue"]})]})]}),(0,se.jsxs)(Bv,{className:"border-slate-200",children:[(0,se.jsx)(zv,{className:"pb-2",children:(0,se.jsx)(Hv,{className:"text-sm font-medium text-slate-600",children:"Previous Period"})}),(0,se.jsxs)(Wv,{children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-600",children:c(e.prev_period_revenue)}),(0,se.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[e.prev_period_transactions," transactions"]})]})]})]})]})]})}function JJ(){const{user:e}=wd(),[t,s]=(0,Y.useState)("analytics");return $p(null==e?void 0:e.platform_role)?(0,se.jsx)("div",{className:"min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-[1400px]",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-8",children:[(0,se.jsx)("div",{className:"p-2.5 bg-orange-100 rounded-xl",children:(0,se.jsx)(FJ.A,{className:"h-6 w-6 text-orange-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"App Template Marketplace"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-0.5",children:"Manage transactions and sellers"})]})]}),(0,se.jsxs)(Kj,{value:t,onValueChange:s,className:"space-y-6",children:[(0,se.jsxs)($j,{className:"bg-white border border-slate-200 p-1 rounded-lg shadow-sm",children:[(0,se.jsx)(Zj,{value:"analytics",className:"data-[state=active]:bg-slate-900 data-[state=active]:text-white px-6",children:"Analytics"}),(0,se.jsx)(Zj,{value:"transactions",className:"data-[state=active]:bg-slate-900 data-[state=active]:text-white px-6",children:"Transactions"}),(0,se.jsx)(Zj,{value:"sellers",className:"data-[state=active]:bg-slate-900 data-[state=active]:text-white px-6",children:"Sellers"})]}),(0,se.jsx)(Jj,{value:"analytics",className:"mt-6",children:(0,se.jsx)(ZJ,{})}),(0,se.jsx)(Jj,{value:"transactions",className:"mt-6",children:(0,se.jsx)(VJ,{})}),(0,se.jsx)(Jj,{value:"sellers",className:"mt-6",children:(0,se.jsx)(WJ,{})})]})]})}):(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(jH.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,se.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}var QJ=s(61168);function XJ(e){let{previewConfig:t,liveConfig:s,hasChanges:a}=e;const n=s&&!s.onlyOnHomepage,l=s&&!n;return(0,se.jsxs)("div",{className:"sticky top-0 z-50 bg-white shadow-sm",children:[n&&(0,se.jsxs)("div",{className:"bg-blue-50 border-b border-blue-200 px-4 py-2 flex items-center gap-2",children:[(0,se.jsx)(KP.A,{className:"w-4 h-4 text-blue-600"}),(0,se.jsx)("span",{className:"text-xs font-medium text-blue-700",children:"Platform-wide banner is active \u2014 visible on all pages including this one (shown above)"})]}),l&&(0,se.jsxs)("div",{children:[(0,se.jsx)(eQ,{icon:(0,se.jsx)(QJ.A,{className:"w-3 h-3"}),label:"Live on Homepage",variant:"live"}),(0,se.jsx)(gH,{config:s})]}),(0,se.jsxs)("div",{className:l?"border-t border-slate-200":"",children:[(0,se.jsx)(eQ,{icon:(0,se.jsx)(lA.A,{className:"w-3 h-3"}),label:s?"Preview (Draft)":"Preview",variant:"preview",showChangeIndicator:a&&!!s}),(0,se.jsx)("div",{className:a&&s?"ring-2 ring-orange-400 ring-inset":"",children:(0,se.jsx)(gH,{config:t})})]})]})}function eQ(e){let{icon:t,label:s,variant:a,showChangeIndicator:n}=e;const l="live"===a;return(0,se.jsxs)("div",{className:"\n      border-b px-4 py-2 flex items-center justify-between\n      ".concat(l?"bg-green-50 border-green-200":"bg-slate-100 border-slate-200","\n    "),children:[(0,se.jsxs)("span",{className:"\n        text-xs font-medium uppercase tracking-wide flex items-center gap-1.5\n        ".concat(l?"text-green-700":"text-slate-500","\n      "),children:[t,s]}),l&&(0,se.jsxs)("span",{className:"text-xs font-medium text-green-600 flex items-center gap-1",children:[(0,se.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Currently Active"]}),n&&(0,se.jsxs)("span",{className:"text-xs font-medium text-orange-600 flex items-center gap-1",children:[(0,se.jsx)("span",{className:"w-2 h-2 bg-orange-500 rounded-full"}),"Unsaved Changes"]})]})}var tQ=s(99602),sQ=s(83210);const aQ=[{value:"red",label:"Red (Critical)",preview:"bg-red-600"},{value:"amber",label:"Amber (Warning)",preview:"bg-amber-500"},{value:"transparent",label:"Transparent (Info)",preview:"bg-slate-100 border border-slate-200"},{value:"custom",label:"Custom Hex Color",preview:"bg-gradient-to-r from-purple-500 to-pink-500"}],nQ=[{value:"alert",label:"Alert Circle"},{value:"warning",label:"Warning Triangle"},{value:"info",label:"Info"},{value:"none",label:"No Icon"}],lQ=["red","amber","transparent"],rQ={color:"red",text:"We're aware of a technical issue affecting some services. We're working to resolve it as quickly as possible.",link_status_page:!0,status_page_url:"https://status.base44.com",status_page_link_text:"Status Page",icon:"alert",text_color:null,only_on_homepage:!0,dismissable:!1};function iQ(e){let{color:t,textColor:s,useCustomColor:a,onColorChange:n,onTextColorChange:l,onPresetChange:r}=e;return(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{children:"Color"}),(0,se.jsxs)(Wf,{value:a?"custom":t,onValueChange:r,children:[(0,se.jsx)(Yf,{children:(0,se.jsx)(qf,{placeholder:"Select color"})}),(0,se.jsx)($f,{children:aQ.map(e=>(0,se.jsx)(Zf,{value:e.value,children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:de("w-4 h-4 rounded",e.preview)}),(0,se.jsx)("span",{children:e.label})]})},e.value))})]}),a&&(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[(0,se.jsx)(oQ,{id:"custom-color",label:"Background Color",value:t,onChange:n,placeholder:"#BADA55"}),(0,se.jsx)(oQ,{id:"text-color",label:"Text Color",value:s||"#FFFFFF",onChange:l,placeholder:"#FFFFFF"})]})]})}function oQ(e){let{id:t,label:s,value:a,onChange:n,placeholder:l}=e;const r=a.startsWith("#")?a:"#000000";return(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:t,children:s}),(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(Df,{id:t,type:"text",value:a,onChange:e=>n(e.target.value),placeholder:l,className:"font-mono"}),(0,se.jsx)("input",{type:"color",value:r,onChange:e=>n(e.target.value),className:"h-10 w-10 rounded border border-slate-200 cursor-pointer"})]})]})}function cQ(e){let{form:t,useCustomColor:s,isActive:a,isSaving:n,isActivating:l,isDeactivating:r,isPolishing:i,onFormChange:o,onColorPresetChange:c,onSave:d,onActivate:u,onDeactivate:m,onPolish:x}=e;return(0,se.jsxs)(Bv,{className:"mb-8",children:[(0,se.jsxs)(zv,{children:[(0,se.jsx)(Hv,{children:"Banner Configuration"}),(0,se.jsx)(Vv,{children:a?"Edit the currently active banner or deactivate it":"Configure a new banner to activate"})]}),(0,se.jsxs)(Wv,{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)(aN,{htmlFor:"text",children:"Banner Text"}),(0,se.jsxs)(Bx,{type:"button",variant:"ghost",size:"sm",onClick:x,disabled:!t.text.trim()||i,className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100 h-7 px-2",title:"Polish with AI (\u2318K)",children:[i?(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin"}):(0,se.jsx)(_P.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"ml-1.5 text-xs",children:"Polish"})]})]}),(0,se.jsx)(tN,{id:"text",value:t.text,onChange:e=>o({text:e.target.value}),placeholder:"Enter banner message...",className:"min-h-[80px]"})]}),(0,se.jsx)(iQ,{color:t.color,textColor:t.text_color,useCustomColor:s,onColorChange:e=>o({color:e}),onTextColorChange:e=>o({text_color:e}),onPresetChange:c}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{children:"Icon"}),(0,se.jsxs)(Wf,{value:t.icon,onValueChange:e=>o({icon:e}),children:[(0,se.jsx)(Yf,{children:(0,se.jsx)(qf,{placeholder:"Select icon"})}),(0,se.jsx)($f,{children:nQ.map(e=>(0,se.jsx)(Zf,{value:e.value,children:e.label},e.value))})]})]}),(0,se.jsx)(dQ,{enabled:t.link_status_page,url:t.status_page_url,linkText:t.status_page_link_text,onEnabledChange:e=>o({link_status_page:e}),onUrlChange:e=>o({status_page_url:e}),onLinkTextChange:e=>o({status_page_link_text:e})}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"space-y-0.5",children:[(0,se.jsx)(aN,{children:"Homepage Only"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:t.only_on_homepage?"Banner shows only on the homepage":"Banner shows on all pages (platform-wide)"})]}),(0,se.jsx)(aB,{checked:t.only_on_homepage,onCheckedChange:e=>o({only_on_homepage:e})})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"space-y-0.5",children:[(0,se.jsx)(aN,{children:"Allow Dismiss"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:t.dismissable?"Users can click X to hide (returns on refresh)":"Banner cannot be dismissed by users"})]}),(0,se.jsx)(aB,{checked:t.dismissable,onCheckedChange:e=>o({dismissable:e})})]}),(0,se.jsx)("div",{className:"flex items-center gap-3 pt-4 border-t border-slate-200",children:a?(0,se.jsx)(uQ,{isSaving:n,isDeactivating:r,onSave:d,onDeactivate:m}):(0,se.jsxs)(Bx,{onClick:u,disabled:l||!t.text.trim(),className:"bg-green-600 hover:bg-green-700",children:[l?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(tQ.A,{className:"h-4 w-4 mr-2"}),"Activate Banner"]})})]})]})}function dQ(e){let{enabled:t,url:s,linkText:a,onEnabledChange:n,onUrlChange:l,onLinkTextChange:r}=e;return(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"space-y-0.5",children:[(0,se.jsx)(aN,{children:"Link to Status Page"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:'Add "For updates, check our Status Page." link'})]}),(0,se.jsx)(aB,{checked:t,onCheckedChange:n})]}),t&&(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4 pl-4 border-l-2 border-slate-200",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"status-url",children:"Status Page URL"}),(0,se.jsx)(Df,{id:"status-url",type:"url",value:s,onChange:e=>l(e.target.value),placeholder:"https://status.base44.com"})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)(aN,{htmlFor:"link-text",children:"Link Text"}),(0,se.jsx)(Df,{id:"link-text",type:"text",value:a,onChange:e=>r(e.target.value),placeholder:"Status Page"})]})]})]})}function uQ(e){let{isSaving:t,isDeactivating:s,onSave:a,onDeactivate:n}=e;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(Bx,{onClick:a,disabled:t,className:"bg-orange-500 hover:bg-orange-600",children:[t?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(lV.A,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),(0,se.jsxs)(Bx,{onClick:n,disabled:s,variant:"outline",className:"text-red-600 border-red-300 hover:bg-red-50",children:[s?(0,se.jsx)(Ac.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,se.jsx)(sQ.A,{className:"h-4 w-4 mr-2"}),"Deactivate Banner"]})]})}function mQ(e){return{color:e.color,text:e.text,link_status_page:e.link_status_page,status_page_url:e.status_page_url,status_page_link_text:e.status_page_link_text,icon:e.icon,text_color:e.text_color,only_on_homepage:e.only_on_homepage,dismissable:e.dismissable}}function xQ(e){switch(e){case"red":return"bg-red-600";case"amber":return"bg-amber-500";case"transparent":return"bg-slate-200 border border-slate-300";default:return"border border-slate-300"}}function hQ(e){if(!function(e){return lQ.includes(e)}(e))return{backgroundColor:e}}function pQ(e){let{banners:t,onSelect:s}=e;return 0===t.length?null:(0,se.jsxs)(Bv,{children:[(0,se.jsxs)(zv,{children:[(0,se.jsxs)(Hv,{className:"flex items-center gap-2",children:[(0,se.jsx)(eh.A,{className:"w-5 h-5"}),"Recent Banners"]}),(0,se.jsx)(Vv,{children:"Click to load configuration from a previous banner"})]}),(0,se.jsx)(Wv,{children:(0,se.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,se.jsx)(gQ,{banner:e,onClick:()=>s(e)},e.id))})})]})}function gQ(e){let{banner:t,onClick:s}=e;return(0,se.jsxs)("button",{onClick:s,className:de("w-full text-left p-3 rounded-lg border transition-colors","hover:bg-slate-50 hover:border-slate-300",t.is_active&&"bg-green-50 border-green-200"),children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)(fQ,{color:t.color}),(0,se.jsx)("span",{className:"text-sm text-slate-700 line-clamp-1",children:t.text})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[t.is_active&&(0,se.jsx)(vQ,{}),(0,se.jsx)("span",{className:"text-xs text-slate-400",children:(a=t.created_date,new Date(a).toLocaleDateString())})]})]}),(0,se.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:["Created by ",t.created_by_email]})]});var a}function fQ(e){let{color:t}=e;return(0,se.jsx)("div",{className:de("w-4 h-4 rounded",xQ(t)),style:hQ(t)})}function vQ(){return(0,se.jsx)("span",{className:"text-xs font-medium text-green-600 bg-green-100 px-2 py-0.5 rounded",children:"Active"})}function bQ(e){let{open:t,onOpenChange:s,onConfirm:a}=e;return(0,se.jsx)(NN,{open:t,onOpenChange:s,children:(0,se.jsxs)(kN,{children:[(0,se.jsxs)(CN,{children:[(0,se.jsx)(SN,{children:"Activate Status Banner"}),(0,se.jsx)(EN,{children:"This will set the status banner on the homepage. All users will see this banner immediately. Are you sure?"})]}),(0,se.jsxs)(AN,{children:[(0,se.jsx)(IN,{children:"Cancel"}),(0,se.jsx)(TN,{onClick:()=>{a(),s(!1)},className:"bg-green-600 hover:bg-green-700",children:"Yes, Activate"})]})]})})}function jQ(e){let{message:t}=e;return t?(0,se.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 text-red-700",children:[(0,se.jsx)(ad.A,{className:"w-5 h-5 flex-shrink-0"}),(0,se.jsx)("span",{children:t})]}):null}function yQ(e){let{message:t}=e;return t?(0,se.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3 text-green-700",children:[(0,se.jsx)(hb.A,{className:"w-5 h-5 flex-shrink-0"}),(0,se.jsx)("span",{children:t})]}):null}function NQ(){return(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)(jH.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,se.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,se.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}function wQ(){return(0,se.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,se.jsx)(Ac.A,{className:"w-8 h-8 animate-spin text-slate-400"})})}function _Q(){const{user:e}=wd(),t=$p(null==e?void 0:e.platform_role),[s,a]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!1),{form:r,useCustomColor:i,updateForm:o,setForm:c,resetForm:d,handleColorPresetChange:u,setUseCustomColor:m}=function(e){const[t,s]=(0,Y.useState)((0,ue.A)((0,ue.A)({},rQ),e)),[a,n]=(0,Y.useState)(()=>{const t=(null==e?void 0:e.color)||rQ.color;return!lQ.includes(t)}),l=(0,Y.useCallback)(e=>{s(t=>(0,ue.A)((0,ue.A)({},t),e))},[]),r=(0,Y.useCallback)(()=>{s(rQ),n(!1)},[]),i=(0,Y.useCallback)(e=>{"custom"===e?(n(!0),s(e=>(0,ue.A)((0,ue.A)({},e),{},{color:"#dc2626"}))):(n(!1),s(t=>(0,ue.A)((0,ue.A)({},t),{},{color:e,text_color:null})))},[]);return{form:t,useCustomColor:a,updateForm:l,setForm:s,resetForm:r,handleColorPresetChange:i,setUseCustomColor:n}}(),{data:x,isLoading:h,error:p,refetch:g}=Xd({query:()=>mH.list(1,1,"active"),enabled:t,logErrorMsg:"Failed to load active banner"},[t]),{data:f,isLoading:v,refetch:b}=Xd({query:()=>mH.list(1,5,"all"),enabled:t,logErrorMsg:"Failed to load banner history"},[t]),j=(null==x?void 0:x.items[0])||null,y=(null==f?void 0:f.items)||[],N=h||v,w=(0,Y.useCallback)(e=>{a(e),setTimeout(()=>a(null),3e3)},[]),{mutate:_,isLoading:k,error:C}=eu({mutate:async e=>mH.createAndActivate(e),onSuccess:()=>{w("Banner activated successfully!"),g(),b()},logErrorMsg:"Failed to activate banner"}),{mutate:A,isLoading:S,error:E}=eu({mutate:async e=>mH.update(e.id,e.data),onSuccess:()=>{w("Banner updated successfully!"),g()},logErrorMsg:"Failed to update banner"}),{mutate:T,isLoading:I,error:P}=eu({mutate:async e=>mH.deactivate(e),onSuccess:()=>{w("Banner deactivated successfully!"),d(),g(),b()},logErrorMsg:"Failed to deactivate banner"}),{mutate:L,isLoading:M,error:R}=eu({mutate:async e=>mH.polishText(e),onSuccess:e=>{null!=e&&e.improved_text&&o({text:e.improved_text})},logErrorMsg:"Failed to polish text"}),D=(0,Y.useCallback)(()=>{r.text.trim()&&!M&&L(r.text)},[r.text,M,L]);(0,Y.useEffect)(()=>{const e=e=>{(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey&&"k"===e.key:e.ctrlKey&&"k"===e.key)&&(e.preventDefault(),D())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[D]),(0,Y.useEffect)(()=>{j&&(c(mQ(j)),m(!lQ.includes(j.color)))},[null==j?void 0:j.id,c,m]);const F=function(e){var t,s;if(!e)return null;const a=e;return(null==a||null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"An error occurred"}(p||C||E||P||R),O=(0,Y.useCallback)(()=>{const e={color:r.color,text:r.text,link_status_page:r.link_status_page,status_page_url:r.status_page_url,status_page_link_text:r.status_page_link_text,icon:r.icon,text_color:r.text_color||void 0,only_on_homepage:r.only_on_homepage,dismissable:r.dismissable};_(e)},[r,_]),U=(0,Y.useCallback)(()=>{if(!j)return;const e={color:r.color,text:r.text,link_status_page:r.link_status_page,status_page_url:r.status_page_url,status_page_link_text:r.status_page_link_text,icon:r.icon,text_color:r.text_color,only_on_homepage:r.only_on_homepage,dismissable:r.dismissable};A({id:j.id,data:e})},[j,r,A]),B=(0,Y.useCallback)(()=>{j&&T(j.id)},[j,T]),z=(0,Y.useCallback)(e=>{c(mQ(e)),m(!lQ.includes(e.color))},[c,m]);if(!t)return(0,se.jsx)(NQ,{});if(N)return(0,se.jsx)(wQ,{});const H=function(e){return{id:"preview",color:e.color,text:e.text,linkStatusPage:e.link_status_page,statusPageUrl:e.status_page_url,statusPageLinkText:e.status_page_link_text,icon:e.icon,textColor:e.text_color||void 0,onlyOnHomepage:e.only_on_homepage,dismissable:e.dismissable}}(r),V=j?{id:(W=j).id,color:W.color,text:W.text,linkStatusPage:W.link_status_page,statusPageUrl:W.status_page_url,statusPageLinkText:W.status_page_link_text,icon:W.icon,textColor:W.text_color||void 0,onlyOnHomepage:W.only_on_homepage,dismissable:W.dismissable}:null;var W;const q=function(e,t){return!!t&&(e.color!==t.color||e.text!==t.text||e.link_status_page!==t.link_status_page||e.status_page_url!==t.status_page_url||e.status_page_link_text!==t.status_page_link_text||e.icon!==t.icon||e.text_color!==t.text_color||e.only_on_homepage!==t.only_on_homepage||e.dismissable!==t.dismissable)}(r,j);return(0,se.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,se.jsx)(XJ,{previewConfig:H,liveConfig:V,hasChanges:q}),(0,se.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,se.jsxs)("header",{className:"mb-8",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Status Banner Controls"}),(0,se.jsx)("p",{className:"text-slate-600 mt-2",children:j?'Edit the banner below and click "Save Changes" to update what users see.':"Configure a new banner and activate it to display on the homepage."})]}),(0,se.jsx)(jQ,{message:F}),(0,se.jsx)(yQ,{message:s}),(0,se.jsx)(cQ,{form:r,useCustomColor:i,isActive:!!j,isSaving:S,isActivating:k,isDeactivating:I,isPolishing:M,onFormChange:o,onColorPresetChange:u,onSave:U,onActivate:()=>l(!0),onDeactivate:B,onPolish:D}),(0,se.jsx)(pQ,{banners:y,onSelect:z})]}),(0,se.jsx)(bQ,{open:n,onOpenChange:l,onConfirm:O})]})}const kQ=e=>{let{formData:t,errors:s,logoPreview:a,onInputChange:n,onLogoUpload:l,onLogoRemove:r}=e;return(0,se.jsxs)("div",{"data-testid":"basic-info-step",className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start",children:[(0,se.jsx)("div",{className:"w-full inline-flex justify-start items-start",children:(0,se.jsx)("div",{className:"flex-1 flex justify-start items-start",children:(0,se.jsx)("div",{className:"flex-1 self-stretch inline-flex flex-col justify-start items-start gap-2",children:(0,se.jsxs)("div",{className:"inline-flex justify-start items-start gap-4",children:[(0,se.jsx)("div",{className:"w-20 h-20 rounded-2xl overflow-hidden bg-gray-100 flex items-center justify-center",children:a?(0,se.jsx)("img",{src:a,alt:"Logo preview",className:"w-20 h-20 rounded-2xl object-cover"}):(0,se.jsx)("div",{className:"w-20 h-20 bg-gray-200 rounded-2xl flex items-center justify-center",children:(0,se.jsx)(W_.A,{"data-testid":"placeholder-upload-icon",className:"h-8 w-8 text-gray-400"})})}),(0,se.jsxs)("div",{className:"inline-flex flex-col justify-start items-start gap-3",children:[(0,se.jsxs)("div",{"data-testid":"logo-label",className:"self-stretch justify-center text-gray-700 text-sm font-medium font-base44 leading-tight",children:["Logo/profile",(0,se.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,se.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-1.5",children:[(0,se.jsxs)("div",{className:"inline-flex justify-start items-start gap-3",children:[(0,se.jsx)("input",{"data-testid":"logo-upload-input",type:"file",id:"logo-upload-basic",className:"hidden",accept:"image/*",onChange:l}),(0,se.jsx)(Bx,{variant:"secondary",size:"sm",asChild:!0,className:"h-7 px-3",children:(0,se.jsxs)("label",{"data-testid":"upload-button",htmlFor:"logo-upload-basic",className:"cursor-pointer gap-1.5",children:[(0,se.jsx)(W_.A,{"data-testid":"upload-icon",className:"w-4 h-4"}),"Upload logo"]})}),a&&(0,se.jsx)(Bx,{"data-testid":"remove-logo-button",variant:"outline",size:"sm",onClick:r,className:"h-7 px-3",children:"Remove"})]}),(0,se.jsx)("div",{"data-testid":"file-format-text",className:"justify-start text-gray-500 text-xs font-normal font-base44 leading-none",children:"We support PNGs and JPEGs"})]})]})]})})})}),s.logo&&(0,se.jsx)("p",{"data-testid":"logo-error",className:"text-sm text-red-500 mt-2",children:s.logo})]}),(0,se.jsx)("div",{"data-testid":"name-field-container",className:"w-full",children:(0,se.jsx)(UM,{"data-testid":"name-input",label:"Display name (you or your company)",placeholder:"Enter your name or company name",value:t.name,onChange:e=>n("name",e),error:s.name,required:!0,className:"w-full",tooltipText:"Your display name shows who you are. Company name is best, but your own name works too."})}),(0,se.jsx)("div",{"data-testid":"description-field-container",className:"w-full",children:(0,se.jsx)(UM,{"data-testid":"description-input",label:"What should users know about your services or company? (2 sentences)",placeholder:"Describe your expertise and what makes you unique...",value:t.description,onChange:e=>n("description",e),error:s.description,type:"textarea",helperText:"".concat(t.description.length," characters (minimum 20)"),required:!0,className:"w-full"})}),(0,se.jsxs)("div",{"data-testid":"location-fields-container",className:"w-full grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,se.jsx)(zM,{"data-testid":"country-select",label:"Country",placeholder:"Select your country",value:t.country,onChange:e=>n("country",e),error:s.country,required:!0,className:"w-full",tooltipText:"Providing your location ensures smoother collaboration with people in different places"}),(0,se.jsx)(UM,{"data-testid":"city-input",label:"City",placeholder:"e.g., San Francisco",value:t.city,onChange:e=>n("city",e),error:s.city,required:!0,className:"w-full",tooltipText:"Providing your location ensures smoother collaboration with people in different places"})]})]})},CQ=e=>{let{label:t,value:s,onValueChange:a,options:n,className:l="",error:r}=e;return(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-1 ".concat(l),children:[(0,se.jsx)(aN,{className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:t}),(0,se.jsx)(Nw,{value:s,onValueChange:a,className:"w-full grid grid-cols-1 sm:grid-cols-2 gap-3",children:n.map(e=>(0,se.jsxs)(aN,{htmlFor:"radio-".concat(e.value),className:"p-3 bg-white rounded-lg border border-slate-200 flex justify-start items-center gap-3 cursor-pointer hover:bg-slate-50 transition-colors",children:[(0,se.jsx)(ww,{id:"radio-".concat(e.value),value:e.value,className:"w-4 h-4"}),(0,se.jsx)("span",{className:"text-black text-sm font-medium font-base44 leading-tight",children:e.label})]},e.value))}),r&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1",children:r})]})},AQ=e=>{let{formData:t,errors:s,onInputChange:a,onLanguageToggle:n}=e;return(0,se.jsxs)("div",{"data-testid":"profile-step",className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsx)(CQ,{label:"Your team size",value:t.individual_or_team,onValueChange:e=>a("individual_or_team",e),options:[{value:"individual",label:"Individual"},{value:"team",label:"Team/Agency"}],error:s.individual_or_team}),(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-3",children:[(0,se.jsxs)("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,se.jsxs)("div",{className:"flex flex-col justify-start items-start gap-1",children:[(0,se.jsx)(aN,{className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Starting budget (USD)"}),(0,se.jsxs)("div",{className:"w-full h-10 px-3 py-2 bg-white rounded-lg border border-slate-200 inline-flex justify-start items-center gap-2 overflow-hidden",children:[(0,se.jsx)("span",{className:"text-slate-500 text-sm font-normal font-base44 leading-tight",children:"$"}),(0,se.jsx)("input",{type:"number",min:"0",placeholder:"e.g, 5000",value:t.budget_starting_from_dollars,onChange:e=>a("budget_starting_from_dollars",e.target.value),className:"flex-1 text-sm font-normal font-base44 leading-tight bg-transparent border-none outline-none placeholder:text-slate-400"})]}),s.budget_starting_from_dollars&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.budget_starting_from_dollars})]}),(0,se.jsxs)("div",{className:"flex flex-col justify-start items-start gap-1",children:[(0,se.jsx)(aN,{className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Hourly rate (USD)"}),(0,se.jsxs)("div",{className:"w-full h-10 px-3 py-2 bg-white rounded-lg border border-slate-200 inline-flex justify-start items-center gap-2",children:[(0,se.jsx)("span",{className:"text-slate-500 text-sm font-normal font-base44 leading-tight",children:"$"}),(0,se.jsx)("input",{type:"number",min:"0",placeholder:"e.g, 150",value:t.hourly_rate,onChange:e=>a("hourly_rate",e.target.value),className:"flex-1 text-sm font-normal font-base44 leading-tight bg-transparent border-none outline-none placeholder:text-slate-400"})]}),s.hourly_rate&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.hourly_rate})]})]}),s.pricing&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.pricing})]}),(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-2",children:[(0,se.jsxs)("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,se.jsx)(UM,{label:"Add Website link",placeholder:"Paste website URL",value:t.website_url,onChange:e=>a("website_url",e),error:s.website_url,type:"url",className:"w-full"}),(0,se.jsx)(UM,{label:"LinkedIn link",placeholder:"Paste LinkedIn URL",value:t.linkedin_url,onChange:e=>a("linkedin_url",e),error:s.linkedin_url,type:"url",className:"w-full"})]}),(0,se.jsx)("div",{className:"w-full flex flex-col justify-start items-start",children:(0,se.jsx)("p",{className:"text-slate-500 text-sm font-normal font-base44 leading-tight",children:"At least one link is required."})})]}),(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-1",children:[(0,se.jsx)(aN,{className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"What is your preferred working language?"}),(0,se.jsx)("div",{className:"w-full h-40 bg-white rounded-lg border border-slate-200 overflow-hidden",children:(0,se.jsx)("div",{className:"h-full overflow-y-auto pl-3 pr-1.5 py-3",children:(0,se.jsx)("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1.5",children:HE.map(e=>(0,se.jsxs)("div",{className:"inline-flex justify-start items-center gap-2",children:[(0,se.jsx)(E_,{id:"lang-".concat(e.value),checked:t.languages.includes(e.value),onCheckedChange:()=>n(e.value),className:"w-4 h-4"}),(0,se.jsx)(aN,{htmlFor:"lang-".concat(e.value),className:"text-gray-700 text-sm font-normal font-base44 leading-tight cursor-pointer",children:e.label})]},e.value))})})}),s.languages&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.languages})]})]})},SQ=e=>{let{options:t,selectedOptions:s,onToggle:a,getOptionLabel:n=e=>String(e),getOptionKey:l=e=>String(e),className:r,buttonClassName:i,multiple:o=!0,disabled:c=!1}=e;return(0,se.jsx)("div",{className:de("w-full inline-flex justify-start items-start gap-3 flex-wrap content-start",r),children:t.map(e=>{const t=(e=>s.some(t=>l(t)===l(e)))(e);return(0,se.jsx)("button",{type:"button",onClick:()=>(e=>{c||a(e)})(e),disabled:c,className:de("p-3 rounded-lg outline outline-1 outline-offset-[-1px] flex justify-center items-center gap-3 transition-all duration-200",t?"bg-gray-800 outline-gray-800 text-white hover:bg-gray-900 hover:outline-gray-900":"bg-white outline-gray-200 text-black hover:bg-slate-100 hover:outline-slate-950/50",c&&"opacity-50 cursor-not-allowed hover:bg-white hover:outline-gray-200",c&&t&&"hover:bg-gray-800 hover:outline-gray-800",i),children:(0,se.jsx)("div",{className:"inline-flex flex-col justify-center items-start gap-0.5",children:(0,se.jsx)("div",{className:"inline-flex justify-start items-center gap-2",children:(0,se.jsx)("span",{className:"text-sm font-normal font-base44 leading-tight",children:n(e)})})})},l(e))})})},EQ=e=>{var t,s;let{formData:a,errors:n,onInputChange:l,onServiceToggle:r}=e;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6",children:[(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-2",children:[(0,se.jsxs)("div",{className:"flex flex-col justify-start items-start gap-0.5",children:[(0,se.jsx)(aN,{className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Which services do you offer?"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm font-normal font-base44 leading-tight",children:"Please select at least one service"})]}),(0,se.jsx)(SQ,{options:zE,selectedOptions:a.services,onToggle:r}),n.services&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1",children:n.services})]}),a.services.includes("Other")&&(0,se.jsx)("div",{className:"w-full",children:(0,se.jsx)(UM,{label:"Tell us what service you offer",placeholder:"Describe your service...",value:a.other_service_description||"",onChange:e=>l("other_service_description",e),error:n.other_service_description,helperText:"".concat(null!==(t=null===(s=a.other_service_description)||void 0===s?void 0:s.length)&&void 0!==t?t:0,"/30 characters"),className:"w-full"})})]})},TQ=e=>{let{formData:t,errors:s,onInputChange:a,onAppsModeToggle:n}=e;const l=t.apps&&t.apps.length>0?t.apps.length<2?[...t.apps,...Array(2-t.apps.length).fill({url:"",allow_public_showcase:!0})]:t.apps:[{url:"",allow_public_showcase:!0},{url:"",allow_public_showcase:!0}],r=t.has_apps_to_share?"has_apps":"no_apps";return(0,se.jsxs)("div",{"data-testid":"apps-step",className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-4 overflow-hidden",children:[(0,se.jsx)("div",{className:"flex flex-col justify-start items-start gap-1",children:(0,se.jsx)("div",{className:"flex flex-col justify-start items-start",children:(0,se.jsx)("div",{className:"justify-center text-gray-700 text-base font-semibold font-base44 leading-normal",children:"Show us your work on Base44"})})}),(0,se.jsx)(CQ,{label:"",value:r,onValueChange:e=>n("has_apps"===e),options:[{value:"has_apps",label:"I have apps to share"},{value:"no_apps",label:"I don't have apps to share"}]}),t.has_apps_to_share?(0,se.jsxs)("div",{className:"w-full pt-3 flex flex-col justify-start items-start gap-2",children:[(0,se.jsxs)("div",{className:"w-full flex gap-4",children:[(0,se.jsx)("div",{className:"flex-[3] min-w-0",children:(0,se.jsxs)("div",{className:"text-left text-gray-700 text-sm font-medium font-base44 leading-tight",children:["App links",s.apps&&(0,se.jsx)("div",{className:"text-red-500 text-xs mt-1 font-normal",children:s.apps})]})}),(0,se.jsx)("div",{className:"flex-[2] min-w-0",children:(0,se.jsxs)("div",{className:"text-left text-gray-700 text-sm font-medium font-base44 leading-tight flex items-center gap-1",children:["Share apps publicly",(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{delayDuration:100,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-gray-600 hover:text-gray-900"})}),(0,se.jsx)(pp,{className:"max-w-[240px] p-3 text-xs",children:(0,se.jsx)("p",{children:"Public apps will be showcased to other users. Private apps are only shared with us for review."})})]})})]})})]}),(0,se.jsx)("div",{className:"w-full flex flex-col gap-3",children:l.map((e,s)=>(0,se.jsxs)("div",{className:"w-full flex gap-4 items-center",children:[(0,se.jsx)("div",{className:"flex-[3] min-w-0",children:(0,se.jsx)(UM,{label:"",placeholder:"https://base44.com/app/my-app",value:e.url,onChange:e=>((e,s)=>{const n=[...t.apps||[]];for(;n.length<2;)n.push({url:"",allow_public_showcase:!0});n[e]||(n[e]={url:"",allow_public_showcase:!0}),n[e]=(0,ue.A)((0,ue.A)({},n[e]),{},{url:s}),a("apps",n)})(s,e),error:null,type:"url",className:"w-full"})}),(0,se.jsx)("div",{className:"flex-[2] min-w-0",children:(0,se.jsxs)("div",{className:"flex justify-start items-center gap-2",children:[(0,se.jsx)(E_,{id:"showcase-".concat(s),checked:e.allow_public_showcase,onCheckedChange:e=>((e,s)=>{const n=[...t.apps||[]];n[e]||(n[e]={url:"",allow_public_showcase:!0}),n[e]=(0,ue.A)((0,ue.A)({},n[e]),{},{allow_public_showcase:s}),a("apps",n)})(s,e),className:"w-4 h-4"}),(0,se.jsx)(aN,{htmlFor:"showcase-".concat(s),className:"text-gray-950 text-sm font-normal font-base44 leading-tight pointer-events-none",children:"Share publicly"})]})})]},s))}),(0,se.jsxs)(Bx,{type:"button",variant:"secondary",size:"sm",onClick:()=>{const e=[...t.apps||[]];for(;e.length<2;)e.push({url:"",allow_public_showcase:!0});e.length<5&&e.push({url:"",allow_public_showcase:!0}),a("apps",e)},disabled:l.length>=5,className:"h-7 px-3 gap-1.5",children:[l.length<5?(0,se.jsx)(op.A,{className:"w-4 h-4"}):null,l.length>=5?"Maximum 5 apps":"Add link"]})]}):(0,se.jsx)("div",{className:"w-full pt-3",children:(0,se.jsx)(UM,{label:"What makes you a great partner?",placeholder:"Describe your relevant experience",value:t.no_apps_explanation||"",onChange:e=>a("no_apps_explanation",e),error:s.no_apps_explanation,type:"textarea",required:!0,helperText:"".concat((t.no_apps_explanation||"").length," characters (minimum 20)"),rows:4,className:"w-full h-30",tooltipText:"Will be reviewed internally by Base44"})})]})},IQ=e=>{var t;let{formData:s,userEmail:a,logoPreview:n}=e;const l=(()=>{const e=[];return s.website_url&&e.push(s.website_url.replace(/^https?:\/\//,"").replace(/^www\./,"")),s.linkedin_url&&e.push(s.linkedin_url.replace(/^https?:\/\//,"").replace(/^www\./,"")),e})(),r=(()=>{let e=[...s.services];return e.includes("Other")&&s.other_service_description&&(e=e.filter(e=>"Other"!==e),e.push(s.other_service_description)),e})(),i=[{label:"Type",value:"individual"===s.individual_or_team?"Individual":"Team/Agency"},{label:"Location",value:"".concat(s.city,", ").concat(s.country)},{label:"Links",value:(0,se.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:l.map((e,t)=>(0,se.jsxs)(Y.Fragment,{children:[(0,se.jsx)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:e}),t<l.length-1&&(0,se.jsx)("div",{className:"w-1 h-1 bg-gray-500 rounded-full flex-shrink-0"})]},t))}),show:l.length>0},{label:"Languages",value:s.languages.map(e=>{var t;return(null===(t=HE.find(t=>t.value===e))||void 0===t?void 0:t.label)||e}).join(", "),show:s.languages.length>0},{label:"Services",value:(0,se.jsx)("div",{className:"flex flex-col gap-1",children:r.map((e,t)=>(0,se.jsxs)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:["\u2022 ",e]},t))}),show:s.services.length>0},{label:"Pricing",value:(0,se.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[s.budget_starting_from_dollars&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:["From $",s.budget_starting_from_dollars]}),s.hourly_rate&&(0,se.jsx)("div",{className:"w-1 h-1 bg-gray-500 rounded-full flex-shrink-0"})]}),s.hourly_rate&&(0,se.jsxs)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:["$",s.hourly_rate,"/hour"]})]}),show:!(!s.budget_starting_from_dollars&&!s.hourly_rate)},{label:"Description",value:(0,se.jsx)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight whitespace-pre-wrap break-words",children:s.description}),show:!!s.description},{label:"Apps",value:(0,se.jsx)("div",{className:"flex flex-col gap-2",children:null===(t=s.apps)||void 0===t?void 0:t.filter(e=>e.url&&e.url.trim()).map((e,t)=>{return(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start gap-1 sm:gap-2",children:[(0,se.jsxs)("div",{className:"flex-1 justify-start text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:["\u2022 ",(s=e.url,s.replace(/^https?:\/\//,"").replace(/^www\./,""))]}),e.allow_public_showcase&&(0,se.jsx)("span",{className:"text-xs text-slate-900 bg-gray-200 px-2 py-1 max-w-16 rounded flex-shrink-0",children:"Allowed"})]},t);var s})}),show:s.has_apps_to_share&&s.apps&&s.apps.length>0&&s.apps.some(e=>e.url&&e.url.trim())},{label:"Experience",value:(0,se.jsx)("div",{className:"text-gray-950 text-sm font-medium font-base44 leading-tight whitespace-pre-wrap break-words",children:s.no_apps_explanation}),show:!s.has_apps_to_share&&!!s.no_apps_explanation}];return(0,se.jsxs)("div",{className:"w-full p-6 bg-white inline-flex flex-col justify-start items-start gap-3 overflow-hidden",children:[(0,se.jsxs)("p",{className:"w-full text-gray-700 text-sm font-normal font-base44 leading-tight",children:["Our team will review your application and get back to you soon. You'll receive an email at"," ",(0,se.jsx)("span",{className:"font-medium",children:a})," once it has been processed."]}),(0,se.jsx)("p",{className:"w-full text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Review your profile card"}),(0,se.jsxs)("div",{className:"w-full p-4 bg-slate-50 rounded-lg border border-slate-300 flex flex-col justify-start items-start gap-3 overflow-hidden",children:[(0,se.jsxs)("div",{className:"w-full inline-flex justify-start items-center gap-3",children:[(0,se.jsx)("div",{className:"w-10 h-10 rounded-md border border-black/10 bg-gray-100 flex items-center justify-center overflow-hidden",children:n||s.logo_url?(0,se.jsx)("img",{src:n||s.logo_url,alt:"Company logo",className:"w-10 h-10 object-cover"}):(0,se.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-md flex items-center justify-center",children:(0,se.jsx)("span",{className:"text-xs text-gray-400 font-base44",children:s.name.charAt(0).toUpperCase()})})}),(0,se.jsx)("div",{className:"flex-1 text-black text-base font-medium font-base44 leading-tight",children:s.name})]}),(0,se.jsx)("div",{className:"w-full flex flex-col justify-start items-start gap-[3px] min-w-0",children:i.filter(e=>!1!==e.show).map((e,t)=>(0,se.jsxs)("div",{className:"w-full py-[3px] flex flex-col sm:flex-row sm:items-start gap-1 sm:gap-0",children:[(0,se.jsx)("div",{className:"sm:w-44 sm:flex-shrink-0 justify-start text-black text-sm font-normal font-base44 leading-tight",children:e.label}),(0,se.jsx)("div",{className:"flex-1 justify-start text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:e.value})]},t))})]})]})};const PQ=new class extends qp{getBaseURL(){return"/partners"}getPartnerById(e){return this.axios.get("/catalog/".concat(e))}contactRequest(e){return this.axios.post("/contact-requests",e)}getAllContactRequests(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.axios.get("/contact-requests",{params:e})}},LQ=PQ,MQ={name:"",description:"",logo_url:"",website_url:"",linkedin_url:"",country:"",city:"",individual_or_team:"individual",services:[],languages:[],budget_starting_from_dollars:"",hourly_rate:"",other_service_description:"",apps:[],has_apps_to_share:!0,no_apps_explanation:"",terms_accepted:!1},RQ=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"create",s=arguments.length>2?arguments[2]:void 0;const[a,n]=(0,Y.useState)(e||MQ),[l,r]=(0,Y.useState)({}),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)((null==e?void 0:e.logo_url)||null),[u,m]=(0,Y.useState)(!1),x=(e,t)=>{n(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t})),l[e]&&r(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:null})),("budget_starting_from_dollars"===e||"hourly_rate"===e)&&l.pricing&&t&&r(e=>(0,ue.A)((0,ue.A)({},e),{},{pricing:null}))};return{formData:a,errors:l,logoFile:i,logoPreview:c,isSubmitting:u,handleInputChange:x,handleServiceToggle:e=>{const t=a.services.includes(e)?a.services.filter(t=>t!==e):[...a.services,e];x("services",t)},handleLanguageToggle:e=>{const t=a.languages.includes(e)?a.languages.filter(t=>t!==e):[...a.languages,e];x("languages",t)},handleAppsModeToggle:e=>{n(t=>(0,ue.A)((0,ue.A)({},t),{},{has_apps_to_share:e})),r(e=>(0,ue.A)((0,ue.A)({},e),{},{apps:null,no_apps_explanation:null}))},handleLogoUpload:e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!s)return;if(!s.type.startsWith("image/"))return void so({title:"Invalid file type",description:"Please upload an image file (PNG, JPG, SVG)",variant:"destructive"});if(s.size>5242880)return void so({title:"File too large",description:"Please upload an image smaller than 5MB",variant:"destructive"});o(s),l.logo&&r(e=>(0,ue.A)((0,ue.A)({},e),{},{logo:null}));const a=new FileReader;a.onloadend=()=>{d(a.result)},a.readAsDataURL(s)},handleLogoRemove:()=>{o(null),d(null),r(e=>(0,ue.A)((0,ue.A)({},e),{},{logo:"Logo upload is required"}))},handleTermsToggle:()=>{x("terms_accepted",!a.terms_accepted)},validateStep:e=>{let t;switch(e){case 0:t=((e,t)=>{const s=(0,ue.A)((0,ue.A)({},e),{},{logo:t}),a=tT.safeParse(s);return a.success?{success:!0,errors:{}}:{success:!1,errors:lT(a.error)}})(a,!(!i&&!a.logo_url));break;case 1:t=(e=>{const t=sT.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:lT(t.error)}})(a);break;case 2:t=(e=>{const t=aT.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:lT(t.error)}})(a);break;case 3:t=(e=>{const t=nT.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:lT(t.error)}})(a);break;default:return!0}return r(t.errors),t.success},handleSubmit:async e=>{const n=(e=>{const t=eT.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:lT(t.error)}})(a);if(!n.success)return r(n.errors),!1;if(!e)return so({title:"Authentication Required",description:"Please log in to submit a partner application.",variant:"destructive"}),!1;m(!0);try{let n=a.logo_url;if(i)try{n=(await ip.uploadFile(i)).url}catch(c){so({title:"Logo upload failed",description:"Continuing with application without logo",variant:"destructive"})}const l=(0,ue.A)((0,ue.A)({},a),{},{logo_url:n,budget_starting_from_dollars:a.budget_starting_from_dollars?parseInt(a.budget_starting_from_dollars):null,hourly_rate:a.hourly_rate?parseInt(a.hourly_rate):null,apps:(a.apps||[]).filter(e=>e.url&&e.url.trim())});if("edit"===t){if(!s)throw new Error("Partner ID is required for updating a partner profile");await LQ.update(s,l)}else await LQ.create(l);return so("edit"===t?{title:"Success",description:"Partner details updated successfully"}:{description:(0,se.jsx)("div",{className:"flex items-start gap-2",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"font-medium",children:"Thank you for applying to become a partner!"}),(0,se.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:["We'll review your application and notify you via email at ",e,"."]})]})}),duration:1e4}),!0}catch(c){var l,o;return so({title:"Submission Failed",description:(null===(l=c.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.detail)||"Failed to submit application. Please try again.",variant:"destructive"}),!1}finally{m(!1)}},resetForm:()=>{n(MQ),o(null),d(null),r({})}}},DQ=e=>{let{isOpen:t,onClose:s,mode:a="create",initialData:n,partnerId:l,onSuccess:r}=e;const{user:i}=wd(),[o,c]=(0,Y.useState)(0),{formData:d,errors:u,logoPreview:m,isSubmitting:x,handleInputChange:h,handleServiceToggle:p,handleLanguageToggle:g,handleAppsModeToggle:f,handleLogoUpload:v,handleLogoRemove:b,handleTermsToggle:j,validateStep:y,handleSubmit:N,resetForm:w}=RQ(n,a,l),_=[{id:1,title:"Basic Info",description:"Tell us about yourself and your location"},{id:2,title:"Profile",description:"Add your online presence and languages"},{id:3,title:"Services",description:"Define your services and pricing"},{id:4,title:"Apps",description:"Share your apps or explain your experience"},{id:5,title:"Review",description:"Review your application before submitting"}];return t?(0,se.jsx)(mp,{children:(0,se.jsx)("div",{"data-testid":"become-partner-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,se.jsx)(OM,{"data-testid":"partner-wizard",steps:_,currentStep:o,title:"edit"===a?"Edit Partner Profile":"Become a Base44 Partner",description:"edit"===a?"Update partner information":(0,se.jsxs)(se.Fragment,{children:["Information you provide here will be shown on your Partner profile and will be visible to potential clients."," ",(0,se.jsx)("a",{href:"/partners/terms",target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 hover:text-gray-800 text-sm underline transition-colors",children:"Partners terms of use"})]}),onNext:()=>{y(o)&&c(e=>Math.min(e+1,_.length-1))},onPrevious:()=>{c(e=>Math.max(e-1,0))},onSubmit:async()=>{await N(null==i?void 0:i.email)&&(w(),c(0),s(),r&&r())},onClose:s,isLoading:x,submitButtonText:"edit"===a?"Save Changes":"Submit",className:"w-[640px] h-[600px]",footerLeftContent:o!==_.length-1||"edit"===a?null:(0,se.jsxs)("div",{className:"flex justify-start items-center gap-2",children:[(0,se.jsx)("button",{type:"button",onClick:j,className:"w-4 h-4 rounded outline outline-1 outline-offset-[-1px] flex justify-center items-center transition-colors ".concat(u.terms_accepted?"bg-white outline-red-500 hover:outline-red-600":d.terms_accepted?"bg-gray-800 outline-gray-800":"bg-white outline-gray-300 hover:outline-gray-400"),children:d.terms_accepted&&(0,se.jsx)(Ds.A,{className:"w-3 h-3 text-white",strokeWidth:2})}),(0,se.jsxs)("div",{className:"flex justify-start items-center gap-1",children:[(0,se.jsxs)("span",{className:"text-gray-700 text-sm font-normal font-base44 leading-tight",children:["Agree to"," "]}),(0,se.jsx)("a",{href:"/partners/terms",target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 text-sm font-normal font-base44 underline leading-tight hover:text-gray-800 transition-colors",children:"terms of use"}),u.terms_accepted&&(0,se.jsxs)(xp,{delayDuration:100,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"w-4 h-4 text-red-500"})}),(0,se.jsx)(pp,{children:(0,se.jsx)("p",{children:"You must agree to the terms of service to become a partner."})})]})]})]}),children:(0,se.jsx)("div",{"data-testid":"step-content",children:(()=>{switch(o){case 0:return(0,se.jsx)(kQ,{formData:d,errors:u,logoPreview:m,onInputChange:h,onLogoUpload:v,onLogoRemove:b});case 1:return(0,se.jsx)(AQ,{formData:d,errors:u,onInputChange:h,onLanguageToggle:g});case 2:return(0,se.jsx)(EQ,{formData:d,errors:u,onInputChange:h,onServiceToggle:p});case 3:return(0,se.jsx)(TQ,{formData:d,errors:u,onInputChange:h,onAppsModeToggle:f});case 4:return(0,se.jsx)(IQ,{formData:d,userEmail:null==i?void 0:i.email,logoPreview:m});default:return null}})()})})})}):null};var FQ=s(76274),OQ=s(78130),UQ=s(41016),BQ=s(31855);const zQ=e=>e&&Array.isArray(e)?e.map(e=>{const t=HE.find(t=>t.value===e);return t?t.label:e}):[];function HQ(e){let{showAnalytics:t=!1,setShowAnalytics:s=()=>{}}=e;const[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)("all"),[c,d]=(0,Y.useState)(""),[u,m]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(""),[f,v]=(0,Y.useState)(null),[b,j]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(1),[w,_]=(0,Y.useState)(0),[k,C]=(0,Y.useState)({key:"created_date",direction:"desc"}),[A,S]=(0,Y.useState)(null),[E,T]=(0,Y.useState)({}),[I,P]=(0,Y.useState)(new Set),[L,M]=(0,Y.useState)("all"),[R,D]=(0,Y.useState)(""),F=50,[O,U]=(0,Y.useState)([]),[B,z]=(0,Y.useState)([]),[H,V]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{if(A&&clearTimeout(A),1===y)return S(setTimeout(()=>{W()},500)),()=>{A&&clearTimeout(A)};N(1)},[c,i,L,R,k]),(0,Y.useEffect)(()=>{W()},[y]);const W=async()=>{try{r(!0);let e={archived:!1};c&&(e.$or=[{name:{$regex:c,$options:"i"}},{description:{$regex:c,$options:"i"}},{city:{$regex:c,$options:"i"}},{country:{$regex:c,$options:"i"}},{services:{$regex:c,$options:"i"}},{languages:{$regex:c,$options:"i"}}]),"all"!==i&&(e.status=i),"all"!==L&&(e.individual_or_team=L),R&&(e.$or=e.$or?[...e.$or,{city:{$regex:R,$options:"i"}},{country:{$regex:R,$options:"i"}}]:[{city:{$regex:R,$options:"i"}},{country:{$regex:R,$options:"i"}}]);const t=(0,ue.A)((0,ue.A)({},e),{},{limit:F,skip:(y-1)*F,sort_by:"desc"===k.direction?"-".concat(k.key):k.key}),s=await LQ.listCatalogItems(t),a=s.items||s;n(a),a.length<F?_((y-1)*F+a.length):_(y*F+1)}catch(e){so({title:"Error",description:"Failed to load partners",variant:"destructive"})}finally{r(!1)}},q=async e=>{const t=e.item.id;T(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:!0}));try{await LQ.approveItem(t),so({title:"Success",description:"".concat(e.item.name," has been approved")}),await W()}catch(s){so({title:"Error",description:"Failed to approve partner",variant:"destructive"})}finally{T(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:!1}))}},G=e=>{m(e),g(""),h(!0)},K=e=>{const t=k.key===e&&"asc"===k.direction?"desc":"asc";C({key:e,direction:t}),N(1)},$=()=>"all"!==i||"all"!==L||""!==R||""!==c,Z=e=>{switch(e){case"approved":return(0,se.jsxs)(gs,{className:"bg-emerald-100 text-emerald-700 border-emerald-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1.5"}),"Approved"]});case"rejected":return(0,se.jsxs)(gs,{className:"bg-red-100 text-red-700 border-red-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),"Rejected"]});default:return(0,se.jsxs)(gs,{className:"bg-amber-100 text-amber-700 border-amber-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,se.jsx)(jS.A,{className:"w-3 h-3 mr-1.5"}),"Pending"]})}};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold",children:"Partner Management"}),(0,se.jsxs)(zt,{onClick:()=>t?s(!1):(async()=>{V(!0);try{const[e,t]=await Promise.all([LQ.listCatalogItems({limit:1e4,skip:0,sort_by:"-created_date"}),LQ.getAllContactRequests({limit:1e4,skip:0,sort_by:"-created_date"})]),a=e.items||e,n=t.items||t;U(a),z(n),s(!0)}catch(e){so({title:"Error",description:"Failed to fetch analytics data",variant:"destructive"})}finally{V(!1)}})(),disabled:H,className:"flex items-center gap-2",variant:t?"default":"outline",children:[(0,se.jsx)(GP.A,{className:"h-4 w-4"}),H?"Analyzing...":t?"Hide Analytics":"Analyze"]})]}),t&&O.length>0&&(0,se.jsxs)("div",{className:"mb-8 bg-gradient-to-br from-slate-50 to-white p-8 rounded-2xl border border-slate-200 shadow-lg",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"p-2 bg-blue-100 rounded-xl",children:(0,se.jsx)(GP.A,{className:"h-6 w-6 text-blue-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Partner Analytics Dashboard"}),(0,se.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:["Real-time insights across ",O.length," partners"]})]})]}),(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>s(!1),className:"h-10 w-10 p-0 hover:bg-slate-100 rounded-xl",children:(0,se.jsx)(la.A,{className:"h-5 w-5 text-slate-400"})})]}),(()=>{const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const s={total:e.length,approved:e.filter(e=>"approved"===e.item.status).length,pending:e.filter(e=>"pending"===e.item.status).length,rejected:e.filter(e=>"rejected"===e.item.status).length,archived:e.filter(e=>e.item.archived).length},a={individual:e.filter(e=>"individual"===e.item.individual_or_team).length,team:e.filter(e=>"team"===e.item.individual_or_team).length},n=e.reduce((e,t)=>(t.item.languages&&t.item.languages.forEach(t=>{e[t]=(e[t]||0)+1}),e),{}),l=e.reduce((e,t)=>{const s=WE(t.item.country)||t.item.country||"Unknown";return e[s]=(e[s]||0)+1,e},{}),r=e.reduce((e,t)=>(t.item.services&&t.item.services.forEach(t=>{e[t]=(e[t]||0)+1}),e),{}),i={withBudget:e.filter(e=>e.item.budget_starting_from_dollars).length,withHourlyRate:e.filter(e=>e.item.hourly_rate).length,averageBudget:e.filter(e=>e.item.budget_starting_from_dollars).reduce((e,t)=>e+t.item.budget_starting_from_dollars,0)/e.filter(e=>e.item.budget_starting_from_dollars).length||0,averageHourlyRate:e.filter(e=>e.item.hourly_rate).reduce((e,t)=>e+t.item.hourly_rate,0)/e.filter(e=>e.item.hourly_rate).length||0},o={withDescriptions:e.filter(e=>e.item.description&&e.item.description.trim()).length,withLogos:e.filter(e=>e.item.logo_url&&e.item.logo_url.trim()).length,withWebsites:e.filter(e=>e.item.website_url&&e.item.website_url.trim()).length,withApps:e.filter(e=>e.item.has_apps_to_share&&e.item.apps&&e.item.apps.length>0).length,termsAccepted:e.filter(e=>e.item.terms_accepted).length},c=e.reduce((e,t)=>{var s;const a=(null===(s=t.item_creator)||void 0===s?void 0:s.full_name)||"Unknown";return e[a]=(e[a]||0)+1,e},{}),d=He()(),u=e.filter(e=>He()(e.item.created_date).isSame(d,"month")).length,m=e.filter(e=>He()(e.item.created_date).isSame(d,"quarter")).length,x={total:t.length,thisMonth:t.filter(e=>He()(e.created_date).isSame(d,"month")).length,thisQuarter:t.filter(e=>He()(e.created_date).isSame(d,"quarter")).length},h=t.reduce((e,t)=>{const s=t.partner_name||"Unknown";return e[s]=(e[s]||0)+1,e},{}),p=t.reduce((e,t)=>{const s=t.project_type||"unknown";return e[s]=(e[s]||0)+1,e},{}),g=t.reduce((e,t)=>{const s=t.work_basis||"unknown";return e[s]=(e[s]||0)+1,e},{}),f=t.reduce((e,t)=>{const s=t.start_date||"unknown";return e[s]=(e[s]||0)+1,e},{}),v={uniqueClients:new Set(t.map(e=>e.client_email)).size,averageRequestsPerClient:t.length/new Set(t.map(e=>e.client_email)).size||0,repeatClients:Object.values(t.reduce((e,t)=>(e[t.client_email]=(e[t.client_email]||0)+1,e),{})).filter(e=>e>1).length};return{statusStats:s,typeStats:a,languageStats:n,countryStats:l,serviceStats:r,pricingStats:i,contentStats:o,creatorStats:Object.entries(c).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,10),topCountries:Object.entries(l).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,5),topServices:Object.entries(r).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,5),temporalStats:{thisMonth:u,thisQuarter:m,totalCreators:Object.keys(c).length},contactRequestsStats:x,topPartnersByRequests:Object.entries(h).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,10),projectTypeStats:p,workBasisStats:g,startDateStats:f,clientEngagementStats:v}}(O,B);return(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-emerald-100 rounded-lg",children:(0,se.jsx)(_P.A,{className:"h-5 w-5 text-emerald-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Status Overview"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Approval pipeline health"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"text-center p-4 bg-slate-50 rounded-lg",children:[(0,se.jsx)("div",{className:"text-3xl font-bold text-slate-900",children:e.statusStats.total}),(0,se.jsx)("div",{className:"text-sm text-slate-600 font-medium",children:"Total Partners"})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-emerald-700",children:"Approved"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-emerald-700",children:[e.statusStats.approved," (",(e.statusStats.approved/e.statusStats.total*100).toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-emerald-100 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-emerald-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.statusStats.approved/e.statusStats.total*100,"%")}})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-amber-700",children:"Pending"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-amber-700",children:[e.statusStats.pending," (",(e.statusStats.pending/e.statusStats.total*100).toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-amber-100 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-amber-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.statusStats.pending/e.statusStats.total*100,"%")}})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-red-700",children:"Rejected"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-red-700",children:[e.statusStats.rejected," (",(e.statusStats.rejected/e.statusStats.total*100).toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-red-100 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.statusStats.rejected/e.statusStats.total*100,"%")}})})]})]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,se.jsx)(eb.A,{className:"h-5 w-5 text-blue-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Partner Analytics"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Types and geographic distribution"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.typeStats.individual}),(0,se.jsx)("div",{className:"text-xs text-blue-700 font-medium",children:"Individuals"})]}),(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-indigo-900",children:e.typeStats.team}),(0,se.jsx)("div",{className:"text-xs text-indigo-700 font-medium",children:"Teams"})]})]}),(0,se.jsxs)("div",{className:"p-4 bg-slate-50 rounded-lg border-l-4 border-green-500",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-700 mb-2",children:"Top Regions"}),(0,se.jsx)("div",{className:"space-y-2",children:e.topCountries.slice(0,3).map((e,t)=>{let[s,a]=e;return(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-xs text-slate-600",children:s}),(0,se.jsx)("span",{className:"text-xs font-bold text-slate-900",children:a})]},s)})})]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,se.jsx)(FQ.A,{className:"h-5 w-5 text-purple-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Profile Quality"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Completeness metrics"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"With Descriptions"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[(e.contentStats.withDescriptions/e.statusStats.total*100).toFixed(1),"%"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.contentStats.withDescriptions/e.statusStats.total*100,"%")}})})]}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Terms Accepted"}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[(e.contentStats.termsAccepted/e.statusStats.total*100).toFixed(1),"%"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.contentStats.termsAccepted/e.statusStats.total*100,"%")}})})]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[(0,se.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg border border-green-200",children:[(0,se.jsx)("div",{className:"text-xl font-bold text-green-700",children:e.contentStats.withLogos}),(0,se.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"With Logos"})]}),(0,se.jsxs)("div",{className:"text-center p-3 bg-orange-50 rounded-lg border border-orange-200",children:[(0,se.jsx)("div",{className:"text-xl font-bold text-orange-700",children:e.contentStats.withApps}),(0,se.jsx)("div",{className:"text-xs text-orange-600 font-medium",children:"With Apps"})]})]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-teal-100 rounded-lg",children:(0,se.jsx)(KP.A,{className:"h-5 w-5 text-teal-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Services & Languages"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Service portfolio analysis"})]})]}),(0,se.jsx)("div",{className:"space-y-4",children:(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-700",children:"Top Services"}),e.topServices.slice(0,4).map((t,s)=>{let[a,n]=t;const l=n/e.statusStats.total*100;return(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:a}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[n," (",l.toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"".concat(["bg-blue-500","bg-green-500","bg-purple-500","bg-orange-500"][s]," h-2 rounded-full transition-all duration-500"),style:{width:"".concat(l,"%")}})})]},a)})]})})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-rose-100 rounded-lg",children:(0,se.jsx)(OQ.A,{className:"h-5 w-5 text-rose-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Top Contributors"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Most active partner creators"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-rose-50 to-rose-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-rose-900",children:e.temporalStats.totalCreators}),(0,se.jsx)("div",{className:"text-xs text-rose-700 font-medium",children:"Total Contributors"})]}),(0,se.jsx)("div",{className:"space-y-3",children:e.creatorStats.slice(0,5).map((e,t)=>{let[s,a]=e;return(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:t+1}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700 truncate max-w-24",children:s})]}),(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:"text-right",children:[(0,se.jsx)("div",{className:"text-sm font-bold text-slate-900",children:a}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"partners"})]})})]},s)})})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-cyan-100 rounded-lg",children:(0,se.jsx)(Pf.A,{className:"h-5 w-5 text-cyan-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Recent Activity"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Growth and trends"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,se.jsxs)("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-green-700",children:"This Month"}),(0,se.jsx)("span",{className:"text-xl font-bold text-green-900",children:e.temporalStats.thisMonth})]}),(0,se.jsx)("div",{className:"text-xs text-green-600 mt-1",children:"new partners"})]}),(0,se.jsxs)("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg border border-blue-200",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"This Quarter"}),(0,se.jsx)("span",{className:"text-xl font-bold text-blue-900",children:e.temporalStats.thisQuarter})]}),(0,se.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"total registrations"})]})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[e.pricingStats.averageBudget>0&&(0,se.jsxs)("div",{className:"p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-purple-700 mb-2",children:"Average Project Budget"}),(0,se.jsxs)("div",{className:"text-lg font-bold text-purple-900",children:["$",e.pricingStats.averageBudget.toLocaleString()]}),(0,se.jsxs)("div",{className:"text-xs text-purple-600 mt-1",children:["starting budget across ",e.pricingStats.withBudget," partners"]})]}),e.pricingStats.averageHourlyRate>0&&(0,se.jsxs)("div",{className:"p-4 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-emerald-700 mb-2",children:"Average Hourly Rate"}),(0,se.jsxs)("div",{className:"text-lg font-bold text-emerald-900",children:["$",e.pricingStats.averageHourlyRate.toFixed(0),"/hr"]}),(0,se.jsxs)("div",{className:"text-xs text-emerald-600 mt-1",children:["across ",e.pricingStats.withHourlyRate," partners"]})]})]})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-indigo-100 rounded-lg",children:(0,se.jsx)(Xx.A,{className:"h-5 w-5 text-indigo-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Contact Requests"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Client engagement metrics"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"text-center p-4 bg-slate-50 rounded-lg",children:[(0,se.jsx)("div",{className:"text-3xl font-bold text-slate-900",children:e.contactRequestsStats.total}),(0,se.jsx)("div",{className:"text-sm text-slate-600 font-medium",children:"Total Requests"})]}),(0,se.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-indigo-900",children:e.clientEngagementStats.uniqueClients}),(0,se.jsx)("div",{className:"text-xs text-indigo-700 font-medium",children:"Unique Clients"})]}),(0,se.jsxs)("div",{className:"text-center p-3 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:[(0,se.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:e.clientEngagementStats.repeatClients}),(0,se.jsx)("div",{className:"text-xs text-purple-700 font-medium",children:"Repeat Clients"})]})]}),(0,se.jsx)("div",{className:"space-y-2",children:(0,se.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg border-l-4 border-green-500",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-green-700",children:"This Month"}),(0,se.jsx)("span",{className:"text-lg font-bold text-green-900",children:e.contactRequestsStats.thisMonth})]}),(0,se.jsx)("div",{className:"text-xs text-green-600 mt-1",children:"new requests"})]})})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-emerald-100 rounded-lg",children:(0,se.jsx)(ob.A,{className:"h-5 w-5 text-emerald-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Most Contacted Partners"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Popular partner rankings"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsx)("div",{className:"space-y-3",children:e.topPartnersByRequests.slice(0,5).map((e,t)=>{let[s,a]=e;return(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:t+1}),(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700 truncate max-w-24",children:s})]}),(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:"text-right",children:[(0,se.jsx)("div",{className:"text-sm font-bold text-slate-900",children:a}),(0,se.jsx)("div",{className:"text-xs text-slate-500",children:"requests"})]})})]},s)})}),0===e.topPartnersByRequests.length&&(0,se.jsx)("div",{className:"text-center py-4 text-slate-500",children:(0,se.jsx)("div",{className:"text-sm",children:"No contact requests yet"})})]})]}),(0,se.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[(0,se.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,se.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,se.jsx)(UQ.A,{className:"h-5 w-5 text-orange-600"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h3",{className:"font-semibold text-slate-800",children:"Project Insights"}),(0,se.jsx)("p",{className:"text-xs text-slate-500",children:"Client preferences analysis"})]})]}),(0,se.jsxs)("div",{className:"space-y-4",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-700",children:"Project Types"}),Object.entries(e.projectTypeStats).map((t,s)=>{let[a,n]=t;const l=n/e.contactRequestsStats.total*100,r="new_project"===a?"New Project":"Existing Project";return(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:r}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[n," (",l.toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"".concat(["bg-blue-500","bg-green-500"][s]," h-2 rounded-full transition-all duration-500"),style:{width:"".concat(l,"%")}})})]},a)})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-slate-700",children:"Work Basis Preference"}),Object.entries(e.workBasisStats).map((t,s)=>{let[a,n]=t;const l=n/e.contactRequestsStats.total*100,r="hourly"===a?"Hourly Rate":"fixed_price"===a?"Fixed Price":a;return(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)("span",{className:"text-sm font-medium text-slate-700",children:r}),(0,se.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[n," (",l.toFixed(1),"%)"]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,se.jsx)("div",{className:"".concat(["bg-purple-500","bg-pink-500"][s]," h-2 rounded-full transition-all duration-500"),style:{width:"".concat(l,"%")}})})]},a)})]})]})]})]})})()]}),(0,se.jsxs)("div",{className:"mb-8 space-y-4",children:[(0,se.jsx)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3 items-start lg:items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center flex-1",children:[(0,se.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,se.jsx)(nl,{placeholder:"Search partners, services, locations...",className:"pl-10 h-9 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-200",value:c,onChange:e=>d(e.target.value)})]}),(0,se.jsxs)(br,{value:i,onValueChange:o,children:[(0,se.jsx)(Nr,{className:"w-36 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(HO.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(yr,{placeholder:"Status"})]})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"all",children:"All Status"}),(0,se.jsx)(Ar,{value:"pending",children:"Pending"}),(0,se.jsx)(Ar,{value:"approved",children:"Approved"}),(0,se.jsx)(Ar,{value:"rejected",children:"Rejected"})]})]}),(0,se.jsxs)(br,{value:L,onValueChange:M,children:[(0,se.jsx)(Nr,{className:"w-36 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(eb.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(yr,{placeholder:"Type"})]})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"all",children:"All Types"}),(0,se.jsx)(Ar,{value:"individual",children:"Individual"}),(0,se.jsx)(Ar,{value:"team",children:"Team"})]})]}),(0,se.jsxs)("div",{className:"relative w-full sm:w-40",children:[(0,se.jsx)(BQ.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,se.jsx)(nl,{placeholder:"Location...",className:"pl-10 h-9 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-200",value:R,onChange:e=>D(e.target.value)})]}),$()&&(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>{o("all"),M("all"),D(""),d(""),N(1)},className:"h-9 px-3 text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-all duration-200",children:[(0,se.jsx)(la.A,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-1.5 rounded-lg",children:[(0,se.jsx)(lA.A,{className:"h-3.5 w-3.5"}),w>0?"".concat(w," total partners"):"".concat(a.length," partners")]})]})}),$()&&(0,se.jsxs)("div",{className:"flex flex-wrap gap-2 items-center p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:[(0,se.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[(0,se.jsx)(By.A,{className:"h-3.5 w-3.5"}),"Active filters:"]}),"all"!==i&&(0,se.jsxs)(gs,{className:"bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Status: ",i,(0,se.jsx)("button",{onClick:()=>o("all"),className:"ml-1 hover:bg-blue-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),"all"!==L&&(0,se.jsxs)(gs,{className:"bg-teal-100 text-teal-800 hover:bg-teal-200 transition-colors",children:["Type: ",L,(0,se.jsx)("button",{onClick:()=>M("all"),className:"ml-1 hover:bg-teal-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),R&&(0,se.jsxs)(gs,{className:"bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:["Location: ",R,(0,se.jsx)("button",{onClick:()=>D(""),className:"ml-1 hover:bg-purple-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),c&&(0,se.jsxs)(gs,{className:"bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:['Search: "',c,'"',(0,se.jsx)("button",{onClick:()=>d(""),className:"ml-1 hover:bg-green-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})]})]}),(0,se.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{className:"w-8"}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>K("name"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Partner",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>K("city"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Location",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>K("individual_or_team"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Type",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{children:"Services"}),(0,se.jsx)(hi,{children:"Languages"}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>K("status"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Status",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer w-40",onClick:()=>K("created_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Created Date",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{children:"Actions"})]})}),(0,se.jsx)(ui,{children:l?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:9,className:"text-center py-8",children:"Loading partners..."})}):0===a.length?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:9,className:"text-center py-8",children:"No partners found"})}):a.map(e=>(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)(xi,{className:"hover:bg-gray-50/80 transition-colors duration-200 group h-12",children:[(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsx)(zt,{variant:"ghost",size:"sm",onClick:()=>{return t=e.item.id,void P(e=>{const s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s});var t},className:"h-6 w-6 p-0 rounded hover:bg-gray-100 transition-all duration-200 group",children:I.has(e.item.id)?(0,se.jsx)(_t.A,{className:"h-3 w-3 text-gray-600 group-hover:text-gray-900 transition-colors"}):(0,se.jsx)(bs.A,{className:"h-3 w-3 text-gray-600 group-hover:text-gray-900 transition-colors"})})}),(0,se.jsx)(pi,{className:"font-medium py-2 text-sm",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[e.item.logo_url&&""!==e.item.logo_url.trim()?(0,se.jsx)("img",{src:e.item.logo_url,alt:"".concat(e.item.name," logo"),className:"h-8 w-8 rounded-full object-cover border border-gray-200",onError:e=>{e.target.style.display="none"}}):(0,se.jsx)(Zg.A,{className:"h-8 w-8 text-gray-400 p-1 border border-gray-200 rounded-full bg-gray-50"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"font-medium text-gray-900",children:e.item.name}),(0,se.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[e.item.website_url&&(0,se.jsxs)("a",{href:e.item.website_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1",children:[(0,se.jsx)(KP.A,{className:"h-3 w-3"}),"Website"]}),e.item.linkedin_url&&(0,se.jsxs)("a",{href:e.item.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1",children:[(0,se.jsx)(HD.A,{className:"h-3 w-3"}),"LinkedIn"]})]})]})]})}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[(0,se.jsx)(BQ.A,{className:"h-3.5 w-3.5"}),e.item.city,", ",WE(e.item.country)]})}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsx)("div",{className:"flex items-center gap-1 text-sm",children:"individual"===e.item.individual_or_team?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ay.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)("span",{className:"text-gray-600",children:"Individual"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(eb.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)("span",{className:"text-gray-600",children:"Team"})]})})}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsx)("div",{className:"text-sm text-gray-600",children:e.item.services&&e.item.services.length>0?(0,se.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.item.services.slice(0,2).map((t,s)=>(0,se.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-md",children:"Other"===t&&e.item.other_service_description?"Other: ".concat(e.item.other_service_description.substring(0,20),"..."):t},s)),e.item.services.length>2&&(0,se.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.item.services.length-2]})]}):(0,se.jsx)("span",{className:"text-gray-400 text-xs",children:"No services"})})}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsx)("div",{className:"text-sm text-gray-600",children:e.item.languages&&e.item.languages.length>0?(0,se.jsxs)("div",{className:"flex flex-wrap gap-1",children:[zQ(e.item.languages.slice(0,2)).map((e,t)=>(0,se.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-md",children:e},t)),e.item.languages.length>2&&(0,se.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.item.languages.length-2]})]}):(0,se.jsx)("span",{className:"text-gray-400 text-xs",children:"No languages"})})}),(0,se.jsxs)(pi,{className:"py-2",children:[Z(e.item.status),"rejected"===e.item.status&&e.item.rejected_reason&&(0,se.jsx)("div",{className:"mt-1 text-xs text-red-600 max-w-xs truncate",children:e.item.rejected_reason})]}),(0,se.jsx)(pi,{className:"py-2 w-40",children:He().utc(e.item.created_date).fromNow()}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsxs)(zt,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),(e=>{var t,s;const a={name:e.item.name||"",description:e.item.description||"",logo_url:e.item.logo_url||"",website_url:e.item.website_url||"",linkedin_url:e.item.linkedin_url||"",country:e.item.country||"",city:e.item.city||"",individual_or_team:e.item.individual_or_team||"individual",services:e.item.services||[],languages:e.item.languages||[],budget_starting_from_dollars:(null===(t=e.item.budget_starting_from_dollars)||void 0===t?void 0:t.toString())||"",hourly_rate:(null===(s=e.item.hourly_rate)||void 0===s?void 0:s.toString())||"",other_service_description:e.item.other_service_description||"",apps:e.item.apps||[],has_apps_to_share:!0===e.item.has_apps_to_share,no_apps_explanation:e.item.no_apps_explanation||"",terms_accepted:e.item.terms_accepted||!1};v((0,ue.A)((0,ue.A)({},e),{},{editData:a})),j(!0)})(e)},disabled:E[e.item.id],className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 h-8 px-3 transition-all duration-200",children:[(0,se.jsx)(eU.A,{className:"h-3.5 w-3.5 mr-1"}),"Edit"]}),"pending"===e.item.status&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(zt,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),q(e)},disabled:E[e.item.id],className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 px-3 transition-all duration-200",children:"Approve"}),(0,se.jsx)(zt,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),G(e)},disabled:E[e.item.id],className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-8 px-3 transition-all duration-200",children:"Reject"})]}),"rejected"===e.item.status&&(0,se.jsx)(zt,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),q(e)},disabled:E[e.item.id],className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-8 px-3 transition-all duration-200",children:"Approve"}),"approved"===e.item.status&&(0,se.jsx)(zt,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),G(e)},disabled:E[e.item.id],className:"text-amber-600 hover:text-amber-700 hover:bg-amber-50 h-8 px-3 transition-all duration-200",children:"Revoke"}),(0,se.jsx)(zt,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),(async e=>{const t=e.item.id;T(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:!0}));try{await LQ.archiveItem(t),so({title:"Success",description:"".concat(e.item.name," has been archived")}),await W()}catch(s){so({title:"Error",description:"Failed to archive partner",variant:"destructive"})}finally{T(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:!1}))}})(e)},disabled:E[e.item.id],className:"text-gray-500 hover:text-gray-700 hover:bg-gray-100 h-8 px-3 transition-all duration-200",children:"Archive"})]})})]},e.item.id),I.has(e.item.id)&&(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:9,className:"bg-gradient-to-br from-gray-50 to-gray-100/50 p-8 border-t border-gray-100",children:(0,se.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-blue-500 rounded-full"}),"Description"]}),(0,se.jsx)("div",{className:"text-sm text-gray-600",children:e.item.description||(0,se.jsx)("span",{className:"text-gray-400 italic",children:"No description available"})})]}),(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-green-500 rounded-full"}),"Services & Pricing"]}),(0,se.jsxs)("div",{className:"space-y-3",children:[e.item.services&&e.item.services.length>0&&(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Services:"}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:e.item.services.map((t,s)=>(0,se.jsx)(gs,{className:"bg-blue-50 text-blue-700 border-blue-200",children:"Other"===t&&e.item.other_service_description?"Other: ".concat(e.item.other_service_description):t},s))})]}),(e.item.budget_starting_from_dollars||e.item.hourly_rate)&&(0,se.jsxs)("div",{children:[(0,se.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Pricing:"}),(0,se.jsxs)("div",{className:"mt-2 space-y-1",children:[e.item.budget_starting_from_dollars&&(0,se.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[(0,se.jsx)(OJ.A,{className:"h-3.5 w-3.5"}),"Starting from $",e.item.budget_starting_from_dollars.toLocaleString()]}),e.item.hourly_rate&&(0,se.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[(0,se.jsx)(jS.A,{className:"h-3.5 w-3.5"}),"$",e.item.hourly_rate,"/hour"]})]})]})]})]}),e.item.languages&&e.item.languages.length>0&&(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-purple-500 rounded-full"}),"Languages"]}),(0,se.jsx)("div",{className:"flex flex-wrap gap-2",children:zQ(e.item.languages).map((e,t)=>(0,se.jsx)(gs,{className:"bg-purple-50 text-purple-700 border-purple-200",children:e},t))})]})]}),(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-orange-500 rounded-full"}),e.item.has_apps_to_share?"Portfolio Apps":"Experience"]}),e.item.has_apps_to_share?(0,se.jsx)("div",{children:e.item.apps&&e.item.apps.length>0?(0,se.jsx)("div",{className:"space-y-3",children:e.item.apps.map((e,t)=>(0,se.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,se.jsx)("div",{children:(0,se.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[(0,se.jsx)(Rj.A,{className:"h-3.5 w-3.5"}),e.url.replace(/^https?:\/\//,"").split("/")[0]]})}),e.allow_public_showcase&&(0,se.jsx)(gs,{className:"bg-green-100 text-green-700 text-xs",children:"Public Showcase"})]},t))}):(0,se.jsx)("p",{className:"text-sm text-gray-600",children:"No apps shared"})}):(0,se.jsx)("div",{className:"text-sm text-gray-600",children:e.item.no_apps_explanation||(0,se.jsx)("span",{className:"text-gray-400 italic",children:"No experience description provided"})})]}),(0,se.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-teal-500 rounded-full"}),"Terms & Conditions"]}),(0,se.jsx)("div",{className:"text-sm",children:e.item.terms_accepted?(0,se.jsxs)("div",{className:"flex items-center gap-2 text-green-700",children:[(0,se.jsx)(HO.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"font-medium",children:"Terms Accepted"}),e.item.terms_accepted_at&&(0,se.jsxs)("span",{className:"text-gray-500",children:["on ",new Date(e.item.terms_accepted_at).toLocaleDateString()]})]}):(0,se.jsxs)("div",{className:"flex items-center gap-2 text-red-600",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{className:"font-medium",children:"Terms Not Accepted"})]})})]}),"rejected"===e.item.status&&e.item.rejected_reason&&(0,se.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,se.jsxs)("h4",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[(0,se.jsx)("div",{className:"w-1 h-5 bg-red-500 rounded-full"}),"Rejection Reason"]}),(0,se.jsx)("div",{className:"text-sm text-red-800 bg-white p-3 rounded border border-red-200",children:e.item.rejected_reason})]})]})]})})})]}))})]})}),a.length>0&&(0,se.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,se.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:(0,se.jsxs)("span",{children:["Showing ",(y-1)*F+1," to ",Math.min(y*F,w)," of ",w," items"]})}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>N(e=>Math.max(e-1,1)),disabled:1===y||l,className:"h-8 px-3",children:"Previous"}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[y>2&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>N(1),className:"h-8 w-8 p-0",children:"1"}),y>3&&(0,se.jsx)("span",{className:"px-1 text-gray-400",children:"..."})]}),y>1&&(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>N(e=>e-1),className:"h-8 w-8 p-0",children:y-1}),(0,se.jsx)(zt,{variant:"default",size:"sm",className:"h-8 w-8 p-0",children:y}),a.length===F&&(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>N(e=>e+1),disabled:l,className:"h-8 w-8 p-0",children:y+1})]}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>N(e=>e+1),disabled:a.length<F||l,className:"h-8 px-3",children:"Next"})]})]}),(0,se.jsx)(ma,{open:x,onOpenChange:h,children:(0,se.jsxs)(fa,{children:[(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{children:"Reject Partner Application"}),(0,se.jsx)(ya,{children:u&&(0,se.jsxs)("span",{children:["You are about to reject ",(0,se.jsx)("strong",{children:u.item.name}),". Please provide a reason for rejection."]})})]}),(0,se.jsxs)("div",{className:"space-y-4 py-4",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(On,{htmlFor:"reason",children:"Rejection Reason (Optional)"}),(0,se.jsx)(ki,{id:"reason",placeholder:"Enter the reason for rejection...",value:p,onChange:e=>g(e.target.value),className:"mt-2 min-h-[100px]"})]}),(0,se.jsx)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,se.jsxs)("div",{className:"flex gap-2",children:[(0,se.jsx)(ad.A,{className:"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-amber-800",children:"This action will mark the partner as rejected and they will need to reapply."})]})})]}),(0,se.jsxs)(ba,{children:[(0,se.jsx)(zt,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),(0,se.jsx)(zt,{variant:"destructive",onClick:async()=>{if(!u)return;const e=u.item.id;T(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!0})),h(!1);try{await LQ.declineItem(e,p),so({title:"Partner Rejected",description:"".concat(u.item.name," has been rejected")}),await W()}catch(t){so({title:"Error",description:"Failed to reject partner",variant:"destructive"})}finally{T(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:!1}))}},disabled:E[null==u?void 0:u.item.id],children:"Reject Partner"})]})]})}),f&&(0,se.jsx)(DQ,{isOpen:b,onClose:()=>{j(!1),v(null)},mode:"edit",initialData:f.editData,partnerId:f.item.id,onSuccess:()=>{W()}})]})}function VQ(){const[e,t]=(0,Y.useState)([]),[s,a]=(0,Y.useState)(!0),[n,l]=(0,Y.useState)(""),[r,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)(0),[m,x]=(0,Y.useState)(1),[h,p]=(0,Y.useState)({key:"created_date",direction:"desc"}),[g,f]=(0,Y.useState)(null),[v,b]=(0,Y.useState)("all"),[j,y]=(0,Y.useState)("all"),N=25;(0,Y.useEffect)(()=>{if(g&&clearTimeout(g),1===m)return f(setTimeout(()=>{w()},500)),()=>{g&&clearTimeout(g)};x(1)},[n,v,j,h]),(0,Y.useEffect)(()=>{w()},[m]);const w=async()=>{try{var e;a(!0);let s={skip:(m-1)*N,limit:N,sort_by:"desc"===h.direction?"-".concat(h.key):h.key};n&&(s.search=n),"all"!==v&&(s.project_type=v),"all"!==j&&(s.work_basis=j);const l=await LQ.getAllContactRequests(s);t(l.items||[]),u(l.total||(null===(e=l.items)||void 0===e?void 0:e.length)||0)}catch(s){so({title:"Error",description:"Failed to load contact requests",variant:"destructive"})}finally{a(!1)}},_=e=>{const t=h.key===e&&"asc"===h.direction?"desc":"asc";p({key:e,direction:t}),x(1)},k=()=>"all"!==v||"all"!==j||""!==n,C=e=>{switch(e){case"as_soon_as_possible":return"ASAP";case"within_a_week":return"Within a week";case"within_a_month":return"Within a month";case"more_than_a_month":return"1+ months";default:return e}},A=e=>"hourly"===e?"Hourly Rate":"Fixed Price",S=e=>"new_project"===e?"New Project":"Existing Project";return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"mb-8 space-y-4",children:[(0,se.jsx)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:(0,se.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3 items-start lg:items-center justify-between",children:[(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center flex-1",children:[(0,se.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,se.jsx)(na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,se.jsx)(nl,{placeholder:"Search clients, partners, projects...",className:"pl-10 h-9 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-200",value:n,onChange:e=>l(e.target.value)})]}),(0,se.jsxs)(br,{value:v,onValueChange:b,children:[(0,se.jsx)(Nr,{className:"w-36 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(UQ.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(yr,{placeholder:"Project"})]})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"all",children:"All Projects"}),(0,se.jsx)(Ar,{value:"new_project",children:"New Project"}),(0,se.jsx)(Ar,{value:"existing_project",children:"Existing Project"})]})]}),(0,se.jsxs)(br,{value:j,onValueChange:y,children:[(0,se.jsx)(Nr,{className:"w-36 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)(OJ.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,se.jsx)(yr,{placeholder:"Pricing"})]})}),(0,se.jsxs)(kr,{children:[(0,se.jsx)(Ar,{value:"all",children:"All Pricing"}),(0,se.jsx)(Ar,{value:"hourly",children:"Hourly Rate"}),(0,se.jsx)(Ar,{value:"fixed",children:"Fixed Price"})]})]}),k()&&(0,se.jsxs)(zt,{variant:"outline",size:"sm",onClick:()=>{b("all"),y("all"),l(""),x(1)},className:"h-9 px-3 text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-all duration-200",children:[(0,se.jsx)(la.A,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-1.5 rounded-lg",children:[(0,se.jsx)(lA.A,{className:"h-3.5 w-3.5"}),d>0?"".concat(d," total requests"):"".concat(e.length," requests")]})]})}),k()&&(0,se.jsxs)("div",{className:"flex flex-wrap gap-2 items-center p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:[(0,se.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[(0,se.jsx)(By.A,{className:"h-3.5 w-3.5"}),"Active filters:"]}),"all"!==v&&(0,se.jsxs)(gs,{className:"bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Type: ","new_project"===v?"New Project":"Existing Project",(0,se.jsx)("button",{onClick:()=>b("all"),className:"ml-1 hover:bg-blue-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),"all"!==j&&(0,se.jsxs)(gs,{className:"bg-teal-100 text-teal-800 hover:bg-teal-200 transition-colors",children:["Pricing: ","hourly"===j?"Hourly Rate":"Fixed Price",(0,se.jsx)("button",{onClick:()=>y("all"),className:"ml-1 hover:bg-teal-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]}),n&&(0,se.jsxs)(gs,{className:"bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:['Search: "',n,'"',(0,se.jsx)("button",{onClick:()=>l(""),className:"ml-1 hover:bg-green-300 rounded-full p-0.5 transition-colors",children:(0,se.jsx)(la.A,{className:"h-3 w-3"})})]})]})]}),(0,se.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,se.jsxs)(ci,{children:[(0,se.jsx)(di,{children:(0,se.jsxs)(xi,{children:[(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>_("client_name"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Client",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>_("partner_name"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Partner",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{children:"Project Description"}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>_("project_type"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Type",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>_("work_basis"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Pricing",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer",onClick:()=>_("start_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Start Date",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{className:"cursor-pointer w-40",onClick:()=>_("created_date"),children:(0,se.jsxs)("div",{className:"flex items-center",children:["Created",(0,se.jsx)(yH.A,{className:"ml-2 h-4 w-4"})]})}),(0,se.jsx)(hi,{children:"Actions"})]})}),(0,se.jsx)(ui,{children:s?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:8,className:"text-center py-8",children:"Loading contact requests..."})}):0===e.length?(0,se.jsx)(xi,{children:(0,se.jsx)(pi,{colSpan:8,className:"text-center py-8",children:"No contact requests found"})}):e.map(e=>{var t;return(0,se.jsxs)(xi,{className:"hover:bg-gray-50/80 transition-colors duration-200",children:[(0,se.jsx)(pi,{className:"font-medium py-2 text-sm",children:(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"font-medium text-gray-900",children:e.client_name}),(0,se.jsxs)("div",{className:"flex items-center gap-1 mt-0.5 text-xs text-gray-500",children:[(0,se.jsx)(Hc.A,{className:"h-3 w-3"}),e.client_email]}),(0,se.jsxs)("div",{className:"flex items-center gap-1 mt-0.5 text-xs text-gray-500",children:[(0,se.jsx)(ay.A,{className:"h-3 w-3"}),"Account: ",e.requester_email]})]})}),(0,se.jsx)(pi,{className:"py-2 text-sm",children:(0,se.jsxs)("div",{className:"flex items-center gap-1 text-gray-700",children:[(0,se.jsx)(Zg.A,{className:"h-3.5 w-3.5 text-gray-400"}),e.partner_name]})}),(0,se.jsx)(pi,{className:"py-2 text-sm max-w-xs",children:(0,se.jsx)("div",{className:"truncate text-gray-600",title:e.project_description,children:(null===(t=e.project_description)||void 0===t?void 0:t.length)>100?"".concat(e.project_description.substring(0,100),"..."):e.project_description})}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsx)(gs,{variant:"outline",className:"text-xs",children:S(e.project_type)})}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsx)(gs,{variant:"outline",className:"text-xs",children:A(e.work_basis)})}),(0,se.jsx)(pi,{className:"py-2 text-sm text-gray-600",children:(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsx)(H_.A,{className:"h-3 w-3"}),C(e.start_date)]})}),(0,se.jsx)(pi,{className:"py-2 w-40 text-sm text-gray-500",children:He().utc(e.created_date).fromNow()}),(0,se.jsx)(pi,{className:"py-2",children:(0,se.jsxs)(zt,{size:"sm",variant:"outline",onClick:()=>(e=>{i(e),c(!0)})(e),className:"h-7 text-xs",children:["View Details",(0,se.jsx)(bs.A,{className:"h-3 w-3 ml-1"})]})})]},e.id)})})]})}),e.length>0&&(0,se.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,se.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:(0,se.jsxs)("span",{children:["Showing ",(m-1)*N+1," to ",Math.min(m*N,d)," of ",d," items"]})}),(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>x(e=>Math.max(e-1,1)),disabled:1===m||s,className:"h-8 px-3",children:"Previous"}),(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[m>2&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>x(1),className:"h-8 w-8 p-0",children:"1"}),m>3&&(0,se.jsx)("span",{className:"px-1 text-gray-400",children:"..."})]}),m>1&&(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>x(e=>e-1),className:"h-8 w-8 p-0",children:m-1}),(0,se.jsx)(zt,{variant:"default",size:"sm",className:"h-8 w-8 p-0",children:m}),e.length===N&&(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>x(e=>e+1),disabled:s,className:"h-8 w-8 p-0",children:m+1})]}),(0,se.jsx)(zt,{variant:"outline",size:"sm",onClick:()=>x(e=>e+1),disabled:e.length<N||s,className:"h-8 px-3",children:"Next"})]})]}),(0,se.jsx)(ma,{open:o,onOpenChange:c,children:(0,se.jsxs)(fa,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,se.jsx)(va,{children:(0,se.jsx)(ja,{children:"Contact Request Details"})}),r&&(0,se.jsxs)("div",{className:"space-y-6 pt-4",children:[(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Client Information"}),(0,se.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600",children:"Name"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:r.client_name})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600",children:"Email"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:r.client_email})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600",children:"Account"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:r.requester_email})]})]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Partner"}),(0,se.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600",children:"Partner Name"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:r.partner_name})]})})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Project Details"}),(0,se.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600",children:"Type"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:S(r.project_type)})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600",children:"Work Basis"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:A(r.work_basis)})]}),(0,se.jsxs)("div",{className:"flex justify-between",children:[(0,se.jsx)("span",{className:"text-sm text-gray-600",children:"Start Date"}),(0,se.jsx)("span",{className:"text-sm font-medium text-gray-900",children:C(r.start_date)})]})]})]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Project Description"}),(0,se.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,se.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:r.project_description})})]}),(0,se.jsx)("div",{className:"pt-4 border-t border-gray-200",children:(0,se.jsxs)("p",{className:"text-xs text-gray-500",children:["Submitted: ",new Date(r.created_date).toLocaleString()]})})]})]})})]})}function WQ(){const{user:e}=wd(),[t,s]=(0,Y.useState)("partners"),[a,n]=(0,Y.useState)(!1);return e&&$p(null==e?void 0:e.platform_role)?(0,se.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,se.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,se.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"p-2 bg-slate-900 rounded-xl",children:(0,se.jsx)(HO.A,{className:"h-6 w-6 text-white"})}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Partner Management"}),(0,se.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage partner profiles and review contact requests"})]})]})}),(0,se.jsxs)(ji,{value:t,onValueChange:s,className:"space-y-6",children:[(0,se.jsxs)(yi,{className:"grid w-full max-w-md grid-cols-2 bg-white border border-slate-200 shadow-sm",children:[(0,se.jsxs)(Ni,{value:"partners",className:"flex items-center gap-2 data-[state=active]:bg-slate-900 data-[state=active]:text-white transition-all duration-200",children:[(0,se.jsx)(eb.A,{className:"h-4 w-4"}),"Partners"]}),(0,se.jsxs)(Ni,{value:"contact-requests",className:"flex items-center gap-2 data-[state=active]:bg-slate-900 data-[state=active]:text-white transition-all duration-200",children:[(0,se.jsx)(Xx.A,{className:"h-4 w-4"}),"Contact Requests"]})]}),(0,se.jsx)(wi,{value:"partners",className:"mt-6",children:(0,se.jsx)(HQ,{showAnalytics:a,setShowAnalytics:n})}),(0,se.jsx)(wi,{value:"contact-requests",className:"mt-6",children:(0,se.jsx)(VQ,{})})]})]})}):(0,se.jsx)(J.C5,{to:"/",replace:!0})}function qQ(e){let{totalPartners:t,onBecomePartnerClick:s}=e;const{user:a}=wd();return(0,se.jsxs)("div",{className:"relative font-base44 bg-gradient-to-r from-[#f6f3ef] to-[#f4f4f5] w-full overflow-hidden",children:[(0,se.jsx)("div",{className:"absolute -right-[100%] bottom-[-100%] md:-right-[50%] md:bottom-[-140%] xl:-right-[30%] xl:bottom-[-140%] w-[60rem] h-[40rem] rounded-full blur-[150px] opacity-100",style:{background:"radial-gradient(ellipse 50% 50% at 50% 50%, #FF5500, #FFEAA6"}}),(0,se.jsx)("div",{className:"relative z-10 max-w-7xl mx-auto px-6 lg:px-8 py-14",children:(0,se.jsxs)("div",{className:"flex flex-col justify-start items-start gap-4",children:[(0,se.jsx)("h1",{className:"text-8xl font-normal text-slate-800/90 ",children:"Hire a partner"}),(0,se.jsx)("p",{className:"max-w-4xl text-base font-normal text-slate-800  leading-relaxed",children:"From first steps to advanced builds, Base44 Partners provide the expertise and insight to help you achieve the best outcome. Explore partners and reach out to start collaborating."}),(0,se.jsxs)("div",{className:"flex flex-wrap justify-start items-center gap-1.5",children:[(0,se.jsx)("span",{className:"text-base font-normal text-slate-800/90 leading-loose whitespace-nowrap",children:"Want to become a Base44 Partner?"}),(0,se.jsx)("button",{onClick:()=>{const e={user_id:(null==a?void 0:a.id)||null,app_id:null,conversation_id:null},t={cta:"Apply here",origin:"partner_catalog_hero",target_route:null,section:"catalog_header"};Tu("User clicked apply as partner",(0,ue.A)((0,ue.A)({},e),t)),Vu(e,t),s()},className:"text-base font-medium text-orange-500 leading-loose hover:text-orange-600 transition-colors whitespace-nowrap",children:"Apply here"})]})]})})]})}function YQ(e){let{title:t,onApply:s,onClearAll:a,onClearAndApply:n,children:l,width:r="w-80"}=e;return(0,se.jsxs)("div",{className:"".concat(r," flex flex-col gap-2"),children:[(0,se.jsx)("div",{className:"p-4",children:(0,se.jsx)(aN,{className:"text-xs font-medium text-slate-500 tracking-wide block",children:t})}),(0,se.jsx)("div",{className:"px-4",children:l}),(0,se.jsx)("div",{className:"border-t border-slate-200 px-4 py-4",children:(0,se.jsxs)("div",{className:"flex justify-between items-center",children:[(0,se.jsx)(Bx,{variant:"ghost",size:"sm",onClick:n,className:"text-slate-500 hover:text-slate-700 hover:bg-transparent px-0",children:"Clear All"}),(0,se.jsx)(Bx,{onClick:s,className:"px-6",size:"sm",children:"Apply"})]})})]})}const GQ=["Application Development","Mobile Development","UI/UX Design","AI Specialist","Security Specialist","API & Integrations","Strategic consulting","QA & Testing","Other"];function KQ(e){let{onApply:t,initialServices:s=[],onClose:a}=e;const[n,l]=(0,Y.useState)(s);(0,Y.useEffect)(()=>{l(s)},[s]);return(0,se.jsx)(YQ,{title:"Services",onApply:()=>{t(n)},onClearAll:()=>{l([])},onClearAndApply:()=>{l([]),t([]),null==a||a()},children:(0,se.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:GQ.map(e=>(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(E_,{id:e,checked:n.includes(e),onCheckedChange:()=>(e=>{n.includes(e)?l(n.filter(t=>t!==e)):l([...n,e])})(e)}),(0,se.jsx)("label",{htmlFor:e,className:"text-sm text-slate-700 cursor-pointer select-none flex-1",children:e})]},e))})})}function $Q(e){let{onApply:t,initialLanguages:s=[],onClose:a}=e;const[n,l]=(0,Y.useState)(s);(0,Y.useEffect)(()=>{l(s)},[s]);return(0,se.jsx)(YQ,{title:"Language",onApply:()=>{t(n)},onClearAll:()=>{l([])},onClearAndApply:()=>{l([]),t([]),null==a||a()},children:(0,se.jsx)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-3 max-h-64 overflow-y-auto",children:HE.map(e=>(0,se.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,se.jsx)(E_,{id:e.value,checked:n.includes(e.value),onCheckedChange:()=>{return t=e.value,void(n.includes(t)?l(n.filter(e=>e!==t)):l([...n,t]));var t}}),(0,se.jsx)("label",{htmlFor:e.value,className:"text-sm text-slate-700 cursor-pointer select-none flex-1",children:e.label})]},e.value))})})}function ZQ(e){let{selectedServices:t,onServicesChange:s,budgetRange:a,onBudgetRangeChange:n,selectedLanguages:l,onLanguagesChange:r,onBudgetApply:i,onServicesApply:o,onLanguagesApply:c}=e;const[d,u]=(0,Y.useState)(!1),[m,x]=(0,Y.useState)(!1);return(0,se.jsx)("div",{className:"w-full bg-white border-t border-b border-slate-200 font-base44",children:(0,se.jsx)("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-6 flex justify-between items-center",children:(0,se.jsx)("div",{className:"flex justify-end items-center gap-6",children:(0,se.jsxs)("div",{className:"flex justify-start items-center gap-10",children:[(0,se.jsxs)(mS,{open:d,onOpenChange:u,children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"ghost",className:"flex justify-end items-center gap-1 p-0 h-auto hover:bg-transparent",children:[(0,se.jsx)("span",{className:"text-black text-sm font-normal",children:"Service"}),(0,se.jsx)(_t.A,{className:"w-4 h-4 text-zinc-500"})]})}),(0,se.jsx)(hS,{className:"w-auto p-0",align:"start",children:(0,se.jsx)(KQ,{onApply:e=>{o(e),u(!1)},initialServices:t,onClose:()=>u(!1)})})]}),(0,se.jsxs)(mS,{open:m,onOpenChange:x,children:[(0,se.jsx)(xS,{asChild:!0,children:(0,se.jsxs)(Bx,{variant:"ghost",className:"flex justify-end items-center gap-1 p-0 h-auto hover:bg-transparent",children:[(0,se.jsx)("span",{className:"text-black text-sm font-normal",children:"Language"}),(0,se.jsx)(_t.A,{className:"w-4 h-4 text-zinc-500"})]})}),(0,se.jsx)(hS,{className:"w-auto p-0",align:"start",children:(0,se.jsx)($Q,{onApply:e=>{c(e),x(!1)},initialLanguages:l,onClose:()=>x(!1)})})]})]})})})})}function JQ(e){if(!e)return null;const t="string"==typeof e?Number(e):e;if(isNaN(t)||t<=0)return null;if(t>=1e3){const e=t/1e3;return"From $".concat(e%1==0?e.toFixed(0):e.toFixed(1),"K")}return"From $".concat(t)}function QQ(e){if(!e)return null;const t="string"==typeof e?Number(e):e;if(isNaN(t)||t<=0)return null;if(t>=1e3){const e=t/1e3;return"$".concat(e%1==0?e.toFixed(0):e.toFixed(1),"K/hr")}return"$".concat(t,"/hr")}function XQ(e){if(!e)return null;try{return new URL(e).hostname.replace(/^www\./,"")}catch(t){return e}}const eX=function(e){var t,s;let{partner:a,onContactClick:n}=e;const{item:l}=a,{user:r}=wd(),[i,o]=(0,Y.useState)(!1),c=(0,Y.useRef)(null),d=Array.isArray(l.services)?l.services.slice(0,4):[],u=Array.isArray(l.services)&&l.services.length>4?l.services.length-4:0;(0,Y.useEffect)(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&o(!1)},t=e=>{c.current&&!c.current.contains(e.relatedTarget)&&o(!1)};return i&&(document.addEventListener("mousedown",e),document.addEventListener("focusout",t)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("focusout",t)}},[i]);const m=e=>{o(!i)};return(0,se.jsx)("div",{ref:c,className:"group cursor-pointer h-full",onClick:m,children:(0,se.jsxs)("div",{className:"h-full bg-white rounded-2xl border border-slate-200 hover:border-slate-300 transition-all duration-300 hover:shadow-sm overflow-hidden flex flex-col",children:[(0,se.jsxs)("div",{className:"p-5 flex-1 flex flex-col",children:[(0,se.jsxs)("div",{className:"flex flex-col",children:[(0,se.jsxs)("div",{className:"flex items-start gap-3",children:[(0,se.jsx)("div",{className:"w-16 h-16 rounded-xl bg-slate-100 flex items-center justify-center overflow-hidden shadow-[inset_0_0_0_1px_rgba(226,232,240,1)]",children:l.logo_url?(0,se.jsx)("img",{src:l.logo_url,alt:l.name||"Partner",className:"w-full h-full object-contain"}):(0,se.jsx)("span",{className:"text-2xl font-light text-slate-400",children:null===(t=l.name)||void 0===t?void 0:t.charAt(0).toUpperCase()})}),(0,se.jsx)("div",{className:"flex-1 min-w-0",children:(0,se.jsxs)("div",{className:"flex flex-col min-w-0 space-y-2",children:[(0,se.jsx)("h3",{className:"text-gray-900 text-base font-semibold font-base44 leading-4 truncate",children:l.name}),(l.city||l.country)&&(0,se.jsx)(mp,{children:(0,se.jsxs)(xp,{children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)("div",{className:"text-gray-500 text-sm font-normal font-base44 leading-4 truncate",children:[l.city,l.country?WE(l.country):null].filter(Boolean).join(", ")})}),(0,se.jsx)(pp,{children:(0,se.jsx)("p",{children:[l.city,l.country?WE(l.country):null].filter(Boolean).join(", ")})})]})}),(l.website_url||l.linkedin_url)&&(0,se.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[l.website_url&&(0,se.jsx)("a",{href:l.website_url,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"flex items-center gap-1.5 text-sm text-blue-500 hover:text-blue-400 font-base44 leading-4 min-w-0",children:(0,se.jsxs)("div",{className:"inline-flex justify-start items-start gap-1",children:[(0,se.jsx)("div",{className:"justify-start text-sm font-normal font-base44 leading-4 truncate max-w-32",children:XQ(l.website_url)}),(0,se.jsx)("div",{"data-filled":"False","data-size":"Small",className:"flex justify-start items-start",children:(0,se.jsx)("div",{className:"w-4 h-4 relative",children:(0,se.jsx)(Rj.A,{className:"w-4 h-4 absolute "})})})]})}),l.linkedin_url&&(0,se.jsx)("a",{href:l.linkedin_url,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,se.jsx)("div",{className:"justify-start text-blue-500 text-sm hover:text-blue-400 font-normal leading-4",children:"LinkedIn"})})]})]})})]}),d.length>0&&(0,se.jsxs)("div",{className:"mt-4 flex flex-wrap gap-1.5",children:[null===(s=i?l.services:d)||void 0===s?void 0:s.map(e=>(0,se.jsx)(gk,{variant:"secondary",className:"rounded-2xl border border-slate-200 bg-white text-slate-700 px-3 py-1 shadow-[0_1px_0_rgba(0,0,0,0.02)] hover:bg-white",children:e},e)),u>0&&!i&&(0,se.jsxs)(gk,{variant:"secondary",className:"rounded-2xl border border-slate-200 bg-white text-slate-700 px-3 py-1 shadow-[0_1px_0_rgba(0,0,0,0.02)] cursor-pointer hover:bg-white",onClick:e=>{e.stopPropagation(),m()},children:["+",u]})]}),l.description&&(0,se.jsx)("div",{className:"mt-4 cursor-pointer",onClick:e=>{e.stopPropagation(),m()},children:(0,se.jsx)("p",{className:"\n                                self-stretch justify-start text-gray-600 text-sm font-normal font-base44 break-words transition-all duration-300 ease-in-out\n                                ".concat(i?"leading-normal":"max-h-10 leading-normal line-clamp-2 overflow-hidden","\n                            "),children:l.description})}),l.languages&&l.languages.length>0&&(0,se.jsxs)("div",{className:"mt-4 text-[15px] text-slate-500",children:[(0,se.jsx)("span",{className:"text-slate-500",children:"Languages:"})," ",(0,se.jsx)("span",{className:"text-slate-900",children:(x=l.languages,zQ(x).join(", "))})]})]}),(0,se.jsx)("div",{className:"flex-1"})]}),(0,se.jsxs)("div",{className:"flex flex-wrap items-center gap-4 border-t border-slate-200 px-5 py-5 flex-shrink-0",children:[(0,se.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-[15px] flex-1 min-w-0",children:[JQ(l.budget_starting_from_dollars)&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-slate-600 whitespace-nowrap",children:[(0,se.jsx)(OJ.A,{className:"h-4 w-4 text-slate-400"}),(0,se.jsx)("span",{children:JQ(l.budget_starting_from_dollars)})]}),QQ(l.hourly_rate)&&(0,se.jsxs)("div",{className:"flex items-center gap-2 text-slate-600 whitespace-nowrap",children:[(0,se.jsx)(jS.A,{className:"h-4 w-4 text-slate-400"}),(0,se.jsx)("span",{children:QQ(l.hourly_rate)})]})]}),(0,se.jsxs)(Bx,{onClick:e=>{e.stopPropagation();const t={user_id:(null==r?void 0:r.id)||null,app_id:null,conversation_id:null},s={cta:"Contact",origin:"partner_card",target_route:null,partner_id:l.id,partner_name:l.name||null,partner_services:l.services||[],partner_country:l.country||null};Tu("User clicked contact partner",(0,ue.A)((0,ue.A)({},t),s)),Vu(t,s),null==n||n()},variant:"outline",size:"lg",className:"h-10 px-5 rounded-xl border-slate-300 text-slate-800 bg-white hover:bg-slate-50 shadow-[0_1px_0_rgba(0,0,0,0.02)] flex-shrink-0",children:["Contact",(0,se.jsx)(Ws.A,{className:"h-3.5 w-3.5 ml-2"})]})]})]})});var x};function tX(e){let{isLoading:t,isLoadingMore:s,partners:a,onContactClick:n,onBecomePartnerClick:l,hasMore:r,targetRef:i}=e;return t?(0,se.jsx)("div",{className:"flex justify-center items-center py-32",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,se.jsx)("div",{className:"w-8 h-8 border-2 border-slate-200 border-t-slate-600 rounded-full animate-spin"}),(0,se.jsx)("p",{className:"text-sm text-slate-500",children:"Loading partners..."})]})}):t||0!==a.length?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:a.map(e=>(0,se.jsx)(eX,{partner:e,onContactClick:()=>n(e)},e.item.id))}),r&&(0,se.jsx)("div",{ref:i,className:"flex justify-center items-center py-12",children:s&&(0,se.jsxs)("div",{className:"flex items-center gap-3",children:[(0,se.jsx)("div",{className:"w-5 h-5 border-2 border-slate-200 border-t-slate-600 rounded-full animate-spin"}),(0,se.jsx)("span",{className:"text-sm text-slate-500",children:"Loading more..."})]})})]}):(0,se.jsx)("div",{className:"text-center py-32",children:(0,se.jsxs)("div",{className:"max-w-sm mx-auto",children:[(0,se.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)("svg",{className:"w-8 h-8 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,se.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No partners found"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 leading-relaxed mb-6",children:"Try adjusting your filters or search to find the right partner for your project."}),l&&(0,se.jsxs)("div",{className:"pt-6 border-t border-slate-100",children:[(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-3",children:"Are you a developer or agency?"}),(0,se.jsxs)(Bx,{variant:"outline",size:"sm",onClick:l,className:"border-slate-300",children:[(0,se.jsx)(op.A,{className:"h-4 w-4 mr-2"}),"Become a Partner"]})]})]})})}const sX=e=>{let{label:t,options:s,selectedValue:a,onValueChange:n,error:l,className:r=""}=e;return(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-1 ".concat(r),children:[(0,se.jsx)(aN,{className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:t}),(0,se.jsx)("div",{className:"w-full inline-flex justify-start items-start gap-3 mt-3",children:s.map(e=>(0,se.jsx)("button",{type:"button",onClick:()=>n(e.value),className:"flex-1 p-3 rounded-lg border flex justify-center items-center gap-3 transition-colors ".concat(a===e.value?"bg-white border-slate-950 text-black":"bg-white border-slate-200 text-black hover:bg-slate-50"),children:(0,se.jsxs)("div",{className:"inline-flex flex-col justify-center items-center gap-0.5",children:[(0,se.jsx)("div",{className:"inline-flex justify-start items-center gap-2",children:(0,se.jsx)("span",{className:"text-center text-sm font-medium font-base44 leading-tight",children:e.label})}),(0,se.jsx)("div",{className:"text-center text-sm font-normal font-base44 leading-tight",children:e.description})]})},e.value))}),l&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:l})]})},aX=e=>{let{label:t,helperText:s,selectedServices:a,onServiceToggle:n,error:l,className:r=""}=e;return(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-2 ".concat(r),children:[(0,se.jsxs)("div",{className:"flex flex-col justify-start items-start gap-0.5",children:[(0,se.jsx)(aN,{className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:t}),s&&(0,se.jsx)("p",{className:"text-slate-500 text-sm font-normal font-base44 leading-tight",children:s})]}),(0,se.jsx)(SQ,{options:zE,selectedOptions:a,onToggle:n}),l&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-1",children:l})]})},nX=[{value:"new_project",label:"New project",description:"Start from scratch"},{value:"existing_project",label:"Existing project",description:"Update or improve current project"}],lX=[{value:"as_soon_as_possible",label:"ASAP (start right away)"},{value:"within_a_week",label:"Within the next 1\u20132 weeks"},{value:"within_a_month",label:"Within the next month"},{value:"more_than_a_month",label:"Flexible"}],rX=[{value:"less_than_a_week",label:"Less than a week"},{value:"about_1_week",label:"About 1 week"},{value:"about_1_month",label:"About 1 month"},{value:"more_than_1_month",label:"More than 1 month"},{value:"i_dont_know",label:"I don't know"}],iX=UE.Ik({project_type:UE.k5(["new_project","existing_project"],{required_error:"Please select a project type"}),project_description:UE.Yj().min(20,"Please provide at least 20 characters").max(1e3,"Description must be less than 1000 characters"),services:UE.YO(UE.Yj()).min(1,"Please select at least one service"),work_basis:UE.k5(["hourly","fixed_price"],{required_error:"Please select a work basis"}),start_date:UE.KC([UE.k5(["as_soon_as_possible","within_a_week","within_a_month","more_than_a_month"]),UE.eu("")]).refine(e=>""!==e,{message:"Please select a timeline"}),estimated_project_duration:UE.KC([UE.k5(["less_than_a_week","about_1_week","about_1_month","more_than_1_month","i_dont_know"]),UE.eu("")]).refine(e=>""!==e,{message:"Please select estimated project duration"}),client_name:UE.Yj().min(1,"Name is required").max(100,"Name must be less than 100 characters"),client_email:UE.Yj().min(1,"Email is required").email("Please enter a valid email address")}),oX=iX.pick({project_type:!0,project_description:!0,services:!0}),cX=iX.pick({work_basis:!0,start_date:!0,estimated_project_duration:!0}),dX=iX.pick({client_name:!0,client_email:!0}),uX=iX,mX=e=>{const t={};return e.errors.forEach(e=>{const s=e.path.join(".");s&&(t[s]=e.message)}),t},xX=e=>{let{formData:t,errors:s,onInputChange:a,onServiceToggle:n}=e;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsx)(sX,{label:"Project type",options:nX,selectedValue:t.project_type,onValueChange:e=>a("project_type",e),error:s.project_type}),(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-1",children:[(0,se.jsx)(aN,{htmlFor:"project_description",className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Project description"}),(0,se.jsx)(tN,{id:"project_description",placeholder:"Describe your project goals, requirements, and any specific technologies needed\u2026",value:t.project_description,onChange:e=>a("project_description",e.target.value),className:"min-h-[120px] resize-none mt-3 ".concat(s.project_description?"border-red-500":"border-slate-200")}),s.project_description&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:s.project_description}),(0,se.jsxs)("p",{className:"text-sm text-slate-400 mt-1",children:[t.project_description.length," characters (minimum 20)"]})]}),(0,se.jsx)(aX,{label:"What do you need help with?",selectedServices:t.services,onServiceToggle:n,error:s.services})]})},hX=e=>{let{label:t,placeholder:s="",value:a,options:n,onValueChange:l,error:r,helperText:i,required:o=!1,tooltipText:c,className:d=""}=e;const u="w-full h-10 ".concat(r?"border-red-500":"border-slate-200"," ").concat(d);return(0,se.jsxs)("div",{className:"w-full space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center gap-1",children:[(0,se.jsxs)(aN,{className:"text-center justify-center text-gray-700 text-sm font-medium font-base44 leading-tight",children:[t,o&&(0,se.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),c&&(0,se.jsxs)(xp,{delayDuration:100,children:[(0,se.jsx)(hp,{asChild:!0,children:(0,se.jsx)(Oy.A,{className:"h-4 w-4 text-gray-600 hover:text-gray-900"})}),(0,se.jsx)(pp,{className:"max-w-[240px] p-3 text-xs",children:(0,se.jsx)("p",{children:c})})]})]}),(0,se.jsxs)(Wf,{value:a,onValueChange:l,children:[(0,se.jsx)(Yf,{className:"w-full ".concat(u," focus:outline-none focus-visible:outline-none focus:ring-1 focus:ring-black focus:border-black data-[state=open]:ring-1 data-[state=open]:ring-black data-[state=open]:border-black"),style:{color:a?"#000000":"#94a3b8"},children:(0,se.jsx)(qf,{placeholder:s,className:"text-sm font-normal font-base44 leading-tight"})}),(0,se.jsx)($f,{className:"bg-white border border-slate-200 rounded-md shadow-lg",position:"popper",sideOffset:0,children:n.map(e=>(0,se.jsx)(Zf,{value:e.value,hideCheckIcon:!0,className:"w-full p-1.5 rounded-md cursor-pointer inline-flex justify-start items-center gap-2 hover:!bg-slate-50 focus:!bg-slate-50 data-[highlighted]:!bg-slate-50 data-[state=checked]:!bg-slate-700 data-[state=checked]:!text-white data-[state=checked]:hover:!bg-slate-700 data-[state=checked]:data-[highlighted]:!bg-slate-700",children:(0,se.jsx)("div",{className:"flex-1 justify-start text-sm font-normal font-base44 leading-tight ",children:e.label})},e.value))})]}),r&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:r}),i&&!r&&(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:i})]})},pX=e=>{let{formData:t,errors:s,onInputChange:a}=e;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsx)(sX,{label:"Work basis",options:[{value:"hourly",label:"Hourly payment",description:"Pay based on working hours"},{value:"fixed_price",label:"Fixed price",description:"Agree on the total cost upfront"}],selectedValue:t.work_basis,onValueChange:e=>a("work_basis",e),error:s.work_basis}),(0,se.jsx)(hX,{label:"Preferred start time",placeholder:"Select start time",value:t.start_date,options:lX,onValueChange:e=>a("start_date",e),error:s.start_date}),(0,se.jsx)(hX,{label:"Estimated project duration",placeholder:"Select project duration",value:t.estimated_project_duration,options:rX,onValueChange:e=>a("estimated_project_duration",e),error:s.estimated_project_duration})]})},gX=e=>{let{formData:t,errors:s,onInputChange:a}=e;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white flex flex-col justify-start items-start gap-6 overflow-hidden",children:[(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-1",children:[(0,se.jsx)(aN,{htmlFor:"client_name",className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Your Name"}),(0,se.jsx)(Df,{id:"client_name",type:"text",placeholder:"Full name",value:t.client_name,onChange:e=>a("client_name",e.target.value),className:"h-11 mt-3 ".concat(s.client_name?"border-red-500":"border-slate-200")}),s.client_name&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:s.client_name})]}),(0,se.jsxs)("div",{className:"w-full flex flex-col justify-start items-start gap-1",children:[(0,se.jsx)(aN,{htmlFor:"client_email",className:"text-gray-700 text-sm font-medium font-base44 leading-tight",children:"Email Address"}),(0,se.jsx)(Df,{id:"client_email",type:"email",placeholder:"your@email.com",value:t.client_email,onChange:e=>a("client_email",e.target.value),className:"h-11 mt-3 ".concat(s.client_email?"border-red-500":"border-slate-200")}),s.client_email&&(0,se.jsx)("p",{className:"text-sm text-red-500 mt-2",children:s.client_email}),(0,se.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:"This email will be shared with the partner for communication"})]})]})},fX=e=>{let{title:t,items:s,className:a=""}=e;const n=s.filter(e=>!1!==e.show);return(0,se.jsxs)("div",{className:"w-full flex flex-col gap-3 ".concat(a),children:[t&&(0,se.jsx)("div",{className:"w-full justify-center text-gray-700 text-sm font-medium font-base44 leading-tight",children:t}),(0,se.jsx)("div",{className:"w-full p-4 bg-slate-50 rounded-lg border border-slate-300 flex flex-col justify-start items-start gap-3",children:(0,se.jsx)("div",{className:"w-full flex flex-col justify-start items-start gap-[3px]",children:n.map((e,t)=>(0,se.jsxs)("div",{className:"w-full py-[3px] flex flex-col sm:flex-row sm:items-start gap-1 sm:gap-0",children:[(0,se.jsx)("div",{className:"sm:w-44 sm:flex-shrink-0 justify-start text-black text-sm font-normal font-base44 leading-tight",children:e.label}),(0,se.jsx)("div",{className:"flex-1 justify-start text-gray-950 text-sm font-medium font-base44 leading-tight break-words",children:e.value})]},t))})})]})},vX=e=>{let{formData:t,partner:s}=e;const a=[{label:"Partner",value:s.item.name||"Partner"},{label:"Project Type",value:(l=t.project_type,"new_project"===l?"New Project":"Existing Project")},{label:"Work Basis",value:(n=t.work_basis,"hourly"===n?"Hourly Rate":"Fixed Price")},{label:"Preferred start time",value:(e=>{const t=lX.find(t=>t.value===e);return t?t.label:e})(t.start_date)},{label:"Estimated duration",value:(e=>{const t=rX.find(t=>t.value===e);return t?t.label:e})(t.estimated_project_duration)},{label:"Contact",value:t.client_email},{label:"Services",value:t.services.join(", "),show:t.services.length>0},{label:"Description",value:t.project_description}];var n,l;return(0,se.jsxs)("div",{className:"w-full p-6 bg-white inline-flex flex-col justify-start items-start gap-3 overflow-hidden",children:[(0,se.jsxs)("div",{className:"w-full justify-start text-gray-700 text-sm font-normal font-base44 leading-tight",children:["We'll share your request with ",s.item.name||"this partner",". After reviewing your project details, they'll get in touch with you by email."]}),(0,se.jsx)(fX,{title:"Request summary",items:a})]})},bX={project_type:"existing_project",project_description:"",services:[],work_basis:"hourly",start_date:"",estimated_project_duration:"",client_name:"",client_email:""},jX=(e,t)=>{const[s,a]=(0,Y.useState)((0,ue.A)((0,ue.A)({},bX),{},{client_name:e||"",client_email:t||""})),[n,l]=(0,Y.useState)({}),[r,i]=(0,Y.useState)(!1),o=(e,t)=>{a(s=>(0,ue.A)((0,ue.A)({},s),{},{[e]:t})),n[e]&&l(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:null}))},c=()=>{a((0,ue.A)((0,ue.A)({},bX),{},{client_name:e||"",client_email:t||""})),l({}),i(!1)};return{formData:s,errors:n,isSubmitting:r,handleInputChange:o,handleServiceToggle:e=>{const t=s.services.includes(e)?s.services.filter(t=>t!==e):[...s.services,e];o("services",t)},validateStep:e=>{let t;switch(e){case 0:t=(e=>{const t=oX.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:mX(t.error)}})(s);break;case 1:t=(e=>{const t=cX.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:mX(t.error)}})(s);break;case 2:t=(e=>{const t=dX.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:mX(t.error)}})(s);break;default:return!0}return l(t.errors),t.success},resetForm:c,handleSubmit:async e=>{const t=(e=>{const t=uX.safeParse(e);return t.success?{success:!0,errors:{}}:{success:!1,errors:mX(t.error)}})(s);if(!t.success)return l(t.errors),!1;i(!0);try{return await e(s),c(),!0}catch(a){return!1}finally{i(!1)}}}},yX=e=>{let{isOpen:t,onClose:s,partner:a,onSubmit:n}=e;const{user:l}=wd(),[r,i]=(0,Y.useState)(0),{formData:o,errors:c,isSubmitting:d,handleInputChange:u,handleServiceToggle:m,validateStep:x,resetForm:h,handleSubmit:p}=jX(null==l?void 0:l.full_name,null==l?void 0:l.email),g=[{id:1,title:"Project",description:"Tell us about your project"},{id:2,title:"Timeline",description:"Define work basis and timeline"},{id:3,title:"Contact",description:"Your contact information"},{id:4,title:"Review",description:"Review and submit your request"}];if(!t||!a)return null;const f=(0,se.jsx)("div",{className:"w-full px-2.5 py-2 bg-slate-100 border-t border-slate-200 flex justify-center items-center gap-2.5",children:(0,se.jsxs)("div",{className:"text-center flex items-center",children:[(0,se.jsx)("span",{className:"text-gray-600 text-xs font-normal font-base44 leading-tight",children:"Services are delivered by independent Partners. Base44 isn't responsible for them."}),(0,se.jsx)("a",{href:"/partners/terms",target:"_blank",rel:"noopener noreferrer",className:"ml-1 text-gray-600 text-xs font-normal font-base44 underline leading-tight cursor-pointer hover:text-gray-800",children:"Terms of use"})]})});return(0,se.jsx)("div",{"data-testid":"contact-request-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,se.jsx)(OM,{"data-testid":"contact-request-wizard",steps:g,currentStep:r,title:"Contact ".concat(a.item.name||"Partner"),description:"We will share this information with the partner to enable communication.",onNext:()=>{x(r)&&i(e=>Math.min(e+1,g.length-1))},onPrevious:()=>{i(e=>Math.max(e-1,0))},onClose:()=>{d||(h(),i(0),s())},onSubmit:async()=>{await p(n)&&(i(0),s())},isNextDisabled:!1,isLoading:d,nextButtonText:"Next",submitButtonText:"Submit",className:"w-[640px] h-[600px]",banner:f,children:(0,se.jsx)("div",{"data-testid":"contact-request-step-content",children:(()=>{if(!a)return null;switch(r){case 0:return(0,se.jsx)(xX,{formData:o,errors:c,onInputChange:u,onServiceToggle:m});case 1:return(0,se.jsx)(pX,{formData:o,errors:c,onInputChange:u});case 2:return(0,se.jsx)(gX,{formData:o,errors:c,onInputChange:u});case 3:return(0,se.jsx)(vX,{formData:o,partner:a});default:return null}})()})})})};function NX(){const{user:e}=wd(),{partnerId:t}=(0,J.g)(),s=(0,J.Zp)(),[a,n]=(0,Y.useState)([]),[l,r]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)("all"),[u,m]=(0,Y.useState)([]),[x]=(0,Y.useState)("relevance"),[h,p]=(0,Y.useState)(0),[g,f]=(0,Y.useState)(1e5),[v,b]=(0,Y.useState)(!0),[j,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(0),[_]=(0,Y.useState)(12),[k,C]=(0,Y.useState)(0),A=(0,Y.useMemo)(()=>Math.floor(Date.now()/36e5),[]),[S,E]=(0,Y.useState)(!1),[T,I]=(0,Y.useState)(!1),P=(0,Y.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?r(!0):y(!0);const t=e?0:k,s={skip:t,limit:_,sort_by:R(x),status:"approved",seed:A};i.length>0&&(s.services={$in:i}),u.length>0&&(s.languages={$in:u}),(h>0||g<1e5)&&(s.budget_starting_from_dollars={},h>0&&(s.budget_starting_from_dollars.$gte=h),g<1e5&&(s.budget_starting_from_dollars.$lte=g)),Object.keys(s).forEach(e=>{void 0===s[e]&&delete s[e]});const a=await LQ.listCatalogItems(s),l=Array.isArray(a)?a:a.items,o=Array.isArray(a)?l.length:a.total||l.length;e?(n(l),w(o)):n(e=>[...e,...l]),C(t+l.length),b(l.length===_)}catch(t){so({title:"Error",description:"Failed to load partners. Please try again.",variant:"destructive"})}finally{r(!1),y(!1)}},[k,_,i,u,x,h,g,A]);(0,Y.useEffect)(()=>{n([]),C(0),b(!0),P(!0)},[i,u,x,h,g]),(0,Y.useEffect)(()=>{Tu("Page View",{page_name:t?"Partner Detail View":"Partners Catalog",page_url:window.location.pathname,user_id:(null==e?void 0:e.id)||null,app_id:null,conversation_id:null,partner_id:t||null,selected_services:i,selected_languages:u,budget_min:h,budget_max:g,sort_by:x})},[]),(0,Y.useEffect)(()=>{"true"===new URLSearchParams(window.location.search).get("apply")&&(I(!0),window.history.replaceState({},"",window.location.pathname))},[]);const{data:L,resetData:M}=Xd({query:async()=>{var e,s;if((null==L||null===(e=L.item)||void 0===e||null===(s=e.id)||void 0===s?void 0:s.toString())===t)return L;const a=await LQ.getPartnerById(t);return E(!0),{item:a.item}},enabled:!!t,initialData:null,onError:()=>{s("/partners",{replace:!0})},logErrorMsg:"Error fetching partner by ID:",toastError:{title:"Error",description:"Partner not found or unavailable."}},[t]),R=e=>{switch(e){case"budget_low":return"budget_starting_from_dollars_asc";case"budget_high":return"budget_starting_from_dollars_desc";case"hourly_low":return"hourly_rate_asc";case"hourly_high":return"hourly_rate_desc";case"newest":return"created_at_desc";default:return"usage"}},D=(0,Y.useCallback)(()=>{!v||j||l||P(!1)},[v,j,l,P]),{targetRef:F}=mq({onLoadMore:D,hasMore:v,isLoading:j||l}),O=()=>{E(!1),t&&(s("/partners",{replace:!0}),M({data:null,refetch:!1}))};return(0,se.jsxs)("div",{"data-testid":"partners-catalog",className:"min-h-screen bg-white",children:[(0,se.jsx)(qQ,{"data-testid":"catalog-header",totalPartners:N,onBecomePartnerClick:()=>I(!0)}),(0,se.jsx)(ZQ,{"data-testid":"filter-bar",selectedServices:i,onServicesChange:o,budgetRange:c,onBudgetRangeChange:d,selectedLanguages:u,onLanguagesChange:m,onBudgetApply:(e,t)=>{p(e),f(t)},onServicesApply:e=>{o(e)},onLanguagesApply:e=>{m(e)},currentBudgetMin:h,currentBudgetMax:g}),(0,se.jsxs)("div",{"data-testid":"partners-catalog-content",className:"max-w-7xl mx-auto px-6 lg:px-8 py-12",children:[(0,se.jsx)(tX,{"data-testid":"partners-grid",isLoading:l,isLoadingMore:j,partners:a,onContactClick:e=>{s("/partners/".concat(e.item.id),{replace:!1}),M({data:e,refetch:!1}),E(!0)},onBecomePartnerClick:()=>I(!0),hasMore:v,targetRef:F}),(0,se.jsx)(yX,{isOpen:S,onClose:O,partner:L,onSubmit:async e=>{try{await LQ.contactRequest((0,ue.A)((0,ue.A)({},e),{},{partner_profile_id:null==L?void 0:L.item.id})),so({title:"Success",description:"Your contact request has been sent successfully!"}),O()}catch(a){var t,s;null!==(t=a.response)&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.detail?so({title:"Error",description:a.response.data.detail,variant:"destructive"}):(alert(a.message),so({title:"Error",description:"Failed to send contact request. Please try again.",variant:"destructive"}))}}}),(0,se.jsx)(DQ,{isOpen:T,onClose:()=>I(!1)})]})]})}function wX(){return(0,se.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:(0,se.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-12",children:(0,se.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 px-8 py-6",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Base44 Partners Terms of Use"}),(0,se.jsx)("p",{className:"text-orange-100 mt-2",children:"Last updated: September 11, 2025"})]}),(0,se.jsx)("div",{className:"px-8 py-8",children:(0,se.jsxs)("div",{className:"prose prose-slate max-w-none prose-headings:text-slate-800 prose-headings:font-semibold prose-p:text-slate-700 prose-p:leading-relaxed prose-strong:text-slate-900",children:[(0,se.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n                                    .partners-terms a {\n                                        color: #2563eb !important;\n                                        text-decoration: underline !important;\n                                    }\n                                    .partners-terms a:hover {\n                                        color: #1d4ed8 !important;\n                                    }\n                                "}}),(0,se.jsx)("div",{className:"partners-terms",children:(0,se.jsx)(ZW,{children:'\n\nWelcome to the Base44 Partners: A venue in which Base44 users can review the work of freelance web professionals and agencies, and request to acquire custom services (the "Services").\n\nThese terms and conditions (the "Partners Terms") are a binding agreement between you and Base44 Inc. ("Base44"). These Base44 Partners Terms govern your use of this Platform, including all content and services available through the [Base44.com/partners](https://base44.com/partners) (the "Base44 Partners"). \n\nBY USING AND/OR VISITING THIS WEBSITE, you hereby consent to these terms and conditions, AND TO the general Terms of Use of Base44, as may be amended from time to time, which can be reviewed at [https://base44.com/terms-of-service](https://base44.com/terms-of-service) ; (the "Base44 Terms") You further acknowledge that you have read the terms and conditions of Base44\'s privacy policy, which are published at [https://base44.com/privacy-policy](https://base44.com/privacy-policy), as may be amended from time to time, (the "Privacy Policy").  \n\nThe Base44 Terms and the Privacy Policy are incorporated herein by reference and govern your use of the Base44 Partners. \n\nBY JOINING THE BASE44 PARTNERS, YOU ACKNOWLEDGE THAT YOU HAVE READ THE BASE44 PARTNERS TERMS AND FURTHER UNDERSTAND AND AGREE TO BE BOUND BY SUCH TERMS, INCLUDING ANY FUTURE MODIFICATIONS THERETO. WE MAY REVISE THESE TERMS AT ANY TIME BY POSTING AN UPDATED VERSION ON OUR WEBSITE. YOU ARE ENCOURAGED TO REVIEW THIS AGREEMENT FROM TIME-TO-TIME BECAUSE YOU ARE BOUND BY THESE TERMS. YOUR CONTINUED USE OF THE BASE44 PARTNERS AFTER A CHANGE TO THESE TERMS CONSTITUTES YOUR BINDING ACCEPTANCE OF THESE TERMS. IF, AT ANY TIME, YOU DO NOT AGREE TO ANY OF THE TERMS OF THIS AGREEMENT IN EFFECT AT SUCH TIME, PLEASE DO NOT USE THE BASE44 PARTNERS. NOTWITHSTANDING THE FORGOING, BASE44 SHALL HAVE THE RIGHT TO TERMINATE YOUR ACCOUNT AS A BASE44 PARTNER (AS DEFINED BELOW) AND REMOVE YOU FROM THE PARTNERS AT ANY TIME FOLLOWING SUCH NOTICE.\n\n## 1. General Description\n\nThe Base44 Partners (i) allows any eligible web professionals, freelancers, agencies, and other businesses (either individuals or entities) with a valid user account (the "Base44 Partner(s)") to create a profile dedicated to their work (the "Profile") allows visitors to review the Base44 Partners\' Profiles and allows Base44 users with a valid User Account (the "Base44 Member(s)") to find Base44 Partners that may suit their needs to provide with Services; and (iii) facilitates the initial communication between a Base44 Member and the chosen Base44 Partner so they can connect directly regarding the Services needs of the Base44 Member (Base44 Partners and Base44 Members, together, "Users", and individually: "User" or "you" ).\n\nWithin the Base44 Partners, Base44 Members may request and obtain Services for both free websites on the Base44 platform and websites under any Base44 Premium Plan. The Services are not provided free of charge. Any Custom Services acquired beyond the Marketplace Templates shall be separately and freely negotiated between Base44 Partner and Base44 Members.\n\nBase44 itself does not offer or provide any such tailored website services under the Base44 Partners and has no responsibility or liability for any Services provided by the Base44 Partners.\n\nThe Base44 Partners is not an employment or matching agency, and except as specifically stated herein, the Base44 Partners does not engage as a referral, matching or placement service and does not provide, refer, place, offer or seek to obtain employment or engagements for any of its Users.\n\n## 2. Additional Terms Applicable to Base44 Partners\n\nThe Base44 Partner Program, as currently offered by Base44 at [add URL]. Base44 Partners may sell their Services on the Base44 Partners and present their services in their dedicated Profile. Once Base44 Partners access is granted, the Base44 Partner will have the opportunity to create its Profile, and Base44 Members shall be able to view such Profile after the Base44 Partner completes as indicated.\n\nBase44 reserves the right to make changes from time to time to the Partner Program, including, but not limited to, including, without limitation, accessibility and use of the Base44 Partners, as set forth in the Base44 Partner Terms.\n\nBase44 shall have sole and absolute discretion regarding the eligibility of any Base44 Partner to access and use the Base44 Partners, and does not guarantee that any Base44 Partner will be presented on the Base44 Partners [catalog] for any minimum period of time or at all. Base44 reserves the right to remove any Base44 Partner from the Base44 Partners [catalog] or may require a Base44 Partner to remove any its Profile or User Content included in its Profile, at Base44\'s discretion. Base44 shall not be obligated to provide any explanations regarding its decisions in this respect.\n\n## 3. License \n\nBy creating, posting or sharing any information through the Service, you grant Base44 a world-wide, non-exclusive, sublicensable, royalty-free, fully paid, perpetual, transferable license and unrestricted right, on or through the Base44 Website or Base44 Partners [catalog] to use, modify, remove, publish, transmit, sublicense or display such information or User Content in any now existing or hereinafter medium developed in order to operate Base44\'s business, and to provide Services, including, without limitation, to advertise and promote the Service, the catalog, your Profile. You waive any claims against Base44 or anyone on its behalf relating to any past, present or future moral rights, artists\' rights, or any other similar rights worldwide that you may have with respect to such permitted uses.\n\n**Intellectual Property Rights.** Base44 does not acquire any ownership interest in your Profile, or other User Content under these Partners Terms. Base44 Partner and its licensors (as applicable) shall retain their right, title and interest in the Marks and other User Content. In the event of any third party claim that a Base44 Member\'s possession or use of a service infringes on a third party\'s intellectual property rights, you, not Base44, will be solely responsible for the investigation, defense, settlement and discharge of any such intellectual property infringement claim.\n\n## 4. Base44 Partner Representations and Warranties.\n\nBy using the Base Partners you confirm, undertake, acknowledge, represent and warrant that:\n\nYou are at least 18 years of age or the legal age of majority. To the extent Base44 Partner is an entity, such Base44 Partner further represents and warrants it is duly organized and validly existing under the laws of its jurisdiction and has the requisite power and authority to enter into this agreement and to perform its obligations hereunder;  \n\nYou will at all times provide true, accurate, current, and complete information when submitting any registration form(s) or otherwise providing any information to Base44 through the Partners [catalog]. You are solely responsible for editing and updating such information on your Profile. You shall keep any User Content in your Profile up-to-date with no broken links or misinformation. You are responsible for removing from your Profile, any User Content you are not authorized to use anymore. \n\nYou own or otherwise have the full right and authority to present and publish the User Content or other content presented in your Profile, and your Portfolio (including, without limitation, links and third party websites). You must not submit, upload, post, display or share any User Content or other content that you do not have the right to copy, use, link to or share for the purpose of your use of the Base44 Partners. The posting and use of User Content or other content on or through the Service does not violate the privacy rights, publicity rights, copyrights, contract rights, intellectual property rights, or any other rights of any person. You shall be solely liable for any damages resulting from any infringement of copyrights, trademarks or other intellectual property rights, or any other harm resulting from your uploading, posting or publishing User Content or other content in your Templates or to the Base44 Partners. You should have all rights required to present your Profile. You acknowledge and agree that all information presented in your Profile is non-confidential.\n\nYou may not advertise and/or address non-Base44 apps and/or platforms in your Profile. The websites presented in your Profile should accurately reflect your abilities and the services you are being hired to perform and/or the Templates you are offering for sale. Any content presented in your profile will be free of viruses, Trojan horses, worms, spyware, disabling, or other such malicious code.\n\nYou agree that your use of the Service will not violate any applicable laws.\n\nYou agree that your use of the Service will not include sending unsolicited marketing messages or broadcasts (i.e. spam). Base44 may block anyone violating this provision from using the Service.\n\nYou shall abide by fair business practices and ethics in any dealings with any Base44 Member.\n\nNone of the Base44 Partner, its subsidiaries, or any director or officer thereof, is, or is owned or controlled by individuals or entities that are: (i) the target of any sanctions administered or enforced by the U.S. Department of the Treasury Office of Foreign Asset Control ("OFAC"), the U.S. State Department or any other U.S. government agency or department, the United Nations Security Council, the European Union or Her Majesty Treasury and/or the target of any Israeli sanctions (collectively, "Sanctions"), or (ii) located, organized or resident in a country or territory that is the subject of comprehensive territorial Sanctions.\n\n## 5. Use of the Service by the Partner.\n\nYou confirm and acknowledge that some Personal Information and other Information (as those terms are defined in Base44\'s Privacy Policy) you provide Base44 may become public and accessible to Base44 Members and other Base44 website visitors reviewing your Profile on the Base44 Partners [catalog].\n\nThe order of presentation of the Base44 Partners\' Profiles on the Base44 Partners is subject to Base44\'s sole and absolute discretion. Ranking is determined by parameters decided by Base44. Parameters that may influence your ranking include, without limitation, the nature of the Feedback we may receive from Base44 Members who have used your Services.\n\n**Accuracy of Information.** Any information communicated to you about a Base44 Member via the Base44 Partners [catalog] shall be conveyed in conformity with the information provided to Base44 by such Base44 Member. Base44 is not responsible for the truthfulness and validity of information provided by any Base44 Member. Base44 is not responsible for information provided by third parties. You are solely responsible for the management of Base44 Members\' information in your Base44 Partner [catalog], whether such information is added and/or uploaded by you, or by Base44 on your behalf, in accordance with applicable law.\n\n**Profile.** Each Base44 Partner may have only one Profile presented on the Base44 Partners. You may not have more than one profile in the Base44 Partners.\n\n**Account Protection.** Only you may use your account and authentication credentials (e.g., keys, tokens, password) associated with your Profile, and you are fully responsible for safeguarding such information from compromise and for using them only as authorized by Base44 and in accordance with these terms.\n\n**Guidelines.** Base44 has the right to determine instructions and guidelines in connection with the use of the Base44 Partners, including regarding any languages to be used in the Profiles. \n\n**Removal.** Base44 reserves the right to remove any Base44 Partner from the Base44 Partners without notice, for any reason.\n\n## 6. Submission, Approval and Withdrawal.\n\nYou must submit each Profile that you wish to offer to Base44 Members and or Users, as well as any material updates to such Profile, for Base44\'s prior approval. Any such updates shall be subject to the terms and conditions set forth in this Agreement.  \n\n**Minimum Requirements.** The Profile must comply with all terms and conditions set forth in this Agreement; the Profile must not infringe or misappropriate any intellectual property or personal right of any third party and, the Profile must comply with any other requirements provided to you by Base44.\n\n**Approval.** Prior to making any Profile available, Base44, or a third party on its behalf, will review and evaluate each Profile (including any updates or changes if Base44 deems it necessary) submitted by Base44 Partner. Base44 Partner agrees to cooperate with Base44 in the reviewing, testing and evaluation process and to answer questions and provide information and materials reasonably requested by Base44. Base44 may require Base44 Partner to make adjustments and/or modifications to its Profile, as necessary to ensure the compliance with this Agreement. Base44 Partner shall make such required adjustments within a reasonable period of time as determined by Base44. It is clarified that Base44 shall have no obligation to include any Profile in the [Catalog] even if such Profile was previously approved by Base44.\n\n**Removal.** Base44 may remove or suspend any Profile from the [catalog] at any time, at its sole discretion with no obligation to provide any explanation or prior notice and with no liability to Base44 Partner. Base44 Partners may remove their own Profiles at any time.\n\n**Responding to Claims.** You, as a Base44 Partner, understand and agree that you are solely responsible for providing relevant support and assistance to a Base44 Member in relation to the purchase and use of the Services. If Base44 receives a claim from a third party concerning a Service, Base44 may refer such claim to you. You must respond to the claim promptly, and take any and all actions required for the Service to comply with the law when applicable. If you discover or are notified that a Service violates these Terms, you shall immediately take the required actions to correct such violation. You must state in your Profile your name, address and all the required contact information to which any Base44 Member questions, complaints or claims with respect to the Services you provide should be directed.\n\n**Warranty.** You are solely responsible for any warranties, whether expressed or implied by law, to the extent not effectively disclaimed, for any services you provide. Base44 will have no warranty obligation whatsoever with respect to the services you provide.\n\n## 7. Pricing\n\n**Pricing.** Base44 Partners are required to publish and present their starting rates for each Service they support in their Profiles and to clearly define and present the prices. Prices should be charged in U.S. Dollars.\n\n**Taxes.** Base44 Partner shall be responsible for the payment of any and all taxes assessments, fees and other governmental charges of any kind, as well as withholding and reporting obligations applicable to the conduct of Base44 Partner\'s business. \n\n## 8. Economic Sanctions and Exports Controls\n\nBase44 Partner acknowledges that any use of its services may not be provided to or used by any person in any of the countries that are subject to comprehensive economic sanctions under the EAR, OFAC, or Israeli regulations, which currently include Crimea - region of Ukraine, Cuba, Iran, North Korea, and Syria. Moreover, Base44 Partner shall not allow and fully restrict any usage relating to its Services from Members (individuals and entities) identified on any Sanctions list, including but not limited to OFAC\'s Specially Designated Nationals and Blocked Parties List (the "SDN List"), entities owned 50% or more by any individuals or entities on the SDN List, or individuals or entities that are located in any comprehensively sanctioned country.\n\nBase44 Partner shall (i) be solely responsible to check the applicable Export Controls regulations and any updates or modifications thereof; (ii) be solely responsible to strictly comply with Export Controls at all times during which this Agreement is in force; and (iii) be liable for any infractions or imposed sanctions thereunder.\n\n## 9. User Data Terms\n\nWithout limiting Base44 Partners\' other representations, warranties and obligations under these Partners Terms, to the extent Base44 Partner performs any form of processing activity with respect to or in connection with any personal data of Base44 Members, Base44 Users ("User Data"), then Base44 Partner, Base44 Partner\'s Services, must comply with all applicable privacy and data protection laws, including (but not limited to) the General Data Protection Legislation ((EU) 2016/679) (GDPR) and any applicable national implementing laws, regulations and secondary legislation relating to the Processing of Personal Data (collectively, "Data Privacy Laws"), including, without limitation, any and all consent or notice requirements. \n\n**Definitions:** (i) "GDPR" means the Regulation (EU) 2016/679 of the European Parliament and of the Council of 27 April 2016 on the protection of natural persons with regard to the processing of personal data and on the free movement of such data, and repealing Directive 95/46/EC (General Data Protection Regulation).\n\nBase44 Partner shall limit its Base44 Member Data Processing activities only to the extent required to operate the Base44 Partner\'s Services to the Base44 Members. Base44 Partner is prohibited from Processing, either directly or through a processor, any Base44 Member Data provided to Base44 Partner by Base44 for the purposes of marketing, advertising, sales, personalization, except at the instruction of the Base44 Member and in compliance with applicable Data Privacy Laws.\n\nBase44 Partner further acknowledges and agrees that Base44 is not and shall not be deemed a Controller of any processing activity concerning Personal Data of Base44 Users that is conducted by Base44 Partner outside the Base44 platform, whether through your business or personal email or otherwise.\n\n## 10. Additional Terms Applicable to Base44 Members\n\n**Overview.** As a Base44 Member participating in the Base44 Partners, you agree and acknowledge that: \n\na) Base44 is not the employer of any Base44 Partner, nor does Base44 supervise, direct or control the Base44 Partners\' work or Services, in any manner. Base44 does not provide any training to the Base44 Partners, and has no control over the quality, timing, legality, failure to provide, or any other aspect whatsoever of the Services.\n \nb) Each Base44 Partner provides you services as an independent contractor and is not an employee, joint venturer, partner, agent, or franchisee of Base44 for any purpose whatsoever.\n\nc) Base44 is not responsible for the truthfulness and validity of information presented by any Base44 Partner. Base44 does not have any obligation to independently verify any information provided to it by any Base44 Partner, their experience or training, and shall not be responsible or liable for any representation or undertaking made by any Base44 Partner.\n\nd) You are at least 18 years of age or the legal age of majority;\n\ne) You are not located in a region that is subject to a U.S. government embargo or included on any list of prohibited or restricted parties. Any breach of the foregoing representations and warranties entitles Base44 to immediately terminate the Base44 Terms and/or seek any and all remedies available at law or equity.\n\n**No Endorsement.** In no event shall any reference by Base44 to any Base44 Partner or offered by a third party be construed as an approval or endorsement by Base44 of such Base44 Partner and any Services provided by them. You are responsible for exercising appropriate judgment and caution and Base44 does not enforce or accept any responsibility for the content or use of such Services.\n\n**Relationship.** Any relationship between any Base44 Member and a Base44 Partner listed on the Marketplace will be according to the terms to be agreed upon between such Base44 Member and the specific Base44 Partner they decide to work with. Base44 does not take responsibility, in any way or manner, for the quality of the Services provided to any Base44 Member by any of the Base44 Partners.\n\n**Responsibility.** You accept sole responsibility for all of your activities using the Base44 Partners, including your conduct on the site and any and all content you may submit or present via the Base44 Partners [catalog].\n\n## 11. Information and Communication\n\n**Information Management.** By providing the information required to participate in the Base44 Partners (including without limitation your email address and phone number), you confirm and acknowledge that Base44 may transfer such information, as well as other required Personal Information in your account, to the Base44 Partner(s) you have chosen, and that both Base44 and the Base44 Partner(s) may, to the extent permitted by applicable law, use both your Personal Information and Non Personal Information, in order to facilitate and provide your requested Services. You acknowledge that Base44 Partners are solely responsible for the management of information, including Base44 Members\' Personal Information.\n\n**Communication.** You agree to receive from time to time messages and promotional materials from Base44 by e-mail or any other contact form you may provide us with (including your phone number for calls or text messages), including, without limitation, messages featuring Profiles of various Base44 Partners. If you do not wish to receive such promotional materials or notices, please notify us at any time.\n\n## 12. Termination\n\n**Term and Termination.** Base44 shall have the right to terminate this agreement from any reason. If you are a Base44 Partner, termination will result in the deactivation of your account from the Partners Catalog. \n\n**Disclaimer.** BASE44 IS NOT AFFILIATED WITH OR RESPONSIBLE FOR THE FUNCTIONALITY OR PERFORMANCE OF ANY SERVICES OFFERED BY A BASE44 PARTNER. ALL BASE44 PARTNERS ARE INDEPENDENT PARTIES FROM BASE44. BASE44 HAS NO CONTROL OVER AND SHALL THEREFORE ASSUME NO RESPONSIBILITY FOR ANY TEMPLATE AND ITS CONTENT, FUNCTIONALITY, PRIVACY POLICY OR TERMS OF USE (AND THE PRESENCE, DISPLAY, TERMS, CONDITIONS, OR POLICIES OF SUCH PRIVACY POLICY OR TERMS OF USE), AND AVAILABLE OR RELATED PRODUCTS OR SERVICES.\n\n## 13. Third-Party Disputes\n\nBase44 Members and Base44 Partners must resolve any issues, disputes or concerns directly with each other. Any commercial interaction with any party or person other than Base44 or purchase of Services from such party is done at your own risk. If you have a dispute with a Base44 Partner including, without limitation, regarding their support, services, performance, and/or conduct you will need to handle it through the means they provide. Base44 will not mediate any Base44 Partner -to-Base44 Members disputes.\n\n## 14. Warranty Disclaimer & Limitation of Liability\n\nThe following disclaimers and limitations of liability are supplemental to the disclaimers and limitations of liability under the Base44 Terms:\n\nYOU AGREE THAT YOUR USE OF THE BASE44 PARTNERS [CATALOG], EITHER AS A BASE44 PARTNER OR AS A BASE44 MEMBER, SHALL BE AT YOUR SOLE RISK. TO THE FULLEST EXTENT PERMITTED BY LAW, BASE44, ITS OFFICERS, DIRECTORS, EMPLOYEES, AND AGENTS (COLLECTIVELY: "BASE44 REPRESENTATIVES") DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, AND ASSUME NO RESPONSIBILITY IN CONNECTION WITH (A) THE SERVICES OFFERED BY THE BASE44 PARTNERS ON THE BASE44 PARTNERS [CATALOG] AND THE USE THEREOF BY ANY USER; (B) ANY BASE44 PARTNER\'S REGISTRATION, OR PROFESSIONAL ACCREDITATION; (C) THE RESULTS THAT MAY BE OBTAINED FROM THE USE OF THE BASE44 PARTNERS [CATALOG]; (D) THE TIMELINESS, ACCURACY, RELIABILITY, QUALITY, SUITABILITY, SAFETY, COMPLETENESS OR CONTENT OF THE SERVICES, OR ANY PRODUCTS, MERCHANDISE, CONTENT, INFORMATION OR MATERIALS PROVIDED THROUGH OR IN CONNECTION WITH THE USE OF THE BASE44 PARTNERS [CATALOG]; AND (E) THE SUITABILITY, LEGALITY OR ABILITY OF ANY BASE44 PARTNER TO PROVIDE SERVICES.\n\nNEITHER BASE44 NOR BASE44 REPRESENTATIVES ARE RESPONSIBLE FOR THE CONDUCT, WHETHER ONLINE OR OFFLINE, OF ANY USER OF THE BASE44 PARTNERS (INCLUDING BUT NOT LIMITED TO THE CONDUCT OF ANY BASE44 MEMBER OR BASE44 PARTNERS).\n\nIN ADDITION TO THE LIMITATIONS OF LIABILITY AS STIPULATED IN THE BASE44 TERMS, IN NO EVENT SHALL BASE44 OR ANY BASE44 REPRESENTATIVES BE LIABLE TO YOU FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, PUNITIVE, OR CONSEQUENTIAL DAMAGES WHATSOEVER RESULTING FROM (I) THE USE OR THE INABILITY TO USE THE SERVICE; (II) UNAUTHORIZED ACCESS TO OR ALTERATION OF YOUR ACCOUNT; (III) YOUR RELIANCE ON USER CONTENT, INCLUDING THE TEMPLATES; (IV) ANY COMMUNICATION BETWEEN ANY BASE44 MEMBER AND ANY BASE44 PARTNER LISTED ON THE BASE44 MARKETPLACE AND (V) ANY OTHER MATTER RELATING TO THE SERVICE. SOME JURISDICTIONS DO NOT PERMIT THE EXCLUSION OF CERTAIN LIABILITIES. ACCORDINGLY, CERTAIN LIMITATIONS DESCRIBED HEREIN MAY NOT APPLY TO YOU. \n\nYOU EXPRESSLY WAIVE AND RELEASE BASE44 AND BASE44 REPRESENTATIVES FROM ANY AND ALL LIABILITY, CLAIMS OR DAMAGES ARISING FROM OR IN ANY WAY RELATED TO THE SERVICES (ACTUAL, DIRECT OR CONSEQUENTIAL) OF EVERY KIND AND NATURE, KNOWN AND UNKNOWN, SUSPECTED AND UNSUSPECTED, DISCLOSED AND UNDISCLOSED, ARISING OUT OF OR IN ANY WAY CONNECTED WITH SUCH DISPUTE. AS WITH THE PURCHASE OF A PRODUCT OR SERVICE THROUGH ANY MEDIUM OR IN ANY ENVIRONMENT, USERS SHOULD USE THEIR BEST JUDGMENT AND EXERCISE CAUTION WHERE APPROPRIATE. YOUR USE OF THE BASE44 PARTNERS AND THE SERVICES IS AT YOUR OWN RISK. THE FOREGOING LIMITATIONS OF LIABILITY SHALL APPLY TO THE FULLEST EXTENT PERMITTED BY LAW IN THE APPLICABLE JURISDICTION. \n\nNOTHING IN BASE44 PARTNERS TERMS AND CONDITIONS OR THE BASE44 PARTNERS CONSTITUTES, OR IS MEANT TO CONSTITUTE, ADVICE OF ANY KIND. \n\n## 15. Indemnification\n\nAs a Base44 User, in addition to your obligation of indemnification under the Base44 Terms, you agree to defend, indemnify and hold harmless Base44, its officers, directors, shareholders, employees, affiliates and agents, from and against any and all claims, damages, obligations, losses, liabilities, costs, debt and expenses (including attorneys\' fees) arising from the following, as applicable:\n\nFor each Base44 Partner and Base44 Member (1) your violation of any third party right, including any copyright, property, or privacy right, resulting from your Profile or User Content, or your usage of the Services; and/or (2) your use of the Base44 Partners and/or the Services including in connection with any transactions and interactions resulting from the usages thereof. \n\n## 16. Feedback\n\nBase44 enables both Base44 Partners and Base44 Members to provide feedback regarding the Base44 Partners [_], the Services rendered ("Feedback"). Such Feedback may be viewed by other Base44 Users. Base44 has sole and complete discretion to remove any Feedback, including Feedback which may be deemed as defamatory, libelous, obscene, harassing, threatening, incendiary, abusive, racist, offensive, deceptive or fraudulent, encouraging criminal or harmful conduct, or which otherwise violates the rights of Base44 or any third party (including any intellectual property rights, privacy rights, contractual or fiduciary rights), or otherwise shows any person, entity or brand in a bad or disparaging light, without their prior explicit approval.\n'})})]})}),(0,se.jsx)("div",{className:"bg-slate-50 px-8 py-6 border-t border-slate-200",children:(0,se.jsx)("p",{className:"text-sm text-slate-600 text-center",children:"For questions about these terms, please contact us at partners@base44.com."})})]})})})}function _X(){return(0,se.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:(0,se.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-12",children:(0,se.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden",children:[(0,se.jsxs)("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 px-8 py-6",children:[(0,se.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Base44 App Templates Marketplace - Terms of Service"}),(0,se.jsx)("p",{className:"text-orange-100 mt-2",children:"Last updated: November 18, 2025"})]}),(0,se.jsx)("div",{className:"px-8 py-8",children:(0,se.jsxs)("div",{className:"prose prose-slate max-w-none prose-headings:text-slate-800 prose-headings:font-semibold prose-p:text-slate-700 prose-p:leading-relaxed prose-strong:text-slate-900",children:[(0,se.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n                                    .marketplace-terms a {\n                                        color: #2563eb !important;\n                                        text-decoration: underline !important;\n                                    }\n                                    .marketplace-terms a:hover {\n                                        color: #1d4ed8 !important;\n                                    }\n                                "}}),(0,se.jsx)("div",{className:"marketplace-terms",children:(0,se.jsx)(ZW,{children:'\n\nThese Base44 App Templates Marketplace Terms of Service (the "App Templates Terms") are a binding agreement between you and Wix.com Ltd. (including its subsidiaries and affiliates), which operates the Base44-branded services (collectively, "Base44", "we," or "us").\n\nBy accessing or using the App Templates Marketplace, you acknowledge that you have read, understood and agree to be bound by:\n\n- the general Terms of Service of Base44.com, as may be amended from time to time, which can be reviewed at https://base44.com/terms-of-service ("Base44 Terms")\n\nYou further acknowledge that you have read the terms and conditions of Base44\'s privacy policy, which are published at https://base44.com/privacy-policy, as may be amended from time to time, ("Privacy Policy").\n\nThe Base44 Terms and the Privacy Policy are incorporated herein by reference, and shall govern your use of the Base44 App Templates Marketplace in addition to these Terms. For the avoidance of doubt, the Base44 App Templates Marketplace is part of the Base44 Services. In the event of any conflict or inconsistency between these Terms and the Base44 Terms or the Privacy Policy, these Terms shall prevail with respect to the App Templates Marketplace.\n\nCapitalized terms used in these Terms but not defined herein shall have the respective meanings ascribed to them in the Base44 Terms and Privacy Policy.\n\n**WE MAY REVISE THESE APP TEMPLATES TERMS AT ANY TIME BY POSTING AN UPDATED VERSION.** Changes may include, without limitation, revenue\u2011share percentages, service fees, pricing, tax handling, payment processor terms, payout methods, minimum payout thresholds, currencies, withholdings and reserves, listing standards, ranking signals, security and compliance requirements, review policies, and enforcement mechanisms (collectively, "Program Changes"). Unless we state otherwise in our notice, Program Changes apply on and after the effective date of your Creator account, your existing listings, and future transactions involving those listings. Service fees, reserves, withholdings, offsets, payment processor requirements, and payout schedules may apply to amounts not yet paid out as of the effective date and to future transactions for existing listings. End\u2011user entitlements: Program Changes do not reduce features or access that an end user has already paid for under a prior license grant; however, operational, billing, support, compliance, security, or technical requirements may be updated and will apply to ongoing use. We may use third\u2011party payment processors, and your payouts are subject to their terms, limits, verification/KYC requirements, and availability. You are responsible for all taxes, and we may withhold or collect taxes where required by law. We may offset any amounts you owe us (including fees, refunds, chargebacks, adjustments, or tax withholdings) against any payouts due to you and we may establish, adjust, or release commercially reasonable reserves (e.g., up to 90 days, or longer if permitted by law or required by processors) to cover potential liabilities for past or future transactions.\n\nWe may modify, suspend, or discontinue the Marketplace or any feature, category, integration, or API, and may reclassify, delist, or require updates to your listings.\n\nWe may suspend or terminate your access, listings, or account at any time, with or without notice, including for suspected fraud, abuse, violations of these Terms, or non\u2011compliance with payment processor requirements or where your listings or templates present a security or integrity risk, including any attempt to install or distribute malware, spyware, or other malicious code, run unauthorized background services, mine cryptocurrency, or otherwise misuse user or platform resources. Upon suspension or termination, we may: (a) disable or remove your listings; (b) calculate your final net balance; (c) withhold a commercially reasonable reserve (e.g., up to 90 days) to cover potential refunds, chargebacks, or other liabilities; (d) pay out any undisputed net amounts due in accordance with the then\u2011current payout schedule, subject to offsets, holds, and legal withholdings; and/or (e) recoup any negative balances from your on\u2011file payment method or future earnings. Your continued use of the App Templates Marketplace following any changes constitutes acceptance. If you do not agree, do not use the App Templates Marketplace.\n\nBase44 shall have the right to terminate your account as a Base44 Creator (as defined below) or a Base44 Member and remove you from the App Templates Marketplace at any time, without notice.\n\n## 1. Overview of the Base44 App Templates Marketplace\n\n### 1.1 Definitions\n\n**"Marketplace"** means the Base44 App Templates Marketplace.\n\n**"Listing"** means a Template\'s Marketplace page content (title, description, pricing, media, and support details).\n\n**"Template License"** means the limited license granted to a Member to install/use one Template.\n\n**"Duplicated App" / "Duplicating"** means creating a new app instance by duplicating from another app (whether via Base44 functionality or other means).\n\n**"Base44 Billing System"** means Base44\'s integrated payments infrastructure (and approved third\u2011party processors).\n\n**"Billing Action"** means any transaction processed by or through the Base44 Billing System, including purchases, refunds, chargebacks, holds, offsets, and reserves.\n\n**"Member Modifications"** means any configurations, custom code, scripts, schemas, components, connectors, assets, content, data models, or other changes created by or for a Member in connection with installing, using, or customizing a Template in an app instance.\n\n**"Member Derivative Works"** means any derivative works based on a Template that are created by or for a Member within the Member\'s environment, excluding the unmodified Template and Creator assets (e.g., Creator\'s marks, media, and proprietary libraries).\n\n**"Member Data"** means any data, content, or materials input, uploaded, generated, or otherwise supplied by or for a Member (including by end users) in connection with use of the Template or the Marketplace.\n\n### 1.2 The Base44 App Templates Marketplace is a marketplace that:\n\n- Enables Base44 Creators (as defined below) to list, market and license app templates designed to operate in connection with the Base44 platform ("App Templates" or "Templates");\n- Enables Base44 Members (as defined below) to discover Creators, review their profiles, and purchase single\u2011use licenses to App Templates.\n\nBase44 itself does not offer or provide any services under the App Template Marketplace. Base44 is authorized by Creators to grant and sell licenses to App Templates. Creators remain solely responsible for their Templates.\n\n### 1.3 Roles\n\n**"Base44 Creator"** or **"Creator"** is any person or entity with a premium valid Base44 User Account that lists App Templates in the App Templates Marketplace.\n\n**"Base44 Member"** or **"Member"** is any user with a valid Base44 User Account who browses, licenses Templates.\n\nCreators and Members are each a "User" and collectively "Users."\n\n### 1.4 Nature of services\n\nBase44 is not an employment, matching, or referral agency. Except as expressly stated, the App Templates Marketplace does not provide, place, or seek employment/engagements for Users.\n\nBase44 (or its payment providers) is authorized by Creators to grant and sell end\u2011user licenses to App Templates. Creators remain solely responsible for their Templates. Base44 is not liable for Creator Templates.\n\n## 2. Eligibility\n\nYou must be at least 18 (or the age of majority in your jurisdiction) and have the authority to enter into these Terms. If you act on behalf of an entity, you represent that you are duly authorized to bind that entity.\n\nYou are responsible for your account, credentials, and all activity under it. Do not share your credentials. Notify Base44 promptly of any unauthorized access.\n\nYou agree not to:\n\n- Violate any law, regulation, sanctions or export control regimes;\n- Infringe any third\u2011party rights (IP, privacy, publicity, contract);\n- Introduce malware, spyware, or other malicious code;\n- Engage in spamming, scraping, or abusive behavior;\n- Circumvent security or technical protections;\n\n## 3. Participation\n\nSelling Templates requires a paid plan, you must maintain an active eligible Base44 subscription (as specified by Base44 from time to time) in order to list, sell, or receive payouts for Templates.\n\nAccess to list App Templates is subject to Base44 eligibility criteria, guidelines, and continued compliance. We may approve, reject, remove, or require edits to any Template or profile at our sole discretion and without obligation to explain. One profile per Creator. Public profile information may be visible through the Platform.\n\n## 4. Licenses and rights\n\n### 4.1 Your license to Base44\n\nBy creating, posting or sharing any information or Templates, through the Service, you grant Base44 a worldwide, non\u2011exclusive, sublicensable, royalty\u2011free, fully\u2011paid, perpetual, transferable license to use, host, reproduce, modify, distribute, publicly perform/display, and otherwise exploit your App Templates, listing materials, profile content, marks and logos to operate, market, review, test, list, license and support the App Templates Marketplace and related Base44 services. This includes, without limitation, the right to sell non-sublicensable licenses of Marketplace Templates to Base44 Members, facilitate communications with Base44 Members and advertise and promote the Service, the Marketplace, your Profile, Portfolio and Templates. You waive any claims against Base44 or anyone on its behalf relating to any past, present or future moral rights, artists\' rights, or any other similar rights worldwide that you may have in or to the Templates in your portfolio, with respect to such permitted uses.\n\n### 4.2 Ownership\n\nExcept for the granted licenses, between Base44 and Creator, Creator retains ownership of its App Templates, marks and content. Base44 does not claim ownership in your Template Intellectual Property by virtue of listing or sale in the App Templates Marketplace.\n\nBase44 does not acquire any ownership interest in the Templates, Marks or other User Content under these Marketplace Terms. Base44 Creator and its licensors (as applicable) shall retain their right, title and interest in the Templates, Marks and other User Content. In the event of any third party claim that a Base44 Member\'s possession or use of a Template or service you provide infringes on a third party\'s intellectual property rights, you, not Base44, will be solely responsible for the investigation, defense, settlement and discharge of any such intellectual property infringement claim.\n\n**Member ownership of modifications.** As between the Parties, Member owns all right, title, and interest in and to Member Modifications, Member Derivative Works, and Member Data (excluding the underlying Template IP and Creator assets). Creator will have no claim (including IP, authorship, or moral rights claims) to Member Modifications, Member Derivative Works, or Member Data, and hereby waives and agrees not to assert such claims to the extent permitted by law. Nothing herein grants Member any ownership interest in the Creator\'s Template IP or Creator assets.\n\n**Marks.** You grant Base44 a right to use, reproduce and display the Base44 Creator, and the Template\'s name and trademarks (the "Base44 Creator Marks") to market your listing, the App Templates Marketplace and promotional and marketing activities conducted by Base44 from time to time.\n\n## 5. Creator representations\n\nYou represent, warrant, and covenant that:\n\n1. You have the full right, power and authority to enter into these Terms and to fully perform all obligations hereunder. If you are entering into these Terms on behalf of an entity, you have the legal authority to bind that entity to these Terms. You are at least eighteen (18) years of age, or the age of majority in your jurisdiction of residence, whichever is higher.\n\n2. All information you have provided and will provide to Base44 (including in listings, profiles, support channels, compliance attestations, tax forms and review materials) is and will remain true, accurate, current and complete.\n\n3. Your App Templates, their contemplated use, and your use of App Templates Marketplace resources, do not and will not violate or conflict with any agreement, obligation, policy, or restriction to which you are a party or of which you are aware.\n\n4. Your App Templates, their contemplated use, and your use of the App Templates Marketplace comply, and will continue to comply, with all applicable laws, rules and regulations, including without limitation:\n   - Data protection, privacy, and security laws governing the collection, use, sharing, retention and cross\u2011border transfer of personal information;\n   - Applicable telecommunications and electronic communications laws;\n   - Consumer protection, e\u2011commerce, advertising and marketing, product/service, and related laws.\n\n5. Your App Templates, listings, and related materials, and your use of the App Templates Marketplace platform, do not and will not infringe, misappropriate, or violate any intellectual property, privacy, publicity, contractual, or other personal rights of any third party.\n\n6. Your Templates presented in your profile will be free of any malicious code.\n\n7. You own or otherwise have the full right and authority to present and publish the User Content or other content presented in your Profile, your Templates and your Portfolio (including, without limitation, links and third party websites). You must not submit, upload, post, display or share any content that you do not have the right to copy, use, link to or share for the purpose of your use of the Base44 Marketplace.\n\n8. **No third\u2011party payments triggered by our exercise of rights** Base44 exercise of the rights you grant under these App Templates Marketplace Terms (including the operational license and use of your marks and listing materials) will not obligate Base44 to pay any amounts to any third party (e.g., royalties, residuals, guild fees, or other payments).\n\n9. You are not (i) listed on, owned or controlled by any person or entity listed on, or otherwise the subject of, any applicable sanctions lists (including the U.S. OFAC Specially Designated Nationals and Blocked Persons List), and (ii) a national of, located in, or ordinarily resident in any country or region subject to comprehensive economic sanctions by the United States or Israel (currently including Crimea region of Ukraine, Cuba, Iran, North Korea, and Syria). You will comply with all applicable export control and sanctions laws.\n\n10. You will promptly notify Base44 of any change that would render the above untrue or inaccurate; timely address review findings; and provide information reasonably requested to verify your compliance with these App Templates Marketplace Terms.\n\n11. You confirm and acknowledge that some Personal Information and other Information (as those terms are defined in the Privacy Policy) you provide Base44 may become public and accessible to Base44 Members and other Base44 website visitors reviewing your Profile on the Base44 App Template Marketplace.\n\n12. To the extent permitted by law, you irrevocably permit Members to adapt, configure, and develop on top of your Template within their app instance(s) and waive, and agree not to assert, any moral rights or similar claims that would restrict such permitted adaptations.\n\n### 5.1 Warranty\n\nYou are solely responsible for any warranties, whether expressed or implied by law, to the extent not effectively disclaimed, for the Templates and any services you provide. Base44 will have no warranty obligation whatsoever with respect to the Templates or services you provide.\n\nYou agree that Base44 may monitor use of the Creator App Template to ensure quality, improve Base44 products and services, and verify your compliance with the Base44 Terms. This monitoring may include Base44 accessing and using your Apps, for example to identify security issues that could affect Base44 or Base44\'s users and/or visitors (collectively, the "Users"). You will not interfere with this monitoring. Base44 may use any technical means to overcome such interference. Base44 may suspend access to the Creator Apps by You or your Apps without notice if we reasonably believe that You are in violation of the Base44 Terms.\n\n### 5.2 License to You\n\nSubject to your ongoing compliance with these Terms, Base44 grants You a limited, non-exclusive, non-assignable, non-transferable and revocable license to use the Base44 Platform and develop, test, share and support your Apps which are built on Our Platform, solely in the manner described in these Terms.\n\nYou may not rent, lease, lend, sell, redistribute or sublicense the Base44 Services and/or the Base44 Template Marketplace.\n\nBase44 retains all right, title, and interest in the Base44 Platform and Services.\n\n## 6. Template requirements; submission and review\n\n### 6.1 Requirements\n\n- The Template must be fully functional and reviewed for bugs and defects;\n- The Template, and any demo or instances presented in your Listing, must be free of malware, spyware, viruses, trojans, backdoors, or other malicious code, and must not run unauthorized background services, mine cryptocurrency, or otherwise misuse user or platform resources;\n- The Template must not include any mechanism that grants the Creator (or any third party) access to a Member\'s app instance, systems, or data.\n- The Template must not collect, transmit, Member Data.\n- The Template must not infringe or misappropriate any intellectual property or personal right of any third party; and\n- The Template must comply with any other requirements provided to you by Base44.\n\n### 6.2 Submission\n\nSubmit each Template (and material updates) for review with an active demo account, credentials, and any resources needed to fully evaluate functionality.\n\nAddress review findings within specified timeframes; do not introduce unrelated changes when correcting issues.\n\nOnly public Templates without login are permitted; do not submit private Templates.\n\nListing text, screenshots, media, and pricing must accurately describe functionality, limitations, and any in\u2011Template purchases.\n\n### 6.3 Approval; monitoring\n\nBase44 may review before and after publication, require changes, or remove/suspend any Template or Creator profile at any time at our discretion, including any attempt to install or distribute malware, spyware, or other malicious code, run unauthorized background services, mine cryptocurrency, or otherwise misuse user or platform resources.\n\nContent that is defamatory, libelous, obscene, harassing, threatening, incendiary, abusive, racist, deceptive or fraudulent; encourages harmful/illegal conduct; infringes rights; manipulates ratings/reviews; cheats review; steals data; or otherwise violates law/these Terms.\n\nBase44 Creator agrees to cooperate with Base44 in the reviewing, testing and evaluation process and to answer questions and provide information and materials reasonably requested by Base44. Base44 may require Base44 Creator to make adjustments and/or modifications to its Template, as necessary to ensure the Template\'s compliance with this Agreement. Base44 Creator shall make such required adjustments within a reasonable period of time as determined by Base44. It is clarified that Base44 shall have no obligation to include any Template in the Marketplace even if such Template was previously approved by Base44.\n\n### 6.4 Ranking\n\nThe order of presentation of the Base44 Creators\' Profiles and Marketplace Templates on the Base44 Marketplace is subject to Base44\'s sole and absolute discretion. Ranking is determined by parameters decided by Base44, including, without limitation, the nature of the feedback we may receive from Base44 Members who have purchased the Templates you designed. Ranking signals may include compliance history, quality and performance metrics, User feedback, and support responsiveness, and may change over time without notice.\n\n## 7. Responsibility and Support\n\n### 7.1 You are solely responsible for all content of the Template\n\nYou are solely responsible for development, operation, maintenance, compliance, and support of Templates and for addressing third\u2011party claims.\n\nPublish clear support channels (name, address, contact email) and provide timely support to Members who purchased your Template.\n\nCreators must acknowledge Member support requests within two (2) business days and provide status updates until resolution, as disclosed in the Listing.\n\nIf Base44 receives a claim from a third party concerning a Template, Base44 may refer such claim to you. You must respond to the claim promptly, and take any and all actions required for the Template to comply with the law when applicable. If you discover or are notified that a Template violates the terms of these Marketplace Terms or the Base44 Terms, you shall immediately take the required actions to correct such violation. You must state in your Profile your name, address and all the required contact information to which any Base44 Member questions, complaints or claims with respect to the App Templates provide should be directed.\n\n## 8. Pricing, Collection and Revenue Share\n\nAll money collection related to Templates must use the Base44 Billing System and approved payment providers. No external purchase mechanisms (e.g., license keys, QR codes, external checkout links).\n\n### 8.1 Pricing disclosures and entitlements\n\nBase44 Creators are required to clearly define and present the prices applicable to the Template Licenses being purchased on the Marketplace. If a Marketplace Template License price is charged in any currency other than U.S. Dollar, Base44 will have the sole discretion to determine the exchange rate applicable to the Marketplace Template License and to set off any exchange rate costs incurred to Base44 as result of payment in any non U.S. Dollar currency.\n\nPrices must reflect total cost. If integration is free but a related service costs money, disclose that price in the listing.\n\nYour Template\'s pricing is up to you. However, Base44 won\'t distribute apps or in-app purchase items that are clearly overpriced, and such behavior may lead to rejection.\n\nIf your Template includes in-app purchases, make sure the description, screenshots and previews indicate which features require purchase.\n\nIf you raise prices, the change applies only to new purchasers. Existing paying users retain access to all functionality they already paid for.\n\n### 8.2 Collection\n\nBase44, either directly or through its third party partners or service providers, shall facilitate all purchases, returns and chargeback transactions related to the offered Marketplace Template Licenses (each, a "Billing Action"), including, collection of payments and processing cancellations and refunds related to Marketplace Template Licenses as the Creator\'s authorized. Base44 shall have the right but shall not be obligated, at its sole discretion, to approve cancellations of Marketplace Template Licenses purchased by Base44 Members and to refund such Base44 Members for the amounts paid by them to Base44 (or any part thereof). All Billing Actions are processed via the Base44 Billing System and are subject to processor terms, limits, verification/KYC, and availability.\n\n### 8.3 Revenue share\n\n"Net App Template License Revenues" are payable 100% to the Creator and 0% to Base44 (the "Revenue Share"), unless otherwise notified in writing. The term "Net App Template License Revenues" shall mean the aggregate amounts actually paid by Base44 Members to Base44 in consideration for the sale and use of a License to a Marketplace Template offered on the Marketplace excluding any and all taxes, currency exchange rates and other governmental charges of any kind that may be imposed; hosting fees; third party fees; refunds or rebates; billing or processing fees; and amounts paid by Base44 in connection with the sale of a License for a Marketplace Template.\n\n### 8.4 Payment of Revenue Share\n\nThe Revenue Share will be payable on a monthly basis within ninety (90) days from the Calculation Date (as defined below) on which Base44 collected the relevant Net App Template License Revenues. Calculation of the Revenue Share will occur on the first day of each calendar month for all Marketplace Template Licenses purchased by Base44 Members during the prior calendar month (the "Calculation Date").\n\nBase44 will not pay Base44 Creator an amount lower than two hundred U.S. dollars (USD $200; the "Minimum Payment Amount"). Accordingly, in the event Base44 Creator\'s balance at the end of a month is lower than the Minimum Payment Amount, such balance shall be carried over and added to the next month\'s Revenue Share amount until the total amount payable to such Base44 Creator reaches the Minimum Payment Amount. Any amounts will be payable to a Base44 Creator upon closing of such Base44 Creator\'s User Account.\n\n### 8.5 Form of Payment\n\nAll Revenue Share payments shall be due and payable in U.S. dollars only. Payment shall be made through wire transfer or any other method chosen by Base44, at its sole discretion. In certain territories, Base44 may require a valid tax invoice from the party receiving the payment, and payouts may be delayed until such documentation is received. Payment timing may be adjusted for holds, reserves, chargebacks, and other Billing Actions as permitted in these Terms.\n\n### 8.6 Refunds and chargebacks\n\nBase44 may approve cancellations/refunds at its discretion. Creators must return the corresponding share for refunded/charged\u2011back transactions; we may offset against future payouts.\n\n### 8.7 Taxes\n\nBase44 does not serve as an employer of any Base44 Creator. Base44 Creator shall be responsible for the payment of any and all taxes assessments, fees and other governmental charges of any kind, as well as withholding and reporting obligations applicable to the conduct of Base44 Creator\'s business. You understand and agree that if Base44 is found to be liable for any tax, withholding or reporting obligation in connection with any Services provided or received by you, you will immediately reimburse and indemnify Base44 for all costs, expenses and liabilities (including any interest and penalties) relating to the same. In the event that pursuant to any law or regulation, tax is required to be withheld at source from any payment made to Base44 Creator, Base44 shall withhold said tax at the rate set forth in the certification issued by the appropriate taxing authority and provided to Base44 by Base44 Creator, or in the absence of such certification, at the rate determined by said law or regulation. If a Template License price is presented in any currency other than U.S. dollars, Base44 will have the sole discretion to determine the exchange rate applicable to the License and to set off any exchange rate costs incurred to Base44 as result of payment in any non U.S. dollar currency.\n\n### 8.8 Right to change\n\nWe may modify revenue mechanisms, payout methods, minimums and and/or any other method set forth in this Section, at our sole discretion at any time, without notice to Base44 Creator.\n\n## 9. Access controls\n\n### 9.1 No unauthorized admin or role elevation; no backdoors\n\nYou must not add yourself (or anyone on your behalf) as a site owner, site admin, contributor, or otherwise elevate your privileges within a Member\'s app instance.\n\nYou must not create hidden users, backdoor access, shared "support" accounts, or otherwise bypass Base44 permission flows.\n\n### 9.2 Cookies/trackers\n\nIf the Template uses cookies or similar tracking technologies ("Cookies") to track Base44 Members or their visitors, the Base44 Creator must provide clear and comprehensive notice identifying the Cookies used, the data collected, purposes of use, third parties involved, and obtain valid consent where required (e.g., via a compliant CMP in the EEA/UK).\n\n### 9.3 Duplicating\n\nFor clarity: Cloning creates a new app instance and does not carry over or expand the scope of any existing Template License. Each Duplicated App must initialize as a separate Instance under these Terms.\n\n**Ownership of content created in a Duplicated App.** Member Modifications, Member Derivative Works, and Member Data created in a Duplicated App are owned by the Member (excluding underlying Template IP and Creator assets), and are not subject to Creator ownership or claim.\n\n## 10. Security and permissions\n\nImplement industry\u2011standard security (e.g., protect against CSRF/XSS; store salted password hashes; encrypt sensitive data in transit and at rest; do not store sensitive data in cookies).\n\nRequest only the minimum permissions necessary; define scope before requesting; secure app secret keys, OAuth tokens, and Instance IDs.\n\n## 11. Economic Sanctions and Exports Controls\n\nCreator will not provide or permit use of Templates in or by persons/entities in any of the countries that are subject to comprehensive economic sanctions under the EAR, OFAC, or Israeli regulations - currently including Crimea region of Ukraine, Cuba, Iran, North Korea, Syria. Moreover, Base44 Creator shall not allow and fully restrict any usage relating to its Template(s) from Members (individuals and entities) identified on any Sanctions list, including but not limited to OFAC\'s Specially Designated Nationals and Blocked Parties List (the "SDN List"), entities owned 50% or more by any individuals or entities on the SDN List, or individuals or entities that are located in any comprehensively sanctioned country.\n\nCreator is solely responsible for compliance with U.S., Israeli, EU, UK and other applicable export controls and sanctions.\n\n## 12. User experience; technical; accessibility\n\nFunctionality must be clear and match the listing.\n\nInstallation/configuration/management flows must be intuitive; show demo data on first run.\n\nSubmissions with material bugs or errors will be rejected.\n\n## 13. Marketing; reviews\n\nDo not force ratings/reviews/shares/follows, or incentivize reviews (discounts, gifts, etc.). Do not write or solicit fake reviews.\n\n**UX intrusions.** No distracting/annoying behavior (e.g., JS alert/confirm boxes).\n\nDo not display ads or "powered by" watermarks.\n\nCreators must not promote or redirect Users to other distribution platforms or external purchase flows from within the Template or the Listing.\n\nCross\u2011promotion of other apps by the same Creator must be unobtrusive and relevant to the Template\'s core functionality.\n\n## 14. Content and third\u2011party data\n\nDo not include illegal content or infringe Base44 or third\u2011party rights (including trademarks/copyrights/branded content) without authorization. Provide proof upon request.\n\nIf the Template uses/displays third\u2011party content/services, ensure you have rights under their terms; provide authorization upon Base44 request.\n\nDo not facilitate illegal file sharing or enable saving, copying, extracting, converting, downloading, or transmitting media from third\u2011party sources without explicit authorization/licensing.\n\n## 15. Additional terms for Members\n\n### 15.1 General acknowledgements\n\nBase44 is not the employer, agent, or supervisor of Creators. Creators act as independent contractors.\n\nListings are Creator\u2011provided. Base44 does not guarantee accuracy, suitability, quality, legality, availability, or performance of Templates.\n\nYou are responsible for providing accurate information, paying required fees/taxes, and complying with law, export controls, and sanctions.\n\nReferences or links to Creators or Templates do not constitute endorsement.\n\nYou are solely responsible for your activity in the App Templates Marketplace and for exercising judgment when licensing Templates or engaging Creators.\n\n### 15.2 Information sharing and communications\n\nYou authorize Base44 to share your necessary account and contact information with Creators you engage and to contact you with messages and promotional materials (opt\u2011out available as provided by law).\n\n### 15.3 Third\u2011party dependencies\n\nSome Templates rely on external services/APIs. Your use of those is subject to the third party\'s terms and privacy policy. Changes by a third party may affect Template functionality; Base44 is not responsible for third\u2011party services.\n\n### 15.4 Termination by Base44\n\nWe may terminate or suspend your access at any time. Previously purchased Template licenses generally remain in effect per the applicable license terms.\n\n## 16. Licensing of App Templates\n\nBase44 is authorized by the Creator to grant you a limited, personal, non\u2011exclusive, non\u2011transferable, non\u2011sublicensable, perpetual, single\u2011use license to install/use the Template in connection with one (1) app instance under your Base44 account, solely to customize and operate that app instance.\n\n**Member Modifications; Derivative Works.** Subject to these Terms and the applicable license, Members may configure, adapt, and create Member Modifications and Member Derivative Works from a Template for use within their app instance(s). Creator irrevocably permits such adaptations and, to the maximum extent permitted by law, waives any moral rights enforcement that would prevent or restrict such adaptations. For the avoidance of doubt: (i) the Creator retains ownership of the underlying Template IP and Creator assets; (ii) the Member owns the Member Modifications, Member Derivative Works, and Member Data (excluding the underlying Template IP and Creator assets); and (iii) Creator has no ownership, authorship, or other IP claim to Member Modifications, Member Derivative Works, or Member Data.\n\n**Commercialization limits.** Member Modifications and Member Derivative Works may not be resold, relicensed, distributed, or published as Templates or marketplace listings (on or off the Marketplace) unless expressly permitted by these Terms or by written consent from the Creator and Base44.\n\n### 16.1 License limitations\n\nThis App Template license is limited to a single use and is non\u2011refundable unless required by applicable law or expressly stated otherwise herein.\n\nYou may not resell, redistribute, relicense, or publish the Template or any substantial portion of it, including any modified versions, except for internal use within your licensed app instance(s). Each Duplicated App is a separate app instance and requires its own Template License.\n\nNothing in these Terms restricts your right to create and use Member Modifications or Member Derivative Works internally within your app instance(s). However, you may not list or distribute Member Modifications or Member Derivative Works as a new Template or product on the Marketplace (or elsewhere) if they incorporate the Creator\'s Template IP or assets, unless you have obtained written permission from the Creator (and Base44, where required).\n\nCreators must not display advertisements, promotional banners, or "powered by" watermarks to site owners or visitors, except where the Template\'s sole purpose is advertising and such behavior is (i) lawful, (ii) clearly disclosed pre\u2011purchase in the Listing, and (iii) compliant with applicable consent and disclosure requirements.\n\n### 16.2 Ownership and support\n\nCreator retains ownership of Template IP. No rights are granted except as expressly stated.\n\nCreator is solely responsible for Template support unless the listing states otherwise. Base44 does not provide support for Creator Templates.\n\n### 16.3 Non\u2011refundability\n\nTemplate purchases are generally final and non\u2011refundable, except where required by law.\n\n### 16.4 Payments\n\nYou authorize Base44 or its payment providers to process charges and handle renewals if a Template or related service is offered on a subscription basis.\n\nChargebacks may result in suspension/termination of access and capacity loss. Contact support before initiating a chargeback to avoid unintended consequences.\n\n### 16.5 Third\u2011party services and dependencies\n\nTemplates may require or interoperate with third\u2011party services, APIs, data sources or Base44 platform services. Your use of such offerings is subject to their terms and privacy policies. Base44 is not responsible for third\u2011party services.\n\n### 16.6 Removal/suspension\n\nWe may suspend or remove access to third\u2011party services (including where a provider ceases operations or violates policy) without liability to you. Such changes may impact Template functionality.\n\n### 16.7 Creator - Member disputes\n\nCreators and Members must resolve disputes directly. Base44 does not mediate Creator\u2011Member disputes. Violations of these App Templates Marketplace Terms may result in removal, suspension, or other action.\n\n## 17. Intellectual property; notices\n\nWe respect IP rights. If you believe content infringes your rights, submit a notice to abuse@base44.com (subject: "IP Infringement Notice"). We may remove content or disable access and may terminate repeat infringers.\n\n**Counter\u2011notice.** If your content was removed based on an infringement notice, you may submit a counter\u2011notice as permitted by law. We may share notices with the other party.\n\n## 18. Warranties; Disclaimers\n\nTo the fullest extent permitted by law, the App Templates Marketplace and all Templates are provided "as is" and "as available," without warranties of any kind (express, implied, or statutory), including merchantability, fitness for a particular purpose, accuracy, reliability, non\u2011infringement, or that Templates or the App Templates Marketplace will be secure, error\u2011free, or uninterrupted. Outputs from any AI or automated tooling are suggestions only and may be inaccurate or infringing; review before use.\n\n## 19. Limitation of liability\n\nThe following disclaimers and limitations of liability are supplemental to the disclaimers and limitations of liability under the Base44 Terms:\n\n**19.1** YOU AGREE THAT YOUR USE OF THE BASE44 APP TEMPLATE MARKETPLACE, WHETHER AS A BASE44 CREATOR OR AS A BASE44 MEMBER, IS AT YOUR SOLE RISK. TO THE FULLEST EXTENT PERMITTED BY LAW, BASE44, ITS OFFICERS, DIRECTORS, EMPLOYEES, AND AGENTS (COLLECTIVELY, "BASE44 REPRESENTATIVES") DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, AND ASSUME NO RESPONSIBILITY IN CONNECTION WITH: (A) THE TEMPLATES OFFERED BY BASE44 CREATORS ON THE BASE44 APP TEMPLATE MARKETPLACE AND ANY USE THEREOF BY ANY USER; (B) THE ACCURACY OR COMPLETENESS OF THE MARKETPLACE SITE\'S CONTENT OR THE CONTENT OF ANY SITES LINKED TO THE MARKETPLACE; (C) ANY BASE44 CREATOR\'S REGISTRATION OR PROFESSIONAL ACCREDITATION; (D) THE RESULTS THAT MAY BE OBTAINED FROM USE OF THE BASE44 APP TEMPLATE MARKETPLACE; (E) THE TIMELINESS, ACCURACY, RELIABILITY, QUALITY, SUITABILITY, SAFETY, COMPLETENESS, OR CONTENT OF THE APP TEMPLATES, OR ANY PRODUCTS, MERCHANDISE, CONTENT, INFORMATION, OR MATERIALS PROVIDED THROUGH OR IN CONNECTION WITH THE BASE44 APP TEMPLATE MARKETPLACE; AND (F) THE SUITABILITY, LEGALITY, OR ABILITY OF ANY BASE44 CREATOR TO PROVIDE SERVICES.\n\nNEITHER BASE44 NOR BASE44 REPRESENTATIVES ARE RESPONSIBLE FOR THE CONDUCT, WHETHER ONLINE OR OFFLINE, OF ANY USER OF THE BASE44 APP TEMPLATE MARKETPLACE (INCLUDING, WITHOUT LIMITATION, ANY BASE44 MEMBER OR BASE44 CREATOR).\n\n**19.2** IN ADDITION TO ANY LIMITATIONS OF LIABILITY SET OUT IN THE BASE44 TERMS, IN NO EVENT SHALL BASE44 OR ANY BASE44 REPRESENTATIVES BE LIABLE TO YOU FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, PUNITIVE, OR CONSEQUENTIAL DAMAGES WHATSOEVER RESULTING FROM: (I) THE USE OF OR INABILITY TO USE THE SERVICE; (II) UNAUTHORIZED ACCESS TO OR ALTERATION OF YOUR ACCOUNT; (III) YOUR RELIANCE ON USER CONTENT, INCLUDING TEMPLATES; (IV) ANY COMMUNICATION BETWEEN ANY BASE44 MEMBER AND ANY BASE44 CREATOR LISTED ON THE BASE44 APP TEMPLATE MARKETPLACE; OR (V) ANY OTHER MATTER RELATING TO THE SERVICE. SOME JURISDICTIONS DO NOT PERMIT THE EXCLUSION OF CERTAIN LIABILITIES; ACCORDINGLY, CERTAIN LIMITATIONS DESCRIBED HEREIN MAY NOT APPLY TO YOU.\n\nYOU EXPRESSLY WAIVE AND RELEASE BASE44 AND BASE44 REPRESENTATIVES FROM ANY AND ALL LIABILITY, CLAIMS, OR DAMAGES ARISING FROM OR IN ANY WAY RELATED TO THE SERVICES. IN THE EVENT YOU HAVE A DISPUTE WITH ONE OR MORE USERS, YOU RELEASE BASE44 AND BASE44 REPRESENTATIVES FROM ANY AND ALL CLAIMS, DEMANDS, OR DAMAGES (ACTUAL, DIRECT, OR CONSEQUENTIAL) OF EVERY KIND AND NATURE, KNOWN AND UNKNOWN, SUSPECTED AND UNSUSPECTED, DISCLOSED AND UNDISCLOSED, ARISING OUT OF OR IN ANY WAY CONNECTED WITH SUCH DISPUTE. AS WITH THE PURCHASE OF ANY PRODUCT OR SERVICE, USERS SHOULD USE THEIR BEST JUDGMENT AND EXERCISE CAUTION WHERE APPROPRIATE. YOUR USE OF THE BASE44 APP TEMPLATE MARKETPLACE AND THE SERVICES IS AT YOUR OWN RISK. THE FOREGOING LIMITATIONS OF LIABILITY SHALL APPLY TO THE FULLEST EXTENT PERMITTED BY LAW IN THE APPLICABLE JURISDICTION. USERS SHOULD USE THEIR BEST JUDGMENT WHEN PURCHASING OR PROVIDING A SERVICE.\n\nNOTHING IN THE BASE44 APP TEMPLATES TERMS OR ON THE BASE44 APP TEMPLATE MARKETPLACE CONSTITUTES, OR IS INTENDED TO CONSTITUTE, LEGAL, FINANCIAL, OR OTHER PROFESSIONAL ADVICE.\n\nTO THE FULLEST EXTENT PERMITTED BY LAW, BASE44\'S MAXIMUM LIABILITY ARISING OUT OF OR IN CONNECTION WITH THE SERVICE OR YOUR USE OF THE BASE44 APP TEMPLATE MARKETPLACE, REGARDLESS OF THE CAUSE OF ACTION (CONTRACT, TORT, BREACH OF WARRANTY, OR OTHERWISE), WILL NOT EXCEED THE GREATER OF: (A) IF YOU ARE A BASE44 MEMBER, THE FEES YOU HAVE PAID TO BASE44 FOR THE LICENSE TO A TEMPLATE; (B) IF YOU ARE A BASE44 CREATOR, THE FEES PAID BY BASE44 TO YOU IN THE LAST THREE (3) MONTHS; AND (C) $100.\n\n## 20. Indemnity\n\nAs a user of the Base44 App Template Marketplace (whether a Base44 Member or a Base44 Creator), and in addition to your indemnification obligations under the Base44 Terms, you agree to defend, indemnify, and hold harmless Base44 and its officers, directors, shareholders, employees, affiliates, and agents from and against any and all claims, damages, obligations, losses, liabilities, costs, debts, and expenses (including reasonable attorneys\' fees) arising out of or related to:\n\n**For all Base44 Members and Base44 Creators:**\n\n1. your violation of any third\u2011party right, including any copyright, property, or privacy right, resulting from your portfolio, user content, or your use of the Services or Templates;\n\n2. your use of the Base44 App Template Marketplace and/or the Services, including any transactions or interactions arising therefrom; and\n\n3. any alleged breach by you of these Marketplace Terms (including any documents incorporated by reference) or of any agreement between a Base44 Creator and a Base44 Member governing a Member\'s use of a Template.\n\n**Additional obligations for Base44 Creators:**\n\n4. your gross negligence or willful misconduct; and\n\n5. any claims arising from the use of, inability to use, performance, non\u2011performance, or improper performance of your Template, including any product liability claims.\n\n## 21. Termination\n\nBase44 Members and Base44 Creators acknowledge that Base44 may, in its sole discretion, terminate their access to the Base44 App Template Marketplace, the Services, and any Templates at any time, with or without notice. Such termination may disable or limit certain Template features. Base44 shall have no liability arising from or related to any such termination.\n\n### 21.1 Effect\n\n- Creator accounts and listings may be deactivated or removed.\n- Member access to the App Templates Marketplace may cease; previously issued Template licenses generally remain in effect per license terms.\n- Accrued, undisputed Creator payouts will be paid per schedule, subject to offsets for refunds/chargebacks.\n- Sections intended to survive (payments, IP, disclaimers, limitations, indemnity, privacy, sanctions/export, governing law) survive termination.\n\n### 21.2 Data and capacity loss\n\nTermination or removal may result in loss of content, data or functionality. Back up your data. We are not responsible for data loss.\n\n## 22. Changes to the App Templates Marketplace\n\n**Terms and services** We may change, suspend, or discontinue any feature of the App Templates Marketplace, and/or update these Terms, at any time, with or without notice, subject to applicable law. If changes materially impact fees or revenue share percentage, we will provide prior notice (for percentage changes).\n\n## 23. Governing law; disputes; venue; class action waiver\n\n### 23.1 Governing law\n\nYou expressly acknowledge and agree that Base44 shall have the right to enforce these Terms against you. Except to the extent any mandatory applicable law provides otherwise, these Terms, the rights and remedies provided hereunder, and any and all claims and disputes related hereto and/or to the App Templates Marketplace shall be governed by, construed under and enforced in all respects solely and exclusively in accordance with the internal substantive laws of the State of Israel, without respect to its conflict of laws principles. Any and all such claims and disputes shall be brought in, and you hereby consent to them being decided exclusively by, a court of competent jurisdiction located in Tel Aviv, Israel. The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded.\n\nNotwithstanding the foregoing, if you are located in the United States of America, the governing law for payment\u2011related disputes between you and Base44 will be the State of New York, without respect to its conflict of laws principles, and such disputes shall be brought exclusively in courts located in New York, New York.\n\n## 24. Miscellaneous\n\n**Entire agreement.** These Terms, together with the Base44 Terms of Service, and the Base44 Privacy Policy, constitute the entire agreement regarding the App Templates Marketplace.\n\n**Assignment.** We may assign these Terms. You may not assign without our prior written consent.\n\n**Severability; waiver.** If any provision is unenforceable, the remainder remains in effect. No waiver is effective unless in writing and no waiver of one breach is a waiver of another.\n\n**Notices.** We may notify you via the App Templates Marketplace, email, your account, your Reseller (if applicable), or other contact details you provided. Notices are deemed received within 24 hours of sending unless otherwise indicated.\n\n**Relationship.** Nothing herein creates a partnership, joint venture, or employment relationship between Base44 and any User.\n\n**Survival.** The following provisions survive termination or expiration: licenses granted to Base44; payments, offsets, taxes; data privacy and access controls; security and permissions; sanctions/export; disclaimers; limitations of liability; indemnity; IP and notices; dispute resolution; and any other provision that by its nature should survive.\n'})})]})})]})})})}const kX=()=>{const[e]=(0,Z.useSearchParams)(),t=e.get("appId"),[s,a]=(0,Y.useState)(!0);return(0,Y.useEffect)(()=>{(async()=>{if(t)try{const{url:e}=await zc.getAppPublishedUrl(t);window.location.href=e}catch(e){a(!1)}else a(!1)})()},[t]),t?s?(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mx-auto mb-4"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Redirecting to app..."})]})}):null:(0,se.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,se.jsx)("div",{className:"text-center",children:(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"No app found"})})})},CX=[{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/7d29cd82d_image.png",name:"Task management flow"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/5c09f40a9_Screenshot2025-08-05at72216PM.png",name:"Interactive Floating Sidebar UI"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6e210e9d2_image.png",name:"Tuesday.com"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/99957f317_image.png",name:"CryptoPulse AI"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/50c296c5a_Screenshot2025-08-05at75928PM.png",name:"Digital Asset Trading Interface"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/7117fa9d7_image.png",name:"Moda Studio"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/476d38fcc_AccuPro.jpg",name:"AccuPro"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/3cb61189d_Screenshot2025-08-07at60618PM.png",name:"Dark glassmorphic interface"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/68c00d37cf382c8b00deb66e/be38563c8_Screenshot2025-09-09171606.png",name:"CODE GEN AI"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/06acedf4e_Screenshot2025-08-05at73529PM.png",name:"Interactive Globe"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/8a6304e4b_Screenshot1.png",name:"CodeMaster"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/148eedd97_Screenshot2025-08-06034625.png",name:"CompanyHub"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/bc3a6408d_Screenshot2025-08-05at94004PM.png",name:"Financial Education Academy"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/010274a5c_Screenshot2025-08-28092749.png",name:"SETH"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/4f97403a2_IMG_2122.jpeg",name:"Star AI"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/eb22e5da9_Srenity-SpaSalon-HeroSection-2.png",name:"Serenity- Spa & Salon"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/42cbdff5a_Screenshot2025-08-28at44953PM.png",name:"StudyBuddy"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/8aee77a9c_image.png",name:"Burger Builder"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/de3be3bad_Mathsolver.jpeg",name:"ClayMath Solver"},{url:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/3649b0995_Screenshot2025-08-04at105545pm.png",name:"FormForge"}];const AX=function(){const{user:e}=wd(),[t,s]=(0,Z.useSearchParams)(),[a,n]=(0,Y.useState)("new"===t.get("renderer")),[l,r]=(0,Y.useState)("false"!==t.get("lazy")),[i,o]=(0,Y.useState)(parseInt(t.get("quality")||"80",10)),[c,d]=(0,Y.useState)(parseInt(t.get("duration")||"300",10)),[u,m]=(0,Y.useState)("true"!==t.get("transition")),[x,h]=(0,Y.useState)({}),[p,g]=(0,Y.useState)(Date.now()),f=(e,a)=>{const n=new URLSearchParams(t);n.set(e,a.toString()),s(n)},v=()=>{h({}),g(Date.now()),window.location.reload()},b=(e,t)=>{const s=Date.now()-t;h(t=>(0,ue.A)((0,ue.A)({},t),{},{[e]:s}))};return e&&$p(e.platform_role)?(0,se.jsx)("div",{className:"min-h-screen bg-slate-50 py-8 px-4",children:(0,se.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,se.jsx)("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg p-6 mb-6 shadow-lg",children:(0,se.jsxs)("div",{className:"flex items-start gap-4",children:[(0,se.jsx)("div",{className:"text-4xl",children:"\u26a0\ufe0f"}),(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"First Time Testing? Read This!"}),(0,se.jsx)("p",{className:"text-orange-50 mb-3",children:"To see accurate results and avoid cached images, you MUST clear your cache first."}),(0,se.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,se.jsx)(Bx,{onClick:v,className:"bg-white text-orange-600 hover:bg-orange-50 font-semibold",size:"lg",children:"\u{1f504} Click Here to Clear Cache & Reload"}),(0,se.jsxs)("div",{className:"flex items-center gap-2 text-orange-50 text-sm",children:[(0,se.jsx)("span",{children:"OR press:"}),(0,se.jsx)("kbd",{className:"bg-orange-700 px-2 py-1 rounded font-mono",children:"Cmd+Shift+R"}),(0,se.jsx)("span",{children:"(Mac)"}),(0,se.jsx)("kbd",{className:"bg-orange-700 px-2 py-1 rounded font-mono",children:"Ctrl+Shift+F5"}),(0,se.jsx)("span",{children:"(Windows)"})]})]})]})]})}),(0,se.jsxs)("div",{className:"mb-8",children:[(0,se.jsx)("h1",{className:"text-4xl font-bold text-slate-900 mb-2",children:"Image Rendering Test Page"}),(0,se.jsxs)("p",{className:"text-slate-600 text-lg",children:["Compare the old ",(0,se.jsx)("code",{className:"bg-slate-200 px-2 py-1 rounded",children:"img"})," tag with the new ",(0,se.jsx)("code",{className:"bg-slate-200 px-2 py-1 rounded",children:"ImageRenderer"})," component"]})]}),(0,se.jsx)(Bv,{className:"mb-8",children:(0,se.jsx)(Wv,{className:"p-6",children:(0,se.jsxs)("div",{className:"space-y-6",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"Rendering Mode"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Switch between old and new image rendering"})]}),(0,se.jsxs)("div",{className:"flex items-center gap-4",children:[(0,se.jsx)(aN,{htmlFor:"renderer-switch",className:"text-base font-medium",children:a?(0,se.jsx)(gk,{className:"bg-green-500 hover:bg-green-600",children:"New ImageRenderer \u2728"}):(0,se.jsx)(gk,{className:"bg-slate-500 hover:bg-slate-600",children:"Old <img> tag"})}),(0,se.jsx)(aB,{id:"renderer-switch",checked:a,onCheckedChange:e=>{n(e),f("renderer",e?"new":"old"),h({}),g(Date.now())}})]})]}),a&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"border-t pt-6 space-y-4",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(aN,{htmlFor:"lazy-switch",className:"text-base font-medium",children:"Lazy Loading"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Only load images when they enter viewport"})]}),(0,se.jsx)(aB,{id:"lazy-switch",checked:l,onCheckedChange:e=>{r(e),f("lazy",e)}})]}),(0,se.jsxs)("div",{children:[(0,se.jsxs)(aN,{htmlFor:"quality-slider",className:"text-base font-medium block mb-2",children:["Image Quality: ",i]}),(0,se.jsx)("input",{id:"quality-slider",type:"range",min:"20",max:"100",value:i,onChange:e=>{return t=Number(e.target.value),o(t),void f("quality",t);var t},className:"w-full"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Lower quality = smaller file size, faster loading"})]}),(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)(aN,{htmlFor:"transition-switch",className:"text-base font-medium",children:"Opacity Transition"}),(0,se.jsx)("p",{className:"text-sm text-slate-600",children:"Smooth fade between placeholder and full image"})]}),(0,se.jsx)(aB,{id:"transition-switch",checked:!u,onCheckedChange:e=>{m(!e),f("transition",e)}})]}),!u&&(0,se.jsxs)("div",{children:[(0,se.jsxs)(aN,{htmlFor:"duration-slider",className:"text-base font-medium block mb-2",children:["Transition Duration: ",c,"ms"]}),(0,se.jsx)("input",{id:"duration-slider",type:"range",min:"0",max:"1000",step:"50",value:c,onChange:e=>{return t=Number(e.target.value),d(t),void f("duration",t);var t},className:"w-full"}),(0,se.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"How fast the blur-to-sharp transition happens"})]})]}),(0,se.jsxs)("div",{className:"border-t pt-6",children:[(0,se.jsx)("h3",{className:"font-semibold mb-3",children:"Features Active:"}),(0,se.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,se.jsx)(gk,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"\u2705 Progressive Loading (blur-up)"}),(0,se.jsx)(gk,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"\u2705 Responsive srcset (1x, 2x, 3x)"}),(0,se.jsx)(gk,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"\u2705 Automatic WebP conversion"}),l&&(0,se.jsx)(gk,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"\u2705 Lazy Loading"}),!u&&(0,se.jsxs)(gk,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:["\u2705 Smooth transitions (",c,"ms)"]}),(0,se.jsx)(gk,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"\u2705 Error handling"})]})]})]})]})})}),(0,se.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"p-4",children:[(0,se.jsx)("div",{className:"text-sm text-slate-600",children:"Total Images"}),(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:CX.length})]})}),(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"p-4",children:[(0,se.jsx)("div",{className:"text-sm text-slate-600",children:"Images Loaded"}),(0,se.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:Object.keys(x).length})]})}),(0,se.jsx)(Bv,{children:(0,se.jsxs)(Wv,{className:"p-4",children:[(0,se.jsx)("div",{className:"text-sm text-slate-600",children:"Avg Load Time"}),(0,se.jsxs)("div",{className:"text-2xl font-bold text-slate-900",children:[Object.keys(x).length>0?Math.round(Object.values(x).reduce((e,t)=>e+t,0)/Object.values(x).length):0,"ms"]})]})})]}),(0,se.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-8",children:(0,se.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,se.jsxs)("div",{className:"flex-1",children:[(0,se.jsx)("h3",{className:"font-semibold text-orange-900 mb-2",children:"\u{1f9ea} Testing Instructions:"}),(0,se.jsxs)("ul",{className:"text-sm text-orange-800 space-y-1 list-disc list-inside",children:[(0,se.jsxs)("li",{children:[(0,se.jsx)("strong",{children:"First time:"})," Press Cmd+Shift+R (Mac) or Ctrl+Shift+F5 (Windows) to hard reload"]}),(0,se.jsx)("li",{children:"Open DevTools Network tab to see image requests"}),(0,se.jsx)("li",{children:"Toggle between old and new renderer to compare"}),(0,se.jsx)("li",{children:"Watch for blur-up effect with new renderer (small placeholder \u2192 full image)"}),(0,se.jsx)("li",{children:"Scroll down to see lazy loading in action"}),(0,se.jsx)("li",{children:"Check image URLs - new renderer adds transformation parameters"}),(0,se.jsx)("li",{children:"Compare file sizes in Network tab (WebP vs original format)"})]})]}),(0,se.jsx)(Bx,{onClick:v,variant:"outline",className:"bg-white border-orange-300 text-orange-700 hover:bg-orange-50 whitespace-nowrap",children:"\u{1f504} Clear Cache & Reload"})]})}),(0,se.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:CX.map((e,t)=>{const s=Date.now(),n="".concat(e.url).concat(e.url.includes("?")?"&":"?","_cb=").concat(p);return(0,se.jsxs)(Bv,{className:"overflow-hidden",children:[(0,se.jsx)("div",{className:"relative aspect-video bg-slate-100",children:a?(0,se.jsx)(Cg,{src:n,alt:e.name,className:"w-full h-full",objectFit:"cover",quality:i,lazy:l,transitionDuration:c,disableTransition:u,onLoad:()=>b(t,s),onError:()=>{}}):(0,se.jsx)("img",{src:n,alt:e.name,className:"w-full h-full object-cover",onLoad:()=>b(t,s),onError:()=>{}})}),(0,se.jsxs)(Wv,{className:"p-4",children:[(0,se.jsx)("h3",{className:"font-medium text-slate-900 text-sm mb-2 truncate",children:e.name}),(0,se.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[(0,se.jsxs)("span",{children:["Image ",t+1]}),x[t]&&(0,se.jsxs)(gk,{variant:"outline",className:"text-xs",children:[x[t],"ms"]})]})]})]},t)})}),(0,se.jsxs)("div",{className:"mt-12 space-y-4",children:[(0,se.jsxs)("div",{className:"text-center text-slate-600 text-sm",children:[(0,se.jsx)("p",{children:"Open DevTools Network tab to see the difference in image requests and file sizes"}),(0,se.jsx)("p",{className:"mt-2",children:"Expected: 40-60% bandwidth reduction with ImageRenderer + WebP conversion"})]}),(0,se.jsxs)("div",{className:"bg-slate-100 border border-slate-200 rounded-lg p-4 text-sm",children:[(0,se.jsx)("h4",{className:"font-semibold text-slate-900 mb-2",children:"\u{1f4a1} URL Parameters"}),(0,se.jsx)("p",{className:"text-slate-600 mb-2",children:"Settings are saved in URL - share your configuration:"}),(0,se.jsxs)("div",{className:"space-y-1 text-slate-600 font-mono text-xs",children:[(0,se.jsxs)("div",{children:["\u2022 ",(0,se.jsx)("code",{children:"?renderer=new"})," - Use new ImageRenderer"]}),(0,se.jsxs)("div",{children:["\u2022 ",(0,se.jsx)("code",{children:"?renderer=old"})," - Use old <img> tag (default)"]}),(0,se.jsxs)("div",{children:["\u2022 ",(0,se.jsx)("code",{children:"?lazy=true"})," - Enable lazy loading"]}),(0,se.jsxs)("div",{children:["\u2022 ",(0,se.jsx)("code",{children:"?quality=85"})," - Set image quality"]}),(0,se.jsxs)("div",{children:["\u2022 ",(0,se.jsx)("code",{children:"?transition=true"})," - Enable smooth transitions"]}),(0,se.jsxs)("div",{children:["\u2022 ",(0,se.jsx)("code",{children:"?duration=500"})," - Set transition duration (ms)"]})]}),(0,se.jsxs)("p",{className:"text-slate-600 mt-3",children:["Example: ",(0,se.jsx)("code",{className:"text-orange-600",children:"/img-test?renderer=new&quality=90&transition=true&duration=400"})]})]})]})]})}):(0,se.jsx)(J.C5,{to:"/",replace:!0})},SX=(0,Y.memo)(()=>(0,se.jsxs)("div",{className:"absolute inset-0 m-2 sm:m-4 rounded-lg sm:rounded-xl p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6 overflow-auto",children:[(0,se.jsx)("style",{children:"\n        @keyframes aggressivePulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.3; }\n        }\n        .aggressive-skeleton {\n          animation: aggressivePulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n        }\n        .delay-1 { animation-delay: 0.1s; }\n        .delay-2 { animation-delay: 0.2s; }\n        .delay-3 { animation-delay: 0.3s; }\n        .delay-4 { animation-delay: 0.4s; }\n        .delay-5 { animation-delay: 0.5s; }\n        .delay-6 { animation-delay: 0.6s; }\n      "}),(0,se.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,se.jsx)($r,{className:"h-8 sm:h-10 w-48 sm:w-64 bg-slate-200 aggressive-skeleton delay-1"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-full max-w-sm sm:max-w-md bg-slate-200 aggressive-skeleton delay-3"})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 md:gap-6 mt-4 sm:mt-6 md:mt-8",children:[(0,se.jsxs)("div",{className:"bg-white rounded-lg sm:rounded-xl p-4 sm:p-6 shadow-sm space-y-3 sm:space-y-4",children:[(0,se.jsx)($r,{className:"h-5 sm:h-6 w-28 sm:w-32 bg-slate-200 aggressive-skeleton delay-2"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-full bg-slate-200 aggressive-skeleton delay-4"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-3/4 bg-slate-200 aggressive-skeleton delay-1"}),(0,se.jsx)($r,{className:"h-9 sm:h-10 w-20 sm:w-24 bg-slate-200 aggressive-skeleton delay-5 mt-3 sm:mt-4"})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg sm:rounded-xl p-4 sm:p-6 shadow-sm space-y-3 sm:space-y-4",children:[(0,se.jsx)($r,{className:"h-5 sm:h-6 w-32 sm:w-40 bg-slate-200 aggressive-skeleton delay-6"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-full bg-slate-200 aggressive-skeleton delay-2"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-2/3 bg-slate-200 aggressive-skeleton delay-5"}),(0,se.jsx)($r,{className:"h-9 sm:h-10 w-24 sm:w-28 bg-slate-200 aggressive-skeleton delay-3 mt-3 sm:mt-4"})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg sm:rounded-xl p-4 sm:p-6 shadow-sm space-y-3 sm:space-y-4",children:[(0,se.jsx)($r,{className:"h-5 sm:h-6 w-32 sm:w-36 bg-slate-200 aggressive-skeleton delay-3"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-full bg-slate-200 aggressive-skeleton delay-6"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-5/6 bg-slate-200 aggressive-skeleton delay-2"}),(0,se.jsx)($r,{className:"h-9 sm:h-10 w-28 sm:w-32 bg-slate-200 aggressive-skeleton delay-4 mt-3 sm:mt-4"})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg sm:rounded-xl p-4 sm:p-6 shadow-sm space-y-3 sm:space-y-4",children:[(0,se.jsx)($r,{className:"h-5 sm:h-6 w-24 sm:w-28 bg-slate-200 aggressive-skeleton delay-1"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-full bg-slate-200 aggressive-skeleton delay-5"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-4/5 bg-slate-200 aggressive-skeleton delay-3"}),(0,se.jsx)($r,{className:"h-9 sm:h-10 w-16 sm:w-20 bg-slate-200 aggressive-skeleton delay-6 mt-3 sm:mt-4"})]})]}),(0,se.jsxs)("div",{className:"bg-white rounded-lg sm:rounded-xl p-4 sm:p-6 md:p-8 shadow-sm space-y-4 sm:space-y-6 mt-4 sm:mt-6 md:mt-8",children:[(0,se.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,se.jsx)($r,{className:"h-6 sm:h-8 w-40 sm:w-48 bg-slate-200 aggressive-skeleton"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-full bg-slate-200 aggressive-skeleton"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-full bg-slate-200 aggressive-skeleton"}),(0,se.jsx)($r,{className:"h-3 sm:h-4 w-3/4 bg-slate-200 aggressive-skeleton"})]}),(0,se.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 mt-4 sm:mt-6",children:[(0,se.jsx)($r,{className:"h-24 sm:h-32 w-full bg-slate-200 aggressive-skeleton rounded-lg"}),(0,se.jsx)($r,{className:"h-24 sm:h-32 w-full bg-slate-200 aggressive-skeleton rounded-lg"}),(0,se.jsx)($r,{className:"h-24 sm:h-32 w-full bg-slate-200 aggressive-skeleton rounded-lg"})]})]}),(0,se.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mt-4 sm:mt-6 md:mt-8 p-4 sm:p-6 bg-white rounded-lg sm:rounded-xl shadow-sm",children:[(0,se.jsxs)("div",{className:"space-y-1 sm:space-y-2",children:[(0,se.jsx)($r,{className:"h-4 sm:h-5 w-28 sm:w-32 bg-slate-200 aggressive-skeleton"}),(0,se.jsx)($r,{className:"h-3 w-40 sm:w-48 bg-slate-200 aggressive-skeleton"})]}),(0,se.jsx)($r,{className:"h-10 sm:h-12 w-32 sm:w-36 bg-slate-200 aggressive-skeleton rounded-lg"})]})]}));SX.displayName="PreviewSkeletonUI";const EX=SX;var TX=s(47499);const IX=(0,Y.memo)(e=>{let{currentUrl:t,referralCode:s,referralIsValid:a,isAuthLoading:n,onSuccess:l,onSwitchToLogin:r}=e;const{formData:i,isLoading:o,error:c,showPassword:d,setShowPassword:u,showPasswordTooltip:m,setShowPasswordTooltip:x,passwordStrength:h,isVerified:p,handleTurnstileSuccess:g,handleTurnstileError:f,handleTurnstileExpired:v,handleInputChange:b,handleSubmit:j}=((e,t,s)=>{const[a,n]=(0,Y.useState)({email:"",password:""}),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)({score:0,label:"Weak password",hasMinLength:!1,hasUpperLower:!1,hasSymbol:!1}),{turnstileToken:x,isVerified:h,handleTurnstileSuccess:p,handleTurnstileError:g,handleTurnstileExpired:f,validateTurnstileToken:v}=RW(r),b=(0,TX.n)({mutationFn:async()=>{if(!v())throw new Error("Please complete the verification");const e=t&&s?t:null;return jd.register(a.email,a.password,x,e)},onError:e=>{var t,s;400===(null===(t=e.response)||void 0===t?void 0:t.status)?r((null===(s=e.response.data)||void 0===s?void 0:s.detail)||"Registration failed"):r(e.message||"Registration failed. Please try again.")}}),j=(0,Y.useCallback)(e=>{const{name:t,value:s}=e.target;n(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:s})),"password"===t&&m(OW(s)),r(null)},[]),y=(0,Y.useCallback)(async e=>{r(null);try{(await b.mutateAsync()).id?e(a.email):r("Registration failed. Please try again.")}catch(t){}},[b,a.email]);return{formData:a,isLoading:b.isPending,error:l,setError:r,showPassword:i,setShowPassword:o,showPasswordTooltip:c,setShowPasswordTooltip:d,passwordStrength:u,isVerified:h,handleTurnstileSuccess:p,handleTurnstileError:g,handleTurnstileExpired:f,handleInputChange:j,handleSubmit:y}})(0,s,a),[y,N]=(0,Y.useState)(null);(0,Y.useEffect)(()=>()=>{y&&clearTimeout(y)},[y]);const w=(0,Y.useCallback)(()=>{y&&(clearTimeout(y),N(null)),x(!0)},[y,x]),_=(0,Y.useCallback)(()=>{const e=setTimeout(()=>{x(!1)},150);N(e)},[x]),k=(0,Y.useCallback)(()=>{y&&(clearTimeout(y),N(null))},[y]),C=(0,Y.useCallback)(()=>{x(!1)},[x]);return(0,se.jsx)("div",{className:"w-full space-y-4",children:n?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($r,{className:"w-full h-10 sm:h-12 rounded-lg bg-slate-300"}),(0,se.jsx)($r,{className:"w-full h-10 sm:h-12 rounded-lg bg-slate-300"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(fW,{buttonText:{default:"Sign up with Google",loading:"Please wait..."},redirectUrl:t,className:"w-full bg-gray-900 hover:bg-gray-800 hover:text-white text-white rounded-lg px-4 py-2.5 sm:py-3 flex items-center justify-center gap-2 transition-colors text-xs sm:text-sm border-0 h-auto",svgClassName:"w-4 h-4 sm:w-[18px] sm:h-[18px]"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,se.jsx)(Tr,{})}),(0,se.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,se.jsx)("span",{className:"bg-white px-2 text-slate-500",children:"Or"})})]}),c&&(0,se.jsx)("div",{className:"p-3 text-xs sm:text-sm text-red-600 bg-red-50 rounded-md",children:c}),(0,se.jsxs)("form",{onSubmit:e=>{e.preventDefault(),j(l)},className:"space-y-4",children:[(0,se.jsx)(CW,{name:"email",value:i.email,onChange:b,placeholder:"Enter your email address",required:!0,disabled:o,label:"Email"}),(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:"password",className:"text-xs sm:text-sm font-medium text-[#09090B]",children:"Password"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(gW,{name:"password",type:d?"text":"password",placeholder:"Enter your password",value:i.password,onChange:b,onFocus:w,onBlur:_,required:!0,disabled:o,className:"bg-white text-[#09090B] h-9 px-3 py-1 pr-20 border border-[#E4E4E7] rounded-md shadow-xs text-xs sm:text-sm",minLength:8}),i.password&&(0,se.jsx)("div",{className:"absolute right-9 top-1/2 -translate-y-1/2 h-[18px] flex items-center",children:(0,se.jsx)("span",{className:"text-xs text-[#71717A] font-normal leading-none",children:h.label.replace(" password","")})}),i.password&&(0,se.jsx)("button",{type:"button",onClick:()=>u(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 w-[18px] h-[18px] flex items-center justify-center text-[#71717A] hover:text-[#09090B]",children:d?(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,se.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,se.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,se.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,se.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,se.jsx)("div",{className:"hidden lg:block",children:(0,se.jsx)(zW,{password:i.password,showTooltip:m,onMouseEnter:k,onMouseLeave:C})})]})]}),(0,se.jsx)("div",{className:"lg:hidden",children:(0,se.jsx)(HW,{password:i.password,showTooltip:!!i.password})}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(hW,{type:"submit",className:"w-full h-9 sm:h-10 bg-black text-white rounded-md text-xs sm:text-sm",disabled:o||h.score<3,children:o?"Creating account...":"Sign Up"}),(0,se.jsx)(MW,{onSuccess:g,onError:f,onExpired:v,isVerified:p,className:"flex justify-center"}),(0,se.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 text-center",children:["Already have a Base44 account?"," ",(0,se.jsx)("button",{type:"button",onClick:r,className:"text-blue-600 hover:text-blue-700 underline font-medium",children:"Log In"})]})]})]})]})})});IX.displayName="RegisterForm";const PX=IX,LX=(0,Y.memo)(e=>{let{currentUrl:t,isAuthLoading:s,initialEmail:a,onSwitchToRegister:n,onNeedsVerification:l,prompt:r,platformVersion:i}=e;const{formData:o,setFormData:c,isLoading:d,error:u,setError:m,emailSubmitted:x,isCheckingSSO:h,ssoInfo:p,needsEmailVerification:g,handleInputChange:f,handleEmailChange:v,handleSubmit:b,resetEmailSubmitted:j}=((e,t)=>{const[s,a]=(0,Y.useState)({email:"",password:""}),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),[d,u]=(0,Y.useState)(!1),m=(0,TX.n)({mutationFn:async e=>{var t;if(!e.includes("@")||null===(t=e.split("@")[1])||void 0===t||!t.includes("."))throw new Error("Please enter a valid email address");return jd.checkDomainSSO(e)},onSuccess:e=>{c(e),i(!0)},onError:e=>{i(!0),c(null),"Please enter a valid email address"===e.message&&l(e.message)}}),x=(0,TX.n)({mutationFn:async()=>jd.login(s.email,s.password,null),onSuccess:s=>{if(s.success&&s.access_token)if((0,ee.O5)(s.access_token),localStorage.setItem("lastUsedAuthMethod","email"),t)window.location.reload();else{const t=Xc(e,"/");window.location.href=t}else l("Login failed. Please try again.")},onError:e=>{var t;if(400===(null===(t=e.response)||void 0===t?void 0:t.status)){var s;const t=(null===(s=e.response.data)||void 0===s?void 0:s.detail)||"Invalid email or password";l(t)}else l("Login failed. Please try again.")}}),h=(0,Y.useCallback)(e=>{const{name:t,value:s}=e.target;a(e=>(0,ue.A)((0,ue.A)({},e),{},{[t]:s})),l(null)},[]),p=(0,Y.useCallback)(e=>{h(e),r&&(i(!1),c(null))},[r,h]),g=(0,Y.useCallback)(async()=>{l(null),await m.mutateAsync(s.email)},[m,s.email]),f=(0,Y.useCallback)(()=>{if(!o||!o.workspace_id)return void l("SSO configuration error. Please try again.");const t="".concat((0,fe.Zk)(),"/workspaces/").concat(o.workspace_id,"/auth/sso/login?from_url=").concat(encodeURIComponent(e));window.location.replace(t)},[o,e]),v=(0,Y.useCallback)(async e=>{if(r)if(null!=o&&o.has_sso)f();else{l(null),u(!1);try{await x.mutateAsync()}catch(n){var t,a;if(400===(null===(t=n.response)||void 0===t?void 0:t.status))((null===(a=n.response.data)||void 0===a?void 0:a.detail)||"Invalid email or password").includes("verify your email")&&(u(!0),e(s.email),l("Please verify your email before logging in. Check your email for the verification code."))}}else await g()},[r,o,s.email,g,f,x]),b=(0,Y.useCallback)(()=>{i(!1),c(null),l(null)},[]);return{formData:s,setFormData:a,isLoading:x.isPending,error:n,setError:l,emailSubmitted:r,isCheckingSSO:m.isPending,ssoInfo:o,needsEmailVerification:d,handleInputChange:h,handleEmailChange:p,handleSubmit:v,resetEmailSubmitted:b}})(t,r),[y,N]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{a&&c({email:a,password:""})},[a,c]),(0,Y.useEffect)(()=>{const e=localStorage.getItem("lastUsedAuthMethod");N(e)},[]);return(0,se.jsx)("div",{className:"w-full space-y-4",children:s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($r,{className:"w-full h-10 sm:h-12 rounded-lg bg-slate-300"}),(0,se.jsx)($r,{className:"w-full h-10 sm:h-12 rounded-lg bg-slate-300"})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(fW,{buttonText:{default:"Log in with Google",loading:"Logging in..."},redirectUrl:t,showLastUsed:"google"===y,className:"w-full bg-gray-900 hover:bg-gray-800 hover:text-white text-white rounded-lg px-4 py-2.5 sm:py-3 flex items-center justify-center gap-2 transition-colors text-xs sm:text-sm border-0 h-auto",svgClassName:"w-4 h-4 sm:w-[18px] sm:h-[18px]"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,se.jsx)(Tr,{})}),(0,se.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,se.jsx)("span",{className:"bg-white px-2 text-slate-500",children:"Or"})})]}),g&&(0,se.jsxs)("div",{className:"p-3 text-xs sm:text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:["Please verify your email before logging in.",(0,se.jsx)("div",{className:"mt-2",children:(0,se.jsx)("button",{onClick:async()=>{if(o.email)try{await jd.resendOtp(o.email),l(o.email)}catch(u){m("Failed to resend verification code. Please try again.")}else m("Please enter your email address first.")},disabled:d,className:"text-orange-600 hover:text-orange-500 underline",children:"Resend verification code"})})]}),u&&u.includes("successfully")&&(0,se.jsx)("div",{className:"p-3 text-xs sm:text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:u}),(0,se.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b(l)},className:"space-y-4",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsx)("label",{htmlFor:"email",className:"text-xs sm:text-sm font-medium text-[#09090B]",children:"Email"}),(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(gW,{name:"email",type:"email",placeholder:"Enter your email address",value:o.email,onChange:v,required:!0,disabled:d||x,className:"bg-white text-[#09090B] h-9 px-3 py-1 rounded-md shadow-xs border border-[#E4E4E7] w-full text-xs sm:text-sm ".concat(x?"pr-12":"")}),x&&!h&&(0,se.jsx)("button",{type:"button",onClick:j,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs sm:text-sm font-medium text-[#71717A] hover:text-[#09090B] underline",children:"Edit"})]})]}),"email"===y&&!x&&(0,se.jsx)("div",{className:"absolute -top-2 right-0",children:(0,se.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-[#FF983B] text-white",children:"Last Used"})})]}),x&&!h&&(0,se.jsx)(se.Fragment,{children:null!=p&&p.has_sso?(0,se.jsxs)("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-md",children:[(0,se.jsxs)("p",{className:"text-xs sm:text-sm text-slate-800",children:["SSO is enabled for ",(0,se.jsx)("strong",{children:p.workspace_name})]}),(0,se.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Click below to continue with your organization's login"})]}):(0,se.jsxs)("div",{className:"space-y-2",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between",children:[(0,se.jsx)("label",{htmlFor:"password",className:"text-xs sm:text-sm font-medium text-[#09090B]",children:"Password"}),(0,se.jsx)("a",{href:"/forgot-password",className:"text-xs sm:text-sm font-medium text-[#71717A] hover:text-[#09090B]",children:"Forgot password?"})]}),(0,se.jsx)(gW,{name:"password",type:"password",placeholder:"Enter your password",value:o.password,onChange:f,required:!(null!=p&&p.has_sso),disabled:d,autoFocus:!0,className:"bg-white text-[#09090B] h-9 px-3 py-1 rounded-md shadow-xs text-xs sm:text-sm ".concat(u&&!g&&x?"border border-[#DC2626]":"border border-[#E4E4E7]")})]})}),u&&!g&&!u.includes("successfully")&&(0,se.jsx)("p",{className:"text-xs sm:text-sm text-[#DC2626] font-normal",children:u}),h&&(0,se.jsxs)("div",{className:"flex items-center justify-center gap-2 text-xs sm:text-sm text-gray-500",children:[(0,se.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500"}),"Checking authentication method..."]}),(0,se.jsxs)("div",{className:"space-y-3",children:[(0,se.jsx)(hW,{type:"submit",className:"w-full h-9 sm:h-10 bg-black text-white rounded-md text-xs sm:text-sm",disabled:d||h||!x&&!o.email,children:h?"Checking...":d?"Logging in...":x?null!=p&&p.has_sso?"Continue with ".concat(p.sso_provider||"SSO"):"Log In":"Continue"}),(0,se.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 text-center",children:["Don't have an account?"," ",(0,se.jsx)("button",{type:"button",onClick:n,className:"text-blue-600 hover:text-blue-700 underline font-medium",children:"Sign up"})]})]})]})]})})});LX.displayName="LoginForm";const MX=LX,RX=(0,Y.memo)(e=>{let{email:t,onBack:s,onSuccess:a,currentUrl:n}=e;const l=(0,Y.useRef)([]),{otp:r,otpErrors:i,otpValidationError:o,isLoading:c,error:d,handleOtpChange:u,handleKeyDown:m,handlePaste:x,handleSubmit:h,handleResendOtp:p}=(e=>{const[t,s]=(0,Y.useState)(["","","","","",""]),[a,n]=(0,Y.useState)([!1,!1,!1,!1,!1,!1]),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),u=(0,TX.n)({mutationFn:async e=>{let{email:s,otpCode:a}=e;const l=t.map(e=>!e);if(l.some(e=>e))throw n(l),r("Please fill out all fields."),new Error("Empty fields");return jd.verifyOtp(s,a)},onSuccess:(t,s)=>{if(t.success){if(pw("registration_completed",{email:(0,fw.sha256)(s.email),user_id:t.id,registration_method:"email&password"}),Cu(t.id),t.access_token){(0,ee.O5)(t.access_token);const s=Xc(e,"/");window.location.href=s}}else o("Invalid verification code. Please try again.")},onError:e=>{var t,s,a;"Empty fields"!==e.message&&(400===(null===(t=e.response)||void 0===t?void 0:t.status)||429===(null===(s=e.response)||void 0===s?void 0:s.status)?o((null===(a=e.response.data)||void 0===a?void 0:a.detail)||"Invalid verification code"):o("Verification failed. Please try again."))}}),m=(0,TX.n)({mutationFn:async e=>jd.resendOtp(e),onSuccess:()=>{d("New verification code sent to your email."),s(["","","","","",""])},onError:e=>{o("Failed to resend verification code. Please try again.")}}),x=(0,Y.useCallback)((e,t)=>{t.length>1||(s(s=>{const a=[...s];return a[e]=t,a}),t&&(n(t=>{const s=[...t];return s[e]=!1,s}),r(null)))},[]),h=(0,Y.useCallback)((e,s,a)=>{var n;"Backspace"===s.key&&!t[e]&&e>0&&(null===(n=a.current[e-1])||void 0===n||n.focus())},[t]),p=(0,Y.useCallback)((e,a)=>{e.preventDefault();const n=e.clipboardData.getData("text").slice(0,6),l=[...t];for(let t=0;t<n.length;t++)/^\d$/.test(n[t])&&(l[t]=n[t]);s(l);const r=l.findIndex(e=>!e);var i,o;-1!==r?null===(i=a.current[r])||void 0===i||i.focus():null===(o=a.current[5])||void 0===o||o.focus()},[t]),g=(0,Y.useCallback)(async(e,s)=>{o(null),r(null);try{const a=t.join("");(await u.mutateAsync({email:e,otpCode:a})).success&&s(e)}catch(a){}},[t,u]),f=(0,Y.useCallback)(async(e,t)=>{o(null),d(null);try{var s;await m.mutateAsync(e),null===(s=t.current[0])||void 0===s||s.focus()}catch(a){}},[m]),v=(0,Y.useCallback)(()=>{s(["","","","","",""]),n([!1,!1,!1,!1,!1,!1]),r(null),o(null),d(null)},[]);return{otp:t,otpErrors:a,otpValidationError:l,isLoading:u.isPending||m.isPending,error:i,setError:o,success:c,setSuccess:d,handleOtpChange:x,handleKeyDown:h,handlePaste:p,handleSubmit:g,handleResendOtp:f,resetOtp:v}})(n);(0,Y.useEffect)(()=>{var e;null===(e=l.current[0])||void 0===e||e.focus()},[]);return(0,se.jsxs)("div",{className:"w-full space-y-4 flex flex-col items-center",children:[(0,se.jsxs)("div",{className:"space-y-1 w-full",children:[(0,se.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 text-center",children:["We sent a verification code to ",t]}),(0,se.jsx)("button",{type:"button",onClick:s,className:"text-xs text-gray-500 hover:text-gray-700 transition-colors text-center w-full",children:"Wrong email? Change it"})]}),d&&(0,se.jsx)("div",{className:"p-3 text-xs sm:text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:d}),(0,se.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h(t,a)},className:"space-y-4 w-full",children:[(0,se.jsxs)("div",{className:"space-y-2 text-center",children:[(0,se.jsx)("label",{htmlFor:"otpCode",className:"text-xs sm:text-sm font-medium text-[#09090B]",children:"Verification Code"}),(0,se.jsx)("div",{className:"flex gap-1.5 sm:gap-2 justify-center",children:r.map((e,t)=>(0,se.jsx)(gW,{name:"otpCode".concat(t),type:"text",inputMode:"numeric",pattern:"\\d{1}",value:e,onChange:e=>u(t,e.target.value),onKeyDown:e=>m(t,e,l),onPaste:0===t?e=>x(e,l):void 0,disabled:c,className:"w-9 sm:w-11 h-9 sm:h-11 text-center text-base sm:text-lg font-semibold bg-white text-[#09090B] rounded-md shadow-xs ".concat(i[t]?"border border-[#DC2626]":"border border-[#E4E4E7] focus:border-slate-400 focus:ring-slate-400"),maxLength:1,ref:e=>l.current[t]=e},t))}),o&&(0,se.jsx)("p",{className:"text-xs sm:text-sm text-[#DC2626] font-normal",children:o})]}),(0,se.jsx)(hW,{type:"submit",className:"w-full h-9 sm:h-10 bg-black text-white rounded-md text-xs sm:text-sm",disabled:c,children:c?"Verifying...":"Verify Email"}),(0,se.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 text-center",children:["Didn't receive the code?"," ",(0,se.jsx)("button",{type:"button",onClick:()=>{p(t,l)},disabled:c,className:"font-medium text-black hover:text-slate-700 underline",children:"Resend email"})]})]})]})});RX.displayName="OtpForm";const DX=RX,FX=(0,Y.memo)(e=>{var t;let{isAuthLoading:s,prompt:a,platformVersion:n}=e;const l=(0,J.zy)(),r=new URLSearchParams(l.search),i="".concat(l.pathname).concat(l.search),o=r.get("ref"),[c,d]=(0,Y.useState)("register"),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(""),[p,g]=(0,Y.useState)(""),{data:f}=Xd({query:async()=>{if(!o)return null;const e=await FW.validateReferralCode(o);return{isValid:e.is_valid,referrerInfo:e.referrer,validationMessage:e.message}},onError:e=>{},enabled:!!o&&"register"===c,initialData:null},[o,c]),v=(0,Y.useCallback)(e=>{h(e),m(!0)},[]),b=(0,Y.useCallback)(()=>{m(!1),d("register")},[]),j=(0,Y.useCallback)(e=>{m(!1),d("login"),g(e)},[]),y=(0,Y.useCallback)(()=>{d("login"),g("")},[]),N=(0,Y.useCallback)(()=>{d("register"),g("")},[]),w=(0,Y.useCallback)(e=>{h(e),m(!0),d("register")},[]);return(0,se.jsx)("div",{className:"flex flex-col items-end gap-4 sm:gap-6 w-full max-w-xl px-4 sm:px-8 pt-6 sm:pt-8 pb-3 sm:pb-4 md:px-10 md:pt-10 md:pb-6",style:{borderRadius:"12px",background:"linear-gradient(180deg, rgba(255, 255, 255, 0.00) 60%, #D6E8FE 100%), rgba(255, 255, 255, 0.95)",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.10), 0 4px 6px -4px rgba(0, 0, 0, 0.10)"},children:(0,se.jsxs)("div",{className:"w-full flex flex-col items-center gap-6 sm:gap-8",children:[(0,se.jsxs)("div",{className:"flex flex-col items-center gap-1.5 sm:gap-2 w-full",children:[(0,se.jsxs)("h2",{className:"text-sm sm:text-base md:text-lg text-gray-800 text-center",children:["Building your app",(0,se.jsxs)("span",{className:"inline-flex items-end ml-0.5 gap-[1px]",children:[(0,se.jsx)("style",{children:"\n                @keyframes dotJump {\n                  0%, 60%, 100% { transform: translateY(0); }\n                  30% { transform: translateY(-0.4em); }\n                }\n                .dot-1 { animation: dotJump 1.4s infinite; }\n                .dot-2 { animation: dotJump 1.4s 0.2s infinite; }\n                .dot-3 { animation: dotJump 1.4s 0.4s infinite; }\n              "}),(0,se.jsx)("span",{className:"dot-1 inline-block",children:"."}),(0,se.jsx)("span",{className:"dot-2 inline-block",children:"."}),(0,se.jsx)("span",{className:"dot-3 inline-block",children:"."})]})]}),(0,se.jsx)("p",{className:"text-lg sm:text-xl md:text-2xl font-semibold text-gray-900 text-center",children:u?"Verify your email to continue":"register"===c?"Sign up to watch it come to life":"Log in to watch it come to life"})]}),u?(0,se.jsx)(DX,{email:x,onBack:b,onSuccess:j,currentUrl:i}):"register"===c?(0,se.jsx)(PX,{currentUrl:i,referralCode:o,referralIsValid:null!==(t=null==f?void 0:f.isValid)&&void 0!==t?t:null,isAuthLoading:s,onSuccess:v,onSwitchToLogin:y}):(0,se.jsx)(MX,{currentUrl:i,isAuthLoading:s,initialEmail:p,onSwitchToRegister:N,onNeedsVerification:w,prompt:a,platformVersion:n})]})})});FX.displayName="AuthModal";const OX=FX;function UX(e){let{isAuthLoading:t=!1,prompt:s,platformVersion:a}=e;return(0,se.jsxs)("div",{className:"relative flex flex-col h-full bg-slate-50",children:[(0,se.jsx)(EX,{}),(0,se.jsx)("div",{className:"absolute inset-0 bg-black/40 rounded-lg sm:rounded-xl m-2 sm:m-4"}),(0,se.jsx)("div",{className:"absolute inset-0 flex items-center justify-center font-base44 p-4",children:(0,se.jsx)(OX,{isAuthLoading:t,prompt:s,platformVersion:a})})]})}function BX(e){let{children:t}=e;return(0,se.jsx)(ap.Provider,{value:{app:{id:"preview",conversation:{id:"preview-conv"}}},children:t})}function zX(e){let{prompt:t}=e;const s=(0,Y.useMemo)(()=>({id:"preview-conv",model:"",messages:[{id:"1",role:"user",content:t,created_at:(new Date).toISOString(),type:"text",metadata:{}},{id:"2",role:"assistant",content:"I'm building your app now! Creating the layout, pages, and features...\n\n**Sign up to see your app!**",created_at:(new Date).toISOString(),type:"text",metadata:{}}]}),[t]);return(0,Y.useEffect)(()=>{gu.setState(s)},[s]),(0,se.jsx)(Nd,{children:(0,se.jsx)(BX,{children:(0,se.jsx)("div",{className:"h-full flex flex-col",children:(0,se.jsx)(yI,{status:{state:"processing"},addMessage:async()=>{},undoMessage:()=>{},onStop:()=>{},isDisabled:!0,placeholder:"Sign up to start building...",suggestions:null,isOutOfCredits:!1,currentUsage:null,billingStats:null})})})})}function HX(e){let{onToggleVersions:t,showVersions:s}=e;return(0,se.jsx)("div",{className:"py-1.5 px-1 flex items-center bg-slate-50 relative z-10 shadow-[0_10px_23px_rgba(248,250,252,252.15)]",children:(0,se.jsx)("div",{className:"flex items-center gap-3 flex-1",children:(0,se.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[(0,se.jsx)("img",{src:Wx,alt:"Logo",className:"h-8 w-8"}),(0,se.jsx)("span",{className:"text-sm font-semibold text-slate-900 animate-[pulse_1.5s_ease-in-out_infinite]",children:"Building your app..."})]})})})}const VX=new Q.E;function WX(){const e=(0,J.zy)(),t=(0,J.Zp)(),s=new URLSearchParams(e.search),a=s.get("prompt")||"",n=s.get("app_platform_version"),l=uo(),{isAuthenticated:r,isLoadingAuth:i,user:o}=wd(),[c,d]=(0,Y.useState)(null),{isNativeMobile:u,actions:m}=fd();return(0,Y.useEffect)(()=>{if(!i&&!r){const e="sign_up",t={user_id:r&&null!=o&&o.id?o.id:null,app_id:null,conversation_id:null};Hu(t,{page_name:e}),Tu("Page View",{page_name:e,page_url:window.location.pathname,user_id:t.user_id})}},[i,r,o]),(0,Y.useEffect)(()=>{!async function(){if(!i&&r&&a)try{const e={status:{state:"processing",details:"Starting conversation..."}};n&&(e.platform_version=parseInt(n,10));const s=await zc.create(e);u?(Gh(s.id,{content:a},null==o?void 0:o.id,{from_mobile:!0}),await m.addAppProcess({appId:s.id,appName:s.name})):t("/apps/".concat(s.id,"/editor/preview"),{state:{initialPrompt:a}})}catch(e){d(e.message||"Error creating app")}}()},[i,r,a,n,t,u,m]),i||!i&&r?null:c?(0,se.jsx)("div",{className:"flex items-center justify-center h-screen bg-slate-50",children:(0,se.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,se.jsx)("span",{children:c})})}):(0,se.jsx)(X.Ht,{client:VX,children:l?(0,se.jsx)(YX,{prompt:a,isAuthLoading:i}):(0,se.jsx)(qX,{prompt:a,isAuthLoading:i})})}function qX(e){let{prompt:t,isAuthLoading:s}=e;const[a,n]=(0,Y.useState)(!1),l=new URLSearchParams(window.location.search).get("app_platform_version")||void 0;return(0,se.jsx)("div",{className:"flex flex-row h-screen bg-slate-50",children:(0,se.jsxs)(ZF,{direction:"horizontal",children:[(0,se.jsx)(JF,{defaultSize:24,minSize:20,maxSize:40,className:"h-full overflow-hidden relative",style:{minWidth:"250px"},children:(0,se.jsxs)("div",{className:"flex flex-col h-full",children:[(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsx)(HX,{onToggleVersions:()=>n(e=>!e),showVersions:a})}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,se.jsx)(zX,{prompt:t})})]})}),(0,se.jsx)(QF,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,se.jsx)(JF,{defaultSize:76,className:"flex-1 overflow-auto",children:(0,se.jsx)(UX,{isAuthLoading:s,prompt:t,platformVersion:l})})]})})}function YX(e){let{prompt:t,isAuthLoading:s}=e;const[a,n]=(0,Y.useState)(!1),l=new URLSearchParams(window.location.search).get("app_platform_version")||void 0;return(0,se.jsxs)("div",{className:"flex flex-col h-screen bg-slate-50",children:[(0,se.jsx)("div",{className:"flex-shrink-0",children:(0,se.jsx)(HX,{onToggleVersions:()=>n(e=>!e),showVersions:a})}),(0,se.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,se.jsx)(UX,{isAuthLoading:s,prompt:t,platformVersion:l})})]})}function GX(){const{provider:e}=(0,J.g)(),[t]=(0,Z.useSearchParams)(),s=(0,J.Zp)(),[a,n]=(0,Y.useState)("Processing..."),[l,r]=(0,Y.useState)(null);return(0,Y.useEffect)(()=>{const a=t.get("status"),l=t.get("message"),i="success"===a;r(i),n(i?"Connected successfully!":l||"Connection failed"),window.opener&&!window.opener.closed?(window.opener.postMessage({type:"oauth_result",provider:e||"unknown",status:i?"success":"error",message:l||void 0},window.location.origin),setTimeout(()=>{window.close()},1e3)):setTimeout(()=>{s("/settings?tab=account",{replace:!0})},2e3)},[t,s,e]),(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:(0,se.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-sm w-full mx-4 text-center",children:null===l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ac.A,{className:"w-12 h-12 mx-auto mb-4 text-slate-400 animate-spin"}),(0,se.jsx)("p",{className:"text-slate-600",children:a})]}):l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(hb.A,{className:"w-12 h-12 mx-auto mb-4 text-emerald-500"}),(0,se.jsx)("p",{className:"text-slate-900 font-medium",children:a}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:"This window will close automatically..."})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Uy.A,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),(0,se.jsx)("p",{className:"text-slate-900 font-medium",children:"Connection Failed"}),(0,se.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:a}),(0,se.jsx)("p",{className:"text-sm text-slate-400 mt-4",children:"This window will close automatically..."})]})})})}function KX(e){var t,s;const a=e;return"string"==typeof(null==a||null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.error)}function $X(e){var t,s;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"An error occurred";const n=null===(t=e.response)||void 0===t?void 0:t.data;return(null==n||null===(s=n.detail)||void 0===s?void 0:s.error_description)||(null==n?void 0:n.error_description)||e.message||a}class ZX extends te.H{getBaseURL(){return(0,fe.wE)()+"/oauth"}async verifyDevice(e){return this.axios.post("/device/verify",{user_code:e})}async consent(e){return this.axios.post("/consent",{mcp_oauth_context:e})}async cancel(e){return this.axios.post("/cancel",{mcp_oauth_context:e})}}const JX=new ZX,QX=()=>(0,se.jsx)("div",{className:"w-10 h-10 bg-black rounded-full flex items-center justify-center",children:(0,se.jsx)("svg",{viewBox:"0 0 24 24",className:"w-6 h-6 text-white",fill:"currentColor",children:(0,se.jsx)("path",{d:"M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"})})}),XX={"apps:read":{title:"View your apps",description:"See a list of your apps and their details"},"apps:write":{title:"Create and modify apps",description:"Create new apps and make changes to existing ones"},offline:{title:"Access your account offline",description:"Stay connected even when you're not actively using the app"},"entities:read":{title:"View your data",description:"See your app data and entities"},"entities:write":{title:"Modify your data",description:"Create, update, and delete your app data"}};const e0=()=>{var e;const[t,s]=(0,Y.useState)(!1),[a,n]=(0,Y.useState)(null),[l,r]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),[u,m]=(0,Y.useState)(!0),x=(0,J.Zp)(),h=(0,J.zy)(),{user:p,isAuthenticated:g,isLoadingAuth:f,reloadUser:v,logout:b}=wd();(0,Y.useEffect)(()=>{const e=new URLSearchParams(h.search),t=e.get("mcp_oauth_context"),s=e.get("token");if(s){(0,ee.O5)(s),d(s),e.delete("token");const t=e.toString();window.history.replaceState({},"","".concat(h.pathname).concat(t?"?".concat(t):"")),null==v||v()}if(!t)return n("Missing OAuth context. Please try connecting again."),void m(!1);try{const e=JSON.parse(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");const s=t.length%4;return s&&(t+="=".repeat(4-s)),atob(t)}(t));r(e),o(t)}catch(a){n("Invalid OAuth context. Please try connecting again.")}setTimeout(()=>m(!1),500)},[h.search,v,h.pathname]),(0,Y.useEffect)(()=>{if(!u&&!f&&!g&&!c&&l){const e=new URLSearchParams(h.search);x("/login?".concat(e.toString()))}},[u,f,g,c,l,x,h.search]);const j=(null==l||null===(e=l.scope)||void 0===e?void 0:e.split(" "))||[],y=["apps:write","apps:read",...j.filter(e=>!["apps:write","apps:read"].includes(e))].filter(e=>j.includes(e)).map(e=>XX[e]).filter(Boolean);return a&&!l?(0,se.jsx)("div",{className:"min-h-screen bg-stone-100 flex items-center justify-center p-4",children:(0,se.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 max-w-md w-full text-center",children:[(0,se.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(la.A,{className:"w-8 h-8 text-red-600"})}),(0,se.jsx)("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),(0,se.jsx)("p",{className:"text-gray-600 mb-6",children:a}),(0,se.jsx)(hW,{onClick:()=>x("/"),variant:"outline",children:"Go to Home"})]})}):u||f||!g&&c||!p||!l?(0,se.jsx)("div",{className:"min-h-screen bg-stone-100 flex items-center justify-center",children:(0,se.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):(0,se.jsxs)("div",{className:"min-h-screen bg-stone-100 flex flex-col",children:[(0,se.jsx)("header",{className:"px-10 py-6",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",className:"h-8"})}),(0,se.jsx)("main",{className:"flex-1 flex items-center justify-center px-4 pb-16",children:(0,se.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 w-full max-w-[460px] overflow-hidden",children:(0,se.jsxs)("div",{className:"p-8 pb-8 flex flex-col gap-6",children:[(0,se.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,se.jsx)(QX,{}),(0,se.jsx)(Ws.A,{className:"w-6 h-6 text-gray-400"}),(0,se.jsx)("img",{src:"/logo_v3.png",alt:"Base44",className:"w-10 h-10"})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsx)("h1",{className:"text-xl font-semibold text-gray-950",children:"ChatGPT would like to access your Base44 account"}),(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsx)("p",{className:"text-sm text-gray-500",children:"This will allow ChatGPT to:"}),(0,se.jsx)("div",{className:"flex flex-col gap-4",children:y.map((e,t)=>(0,se.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,se.jsx)("div",{className:"w-6 h-6 flex items-center justify-center flex-shrink-0",children:(0,se.jsx)(Ds.A,{className:"w-4 h-4 text-green-500",strokeWidth:3})}),(0,se.jsxs)("div",{className:"flex flex-col gap-1 flex-1",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-black leading-none",children:e.title}),(0,se.jsx)("p",{className:"text-sm text-gray-500 leading-none",children:e.description})]})]},t))})]}),(0,se.jsxs)("div",{className:"flex flex-col",children:[a&&(0,se.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,se.jsx)("p",{className:"text-sm text-red-600",children:a})}),(0,se.jsxs)("div",{className:"flex gap-3 py-6",children:[(0,se.jsx)(hW,{variant:"outline",className:"flex-1 h-10 rounded-lg border-gray-200 bg-white text-gray-900 font-medium shadow-sm hover:bg-gray-50",onClick:async()=>{if(i){s(!0),n(null);try{const e=await JX.cancel(i);window.location.href=e.redirect_url}catch(e){if(KX(e));x("/")}}else x("/")},disabled:t,children:"Cancel"}),(0,se.jsx)(hW,{className:"flex-1 h-10 rounded-lg bg-gray-900 text-white font-medium shadow-sm hover:bg-gray-800",onClick:async()=>{if(l&&p&&i){s(!0),n(null);try{const e=await JX.consent(i);window.location.href=e.redirect_url}catch(e){KX(e)?n($X(e)):n("An error occurred. Please try again."),s(!1)}}},disabled:t,children:t?"Authorizing...":"Allow"})]}),(0,se.jsxs)("div",{className:"border-t border-gray-200 pt-6 flex flex-col gap-2 items-center",children:[(0,se.jsxs)("p",{className:"text-sm text-gray-500",children:["Logged in as ",p.email]}),(0,se.jsx)("button",{onClick:()=>{b(!1);const e=new URLSearchParams(window.location.search);window.location.href="/login?".concat(e.toString())},className:"text-sm text-black underline hover:text-gray-700",children:"Switch account"})]})]})]})]})})})]})},t0=()=>{const[e,t]=(0,Y.useState)(["","","","","","","",""]),[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!1),o=(0,Y.useRef)([]),{user:c}=wd(),d=(s,a)=>{const n=a.toUpperCase().slice(-1);if(n&&!/^[A-Z]$/.test(n))return;const r=[...e];var i;(r[s]=n,t(r),l(null),n&&s<7)&&(null===(i=o.current[s+1])||void 0===i||i.focus())},u=(t,s)=>{var a;"Backspace"===s.key&&!e[t]&&t>0&&(null===(a=o.current[t-1])||void 0===a||a.focus())},m=e=>{e.preventDefault();const s=e.clipboardData.getData("text").toUpperCase().replace(/-/g,"").replace(/\s/g,"").slice(0,8).split(""),a=["","","","","","","",""];s.forEach((e,t)=>{/^[A-Z]$/.test(e)&&(a[t]=e)}),t(a);const n=a.findIndex(e=>!e);var l,r;-1===n?null===(l=o.current[7])||void 0===l||l.focus():null===(r=o.current[n])||void 0===r||r.focus()},x=async()=>{const t="".concat(e.slice(0,4).join(""),"-").concat(e.slice(4).join(""));if(e.some(e=>!e))l("Please enter the complete code");else{a(!0),l(null);try{await JX.verifyDevice(t),i(!0)}catch(s){KX(s)?l($X(s)):l("An error occurred. Please try again.")}finally{a(!1)}}};if(r)return(0,se.jsxs)("div",{className:"min-h-screen bg-stone-100 flex flex-col",children:[(0,se.jsx)("header",{className:"px-10 py-6",children:(0,se.jsx)(Z.Link,{to:"/",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",className:"h-8"})})}),(0,se.jsx)("main",{className:"flex-1 flex items-center justify-center px-4 pb-16",children:(0,se.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 w-full max-w-[460px] overflow-hidden",children:(0,se.jsxs)("div",{className:"p-8 flex flex-col gap-6 items-center text-center",children:[(0,se.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:(0,se.jsx)(Ds.A,{className:"w-8 h-8 text-green-600",strokeWidth:2.5})}),(0,se.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,se.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Device Authorized"}),(0,se.jsx)("p",{className:"text-gray-600",children:"You can close this window and return to your terminal or device."})]})]})})})]});return(0,se.jsxs)("div",{className:"min-h-screen bg-stone-100 flex flex-col",children:[(0,se.jsx)("header",{className:"px-10 py-6",children:(0,se.jsx)(Z.Link,{to:"/",children:(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",className:"h-8"})})}),(0,se.jsx)("main",{className:"flex-1 flex items-center justify-center px-4 pb-16",children:(0,se.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 w-full max-w-[460px] overflow-hidden",children:(0,se.jsxs)("div",{className:"p-8 flex flex-col gap-6",onKeyDown:t=>{"Enter"!==t.key||e.some(e=>!e)||s||x()},children:[(0,se.jsx)("div",{className:"flex items-center justify-center",children:(0,se.jsx)("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center",children:(0,se.jsx)(Hy.A,{className:"w-6 h-6 text-slate-600"})})}),(0,se.jsxs)("div",{className:"flex flex-col gap-2 text-center",children:[(0,se.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Authorize Device"}),c&&(0,se.jsxs)("p",{className:"text-sm text-gray-500",children:["Logged in as ",c.email]})]}),(0,se.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,se.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"Enter the code shown in your terminal or device. Do not use a code shared by someone else."}),(0,se.jsxs)("div",{className:"flex justify-center items-center gap-1",children:[e.slice(0,4).map((e,t)=>(0,se.jsx)("input",{ref:e=>{o.current[t]=e},type:"text",maxLength:1,value:e,onChange:e=>d(t,e.target.value),onKeyDown:e=>u(t,e),onPaste:m,className:"w-11 h-14 text-center text-xl font-mono font-semibold border border-gray-300 rounded-lg focus:border-orange-500 focus:ring-2 focus:ring-orange-500/20 outline-none transition-all",autoFocus:0===t},t)),(0,se.jsx)("span",{className:"text-2xl text-gray-400 mx-1",children:"-"}),e.slice(4).map((e,t)=>(0,se.jsx)("input",{ref:e=>{o.current[t+4]=e},type:"text",maxLength:1,value:e,onChange:e=>d(t+4,e.target.value),onKeyDown:e=>u(t+4,e),onPaste:m,className:"w-11 h-14 text-center text-xl font-mono font-semibold border border-gray-300 rounded-lg focus:border-orange-500 focus:ring-2 focus:ring-orange-500/20 outline-none transition-all"},t+4))]}),(0,se.jsx)(hW,{className:"w-full h-10 rounded-lg bg-gray-900 text-white font-medium shadow-sm hover:bg-gray-800",onClick:x,disabled:s||e.some(e=>!e),children:s?"Authorizing...":"Continue"}),n&&(0,se.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,se.jsx)(la.A,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-sm text-red-600",children:n})]})]}),(0,se.jsx)("div",{className:"border-t border-gray-200 pt-6 text-center",children:(0,se.jsx)("p",{className:"text-sm text-gray-500",children:"Base44 staff will never give you a code to enter on this page."})})]})})})]})};function s0(){const{fileId:e}=(0,J.g)();window.location.href="".concat((0,fe.wE)(),"/api/files/").concat(e)}function a0(e){let{url:t}=e;window.location.href=t}function n0(e){let{urlChangeHandler:t}=e;const s=(0,J.g)(),a=window.location.pathname,n=t(a,s);return n!==a&&(window.location.href=n),(0,se.jsx)("div",{children:"Loading..."})}const l0=[{name:"Home",url:"/",component:(0,se.jsx)(gv,{}),icon:(0,se.jsx)($v.A,{})},{name:"Login",url:"/login",component:(0,se.jsx)(kW,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"Register",url:"/register",component:(0,se.jsx)(qW,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"VerifyEmail",url:"/verify-email",component:(0,se.jsx)(YW,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"ForgotPassword",url:"/forgot-password",component:(0,se.jsx)(GW,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"CheckEmail",url:"/check-email",component:(0,se.jsx)(KW,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"ResetPassword",url:"/reset-password",component:(0,se.jsx)($W,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"PrivacyPolicy",url:"/privacy-policy",component:(0,se.jsx)(a0,{url:"https://base44.com/privacy-policy"}),requiresAuth:!1,hide:!0},{name:"TermsOfService",url:"/terms-of-service",component:(0,se.jsx)(a0,{url:"https://base44.com/terms-of-service"}),requiresAuth:!1,hide:!0},{name:"ResponsibleUse",url:"/responsible-use-policy",component:(0,se.jsx)(uq,{}),requiresAuth:!1,hide:!0},{name:"File",url:"/api/files/:fileId",component:(0,se.jsx)(s0,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"App Preview",url:"/app_preview",component:(0,se.jsx)(kX,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"Image Test",url:"/img-test",component:(0,se.jsx)(AX,{}),hide:!0},{name:"Build Preview",url:"/build",component:(0,se.jsx)(WX,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"OAuth Callback",url:"/oauth/:provider/callback",component:(0,se.jsx)(GX,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"OAuth Consent",url:"/oauth/consent",component:(0,se.jsx)(e0,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"Device Authorization",url:"/login/device",component:(0,se.jsx)(t0,{}),requiresAuth:!0,usesLayout:!1,hide:!0},{name:"User Apps",url:"/user-apps/:appId/show/:pageName?",component:(0,se.jsx)(n0,{urlChangeHandler:e=>e.replace("/user-apps/","/apps/")}),icon:(0,se.jsx)(Zv.A,{}),showInMenu:!1,requiresAuth:!1},{name:"Scheduled Tasks Redirect",url:"/apps/:appId/editor/workspace/scheduled-tasks",component:(0,se.jsx)(n0,{urlChangeHandler:e=>e.replace("/scheduled-tasks","/automations")}),hide:!0},{name:"User Apps",url:"/apps",component:(0,se.jsx)(Kv,{}),icon:(0,se.jsx)(Zv.A,{}),children:[{name:"User App Dashboard",url:"/apps/:appId",component:(0,se.jsx)(vH,{view:"workspace"}),icon:(0,se.jsx)(Zv.A,{}),usesLayout:!1},{name:"App Show",url:"/apps-show/:appSlug/:pageName?",component:(0,se.jsx)(n0,{urlChangeHandler:(e,t)=>{const s=t.appSlug,a=t.pageName,n=window.location.host;return"https://".concat(s,".").concat(n,"/").concat(a||"")}}),icon:(0,se.jsx)(Jv.A,{}),usesLayout:!1,requiresAuth:!1},{name:"Edit User App",url:"/apps/:appId/editor/preview/:pageName",component:(0,se.jsx)(vH,{view:"preview"}),icon:(0,se.jsx)(Qv.A,{}),usesLayout:!1},{name:"Remix User App",url:"/remix-app/:appId",component:(0,se.jsx)(Uq,{}),icon:(0,se.jsx)(Qv.A,{})},{name:"Edit User App",url:"/apps/:appId/dashboard",component:(0,se.jsx)(vH,{view:"workspace"}),icon:(0,se.jsx)(Qv.A,{}),usesLayout:!1},{name:"Edit User App",url:"/apps/:appId/editor/preview",component:(0,se.jsx)(vH,{view:"preview"}),icon:(0,se.jsx)(Qv.A,{}),usesLayout:!1},{name:"Edit User App",url:"/apps/:appId/editor/workspace/:workspaceView",component:(0,se.jsx)(vH,{view:"workspace"}),icon:(0,se.jsx)(Qv.A,{}),usesLayout:!1},{name:"Create App",url:"/create-app",component:(0,se.jsx)(bH,{}),icon:(0,se.jsx)(op.A,{})}]},{name:"Billing",url:"/billing",component:(0,se.jsx)(l_,{}),icon:(0,se.jsx)(su.A,{}),hide:!0},{name:"Support",url:"/support",component:(0,se.jsx)(Yq,{})},{name:"My Tickets",url:"/support/conversations",component:(0,se.jsx)(bG,{})},{name:"Admin Support Tickets",url:"/support/admin/conversations",component:(0,se.jsx)(YG,{}),usesLayout:!1},{name:"Admin Support Docs",url:"/support/admin/agent-backoffice",component:(0,se.jsx)(nK,{})},{name:"Admin Analytics",url:"/support/admin/analytics",component:(0,se.jsx)(PJ,{})},{name:"Admin Portal",url:"/admin",component:(0,se.jsx)(uW,{}),icon:(0,se.jsx)(Xv.A,{}),hide:!0},{name:"User Management",url:"/user-management",component:(0,se.jsx)(gV,{}),icon:(0,se.jsx)(eb.A,{}),hide:!0},{name:"Complex Apps",url:"/admin/complex-apps",component:(0,se.jsx)(jV,{}),icon:(0,se.jsx)(Xv.A,{}),hide:!0},{name:"Sandbox Management",url:"/admin/sandboxes",component:(0,se.jsx)(SV,{}),icon:(0,se.jsx)(Xv.A,{}),hide:!0},{name:"App Templates Management",url:"/app-templates-management",component:(0,se.jsx)(MJ,{}),icon:(0,se.jsx)(eb.A,{}),hide:!0},{name:"App Template Marketplace Admin",url:"/admin/app-template-marketplace",component:(0,se.jsx)(JJ,{}),icon:(0,se.jsx)(eb.A,{}),hide:!0},{name:"Status Banner Controls",url:"/admin/status-banner-controls",component:(0,se.jsx)(_Q,{}),hide:!0},{name:"Integration Management",url:"/integration-management",component:(0,se.jsx)(DJ,{}),icon:(0,se.jsx)(tb.A,{}),hide:!0},{name:"Integrations Catalog",url:"/integrations-catalog",component:(0,se.jsx)(_q,{}),icon:(0,se.jsx)(tb.A,{}),children:[{name:"Integrations Catalog Item",url:"/integrations-catalog/item/:itemId",component:(0,se.jsx)(Cq,{})},{name:"Integration Editor",url:"/integrations-catalog/editor/:itemId?",component:(0,se.jsx)(Tq,{})}]},{name:"App Templates",url:"/app-templates",component:(0,se.jsx)(Lq,{}),icon:(0,se.jsx)(Zv.A,{}),children:[{name:"Template Detail",url:"/app-templates/:templateId",component:(0,se.jsx)(Lq,{})},{name:"Manage Listing",url:"/app-templates/manage-listing/:appId",component:(0,se.jsx)(hR,{})}]},{name:"Partners Catalog",url:"/partners",component:(0,se.jsx)(NX,{}),icon:(0,se.jsx)(eb.A,{}),children:[{name:"Partner Contact",url:"/partners/:partnerId",component:(0,se.jsx)(NX,{})}]},{name:"Partners Terms",url:"/partners/terms",component:(0,se.jsx)(wX,{}),requiresAuth:!1,hide:!0},{name:"Marketplace Terms",url:"/marketplace/terms",component:(0,se.jsx)(_X,{}),requiresAuth:!1,hide:!0},{name:"Partner Admin",url:"/admin/partners",component:(0,se.jsx)(WQ,{}),icon:(0,se.jsx)(eb.A,{}),hide:!0},{name:"Analytics",url:"/admin/analytics",component:(0,se.jsx)(bV,{}),icon:(0,se.jsx)(Xv.A,{}),hide:!0},{name:"Stripe",url:"/integrations/stripe",component:(0,se.jsx)(dq,{}),icon:(0,se.jsx)(su.A,{}),hide:!0},{name:"Workspace Settings",url:"/workspace/:workspaceId/settings/:sectionName",component:(0,se.jsx)(vJ,{}),hide:!0},{name:"Workspace Settings",url:"/workspace/:workspaceId/settings",component:(0,se.jsx)(vJ,{}),hide:!0},{name:"Workspace Settings Redirect",url:"/workspace/:workspaceId",component:(0,se.jsx)(vJ,{}),hide:!0},{name:"Create Workspace",url:"/create-workspace",component:(0,se.jsx)(kZ,{}),hide:!0},{name:"Accept Invitation",url:"/invite/accept",component:(0,se.jsx)(jJ,{}),hide:!0,usesLayout:!1,requiresAuth:!0},{name:"Accept Ownership",url:"/ownership/accept",component:(0,se.jsx)(AJ,{}),hide:!0,usesLayout:!1,requiresAuth:!0},{name:"NotFound",url:"*",component:(0,se.jsx)(JW,{}),hide:!0,usesLayout:!1,requiresAuth:!1}];var r0=s(78602),i0=s(30772);function o0(e){let{isMobile:t=!1,onItemClick:s}=e;const a=(0,J.Zp)(),n=(0,J.zy)(),{workspaces:l,isLoadingWorkspaces:r,activeWorkspace:i,switchActiveWorkspace:o}=qd(),{isNativeMobile:c,navigation:d,actions:u}=fd(),m=e=>{if((null==i?void 0:i.id)===e.id)return void(s&&s());o(e),c&&d.dismissOverlay();const t=n.pathname.match(/^\/workspace\/([^/]+)(.*)/);if(t){const s=t[2]||"";a("/workspace/".concat(e.id).concat(s))}s&&s()},x=e=>{o(e);const t=e.user_role||e.role||"member",n=e.is_personal||["owner","admin"].includes(t)?"seats-members":"account";a("/workspace/".concat(e.id,"/settings/").concat(n)),s&&s()},h=async()=>{c?u.onItemClicked({id:"user-menu.createWorkspace"}):a("/create-workspace"),s&&s()};return t?(0,se.jsxs)("div",{className:"p-1",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between px-4 py-2",children:[(0,se.jsx)("div",{className:"text-sm font-medium text-gray-900 font-base44 p-0",children:"Workspaces"}),(l?l.filter(e=>!e.is_personal).length:0)>=3?null:(0,se.jsx)("button",{onClick:h,className:"flex items-center justify-center w-6 h-6 bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded-lg transition-colors",title:"Create a Workspace",children:(0,se.jsx)(op.A,{className:"h-3 w-3 text-gray-600"})})]}),r?(0,se.jsxs)("div",{className:"px-4 py-3 flex items-center justify-center",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-gray-400"}),(0,se.jsx)("span",{className:"ml-2 text-sm text-gray-500 font-base44",children:"Loading..."})]}):l.length>0?(0,se.jsx)("div",{className:"space-y-1",children:l.map(e=>(0,se.jsxs)("button",{onClick:()=>m(e),className:"cursor-pointer flex items-center justify-between px-4 py-4 hover:bg-gray-50 rounded-lg font-base44 w-full group ".concat((null==i?void 0:i.id)===e.id?"bg-orange-50 border-l-2 border-orange-500 text-orange-600 hover:bg-orange-300":"border-l-2 border-transparent"),children:[(0,se.jsx)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:(0,se.jsxs)("div",{className:"min-w-0 flex-1 text-left",children:[(0,se.jsx)("div",{className:"truncate text-base font-light ".concat((null==i?void 0:i.id)===e.id?"text-orange-600":"text-gray-900"),children:e.is_personal?"My Workspace":"".concat(e.name.charAt(0).toUpperCase()+e.name.slice(1)," Workspace")}),e.domain&&!e.is_personal&&(0,se.jsx)("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:e.domain})]})}),(0,se.jsx)("div",{className:"flex items-center gap-1 flex-shrink-0",children:(0,se.jsx)("button",{onClick:t=>{t.stopPropagation(),x(e)},className:"px-2 py-1 hover:bg-gray-200 hover:shadow-sm rounded-lg transition-all opacity-0 group-hover:opacity-100 text-xs text-gray-600 hover:text-gray-800",title:"Manage Workspace",children:"Manage"})})]},e.id))}):(0,se.jsx)("div",{className:"px-4 py-3",children:(0,se.jsx)("div",{className:"text-sm text-gray-500 text-center font-base44",children:"No workspaces found"})})]}):(0,se.jsxs)("div",{className:"p-1",children:[(0,se.jsxs)("div",{className:"flex items-center justify-between px-4 py-2",children:[(0,se.jsx)(Ln,{className:"text-sm font-medium text-gray-900 font-base44 p-0",children:"Workspaces"}),(l?l.filter(e=>!e.is_personal).length:0)>=3?null:(0,se.jsx)("button",{onClick:h,className:"flex items-center justify-center w-6 h-6 bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded-lg transition-colors",title:"Create a Workspace",children:(0,se.jsx)(op.A,{className:"h-3 w-3 text-gray-600"})})]}),r?(0,se.jsxs)("div",{className:"px-4 py-3 flex items-center justify-center",children:[(0,se.jsx)(Ac.A,{className:"h-4 w-4 animate-spin text-gray-400"}),(0,se.jsx)("span",{className:"ml-2 text-sm text-gray-500 font-base44",children:"Loading..."})]}):l.length>0?(0,se.jsx)("div",{className:"space-y-1",children:l.map(e=>(0,se.jsxs)(Tn,{onClick:()=>m(e),className:"cursor-pointer flex items-center justify-between px-4 py-2 rounded-lg font-base44 group ".concat((null==i?void 0:i.id)===e.id?"bg-orange-50 border-l-2 border-orange-500 text-orange-600 hover:bg-orange-100":"border-l-2 border-transparent"),children:[(0,se.jsx)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:(0,se.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,se.jsx)("div",{className:"truncate text-sm font-light ".concat((null==i?void 0:i.id)===e.id?"text-orange-600":"text-gray-900"),children:e.is_personal?"My Workspace":"".concat(e.name.charAt(0).toUpperCase()+e.name.slice(1)," Workspace")}),e.domain&&!e.is_personal&&(0,se.jsx)("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:e.domain})]})}),(0,se.jsx)("div",{className:"flex items-center gap-1 flex-shrink-0",children:(0,se.jsx)("button",{onClick:t=>{t.stopPropagation(),x(e)},className:"px-2 py-1 hover:bg-gray-200 hover:shadow-sm rounded-lg transition-all opacity-0 group-hover:opacity-100 text-xs text-gray-600 hover:text-gray-800",title:"Manage Workspace",children:"Manage"})})]},e.id))}):(0,se.jsx)("div",{className:"px-4 py-3",children:(0,se.jsx)("div",{className:"text-sm text-gray-500 text-center font-base44",children:"No workspaces found"})})]})}var c0=s(7425);function d0(e){let{user:t,activeWorkspace:s,onSettingsClick:a,isSettingsDisabled:n,onReferralClick:l,onBillingClick:r,onAffiliateClick:i,onIntegrationsClick:o,onPartnersClick:c,onDocsAndSupportClick:d,onAboutClick:u,onLogout:m,onItemClick:x,closeMenuOnItemClick:h=!0,className:p=""}=e;const{isNativeMobile:g,platform:f}=fd(),[v,b]=(0,Y.useState)(void 0),j=e=>{null==e||e(),h&&(null==x||x())};(0,Y.useEffect)(()=>{g&&f.os().then(b)},[g,f]);const y=[{key:"settings",icon:(0,se.jsx)(vP.A,{size:18,className:"text-gray-800"}),label:"Settings",onClick:()=>j(a),disabled:n},{key:"referrals",icon:(0,se.jsx)(Bz.A,{size:18,className:"text-gray-800"}),label:"Refer Friends",onClick:()=>j(l)}];"ios"!==v&&y.push({key:"billing",icon:(0,se.jsx)(su.A,{size:18,className:"text-gray-800"}),label:"Billing",onClick:()=>j(r)});const N=[{key:"integrations",icon:(0,se.jsx)(c0.A,{size:18,className:"text-gray-800"}),label:"Integrations",onClick:()=>j(o)},{key:"partners",icon:(0,se.jsx)(eb.A,{size:18,className:"text-gray-800"}),label:"Hire a Partner",onClick:()=>j(c)},{key:"docs-support",icon:(0,se.jsx)(Pj.A,{size:18,className:"text-gray-800"}),label:"Docs & Support",onClick:()=>j(d)},{key:"about",icon:(0,se.jsx)(Oy.A,{size:18,className:"text-gray-800"}),label:"About the app",onClick:()=>j(u)}],w=[...g?N:[],{key:"affiliates",icon:(0,se.jsx)(r0.A,{size:18,className:"text-gray-800"}),label:"Become an Affiliate!",onClick:()=>j(i)},{key:"logout",icon:(0,se.jsx)(zz.A,{size:18}),label:"Sign Out",onClick:()=>j(m),isDestructive:!0}];return(0,se.jsxs)("div",{className:"flex flex-col h-full ".concat(p),children:[t&&(0,se.jsx)("div",{className:"px-6 py-6 border-b border-gray-100",children:(0,se.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsx)(WZ,{size:"lg"}),s&&!s.is_personal&&(0,se.jsx)("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-orange-500 border-2 border-white rounded-full"})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"font-semibold text-lg text-gray-900 font-base44",children:(_=t.full_name,_?_.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"")}),(0,se.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:t.email})]})]})}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto scrollbar-auto-hide",children:[(0,se.jsx)("div",{className:"py-2",children:y.map(e=>(0,se.jsxs)("button",{onClick:e.onClick,disabled:e.disabled,className:"w-full flex items-center px-6 py-2 transition-colors font-base44 ".concat(e.disabled?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"),children:[(0,se.jsx)("span",{className:"text-gray-600",children:e.icon}),(0,se.jsx)("span",{className:"ml-3 text-base font-medium text-gray-900",children:e.label})]},e.key))}),(0,se.jsx)("div",{className:"border-t border-gray-100 py-2",children:(0,se.jsx)(o0,{isMobile:!0,onItemClick:x})}),(0,se.jsx)("div",{className:"border-t border-gray-100 py-2",children:w.map(e=>(0,se.jsxs)("button",{onClick:e.onClick,className:"w-full flex items-center px-6 py-2 hover:bg-gray-50 transition-colors font-base44 ".concat(e.isDestructive?"text-red-600":"text-gray-900"),children:[(0,se.jsx)("span",{className:e.isDestructive?"text-red-600":"text-gray-600",children:e.icon}),(0,se.jsx)("span",{className:"ml-3 text-base font-medium ".concat(e.isDestructive?"text-red-600":"text-gray-900"),children:e.label})]},e.key))})]})]});var _}const u0=d0,m0={referrals:[],total_referrals:0,published_referrals:0};function x0(){const{user:e,reloadUser:t}=wd(),[s,a]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null),o=(0,Y.useRef)(!1),c=(null==e?void 0:e.referral_code)||r||null,d=c?"https://app.base44.com/register?ref=".concat(c):"",{data:u,isLoading:m,refetch:x}=Xd({query:async()=>await FW.getReferralStats(),initialData:m0,enabled:Boolean(e&&c),logErrorMsg:"Failed to fetch referral stats",onError:()=>{}},[null==e?void 0:e.id,c]),{mutate:h,isLoading:p,error:g}=eu({mutate:async()=>{const e=await FW.generateReferralCode();return i(e),o.current=!1,await t(),{code:e}},logErrorMsg:"Failed to generate referral code",onError:()=>{o.current=!1}}),f=g?g instanceof Error?g.message:String(g):null,v=(0,Y.useCallback)(()=>{c||p||o.current||(o.current=!0,h())},[c,p,h]),b=(0,Y.useMemo)(()=>((null==u?void 0:u.referrals)||[]).slice(0,5),[u]),j=((null==u?void 0:u.total_referrals)||0)>=5,y=(0,Y.useCallback)(async()=>{if(d)try{await navigator.clipboard.writeText(d),a(!0),setTimeout(()=>a(!1),2e3)}catch(e){}},[d]);return{user:e,referralCode:c,referralLink:d,isLoading:p,isCopied:s,error:f,referralStats:u||null,statsLoading:m,showTerms:n,referrals:b,maxReferrals:5,hasReachedMax:j,copyToClipboard:y,generateReferralCode:v,setShowTerms:l,refetchStats:x}}const h0=e=>{let{referral:t}=e;const s="published"===t.status;return(0,se.jsxs)("div",{className:"flex items-center justify-between py-1 hover:opacity-80 transition-all duration-200",style:{borderRadius:"12px",background:"rgba(103, 48, 23, 0.05)",paddingLeft:"12px",paddingRight:"12px"},children:[(0,se.jsx)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:(0,se.jsx)("div",{className:"min-w-0 flex-1",children:(0,se.jsx)("p",{className:"text-sm font-light text-black truncate font-base44",children:t.email})})}),(0,se.jsx)("div",{className:"flex-shrink-0 ml-2",children:(0,se.jsx)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-light font-base44 ".concat(s?"text-[#229954] border border-[#229954]":"bg-white text-black border border-slate-200"),style:s?{backgroundColor:"#E9F6EE"}:{},children:s?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(JK.A,{className:"h-3 w-3"}),"+10"]}):"Registered"})})]})},p0=()=>(0,se.jsxs)("div",{className:"space-y-6 text-sm",children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-semibold text-slate-800 mb-4 font-base44",children:"Eligibility"}),(0,se.jsxs)("ul",{className:"space-y-3 ml-4",children:[(0,se.jsx)("li",{className:"text-slate-700 leading-relaxed font-base44",children:"Only brand-new users can join through this referral offer. Existing accounts aren't included."}),(0,se.jsx)("li",{className:"text-slate-700 leading-relaxed font-base44",children:"We ask that you share your referral link responsibly. Posting it in irrelevant or spammy places may lead to removal from the program."})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-semibold text-slate-800 mb-4 font-base44",children:"Referral Credits"}),(0,se.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-3 text-slate-700",children:[(0,se.jsx)("li",{className:"leading-relaxed font-base44",children:"You earn 10 credits when a referred friend publishes their first app"}),(0,se.jsx)("li",{className:"leading-relaxed font-base44",children:"Referred friends receive 10 bonus credits upon registration"}),(0,se.jsx)("li",{className:"leading-relaxed font-base44",children:"Maximum of 5 successful referrals per account"}),(0,se.jsx)("li",{className:"leading-relaxed font-base44",children:"Credits have no cash value and cannot be transferred"})]})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("h4",{className:"font-semibold text-slate-800 mb-4 font-base44",children:"Restrictions"}),(0,se.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-3 text-slate-700",children:[(0,se.jsx)("li",{className:"leading-relaxed font-base44",children:"Base44 reserves the right to void fraudulent referrals"}),(0,se.jsx)("li",{className:"leading-relaxed font-base44",children:"Referral codes are non-transferable"})]})]})]}),g0=()=>(0,se.jsx)("p",{className:"text-sm text-slate-700 leading-relaxed font-base44",children:"Base44 reserves the right to modify or terminate this referral program at any time. Changes will be communicated through the platform."}),f0=e=>{let{referralState:t,titleSize:s="default"}=e;const{referralCode:a,referralLink:n,isCopied:l,error:r,referralStats:i,referrals:o,maxReferrals:c,hasReachedMax:d,copyToClipboard:u,generateReferralCode:m}=t,x="large"===s;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("div",{className:"relative ".concat(x?"mb-4 sm:mb-6":"mb-6"," max-w-sm"),children:[(0,se.jsxs)("div",{children:[(0,se.jsx)("h1",{className:"text-left font-base44 font-normal text-black mb-1 ".concat(x?"text-xl sm:text-5xl leading-tight sm:leading-none":"text-2xl font-bold"),children:x?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("span",{className:"sm:hidden",children:"Invite & Earn Credits"}),(0,se.jsxs)("span",{className:"hidden sm:inline",children:["Invite Friends &",(0,se.jsx)("br",{}),"Earn Credits"]})]}):"Invite Friends & Earn Credits"}),(0,se.jsx)("p",{className:"text-left text-black mt-1 font-base44 ".concat(x?"text-sm sm:text-md":"text-sm text-gray-600"),children:"Share your link and earn 10 credits when friends publish their first app"})]}),d&&(0,se.jsx)("div",{className:"mt-3 mb-1",children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("div",{className:"text-lg",children:"\u{1f389}"}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-sm font-semibold text-black font-base44",children:"Amazing! You've reached the maximum referrals"}),(0,se.jsxs)("p",{className:"text-xs text-gray-600 mt-1 font-base44",children:["You can refer up to ",c," friends total",((null==i?void 0:i.total_referrals)||0)>c&&" (".concat(((null==i?void 0:i.total_referrals)||0)-c," additional won't earn credits)")]})]})]})})]}),(0,se.jsxs)("div",{className:"relative z-10",children:[(0,se.jsx)("div",{className:"mb-4",children:r?(0,se.jsxs)("div",{className:"p-4 rounded-xl bg-red-50 border border-red-200",children:[(0,se.jsx)("p",{className:"text-sm text-red-600 font-medium font-base44",children:r}),(0,se.jsx)("button",{onClick:m,className:"mt-2 text-sm text-red-700 hover:text-red-800 underline font-medium font-base44",children:"Try again"})]}):a?(0,se.jsxs)("div",{className:"relative",children:[(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)("input",{type:"text",value:n,readOnly:!0,className:"flex-1 px-3 py-2 border border-[#ECEBFA] rounded-xl text-xs bg-white font-mono focus:outline-none focus:ring-1 focus:ring-black/20 focus:border-black transition-all duration-200 text-[#62748E] shadow-[0_1px_2px_0_rgba(0,0,0,0.05)]",style:{height:"40px"}}),(0,se.jsx)("button",{onClick:u,className:"px-4 py-2 bg-black text-white rounded-[12px] hover:bg-black/90 transition-all duration-200 focus:outline-none focus:ring-1 focus:ring-black/20 flex items-center gap-2 font-medium text-xs font-base44",style:{height:"40px"},title:"Copy to clipboard",children:l?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Ds.A,{className:"h-4 w-4"}),"Copied"]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ob.A,{className:"h-4 w-4"}),"Copy"]})})]}),(0,se.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 transition-all duration-200 ".concat(l?"opacity-100 translate-y-0":"opacity-0 -translate-y-2 pointer-events-none"),children:(0,se.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-emerald-50 border border-emerald-200/50 rounded-lg text-xs",children:[(0,se.jsx)(sd.A,{className:"w-3 h-3 text-emerald-600 flex-shrink-0"}),(0,se.jsx)("p",{className:"text-emerald-700 font-medium font-base44",children:"Copied to clipboard!"})]})})]}):(0,se.jsx)("div",{children:(0,se.jsxs)("div",{className:"flex items-center gap-2",children:[(0,se.jsx)($r,{className:"flex-1 h-10 rounded"}),(0,se.jsx)($r,{className:"w-16 h-10 rounded"})]})})}),(0,se.jsxs)("div",{className:"space-y-1.5",children:[(0,se.jsx)("h3",{className:"text-sm font-light text-gray-700 font-base44",children:"How it Works"}),(0,se.jsx)("div",{className:"flex flex-col",children:[{icon:DD.A,text:"Share your unique referral link with friends"},{icon:Bz.A,text:"They get <span class='font-bold'>10 credits</span> when they sign up"},{icon:Bz.A,text:"You earn <span class='font-bold'>10 credits</span> when they publish their first app"}].map((e,t)=>{const s=e.icon;return(0,se.jsxs)("div",{className:"flex items-center py-0.5 rounded-lg",children:[(0,se.jsx)("div",{className:"flex-shrink-0 rounded-full",style:{display:"flex",width:"40px",height:"40px",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"10px"},children:(0,se.jsx)(s,{className:"w-5 h-5 text-[#272524]"})}),(0,se.jsx)("p",{className:"text-sm text-black font-base44",dangerouslySetInnerHTML:{__html:e.text}})]},t)})})]})]}),(o.length>0||void 0!==(null==i?void 0:i.total_referrals))&&(0,se.jsxs)("div",{children:[(0,se.jsx)("div",{className:"mb-3 mt-3",children:(0,se.jsxs)("h4",{className:"text-sm font-light text-gray-700 font-base44",children:["Your Referrals (",(null==i?void 0:i.total_referrals)||0,"/",c,")"]})}),o.length>0&&(0,se.jsx)("div",{className:"space-y-1.5",children:o.map((e,t)=>(0,se.jsx)(h0,{referral:e},t))})]})]})};function v0(e){let{isOpen:t,onClose:s}=e;const a=x0(),{showTerms:n,setShowTerms:l,generateReferralCode:r,referralCode:i,refetchStats:o,user:c}=a,d=(0,Y.useRef)(null),u=(0,Y.useRef)(null),m=(0,Y.useRef)(null),x=(0,Y.useRef)(null),h=(e,t)=>{e.current&&(e.current.classList.add("show-scrollbar"),t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{e.current&&e.current.classList.remove("show-scrollbar")},1e3))};(0,Y.useEffect)(()=>{const e=d.current,t=u.current,s=()=>h(d,m),a=()=>h(u,x);return e&&e.addEventListener("scroll",s,{passive:!0}),t&&t.addEventListener("scroll",a,{passive:!0}),()=>{e&&e.removeEventListener("scroll",s),t&&t.removeEventListener("scroll",a),[m,x].forEach(e=>{e.current&&clearTimeout(e.current)})}},[n,a.referralStats]);const p=(0,Y.useRef)(!1),g=(0,Y.useRef)(r),f=(0,Y.useRef)(o);g.current=r,f.current=o,(0,Y.useEffect)(()=>{c&&(t&&!p.current&&(p.current=!0,i?f.current():g.current()),t||(p.current=!1))},[t,i,c]),(0,Y.useEffect)(()=>{t||l(!1)},[t,l]);const v=()=>{l(!1),s()};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("style",{jsx:!0,children:"\n        .custom-scrollbar {\n          scrollbar-gutter: stable;\n          scrollbar-width: none;\n          -ms-overflow-style: none;\n        }\n        .custom-scrollbar::-webkit-scrollbar { width: 6px; }\n        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }\n        .custom-scrollbar::-webkit-scrollbar-thumb { background: transparent; border-radius: 3px; }\n        .custom-scrollbar.show-scrollbar { scrollbar-width: thin; }\n        .custom-scrollbar.show-scrollbar::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.05); }\n        .custom-scrollbar.show-scrollbar::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.3); }\n        .custom-scrollbar.show-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(0, 0, 0, 0.5); }\n      "}),(0,se.jsx)(ma,{open:t,onOpenChange:v,children:(0,se.jsx)(fa,{className:"font-base44 w-[90vw] max-w-[90vw] sm:w-full sm:max-w-[800px] max-h-[90vh] overflow-hidden bg-transparent border-none backdrop-blur-none relative fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-0 [&>button]:hidden",children:(0,se.jsx)("div",{className:"rounded-[20px] sm:rounded-[40px] p-3 sm:p-3",style:{background:"linear-gradient(180deg, rgba(255, 255, 255, 0.60) 0%, rgba(233, 232, 248, 0.60) 106.43%), rgba(255, 255, 255, 0.10)"},children:(0,se.jsxs)("div",{className:"rounded-[18px] sm:rounded-[40px] relative overflow-hidden flex min-h-[500px] sm:min-h-[600px]",style:{background:"linear-gradient(180deg, rgba(255, 255, 255, 0.00) 0%, #FBF3EC 100%), #FFF"},children:[!n&&(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{className:"hidden sm:flex flex-col w-[270px] flex-shrink-0 rounded-tl-[36px] relative overflow-hidden",children:[(0,se.jsx)("img",{src:"/assets/invite/invite_bg.webp",alt:"Creative workspace",className:"absolute inset-0 h-full w-full object-cover rounded-tl-[36px]"}),(0,se.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400/20 via-transparent to-orange-300/30 rounded-tl-[36px]"}),(0,se.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-2/3 bg-gradient-to-t from-orange-500/40 via-orange-400/20 to-transparent"})]})}),(0,se.jsxs)("div",{className:"flex-1 relative p-4 sm:p-0 ".concat(n?"rounded-[18px] sm:rounded-[36px]":"rounded-[18px] sm:rounded-r-[36px]"," flex flex-col h-[500px] sm:h-[600px]"),style:{background:"linear-gradient(180deg, rgba(255, 255, 255, 0.95) 0%, rgba(239, 238, 251, 0.95) 100%), #FFF"},children:[(0,se.jsx)("div",{className:"flex-shrink-0 absolute top-0 left-0 right-0 z-40",children:(0,se.jsxs)("div",{className:"flex items-center justify-between px-4 sm:px-9 pt-4 sm:pt-6",children:[n?(0,se.jsxs)("button",{onClick:()=>l(!1),className:"p-2 hover:bg-black/10 rounded-lg transition-all duration-200 flex items-center gap-2",title:"Back",children:[(0,se.jsx)(Vs.A,{className:"h-6 w-6 text-black"}),(0,se.jsx)("span",{className:"text-black font-base44 text-sm",children:"Back"})]}):(0,se.jsx)("div",{}),(0,se.jsx)("button",{onClick:v,className:"p-2 hover:bg-black/10 rounded-lg transition-all duration-200",title:"Close",children:(0,se.jsx)("svg",{className:"h-6 w-6 text-black",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,se.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),n?(0,se.jsx)(se.Fragment,{children:(0,se.jsxs)("div",{ref:d,className:"flex-1 overflow-y-auto sm:px-5 pb-5 custom-scrollbar",style:{paddingTop:"60px"},children:[(0,se.jsx)("div",{className:"mb-6",children:(0,se.jsxs)(va,{children:[(0,se.jsx)(ja,{className:"text-left font-base44 text-2xl font-bold text-black mb-2",children:"Terms & Conditions"}),(0,se.jsx)(ya,{className:"text-left text-sm text-black font-base44",children:"Referral program terms and conditions"})]})}),(0,se.jsx)(p0,{})]})}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(ja,{className:"sr-only",children:"Referral Program"}),(0,se.jsx)("div",{ref:u,className:"flex-1 overflow-y-auto sm:px-9 pb-5 custom-scrollbar",style:{paddingTop:"32px"},children:(0,se.jsx)(f0,{referralState:a,titleSize:"large"})})]}),(0,se.jsx)("div",{className:"flex-shrink-0 relative border-t border-slate-300 text-center px-4 sm:px-9 py-3 sm:py-6",children:n?(0,se.jsx)(g0,{}):(0,se.jsx)("button",{onClick:()=>l(!0),className:"text-sm text-black transition-colors hover:underline font-base44",children:"Terms & Conditions"})})]})]})})})})]})}var b0=s(81850);function j0(e){const{onOpenUrl:t}=null!=e?e:{},s=(0,Y.useCallback)((e,s)=>{t?t({url:e,source:s}):window.open(e,"_blank")},[t]),{user:a}=wd(),[n,l]=(0,Y.useState)("notifications"),[r,i]=(0,Y.useState)(new Set),o=(0,Y.useRef)(null),c=(0,Y.useRef)(!1),{isLoading:d,error:u,refetch:m,resetData:x,setData:h,data:{userNotifications:p,totalUnreadNotifications:g,changelogItems:f,hasMore:v}}=Xd({initialData:{userNotifications:[],totalUnreadNotifications:0,changelogItems:[],hasMore:!0},query:async e=>{var t,s;const a=null!==(t=null==e||null===(s=e.refetchData)||void 0===s?void 0:s.nextPage)&&void 0!==t&&t,n=a?p:[],[l,r]=await Promise.all([xV.getUserNotifications(50,n.length),a?Promise.resolve(f):xV.getChangelog()]);return{userNotifications:[...n,...l.items],totalUnreadNotifications:l.total_unread,changelogItems:r,hasMore:l.items.length>=50}},logErrorMsg:"Failed to fetch notifications"},[]);(0,Y.useEffect)(()=>{const e=setInterval(()=>m(),12e5);return()=>clearInterval(e)},[]),(0,Y.useEffect)(()=>{if(null==a||!a.id)return;const e=xV.subscribeToNotifications(a.id,()=>{m()});return()=>{e&&e()}},[null==a?void 0:a.id]),(0,Y.useEffect)(()=>{d||(c.current=!1)},[d]);const b=f.some(e=>!e.is_seen);return{activeTab:n,userNotifications:p,changelogItems:f,isLoading:d&&0===p.length,loadingMore:d&&p.length>0,error:u,hasMoreNotifications:v,expandedNotifications:r,totalUnreadNotifications:g,hasUnseenChangelog:b,scrollContainerRef:o,handleTabChange:async e=>{l(e),"latest_news"===e&&(await xV.markChangelogAsSeen(),h(e=>(0,ue.A)((0,ue.A)({},e),{},{changelogItems:e.changelogItems.map(e=>(0,ue.A)((0,ue.A)({},e),{},{is_seen:!0}))})))},handleDropdownOpen:async e=>{e&&"latest_news"===n&&(await xV.markChangelogAsSeen(),h(e=>(0,ue.A)((0,ue.A)({},e),{},{changelogItems:e.changelogItems.map(e=>(0,ue.A)((0,ue.A)({},e),{},{is_seen:!0}))})))},handleMarkAllAsRead:async()=>{try{await xV.markAllNotificationsAsRead(),h(e=>(0,ue.A)((0,ue.A)({},e),{},{userNotifications:e.userNotifications.map(e=>(0,ue.A)((0,ue.A)({},e),{},{is_read:!0})),totalUnreadNotifications:0}))}catch(e){}},handleNotificationAction:async e=>{var t;e.is_read||h(t=>(0,ue.A)((0,ue.A)({},t),{},{userNotifications:t.userNotifications.map(t=>t.id===e.id?(0,ue.A)((0,ue.A)({},t),{},{is_read:!0}):t),totalUnreadNotifications:Math.max(0,t.totalUnreadNotifications-1)})),xV.markNotificationAsRead(e.id).catch(console.error),null!==(t=e.action_url)&&void 0!==t&&t.startsWith("http")&&s(e.action_url,"notification")},handleChangelogClick:e=>{e.link_url&&s(e.link_url,"changelog")},handleReadMoreClick:(e,t,s)=>{e.stopPropagation();const a=t.id||s.toString();i(e=>{const t=new Set;return e.has(a)||t.add(a),t})},handleScroll:e=>{if("notifications"!==n)return;const{scrollTop:t,scrollHeight:s,clientHeight:a}=e.target;s-t-a<100&&v&&!c.current&&(c.current=!0,m({nextPage:!0}))},NOTIFICATIONS_PAGE_SIZE:50}}const y0=e=>{const t=new Date,s=String(e),a=/Z$|[+-]\d{2}(:\d{2})?$/.test(s)?s:s+"Z",n=t.getTime()-new Date(a).getTime();if(n<0)return"Just now";const l=Math.floor(n/6e4),r=Math.floor(l/60),i=Math.floor(r/24);return l<1?"Just now":l<60?"".concat(l,"m ago"):r<24?"".concat(r,"h ago"):i<7?"".concat(i,"d ago"):i<30?"".concat(Math.floor(i/7),"w ago"):"".concat(Math.floor(i/30),"mo ago")};function N0(e){let{notifications:t,loadingMore:s,hasMore:a,pageSize:n,onNotificationAction:l,discountPercent:r=0}=e;return 0===t.length?(0,se.jsx)("div",{className:"px-4 py-8 text-center text-gray-500",children:"No notifications yet"}):(0,se.jsxs)("div",{className:"pl-1.5 pr-0 pb-3 flex flex-col gap-1.5",children:[t.map((e,t)=>(0,se.jsx)(w0,{notification:e,onAction:l,showDivider:t>0,discountPercent:r},e.id)),s&&(0,se.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,se.jsx)(Ac.A,{className:"w-5 h-5 animate-spin text-gray-400"}),(0,se.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"Loading more..."})]}),!a&&t.length>n&&(0,se.jsx)("div",{className:"py-3 text-center text-xs text-gray-400",children:"No more notifications"})]})}function w0(e){let{notification:t,onAction:s,showDivider:a,discountPercent:n=0}=e;const l=t.action_url||!t.is_read;return(0,se.jsxs)(se.Fragment,{children:[a&&(0,se.jsx)("div",{className:"border-t border-gray-100 mx-3"}),(0,se.jsx)("div",{className:"p-3 rounded-xl hover:bg-slate-50 transition-colors ".concat(l?"cursor-pointer":""),onClick:()=>l&&s(t),children:(0,se.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,se.jsxs)("div",{className:"flex items-start justify-between",children:[(0,se.jsx)("p",{className:"text-sm font-medium text-gray-900 flex-1 pr-6",children:t.title}),(0,se.jsxs)("div",{className:"flex items-center gap-1.5 shrink-0",children:[(0,se.jsx)("span",{className:"text-sm text-gray-400",children:y0(t.created_date)}),!t.is_read&&(0,se.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"})]})]}),(0,se.jsx)("p",{className:"text-sm text-gray-700 pr-20",dangerouslySetInnerHTML:{__html:Xg(t.content)}}),t.action_label&&!t.is_read&&(0,se.jsx)("div",{className:"mt-3",children:"Upgrade"===t.action_label?(0,se.jsx)(_0,{onClick:e=>{e.stopPropagation(),s(t)},discountPercent:n}):(0,se.jsx)("button",{className:"h-8 px-4 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg shadow-sm hover:bg-gray-50 transition-colors",onClick:e=>{e.stopPropagation(),s(t)},children:t.action_label})})]})})]})}function _0(e){let{onClick:t,discountPercent:s=0}=e;const a=s>0;return(0,se.jsxs)("button",{className:"h-8 px-3 text-sm font-medium rounded-lg hover:bg-orange-50 transition-colors flex items-center gap-1.5 shadow-sm",style:a?{background:"linear-gradient(77deg, rgba(255, 102, 0, 0.26) 70.38%, rgba(255, 222, 162, 0.182) 98.95%), #fff",border:"1px solid #ffcbb4"}:{background:"white",border:"1px solid #ffd0bb"},onClick:t,children:[(0,se.jsx)(ry.A,{size:16,className:"text-[#ff631f]"}),(0,se.jsx)("span",{className:"text-[#ff631f]",children:a?"".concat(s,"% off"):"Upgrade"})]})}function k0(e){let{items:t,expandedItems:s,onItemClick:a,onReadMoreClick:n}=e;return 0===t.length?(0,se.jsx)("div",{className:"px-4 py-8 text-center text-gray-500",children:"No news yet"}):(0,se.jsx)("div",{className:"space-y-0",children:t.map((e,t)=>(0,se.jsx)(C0,{item:e,index:t,isExpanded:s.has(e.id||t.toString()),onClick:a,onReadMoreClick:n},e.id||t))})}function C0(e){let{item:t,index:s,isExpanded:a,onClick:n,onReadMoreClick:l}=e;const r=0===s;return(0,se.jsxs)("div",{className:"relative",children:[s>0&&(0,se.jsx)("div",{className:"border-t border-gray-100 mx-2"}),(0,se.jsx)("div",{className:"pl-2 pr-0.5 py-2",children:(0,se.jsx)("div",{className:"p-0 hover:bg-slate-50 hover:rounded-xl cursor-pointer transition-all duration-200",onClick:()=>n(t),children:r?(0,se.jsx)(A0,{item:t}):(0,se.jsx)(S0,{item:t,index:s,isExpanded:a,onReadMoreClick:l})})})]})}function A0(e){let{item:t}=e;return(0,se.jsxs)("div",{className:"px-2 py-2",children:[t.image_url&&(0,se.jsx)("div",{className:"w-full mb-4",children:(0,se.jsx)("img",{src:t.image_url,alt:"",className:"w-full h-[205px] object-cover rounded-lg"})}),(0,se.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,se.jsxs)("h4",{className:"text-[15px] font-semibold text-gray-900 flex items-center gap-1 ".concat(t.link_url?"hover:underline":""),children:[t.title,t.link_url&&(0,se.jsx)(E0,{})]}),!t.is_seen&&(0,se.jsx)(T0,{})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-[14px] text-gray-600 mb-2",children:t.content}),(0,se.jsx)("p",{className:"text-xs text-gray-400",children:y0(t.created_date)})]})]})}function S0(e){let{item:t,index:s,isExpanded:a,onReadMoreClick:n}=e;return(0,se.jsxs)("div",{className:"px-2 py-2",children:[t.image_url&&(0,se.jsx)("div",{className:"w-full mb-4",children:(0,se.jsx)("img",{src:t.image_url,alt:"",className:"w-full h-48 object-cover rounded-lg"})}),(0,se.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,se.jsxs)("h4",{className:"text-[15px] font-semibold text-gray-900 flex items-center gap-1 ".concat(t.link_url?"hover:underline":""),children:[t.title,t.link_url&&(0,se.jsx)(E0,{})]}),!t.is_seen&&(0,se.jsx)(T0,{})]}),(0,se.jsxs)("div",{children:[(0,se.jsx)("p",{className:"text-[14px] text-gray-600 mb-1 ".concat(a?"":"line-clamp-2"),children:t.content}),(0,se.jsx)("div",{className:"mb-2",children:(0,se.jsx)("span",{className:"text-black hover:text-gray-700 text-xs cursor-pointer font-light underline",onClick:e=>n(e,t,s),children:a?"Show less":"Read more"})}),(0,se.jsx)("p",{className:"text-xs text-gray-400",children:y0(t.created_date)})]})]})}function E0(){return(0,se.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"flex-shrink-0",children:(0,se.jsx)("path",{d:"M4.6665 4.66667H11.3332M11.3332 4.66667V11.3333M11.3332 4.66667L4.6665 11.3333",stroke:"#0A0A0A",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"})})}function T0(){return(0,se.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 ml-3 mt-1"})}function I0(e){let{activeTab:t,userNotifications:s,changelogItems:a,isLoading:n,loadingMore:l,error:r,hasMoreNotifications:i,expandedNotifications:o,totalUnreadNotifications:c,scrollContainerRef:d,handleTabChange:u,handleMarkAllAsRead:m,handleNotificationAction:x,handleChangelogClick:h,handleReadMoreClick:p,handleScroll:g,NOTIFICATIONS_PAGE_SIZE:f,scrollContainerClassName:v="flex-1 overflow-y-auto",tabContainerClassName:b="px-4 pt-4 pb-3",footerClassName:j="border-t border-gray-100 px-4 py-3"}=e;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:b,children:(0,se.jsxs)("div",{className:"bg-gray-100 p-[3px] rounded-xl flex gap-0.5 h-9",children:[(0,se.jsx)("button",{className:"flex-1 px-2 py-1 text-sm font-medium rounded-lg transition-all ".concat("notifications"===t?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-500 hover:text-gray-700"),onClick:()=>u("notifications"),children:"Notifications"}),(0,se.jsx)("button",{className:"flex-1 px-2 py-1 text-sm font-medium rounded-lg transition-all ".concat("latest_news"===t?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-500 hover:text-gray-700"),onClick:()=>u("latest_news"),children:"Latest news"})]})}),(0,se.jsx)("div",{ref:d,className:v,onScroll:g,children:n?(0,se.jsx)("div",{className:"px-4 py-8 text-center text-gray-500",children:"Loading..."}):r?(0,se.jsx)("div",{className:"px-4 py-8 text-center text-red-500",children:"Failed to load notifications"}):"notifications"===t?(0,se.jsx)(N0,{notifications:s,loadingMore:l,hasMore:i,pageSize:f,onNotificationAction:x}):(0,se.jsx)(k0,{items:a,expandedItems:o,onItemClick:h,onReadMoreClick:p})}),"notifications"===t&&c>0&&(0,se.jsx)("div",{className:j,children:(0,se.jsx)("button",{className:"w-full text-sm font-medium text-gray-500 hover:text-gray-700 text-center",onClick:m,children:"Mark all as read"})})]})}function P0(){const[e,t]=(0,Y.useState)(!1),s=j0(),{totalUnreadNotifications:a,hasUnseenChangelog:n,handleDropdownOpen:l}=s;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("style",{children:"\n.notifications-scrollbar {\n    scrollbar-width: thin;\n    scrollbar-color: #d1d5db transparent;\n}\n\n.notifications-scrollbar::-webkit-scrollbar {\n    width: 6px;\n}\n\n.notifications-scrollbar::-webkit-scrollbar-track {\n    background: transparent;\n}\n\n.notifications-scrollbar::-webkit-scrollbar-thumb {\n    background-color: #d1d5db;\n    border-radius: 3px;\n}\n\n.notifications-scrollbar::-webkit-scrollbar-thumb:hover {\n    background-color: #9ca3af;\n}\n"}),(0,se.jsxs)(Nj,{open:e,onOpenChange:async e=>{t(e),await l(e)},children:[(0,se.jsx)(wj,{className:"relative focus:outline-none",children:(0,se.jsx)("div",{className:"flex items-center justify-center p-2 mr-1.5 rounded-[10px] hover:bg-gray-200 transition-colors",children:(0,se.jsxs)("div",{className:"relative size-5",children:[(0,se.jsx)(b0.A,{size:18,className:"text-gray-800 mt-px"}),a>0?(0,se.jsx)("div",{className:"absolute -top-0.5 left-[10px] min-w-3 h-3 px-1 flex items-center justify-center rounded-full bg-[#f54a00]",children:(0,se.jsx)("span",{className:"text-[10px] font-medium text-white leading-none",children:a})}):n?(0,se.jsx)("div",{className:"absolute top-0 left-[11px] size-2 rounded-full bg-[#f54a00]"}):null]})})}),(0,se.jsx)(Aj,{align:"end",className:"w-[400px] max-h-[80vh] overflow-hidden flex flex-col p-0 rounded-xl font-base44 shadow-md border border-gray-200",sideOffset:8,children:(0,se.jsx)(I0,(0,ue.A)((0,ue.A)({},s),{},{scrollContainerClassName:"overflow-y-auto max-h-[500px] notifications-scrollbar",tabContainerClassName:"px-3 pt-3 pb-3",footerClassName:"border-t border-gray-100 px-3 py-2.5"}))})]})]})}const L0="text-gray-700 hover:text-gray-800",M0="",R0=()=>{const e="localhost"===window.location.hostname,t="https://app.base44.com".includes("base44.com");return e&&t},D0=()=>(0,se.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",width:"114",height:"28"});function F0(){var e;const{logout:t,user:s}=wd(),a=(0,J.Zp)(),n=(0,J.zy)(),{workspaces:l,isLoadingWorkspaces:r,activeWorkspace:i,switchActiveWorkspace:o}=qd(),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),p=qu(),g=()=>{t(),a("/login")},f=()=>{d(!1)};(0,Y.useEffect)(()=>{!r&&l.length>0&&!i&&o(l[0])},[l,r,i,o]);const v=e=>n.pathname===e,b=()=>{if(null!=i&&i.id){const e="/workspace/".concat(i.id,p?"/settings":"/settings/basic-information");a(e)}},j=[{key:"settings",icon:(0,se.jsx)(vP.A,{size:18,className:"mr-2 font-base44 text-gray-800"}),label:"Settings",onClick:b,disabled:!(null!=i&&i.id)},{key:"referrals",icon:(0,se.jsx)(Bz.A,{size:18,className:"mr-2 font-base44 text-gray-800"}),label:"Refer Friends",onClick:()=>h(!0)},{key:"billing",icon:(0,se.jsx)(su.A,{size:18,className:"mr-2 font-base44 text-gray-800"}),label:"Billing",onClick:()=>{Tu("User Clicked Billing",{source:"top_bar_user_menu",destination:"/billing"}),Vu({user_id:(null==s?void 0:s.id)||null,app_id:null,conversation_id:null},{cta:"billing",origin:"top_bar_user_menu",target_route:"/billing"}),a("/billing")}}],y=[{key:"affiliates",icon:(0,se.jsx)(r0.A,{size:18,className:"mr-2 font-base44 text-gray-800"}),label:"Become an Affiliate!",onClick:()=>window.open("https://base44.com/affiliates","_blank"),className:"text-black font-base44 font-light"},{key:"logout",icon:(0,se.jsx)(zz.A,{size:18,className:"mr-2 font-base44 text-gray-800"}),label:"Sign Out",onClick:g,className:"text-black font-base44 font-light"}],N=[{href:"/apps",external:!1,label:"Apps"},{href:"/integrations-catalog",external:!1,label:"Integrations"},{href:"/app-templates",external:!1,label:"App Templates",onClick:()=>{Tu("App Templates - CTA Clicked",{origin:"top_bar_navigation"})}},{href:"/partners",external:!1,label:"Hire A Partner"},{href:"https://base44.com/affiliates",external:!0,label:"Affiliates"},{href:"https://app.base44.com/support",external:!0,label:"Docs & Support"},...Zp(null==s?void 0:s.platform_role)?[{href:"/admin",external:!1,label:"Admins"}]:[]],w=[{href:"https://discord.gg/ThpYPZpVts",title:"Join our Discord",icon:(0,se.jsx)("svg",{className:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M18.8943 4.34399C17.5183 3.71467 16.057 3.256 14.5317 3C14.3396 3.33067 14.1263 3.77866 13.977 4.13067C12.3546 3.89599 10.7439 3.89599 9.14391 4.13067C8.99457 3.77866 8.77056 3.33067 8.58922 3C7.05325 3.256 5.59191 3.71467 4.22552 4.34399C1.46286 8.41865 0.716188 12.3973 1.08952 16.3226C2.92418 17.6559 4.69486 18.4666 6.4346 19C6.86126 18.424 7.24527 17.8053 7.57594 17.1546C6.9466 16.92 6.34927 16.632 5.77327 16.2906C5.9226 16.184 6.07194 16.0667 6.21061 15.9493C9.68793 17.5387 13.4543 17.5387 16.889 15.9493C17.0383 16.0667 17.177 16.184 17.3263 16.2906C16.7503 16.632 16.153 16.92 15.5236 17.1546C15.8543 17.8053 16.2383 18.424 16.665 19C18.4036 18.4666 20.185 17.6559 22.01 16.3226C22.4687 11.7787 21.2836 7.83202 18.8943 4.34399ZM8.05593 13.9013C7.01058 13.9013 6.15725 12.952 6.15725 11.7893C6.15725 10.6267 6.98925 9.67731 8.05593 9.67731C9.11191 9.67731 9.97588 10.6267 9.95454 11.7893C9.95454 12.952 9.11191 13.9013 8.05593 13.9013ZM15.065 13.9013C14.0196 13.9013 13.1652 12.952 13.1652 11.7893C13.1652 10.6267 13.9983 9.67731 15.065 9.67731C16.121 9.67731 16.985 10.6267 16.9636 11.7893C16.9636 12.952 16.1317 13.9013 15.065 13.9013Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})})},{href:"https://x.com/base_44",title:"Follow on X",icon:(0,se.jsx)(VD.A,{size:26})},{href:"https://www.linkedin.com/company/106589953",title:"Follow on LinkedIn",icon:(0,se.jsx)(HD.A,{size:26})}];return(0,se.jsxs)("header",{className:"sticky top-0 z-50 bg-[#F5F5F4]",children:[(0,se.jsx)("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:(0,se.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsx)(Z.Link,{to:"/",children:(0,se.jsx)(D0,{})}),(0,se.jsxs)("nav",{className:"hidden md:flex items-center ml-6 sm:ml-8 space-x-4 sm:space-x-6",children:[N.map((e,t)=>e.external?(0,se.jsxs)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"relative flex font-base44 items-center text-sm font-medium text-gray-700 py-2 transition-colors duration-200 hover:text-orange-500 group",children:[e.icon,e.label,(0,se.jsx)("span",{className:"absolute bottom-1 left-0 w-full h-0.5 bg-orange-500 transform scale-x-0 transition-transform duration-200 group-hover:scale-x-100"})]},t):(0,se.jsxs)(Z.Link,{to:e.href,onClick:e.onClick,className:"relative flex font-base44 items-center text-sm font-medium py-2 transition-colors duration-200 group ".concat(v(e.href)?"text-orange-500":"text-gray-700 hover:text-orange-500"),children:[e.icon,e.label,(0,se.jsx)("span",{className:"absolute bottom-1 left-0 w-full h-0.5 bg-orange-500 transform transition-transform duration-200 ".concat(v(e.href)?"scale-x-100":"scale-x-0 group-hover:scale-x-100")})]},t)),R0()&&(0,se.jsx)("span",{className:"bg-red-600 text-white text-xs font-bold px-2 py-1 rounded",children:"Production"})]})]}),(0,se.jsxs)("div",{className:"flex items-center",children:[(0,se.jsxs)("div",{className:"hidden md:flex items-center  mr-2",children:[(0,se.jsx)(P0,{}),(0,se.jsx)("button",{onClick:()=>h(!0),className:"".concat(L0," ").concat(M0," p-2 hover:bg-gray-200 hover:rounded-[10px]"),title:"Refer Friends",children:(0,se.jsx)(Bz.A,{size:20})})]}),(0,se.jsxs)("div",{className:"flex items-center font-base44",children:[(0,se.jsx)("div",{className:"hidden md:block",children:(0,se.jsxs)(yn,{children:[(0,se.jsx)(Nn,{className:"outline-none",children:(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:"".concat(L0," ").concat(M0," cursor-pointer relative"),children:[(0,se.jsx)(WZ,{}),i&&!i.is_personal&&(0,se.jsx)("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-orange-500 border-2 border-white rounded-full"})]})})}),(0,se.jsxs)(En,{align:"end",className:"w-64 p-0 shadow-lg border-none rounded-lg min-w-[128px]",children:[s&&(0,se.jsxs)("div",{className:"px-4 py-3 border-b border-slate-100 font-base44",children:[(0,se.jsx)("div",{className:"font-medium",children:null===(e=s.full_name)||void 0===e?void 0:e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}),(0,se.jsx)("div",{className:"text-xs text-muted-foreground truncate mt-0.5",children:s.email})]}),(0,se.jsx)("div",{className:"p-1",children:j.map(e=>(0,se.jsxs)(Tn,{onClick:e.onClick,disabled:e.disabled,className:"cursor-pointer flex items-center px-4 py-2 hover:bg-slate-50 font-base44",children:[e.icon,(0,se.jsx)("span",{children:e.label})]},e.key))}),(0,se.jsx)(Mn,{}),(0,se.jsx)(o0,{}),(0,se.jsx)(Mn,{}),(0,se.jsx)("div",{className:"p-1",children:y.map(e=>(0,se.jsxs)(Tn,{onClick:e.onClick,className:"cursor-pointer flex items-center px-4 py-2 hover:bg-slate-50 ".concat("logout"===e.key?"text-red-600 hover:text-red-700":e.className||""),children:["logout"===e.key?(0,se.jsx)(zz.A,{size:18,className:"mr-2 font-base44"}):e.icon,(0,se.jsx)("span",{children:e.label})]},e.key))})]})]})}),(0,se.jsxs)("div",{className:"md:hidden",children:[(0,se.jsx)("button",{onClick:()=>m(!0),className:"outline-none",children:(0,se.jsx)("div",{className:"flex items-center gap-2",children:(0,se.jsxs)("div",{className:"".concat(L0," ").concat(M0," cursor-pointer relative"),children:[(0,se.jsx)(WZ,{}),i&&!i.is_personal&&(0,se.jsx)("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-orange-500 border-2 border-white rounded-full"})]})})}),(0,se.jsx)(Fr,{open:u,onOpenChange:m,children:(0,se.jsx)(Vr,{side:"bottom",className:"h-[90vh] max-h-[600px] p-0 rounded-t-3xl border-t border-gray-200",children:(0,se.jsxs)("div",{className:"flex flex-col h-full",children:[(0,se.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,se.jsx)("div",{className:"w-12 h-1 bg-gray-300 rounded-full"})}),(0,se.jsx)(u0,{user:s,activeWorkspace:i,onSettingsClick:b,isSettingsDisabled:!(null!=i&&i.id),onReferralClick:()=>h(!0),onBillingClick:()=>{Tu("User Clicked Billing",{source:"top_bar_user_menu",destination:"/billing"}),Vu({user_id:(null==s?void 0:s.id)||null,app_id:null,conversation_id:null},{cta:"billing",origin:"top_bar_user_menu",target_route:"/billing"}),a("/billing")},onAffiliateClick:()=>window.open("https://base44.com/affiliates","_blank"),onLogout:g,onItemClick:()=>m(!1)})]})})})]}),(0,se.jsx)("div",{className:"md:hidden ml-4 flex items-center",children:(0,se.jsxs)(Fr,{open:c,onOpenChange:d,children:[(0,se.jsx)(Or,{asChild:!0,children:(0,se.jsx)("button",{className:"".concat(L0," ").concat(M0," flex items-center justify-center"),children:(0,se.jsx)(i0.A,{size:24})})}),(0,se.jsx)(Vr,{side:"right",className:"w-[80%] sm:w-[350px] p-0",children:(0,se.jsxs)("div",{className:"flex flex-col h-full",children:[(0,se.jsx)("div",{className:"flex-1 px-6 py-8",children:(0,se.jsx)("nav",{className:"space-y-1",children:N.map((e,t)=>e.external?(0,se.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"block py-4 min-h-[44px] flex items-center text-lg font-medium text-gray-700 hover:text-orange-500 transition-colors",onClick:f,children:e.label},t):(0,se.jsx)(Z.Link,{to:e.href,className:"py-4 min-h-[44px] flex items-center text-lg font-medium text-gray-700 hover:text-orange-500 transition-colors",onClick:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),f()},children:e.label},t))})}),(0,se.jsx)("div",{className:"px-6 py-8 border-t border-gray-100",children:(0,se.jsx)("div",{className:"flex justify-center space-x-8",children:w.map((e,t)=>(0,se.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-orange-500 transition-colors",title:e.title,"aria-label":e.title,children:e.icon},t))})})]})})]})})]})]})]})}),(0,se.jsx)(v0,{isOpen:x,onClose:()=>h(!1)})]})}const O0=e=>{let{children:t,hideHeader:s}=e;const{isNativeMobile:a}=fd(),n=null!=s?s:a,l="/"===(0,J.zy)().pathname,{banner:r}=xH(),i=r&&(!1===r.onlyOnHomepage||l),o=l?"transparent":a?wf:"#F5F5F4";return(0,se.jsxs)(qi,{children:[(0,se.jsx)(lo,{}),(0,se.jsx)("div",{className:"flex flex-col h-screen relative overflow-hidden",style:{background:o},children:(0,se.jsxs)("div",{className:"flex flex-col h-full w-full relative z-10",children:[!n&&(0,se.jsx)(F0,{}),i&&(0,se.jsx)(gH,{config:r}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:(0,se.jsx)("main",{className:"w-full h-full",children:t})})]})})]})};let U0=!1;const B0=[],z0=async e=>{var t;if(!U0&&e)for(await(t=e.email,new Promise(e=>{var s,a,n,l,r,i;window.fbq||(s=window,a=document,n="script",s.fbq||(l=s.fbq=function(){l.callMethod?l.callMethod.apply(l,arguments):l.queue.push(arguments)},s._fbq||(s._fbq=l),l.push=l,l.loaded=!0,l.version="2.0",l.queue=[],(r=a.createElement(n)).async=!0,r.src="https://connect.facebook.net/en_US/fbevents.js",(i=a.getElementsByTagName(n)[0]).parentNode.insertBefore(r,i)),window.fbq("init","2102574843552117",t?{em:t}:{})),e()})),U0=!0;B0.length>0;){B0.shift()()}};function H0(){const{user:e,isLoadingAuth:t}=wd(),s=(0,J.zy)(),a="true"===new URLSearchParams(s.search).get("is_new_user"),n=(0,Y.useRef)(!1);return(0,Y.useEffect)(()=>{!t&&e&&(z0(e),a&&!n.current&&(n.current=!0,Tu("Registration Completed",{}),pw("registration_completed",{email:vw()(e.email),user_id:e.id,registration_method:"google"}),Cu(e.id),(0,jk.Vr)("is_new_user")))},[t,e,a]),null}let V0=!1;function W0(){return(0,Y.useEffect)(()=>{new Promise(e=>{if(window.turnstile||V0)return void e();const t=document.createElement("script");t.src="https://challenges.cloudflare.com/turnstile/v0/api.js",t.async=!0,t.defer=!0,t.onload=()=>{V0=!0,e()},t.onerror=()=>{e()},document.head.appendChild(t)})},[]),null}function q0(e){let{page:t}=e;const s=!(!1===t.requiresAuth),a=!(!1===t.usesLayout),n=l0.filter(e=>!1!==e.showInMenu),l=O0;let r=a?(0,se.jsx)(l,{pages:n,children:t.component}):t.component;return s&&(r=(0,se.jsx)(Y0,{children:r})),(0,se.jsx)(se.Fragment,{children:r})}function Y0(e){let{children:t}=e;const{isAuthenticated:s,isLoadingAuth:a}=wd();if(a)return(0,se.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin"})});if(!s){const e=encodeURIComponent(window.location.href);return Ec(window.location.host)||(window.location.href="https://app.base44.com/login?from_url=".concat(e)),(0,se.jsx)(J.C5,{to:"/login?from_url=".concat(e),replace:!0})}return(0,se.jsx)(se.Fragment,{children:t})}const G0=function(){(0,Y.useEffect)(()=>{(()=>{try{const e=new URLSearchParams(window.location.search),t={};let s=!1;if(ju.forEach(a=>{const n=e.get(a);n&&(t[a]=n,s||(s=!0))}),s){const e=yu();return e.params&&0!==Object.keys(e.params).length?e.params:(localStorage.setItem(vu,JSON.stringify(t)),localStorage.setItem(bu,Date.now().toString()),t)}return{}}catch(e){return{}}})()},[]);const e="localhost"!==window.location.hostname,t=l0.filter(e=>!e.nativeAppOnly&&!e.url.startsWith("/native")),s=dc().flatMapDeep(t,e=>[e,...e.children||[]]);return(0,se.jsx)(X.Ht,{client:Kd,children:(0,se.jsx)(Z.BrowserRouter,{children:(0,se.jsx)(Nd,{children:(0,se.jsx)(Wd,{children:(0,se.jsxs)("div",{className:"overflow-x-hidden",children:[(0,se.jsx)(J.BV,{children:s.map(e=>(0,se.jsx)(J.qh,{path:e.url,element:(0,se.jsx)(q0,{page:e})},e.url))}),e&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(H0,{}),(0,se.jsx)(Iu,{}),(0,se.jsx)(gw,{})]}),(0,se.jsx)(Rd,{}),(0,se.jsx)(W0,{})]})})})})})};const K0=function(){const{itemId:e}=(0,J.g)(),t=(0,J.Zp)(),{isNativeMobile:s,navigation:a}=fd(),{item:n,pendingChanges:l,isLoading:r,error:i,refetch:o,clearPendingChanges:c}=$g({itemId:e,enabled:!!e,viewSource:"native-mobile-app"}),d=()=>{s?a.pop():window.history.length>1?t(-1):t("/app-templates")};return r&&!n?(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center safe-area-inset",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,se.jsx)(Ac.A,{className:"w-8 h-8 text-slate-400 animate-spin"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"Loading template..."})]})}):i&&!n?(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center p-4 safe-area-inset",children:(0,se.jsxs)("div",{className:"text-center max-w-md",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(ad.A,{className:"w-6 h-6 text-slate-400"})}),(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Template Not Found"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm mb-6",children:"The template you're looking for doesn't exist or is no longer available."}),(0,se.jsx)("button",{onClick:d,className:"px-6 py-2.5 bg-slate-900 text-white rounded-xl text-sm font-medium hover:bg-slate-800 transition-colors active:scale-[0.98]",children:"Go Back"})]})}):e?(0,se.jsxs)("div",{className:"min-h-screen min-h-[100dvh] bg-white",children:[!1,(0,se.jsx)(gf,{item:n,pendingChanges:l,onItemUpdate:()=>{o()},onClose:d,showCloseButton:!1,showTermsFooter:!0,onPendingChangesCleared:c,className:"min-h-screen min-h-[100dvh]"})]}):(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center p-4 safe-area-inset",children:(0,se.jsxs)("div",{className:"text-center max-w-md",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(ad.A,{className:"w-6 h-6 text-slate-400"})}),(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No Template Selected"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"Please select a template from the catalog."})]})})};const $0=function(){const e=(0,J.Zp)(),{user:t,logout:s}=wd(),{activeWorkspace:a}=qd(),{isNativeMobile:n,linking:l,actions:r}=fd();return(0,se.jsxs)("div",{className:"min-h-screen min-h-[100dvh] bg-white safe-area-inset",children:[!1,(0,se.jsx)(d0,{user:t,activeWorkspace:a,onSettingsClick:()=>{e("/settings")},onReferralClick:async()=>{r.onItemClicked({id:"user-menu.referAFriend"})},onBillingClick:async()=>{r.onItemClicked({id:"user-menu.billing"})},onAffiliateClick:async()=>{await l.openUrl({url:"https://base44.com/affiliates"})},onIntegrationsClick:async()=>{await l.openUrl({url:"https://base44.com/integrations"})},onPartnersClick:async()=>{r.onItemClicked({id:"user-menu.partners"})},onDocsAndSupportClick:async()=>{await l.openUrl({url:"https://app.base44.com/support"})},onAboutClick:async()=>{r.onItemClicked({id:"user-menu.about"})},onLogout:async()=>{await s(!n),r.onItemClicked({id:"user-menu.logout"})},closeMenuOnItemClick:!1,className:"min-h-screen min-h-[100dvh]"})]})};const Z0=function(){const{actions:e,linking:t}=fd(),s=j0({onOpenUrl:(0,Y.useCallback)(s=>{let{url:a,source:n}=s;"notification"===n?e.onItemClicked({id:"notification.onNotificationClicked",data:{url:a}}):t.openUrl({url:a})},[e,t])});return(0,se.jsx)("div",{className:"h-screen h-[100dvh] bg-white safe-area-inset flex flex-col overflow-hidden",children:(0,se.jsx)(I0,(0,ue.A)((0,ue.A)({},s),{},{scrollContainerClassName:"flex-1 overflow-y-auto",tabContainerClassName:"px-4 pt-4 pb-3",footerClassName:"border-t border-gray-100 px-4 py-3 bg-white"}))})};function J0(){const{app:e,isLoading:t,error:s}=lp(),{initialSyncState:a}=wx.usePick("initialSyncState"),n=Boolean(null==e?void 0:e.connected_to_github)&&"complete"!==a;return s&&!t?(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center p-4 safe-area-inset",children:(0,se.jsxs)("div",{className:"text-center max-w-md",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(ad.A,{className:"w-6 h-6 text-slate-400"})}),(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"App Not Found"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"The app you're looking for doesn't exist or you don't have access to it."})]})}):t||!e||n?(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] h-screen h-[100dvh] bg-slate-50 safe-area-inset overflow-hidden",children:(0,se.jsx)(bh,{loadingState:"preparing"})}):(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] h-screen h-[100dvh] bg-white flex flex-col safe-area-inset",children:(0,se.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,se.jsx)(TP,{})})})}const Q0=function(){const{appId:e}=(0,J.g)();return e?(0,se.jsx)(np,{children:(0,se.jsx)(rb,{children:(0,se.jsx)(nb,{children:(0,se.jsx)(oH,{children:(0,se.jsx)(Ex,{children:(0,se.jsx)(J0,{})})})})})}):(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center p-4 safe-area-inset",children:(0,se.jsxs)("div",{className:"text-center max-w-md",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(ad.A,{className:"w-6 h-6 text-slate-400"})}),(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No App Selected"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"Please provide an app ID to edit."})]})})};function X0(e){let{onDataChange:t,onReset:s}=e;const{activeWorkspace:a}=qd(),n=qu(),[l,r]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(!1),[u,m]=(0,Y.useState)(!1);(0,Y.useEffect)(()=>{if(a){const e=a.is_personal||!1;if(m(e),e)r("Personal Workspace"),o(a.description||""),d(!0);else{r(a.name||""),o(a.description||"");const e=a.user_role||"member";d(["admin","owner"].includes(e))}}},[a]),(0,Y.useEffect)(()=>{t&&a&&t({name:l,description:i,canEdit:c,isPersonalWorkspace:u,workspaceId:a.id,hasChanges:x()})},[l,i,c,u,a,t]),(0,Y.useEffect)(()=>{if(s){const e=()=>{a&&(r(u?"Personal Workspace":a.name||""),o(a.description||""))};window.workspaceInfoReset=e}},[a,u,s]);const x=()=>{if(!a)return!1;const e=u?"Personal Workspace":a.name||"",t=a.description||"";return l!==e||i!==t};return a?(0,se.jsxs)("div",{className:"flex flex-col gap-6",children:[!n&&(0,se.jsx)("div",{className:"flex flex-col gap-3",children:(0,se.jsx)("div",{className:"text-black text-base font-semibold",children:"Workspace info"})}),(0,se.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,se.jsx)("div",{className:"flex gap-3",children:(0,se.jsxs)("div",{className:"flex-1 flex flex-col gap-2",children:[(0,se.jsx)("label",{className:"text-gray-700 text-sm font-medium",children:"Workspace name"}),(0,se.jsx)("input",{type:"text",value:l,onChange:e=>{!u&&c&&r(e.target.value)},disabled:u||!c,className:"px-3 py-1.5 rounded-md border border-gray-300 text-sm ".concat(u||!c?"bg-zinc-100 text-neutral-400 cursor-not-allowed":"bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"),placeholder:"Enter workspace name"})]})}),(0,se.jsx)("div",{className:"flex gap-3",children:(0,se.jsxs)("div",{className:"flex-1 flex flex-col gap-2",children:[(0,se.jsx)("label",{className:"text-gray-700 text-sm font-medium",children:"Workspace Description"}),(0,se.jsx)("textarea",{value:i,onChange:e=>{c&&o(e.target.value)},disabled:!c,className:"h-24 px-3 py-1.5 rounded-md border border-gray-300 text-sm resize-none ".concat(c?"bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent":"bg-zinc-100 text-neutral-400 cursor-not-allowed"),placeholder:"Add description"})]})})]})]}):(0,se.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,se.jsx)("div",{className:"flex flex-col gap-3",children:(0,se.jsx)("div",{className:"text-black text-base font-semibold",children:"Workspace info"})}),(0,se.jsx)("div",{className:"text-gray-500 text-sm",children:"Loading workspace information..."})]})}function e1(e){let{hideCreditsUsage:t=!1}=e;const s=qu(),{refetchWorkspaces:a}=qd(),[n,l]=(0,Y.useState)(!1),[r,i]=(0,Y.useState)(null),o=(0,Y.useCallback)(e=>{i(e)},[]),c=(null==r?void 0:r.canEdit)&&(null==r?void 0:r.hasChanges);return(0,se.jsxs)("div",{className:"h-full flex flex-col",children:[(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,se.jsxs)("div",{className:"".concat(s?"px-5 pt-6":"px-6"," pb-6 md:px-8 md:pb-8 lg:px-10 lg:pb-10 space-y-8"),children:[(0,se.jsx)(X0,{onDataChange:o,onReset:!0}),!t&&(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(RZ,{}),(0,se.jsx)(DZ,{isWorkspaceContext:!0})]})]})}),c&&(0,se.jsxs)("div",{className:"flex-shrink-0 p-4 bg-white border-t border-gray-200 flex justify-end items-center gap-3",children:[(0,se.jsx)("button",{onClick:()=>{window.workspaceInfoReset&&window.workspaceInfoReset()},disabled:n,className:"px-4 py-2 bg-white rounded-md border border-gray-300 hover:bg-gray-50 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,se.jsx)("button",{onClick:async()=>{if(r&&r.canEdit&&r.hasChanges){l(!0);try{const e={};r.isPersonalWorkspace||void 0===r.name||(e.name=r.name),void 0!==r.description&&(e.description=r.description),r.isPersonalWorkspace||void 0===r.domain||(e.domain=r.domain),await Hd.updateWorkspace(r.workspaceId,e),$.default.success("Workspace settings updated successfully!"),await a()}catch(s){var e,t;$.default.error("Failed to update workspace settings: "+((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||s.message||"Unknown error"))}finally{l(!1)}}},disabled:n,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Saving...":"Save Changes"})]})]})}const t1="workspace",s1="account",a1="plan-billing",n1=[{key:t1,label:"Workspace"},{key:a1,label:"Plan & Billing"},{key:s1,label:"Account"}];const l1=function(){var e;const[t,s]=(0,Y.useState)(null),[a,n]=(0,Y.useState)(!1),{platform:l,navigation:r}=fd(),[i,o]=(0,Y.useState)(void 0),c=(0,J.Zp)();(0,Y.useEffect)(()=>{l.os().then(o)},[l]);const d=(0,Y.useMemo)(()=>i&&"ios"===i?n1.filter(e=>e.key!==a1):n1,[i]),u=()=>{t?s(null):r.dismissOverlay()},m=()=>{r.dismissOverlay()},x=()=>{n(!1)};return t?(0,se.jsxs)("div",{className:"min-h-screen min-h-[100dvh] bg-white safe-area-inset flex flex-col",children:[!a&&(0,se.jsxs)("div",{className:"flex-shrink-0 px-4 py-4 bg-white border-b border-gray-200 flex items-center justify-center relative",children:[(0,se.jsxs)("div",{className:"absolute left-3 flex items-center",children:[(0,se.jsx)("button",{onClick:u,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full",children:(0,se.jsx)(vs.A,{size:18})}),(0,se.jsx)("button",{onClick:u,className:"text-gray-600 text-sm font-medium hover:text-gray-800 transition-colors -ml-1.5",children:"Settings"})]}),(0,se.jsx)("div",{className:"text-black text-lg font-bold",children:null===(e=n1.find(e=>e.key===t))||void 0===e?void 0:e.label})]}),(0,se.jsxs)("div",{className:a?"":"flex-1 overflow-y-auto",children:[(()=>{switch(t){case t1:return(0,se.jsx)(e1,{hideCreditsUsage:"ios"===i});case s1:return(0,se.jsx)(nJ,{onFullScreenChange:n,onBackToTab:x});case a1:return(0,se.jsx)(PZ,{handleModalClose:m});default:return null}})(),!a&&(0,se.jsx)("div",{className:"h-16"})]})]}):(0,se.jsxs)("div",{className:"min-h-screen min-h-[100dvh] bg-white safe-area-inset flex flex-col",children:[(0,se.jsxs)("div",{className:"flex-shrink-0 px-4 py-4 bg-white border-b border-gray-200 flex items-center justify-center relative",children:[(0,se.jsx)("div",{className:"absolute left-3 flex items-center",children:(0,se.jsx)("button",{onClick:()=>c(-1),className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full",children:(0,se.jsx)(vs.A,{size:18})})}),(0,se.jsx)("div",{className:"text-black text-lg font-bold",children:"Settings"})]}),(0,se.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,se.jsx)("div",{className:"flex flex-col space-y-2 px-2 py-4",children:d.map(e=>(0,se.jsxs)("button",{onClick:()=>{return t=e.key,void s(t);var t},className:"px-4 py-4 rounded-xl flex items-center justify-between text-left transition-all active:scale-95 text-gray-700 font-medium hover:bg-gray-100 active:bg-gray-200",children:[(0,se.jsx)("div",{className:"text-base",children:e.label}),(0,se.jsx)(bs.A,{size:20,className:"text-gray-400"})]},e.key))})})]})};const r1=function(){const e=x0(),{showTerms:t,setShowTerms:s,referralCode:a,generateReferralCode:n,refetchStats:l,user:r}=e,i=(0,Y.useRef)(!1),o=(0,Y.useRef)(n),c=(0,Y.useRef)(l);return o.current=n,c.current=l,(0,Y.useEffect)(()=>{r&&(i.current||(i.current=!0,a?c.current():o.current()))},[a,r]),t?(0,se.jsxs)("div",{className:"min-h-screen min-h-[100dvh] bg-white safe-area-inset flex flex-col",children:[(0,se.jsxs)("div",{className:"flex-shrink-0 px-4 py-4 bg-white border-b border-gray-200 flex items-center relative",children:[(0,se.jsxs)("button",{onClick:()=>s(!1),className:"flex items-center gap-1 text-gray-600 hover:text-gray-800",children:[(0,se.jsx)(vs.A,{size:20}),(0,se.jsx)("span",{className:"text-sm font-medium",children:"Back"})]}),(0,se.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 text-black text-lg font-bold",children:"Terms & Conditions"})]}),(0,se.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:[(0,se.jsx)("p",{className:"text-sm text-slate-600 mb-6 font-base44",children:"Referral program terms and conditions"}),(0,se.jsx)(p0,{}),(0,se.jsx)("div",{className:"mt-8 pt-6 border-t border-slate-200",children:(0,se.jsx)(g0,{})})]})]}):(0,se.jsxs)("div",{className:"min-h-screen min-h-[100dvh] bg-white safe-area-inset flex flex-col",children:[(0,se.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,se.jsx)(f0,{referralState:e,titleSize:"default"})}),(0,se.jsx)("div",{className:"flex-shrink-0 border-t border-gray-200 px-4 py-4 text-center",children:(0,se.jsx)("button",{onClick:()=>s(!0),className:"text-sm text-gray-600 hover:text-black transition-colors font-base44",children:"Terms & Conditions"})})]})},i1=()=>(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center p-4 safe-area-inset",children:(0,se.jsxs)("div",{className:"text-center max-w-md",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(ad.A,{className:"w-6 h-6 text-slate-400"})}),(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No App Selected"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"Please provide an app ID to publish."})]})});function o1(){const{app:e,isLoading:t,error:s}=lp(),{isNativeMobile:a,navigation:n,actions:l}=fd(),{initialSyncState:r}=wx.usePick("initialSyncState"),i=Boolean(null==e?void 0:e.connected_to_github)&&"complete"!==r;return s&&!t?(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center p-4 safe-area-inset",children:(0,se.jsxs)("div",{className:"text-center max-w-md",children:[(0,se.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:(0,se.jsx)(ad.A,{className:"w-6 h-6 text-slate-400"})}),(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"App Not Found"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:"The app you're looking for doesn't exist or you don't have access to it."})]})}):t||!e||i?(0,se.jsx)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex items-center justify-center safe-area-inset",children:(0,se.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,se.jsx)(Ac.A,{className:"w-8 h-8 text-slate-400 animate-spin"}),(0,se.jsx)("p",{className:"text-slate-500 text-sm",children:i?"Syncing with GitHub...":"Loading..."})]})}):(0,se.jsxs)("div",{className:"min-h-screen min-h-[100dvh] bg-white flex flex-col safe-area-inset",children:[!1,(0,se.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,se.jsx)(hz,{app:e,onPublishSuccess:()=>{l.onItemClicked({id:"publish.success",data:{app_id:(null==e?void 0:e.id)||null}}),a&&setTimeout(()=>{n.dismissModal()},500)},showLastPublishedFooter:!0,footerClassName:"mt-4 -mx-4"})})]})}const c1=function(){const{appId:e}=(0,J.g)();return e?(0,se.jsx)(np,{children:(0,se.jsx)(rb,{children:(0,se.jsx)(nb,{children:(0,se.jsx)(oH,{children:(0,se.jsx)(Ex,{children:(0,se.jsx)(o1,{})})})})})}):(0,se.jsx)(i1,{})},d1=["children","onClick","className"];const u1=()=>{const{linking:e}=fd(),t=(0,J.Zp)();return s=>{s.startsWith("/")?t(s):e.openUrl({url:s})}},m1=e=>{let{children:t,onClick:s,className:a}=e,n=(0,Nt.A)(e,d1);return(0,se.jsx)(Bx,(0,ue.A)((0,ue.A)({},n),{},{variant:"ghost",size:"sm",onClick:s,className:de(a,"flex flex-row gap-2 items-center justify-start"),children:t}))},x1=e=>{let{children:t,className:s,to:a}=e;const n=u1();return(0,se.jsx)("div",{className:de("flex flex-row gap-2 items-center justify-between",s),onClick:()=>n(a),children:t})},h1=e=>{var t;let{}=e;const{currentUsage:s,app:a}=lp(),{actions:n,platform:l}=fd(),{stats:r}=Dz(),i=hv(r)?Math.round(100*uv.discountPercent):0,[o,c]=(0,Y.useState)(!1),[d,u]=(0,Y.useState)(void 0),m=u1();(0,Y.useEffect)(()=>{l.os().then(u)},[l]);const x="ios"===d,h=()=>{n.onItemClicked({id:"user-menu.billing"})};return o?(0,se.jsxs)("div",{className:"relative flex w-full h-full",children:[(0,se.jsx)("div",{className:"absolute top-4 right-4 w-4 h-4 ",onClick:()=>c(!1),children:(0,se.jsx)(la.A,{className:"h-4 w-4"})}),(0,se.jsx)("div",{className:"flex flex-col p-2",children:(0,se.jsx)(WD,{app:a,isOpen:o,handleNavigate:m})})]}):(0,se.jsx)(se.Fragment,{children:(0,se.jsx)("div",{className:"flex flex-col w-full h-full gap-2 p-2",children:(0,se.jsxs)("div",{className:"flex flex-col w-full h-full gap-2 justify-start",children:[s&&(0,se.jsxs)("div",{className:"flex flex-col w-full gap-2 h-full border border-slate-200 rounded-[10px] p-2",children:[(0,se.jsxs)("div",{className:"flex flex-row w-full items-center justify-between",children:[(0,se.jsx)("span",{children:"Credits"}),(0,se.jsx)("span",{className:"text-xs bg-slate-100 py-0.5 rounded",children:Oj(s.tier,!1)})]}),(0,se.jsxs)("div",{className:"flex flex-col w-full h-full gap-[2px]",children:[(0,se.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,se.jsx)("span",{children:"Monthly Credits"}),(0,se.jsxs)("span",{children:[(p=s.monthly_usage,p%1==0?p:p.toFixed(1)),"/",s.monthly_limit,s.extra_credits>0&&" (+".concat(s.extra_credits,")")]})]}),(0,se.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,se.jsx)("div",{className:"h-1.5 rounded-full ".concat(s.is_over_limit?"bg-red-500":"bg-primary"),style:{width:"".concat(Math.min(s.monthly_usage/s.monthly_limit*100,100),"%")}})})]}),s.daily_limit&&(0,se.jsx)("div",{className:"flex flex-col w-full h-full gap-[2px]",children:(0,se.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,se.jsx)("span",{children:"Daily Credits"}),(0,se.jsxs)("span",{children:[s.daily_usage,"/",s.daily_limit]})]})}),(0,se.jsxs)("div",{className:"px-2 pb-1 text-xs text-muted-foreground",children:["Credits renew on: ",s.next_period_start_date?new Date(s.next_period_start_date).toLocaleDateString():""]})]}),!x&&(0,se.jsxs)(m1,{onClick:h,children:[(0,se.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,se.jsx)("path",{d:"M12.0287 0.0164795C12.1965 0.042961 12.3596 0.100934 12.5095 0.188599C12.7069 0.304114 12.8762 0.468088 13.005 0.666504L14.7355 3.75L14.738 3.75366C14.899 3.99942 14.9897 4.28987 15 4.58862L14.9991 4.71771C14.9843 5.06147 14.8634 5.39025 14.6562 5.65155L14.6545 5.6543L14.6536 5.65338L8.5794 14.4424L8.57768 14.4406C8.4508 14.6113 8.29197 14.7507 8.10978 14.8471C7.92041 14.9474 7.712 15 7.50143 15C7.29086 15 7.08245 14.9474 6.89308 14.8471C6.71098 14.7507 6.55114 14.6121 6.42433 14.4415L0.345341 5.65338L0.343618 5.65155C0.13648 5.39026 0.0163288 5.06138 0.00152918 4.71771C-0.0131882 4.37397 0.0786621 4.0346 0.262619 3.75366L0.264343 3.75L1.99786 0.666504C2.1268 0.4679 2.29663 0.304156 2.49419 0.188599C2.69408 0.0717083 2.91669 0.00678431 3.1439 0H11.8598L12.0287 0.0164795ZM8.37087 13.2788L13.5248 5.63873H11.1017L8.37087 13.2788ZM6.6027 13.2431L4.21086 5.63873H1.47501L6.6027 13.2431ZM7.48937 13.0389L10.0962 5.63873H5.18973L7.48937 13.0389ZM3.09909 0.9375C3.03124 0.948211 2.96586 0.972569 2.90521 1.008C2.82421 1.05537 2.75351 1.12204 2.70099 1.20392L2.69668 1.21124L0.964892 4.29108L0.965754 4.29199C0.892875 4.40351 0.856552 4.53824 0.862352 4.67468C0.862739 4.68362 0.865053 4.69236 0.865798 4.70123H4.13847L5.03874 0.931091H3.16716L3.09909 0.9375ZM11.1845 4.70123H14.1349C14.1356 4.69236 14.1379 4.68361 14.1383 4.67468C14.1441 4.53821 14.1076 4.40334 14.0349 4.29199L12.3062 1.21124L12.301 1.20392C12.2486 1.12227 12.1793 1.05528 12.0985 1.008C12.0378 0.972495 11.9717 0.948222 11.9038 0.9375L11.8348 0.931091H10.2873L11.1845 4.70123ZM5.15785 4.70123H10.1651L9.26788 0.931091H6.05811L5.15785 4.70123Z",fill:"black"})}),(0,se.jsx)("span",{children:"Upgrade Plan"}),i>0&&(0,se.jsxs)("span",{className:"px-1.5 py-px rounded-sm text-sm font-medium text-black",style:{background:"linear-gradient(118deg, rgba(255, 154, 110, 1) 5.32%, rgba(255, 99, 31, 1) 100%)"},children:[i,"% off"]})]}),!x&&(0,se.jsx)(at.Separator,{}),(0,se.jsx)(m1,{children:(0,se.jsxs)(x1,{to:"https://docs.base44.com",children:[(0,se.jsx)(Lj.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Documentation"})]})}),(0,se.jsxs)(m1,{onClick:()=>m("/settings"),children:[(0,se.jsx)(vP.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Settings"})]}),!x&&(0,se.jsxs)(m1,{onClick:h,children:[(0,se.jsx)(su.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Billing"})]}),(0,se.jsx)(m1,{children:(0,se.jsxs)(x1,{to:"https://app.base44.com/support?appId=".concat(null!==(t=null==a?void 0:a.id)&&void 0!==t?t:""),children:[(0,se.jsx)(Oy.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Help Center"})]})}),s&&(0,se.jsxs)(m1,{onClick:()=>c(!0),children:[(0,se.jsx)(Bz.A,{className:"h-4 w-4"}),(0,se.jsx)("span",{children:"Win Free Credits"})]}),(0,se.jsx)(at.Separator,{})]})})});var p},p1=()=>{const{appId:e}=(0,J.g)();return e?(0,se.jsx)(np,{children:(0,se.jsx)(rb,{children:(0,se.jsx)(h1,{})})}):(0,se.jsx)(i1,{})},g1=[{name:"App Template Detail",url:"/app-templates/:itemId",component:(0,se.jsx)(K0,{}),requiresAuth:!0},{name:"Remix User App",url:"/remix-app/:appId",component:(0,se.jsx)(Uq,{}),requiresAuth:!0},{name:"User Menu",url:"/user-menu",component:(0,se.jsx)($0,{}),requiresAuth:!0},{name:"Notifications",url:"/notifications",component:(0,se.jsx)(Z0,{}),requiresAuth:!0},{name:"Chat Editor",url:"/chat-editor/:appId",component:(0,se.jsx)(Q0,{}),requiresAuth:!0},{name:"Settings",url:"/settings",component:(0,se.jsx)(l1,{}),requiresAuth:!0},{name:"Refer a Friend",url:"/refer-a-friend",component:(0,se.jsx)(r1,{}),requiresAuth:!0},{name:"Publish App",url:"/publish/:appId",component:(0,se.jsx)(c1,{}),requiresAuth:!0},{name:"Main Menu",url:"/main-menu/:appId",component:(0,se.jsx)(p1,{}),requiresAuth:!0},{name:"Create Workspace",url:"/create-workspace",component:(0,se.jsx)(kZ,{}),requiresAuth:!0,usesLayout:!0},{name:"Workspace Dashboard",url:"/workspace/:workspaceId",component:(0,se.jsx)(_Z,{}),requiresAuth:!0,usesLayout:!0},{name:"App Dashboard",url:"/apps/:appId",component:(0,se.jsx)(vH,{view:"workspace"}),requiresAuth:!0},{name:"App Dashboard",url:"/apps/:appId/dashboard",component:(0,se.jsx)(vH,{view:"workspace"}),requiresAuth:!0},{name:"App Editor Preview",url:"/apps/:appId/editor/preview",component:(0,se.jsx)(vH,{view:"preview"}),requiresAuth:!0},{name:"App Editor Preview Page",url:"/apps/:appId/editor/preview/:pageName",component:(0,se.jsx)(vH,{view:"preview"}),requiresAuth:!0},{name:"App Editor Workspace",url:"/apps/:appId/editor/workspace/:workspaceView",component:(0,se.jsx)(vH,{view:"workspace"}),requiresAuth:!0},{name:"Home",url:"/",component:(0,se.jsx)(gv,{}),requiresAuth:!0,usesLayout:!0},{name:"User Apps",url:"/apps",component:(0,se.jsx)(Kv,{}),requiresAuth:!0,usesLayout:!0},{name:"Partners Catalog",url:"/partners",component:(0,se.jsx)(NX,{}),requiresAuth:!0,usesLayout:!0},{name:"App Templates",url:"/app-templates",component:(0,se.jsx)(Lq,{}),requiresAuth:!0,usesLayout:!0},{name:"Integrations Catalog",url:"/integrations-catalog",component:(0,se.jsx)(_q,{}),requiresAuth:!0,usesLayout:!0},{name:"Billing",url:"/billing",component:(0,se.jsx)(l_,{}),requiresAuth:!0,usesLayout:!0}];function f1(){return null}function v1(){return(0,Y.useLayoutEffect)(()=>(pd(),xd("404"),hd("404"),()=>pd()),[]),(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("h1",{className:"text-2xl font-semibold text-slate-900 mb-2",children:"Page Not Found"}),(0,se.jsx)("p",{className:"text-slate-600",children:"This page is not available in the mobile app."})]})})}function b1(e){let{page:t}=e;const s=!(!1===t.requiresAuth),a=!0===t.usesLayout;(0,Y.useLayoutEffect)(()=>(pd(),()=>pd()),[t.url]);let n=t.component;return s&&(n=(0,se.jsx)(j1,{children:n})),a&&(n=(0,se.jsx)(O0,{children:n})),(0,se.jsx)(se.Fragment,{children:n})}function j1(e){let{children:t}=e;const{isAuthenticated:s,isLoadingAuth:a}=wd();return(0,Y.useEffect)(()=>{xd("auth")},[]),(0,Y.useEffect)(()=>{a||hd("auth")},[a,s]),a?(0,se.jsx)("div",{className:"flex justify-center items-center h-screen bg-white",children:(0,se.jsx)(Ac.A,{className:"h-8 w-8 animate-spin text-orange-500"})}):s?(0,se.jsx)(se.Fragment,{children:t}):(0,se.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:(0,se.jsxs)("div",{className:"text-center",children:[(0,se.jsx)("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Authentication Required"}),(0,se.jsx)("p",{className:"text-slate-600",children:"Please log in through the app to continue."})]})})}const y1=function(){return(0,se.jsx)(X.Ht,{client:Kd,children:(0,se.jsx)(Z.BrowserRouter,{children:(0,se.jsx)(Nd,{children:(0,se.jsxs)(Wd,{children:[(0,se.jsx)(f1,{}),(0,se.jsx)("div",{className:"overflow-x-hidden ".concat(""),children:(0,se.jsxs)(J.BV,{children:[g1.map(e=>(0,se.jsx)(J.qh,{path:e.url,element:(0,se.jsx)(b1,{page:e})},e.url)),(0,se.jsx)(J.qh,{path:"*",element:(0,se.jsx)(v1,{})})]})})]})})})})},N1=()=>{let e;return e=Ec(window.location.host)?od()?(0,se.jsx)(y1,{}):(0,se.jsx)(G0,{}):(0,se.jsx)(rd,{}),(0,se.jsx)(Dd,{componentName:"App",children:(0,se.jsxs)("div",{className:"font-sans",children:[(0,se.jsx)("div",{children:(0,se.jsx)(lo,{})}),(0,se.jsx)("div",{children:(0,se.jsx)(io,{})}),(0,se.jsx)("div",{children:(0,se.jsx)($.Toaster,{})}),(0,se.jsx)(qi,{children:e})]})})},w1=e=>{e&&e instanceof Function&&s.e(96).then(s.bind(s,88206)).then(t=>{let{getCLS:s,getFID:a,getFCP:n,getLCP:l,getTTFB:r}=t;s(e),a(e),n(e),l(e),r(e)})};G.createRoot(document.getElementById("root")).render((0,se.jsx)(N1,{})),w1()},69783:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(73422),n=s(41397),l=s.n(n),r=s(23046),i=s(55194);function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}class c{constructor(){this._roomToListeners=void 0,this._notificationListeners=void 0,this._directiveCallbacks=void 0,this._statusBannerListeners=void 0,this.historicalSocketIds=void 0,this.socket=void 0,this.tokenUnsubscribe=null,this._connectionPromise=null,this._connectionResolver=null,this._roomToListeners={},this._notificationListeners={},this._directiveCallbacks={},this._statusBannerListeners={},this.historicalSocketIds=[],this.initializeSocket(),this.setupTokenListener()}waitForConnection(){var e;return null!==(e=this.socket)&&void 0!==e&&e.connected?Promise.resolve():(this._connectionPromise||(this._connectionPromise=new Promise(e=>{this._connectionResolver=e})),this._connectionPromise)}setupTokenListener(){this.tokenUnsubscribe=i.b3.addListener(e=>{"token_changed"===e&&this.reconnectWithAuth()})}getMountPath(){throw new Error("Not implemented")}getSocketQuery(){const e=i.b3.getToken();return e?{token:e}:{}}initializeSocket(){const e={path:this.getMountPath(),transports:["websocket"]};e.query=this.getSocketQuery(),this.socket=(0,a.io)((0,r.GY)(),e),this.socket.on("connect",()=>{this.historicalSocketIds=l().uniq(this.historicalSocketIds.concat([this.socket.id])),this.reconnectAllRooms(),this._connectionResolver&&(this._connectionResolver(),this._connectionResolver=null,this._connectionPromise=null)}),this.socket.on("disconnect",()=>{}),this.socket.on("update_model",e=>this.onUpdateModel(e)),this.socket.on("new_notification",e=>this.onNewNotification(e)),this.socket.on("github_changes",e=>this.onGitHubChanges(e)),this.socket.on("mobile_build_update",e=>{this.onMobileBuildUpdate(e)}),this.socket.on("directive",e=>this.onDirective(e)),this.socket.on("status_banner_update",e=>this.onStatusBannerUpdate(e)),this.socket.on("user_joined",e=>{}),this.socket.on("user_left",e=>{}),this.socket.on("error",e=>{"Authentication required to join rooms"===e.message||"Access denied to this room"===e.message||e.message}),this.socket.on("*",e=>{})}reconnectWithAuth(){this.socket&&this.socket.disconnect(),this.initializeSocket()}getSocketId(){return this.socket.id}reconnectAllRooms(){Object.keys(this._roomToListeners).forEach(e=>{this.joinRoom(e),Object.values(this._roomToListeners[e]).forEach(e=>{let{reconnectCallback:t}=e;t&&t()})}),Object.keys(this._notificationListeners).forEach(e=>{this.joinRoom(e),Object.values(this._notificationListeners[e]).forEach(e=>{let{reconnectCallback:t}=e;t&&t()})})}hasListeners(e){return Object.keys(this._roomToListeners[e]||{}).length>0}joinRoom(e){this.socket.emit("join",e)}leaveRoom(e){this.socket.emit("leave",e)}addListener(e,t,s){this.hasListeners(e)||(this.joinRoom(e),this._roomToListeners[e]={});const a="function"==typeof s?{reconnectCallback:s}:s||{},n=o();this._roomToListeners[e][n]={callback:t,reconnectCallback:a.reconnectCallback,onGitHubChanges:a.onGitHubChanges,onMobileBuildUpdate:a.onMobileBuildUpdate};const l=this;return()=>{l.removeListener(n)}}getListeners(e){return this._roomToListeners[e]}removeListener(e){Object.keys(this._roomToListeners).forEach(t=>{this._roomToListeners[t][e]&&(delete this._roomToListeners[t][e],0===Object.keys(this._roomToListeners[t]).length&&(this.leaveRoom(t),delete this._roomToListeners[t]))})}hasNotificationListeners(e){return Object.keys(this._notificationListeners[e]||{}).length>0}addNotificationListener(e,t,s){this.hasNotificationListeners(e)||(this.joinRoom(e),this._notificationListeners[e]={});const a=o();this._notificationListeners[e][a]={callback:t,reconnectCallback:s};const n=this;return()=>{n.removeNotificationListener(a)}}removeNotificationListener(e){Object.keys(this._notificationListeners).forEach(t=>{this._notificationListeners[t][e]&&(delete this._notificationListeners[t][e],0===Object.keys(this._notificationListeners[t]).length&&(this.leaveRoom(t),delete this._notificationListeners[t]))})}onUpdateModel(e){const t=e.room,s=JSON.parse(e.data);this._roomToListeners[t]&&Object.values(this._roomToListeners[t]).forEach(e=>{let{callback:t}=e;t(s)})}onNewNotification(e){const t=e.room,s=JSON.parse(e.data);this._notificationListeners[t]&&Object.values(this._notificationListeners[t]).forEach(e=>{let{callback:t}=e;t(s)})}onGitHubChanges(e){const t=e.room,s=e.data;this._roomToListeners[t]&&Object.values(this._roomToListeners[t]).forEach(e=>{let{onGitHubChanges:t}=e;t&&t(s)})}onMobileBuildUpdate(e){const t=e.room,s=e.data;this._roomToListeners[t]&&Object.values(this._roomToListeners[t]).forEach(e=>{let{onMobileBuildUpdate:t}=e;t&&t(s)})}onDirective(e){var t;const{room:s,type:a}=e,n=null===(t=this._directiveCallbacks[s])||void 0===t?void 0:t[a];n&&n()}setDirectiveCallback(e,t,s){this._directiveCallbacks[e]||(this._directiveCallbacks[e]={}),this._directiveCallbacks[e][t]=s}removeDirectiveCallback(e,t){this._directiveCallbacks[e]&&(delete this._directiveCallbacks[e][t],0===Object.keys(this._directiveCallbacks[e]).length&&delete this._directiveCallbacks[e])}removeAllDirectiveCallbacks(e){delete this._directiveCallbacks[e]}onStatusBannerUpdate(e){Object.values(this._statusBannerListeners).forEach(t=>{try{t(e)}catch(s){}})}addStatusBannerListener(e){const t=o();return this._statusBannerListeners[t]=e,()=>{delete this._statusBannerListeners[t]}}cleanup(){this.tokenUnsubscribe&&(this.tokenUnsubscribe(),this.tokenUnsubscribe=null),this.socket&&this.socket.disconnect()}}},73215:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>g,Vp:()=>u,bx:()=>p,r8:()=>x,xL:()=>o.xL,yI:()=>o.yI});var a=s(36642),n=s(41397),l=s.n(n),r=s(23046),i=s(85667),o=s(38534),c=s(6221);let d=[];function u(e){d.push(e)}let m=()=>null;function x(e){m=e}let h=()=>null;function p(e){h=e}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const x=a.A.create();let p;return p=e.startsWith("/")?(0,r.Gt)()+e:e,x.defaults.baseURL=p,n&&(x.defaults.headers.common["Content-Type"]="application/json",x.defaults.headers.common.Accept="application/json"),Object.keys(t).forEach(e=>{x.defaults.headers.common[e]=t[e]}),x.interceptors.request.use(t=>{t.headers=l().merge(l().cloneDeep((0,o.KZ)()),t.headers),t.headers["X-Socket-Id"]=c.A.getSocketId(),t.headers["X-Origin-URL"]=window.location.href;const a=m();a&&(t.headers["X-Active-Workspace-Id"]=a);const n=h();n&&(t.headers["X-Active-App-Id"]=n);const r=(0,i.A)();if(t.requestId=r,s)try{window.parent.postMessage({type:"api-request-start",requestId:r,data:{url:e+t.url,method:t.method,body:t.data instanceof FormData?"[FormData object]":t.data}},"*")}catch(d){}return t},e=>Promise.reject(e)),x.interceptors.response.use(e=>{if(s)try{window.parent.postMessage({type:"api-request-end",requestId:e.config.requestId,data:{statusCode:e.status,response:e.data}},"*")}catch(t){}return n?e.data:e},e=>{var t,s,a,n,l;null!==(t=e.config)&&void 0!==t&&t.requestId&&window.parent.postMessage({type:"api-request-end",requestId:e.config.requestId,data:{statusCode:(null===(n=e.response)||void 0===n?void 0:n.status)||0,response:(null===(l=e.response)||void 0===l?void 0:l.data)||{error:e.message}}},"*");if(u)for(const r of d)r(e);if(null!==(s=e.response)&&void 0!==s&&null!==(a=s.data)&&void 0!==a&&a.traceback);return Promise.reject(e)}),x}},75888:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(84125);class n extends a.y{getBaseURL(){return"/usage-logs"}async getStats(){return await this.axios.get("/stats")}async getMonthlyPlans(){return await this.axios.get("/monthly-plans")}async getCurrentUsage(){return await this.axios.get("/current-usage")}async getPricingAndSubscription(){return await this.axios.get("/pricing-and-subscription")}getUserStats(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n={};return t&&s&&(n.start_date=t.toISOString(),n.end_date=s.toISOString()),a&&(n.workspace_id=a),this.axios.get("/user-stats/".concat(e),{params:n})}getUserWorkspacesWithDetails(e){return this.axios.get("/user-workspaces-with-details/".concat(e))}getCurrentIntegrationUsage(){return this.axios.get("/current-integration-usage")}getOrganizationRuntimeStatus(e){return this.axios.get("/organization-runtime-status/".concat(e))}clearOrganizationRuntimeBlock(e){return this.axios.post("/organization-runtime-status/".concat(e,"/clear"))}}const l=new n},76976:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(89379),n=s(38534),l=s(89445);const r=new class{constructor(){this.listeners=new Set,setTimeout(()=>{this.processSSOTokensFromURL()},0)}getToken(){return this.fetchToken(!1)||localStorage.getItem("token")||localStorage.getItem("base44_access_token")}fetchToken(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=new URLSearchParams(window.location.search),s=t.get("access_token")||localStorage.getItem("token")||localStorage.getItem("base44_access_token");return e&&t.has("access_token")&&(0,l.Vr)("access_token"),s}setToken(e){e?(localStorage.setItem("token",e),localStorage.setItem("base44_access_token",e),(0,n.yI)("Authorization","Bearer ".concat(e))):(localStorage.removeItem("token"),localStorage.removeItem("base44_access_token"),(0,n.xL)("Authorization")),this.notifyListeners("token_changed",{token:e})}addListener(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.listeners.forEach(s=>{try{s(e,t)}catch(a){}})}processSSOTokensFromURL(){const e=new URLSearchParams(window.location.search);if(e.get("sso_access_token")){const t={sso_access_token:e.get("sso_access_token"),sso_token_type:e.get("sso_token_type"),sso_expires_at:e.get("sso_expires_at"),sso_scope:e.get("sso_scope"),sso_provider:e.get("sso_provider"),sso_id_token:e.get("sso_id_token")};this.setSSOTokens(t);["sso_access_token","sso_token_type","sso_expires_at","sso_scope","sso_provider","sso_id_token"].forEach(t=>{e.delete(t)});const s=window.location.pathname+(e.toString()?"?"+e.toString():"");window.history.replaceState({},"",s),this.notifyListeners("sso_tokens_updated",{tokens:this.getSSOTokens()})}}setSSOTokens(e){const t={access_token:e.sso_access_token,token_type:e.sso_token_type,expires_at:e.sso_expires_at,scope:e.sso_scope,provider:e.sso_provider,id_token:e.sso_id_token,stored_at:Date.now()},s=Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return null!=s}));if(localStorage.setItem("sso_tokens",JSON.stringify(s)),s.access_token)try{(0,n.yI)("SSO_AUTHORIZATION","".concat(s.token_type," ").concat(s.access_token))}catch(a){setTimeout(()=>{try{(0,n.yI)("SSO_AUTHORIZATION","".concat(s.token_type," ").concat(s.access_token))}catch(e){}},100)}}getSSOTokens(){try{const e=localStorage.getItem("sso_tokens");if(!e)return null;const t=JSON.parse(e);return t.expires_at&&new Date(1e3*t.expires_at)<=new Date?(this.clearSSOTokens(),null):t}catch(e){return this.clearSSOTokens(),null}}clearSSOTokens(){localStorage.removeItem("sso_tokens");try{(0,n.xL)("SSO_AUTHORIZATION")}catch(e){setTimeout(()=>{try{(0,n.xL)("SSO_AUTHORIZATION")}catch(e){}},100)}this.notifyListeners("sso_tokens_cleared")}getSSOAuthHeader(){const e=this.getSSOTokens();return e&&e.access_token?{SSO_AUTHORIZATION:"".concat(e.token_type," ").concat(e.access_token)}:null}async fetchWithSSO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=this.getSSOAuthHeader();if(!s)throw new Error("No valid SSO tokens available");const n=(0,a.A)((0,a.A)({},s),{},{"Content-Type":"application/json"},t.headers);return fetch(e,(0,a.A)((0,a.A)({},t),{},{headers:n}))}debugSSOTokens(){const e=localStorage.getItem("sso_tokens");if(e)try{const t=JSON.parse(e);if(t.expires_at){new Date(1e3*t.expires_at)}}catch(t){}}}},83153:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(84125);class n extends a.H{getBaseURL(){return"/apps"}_appPath(e,t){return"/".concat(e,"/payments").concat(t)}getSandboxStatus(e){return this.axios.get(this._appPath(e,"/stripe/sandbox"))}getClaimUrl(e){return this.axios.get(this._appPath(e,"/stripe/sandbox/claim-url"))}createProduct(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.axios.post(this._appPath(e,"/stripe/products"),{name:t,description:s,metadata:a})}listProducts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return this.axios.get(this._appPath(e,"/stripe/products"),{params:{active:t,limit:s}})}getProduct(e,t){return this.axios.get(this._appPath(t,"/stripe/products/".concat(e)))}updateProduct(e,t,s){let{name:a,description:n,images:l,metadata:r,active:i}=s;return this.axios.put(this._appPath(e,"/stripe/products/".concat(t)),{name:a,description:n,images:l,metadata:r,active:i})}createPrice(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"usd",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return this.axios.post(this._appPath(e,"/stripe/prices"),{product_id:t,unit_amount:s,currency:a,recurring_interval:n,recurring_interval_count:l,metadata:r})}listPrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;return this.axios.get(this._appPath(e,"/stripe/prices"),{params:{product_id:t,active:s,limit:a}})}getPrice(e,t){return this.axios.get(this._appPath(t,"/stripe/prices/".concat(e)))}updatePrice(e,t,s){let{active:a,metadata:n,nickname:l}=s;return this.axios.put(this._appPath(e,"/stripe/prices/".concat(t)),{active:a,metadata:n,nickname:l})}getIntegrationStatus(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.axios.get(this._appPath(e,"/stripe/status"),{params:t?{check_transactions:!0}:{}})}configureLiveKeys(e,t,s){return this.axios.post(this._appPath(e,"/stripe/configure-live-keys"),{publishable_key:t,secret_key:s})}removeIntegration(e){return this.axios.delete(this._appPath(e,"/stripe"))}}const l=new n},84125:(e,t,s)=>{"use strict";s.d(t,{H:()=>r,y:()=>i});var a=s(89379),n=s(73215),l=s(6221);class r{constructor(){this.axios=this.getClient()}getBaseURL(){return"/"}getClient(){return(0,n.Ay)(this.getBaseURL())}}class i extends r{parseInstance(e){return e}list(e,t,s,a){let n={};return e&&(n.sort=e),t&&(n.limit=t),s&&(n.skip=s),a&&(n.fields=a),this.axios.get("",{params:n}).then(e=>e.map(this.parseInstance))}filterParams(e,t,s,a,n){let l={q:JSON.stringify(e)};return t&&(l.sort=t),s&&(l.limit=s),a&&(l.skip=a),n&&(l.fields=n),l}filter(e,t,s,a,n){let l=this.filterParams(e,t,s,a,n);return this.axios.get("",{params:l}).then(e=>e.map(this.parseInstance))}get(e){return this.axios.get("/".concat(e)).then(this.parseInstance)}subscribe(e,t,s,n){const r=this;s(this.parseInstance(t));const i=this.getBaseURL()+"/"+e;return l.A.addListener(i,e=>{t=(0,a.A)((0,a.A)({},t),e),s(this.parseInstance(t),Object.keys(e))},{reconnectCallback:async()=>{const t=await r.get(e);s(this.parseInstance(t),Object.keys(t))},onGitHubChanges:n})}async fetchAndSubscribe(e,t,s){let a=await this.get(e);return this.subscribe(e,a,t,s)}schema(){return this.axios.get("/schema")}create(e){return this.axios.post("",e).then(this.parseInstance)}update(e,t){return this.axios.put("/".concat(e),t).then(this.parseInstance).then(s=>{const a=l.A.getListeners(this.getBaseURL()+"/"+e)||[];return Object.values(a).forEach(e=>e.callback(s,Object.keys(t))),s})}delete(e){return this.axios.delete("/".concat(e))}deleteMany(e){return this.axios.delete("",{data:e})}}},89445:(e,t,s)=>{"use strict";s.d(t,{I5:()=>i,Vr:()=>r,m9:()=>o});var a=s(89379),n=s(53986);const l=["or","and"];function r(e){const t=new URLSearchParams(window.location.search);t.delete(e);const s=window.location.pathname+(t.toString()?"?"+t.toString():"");window.history.replaceState({},"",s)}function i(e){const t=e,{or:s,and:r}=t,c=(0,n.A)(t,l),d=(0,a.A)((0,a.A)({},o(c)),{},{or:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return i({$or:[c,...t]})},and:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return i({$and:[c,...t]})},query:()=>{var e;return null!==(e=o(c))&&void 0!==e?e:{}}});return d}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:49;if(t<=0)return e;if("function"!=typeof e){if(Array.isArray(e)){const s=e.map(e=>o(e,t-1)).filter(e=>null!=e);if(0===s.length)return;return s}if(null!=e&&"object"==typeof e){const s={};for(const a in e){const n=o(e[a],t-1);null!=n&&(s[a]=n)}if(0===Object.keys(s).length)return;if(1===Object.keys(s).length&&null!=s.$options)return;return s}if(null!==e)return e}}},91903:()=>{}},n={};function l(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return a[e].call(s.exports,s,s.exports,l),s.loaded=!0,s.exports}l.m=a,l.amdO={},e=[],l.O=(t,s,a,n)=>{if(!s){var r=1/0;for(d=0;d<e.length;d++){for(var[s,a,n]=e[d],i=!0,o=0;o<s.length;o++)(!1&n||r>=n)&&Object.keys(l.O).every(e=>l.O[e](s[o]))?s.splice(o--,1):(i=!1,n<r&&(r=n));if(i){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,a,n]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var n=Object.create(null);l.r(n);var r={};t=t||[null,s({}),s([]),s(s)];for(var i=2&a&&e;("object"==typeof i||"function"==typeof i)&&!~t.indexOf(i);i=s(i))Object.getOwnPropertyNames(i).forEach(t=>r[t]=()=>e[t]);return r.default=()=>e,l.d(n,r),n},l.d=(e,t)=>{for(var s in t)l.o(t,s)&&!l.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},l.e=()=>Promise.resolve(),l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),l.p="/",(()=>{var e={792:0};l.O.j=t=>0===e[t];var t=(t,s)=>{var a,n,[r,i,o]=s,c=0;if(r.some(t=>0!==e[t])){for(a in i)l.o(i,a)&&(l.m[a]=i[a]);if(o)var d=o(l)}for(t&&t(s);c<r.length;c++)n=r[c],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(d)},s=self.webpackChunkfrontend=self.webpackChunkfrontend||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),l.nc=void 0;var r=l.O(void 0,[96],()=>l(67150));r=l.O(r)})();